<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Looking for level codes in Prehistorik-2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The game Prehistorik 2 does not provide saves, but at each level there is (dangling in the air at some place in the level) level code. There are two m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Looking for level codes in Prehistorik-2</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/e8e/5a0/298/e8e5a029843c163451e962d71629a95f.png"><br>  The game <a href="http://en.wikipedia.org/wiki/Prehistorik_2">Prehistorik 2</a> does not provide saves, but at each level there is (dangling in the air at some place in the level) level code.  There are two modes of transmission, Beginner and Expert, the code also defines the mode.  When you start the game, you can start from the first level, or you can enter a code and get immediately to the appropriate level.  On the same computer with a constant environment, the codes do not change, but on different computers the codes, generally speaking, are different, so the codes found during the passage and carefully written out on a piece of paper will become completely useless in another environment.  Therefore, instead of paper, it is better to have a program that writes codes for a particular environment.  The finished result: <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> , is a DOS program that should run in the same environment as the game.  An alternative way to get to the desired level from the code entry screen: enter three ADDE C0DE F00D codes or DEAD C0DE F00D, each of the three codes is incorrect in itself, but when you enter them in this order, the fourth code is the level number from 1 to 10, plus 10 for Expert mode, leads immediately to the requested level. <br><br>  Under the cut - the process of research.  Knowledge of x86 assembler is required at least at the ‚Äúread with <a href="http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html">dictionary</a> ‚Äù level. <br><br><a name="habracut"></a><h1>  Instruments </h1><br>  The main tool is the <a href="http://www.idapro.ru/">IDA Pro</a> disassembler.  For the study of DOS-programs is quite enough <a href="https://www.hex-rays.com/products/ida/support/download_freeware.shtml">free version 5.0</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are many different DOS utilities here: <a href="http://www.exetools.com/">http://www.exetools.com/</a> , some of them will be mentioned later in the text. <br><br>  Optional tool - debugger.  You can use any of the DOS debuggers (the choice is on the link above), their common drawback is the sharing of resources (at least the screen) with the program being debugged.  Give all the resources of the program, but at the same time debug it allows the <a href="http://bochs.sourceforge.net/">Bochs</a> emulator with a built-in debugger.  In addition, you can do without a debugger. <br><br>  It also does not hurt the hex editor.  From the open, apparently, the best - <a href="http://beye.sourceforge.net/">beye</a> (former biew).  But you can get by with <code>hexdump</code> to view and <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <h1> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </h1> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <h1> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </h1> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> <pre> <code class="hljs perl"><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -<span class="hljs-keyword"><span class="hljs-keyword">ne</span></span> <span class="hljs-string"><span class="hljs-string">'\x..\x..'</span></span> | dd of= <span class="hljs-keyword"><span class="hljs-keyword">seek</span></span>= bs=<span class="hljs-number"><span class="hljs-number">1</span></span> conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  <span class="hljs-number"><span class="hljs-number">52190</span></span> .    (     )  Hybrid,       . <br> <br>  exe<span class="hljs-string"><span class="hljs-string">'     ,       : exe'</span></span>       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  <span class="hljs-number"><span class="hljs-number">63728</span></span> . <br> <br>  pre2_1.exe    ,    <span class="hljs-string"><span class="hljs-string">"INTRO CODED BY CYBER"</span></span>.  : <br> <br> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 start proc near seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E48 mov cs:pspSeg, ds seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4D mov ax, cs seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E4F mov es, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 assume es:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E51 mov cx, <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E54 mov si, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E57 mov di, si seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E59 rep movsb seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5B mov ds, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D assume ds:seg002 seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E5D call loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span> seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6<span class="hljs-number"><span class="hljs-number">0</span></span> mov ax, pspSeg seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E63 add ax, <span class="hljs-number"><span class="hljs-number">10</span></span>h seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E66 add nextCS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6A add nextSS, ax seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E6E <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, 10</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">h</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E71</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ds</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E73</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">es</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E75</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSS</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E79</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assume</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ss</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nothing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E7B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextSP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E80</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextIP</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cs</span></span></span><span class="hljs-function">:[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">endp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg002</span></span></span><span class="hljs-function">:5</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E83</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E86 nextIP dw <span class="hljs-number"><span class="hljs-number">3</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">38</span></span> o seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E88 nextCS dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">1</span></span>E w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A pspSeg dw <span class="hljs-number"><span class="hljs-number">0</span></span> ; DATA XREF: start w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8A ; start+<span class="hljs-number"><span class="hljs-number">18</span></span> r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C nextSS dw <span class="hljs-number"><span class="hljs-number">1681</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">22</span></span> w seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8C ; start+<span class="hljs-number"><span class="hljs-number">2</span></span>D r seg002:<span class="hljs-number"><span class="hljs-number">5</span></span>E8E nextSP dw <span class="hljs-number"><span class="hljs-number">80</span></span>h ; DATA XREF: start+<span class="hljs-number"><span class="hljs-number">33</span></span> r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  <span class="hljs-number"><span class="hljs-number">100</span></span>h ,     -     <span class="hljs-number"><span class="hljs-number">80</span></span>h ( Pascal-:   - ).  ds  es       PSP,     ds:<span class="hljs-number"><span class="hljs-number">0</span></span>+<span class="hljs-number"><span class="hljs-number">100</span></span>h = (ds+<span class="hljs-number"><span class="hljs-number">10</span></span>h):<span class="hljs-number"><span class="hljs-number">0</span></span>.    ds,  <span class="hljs-number"><span class="hljs-number">7</span></span> (  assume -   ,   )      ds, es,    -  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     , <span class="hljs-string"><span class="hljs-string">""</span></span>   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+<span class="hljs-number"><span class="hljs-number">10</span></span>h),    ,       .  loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>    ,     ;         <span class="hljs-string"><span class="hljs-string">"This program requires an 80286 or higher"</span></span>, <span class="hljs-string"><span class="hljs-string">"This program requires a VGA card"</span></span>, <span class="hljs-string"><span class="hljs-string">"Intro skipped"</span></span>.    : <br> seg002:082F cmp al, <span class="hljs-string"><span class="hljs-string">'/'</span></span> seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:0836 cmp al, <span class="hljs-string"><span class="hljs-string">'N'</span></span> seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al, <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>h seg002:083D cmp al, <span class="hljs-string"><span class="hljs-string">'I'</span></span> seg002:083F jnz short loc_1A08B <br>  ,   loc_1996<span class="hljs-number"><span class="hljs-number">0</span></span>  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe<span class="hljs-string"><span class="hljs-string">'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><a href="http://yadi.sk/d/hbzp4GFz709m7"><span class="hljs-string"><span class="hljs-string">pre2_2.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   diet     </span></span><a href="http://www.exetools.com/unpackers.htm"><span class="hljs-string"><span class="hljs-string">cup386</span></span></a><span class="hljs-string"><span class="hljs-string"> . diet    ,  </span></span><code><span class="hljs-string"><span class="hljs-string">cup386 pre2_2.exe pre2unp.exe /1</span></span></code><span class="hljs-string"><span class="hljs-string">     </span></span><a href="http://yadi.sk/d/htZpsZTG70HaM"><span class="hljs-string"><span class="hljs-string">pre2unp.exe</span></span></a><span class="hljs-string"><span class="hljs-string">  91344 .    ,  pre2unp.exe - ,   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'</span></span>),   0B171h    : <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C3 call sub_19D1E seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>C6 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">3</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CB mov bx, offset aEnterCode ; <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>CE mov word_251D2, 0AF2h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D4 call sub_19AC4 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>D7 mov byte_251D7, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DC mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>DF mov word_251D2, <span class="hljs-number"><span class="hljs-number">12</span></span>C9h seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     <span class="hljs-string"><span class="hljs-string">"ENTER CODE"</span></span>,      <span class="hljs-number"><span class="hljs-number">4</span></span> ,     ;  ,      ,    -  . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>E8 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>ED jnz short loc_19BF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>EF jmp loc_19CF2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 loc_19BF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>A j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F2 cmp byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F7 jnz short loc_19BFC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>F9 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC ; --------------------------------------------------------------------------- ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 loc_19CF2: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">2</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF2 inc word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF6 mov bx, word_251DC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AFA <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bx</span></span></span><span class="hljs-function">, 8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AFE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jb</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locret_19D1D</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B00</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19D06</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B02</span></span></span><span class="hljs-function"> </span></span>; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 loc_19D02: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">36</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B02 inc byte_251DE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 loc_19D06: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">13</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B06 mov bx, offset levelCode ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B09 mov word ptr [bx], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B0D mov word ptr [bx+<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'[['</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B12 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B17 mov word_251D4, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D locret_19D1D: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">42</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D ; sub_19BC3+<span class="hljs-number"><span class="hljs-number">60</span></span> j ... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D retn seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>B1D sub_19BC3 endp   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">1</span></span></code>   <code>word_251DC</code> ,     <span class="hljs-number"><span class="hljs-number">8</span></span>Ch,   <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">0</span></span>,    .      ,             ,     .   <code>byte_251D6 == <span class="hljs-number"><span class="hljs-number">2</span></span></code>    ,   ;   . <br> seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC loc_19BFC: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">34</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">99</span></span>FC mov bl, ScanCode seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0<span class="hljs-number"><span class="hljs-number">0</span></span> test bl, <span class="hljs-number"><span class="hljs-number">80</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A03 jz short loc_19C08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A05 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 loc_19C08: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">40</span></span> j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A08 mov al, KeysPressed+<span class="hljs-number"><span class="hljs-number">39</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0B <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> al, KeysPressed+<span class="hljs-number"><span class="hljs-number">1</span></span>Ch seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A0F jz short loc_19C14 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A11 jmp loc_19D02 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14      <code>seg002:<span class="hljs-number"><span class="hljs-number">2870</span></span></code> .     ( IDA) ,        ,        <span class="hljs-number"><span class="hljs-number">60</span></span>h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (<span class="hljs-number"><span class="hljs-number">0</span></span> =   , 0FFh =  ).    : <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">39</span></span>h]</code>  <code>KeyPressed[<span class="hljs-number"><span class="hljs-number">1</span></span>Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 loc_19C14: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">4</span></span>C j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A14 mov ScanCode, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A19 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bh, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1B mov al, byte ptr a1234567890AEADfCB[bx] ; <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF-----"</span></span>... seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A1F cmp al, <span class="hljs-string"><span class="hljs-string">'-'</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A21 jnz short loc_19C26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A23 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 ; --------------------------------------------------------------------------- seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 loc_19C26: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">5</span></span>E j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A26 mov ah, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A28 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, '0' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2B</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 9 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A2E</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jbe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A30</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ah</span></span></span><span class="hljs-function">, 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19C33</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">6</span></span>B j    .       <span class="hljs-string"><span class="hljs-string">"--1234567890----AE-----------A-DF------------CB-...-"</span></span>,    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- <span class="hljs-string"><span class="hljs-string">'A'</span></span>      A,     Q -  ,       AZERTY).  ASCII-   <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>-,     .  ,       <span class="hljs-number"><span class="hljs-number">0</span></span>  0Fh. <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A33 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A37 mov cl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A39 shl ah, cl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3B shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3D rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A3F shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A41 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A43 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A45 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A47 shl ah, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A49 rcl dx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4B mov word_251E5, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A4F mov bx, word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A53 mov byte ptr levelCode[bx], al ; <span class="hljs-string"><span class="hljs-string">"[[[["</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A57 inc word_251D4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5B inc bl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A5D cmp bl, <span class="hljs-number"><span class="hljs-number">4</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6<span class="hljs-number"><span class="hljs-number">0</span></span> jnb short loc_19C65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A62 jmp locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   <span class="hljs-number"><span class="hljs-number">4</span></span>  ,    ,   .        ,    <code>word_251D4</code>   .    <span class="hljs-number"><span class="hljs-number">4</span></span> ,    .  <span class="hljs-number"><span class="hljs-number">4</span></span>  <code>word_251E5</code>  <span class="hljs-number"><span class="hljs-number">16</span></span>- ,    (<span class="hljs-string"><span class="hljs-string">"1234"</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">1234</span></span>h),      . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 loc_19C65: ; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">9</span></span>D j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A65 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A66 mov word_251DC, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A6C mov di, word_251DF seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7<span class="hljs-number"><span class="hljs-number">0</span></span> mov si, word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A74 mov bp, word_251E3 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A78 mov ax, di seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7A rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7C rol ax, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A7E mul ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A82 mul bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A84 mov bx, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A86 add bx, si seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A88 ror bx, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8A rol bl, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8C <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bl, bh seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A8E <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> bx, bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> bp seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A91 cmp ax, <span class="hljs-number"><span class="hljs-number">36</span></span>C8h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A94 jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A96 cmp bx, <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9A jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>A9C cmp dx, <span class="hljs-number"><span class="hljs-number">8</span></span>E71h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA<span class="hljs-number"><span class="hljs-number">0</span></span> jnz short loc_19CAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA2 mov dx, word_251E5 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA6 dec dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AA7 cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAA jbe short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">15</span></span>h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAC <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> dx, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AAE mov ax, dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB<span class="hljs-number"><span class="hljs-number">0</span></span> call sub_19559 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB3 cmp word_251E5, ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB7 jz short loc_19CD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AB9 inc dx seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABA cmp dx, <span class="hljs-number"><span class="hljs-number">14</span></span>h seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABD jbe short loc_19CAE seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ABF mov si, offset word_251E1 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC2 mov ax, [si] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC4 mov [si-<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AC7 mov ax, [si+<span class="hljs-number"><span class="hljs-number">2</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACA mov [si], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACC mov ax, [si+<span class="hljs-number"><span class="hljs-number">4</span></span>] seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ACF mov [si+<span class="hljs-number"><span class="hljs-number">2</span></span>], ax seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD2 mov byte_251D6, <span class="hljs-number"><span class="hljs-number">1</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD7 jmp short locret_19D1D seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">14</span></span>h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">1</span></span> (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 ; sub_19BC3+F4 j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AD9 mov al, <span class="hljs-number"><span class="hljs-number">0</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADB cmp dl, 0Ah seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>ADE jb short loc_19CE4 seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dl</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ah</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seg001</span></span></span><span class="hljs-function">:9</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AE4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loc_19CE4</span></span></span><span class="hljs-function">: </span></span>; CODE XREF: sub_19BC3+<span class="hljs-number"><span class="hljs-number">11</span></span>B j seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE4 mov byte_1CDB6, dl seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AE8 mov byte_251C3, al seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AEB mov byte_251D6, <span class="hljs-number"><span class="hljs-number">2</span></span> seg001:<span class="hljs-number"><span class="hljs-number">9</span></span>AF<span class="hljs-number"><span class="hljs-number">0</span></span> jmp short locret_19D1D <br>     :  <code>dx</code>  <span class="hljs-number"><span class="hljs-number">10</span></span>,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-<span class="hljs-number"><span class="hljs-number">10</span></span></code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   <span class="hljs-number"><span class="hljs-number">2</span></span>,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    <span class="hljs-number"><span class="hljs-number">10</span></span>h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F00<span class="hljs-number"><span class="hljs-number">0</span></span>:FFF<span class="hljs-number"><span class="hljs-number">0</span></span></a> (  BIOS)   <span class="hljs-number"><span class="hljs-number">80</span></span>h    BIOS    C00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>  F00<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0000</span></span>.      : <br> ; ax = zero-based level seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C6 <span class="hljs-keyword"><span class="hljs-keyword">xor</span></span> ax, <span class="hljs-number"><span class="hljs-number">55</span></span>A3h seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>C9 mul word_2435F seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>CD mov cl, cs:ProcessorType ; always <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span>+ seg001:<span class="hljs-number"><span class="hljs-number">93</span></span>D2 rol ax, cl  <code>sub_19599</code>     (     -  <span class="hljs-number"><span class="hljs-number">386</span></span>+    <span class="hljs-number"><span class="hljs-number">3</span></span>),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    <span class="hljs-string"><span class="hljs-string">""</span></span>    :  ,         ( <span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>-based).   ,    :  <code>dx:ax</code>    <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h,  <code>bx</code>   <span class="hljs-number"><span class="hljs-number">8</span></span>BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h -   <span class="hljs-number"><span class="hljs-number">16</span></span>- :         . <code>bx</code> -       .  <span class="hljs-number"><span class="hljs-number">8</span></span>E7136C8h  ,  <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>*<span class="hljs-number"><span class="hljs-number">4861</span></span>*<span class="hljs-number"><span class="hljs-number">8779</span></span>;    <span class="hljs-number"><span class="hljs-number">16</span></span>- , <span class="hljs-number"><span class="hljs-number">4861</span></span>  <span class="hljs-number"><span class="hljs-number">8779</span></span>     ,    <span class="hljs-number"><span class="hljs-number">2</span></span> <sup><span class="hljs-number"><span class="hljs-number">3</span></span></sup> *<span class="hljs-number"><span class="hljs-number">7</span></span>   -    .     (<span class="hljs-number"><span class="hljs-number">16</span></span>   - <span class="hljs-number"><span class="hljs-number">16</span></span>-).    ;   -  ,  ,     bx,        <span class="hljs-number"><span class="hljs-number">8</span></span>- .   <span class="hljs-number"><span class="hljs-number">16</span></span>-        <span class="hljs-number"><span class="hljs-number">8</span></span>-,       ,  ,         (  <span class="hljs-number"><span class="hljs-number">8</span></span>- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </pre> <code><a href="http://yadi.sk/d/YylxFXWt6zLKW"></a> <a href="http://www.exetools.com/file-analyzers.htm"></a> <a href="http://www.exetools.com/unpackers.htm"></a> <a href="http://yadi.sk/d/KO4d2hAe6zOPJ"></a> echo -ne '\x..\x..' | dd of= seek= bs=1 conv=notrunc   ( conv=notrunc   ). <br> <br>  <br>   ,     old-games.ru: pre2orig.exe  52190 .    (     )  Hybrid,       . <br> <br>  exe'     ,       : exe'       ,     ,           . ,       . File Scanner      LZEXE,      unlzexe.  unlzexe,  pre2_1.exe  63728 . <br> <br>  pre2_1.exe    ,    "INTRO CODED BY CYBER".  : <br> <br> seg002:5E48 start proc near seg002:5E48 mov cs:pspSeg, ds seg002:5E4D mov ax, cs seg002:5E4F mov es, ax seg002:5E51 assume es:seg002 seg002:5E51 mov cx, 20h seg002:5E54 mov si, 80h seg002:5E57 mov di, si seg002:5E59 rep movsb seg002:5E5B mov ds, ax seg002:5E5D assume ds:seg002 seg002:5E5D call loc_19960 seg002:5E60 mov ax, pspSeg seg002:5E63 add ax, 10h seg002:5E66 add nextCS, ax seg002:5E6A add nextSS, ax seg002:5E6E sub ax, 10h seg002:5E71 mov ds, ax seg002:5E73 assume ds:nothing seg002:5E73 mov es, ax seg002:5E75 assume es:nothing seg002:5E75 mov ax, cs:nextSS seg002:5E79 mov ss, ax seg002:5E7B assume ss:nothing seg002:5E7B mov sp, cs:nextSP seg002:5E80 mov bx, offset nextIP seg002:5E83 jmp dword ptr cs:[bx] seg002:5E83 start endp seg002:5E83 seg002:5E83 ; --------------------------------------------------------------------------- seg002:5E86 nextIP dw 3 ; DATA XREF: start+38 o seg002:5E88 nextCS dw 0 ; DATA XREF: start+1E w seg002:5E8A pspSeg dw 0 ; DATA XREF: start w seg002:5E8A ; start+18 r seg002:5E8C nextSS dw 1681h ; DATA XREF: start+22 w seg002:5E8C ; start+2D r seg002:5E8E nextSP dw 80h ; DATA XREF: start+33 r <br> DOS       <a href="http://ru.wikipedia.org/wiki/Program_Segment_Prefix">PSP</a>  100h ,     -     80h ( Pascal-:   - ).  ds  es       PSP,     ds:0+100h = (ds+10h):0.    ds,  7 (  assume -   ,   )      ds, es,    -  loc_19960.      ,     , ""   ,    DOS    : ds  es    PSP, ss:sp   ,        ( pspSeg+10h),    ,       .  loc_19960    ,     ;         "This program requires an 80286 or higher", "This program requires a VGA card", "Intro skipped".    : <br> seg002:082F cmp al, '/' seg002:0831 jnz short loc_1A08A seg002:0833 lodsb seg002:0834 and al, not 20h seg002:0836 cmp al, 'N' seg002:0838 jnz short loc_1A08B seg002:083A lodsb seg002:083B and al, not 20h seg002:083D cmp al, 'I' seg002:083F jnz short loc_1A08B <br>  ,   loc_19960  ,       <code>/ni</code> . , ,           Hybrid      .  ,   seg002 -    ,    exe'.    cs:ip  0000:0003, ss:sp  1681:0080,   5E90h ,         . <br> <br>   <a href="http://yadi.sk/d/hbzp4GFz709m7">pre2_2.exe</a>  39520 .        (   pre2_1.exe     Hybrid),       .   File Scanner  "Diet 1.00,1.20"   .    ,  diet     :     .     (     )   diet, , , ,     diet, ,      ,   ()   . <br> <br>   diet     <a href="http://www.exetools.com/unpackers.htm">cup386</a> . diet    ,  <code>cup386 pre2_2.exe pre2unp.exe /1</code>     <a href="http://yadi.sk/d/htZpsZTG70HaM">pre2unp.exe</a>  91344 .    ,  pre2unp.exe - ,   . <br> <br>   <br> <img src="https://habrastorage.org/storage2/a1c/c1a/eef/a1cc1aeefffda10c7eddd80b2def2a00.png" align="right"> <br>         .  .             (    ;   ,       ).   ,        , ,        .    ,        , ,    (   ,  ,   ,   ).       -     "ENTER CODE",     .       seg002:B171 (IDA       exe'),   0B171h    : <br> seg001:99C3 sub_19BC3 proc near ; DATA XREF: sub_1906F+A1 o seg001:99C3 call sub_19D1E seg001:99C6 mov byte_251D7, 3 seg001:99CB mov bx, offset aEnterCode ; "ENTER CODE" seg001:99CE mov word_251D2, 0AF2h seg001:99D4 call sub_19AC4 seg001:99D7 mov byte_251D7, 4 seg001:99DC mov bx, offset levelCode ; "[[[[" seg001:99DF mov word_251D2, 12C9h seg001:99E5 call sub_19AC4    <code>sub_19D1E</code> .          <code>sub_19AC4</code> ,     "ENTER CODE",      4 ,     ;  ,      ,    -  . <br> seg001:99E8 cmp byte_251D6, 1 seg001:99ED jnz short loc_19BF2 seg001:99EF jmp loc_19CF2 seg001:99F2 ; --------------------------------------------------------------------------- seg001:99F2 seg001:99F2 loc_19BF2: ; CODE XREF: sub_19BC3+2A j seg001:99F2 cmp byte_251D6, 2 seg001:99F7 jnz short loc_19BFC seg001:99F9 jmp loc_19D02 seg001:99FC ; --------------------------------------------------------------------------- ... seg001:9AF2 ; --------------------------------------------------------------------------- seg001:9AF2 seg001:9AF2 loc_19CF2: ; CODE XREF: sub_19BC3+2C j seg001:9AF2 inc word_251DC seg001:9AF6 mov bx, word_251DC seg001:9AFA sub bx, 8Ch seg001:9AFE jb short locret_19D1D seg001:9B00 jmp short loc_19D06 seg001:9B02 ; --------------------------------------------------------------------------- seg001:9B02 seg001:9B02 loc_19D02: ; CODE XREF: sub_19BC3+36 j seg001:9B02 ; sub_19BC3+4E j seg001:9B02 inc byte_251DE seg001:9B06 seg001:9B06 loc_19D06: ; CODE XREF: sub_19BC3+13D j seg001:9B06 mov bx, offset levelCode ; "[[[[" seg001:9B09 mov word ptr [bx], '[[' seg001:9B0D mov word ptr [bx+2], '[[' seg001:9B12 mov byte_251D6, 0 seg001:9B17 mov word_251D4, 0 seg001:9B1D seg001:9B1D locret_19D1D: ; CODE XREF: sub_19BC3+42 j seg001:9B1D ; sub_19BC3+60 j ... seg001:9B1D retn seg001:9B1D sub_19BC3 endp   <code>byte_251D6 == 1</code>   <code>word_251DC</code> ,     8Ch,   <code>byte_251D6</code>   0,    .      ,             ,     .   <code>byte_251D6 == 2</code>    ,   ;   . <br> seg001:99FC seg001:99FC loc_19BFC: ; CODE XREF: sub_19BC3+34 j seg001:99FC mov bl, ScanCode seg001:9A00 test bl, 80h seg001:9A03 jz short loc_19C08 seg001:9A05 jmp locret_19D1D seg001:9A08 ; --------------------------------------------------------------------------- seg001:9A08 seg001:9A08 loc_19C08: ; CODE XREF: sub_19BC3+40 j seg001:9A08 mov al, KeysPressed+39h seg001:9A0B or al, KeysPressed+1Ch seg001:9A0F jz short loc_19C14 seg001:9A11 jmp loc_19D02 seg001:9A14 ; --------------------------------------------------------------------------- seg001:9A14      <code>seg002:2870</code> .     ( IDA) ,        ,        60h.  ,    -    ,    -   ;    <code>ScanCode</code> .     ,      :  <code>KeyPressed</code> (   )    (0 =   , 0FFh =  ).    : <code>KeyPressed[39h]</code>  <code>KeyPressed[1Ch]</code> -    Enter .     Enter (  )          ,   ,   . <br> seg001:9A14 loc_19C14: ; CODE XREF: sub_19BC3+4C j seg001:9A14 mov ScanCode, 0 seg001:9A19 xor bh, bh seg001:9A1B mov al, byte ptr a1234567890AEADfCB[bx] ; "--1234567890----AE-----------A-DF-----"... seg001:9A1F cmp al, '-' seg001:9A21 jnz short loc_19C26 seg001:9A23 jmp locret_19D1D seg001:9A26 ; --------------------------------------------------------------------------- seg001:9A26 seg001:9A26 loc_19C26: ; CODE XREF: sub_19BC3+5E j seg001:9A26 mov ah, al seg001:9A28 sub ah, '0' seg001:9A2B cmp ah, 9 seg001:9A2E jbe short loc_19C33 seg001:9A30 sub ah, 7 seg001:9A33 seg001:9A33 loc_19C33: ; CODE XREF: sub_19BC3+6B j    .       "--1234567890----AE-----------A-DF------------CB-...-",    ASCII- (  <a href="http://www.computer-engineering.org/ps2keyboard/scancodes1.html"> </a> , ,  ASCII- 'A'      A,     Q -  ,       AZERTY).  ASCII-   hex-,     .  ,       0  0Fh. <br> seg001:9A33 mov dx, word_251E5 seg001:9A37 mov cl, 4 seg001:9A39 shl ah, cl seg001:9A3B shl ah, 1 seg001:9A3D rcl dx, 1 seg001:9A3F shl ah, 1 seg001:9A41 rcl dx, 1 seg001:9A43 shl ah, 1 seg001:9A45 rcl dx, 1 seg001:9A47 shl ah, 1 seg001:9A49 rcl dx, 1 seg001:9A4B mov word_251E5, dx seg001:9A4F mov bx, word_251D4 seg001:9A53 mov byte ptr levelCode[bx], al ; "[[[[" seg001:9A57 inc word_251D4 seg001:9A5B inc bl seg001:9A5D cmp bl, 4 seg001:9A60 jnb short loc_19C65 seg001:9A62 jmp locret_19D1D seg001:9A65 ; ---------------------------------------------------------------------------  <code>word_251E5</code>   4  ,    ,   .        ,    <code>word_251D4</code>   .    4 ,    .  4  <code>word_251E5</code>  16- ,    ("1234" -&gt; 1234h),      . <br> seg001:9A65 seg001:9A65 loc_19C65: ; CODE XREF: sub_19BC3+9D j seg001:9A65 push bp seg001:9A66 mov word_251DC, 0 seg001:9A6C mov di, word_251DF seg001:9A70 mov si, word_251E1 seg001:9A74 mov bp, word_251E3 seg001:9A78 mov ax, di seg001:9A7A rol ax, 1 seg001:9A7C rol ax, 1 seg001:9A7E mul ah seg001:9A80 xor ax, si seg001:9A82 mul bp seg001:9A84 mov bx, ax seg001:9A86 add bx, si seg001:9A88 ror bx, 1 seg001:9A8A rol bl, 1 seg001:9A8C xor bl, bh seg001:9A8E xor bx, bp seg001:9A90 pop bp seg001:9A91 cmp ax, 36C8h seg001:9A94 jnz short loc_19CAC seg001:9A96 cmp bx, 8BD1h seg001:9A9A jnz short loc_19CAC seg001:9A9C cmp dx, 8E71h seg001:9AA0 jnz short loc_19CAC seg001:9AA2 mov dx, word_251E5 seg001:9AA6 dec dx seg001:9AA7 cmp dx, 14h seg001:9AAA jbe short loc_19CD9 seg001:9AAC seg001:9AAC loc_19CAC: ; CODE XREF: sub_19BC3+D1 j seg001:9AAC ; sub_19BC3+D7 j ...   <code>word_251DC</code>   .      ,      <code>word_251E5</code> ,             1  15h ,     <code>loc_19CD9</code>  <code>dx</code> ,     .   ,     . <br> seg001:9AAC xor dx, dx seg001:9AAE seg001:9AAE loc_19CAE: ; CODE XREF: sub_19BC3+FA j seg001:9AAE mov ax, dx seg001:9AB0 call sub_19559 seg001:9AB3 cmp word_251E5, ax seg001:9AB7 jz short loc_19CD9 seg001:9AB9 inc dx seg001:9ABA cmp dx, 14h seg001:9ABD jbe short loc_19CAE seg001:9ABF mov si, offset word_251E1 seg001:9AC2 mov ax, [si] seg001:9AC4 mov [si-2], ax seg001:9AC7 mov ax, [si+2] seg001:9ACA mov [si], ax seg001:9ACC mov ax, [si+4] seg001:9ACF mov [si+2], ax seg001:9AD2 mov byte_251D6, 1 seg001:9AD7 jmp short locret_19D1D seg001:9AD9 ; ---------------------------------------------------------------------------  . <code>word_251E5</code>       <code>sub_19559</code> ,    <code>dx</code>  0  14h.       <code>loc_19CD9</code>  <code>dx</code> ,   <code>sub_19559</code>   . ,  <code>sub_19559</code>    . <br> <br>   ,  <code>byte_251D6</code>   1 (   ,    ),            .      ,   ,    ;  ,       . <br> seg001:9AD9 seg001:9AD9 loc_19CD9: ; CODE XREF: sub_19BC3+E7 j seg001:9AD9 ; sub_19BC3+F4 j seg001:9AD9 mov al, 0 seg001:9ADB cmp dl, 0Ah seg001:9ADE jb short loc_19CE4 seg001:9AE0 sub dl, 0Ah seg001:9AE3 inc ax seg001:9AE4 seg001:9AE4 loc_19CE4: ; CODE XREF: sub_19BC3+11B j seg001:9AE4 mov byte_1CDB6, dl seg001:9AE8 mov byte_251C3, al seg001:9AEB mov byte_251D6, 2 seg001:9AF0 jmp short locret_19D1D <br>     :  <code>dx</code>  10,      <code>byte_1CDB6</code> ,  <code>byte_251C3</code>  ;   <code>byte_1CDB6</code>  <code>dx-10</code> ,  <code>byte_251C3</code>  .    <code>byte_251D6</code>   2,    . <br> <br>    ,   ,  <code>sub_19599</code> , / ,    .    :    <code>word_2435F</code>    10h  BIOS <a href="http://www.about-pc.narod.ru/part5/bios2.html">F000:FFF0</a> (  BIOS)   80h    BIOS    C000:0000  F000:0000.      : <br> ; ax = zero-based level seg001:93C6 xor ax, 55A3h seg001:93C9 mul word_2435F seg001:93CD mov cl, cs:ProcessorType ; always 3 for 386+ seg001:93D2 rol ax, cl  <code>sub_19599</code>     (     -  386+    3),       ,     : <a href="http://yadi.sk/d/few6G1L972UfS">genpass.asm</a> , <a href="http://yadi.sk/d/0l5mlXpW72Uhc">genpass.com</a> . <br> <br>    ""    :  ,         ( hex  1-based).   ,    :  <code>dx:ax</code>    8E7136C8h,  <code>bx</code>   8BD1h.  ,  , ,  <code>dx:ax</code>     <code>mul bp</code>  8E7136C8h -   16- :         . <code>bx</code> -       .  8E7136C8h  ,  2 <sup>3</sup> *7*4861*8779;    16- , 4861  8779     ,    2 <sup>3</sup> *7   -    .     (16   - 16-).    ;   -  ,  ,     bx,        8- .   16-        8-,       ,  ,         (  8- ).  : <a href="http://yadi.sk/d/ceMXWKyp72WFc">getmagic.c</a> , : ADDE C0DE F00D  DEAD C0DE F00D.</code> </div><p>Source: <a href="https://habr.com/ru/post/187072/">https://habr.com/ru/post/187072/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../187054/index.html">Confidence in the certificates of the MEP or ‚ÄúVasya's dad is strong in mathematics‚Äù</a></li>
<li><a href="../187056/index.html">Month with 3Q RC9730C tablet</a></li>
<li><a href="../187058/index.html">Review Board + Mercurial - experience in implementing and automating the process code review</a></li>
<li><a href="../187062/index.html">About it</a></li>
<li><a href="../187070/index.html">Help is needed to work on a new web-series about IT people</a></li>
<li><a href="../187074/index.html">Localization ISO / IEC 14977: 1996 (E) (Extended BNF)</a></li>
<li><a href="../187076/index.html">Image as an information unit</a></li>
<li><a href="../187078/index.html">Continuing to Spam Protection with Cisco IronPort c170</a></li>
<li><a href="../187080/index.html">Corporate Utopia Communication Environment</a></li>
<li><a href="../187086/index.html">Nokia Asha 210 Stylish Budget Book Review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>