<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Features of mobile applications on the iOS platform, using the login and password of clients to access paid content</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mobile application developers are often faced with the need to store sensitive user data on a user device. This can be, for example, a credit card num...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Features of mobile applications on the iOS platform, using the login and password of clients to access paid content</h1><div class="post__text post__text-html js-mediator-article">  Mobile application developers are often faced with the need to store sensitive user data on a user device.  This can be, for example, a credit card number or authentication data.  In this article we will talk about typical implementation errors of storing confidential data from the point of view of information security using the example of the iOS mobile platform. <br>  Usually, application settings are stored in configuration files.  The Cocoa Touch library, used when developing applications for the iOS mobile platform, provides an abstraction layer for storing application settings in the NSUserDefaults class.  The NSUserDefaults class implements the ‚ÄúSingleton‚Äù design pattern (better known as Singleton), which is unloved by many, providing access to the interface above the standard application configuration file. <br>  The standard application configuration file is located in its home directory at the relative address Library / Preferences / &lt;your.company.name&gt;. &lt;App.name&gt; .plist.  Like other files located in the sandbox, it is not readable for other user-level applications.  Exceptions are devices subject to system security policy modifications (jailbroken devices). <br>  Many developers have appreciated the convenience of working with the NSUserDefaults class.  An overwhelming number of applications use it to store internal settings and / or user settings.  Unfortunately, usability rarely correlates with safety.  Storing confidential user data in a standard settings file is a typical mistake of developers, resulting in leakage of user information. <br>  As a result of examining the source code of Appendix A for errors in the context of information security, it was revealed that the application stores user authentication data in the configuration settings file.  Having downloaded Application A on the iPad under the control of the original iOS operating system version 6.1.3, we went through the authentication stage and began studying the application settings file. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b2/c3a/c79/8b2c3ac79b5c34eb8745426140af79dd.png" alt="image"><br>  <b>Fig.</b>  <b>1. Download the application on iPad</b> <br><a name="habracut"></a><br>  To demonstrate the vulnerability, we used the iExplorer application, available for the operating systems of the Windows NT and Mac OS X families. The iExplorer application is a graphical file manager for iOS devices.  Find Application A in the list of installed applications and open Library / Preferences / &lt;settings-name&gt; .plist for reading. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c59/073/6df/c590736dfa76cd3719483f54b2b8ddfc.png" alt="image"><br>  <b>Fig.</b>  <b>2. Appearance of the iExplorer application with access to the required file</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/a6e/0d4/be8/a6e0d4be8d48536570aeb2f69a45d26f.png" alt="image"><br>  <b>Fig.</b>  <b>3. Confidential file configuration file</b> <br><br>  It is quite obvious that the same actions could be performed by an attacker with the aim of unauthorized access to confidential information.  Moreover, the process of extracting the application settings file can be automated in malicious applications running on the user's computer or on jailbroken devices. <br>  Consider another example of incorrect use of the standard application configuration file.  As a result of the study of the source codes of another application, say, Annex B, it was revealed that the user authentication data is stored in an encrypted configuration file.  The data is encrypted using the composition of the AES256 symmetric encryption algorithm with a permanent key of the Base64 encoding algorithm. <br>  At first glance, this approach may seem quite reasonable.  It seems that the interception of encrypted information by the attacker will do little.  However, in fact, the attacker, there are at least two ways to use the data. <br>  1. Substitution of the configuration file.  By making a substitution of the configuration file, an attacker gets partial or full access to the user's confidential data. <br>  2. Recognize the encryption algorithm and extract the key. <br>  If in the first case the lack of the algorithm used is obvious, then in the second case it is required to estimate the complexity of such a hacking.  Install Application B on a device running the iOS operating system and upload the application image.  Since the application image is usually partially or fully encrypted, it must first be decrypted.  Using the debugger, we unload the image of the application from memory and edit the binary image of the application, replacing the decrypted segments.  A detailed description of this process is beyond the scope of the article; we only mention that there are means for automatically decrypting binary images of applications in the Mach-O format. <br>  The next step is to disassemble the binary image of the application.  To do this, we use the interactive disassembler IDA Pro.  Let's try to look for the string password in the __cfstring section and ask the disassembler to show cross-references. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/860/331/df0/860331df0f18bcd2b6a98a591fe060a9.png" alt="image"><br>  <b>Fig.</b>  <b>4. Work with IDA Pro disassembler</b> <br><br>  Go to the subroutine - [Preferences setPassword:].  IDA Pro did not fail here either: it did all the work for us. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/edd/7b5/40c/edd7b540cd535b83871932075b959374.png" alt="image"><br>  <b>Fig.</b>  <b>5. Binary image assembler</b> <br><br>  You don't need to be an ARM architecture guru to understand what's going on here.  At offset 0x0000DDCC, the user's password is encoded with Base64, and at offset 0x0000DDE6, AES256 is encrypted with the TheSuperSecretKey key (in the real application, another encryption key was used). <br>  So, the encryption algorithm together with the key can be compromised by an attacker even with a not very high level of skill in less than 10 minutes.  With this knowledge, an attacker can gain unauthorized access to confidential user information and automate the process of collecting user data. <br>  Recommendations for addressing such vulnerabilities may include the following: <br><ul><li>  Use Key Chains to store sensitive data.  Different levels of access can be applied to keychain items, and they can be protected from being transferred to another device. </li><li>  Use encryption on keychain items.  On devices that have been granted unauthorized privileged access, an attacker can view all keychain items.  To do this, it is enough to create an application with access to all groups of access to the keychain or to the group com.apple.keystore.access-keychain-keys. </li><li>  Use dynamic encryption key generation algorithms unique to each user. </li><li>  Write protections in a pure C language. Consider using embedded functions or use macros. </li><li>  Do not store sensitive data on the user device. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/218007/">https://habr.com/ru/post/218007/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../217993/index.html">We are waiting for the summer webinars from Alexey Kibkalo</a></li>
<li><a href="../217995/index.html">Science fiction technology: light engines and systems (Star Trek)</a></li>
<li><a href="../217997/index.html">Learn BlackBerry 10 App Development is available for free download.</a></li>
<li><a href="../218001/index.html">Part 4.1 We return the sight. From points to the excimer laser</a></li>
<li><a href="../218003/index.html">How to handle terabytes of data in 1000 streams in PHP - Hadoop / MapReduce</a></li>
<li><a href="../218009/index.html">New Nimbus Clipper, as well as passwords for public notes</a></li>
<li><a href="../218011/index.html">Impressions of the Human-Computer Interaction course on Coursera</a></li>
<li><a href="../218013/index.html">What can be done with ITEAD IBOX. Part 1</a></li>
<li><a href="../218015/index.html">Space exit 23: conquering the new frontier</a></li>
<li><a href="../218019/index.html">A couple of words about Epson Moverio BT-200</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>