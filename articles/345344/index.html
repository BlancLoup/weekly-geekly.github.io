<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sending a request to the specified MS SQL Server databases of all the specified servers using available tools</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Write this article I was prompted by a note respected jobgemws " Sending a request to all databases of all these servers on the example of MS SQL Serv...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sending a request to the specified MS SQL Server databases of all the specified servers using available tools</h1><div class="post__text post__text-html js-mediator-article">  Write this article I was prompted by a note respected <a href="https://habrahabr.ru/users/jobgemws/" class="user_link">jobgemws</a> " <a href="https://habrahabr.ru/post/338828/">Sending a request to all databases of all these servers on the example of MS SQL Server and C #. NET</a> " <br><br>  I will tell you how a similar task can be solved with the standard MSSQLSERVER tools, namely SSMS (or, for management extremes - sqlcmd), quickly, without programming, with the help of a tiny life hack. <br><br>  So, in our organization there are several dozens of different types of MSSQLSERVER, different editions.  Express prevails, but this is not important.  The infrastructure is old, entirely inherited, and ‚Äúpiecewise-continuous‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The task: ‚Äúrun the same query / package on several servers in several databases‚Äù, we have, as they say, ‚Äúrarely happens, but often it happens‚Äù. <br><br>  And the fact that this ‚Äúrarely happens‚Äù does not allow to invent a worthy justification for purchasing or writing full-fledged software for centralized administration of the entire zoo, and what ‚Äúoften happens‚Äù happens sometimes requires an instant decision in the style of ‚Äú5 seconds before the explosion‚Äù. <br><br>  But all this is a lyrical digression, a disclaimer and all that. <br><a name="habracut"></a><br>  What do we need to run the script on multiple servers, in many different databases?  In addition to the script itself, of course, which lies with us, well, at least on the desktop: "C: \ Users \ usr_root \ Desktop \ check_version.sql". <br><br>  The script can be absolutely anything, generated, or written by hand, so I don‚Äôt give it here.  However, you need to keep in mind that Use [database] should be removed from it. <br><br>  So, we will need: <br><br>  1. Privileges allowing to connect to the server and execute this script.  Who said sysadmin? <br><br>  2. The list of servers with databases in which you are going to run the script <br>  The list is, of course, better stored in a table somewhere on the server, but I usually get around with the table designer. <br><br>  Well, of course, it goes without saying that it is better that the connection to the servers would be carried out in Windows mode, which will make it possible for the privileged users not to show passwords to random eyes. <br><br>  3. SSMS, at the initial stage, to create a script to run on other servers. <br><br>  4. SSMS or sqlcmd to execute it. <br><br>  Let's get started <br><br>  1. Run the following script on any server instance: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> N<span class="hljs-string"><span class="hljs-string">' :connect '</span></span> + t.[<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>] + <span class="hljs-keyword"><span class="hljs-keyword">isNull</span></span>(N<span class="hljs-string"><span class="hljs-string">' -U '</span></span> + t.[<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>] + N<span class="hljs-string"><span class="hljs-string">' -P '</span></span> + t.[pwd],N<span class="hljs-string"><span class="hljs-string">''</span></span>) + N<span class="hljs-string"><span class="hljs-string">' Use '</span></span> + t.base + N<span class="hljs-string"><span class="hljs-string">' GO :r "C:\Users\usr_root\Desktop\check_version.sql" GO '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">From</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">Values</span></span> (N<span class="hljs-string"><span class="hljs-string">'dbt0300'</span></span>,N<span class="hljs-string"><span class="hljs-string">'5.144.18.12'</span></span>, N<span class="hljs-string"><span class="hljs-string">'sa'</span></span>, N<span class="hljs-string"><span class="hljs-string">'pwd@'</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt1100'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S01100s0'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt1200'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S01200s11'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">'-'</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt1300'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S01300'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt1800'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S01800'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt2300'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S02300'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt2800'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S02800'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt2900_1'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S02900-backup'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt3000'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S03000-2'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt3400'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S03400_tds'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt3600'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S03600_s1'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt3700_1'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S03700-s1'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt3900'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S03900s1'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt4100'</span></span>,N<span class="hljs-string"><span class="hljs-string">'s04100s2'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt4900'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S04900s0'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt5600'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S05600v'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt5700_release'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S05700v'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt6100'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S06100s1'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt6200'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S06200-1'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt6500'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S06500'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt6501'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S06500-2'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt6600'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S06600-1'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt7400'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S07400-01'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt6700'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S06700-bd01'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt7000_0'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S07000-01'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt7200'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S07200-02'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt7700'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S07710-01'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt8600'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S08600-s1'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt8700'</span></span>,N<span class="hljs-string"><span class="hljs-string">'8.12.36.11'</span></span>,N<span class="hljs-string"><span class="hljs-string">'sa'</span></span>, N<span class="hljs-string"><span class="hljs-string">'sapwd'</span></span> ,<span class="hljs-string"><span class="hljs-string">''</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt8900'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S08950s3'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">'- '</span></span>), (N<span class="hljs-string"><span class="hljs-string">'dbt5000_zzz'</span></span>,N<span class="hljs-string"><span class="hljs-string">'S09700s1'</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>,<span class="hljs-string"><span class="hljs-string">' '</span></span>)) t(base, [<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>], [<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>], [pwd], [<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">xml</span></span> <span class="hljs-keyword"><span class="hljs-keyword">path</span></span>(N<span class="hljs-string"><span class="hljs-string">''</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">type</span></span></code> </pre> <br>  2. Click on the result of the execution <br><br><img src="https://habrastorage.org/webt/v6/1t/ug/v61tugpf-3alwrhyztgp0gmawle.jpeg"><br><br>  3. In the window that opens, do Ctrl + A, Ctrl + C. <br><br>  4. Open the new request window, make Ctrl + V. <br><br>  5. In the Query SSMS menu item, select ‚ÄúSQLCMD mode‚Äù.  The script will immediately turn into cheerful gray tones, which means that the sqlcmd commands are recognized: <br><br><img src="https://habrastorage.org/webt/ci/bm/g2/cibmg2in4q_zs7c8m3y4fm20ipq.jpeg"><br><br>  6. Voila!  You can run.  The script will be executed alternately on several servers, without registration and sms ... uh ... sorry, without C #, PowerShell and other wonders, which usually have neither time, nor ... no, well, there is a desire.  Just laziness. <br><br><div class="spoiler">  <b class="spoiler_title">What script was the result of (+)</b> <div class="spoiler_text"><pre> <code class="sql hljs">:connect 5.144.18.12 -U sa -P pwd@ <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt0300 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S01100s0 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt1100 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S01200s11 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt1200 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S01300 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt1300 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S01800 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt1800 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S02300 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt2300 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S02800 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt2800 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S02900-<span class="hljs-keyword"><span class="hljs-keyword">backup</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt2900_1 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S03000<span class="hljs-number"><span class="hljs-number">-2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt3000 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S03400_tds <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt3400 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S03600_s1 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt3600 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S03700-s1 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt3700_1 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S03900s1 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt3900 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> s04100s2 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt4100 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S04900s0 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt4900 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S05600v <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt5600 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S05700v <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt5700_release <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S06100s1 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt6100 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S06200<span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt6200 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S06500 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt6500 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S06500<span class="hljs-number"><span class="hljs-number">-2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt6501 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S06600<span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt6600 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S07400<span class="hljs-number"><span class="hljs-number">-01</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt7400 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S06700-bd01 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt6700 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S07000<span class="hljs-number"><span class="hljs-number">-01</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt7000_0 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S07200<span class="hljs-number"><span class="hljs-number">-02</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt7200 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S07710<span class="hljs-number"><span class="hljs-number">-01</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt7700 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S08600-s1 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt8600 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> <span class="hljs-number"><span class="hljs-number">8.12</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.11</span></span> -U sa -P sapwd <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt8700 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S08950s3 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt8900 <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> S09700s1 <span class="hljs-keyword"><span class="hljs-keyword">Use</span></span> dbt5000_zzz <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> :r <span class="hljs-string"><span class="hljs-string">"C:\Users\usr_root\Desktop\check_version.sql"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span></code> </pre></div></div><br>  Additionally, I want to say that if the script selects some data, generating (possibly several) resulting data sets, then they, as usual, will appear in the ‚Äúbasement for data‚Äù SSMS query window, from where you can get something like ssmsbooster which, for some time, unfortunately, has become severely paid. <br><br>  Well, or just change the display mode of the result to ‚ÄúResult to Text‚Äù or ‚ÄúResult to File‚Äù and then parse the resulting text with delimiters with something like Excel. <br><br>  However, you can use the command: out &lt;filename&gt;, which can also be written into the script, along with: connect and: r <br><br>  That is, in fact, all the magic. <br><br>  The disadvantages of the method include the fact that scripts are executed on servers sequentially, but, since  this life hack is rather related to the category of improvised means ‚Äî this is hardly important. <br><br>  Well, links on the topic: <br><br>  ‚Üí <a href="https://docs.microsoft.com/en-us/sql/relational-databases/scripting/edit-sqlcmd-scripts-with-query-editor">Edit SQLCMD Scripts with Query Editor</a> <br>  ‚Üí <a href="http://www.sqlservercentral.com/articles/SQLCMD/98211/">An SQLCMD Mode in SSMS</a> <br>  ‚Üí <a href="https://www.mssqltips.com/sqlservertip/2311/using-the-ssms-query-editor-in-sqlcmd-mode/">Using the SSMS Query Editor in SQLCMD Mode</a> </div><p>Source: <a href="https://habr.com/ru/post/345344/">https://habr.com/ru/post/345344/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345330/index.html">Using Roslyn to edit game content</a></li>
<li><a href="../345332/index.html">Kubernetes Service Writing Guide</a></li>
<li><a href="../345336/index.html">We spread the application in the App Store. Even if you are not a developer</a></li>
<li><a href="../345340/index.html">A story about how to create a repository and understand Redux</a></li>
<li><a href="../345342/index.html">What are dangerous social networks on your PC?</a></li>
<li><a href="../345346/index.html">Nebraska problem</a></li>
<li><a href="../345348/index.html">Adapting RoboVM for compiling for iOS from Windows / Linux</a></li>
<li><a href="../345350/index.html">Adding 3D objects to video</a></li>
<li><a href="../345356/index.html">Universal Dumper / Injector Unity3D (Mono, Android)</a></li>
<li><a href="../345358/index.html">Creating a Christmas animation with Wolfram Language</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>