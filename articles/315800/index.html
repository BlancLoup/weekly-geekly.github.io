<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Search for sound anomalies</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Let's try to solve the problem of finding anomalies in the sound. 
 Microphones, for the time being, are some of the most common universal detectors. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Search for sound anomalies</h1><div class="post__text post__text-html js-mediator-article"><p>  Let's try to solve the problem of finding anomalies in the sound. <br>  Microphones, for the time being, are some of the most common universal detectors.  They are small, cheap, reliable.  And they are by default present in cell phones.  They can be used almost everywhere.  Therefore, the task of sound processing, not just speech, is right before us.  This is a classic example of Low hanging fruit - "low hanging fruit."  :) </p><br><h4 id="primery-anomaliy-zvuka">  Examples of sound anomalies: </h4><br><ul><li>  Malfunctions in the engine. </li><li>  Changes in the weather: rain, hail, wind. </li><li>  Anomalies work of the heart, stomach, joints. </li><li>  Unusual traffic on the road. </li><li>  Trouble wheelset at the train. </li><li>  Faults during landing and takeoff of the aircraft. </li><li>  Anomalies of fluid flow in the pipe, in the channel. </li><li>  Anomalies of air movement in air conditioning systems, on the wing of the aircraft. </li><li>  Malfunction of the car, bike. </li><li>  Faults machine, equipment. </li><li>  Frustrated musical instrument. </li><li>  Incorrectly taken notes of the song. </li><li>  Echolocation of ships and submarines. <br><a name="habracut"></a></li></ul><br><h4 id="rassmotrenie-zadachi">  Task review </h4><br><h5 id="vhodnye-dannye">  Input data </h5><br><p>  The sound is a time sequence.  In its simplest form, this is <strong>the signal amplitude</strong> along the time axis. <br><img src="https://upload.wikimedia.org/wikipedia/commons/8/8e/Analyse_thermo_gravimetrique_bruit.png" alt="image">  The signal can be converted to a spectral region.  Then the signal will be a <strong>frequency spectrum</strong> that varies over time.  The sound is a continuous stream of data.  This is very important, since we cannot look at the data [far] ahead of time and then build or adjust our algorithm. </p><br><p>  In addition, the signal may change over time, and these changes will no longer be anomalies.  It is desirable that the system itself adapts to signal changes so that it does not consider repeated signal changes as anomalies.  In general, our task extends to any <strong>time sequence</strong> , not only the sound. </p><br><h5 id="supervised-or-unsupervised">  Supervised or unsupervised? </h5><br><p>  In one case, we process the signal without any a priori knowledge of which anomalies are possible.  Deviation of behavior from the usual is considered an anomaly.  These are <strong>unsupervised</strong> models. </p><br><p>  In another case, we know what anomalies might look like.  We have samples of sound anomalies.  We use these patterns in anomaly search algorithms.  These are <strong>supervised</strong> models. </p><br><h5 id="vyhodnye-dannye-i-prinyatie-resheniy">  Imprint and Decision Making </h5><br><p>  In the simplest case, we will only detect the fact of the anomaly with reference to time.  In a more complicated case, we will still classify anomalies.  For example, the anomaly may be weak, strong or catastrophic.  We can only determine the time of the beginning of the anomaly, or determine the time window from the beginning to the completion of the anomaly. </p><br><h4 id="metody-resheniya">  Solution Methods </h4><br><h5 id="obzor-metodov">  Method overview </h5><br><p>  Methods for detecting anomalies in sound belong to a subclass of <a href="https://en.wikipedia.org/wiki/Anomaly_detection">methods for detecting anomalies</a> .  The difference is that the input data, sound, is fed in a continuous stream. </p><br><p>  The simplest methods are <strong>signal change detectors</strong> .  The threshold detector responds to changes in signal amplitude or changes in the spectrum.  Such methods are very simple and in many cases the most reliable.  They work in conditions where the input signal is stable and its behavior does not change in time.  Any change is considered an anomaly. </p><br><p>  The following group of methods relates to <a href="https://en.wikipedia.org/wiki/Signal_processing">signal processing techniques</a> .  These methods are deeply studied in radio signal processing.  For example, give radars and mobile communications.  Methods work great when we know what we are looking for.  We must know in advance the sound or spectrum of the anomaly.  Signal processing techniques have the most powerful filtering apparatus for the desired signals.  It is not entirely clear how we use these methods to look for anomalies. </p><br><p>  And the last group of methods is <a href="https://en.wikipedia.org/wiki/Machine_learning">Machine Learning</a> methods.  It includes both classical methods, for example, linear regression or classification methods, as well as the latest neural networks.  Machine learning methods are good where the system has to adapt to the different behavior of the input signals.  The input signal can vary in rather complex dependencies, and methods are trained along the way and adjusted to these dependencies.  Any patterns of the signal are not considered anomalies.  It is difficult and sometimes impossible to program something like this using conventional methods, because we will have to manually adjust our system to change the signal.  The methods of Machine Learning do not require manual adjustment, they are trained on the available data.  The main problem with Machine Learning methods is that the input data, time sequences, are fed in a continuous stream.  Specialized models have been developed for such data.  As an example, you can specify <a href="https://en.wikipedia.org/wiki/Recurrent_neural_network">recurrent neural networks</a> (RNN).  One of his successful descriptions can be read <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">here</a> . </p><br><h5 id="primery-realizacii">  Implementation examples </h5><br><p>  I will first conduct a brief study of the available examples, in order to choose the most suitable for my task. </p><br><p>  Data preparation: KDNuggets has a good example of using <a href="http://www.kdnuggets.com/2015/12/anomaly-detection-predictive-maintenance-time-series-analysis.html">spectral sequence</a> . </p><br><p>  Now I will try to look for code samples. </p><br><p>  <a href="https://datamarket.azure.com/dataset/aml_labs/anomalydetection">Microsoft Anomaly Detection Service</a> is one of the easiest services.  Unfortunately, it cannot be fed a continuous stream of data.  Its <a href="https://docs.microsoft.com/en-us/azure/machine-learning/machine-learning-apps-anomaly-detection">documentation is</a> quite simple and describes in detail typical anomalies in temporal sequences. </p><br><p>  Numenta has created a <a href="https://github.com/numenta/NAB">test platform</a> for testing systems and algorithms for detecting anomalies in temporal sequences.  <a href="http://numenta.com/">Numenta</a> is a very interesting company engaged in Machine Learning algorithms and trying to get closer to understanding how the brain works.  I recommend to those interested to watch fascinating videos, in particular the report on the detection of anomalies.  Numenta algorithms are very well suited for our task.  Numenta in the lead on the test site.  Unfortunately, their implementation is quite complicated.  A couple of algorithms, presented in <a href="https://github.com/smirmik/CAD">second</a> and <a href="https://github.com/numenta/NAB/tree/master/nab/detectors/knncad">third</a> place (as of November 2016), are not far behind Numenta, but much easier to implement. <br>  On GitHub you can find a lot of Open Source systems, in particular the system from <a href="https://blog.twitter.com/2015/introducing-practical-and-robust-anomaly-detection-in-a-time-series">Twitter</a> . </p><br><p>  If we turn to the theory of the detection of anomalies using the classical Machine Learning, then one of the most popular and complete sources of information on this topic is the <a href="http://scikit-learn.org/stable/modules/outlier_detection.html">scikit-learn</a> project. </p><br><p>  Azure Machine Learning has <a href="https://gallery.cortanaintelligence.com/browse%3Fs%3Danomaly">many examples of implementations</a> .  Naturally, we will have to use Microsoft Azure ML.  You can experiment and build models for free, but then you have to pay for hosting models on Azure servers.  What could be a plus, and maybe a minus. </p><br><p>  Microsoft developed one of the best packages on neural networks, <a href="https://www.microsoft.com/en-us/research/product/cognitive-toolkit/">CNTK</a> , and laid it out in the clear.  There are a few examples of using a packet to process temporary sequences. </p><br><p>  One of the most popular packages on neural networks is Google <a href="https://www.tensorflow.org/">Tensorflow</a> .  <a href="https://keras.io/">Keras</a> is a fairly popular package that runs on top of TensofFlow or Theano and greatly simplifies model creation.  <a href="https://github.com/aurotripathy/lstm-anomaly-detect/blob/master/lstm-synthetic-wave-anomaly-detect.py">Here is one example of</a> its use for RNN. </p><br><h5 id="nachnem-vybor-dizayna">  Let's start the choice of design? </h5><br><h6 id="interfeys">  Interface </h6><br><p> For a start I am defined with the interface.  Regardless of the design of the internals of the service itself, the interface to it will not be much different, since it depends primarily on the task, and not on its implementation. </p><br><p>  So, at the <strong>entrance there is</strong> either a large file with sound, or a port for a stream (stream), through which data is continuously fed. </p><br><p>  The <strong>output</strong> is either a file or a stream.  Output format: time of occurrence of anomalies.  In addition, the following can still be issued: anomaly completion time;  anomaly class. </p><br><p>  Additional <strong>settings</strong> are parameters that are different for different service designs.  For example: </p><br><ul><li>  parameters for setting the ‚Äúfalse positives better / worse false detection‚Äù mode; </li><li>  ‚ÄúThe speed of adjustment for the new laws‚Äù; </li><li>  threshold anomalies. </li></ul><br><h6 id="custom-dizayn">  Custom design </h6><br><p>  Since I started with three approaches, it is logical to work out exactly three designs.  The first one is based on detecting a signal change without using Machine Learning methods.  In the simplest case, the input signal is averaged, so that random noise does not create too many false positives.  Then it is checked for the function ‚Äúif the amplitude is greater than the threshold, then this is an anomaly‚Äù. </p><br><p>  A bit more complicated, but much more practical, if we add logic to detect patterns of a signal.  For example, anomalies will be cached, and new anomalies will be checked for repetitions.  If a similar anomaly is found in the cache, and it is marked ‚Äúnot anomaly‚Äù, then this is ‚Äúnot an anomaly‚Äù.  We have to add the method of determining the ‚Äúanomaly / not anomaly‚Äù.  This will be either an additional user interface or some kind of algorithm. </p><br><h6 id="ispolzovanie">  Using: </h6><br><ul><li>  suitable for simple signals that do not change over time. </li><li>  better suited for signals that are widely known.  That is, we have signal samples without anomalies and samples of the anomalies themselves. </li><li>  rapid prototyping </li></ul><br><h6 id="preimuschestva">  Benefits: </h6><br><ul><li>  the simplest implementation. </li><li>  the easiest hardware requirements. </li></ul><br><h6 id="nedostatki">  Disadvantages: </h6><br><ul><li>  not smart enough to accurately detect and classify anomalies. </li></ul><br><h5 id="dizayn-klassicheskogo-machine-learning">  Classic Machine Learning Design </h5><br><p>  The simplest option is to use Azure ML.  As an example, I can take this simple <a href="https://gallery.cortanaintelligence.com/Experiment/Time-Series-anomaly-detection-with-Trend-Change-detection-3">experiment</a> , or more <a href="https://gallery.cortanaintelligence.com/Solution/Vehicle-Telemetry-Analytics-2">complex</a> . </p><br><p>  In another version, if I want to have complete control over the application, I can take this project and this one as a model.  Both are made in Python. </p><br><h6 id="ispolzovanie-1">  Using: </h6><br><ul><li>  suitable for signals that change over time. </li></ul><br><h6 id="preimuschestva-1">  Benefits: </h6><br><ul><li>  easy hardware requirements. </li><li>  accurate detection of anomalies. </li></ul><br><h6 id="nedostatki-1">  Disadvantages: </h6><br><ul><li>  Efforts are needed to prepare input parameters. </li></ul><br><h5 id="dizayn-baziruyuschiysya-na-neyronnyh-setyah">  Design based on neural networks </h5><br><p>  Most likely, a ready-made <a href="https://github.com/aurotripathy/lstm-anomaly-detect/blob/master/lstm-synthetic-wave-anomaly-detect.py">Keras-</a> based sample is <a href="https://github.com/aurotripathy/lstm-anomaly-detect/blob/master/lstm-synthetic-wave-anomaly-detect.py">suitable</a> , or CNTK can be used.  But I did not find a ready-made example for it, so I‚Äôll have to add the code. </p><br><h6 id="ispolzovanie-2">  Using: </h6><br><ul><li>  The design is suitable for complex signals that change over time. </li></ul><br><h6 id="preimuschestva-2">  Benefits: </h6><br><ul><li>  no preparation of input parameters is required. </li><li>  the highest definition of anomalies. </li></ul><br><h6 id="nedostatki-2">  Disadvantages: </h6><br><ul><li>  the greatest hardware requirements </li></ul><br><h4 id="zaklyuchenie">  Conclusion </h4><br><p>  These review (POC) projects, of course, will have to be done before starting a real project.  Specific data will be very different from the task to the task.  Depending on this data, different methods will suit us. <br>  The purpose of this article was to show one of the approaches to solving the problem "how to approach the problem of" search for sound anomalies. " <br>  If someone from readers decides to throw up fresh ideas or point out problems, mistakes, I will be very happy to see them in the comments.  Thanks in advance! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/315800/">https://habr.com/ru/post/315800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315786/index.html">Implementation of guaranteed asynchronous message delivery</a></li>
<li><a href="../315788/index.html">We test seamless WiFi using voice traffic</a></li>
<li><a href="../315790/index.html">How are you zadolbali with their alerts</a></li>
<li><a href="../315792/index.html">Open Source Legislation</a></li>
<li><a href="../315798/index.html">The final version of Vivaldi 1.5</a></li>
<li><a href="../315802/index.html">How to use HTTP headers to prevent vulnerabilities</a></li>
<li><a href="../315804/index.html">Jenkins for Android on a clean system and without UI</a></li>
<li><a href="../315806/index.html">True lies optimistic interfaces</a></li>
<li><a href="../315808/index.html">The book "Design. Modern Creatif</a></li>
<li><a href="../315810/index.html">The best IT vacancies on My Circle in a week, October 31 - November 6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>