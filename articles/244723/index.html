<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hacker's guide to neural networks. Schemes of real values. Strategy # 1: Random local search</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We are starting to publish the translation of the book (as the author calls it) ‚ÄúHacker's Guide to Neural Networks‚Äù. The book consists of four parts, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hacker's guide to neural networks. Schemes of real values. Strategy # 1: Random local search</h1><div class="post__text post__text-html js-mediator-article">  We are starting to publish the translation of the book (as the author calls it) ‚ÄúHacker's Guide to Neural Networks‚Äù.  The book consists of four parts, two of which have already been completed.  We will try to break the text into logically complete parts, the size of which will allow not overloading the reader.  We will also follow the update of the book and publish the translation of new parts after they appear in the <a href="http://cs.stanford.edu/people/karpathy/">author's</a> blog. <br><br>  Content: <br><div class="spoiler">  <b class="spoiler_title">Chapter 1: Real Value Schemes</b> <div class="spoiler_text">  <a href="http://habrahabr.ru/company/paysto/blog/244723/">Part 1:</a> <br><pre><code class="html hljs xml">  :        ‚Ññ1:   </code> </pre> <br>  <a href="http://habrahabr.ru/company/paysto/blog/244935/">Part 2:</a> <br><pre> <code class="html hljs xml">  ‚Ññ2:  </code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/245051/">Part 3:</a> <br><pre> <code class="html hljs xml">  ‚Ññ3:  </code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/245403/">Part 4:</a> <br><pre> <code class="javascript hljs">        </code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/246093/">Part 5:</a> <br><pre> <code class="javascript hljs">   ¬´¬ª   <span class="hljs-string"><span class="hljs-string">" "</span></span></code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/246397/">Part 6:</a> <br><pre> <code class="javascript hljs">     </code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Chapter 2: Machine Learning</b> <div class="spoiler_text">  <a href="http://habrahabr.ru/company/paysto/blog/246523/">Part 7:</a> <br><pre> <code class="javascript hljs">  </code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/246849/">Part 8:</a> <br><pre> <code class="javascript hljs">        (SVM)</code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/246973/">Part 9:</a> <br><pre> <code class="javascript hljs">  SVM   </code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/247033/">Part 10:</a> <br><pre> <code class="javascript hljs">   :  </code> </pre><br></div></div><br><a name="habracut"></a><br>  Hi there, I'm a graduate student in computing at Stanford.  For several years, as part of my research, I have been working on in-depth training, and among several related my favorite projects - <a href="http://cs.stanford.edu/people/karpathy/convnetjs/">ConvNetJS</a> - Javascript library for training neural networks.  Javascript allows you to visualize well what is happening, and gives you the opportunity to understand the various settings of the hyperparameters, but I still regularly hear people want to consider this topic in more detail.  This article (which I plan to gradually expand to the volume of several chapters) is my modest attempt to do so.  I post it online, instead of creating it in PDF format, as I should do with books, because it should (and I hope it will) end up with animations / demos, etc. <br><br>  My personal experience with neural networks shows that everything becomes much clearer when I start to ignore full page spreads, dense derivatives of back-propagation errors, and just start writing code.  Therefore, this manual will contain very little mathematics (I don‚Äôt think it is necessary, and in some places it may even complicate the understanding of simple concepts).  Since my specialty is computer science and physics, I, instead, will develop this topic from the point of view of a hacker.  My presentation will be centered around code and physical intuition, instead of mathematical derivatives.  Basically, I will try to present the algorithms in the way I would like to use when I first started. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  "... everything became much clearer when I started writing code" </blockquote><br><br>  Surely you will want to skip and immediately begin to study neural networks, how to use them in practice, etc. But before we take up this, I would like us to forget about all this.  Let's take a step back and see what, in fact, is happening.  Let's first talk about real-world value schemes. <br><br>  <b>Chapter 1: Real Value Schemes</b> <br><br>  In my opinion, the best way to imagine neural networks is as real-world value schemes in which real values ‚Äã‚Äã(instead of Boolean {0,1}) ‚Äúflow‚Äù along boundaries and interact in logical elements.  However, instead of such logical elements as AND, OR, NOT, etc., we have binary logical elements, such as * (multiply), + (add), max, or unary logic elements, such as exp, etc. However in contrast to conventional boolean schemes, we will eventually also have gradients flowing along the same boundaries of the scheme, but in the opposite direction.  But we are running ahead.  Let's concentrate and start simple. <br><br>  <b>Basic scenario: Simple logical element in the scheme</b> <br><br>  Let's first consider a single simple circuit with one logical element.  Here is an example: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a98/cfb/034/a98cfb034f0f44c697c60a0cc849f323.PNG" alt="image"></div><br><br>  The circuit takes two source real values ‚Äã‚Äãx and y and multiplies x * y with the aid of a logical element *. <br><br>  The javascript version of this equation will look very simple, like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> forwardMultiplyGate = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x, y</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x * y; }; forwardMultiplyGate(<span class="hljs-number"><span class="hljs-number">-2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// returns -6.</span></span></code> </pre><br>  And in the mathematical form, we can consider this logical element as a reproduction of a function with real values: <br><br>  <b>f (x, y) = xy</b> <br><br>  As in this example, all our logical elements will take one or two initial values ‚Äã‚Äãand produce one output value. <br><br>  <b>purpose</b> <br><br>  The problem, the study of which interests us, is as follows: <br><br>  1. We enter certain initial values ‚Äã‚Äãinto the given scheme (for example, x = -2, y = 3) <br>  2. The circuit calculates the output value (for example, -6) <br>  3. As a result, the key question arises: How should the initial value be slightly changed to increase the result? <br><br>  In this case, which way should we change x, y to get a number greater than -6?  Note that, for example, x = -1.99 and y = 2.99 results in x * y = -5.95, which is already greater than -6.0.  Do not worry: -5.95 is better (higher) than -6.0.  This is an improvement of 0.05, even though the value of -5.95 (distance from zero) is sometimes lower. <br><br>  <b>Strategy # 1: Random local search</b> <br><br>  Good.  We have a circuit, we have several source values, and we just need to change them a bit to increase the output value?  What is the difficulty?  We can easily ‚Äúhelp‚Äù the scheme to calculate the result for any given x and y value.  Isn't it easy?  Why not change x and y arbitrarily and not track which of the changes gives the best result: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ,      var forwardMultiplyGate = function(x, y) { return x * y; }; var x = -2, y = 3; // some input values //    x,y     ,     var tweak_amount = 0.01; var best_out = -Infinity; var best_x = x, best_y = y; for(var k = 0; k &lt; 100; k++) { var x_try = x + tweak_amount * (Math.random() * 2 - 1); //   x var y_try = y + tweak_amount * (Math.random() * 2 - 1); //   y var out = forwardMultiplyGate(x_try, y_try); if(out &gt; best_out) { //   !    x  y best_out = out; best_x = x_try, best_y = y_try; } }</span></span></code> </pre><br><br>  When I started it, I got best_x = -1.9928, best_y = 2.9901, and best_out = -5.9588.  Again, -5.9588 is higher than -6.0.  Well, we are done, right?  Not really: This is the ideal strategy for small problems with a small number of logical elements, if you have the time to calculate, but it does not work if we want to deal with large circuits with millions of initial values.  It turns out we can do more, but more on that in the next part. </div><p>Source: <a href="https://habr.com/ru/post/244723/">https://habr.com/ru/post/244723/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244709/index.html">Saving "many to many" in Yii2 through behavior</a></li>
<li><a href="../244711/index.html">Optional types? Only if very necessary</a></li>
<li><a href="../244713/index.html">10 opportunities to be more productive with Eclipse for Java developers</a></li>
<li><a href="../244715/index.html">The script collapsing comments on Habr√©</a></li>
<li><a href="../244721/index.html">Revised Grunt Beginner's Guide</a></li>
<li><a href="../244725/index.html">Grunt quick setup for comfortable development</a></li>
<li><a href="../244727/index.html">Why 1C is bad and why 1C programmers don‚Äôt like it so much</a></li>
<li><a href="../244729/index.html">Expanding the canvas of Van Gogh's ‚ÄúStarry Night‚Äù with the help of the Wolfram Language (Mathematica)</a></li>
<li><a href="../244731/index.html">GPS monitoring for personal use (part 2. Systems overview)</a></li>
<li><a href="../244735/index.html">Is Telegram Safe? v2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>