<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Notes on MODX Revo from newbie</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Disclaimer: Of course, most likely, much of the one presented in this article will seem like captaincy to knowledgeable people. However, perhaps, it w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Notes on MODX Revo from newbie</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/fcf/e8f/36f/fcfe8f36fd72db79d76976f1cf0762bd.png"><br>  <i>Disclaimer: Of course, most likely, much of the one presented in this article will seem like captaincy to knowledgeable people.</i>  <i>However, perhaps, it will help someone ...</i> <br><br><h4>  Introduction </h4><br>  So, what is MODX (by the way, it is written this way - MODX, and not as the name of the hub - MODx)?  If you read the official site - it is a CMS.  However, this is only part of the truth.  In fact, MODX is roughly midway between the CMS and CMF.  However, anyone who would be interested in MODX would quickly find out from other articles, so I will not dwell on this point in more detail. <br><br>  Since MODX is midway between CMS and CMF, it is not as easy to master as a simple CMS, like Wordpress or Joomla.  Perhaps this article is written in order to reveal some subtleties that seem unobvious at first glance. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h4>  Installation </h4><br>  Personally, I installed MODX Revo 2.2.4 on a server equipped with nginx and PHP-FPM. <br>  Since in general MODX is sharpened for Apache + PHP extension, additional configuration is required for nginx.  My configuration looks like this: <br><div class="spoiler">  <b class="spoiler_title">nginx configuration</b> <div class="spoiler_text"><pre><code class="nginx hljs"><span class="hljs-section"><span class="hljs-section">server</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">listen</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">server_name</span></span> example.com <span class="hljs-regexp"><span class="hljs-regexp">*.example.com</span></span>; <span class="hljs-comment"><span class="hljs-comment">#   MODX        . index index.php index.html; root /srv/http/example.com/public; access_log /srv/http/example.com/logs/http_access.log main buffer=50k; error_log /srv/http/example.com/logs/http_error.log; #    robots.txt.      ? location = /robots.txt { access_log off; log_subrequest off; log_not_found off; } #    favicon.ico location = /favicon.ico { access_log off; log_subrequest off; log_not_found off; } #    sitemap.xml location = /sitemap.xml { access_log off; log_subrequest off; log_not_found off; } #    *.css  *.js  location ~* ^.+\.(css|js)$ { access_log off; log_subrequest off; log_not_found off; } #     ,  location ~* ^.+\.(bmp|gif|jpg|jpeg|ico|png|swf)$ { access_log off; log_subrequest off; log_not_found off; } #      ,   ,   .htaccess, .git, .svn  .. location ~ /\. { deny all; } #        MODX.        ( ),   (   ).    ,    MODX-? location / { try_files $uri $uri/ @rewrite; } #  .    - MODX     index.php?q= -       . location @rewrite { rewrite ^/(.*)$ /index.php?q=$1; } #   php-fpm location ~ \.php$ { # php-fpm.   . fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock; fastcgi_index index.php; fastcgi_param DOCUMENT_ROOT /srv/http/example.com/public; #   ,   root fastcgi_param SCRIPT_FILENAME /srv/http/example.com/public$fastcgi_script_name; #   ,   root + $fastcgi_script_name include fastcgi_params; fastcgi_param REMOTE_ADDR $remote_addr; # ,  IP   PHP   localhost-. } }</span></span></code> </pre> </div></div><br>  In fact, this config, I'm just sure that it is not ideal, but for the initial configuration, it will probably work.  You can stop here only on two things, which, in fact, connect MODX (so that the CNC works correctly): <br><pre> <code class="nginx hljs"> <span class="hljs-attribute"><span class="hljs-attribute">server_name</span></span> example.com <span class="hljs-regexp"><span class="hljs-regexp">*.example.com</span></span>; <span class="hljs-comment"><span class="hljs-comment">#   MODX        . #        MODX.        ( ),   (   ).    ,    MODX-? location / { try_files $uri $uri/ @rewrite; } #  .    - MODX     index.php?q= -       . location @rewrite { rewrite ^/(.*)$ /index.php?q=$1; }</span></span></code> </pre><br>  Actually, this seems to be enough for correct operation both for MODX and for everything else (loading nginx CSS, JS, images and other things without PHP). <br>  The installation itself is very simple, just unpack the files into the desired folder and type in the address bar example.com/setup/, after which a simple installer will be loaded. <br><br><h4>  Man-Friendly URL (CNC) </h4><br>  By default, in CNC MODX is disabled.  It turns on very simply: System -&gt; System Settings -&gt; we drive into the filter ‚Äúfriendly_urls‚Äù and press Enter (you can of course find the handles, but this is faster) -&gt; Switch the value to ‚ÄúYes‚Äù and click ‚ÄúSave‚Äù at the top. <br>  In general, do not forget that in MODX the save button is located in the UPPER RIGHT CORNER.  Sometimes you can forget about it, and then the settings can be lost - because in MODX, an autosave sometimes works, and sometimes not. <br>  Similarly, we do for the ‚Äúautomatic_alias‚Äù function for automatic CNC generation. <br>  We have successfully included the CNC, and now the links will be formed as follows: <br><pre> <code class="hljs">example.com/resourcename.html</code> </pre><br>  Pay attention that in the end .html is substituted!  It depends on the Content-Type of each individual resource (changes in the properties of the resource itself).  Content-Type settings themselves can be found in System -&gt; Content Types. <br>  However, all additional GET parameters still remain the same, and it works like this: <br><pre> <code class="hljs pgsql">example.com/news.html?<span class="hljs-type"><span class="hljs-type">date</span></span>=<span class="hljs-number"><span class="hljs-number">05092012</span></span>&amp;nid=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  Personally, I did not like this system, and I began to look for ways to make these parameters part of the CNC.  And found! <br>  To begin with, it is worth telling a little about the various elements allowing to expand MODX.  There are several: <br><ul><li>  Template Variables - additional fields of resource properties.  We will return to them later </li><li>  Chunks are blocks of HTML code (with possible MODX markup) that can be inserted into any other chunk, resource, or anywhere else.  Attention!  PHP can not be inserted here! </li><li>  Snippets are blocks of PHP code that output some data to the place where they are inserted (using MODX markup).  Peculiar PHP-analog chunks. </li><li>  Plugins are blocks of PHP code executed in accordance with certain events occurring inside MODX.  Something like Drupal-ovsky hooks, perhaps. </li></ul><br>  In this case, we will need snippets and plugins. <br>  So, how to integrate into MODX with its own URL format?  in fact, it‚Äôs very simple to let MODX try to find a page on a given URL, and when it doesn‚Äôt find it, take control and parse it, sending the MODX to the right place.  To do this, you need to use a plugin for the <b>OnPageNotFound</b> event. <br><div class="spoiler">  <b class="spoiler_title">Plugin code for "improved" CNC</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($modx-&gt;request-&gt;getResourceMethod()!=<span class="hljs-string"><span class="hljs-string">"alias"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; $uri = $modx-&gt;resourceIdentifier; $uriChunks = explode(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, $uri); $paramNum=<span class="hljs-number"><span class="hljs-number">0</span></span>; $uriChunksCount = count($uriChunks); $paramDelimiter=<span class="hljs-string"><span class="hljs-string">"-"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//DO NOT use "/"! Set the desired delimiter here. for($i=$uriChunksCount-1;$i&gt;0;$i--) { $parameter=explode($paramDelimiter, $uriChunks[$i], 2); if(count($parameter)!=2) return; $modx-&gt;request-&gt;parameters['GET'][$parameter[0]]=$parameter[1]; if(empty($modx-&gt;request-&gt;parameters['POST'][$parameter[0]])) $modx-&gt;request-&gt;parameters['REQUEST'][$parameter[0]]=$parameter[1]; $paramNum++; unset($uriChunks[$i]); $uri = implode("/", $uriChunks); if (array_key_exists($uri, $modx-&gt;aliasMap)) { $modx-&gt;sendForward($modx-&gt;aliasMap[$uri]); } } if($paramNum==($uriChunksCount-1)) { $parameter=explode($paramDelimiter, $uriChunks[0], 2); if(count($parameter)!=2) return; $modx-&gt;request-&gt;parameters['GET'][$parameter[0]]=$parameter[1]; if(empty($modx-&gt;request-&gt;parameters['POST'][$parameter[0]])) $modx-&gt;request-&gt;parameters['REQUEST'][$parameter[0]]=$parameter[1]; $modx-&gt;sendForward($modx-&gt;getOption('site_start', null, 1)); }</span></span></code> </pre></div></div><br>  Actually, here it is probably worthwhile to dwell on the following things: <br><pre> <code class="php hljs">$modx-&gt;request-&gt;getResourceMethod()</code> </pre><br>  Check whether the CNC is turned on at all. <br><pre> <code class="php hljs">$modx-&gt;resourceIdentifier</code> </pre><br>  This not so obvious variable stores the requested URL. <br><pre> <code class="php hljs">$paramDelimiter=<span class="hljs-string"><span class="hljs-string">"-"</span></span>;</code> </pre><br>  This variable sets the delimiter between the GET parameter name and its value.  You can change to anything except "/". <br><pre> <code class="php hljs">$modx-&gt;request-&gt;parameters[<span class="hljs-string"><span class="hljs-string">'GET'</span></span>][$parameter[<span class="hljs-number"><span class="hljs-number">0</span></span>]]=$parameter[<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($modx-&gt;request-&gt;parameters[<span class="hljs-string"><span class="hljs-string">'POST'</span></span>][$parameter[<span class="hljs-number"><span class="hljs-number">0</span></span>]])) $modx-&gt;request-&gt;parameters[<span class="hljs-string"><span class="hljs-string">'REQUEST'</span></span>][$parameter[<span class="hljs-number"><span class="hljs-number">0</span></span>]]=$parameter[<span class="hljs-number"><span class="hljs-number">1</span></span>];</code> </pre><br>  The fact is that with each request, MODX saves all the information about the GET and POST parameters into its own arrays, after which it forms a common array in the following way: <br><pre> <code class="php hljs">$modx-&gt;request-&gt;parameters[<span class="hljs-string"><span class="hljs-string">'REQUEST'</span></span>] = array_merge($modx-&gt;request-&gt;parameters[<span class="hljs-string"><span class="hljs-string">'GET'</span></span>], ($modx-&gt;request-&gt;parameters[<span class="hljs-string"><span class="hljs-string">'POST'</span></span>]);</code> </pre><br>  To save this structure, we have to check each time whether the data from the POST array is not stored in the REQUEST array, and only in the absence of such data to replace the data in the REQUEST array. <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (array_key_exists($uri, $modx-&gt;aliasMap)) { $modx-&gt;sendForward($modx-&gt;aliasMap[$uri]); }</code> </pre><br>  And this is actually a redirect to the desired resource.  The entire NC table is stored in $ modx-&gt; aliasMap, and we check it with it, figuring out whether it‚Äôs time to go to the right resource, or whether the contents of our underpriced uri still consist of parameters.  $ modx-&gt; sendForward and performs this redirection. <br><br>  However, you probably want to immediately provide links to, for example, the current page, using this URL generation mechanism!  For this, I wrote a simple snippet, just generating the URL of the current page.  Of course, it can be expanded for the generation of other links, but this will be the personal homework of the one who needs it - there is nothing difficult about it :) <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $currentURL=<span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>($modx-&gt;request-&gt;getParameters() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $key =&gt; $value) { $currentURL.=$key.<span class="hljs-string"><span class="hljs-string">"="</span></span>.$value.<span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>; } $currentURL = $modx-&gt;makeUrl($modx-&gt;resource-&gt;get(<span class="hljs-string"><span class="hljs-string">"id"</span></span>), $modx-&gt;context-&gt;get(<span class="hljs-string"><span class="hljs-string">"key"</span></span>), $currentURL); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $currentURL;</code> </pre><br>  Actually, nothing special to explain.  $ modx-&gt; makeUrl just forms the URL.  For reference, it forms it relative to the context - the second parameter sets the context. <br><br><h4>  Multisite in MODX </h4><br><h5>  Processing multiple domains with different contexts by one MODX </h5><br>  Actually, this topic has already been raised, for example, <a href="http://habrahabr.ru/post/150713/">in this topic</a> and <a href="http://lmgtfy.com/%3Fq%3Dmodx%2Bcontext%2Bswitching">on the Internet</a> .  I would like to present my decision, it seems to me, quite simple.  But first, let's list the main methods for solving this problem: <br><ol><li>  edit index.php.  The index.php explicitly states which context is loaded at startup.  It can be completely corrected, and you can substitute your conditions there with a choice of your context.  Why I don‚Äôt like this method: editing the original modx files.  Why don't I like this fact?  Difficulty with updates.  For what I love modx (and just as much I do not like <a href="http://www.simplemachines.org/">the SMF engine of the forum</a> ), this is because it DOES NOT NEED to change any files of the original MODX, which is just as easy to update the engine as possible. </li><li>  Creating a plug-in for the <b>OnHandleRequest</b> event (common drawback: a bit more resources are used - the web context is always loaded first, and only then the necessary context is loaded): <br><ol><li>  Similar to editing index.php, but without editing it.  Everything is almost the same - a rigidly defined list of domains that are processed by a rigidly given list of contexts.  As an option, the context name contains part of the domain name (the context of the forum for the subdomain forum.example.com for example), on the basis of which the search of the necessary context is performed. For simple websites it is suitable, but there is not enough flexibility. </li><li>  Scanning context settings to find the right one.  Maximum flexibility, auto-creation of contexts, no need to edit the plugin after its creation. </li></ol><br></li></ol><br><br>  I am going to describe here just the last option.  My plug-in text (remember, the <b>OnHandleRequest</b> event): <br><div class="spoiler">  <b class="spoiler_title">Plugin-gateway</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($modx-&gt;context-&gt;key!=<span class="hljs-string"><span class="hljs-string">"mgr"</span></span>) { $object = $modx-&gt;getObject(<span class="hljs-string"><span class="hljs-string">'modContextSetting'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'key'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'multisite_http_host'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span> =&gt; $modx-&gt;getOption(<span class="hljs-string"><span class="hljs-string">'http_host'</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($object) $modx-&gt;switchContext($object-&gt;get(<span class="hljs-string"><span class="hljs-string">'context_key'</span></span>)); }</code> </pre></div></div><br>  To use it, it is necessary to put down the ‚Äúmultisite_http_host‚Äù parameter in the context properties with the value of what domain it processes.  If the plugin does not find any suitable context, it uses the default web context. <br>  Here I want to focus on two things. <br>  First, in order to successfully use MODX, you need to understand the principle of xPDO.  xPDO is a mechanism for communication between a database and PHP objects.  Working with an object in PHP we get access to the database.  In fact, everything in MODX uses xPDO to communicate with the database. <br><pre> <code class="php hljs">$object = $modx-&gt;getObject(<span class="hljs-string"><span class="hljs-string">'modContextSetting'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'key'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'multisite_http_host'</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span> =&gt; $modx-&gt;getOption(<span class="hljs-string"><span class="hljs-string">'http_host'</span></span>)));</code> </pre><br>  This code just calls the database to search for the context settings object containing certain conditions (namely, the ‚Äúmultisite_http_host‚Äù setting key with the value of our http host).  After that we get the context key that we need to load from the received object ($ object-&gt; get ("context_key")). <br>  Secondly, the hacker <a href="http://habrahabr.ru/users/xanderbass/" class="user_link">XanderBass</a> asked the right question, the answer to which I would like to duplicate here.  So why do I use the parameter name ‚Äúmultisite_http_host‚Äù and not just ‚Äúhttp_host‚Äù? <br>  Everything is very simple, it follows from the mechanism of combining the settings of the system, the context and the user.  The fact is that the system settings are overwritten by the context settings, and those, in turn, by the user settings. <br>  In this case, http_host is a system setting.  If I used http_host instead of multisite_http_host in the context settings, it would be overwritten by the context setting.  Of course, in this particular example, it is not so scary.  But it is enough just to rewrite this plugin a bit to handle all subdomains of this domain with one context!  Or, make processing the same context of several different domains (for example, driving into a parameter in about the following format: sub1.example.com; sub2.example.com; sub3.example.com ", etc.). In this case, in http_host, it would not be the http_host used in the request, but this is the setting itself, but you never know, maybe we will need the original http_host somewhere else ... <br><br><h5>  Multi-context authentication </h5><br>  Sometimes you want to authenticate the user in several contexts at once.  By default, a user who logs into the system (for example, using the Login mode), logs in to the system only in a single context.  The following authorization plugin automatically enters several contexts ( <b>OnWebLogin</b> and <b>OnWebLogout events</b> ): <br><div class="spoiler">  <b class="spoiler_title">Multi-authentication</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $currentSiteGroup = $modx-&gt;getOption(<span class="hljs-string"><span class="hljs-string">"multisite_site_group"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($currentSiteGroup)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; $currentContext = $modx-&gt;context-&gt;get(<span class="hljs-string"><span class="hljs-string">"key"</span></span>); $currentContextSettings = $modx-&gt;getCollection(<span class="hljs-string"><span class="hljs-string">'modContextSetting'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'key'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"multisite_site_group"</span></span>, <span class="hljs-string"><span class="hljs-string">"value"</span></span> =&gt; $currentSiteGroup)); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>($currentContextSettings <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $currentContextSetting) { $contextKey = $currentContextSetting-&gt;get(<span class="hljs-string"><span class="hljs-string">'context_key'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($contextKey!=<span class="hljs-string"><span class="hljs-string">"mgr"</span></span> &amp;&amp; $contextKey!=$currentContext) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($user) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($modx-&gt;event-&gt;name==<span class="hljs-string"><span class="hljs-string">"OnWebLogout"</span></span>) { $modx-&gt;user-&gt;removeSessionContext($contextKey); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($modx-&gt;event-&gt;name==<span class="hljs-string"><span class="hljs-string">"OnWebLogin"</span></span>) { $modx-&gt;user-&gt;addSessionContext($contextKey); $_SESSION[<span class="hljs-string"><span class="hljs-string">'modx.'</span></span>.$contextKey.<span class="hljs-string"><span class="hljs-string">'.session.cookie.lifetime'</span></span>]=$attributes[<span class="hljs-string"><span class="hljs-string">"lifetime"</span></span>]; } } } }</code> </pre><br></div></div><br>  To use, you need to put down in all contexts on which you want the user to simultaneously go, the parameter ‚Äúmultisite_site_group‚Äù with the same value for all necessary contexts. <br>  Just a few comments: <br>  Here, the search for the necessary contexts is very similar to how we implemented them in the previous plugin, the only difference is in the use of getCollection instead of getObject.  By doing so, we get an array of objects that follow the specified conditions. <br><pre> <code class="php hljs">$modx-&gt;user-&gt;addSessionContext($contextKey);</code> </pre><br>  and <br><pre> <code class="php hljs">$modx-&gt;user-&gt;removeSessionContext($contextKey);</code> </pre><br>  just authorize the user in a particular context. <br><pre> <code class="php hljs">$_SESSION[<span class="hljs-string"><span class="hljs-string">'modx.'</span></span>.$contextKey.<span class="hljs-string"><span class="hljs-string">'.session.cookie.lifetime'</span></span>]=$attributes[<span class="hljs-string"><span class="hljs-string">"lifetime"</span></span>];</code> </pre><br>  puts down the "lifetime" authorization for all other contexts the same as for the current one. <br><br>  At the moment, everything seems to be what I wanted to tell.  Practices with language switching will be possible later, when I finish them a little.  Thank you all for your attention! </div><p>Source: <a href="https://habr.com/ru/post/150942/">https://habr.com/ru/post/150942/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150934/index.html">Mobile editions - is it still future or is it already present? Interview with Vitaliy Dubinin</a></li>
<li><a href="../150935/index.html">Digest of Moscow vacancies</a></li>
<li><a href="../150936/index.html">Games of operators of communication with fire: for what and how does FAS penalize</a></li>
<li><a href="../150940/index.html">Delivery of fresh press using Python directly to the mailbox</a></li>
<li><a href="../150941/index.html">Ruby NoName Podcast S04E17</a></li>
<li><a href="../150943/index.html">Where should Delphi develop instead of where it is developing now?</a></li>
<li><a href="../150944/index.html">Neutrino - a tiny js framework with full inheritance and events</a></li>
<li><a href="../150946/index.html">Add Bundling and Minification to ASP.NET Web Pages</a></li>
<li><a href="../150947/index.html">Nokia Lumia 920 and 820 with wireless charging and Windows Phone 8</a></li>
<li><a href="../150950/index.html">Building Command Line Applications (CLI)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>