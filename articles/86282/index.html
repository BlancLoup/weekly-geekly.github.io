<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I caught a hacker</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It happened in early 2008, when I was still working at a large Ukrainian bank as an engineer in the IT department. The New Year holiday fuss was just ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I caught a hacker</h1><div class="post__text post__text-html js-mediator-article">  It happened in early 2008, when I was still working at a large Ukrainian bank as an engineer in the IT department.  The New Year holiday fuss was just asleep, and the load on the technical support divisions diminished a bit, as one of the web servers reporting to me reported on the place ending on the disk.  A quick analysis showed that the IIS server‚Äôs logs were rapidly growing, on which one of the bank‚Äôs public payment systems was spinning.  My fears came true - a DDOS attack began on the server. <a name="habracut"></a><br>  The attack format was as follows: at a speed of 150-200 requests per second, using the GET method, the same URL was accessed from a large number of IP addresses.  Those.  worked a small international botnet.  The server itself and the firewall of the bank coped with the attack, so I had enough time to study the attack and develop a plan of measures to eliminate it. <br><br>  First, I analyzed the geography of the attacking IP addresses.  The intensity was evenly spread across countries, and it was impossible to block any regions - customers from all over the world would use the banking web-service, and blocking any segment would mean financial losses for the bank.  Further, assuming a possible increase in the intensity of the attack, I optimized the size of the attacked page to a minimum.  The load on the server and the firewall dropped, which was not long in coming.  The hacker who managed the botnet changed the address of the URL being attacked, and the attack was re-arranged for the GIF image - one of the most voluminous elements of the site.  These actions gave me a good lead, and I thoroughly prepared for counteractions.  I wrote a number of scripts using <a href="http://habrahabr.ru/blogs/sql/85758/">LogParser</a> , processing web server logs and revealing "abnormal" client behavior.  ‚ÄúAbnormal‚Äù was considered to refer to the pages in a sequence that is not inherent in either the bank‚Äôs customers or the botnet.  LogParser successfully coped with gigabyte logs, which gave me a good chance of a quick response. <br><br>  At this point, the attack reached 500 requests per second.  Thus, I prepared myself, and threw the bait - renamed the attacked picture, made the return page with the 404th error minimal, and waited.  After a while, the attack stopped for a moment.  Since its effectiveness was reduced to zero, the hacker started manually, through the browser, ‚Äúprobing‚Äù the site for the presence of voluminous elements - LogParser quickly identified this ‚Äúabnormal‚Äù behavior.  That was enough for me - the hacker‚Äôs IP address was in my hands, and he, surprisingly, did not belong to an anonymous proxy server, but to one of the Ukrainian hosters, but also to a good client of this very web service of the bank. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      - Hello, Sergey Ivanovich, good afternoon, you are disturbed from &lt;% bank_name%&gt;, from your server the DDOS attack on our site is coordinated <br>  - Hello.  Tell me ip <br>  - XXX.XXX.XXX.XXX <br>  - Yes, the client is now working in a terminal session on this server, I will disconnect it, and give you access to the server.  These freaks need to be fought.  By the way, I have his contact details. <br>  - Thank you, I will inform the bank security service, they will contact you. <br><br>  ... to be continued (dialogue with the hacker in ICQ, ‚Äúcutting off‚Äù the worm‚Äôs head, my testimony in the management of combating economic crimes and, in fact, how it ended) <br><br>  <b>UPD: on the advice of <a href="http://banzeg.habrahabr.ru/">banzeg</a> moved to <i>Information Security</i></b> <br>  <b>UPD: continued here: <a href="https://habrahabr.ru/post/86333/">How I caught a hacker 2</a></b> </div><p>Source: <a href="https://habr.com/ru/post/86282/">https://habr.com/ru/post/86282/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../86275/index.html">Startup a year later or a successful designer store</a></li>
<li><a href="../86276/index.html">Russian "Silicon Valley" will appear in 2010?</a></li>
<li><a href="../86278/index.html">Google Mail Suspicious Behavior</a></li>
<li><a href="../86279/index.html">A few words about this blog.</a></li>
<li><a href="../86280/index.html">Protection against repeated processing POST request</a></li>
<li><a href="../86283/index.html">Multiple terminal connections WindowsXP</a></li>
<li><a href="../86285/index.html">Report from CEBIT 2010</a></li>
<li><a href="../86286/index.html">New method of working in 37signals: two months results</a></li>
<li><a href="../86288/index.html">Fresh breath of air for Ubuntu</a></li>
<li><a href="../86292/index.html">Adobe shows Flash on Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>