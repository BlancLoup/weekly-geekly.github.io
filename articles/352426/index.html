<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>React v.16.3.0 released</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few days ago, we wrote a post about upcoming changes in our lifecycle methods , where we also touched upon the strategy of gradual migration (update...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>React v.16.3.0 released</h1><div class="post__text post__text-html js-mediator-article"><p>  A few days ago, we wrote a post about <a href="https://reactjs.org/blog/2018/03/27/update-on-async-rendering.html">upcoming changes in our lifecycle methods</a> , where we also touched upon the strategy of gradual migration (updates).  In React 16.3.0, we added several new lifecycle methods to aid in this migration.  We also provided a new API for long-awaited innovations: the official context API, the ref forwarding API, and the ergonomic ref API. </p><a name="habracut"></a><br><h2 id="oficialnoe-context-api">  Official Context API </h2><br><p>  For many years, React has offered an experimental API for working with context.  Let it be a powerful "thing", the use of such an API was under threat, as we all wanted to replace the "experimental" API. </p><br><p>  Version 16.3 introduces a new context API that is more efficient and supports both <em>static type checking</em> and deep updates right away. </p><br><blockquote>  The old context API will work for all releases of version 16, so you have time to migrate. </blockquote><p>  Below is an example that shows how you can ‚Äúskip‚Äù a theme using a new API: </p><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ThemeContext = React.createContext(<span class="hljs-string"><span class="hljs-string">'light'</span></span>); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ThemeProvider</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ state = {<span class="hljs-attr"><span class="hljs-attr">theme</span></span>: <span class="hljs-string"><span class="hljs-string">'light'</span></span>}; render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;ThemeContext.Provider value={this.state.theme}&gt; {this.props.children} &lt;/ThemeContext.Provider&gt; ); } } class ThemedButton extends React.Component { render() { return ( &lt;ThemeContext.Consumer&gt; {theme =&gt; &lt;Button theme={theme} /&gt;} &lt;/ThemeContext.Consumer&gt; ); } }</code> </pre> <br><p>  <a href="https://reactjs.org/docs/context.html">More about the context API here.</a> </p><br><h2 id="createref-api">  createRef API </h2><br><p>  React provided two ways to control <em>refs</em> : specifying ref in a regular string and callback.  Although the ref indication was simply more convenient as a string, it had <a href="https://github.com/facebook/react/issues/1373">several drawbacks</a> and therefore we recommended using the callback option. </p><br><p>  Version 16.3 adds a new option to control refs, which offers the convenience of specifying ref as a string with no flaws: </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.inputRef = React.createRef(); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.inputRef}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">; } componentDidMount() { this.inputRef.current.focus(); } }</span></span></code> </pre> <br><blockquote>  Callback refs will continue to be supported in the new createRef API.  Do not rush to replace callback refs in your components.  They are more flexible, so we will leave them for future advanced use. </blockquote><p>  <a href="https://reactjs.org/docs/refs-and-the-dom.html">More about the createRef API here.</a> </p><br><h2 id="forwardref-api">  forwardRef API </h2><br><p>  <a href="https://reactjs.org/docs/higher-order-components.html">Higher order components</a> (or HOC) are a handy tool for reusing code between components.  If we take the previous example with context as a basis, we can create a HOC in which we will ‚Äúcast‚Äù the theme as a property ( <em>props</em> ): </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">withTheme</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Component</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ThemedComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;ThemeContext.Consumer&gt; {theme =&gt; &lt;Component {...props} theme={theme} /&gt;} &lt;/ThemeContext.Consumer&gt; ); }; }</code> </pre> <br><p>  We can use this HOC to associate components with skin properties ( <em>theme</em> ) from context ( <em>context</em> ) without using ThemeContext directly.  For example: </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FancyButton</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ buttonRef = React.createRef(); focus() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.buttonRef.current.focus(); } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {label, theme, ...rest} = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...rest</span></span></span></span><span class="xml"><span class="hljs-tag">} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag">`${</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">theme</span></span></span></span><span class="xml"><span class="hljs-tag">}</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-button</span></span></span></span><span class="xml"><span class="hljs-tag">`} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.buttonRef}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {label} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FancyThemedButton = withTheme(FancyButton); <span class="hljs-comment"><span class="hljs-comment">//    FancyThemedButton,    FancyButton //      (* theme*) //  HOC     props. &lt;FancyThemedButton label="Click me!" onClick={handleClick} /&gt;;</span></span></code> </pre> <br><p>  Usually HOC'i <a href="https://reactjs.org/docs/higher-order-components.html">prokidyvayut properties (props)</a> in the component that they wrap.  Unfortunately, <a href="https://reactjs.org/docs/higher-order-components.html">refs are not thrown</a> .  This means that we cannot attach ref to FancyButton when using FancyThemedButton.  It turns out that it is impossible to call <code>focus()</code> . </p><br><p>  The forwardRef API solves this problem by offering to intercept the ref and send it on as a normal property. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">withTheme</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Component</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  ,  "ref"   React.forwardRef. function ThemedComponent(props, ref) { return ( &lt;ThemeContext.Consumer&gt; {theme =&gt; ( &lt;Component {...props} ref={ref} theme={theme} /&gt; )} &lt;/ThemeContext.Consumer&gt; ); } //     , //         DevTools, // , "ForwardRef(withTheme(MyComponent))" const name = Component.displayName || Component.name; ThemedComponent.displayName = `withTheme(${name})`; //  React  ref  ThemedComponent. return React.forwardRef(ThemedComponent); } const fancyButtonRef = React.createRef(); //  fancyButtonRef   FancyButton &lt;FancyThemedButton label="Click me!" onClick={handleClick} ref={fancyButtonRef} /&gt;;</span></span></code> </pre> <br><h2 id="izmeneniya-v-metodah-zhiznennogo-cikla-lifecycle-methods">  Changes in life cycle methods (lifecycle methods) </h2><br><p>  The component creation API using the class has remained almost unchanged for several years.  However, we added support for new "features" (such as <a href="https://reactjs.org/docs/react-component.html">error boundaries</a> or the future <a href="https://reactjs.org/docs/react-component.html">async rendering mode</a> ) for which this model was not ready as it should. </p><br><p>  For example, with the current API it is very easy to block the initial component rendering ( <em>initial render</em> ) with irrelevant logic.  In part, this is due to the fact that there are several options for solving the problems posed, and therefore it is not easy to choose the best.  We noticed that error handling is often overlooked and this can lead to memory leaks (which in turn will adversely affect <em>async rendering mode</em> in the future).  The current class API also complicates our other ideas, such as working on <a href="https://twitter.com/trueadm/status/944908776896978946">prototyping the React compiler</a> . </p><br><p>  Most of these problems are associated with the following lifecycle methods: <em>componentWillMount</em> , <em>componentWillReceiveProps,</em> and <em>ComponentWillUpdate</em> .  These methods also make the most of the confusion in the React community.  Therefore, we are going to abandon them in favor of a better alternative. </p><br><p>  Of course, we understand that such changes will affect a huge number of existing components.  Therefore, migration will be as gradual as possible.  We will also offer ways of retreat (We have 50,000 components on Facebook. We also need a gradual update). </p><br><blockquote>  Deprecation (obsolete method) warning will be included in future 16.x releases, but support for the current "life cycles" will work until version 17. Also, in the seventeenth version you can use them with the UNSAFE_ prefix.  We have prepared an <a href="https://github.com/reactjs/react-codemod">automatic script</a> for renaming. </blockquote><p>  In addition to the future "deprecated" life cycle methods, we added a couple of new ones: </p><br><ul><li>  <a href="https://reactjs.org/docs/react-component.html">getDerivedStateFromProps</a> - alternative for componentWillReceiveProps </li><li>  <a href="https://reactjs.org/docs/react-component.html">getSnapshotBeforeUpdate</a> is an alternative to safely reading properties from the DOM before the update happens. </li></ul><br><p>  <a href="https://reactjs.org/blog/2018/03/27/update-on-async-rendering.html">More about the change in lifecycle here.</a> </p><br><h2 id="strictmode-komponent">  StrictMode component </h2><br><p>  StrictMode is a tool for finding potential problems in your application.  Like Fragment, StrictMode is not visually rendered.  This component activates additional checks and warnings. </p><br><blockquote>  StrictMode works only in development mode ( <em>in development mode, not in "prode"</em> ) </blockquote><p>  Although it is impossible to catch all the problem areas (for example, some types of mutations), the StrictMode component will help in many situations.  If you see warnings in <em>strict mode</em> , then most likely you will have bugs in <em>async rendering mode</em> . </p><br><p>  In version 16.3, StrictMode can: </p><br><ul><li>  find components using unsafe (old) lifecycle methods </li><li>  warn about using the old API ref notation as a string </li><li>  track down unexpected side effects </li></ul><br><p>  Additional functionality will be added in future React releases. </p><br><p>  <a href="https://reactjs.org/docs/strict-mode.html">More about StrictMode here.</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/352426/">https://habr.com/ru/post/352426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352416/index.html">How I spent SberSeasons: four stories about different specialties</a></li>
<li><a href="../352418/index.html">Overview of KPI automation software</a></li>
<li><a href="../352420/index.html">New Intel microarchitecture: fast, but not free</a></li>
<li><a href="../352422/index.html">Payloads for testing web applications</a></li>
<li><a href="../352424/index.html">Analysis of the results of the presidential election of 2018. At the federal and regional level</a></li>
<li><a href="../352428/index.html">Friday JS: minus without minus</a></li>
<li><a href="../352430/index.html">Tarantool application: stored procedures</a></li>
<li><a href="../352432/index.html">Linux distribution from scratch to build Docker images - our experience with dappdeps</a></li>
<li><a href="../352434/index.html">Ransomware is gaining strength</a></li>
<li><a href="../352436/index.html">Blondes, monsters and artificial intelligence addictions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>