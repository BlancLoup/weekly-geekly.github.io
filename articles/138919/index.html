<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parallels Plesk hacked - Found a hole in the splash panel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I discovered new tasks in cron, on one of the servers, which made me start to figure it out and google on this topic. 
 After searching, I found...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parallels Plesk hacked - Found a hole in the splash panel</h1><div class="post__text post__text-html js-mediator-article"> Today I discovered new tasks in cron, on one of the servers, which made me start to figure it out and google on this topic. <br>  After searching, I found only one mention on the official <a href="http://forum.parallels.com/showthread.php%3Ft%3D257260">Parallels</a> forum. <br>  For several days now, as people began to complain, technical support was first rejected, and now it has become completely silent. <br><br>  Finding a trojan, laid out its source code on <a href="http://pastebin.com/gAs4EkyG">pastebin</a> . <br>  Quite an interesting script, part of the botnet. <br>  The script itself registers in cron, thus: <br> <code>`echo '* * * * * $^X $script_path detach &gt;/dev/null 2&gt;&amp;1' &gt; /tmp/cron.d; crontab /tmp/cron.d ; rm /tmp/cron.d`;</code> <br> <a name="habracut"></a><br>  Next, it takes commands to attack servers, with several attack options.  If interested, see the source.  And yes, there are comments in Russian in it, that is, it is clear where the legs grow from :) <br><br>  The hole itself, with which it was poured in the file manager of the Plesk panel. <br>  the script is placed in / var / www / vhosts / DOMAINNAME / cgi-bin /, with different names and the extension .pl 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the moment, I closed access to the splash panel with a firewall, leaving only familiar addresses.  No solution or patch yet.  So, if you have a splash panel, be careful.  Subjects prone to defeat 9.5 and below. <br><br>  You can check the presence on your server like this: <br> <code>find /var/www/vhosts/[az]*/cgi-bin/*.pl -mmin -2880</code> <br>  If you see the presence of incomprehensible files with the extension. Pl, then you have already picked up the infection. </div><p>Source: <a href="https://habr.com/ru/post/138919/">https://habr.com/ru/post/138919/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138913/index.html">My extend and class inheritance style</a></li>
<li><a href="../138914/index.html">They waited: Skype beta for Windows Phone</a></li>
<li><a href="../138915/index.html">Google translate learn esperanto</a></li>
<li><a href="../138916/index.html">Document-oriented repository for the Nexus of the E1 Euphrates system</a></li>
<li><a href="../138918/index.html">Big Bang Stats</a></li>
<li><a href="../138920/index.html">Startup in PHP: started for health, and finished for the rest</a></li>
<li><a href="../138921/index.html">TODO lists via Jabber</a></li>
<li><a href="../138922/index.html">EFF asks the European Parliament to protect the rights of programmers</a></li>
<li><a href="../138924/index.html">Droider Show # 29. Time Machine</a></li>
<li><a href="../138926/index.html">For the benefit of logistics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>