<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Setting up a Webpack 3 + Angular 4 development environment: from complex to simple</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 A modern Angular front-end application should include the following features: 



- Ability to use typed JS - Typescript 
- Ensuring the con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Setting up a Webpack 3 + Angular 4 development environment: from complex to simple</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br><br>  A modern Angular front-end application should include the following features: <br><br><ul><li>  Ability to use typed JS - <a href="https://www.typescriptlang.org/">Typescript</a> </li><li>  Ensuring the convenience and performance of development using <a href="https://webpack.js.org/concepts/hot-module-replacement/">HMR</a> (hot module replacement); </li><li>  Application modularity and the possibility of delayed loading of modules (Lazy Loading); </li><li>  <a href="https://angular.io/guide/aot-compiler">AoT</a> - mode (ahead-of-time), which increases application performance. </li></ul><br>  There are many assembly options that solve these problems (angular cli, A2 seed, etc.).  Usually they have a complex structure, poorly configured / expanded, and are a monolith that cannot be changed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the article I will tell you how to combine Angular 2+ with a webpack and deal with all the stages of assembly / development. <br><br>  You will be surprised how simple it is. <a name="habracut"></a><br>  <a href="https://github.com/maxim1006/angular-project">The final application</a> . <br><br>  I will try to highlight the most subtle moments.  So let's go. <br><br><h4>  1) Create a project </h4><br>  Create a folder with the project, so that no one guesses, let's call it <b>angular-project</b> . <br>  (I use <a href="https://www.jetbrains.com/webstorm/">Webstorm</a> , however you can do the same in your editor) <br><br><img src="https://habrastorage.org/web/234/5b2/d6a/2345b2d6a04f452aabd034665ddfe472.png"><br><br><h4>  2) Environment </h4><br>  Install <a href="https://nodejs.org/en/">node.js</a> ( <a href="https://www.npmjs.com/">npm</a> bundled by default). <br><br>  We create <b>package.json</b> , of course, the number of modules connected to the project potentially tends to infinity, but I will leave only the necessary, in my opinion, for full development.  There are many modules, I will try to justify why they are needed. <br><br><div class="spoiler">  <b class="spoiler_title">package.json</b> <div class="spoiler_text"><pre><code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"angular-project"</span></span>, <span class="hljs-string"><span class="hljs-string">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.0.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"angular scaffolding"</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"maxim1006"</span></span>, <span class="hljs-string"><span class="hljs-string">"license"</span></span>: <span class="hljs-string"><span class="hljs-string">"MIT"</span></span>, <span class="hljs-string"><span class="hljs-string">"dependencies"</span></span>: { <span class="hljs-comment"><span class="hljs-comment">//   Angular  "@angular/animations": "^4.3.6", "@angular/common": "^4.3.6", "@angular/compiler": "^4.3.6", "@angular/compiler-cli": "^4.3.6", "@angular/core": "^4.3.6", "@angular/forms": "^4.3.6", "@angular/http": "^4.3.6", "@angular/platform-browser": "^4.3.6", "@angular/platform-browser-dynamic": "^4.3.6", "@angular/router": "^4.3.6", //  hmr "@angularclass/hmr": "^2.1.1", "@angularclass/hmr-loader": "^3.0.2", //polyfills  es5 "core-js": "^2.5.0", //      "reflect-metadata": "^0.1.8", //      "rxjs": "^5.4.3", //  .   js "typescript": "2.3.4", //  js,  ,   "zone.js": "^0.8.17" }, "devDependencies": { //  AoT (Ahead-of-Time Compilation) angular "@ngtools/webpack": "^1.6.2", // ,    typescript "@types/es6-shim": "^0.31.35", "@types/jasmine": "^2.5.54", "@types/node": "^7.0.43", //routing   "angular-router-loader": "^0.6.0", //         "angular2-template-loader": "^0.6.2", //     css "autoprefixer": "^6.3.7", //   typescript  webpack "awesome-typescript-loader": "^3.2.3", //    / "copy-webpack-plugin": "^4.0.1", //   css "css-loader": "^0.28.5", "css-to-string-loader": "^0.1.2", //es6 polyfills "es6-shim": "^0.35.1", //   "hammerjs": "^2.0.8", // webpack   html "html-webpack-plugin": "^2.29.0", //       "less": "^2.7.2", "less-loader": "^4.0.3", //      "on-build-webpack": "^0.1.0", //   webpack   "raw-loader": "^0.5.1", //    "postcss-loader": "^1.3.3", "style-loader": "^0.17.0", // "tslint": "^5.7.0", //  -  "rimraf": "^2.6.1", //    css   base64 "url-loader": "^0.5.8", //webpack "webpack": "^3.5.5", //   express  "webpack-dev-server": "^2.7.1" }, //        npm run __command__ ( npm run serve)  ) "scripts": { // .              ,     .    .    -   .      ,     (   . .),  ( --profile);  ,      webpack   ,  (--watch);       ,    ( ‚Äì-progress). "serve": "webpack-dev-server --config ./webpack.config.js --profile --watch --progress", // ,   serve,     "hmr": "webpack-dev-server --config ./webpack.config.js --profile --watch --progress", // prod     "prod": "npm run aot", //      prod,    "prodServer": "webpack-dev-server --config ./webpack.config.js --open", // ./dist    "clean": "rimraf ./dist", //,   webpack.js ,    aot.   ,    . "aot": "webpack", //   "test": "karma start" } }</span></span></code> </pre> <br></div></div><br><h4>  3) Installation of modules </h4><br>  Through the terminal, go to the folder where package.json is located, and enter the <i>npm i</i> command. <br><br><br><h4>  4) Installing global modules </h4><br>  Since we use the <i>rimraf, webpack</i> and <i>webpack-dev-server commands</i> in the terminal, we will have to explain them to your PC using the <i>npm i rimraf webpack command webpack-dev-server -g</i> <br><br>  After these manipulations, our project was replenished with the <b>node_modules</b> folder <b>.</b> <br><br><img src="https://habrastorage.org/web/6d0/bac/ab1/6d0bacab179047839f88f95a8e761919.png"><br><br><br><h4>  5) README.md </h4><br>  Create a <b>README.md</b> , where, in addition to the link to this article, you can add features for the development of your project. <br><br><br><h4>  6) Linter </h4><br>  Create a <b>tslint.json</b> , I will not stop here, since there is no silver bullet. <br><br><div class="spoiler">  <b class="spoiler_title">tslint.json</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"no-unused-variable"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"curly"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"no-console"</span></span>: [ <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"log"</span></span>, <span class="hljs-string"><span class="hljs-string">"error"</span></span>, <span class="hljs-string"><span class="hljs-string">"debug"</span></span>, <span class="hljs-string"><span class="hljs-string">"info"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"no-debugger"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"no-duplicate-variable"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"no-eval"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"no-invalid-this"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"no-shadowed-variable"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"no-unsafe-finally"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"no-var-keyword"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"triple-equals"</span></span>: [ <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"allow-null-check"</span></span>, <span class="hljs-string"><span class="hljs-string">"allow-undefined-check"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"semicolon"</span></span>: [ <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"always"</span></span>, <span class="hljs-string"><span class="hljs-string">"ignore-interfaces"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"variable-name"</span></span>: [ <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"ban-keywords"</span></span>, <span class="hljs-string"><span class="hljs-string">"check-format"</span></span>, <span class="hljs-string"><span class="hljs-string">"allow-leading-underscore"</span></span> ] } }</code> </pre> <br></div></div><br><h4>  7) PostCss </h4><br>  Create <b>postcss.config.js</b> to not write prefixes to styles. <br><br><div class="spoiler">  <b class="spoiler_title">postcss.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [ <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'autoprefixer'</span></span>)({ <span class="hljs-attr"><span class="hljs-attr">browsers</span></span>: [ <span class="hljs-string"><span class="hljs-string">'last 2 versions'</span></span> ], <span class="hljs-attr"><span class="hljs-attr">cascade</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }) ] };</code> </pre><br></div></div><br>  A little more complicated manipulations will follow, please focus. <br><br><br><h4>  8) Configure Typescript tsconfig.json </h4><br>  Since the development of A2 +, in my opinion, is impossible without <a href="https://www.typescriptlang.org/">typescript</a> , it must be configured.  The settings are normal, but if you have questions, ask in the comments. <br><br><div class="spoiler">  <b class="spoiler_title">tsconfig.json</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-comment"><span class="hljs-comment">//  typescript "compilerOptions": { "target": "es5", "module": "es2015", "declaration": false, "moduleResolution": "node", "sourceMap": true, "emitDecoratorMetadata": true, "experimentalDecorators": true, "removeComments": false, "noImplicitAny": false, "suppressImplicitAnyIndexErrors": true, "skipLibCheck": true, "lib": ["es6", "dom"], "outDir": "./dist/", "typeRoots": [ "./node_modules/@types/" ] }, "compileOnSave": false, "buildOnSave": false, //      ./src "include": [ "./src/**/*" ], // typescript   : "exclude": [ "node_modules/*", "dist/*", "dist-serve/*", "node/*", "**/*.spec.ts" ], // loader  webpack "awesomeTypescriptLoaderOptions": { "forkChecker": true, "useWebpackText": true, "useCache": true }, //  AoT "angularCompilerOptions": { "genDir": ".", "skipMetadataEmit" : true } }</span></span></code> </pre><br></div></div><br><h4>  9) Configure Webpack </h4><br>  The most difficult thing is to let the webpack know what we want from it.  To do this, create a <b>webpack.conf.js</b> , without panic, I will try to explain everything <br><br><div class="spoiler">  <b class="spoiler_title">webpack.conf.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">"use strict"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// node   webpack ,      const path = require('path'); const fs = require('fs'); const webpack = require('webpack'); const WebpackOnBuildPlugin = require('on-build-webpack'); const CopyWebpackPlugin = require('copy-webpack-plugin'); const AotPlugin = require('@ngtools/webpack').AotPlugin; //,  package.json   serve, hmr, prod  . .?  ,   (,    npm run serve,     'serve')      : const ENV = process.env.npm_lifecycle_event ? process.env.npm_lifecycle_event : ''; const isStatic = ENV === 'serve'; const isHmr = ENV === 'hmr'; const isProd = ENV === 'prod'; const isTest = ENV === 'test'; const isAot = ENV.includes('aot'); const isProdServer = ENV.includes('prodServer'); //   ,    webpack   //  webpack.conf.js  ,     module.exports = function makeWebpackConfig() { console.log(`You are in ${ENV} mode`); //    let config = {}; //    //  -   npm run prodServer,    npm run prod,   if (isProdServer) { if (!fs.existsSync('./dist')) { throw "Can't find ./dist, please use 'npm run prod' to get it."; } } // sourcemaps if (isHmr || isStatic) { config.devtool = 'inline-source-map'; } else { config.devtool = 'source-map'; } //  ,    webpack.     index.html   ‚Äú./ng-app.js‚Äù config.entry = { 'ng-app': './src/app/ng-main.ts' }; //  AoT        ,  ‚Ä¶ if (isAot) { config.entry['ng-app'] = './src/app/ng-main-aot.ts'; } //  ,   webpack  'ng-app',    filename: '[name].js',    prod ,      './dist',     path: root('./dist') config.output = isTest ? {} : { path: root('./dist'), //root ‚Äì   ,      ,    webpack.config.js filename: '[name].js' }; //  entry   webpack    - ,   ,    prodServer       prod .       ,     ,  ,  .    ,   webpack.conf.js,    webpack-prod-server.js,       ,    ,       . if (isProdServer) { config.entry = { 'server': './webpack-prod-server.js' }; config.output = {}; } //  ,   webpack   config.resolve = { extensions: ['.ts', '.js', '.json', '.html', '.less', '.svg'] }; //   loaders:     ,   .  ,      ts  js, html   js , less   css    js ,   10   base64    js . config.module = { rules: [ { test: /\.ts$/, use: isAot ? [{loader: '@ngtools/webpack'}] : [ { loader: 'awesome-typescript-loader?' }, { loader: 'angular2-template-loader' }, { loader: 'angular-router-loader' } ].concat(isHmr ? '@angularclass/hmr-loader?pretty=' + !isProd + '&amp;prod=' + isProd : []), exclude: [/\.(spec|e2e|d)\.ts$/] }, { test: /\.html$/, loader: 'raw-loader', exclude: [/node_modules\/(?!(ng2-.+))/, root('src/index.html')] }, { test: /\.(png|jpe?g|gif|svg|woff|woff2|ttf|eot|ico)(\?v=[0-9]\.[0-9]\.[0-9])?$/, loader: "url-loader?name=[name].[ext]&amp;limit=10000&amp;useRelativePath=true" }, { test: /\.less$/, use: [ {loader: "css-to-string-loader"}, {loader: "css-loader"}, {loader: "postcss-loader"}, {loader: "less-loader"} ] } ] }; //     ,   webpack  if (!isTest) { config.plugins = [ //  webpack warcher   new webpack.NoEmitOnErrorsPlugin(), //     .ts ,     .ts     new webpack.DefinePlugin({ 'process.env': { 'STATIC': isStatic, 'HMR': isHmr, 'PROD': isProd, 'AOT': isAot } }), // -    new WebpackOnBuildPlugin((stats) =&gt; { console.log('build is done'); }) ] //    hmr,     hmr .concat(isHmr ? new webpack.HotModuleReplacementPlugin() : []); } //    'npm run prod',     prod   AoT if (isAot) { config.plugins = [ //  AoT  new AotPlugin({ tsConfigPath: './tsconfig.json', entryModule: root('src/app/app.module.ts#AppModule') }), //   new webpack.optimize.UglifyJsPlugin({ compress: { warnings: false, screw_ie8: true, conditionals: true, unused: true, comparisons: true, sequences: true, dead_code: true, evaluate: true, if_return: true, join_vars: true }, output: { comments: false }, sourceMap: true }), //     ./dist  (js     webpack,    ,    ) new CopyWebpackPlugin([ {from: 'index.html', context: './src'}, {from: 'assets/themes/base/fonts/**/*', context: './src'}, {from: 'assets/themes/base/images/other-images/**/*', context: './src'}, ]), new WebpackOnBuildPlugin((stats) =&gt; { console.log('build in aot is done'); }) ]; } //     webpack-dev-server config.devServer = { contentBase: isProdServer ? "./dist" : "./src",//  ,  prod   ./dist,     ./src headers: { "Access-Control-Allow-Origin": "*", "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, PATCH, OPTIONS", "Access-Control-Allow-Headers": "X-Requested-With, content-type, Authorization" }, //   rest  historyApiFallback: true, // HTML5 history api,   1  compress: true,// gzip quiet: false, //        inline: isHmr || isStatic || isProdServer, //inline mode hot: isHmr, // hmr,   hmr  stats: "minimal", port: 9000, //      Webpack overlay: { errors: true }, //  webpack warcher watchOptions: { aggregateTimeout: 50, ignored: /node_modules/ } }; return config; }; //      function root(__path = '.') { return path.join(__dirname, __path); }</span></span></code> </pre><br></div></div><br><h4>  10) src structure </h4><br>  Now our project looks like this, except for the <b>src</b> folder <br><br><img src="https://habrastorage.org/web/5dc/ad8/949/5dcad89492394ca0be84fa682d8c942f.png"><br><br>  Create a structure in the <b>src</b> folder: <br><br><img src="https://habrastorage.org/web/152/5bb/17c/1525bb17c2554be0900c3fb7c51b1795.png"><br><br>  A couple of comments: in the <b>app</b> folder will be our angular application, in the <b>assets</b> folder, auxiliary files, <b>index.html</b> just put in src.  In assets, we will support the theme and split folders for convenient work with fonts, pictures, styles. <br><br>  In our company, we use the <a href="https://ru.bem.info/">BEM</a> methodology, which is slightly more refined and more optimal, in our opinion.  <b>base.less</b> - aggregate .less file for the base theme: <br><br><div class="spoiler">  <b class="spoiler_title">base.less</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">// Common @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> "themes/base/styles/common/normalize"; @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> "themes/base/styles/common/colors"; @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> "themes/base/styles/common/common"; @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> "themes/base/styles/common/fonts"; @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> "themes/base/styles/common/vars"; // Blocks // (please, <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> blocks <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> alphabetical <span class="hljs-keyword"><span class="hljs-keyword">order</span></span>) @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> "themes/base/styles/blocks/app-component";</code> </pre><br></div></div><br>  Note that, in our opinion, the functional and style parts of the application should be distributed: this solves a number of problems of both assembly and project support.  If you use the BEM and the paradigm of one block - one less file, then the approach does not show any problems.  However, there are a bunch of alternatives.  In more detail to rummage in assets it is possible in the appendix, to this post.  Ask questions in the comments to the article. <br><br><h4>  11) index.hml </h4><br>  <b>index.html</b> - has become incredibly simple in A2 + applications <br><br><div class="spoiler">  <b class="spoiler_title">index.html</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">base</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> //  A2+ routing <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Landing<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width, initial-scale=1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image/x-icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/img/favicon.ico"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">app-component</span></span></span><span class="hljs-tag">&gt;</span></span>Loading...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">app-component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./ng-app.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><h4>  12) Angular app </h4><br>  Let's take a deep breath, we have already done everything complicated, now the framework itself remains) <br><br>  Create a structure in the <b>app</b> folder: <br><br><img src="https://habrastorage.org/web/a7c/b17/440/a7cb17440f87413793e05ddbedb8a5bb.png"><br><br>  At first glance - rebus. <br><br>  However, if you have completed at least the <a href="https://angular.io/tutorial">Angular 2+ Tutorial</a> , then all this is already familiar to you.  For the rest, brief comments: the whole application is divided into modules, the framework even provides such an entity - module.  There is a main module - app.module.ts, there are additional modules that extend the functionality of the application.  Most applications will have home, lazy and shared modules.  The names of the modules, of course, are optional, but if you follow the rules for naming, you will not have problems with the extensibility of the application. <br><br>  We won't talk a lot about the framework itself, there is excellent <a href="https://angular.io/guide/quickstart">documentation</a> .  Better focus on the subtle points: <br><br><h4>  ng-main.ts </h4><br>  It begins with him <br><br><div class="spoiler">  <b class="spoiler_title">ng-main.ts</b> <div class="spoiler_text"><pre> <code class="hljs markdown">import './ng-polyfills'; //   ie 9+ import ‚Ä¶ //  webpack   ,    if (process.env.STATIC) { //console.log("<span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">***You are in Dev mode**</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">*"); platformBrowserDynamic().bootstrapModule(AppModule).then(():any =&gt; {}); } else if (process.env.HMR) { //  hmr  Angular //console.log("*</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">**You are in HMR mode**</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span>*"); bootloader(main); } export function main() { return platformBrowserDynamic() .bootstrapModule(AppModule) }</code> </pre><br></div></div><br><h4>  ng-main-aot.ts for AoT </h4><br>  For the <a href="https://angular.io/guide/aot-compiler">AoT</a> (Ahead-of-Time Compilation) mode, create another main ng-main-aot.ts file, so you need ... <br><br><div class="spoiler">  <b class="spoiler_title">ng-main-aot.ts</b> <div class="spoiler_text"><pre> <code class="hljs markdown">import ‚Ä¶ console.log("<span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">***You are in prod mode**</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span><span class="hljs-strong"><span class="hljs-strong">*****</span></span>*"); enableProdMode(); platformBrowser() .bootstrapModuleFactory(<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">any</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>AppModuleNgFactory) .catch(error=&gt;console.log(error));</code> </pre><br></div></div><br><h4>  HMR, styles, hammerjs </h4><br>  HMR, the styles of our application (just in case, left an example of connecting images) and the hammerjs settings for mobile development are connected to <b>app.module.ts</b> in this way: <br><br><div class="spoiler">  <b class="spoiler_title">app.module.ts</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">require("style-loader!../assets/base.less"); //    webpack <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ‚Ä¶ // hammer.js export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> MyHammerConfig extends HammerGestureConfig { overrides = &lt;<span class="hljs-keyword"><span class="hljs-keyword">any</span></span>&gt;{ <span class="hljs-string"><span class="hljs-string">'swipe'</span></span>: {velocity: <span class="hljs-number"><span class="hljs-number">0.4</span></span>, threshold: <span class="hljs-number"><span class="hljs-number">20</span></span>} } } @NgModule({ declarations: [ AppComponent, ], imports: [ BrowserModule, HomeModule, NgRoutingModule ], providers: [ ], bootstrap: [ AppComponent ] }) export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> AppModule { constructor(<span class="hljs-built_in"><span class="hljs-built_in">public</span></span> appRef: ApplicationRef) {} hmrOnInit(store) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!store || !store.state) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'restoreInputValues'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> store) { store.restoreInputValues(); } this.appRef.tick(); <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> store.state; <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> store.restoreInputValues; } hmrOnDestroy(store) { let cmpLocation = this.appRef.components.map(cmp =&gt; cmp.<span class="hljs-keyword"><span class="hljs-keyword">location</span></span>.nativeElement); store.disposeOldHosts = createNewHosts(cmpLocation); store.state = {data: <span class="hljs-string"><span class="hljs-string">'yolo'</span></span>}; store.restoreInputValues = createInputTransfer(); removeNgStyles(); } hmrAfterDestroy(store) { store.disposeOldHosts(); <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> store.disposeOldHosts; } }</code> </pre><br></div></div><br><h4>  Lazy loading </h4><br>  Lazy loading of modules we connect in <b>ng-routing.module.ts</b> <br><br><div class="spoiler">  <b class="spoiler_title">ng-routing.module.ts</b> <div class="spoiler_text"><pre> <code class="hljs coffeescript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ‚Ä¶ const routes: Routes = [ {path: <span class="hljs-string"><span class="hljs-string">''</span></span>, redirectTo: <span class="hljs-string"><span class="hljs-string">'/home'</span></span>, pathMatch: <span class="hljs-string"><span class="hljs-string">'full'</span></span>}, {path: <span class="hljs-string"><span class="hljs-string">'home'</span></span>, component: HomeComponent}, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  lazy ,  .js  webpack     {path: <span class="hljs-string"><span class="hljs-string">'lazy'</span></span>, loadChildren: <span class="hljs-string"><span class="hljs-string">'./modules/lazy/lazy.module#LazyModule'</span></span>}, {path: <span class="hljs-string"><span class="hljs-string">'**'</span></span>, component: PageNotFoundComponent}, ]; @NgModule({ imports: [ RouterModule.forRoot(routes) ], exports: [ RouterModule ] }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NgRoutingModule</span></span></span><span class="hljs-class"> { }</span></span></code> </pre><br></div></div><br>  After connecting the lazy module in the router, you need to do the following in the module that we want to load deferred (using the example of lazy.module.ts): <br><br><div class="spoiler">  <b class="spoiler_title">lazy.module.ts</b> <div class="spoiler_text"><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> routes: Routes = [ {path: <span class="hljs-string"><span class="hljs-string">''</span></span>, component: LazyComponent}, ]; <span class="hljs-meta"><span class="hljs-meta">@NgModule</span></span>({ imports: [SharedModule, RouterModule.forChild(routes)], <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span>: [LazyComponent], declarations: [LazyComponent] }) export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LazyModule</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre><br></div></div><br>  Hmm ... well, that's all.  You can dig in the app folder in the <a href="https://github.com/maxim1006/angular-project">attachment</a> to this post. <br><br>  To develop a page reload for every code change in the editor, we write in the terminal, being in the folder with package.json: <i>npm run serve</i> <br>  The same, but without page reload: <i>npm run hmr</i> <br>  Making a prod build with AoT: <i>npm run prod</i> <br>  Run a static server to view the prod: <i>npm run prodServer</i> <br>  Clean the ./dist folder: <i>npm run clean</i> <br><br>  Just a few steps and we work: <b>webpack build with Angular 4, AoT, HMR, Lazy loading</b> .  Everything, including patterns and styles, is neatly put into a bundle and optimized. <br>  Of course, this configuration can be expanded, improved, changed, but in my opinion, it is quite enough to boldly begin to develop with Angular 2+. <br><br>  PS <br><br>  <b>AoT</b> small advertisement: a great boost to the performance of your SPA application on Angular. <br><br><img src="https://habrastorage.org/webt/i2/mu/bc/i2mubcxc1_hhzp427hapv5iovsy.png"><br><br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/337540/">https://habr.com/ru/post/337540/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337528/index.html">Parallelism versus multithreading versus asynchronous programming: an explanation</a></li>
<li><a href="../337532/index.html">10 years with hummingbirds: how it was</a></li>
<li><a href="../337534/index.html">Fads Stream API</a></li>
<li><a href="../337536/index.html">Fix 7 common exception handling errors in java</a></li>
<li><a href="../337538/index.html">‚ÄúYoung people want to buy shares of familiar start-ups on the stock exchange‚Äù: finance trends according to the founder of the Robinhood service</a></li>
<li><a href="../337546/index.html">Why don't CRM work</a></li>
<li><a href="../337548/index.html">Kaggle: how our nets considered sea lions in the Aleutian Islands</a></li>
<li><a href="../337550/index.html">Learn OpenGL. Part 2.4. - Texture Cards</a></li>
<li><a href="../337554/index.html">The path of the Jedi. From a small user to an employee of an IT company</a></li>
<li><a href="../337556/index.html">SAMBA File Server Based on Linux CentOS 7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>