<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why connect under attack to DDoS neutralization service is too late</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""I used to have to think . " This Russian maxim is applicable to many life situations, but in protecting network resources from denial of service atta...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why connect under attack to DDoS neutralization service is too late</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/a7f/b51/42c/a7fb5142c6894f36a903c876f233ac06.png"><br><br>  <b>"I used to have to think</b> . <b>"</b>  This Russian maxim is applicable to many life situations, but in protecting network resources from denial of service attacks, these words are doubly true. <br><br>  Pre-planning is extremely important if you are going to create a popular and competitive service somewhere on the Internet - not only attackers, but also competitors can pay attention to it.  In the end, an unexpected and large influx of users is essentially no different from a distributed attack. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you have not bothered to protect in advance, the conditions in which you have to return to this topic may be completely suboptimal.  We decided to present to the reader a few basic points - the difficulties that any service will face that are under attack and trying to connect to a system for neutralizing denial of service attacks. <br><a name="habracut"></a><br>  <i>Lyrical digression: if you are going to go on vacation in a tropical country on another continent, then it is useful, in addition to conventional travel insurance, to take care of the issue of vaccinations against the most dangerous and common diseases.</i> <i><br><br></i>  <i>Yes, the chance of a mosquito bite is small, if you wear a long sleeve and roll pants into socks.</i>  <i>In the extreme case, of course, they will save you.</i>  <i>But this process can be delayed, you will spend a lot of nerves and, quite possibly, funds for medical specialists and drugs both on site and upon return.</i>  <i>But all you had to do was put a vaccination against a dangerous disease and make sure that your insurance covers all cases.</i> <br><br><h3>  What are the advantages of connecting to the network filtering traffic before the attack? </h3><br>  The first and most important thing is the knowledge of user behavior.  Observing the traffic of the target resource before the stress, we are well aware of what the normal behavior of the users of the resource is and what traffic statistics are natural for the resource.  When under attack, a gradual (or fast, it all depends on the actions of the attackers) degradation of the service occurs, as a result of which the behavior of normal users of the resource changes significantly.  In some cases, the actions of legitimate users begin to look like an attack and worsen its consequences, as an example - a cyclic update of the same page by the user until the desired page is received in the browser. <br><br>  The stronger the degradation of the service under attack, the more difficult it is to distinguish legitimate users from malicious bots.  If we have not seen the behavior of users on the threshold of an attack with normal and proven legitimate behavior, we do not know in advance how it is possible to distinguish a real user from a malicious bot who sends garbage requests to the server.  In addition, the amount of traffic that accompanies a normal service workflow would also be known. <br><br>  If at the beginning of the attack, the network or filtration equipment was not included in its neutralization, then in the process of learning for automation and learning models, all users who click on ‚ÄúRefresh page‚Äù are almost indistinguishable from the attack traffic, respectively, the probability of their blocking is high.  Knowing the previous behavior of users of the resource, you can protect both them and yourself from the occurrence of a similar situation. <br><br>  Similarly, with the traffic volume and traffic statistics in a normal situation - in the absence of such information at the time of the attack, it will be very difficult to say with certainty whether the traffic returned to normal after neutralizing the attack due to the fact that real users could get blocked just possessing slightly different from the median behavior during the degradation of the service under attack. <br><br>  Of course, such problems are not always encountered, but become especially acute in some attack scenarios.  Depending on the complexity of the attacking bot and the cunning of the attacker, an attack at the root of the service can become really unpleasant - in this case, when the service is degraded, the behavior of the bots looks almost indistinguishable from the behavior of legitimate users who simply do not open anything.  In the case of attacks of another type, as a rule, significant differences remain in the legitimate and harmful behavior in terms of data flows. <br><br>  <i>Imagine a banal domestic situation - a breakthrough of a water pipe, a flood.</i>  <i>You were not ready for it, there were no plugs at hand, locking taps on the pipe and so on, the worst scenario.</i>  <i>You can quickly plug the hole and stop the flow, but furniture and children's toys are already floating throughout the apartment, and guests are knocking on the door.</i>  <i>Can you let them go?</i>  <i>Hardly.</i> <br><br><h3>  What are the real disadvantages and possible consequences when connecting under attack? </h3><br>  <b>‚ÄúFrom a sick head to a healthy one‚Äù</b> is about neutralizing DDoS.  And oddly enough, but even for a long time, companies on the market with professional employees and thousands of consumers across the country or even around the world do not always think about the neutralization of DDoS before the attack begins.  We would like to change this situation with the help of conveying adequate information to the audience, but we will not build illusions - until the thunder clap, the peasant will not cross himself. <br><br>  Let's look at the main difficulties and difficulties that a resource under attack has to cope with, and we, as a service that neutralizes distributed attacks. <br>  The first thing that can be stated with confidence in the case of a service connecting to the filtering system while under attack is that it is highly likely to experience partial or complete inaccessibility among users. <br><br>  Secondly, if you are attacked, then most likely the attacker already knows not only your domain name, but also the IP address.  In addition, usually the IP address of the attacked resource belongs to the hoster, therefore we a priori consider that the hoster is also known.  That is, the attacker has sufficient information to modify the attack vector. <br><br>  In order to quickly move to another hosting provider (it is possible that they are not attacking you), or to change the IP transit provider (perhaps you are just a side victim of attacking a larger target) it takes time. <br><br>  Of course, working out false positive is not the only difficulty.  Connecting under attack does not eliminate the problem of partial or complete unavailability, and if the attack has already begun and managed to cause some harm, then besides work on connecting the resource to the protection system, ‚Äúdamage control‚Äù is needed, that is, work on the consequences of the attack on the consumer and customer side. <br><br>  It happens that the attack "went well" and caused considerable damage.  Literally, this means the following: in addition to clogging the communication channel, through which it will be necessary anyway to organize connectivity with the cloud traffic filtering provider, while there are no dedicated channels, the border router or the balancer can ‚Äúdie‚Äù (deny service).  It can also be bad for other infrastructural components, for example, a firewall (firewall), which is a delicate device and does not like distributed denial-of-service attacks, often looks at the disconnection from the outside world.  The stopping of the normal firewall operation threatens a hole in the network perimeter.  Yes, it is treated by resetting the failed equipment, but it is still necessary to get there and wait for it to return to a consistent state.  All this time, traffic is passed without filtering. <br><br>  Speaking of attacks on the application layer (L7), here and with the channel, everything can be good, and there is connectivity, but the web application is still sick, depressed and can, for example, fall off from the base, or fall with it.  And its return to a normal consistent state can take from several hours to several days, depending on the existing architectural difficulties. <br><br>  To traffic filtering networks there are two most common ways to connect - using DNS or BGP.  Consider these two scenarios separately. <br><br><h4>  DNS </h4><br>  Suppose that the attack is carried out only by the domain name. <br><br>  A typical scenario for connecting a site under an DNS attack is as follows: the owner of a network resource represented by a domain name, whose A-record has the current IP address of the web server being attacked, contacts us for help.  After complying with all the formalities, Qrator Labs assigns the client a special IP address with which it replaces its current address. <br><br>  As a rule, at this moment you have to take into account the possible high TTL to change the DNS record, which can be from several hours to days maximum (RFC limit: 2147483647 seconds) - during this time the old A-record will exist in the cache of DNS recursors.  Therefore, if you realize in advance that an attack is likely, it is necessary to have a low TTL for the A-record DNS. <br><br>  But in some cases even this may not save.  After all, the attackers during the attack check its effectiveness, and seeing that the attack does not give a result, the smart villain will quickly switch to the attack to the IP address that he "remembers", bypassing the filtering network. <br><br>  In this case, you need a new IP address, unknown to the attackers and in no way compromising the protected domain name, preferably in a different address block from the old one, and ideally from another service provider.  After all, attackers can always go ahead and switch the DDoS attack vector to the address block (prefix) of the provider, with sufficient power.  Well, to us - you are welcome.  Moving on. <br><br><h4>  Bgp </h4><br>  In the case of a BGP connection, everything looks different. <br><br>  If the attacked service has its own address blocks (prefixes) and wants to transfer the entire infrastructure under protection, announcing its own prefixes through the DDoS neutralization service provider - what does the process look like? <br><br>  The autonomous system under attack is added to our AS-SET in order to be able to announce its own prefixes, after which the notorious day (24 hours) begins to receive this information with all our uplinks and update the prefix lists.  Naturally, in an emergency, we try to meet such a client, forcing this process, but this is not possible in each case and is done manually.  In the light of the above, time is a key and main stress factor, because protecting a resource requires urgent, ‚Äúanesthetize instantly.‚Äù <br><br>  In the case when the prefix owner prepares for an attack in advance, conducting a number of preliminary settings, he can be transferred to the Qrator filtering network almost instantly, saving time and nerves of technical specialists during after-hours and in an emergency mode.  Mutual integration in this case is not only a technical, but also a psychological process. <br><br>  <i>Lyrical digression: your connectivity service provider buys IP transit, usually from large and reliable telecom operators, not lower than regional Tier-1 carriers.</i>  <i>They filter the prefixes that come to them from clients, based on a certain list (prefix-list), which they take from open databases (RIPE, RADB and others).</i>  <i>Regularly some providers of IP transit services for protection from DDoS update these filters cyclically once a day, others do it only on request.</i>  <i>A competent service provider neutralizing DDoS points of presence are located around the world, you can not instantly roll it.</i> <br><br>  The most difficult case of connection under attack is the appeal of the owner of a complex infrastructure that has a variety of equipment: routers, firewalls, load balancers and other wonders of modern technology.  In such scenarios, even a regular connection to a DDoS neutralization service provider is a complex process, which is a balanced and planned approach.  Even it is somehow embarrassing to mention that in the event of an attack on such a service, its emergency connection to the filtering network eats up a lot of effort and leaves no time for careful planning, because every minute counts under attack.  While these problems are not solved, the service has problems with accessibility to users and is degrading. <br><br>  Often, a DDoS attack is combined in a certain order with a hacker attack - on breaking and entering, either before the denial of service attack or after.  Here risks of a completely different order are involved: the leakage of user data, the attacker getting full access to the system.  These problems need to be solved perpendicularly with the neutralization of DDoS, which in the worst case leads to even longer unavailability of users, and at best - to an increased delay from those who are trying to request the necessary page. <br><br><hr><blockquote>  <a href="https://www.facebook.com/QratorLabs/posts/1401713649907901">Postscript</a> <br>  Colleagues, we bring the following important news to your attention: <a href="https://www.ietf.org/mail-archive/web/idr/current/msg18258.html">www.ietf.org/mail-archive/web/idr/current/msg18258.html</a> <br><br>  The initiative to introduce an automatic protection against the occurrence of ‚Äúroute leaks‚Äù (route leaks), which was directly involved in the creation of Qrator Labs engineers, successfully passed the ‚Äúacceptance call‚Äù stage and moved to the Interdomain Routing working group (IDR). <br><br>  The next stage is the finalization of the document within the framework of the IDR and, further, the verification by the steering group ( <a href="https://www.ietf.org/iesg/">IESG</a> ).  If these stages are successfully completed, the draft will become the new network standard <a href="https://www.ietf.org/rfc.html">RFC</a> . <br><br>  Authors: Alexander Azimov, Evgeny Bogomazov, Randy Bush (Randy Bush, Internet Initiative Japan), Kotikalapudi Sriram (Kotikalapudi Sriram, US NIST) and Keyur Patel (Keyur Patel, Arrcus Inc.) realize that there is an acute demand for proposed changes in the industry .  However, the rush in this process is also unacceptable, and the authors will make every effort to make the proposed standard convenient for both transnational operators and small home networks. <br><br>  We thank the technical specialists who expressed their support in the framework of the adoption call.  At the same time, special thanks to those who not only expressed their opinion, but also sent their comments.  We will try to take them into account with subsequent changes to this draft. <br><br>  We also want to convey to interested engineers that you still have the opportunity to express your own wishes for making additions and clarifications through the IETF newsletter (draft-ymbk-idr-bgp-open-policy@ietf.org) or through <a href="https://initiatives.qrator.net/">the</a> Qrator Labs <a href="https://initiatives.qrator.net/">initiative website.</a> . <br><br>  It is also important to note that by the time the final decision is made, the standard should have two working implementations.  One of them is already available - this is our development based on the Bird raiding demon, available on Github: <a href="https://github.com/QratorLabs/bird">github.com/QratorLabs/bird</a> .  We invite vendors and the open source community to join this process. </blockquote></div><p>Source: <a href="https://habr.com/ru/post/331080/">https://habr.com/ru/post/331080/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331066/index.html">Edge computing will replace cloud computing?</a></li>
<li><a href="../331070/index.html">‚ÄúColleagues, everything has fallen!‚Äù What can go wrong on the meta-search site and what to do about it? Part 1</a></li>
<li><a href="../331072/index.html">How to patch KÃ∂DÃ∂EÃ∂ TCP stack under FreeBSD</a></li>
<li><a href="../331074/index.html">Report from Moscow Data Science Meetup May 31</a></li>
<li><a href="../331078/index.html">We are testing the capabilities of ARKit. Create a game with augmented reality</a></li>
<li><a href="../331082/index.html">Frequencies and network capacity - everything you wanted to ask</a></li>
<li><a href="../331086/index.html">What can go wrong on the meta-search site and what to do about it? Part 2</a></li>
<li><a href="../331088/index.html">Reduce the use of Redux code with React Apollo</a></li>
<li><a href="../331090/index.html">Shallow immersion or data recovery from the hard drive after flooding the office</a></li>
<li><a href="../331092/index.html">Cricket Lee and Paul Vixie's Webinar on Network Security with DNS RPZ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>