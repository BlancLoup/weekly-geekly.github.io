<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Localization of WPF applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the article I will talk about existing approaches to localization of WPF applications and show in detail the localization process using resource fi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Localization of WPF applications</h1><div class="post__text post__text-html js-mediator-article">  In the article I will talk about existing approaches to localization of WPF applications and show in detail the localization process using resource files (resx).  This can be useful for those who are just starting to learn WPF or are already working with this technology, but have not encountered multilingual applications. <br><a name="habracut"></a><br>  <a href="http://msdn.microsoft.com/en-us/library/ms788718.aspx">MSDN</a> offers several ways to localize WPF applications ‚Äî for example, an XML file, a resource file (RESX), or via XAML.  As an example, the last option was considered there, its advantages are described - but there are also a number of drawbacks, like: <br>  1) Different sources for localization of the UI itself (markup elements) and messages from the code (MessageBox, any status changes, etc.). <br>  2) Unnecessary dances with editing the project, unloading the table of rows through the console, loading them into satellite assemblies. <br>  3) Careful control of the Uid of each UI element. <br>  There are also own approaches, for example <a href="http://www.dotnetfunda.com/articles/article811-simplest-way-to-implement-multilingual-wpf-application-.aspx">through MergedDictionaries</a> . <br>  Due to various reasons, each of them did not suit me very well - either unnecessary gestures (such as manual editing the csproj file, shamanism with the developer machine locales), attracting various additional utilities, unnecessary pieces of code (merging dictionaries depending on locale) is a trifle but unaesthetic.  But with the resx files, everything went perfectly - and moreover, it left the usual workflow (with WinForms) of translating the application. <br>  Let's take a closer look at how to use the features of Visual Studio to localize WPF applications.  Let's create a test project WpfAppLocalized with one window - Login. <br><img src="https://habrastorage.org/getpro/habr/post_images/766/295/851/76629585170fcdfef0c6548c23f08fd0.png"><br>  To begin with, we will determine which elements need to be localized - the Login, Password tags, the Login, Cancel buttons, messages about an invalid login / password, a message about successful login. <br>  So, open the automatically created resource file WpfAppLocalized / Properties / Resources.resx (or create a new resource file) - and fill in the string resources with the necessary values. <br><img src="https://habrastorage.org/getpro/habr/post_images/5a2/244/d6e/5a2244d6eb8dc1436648b80ce15aaa80.png"><br>  In the code, you can access resources in several ways - but the Studio helpfully creates proxy classes - and you can use the static properties of the automatically generated class WpfAppLocalization.Properties.Resources to access the value - this moment is extremely important.  In the meantime, let's start with the simplest - the display of messages.  We write a simple handler for clicking on Login: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">if</font> (Login.Text.Equals( <font color="#A31515">"admin"</font> ) &amp;&amp; Password.Password.Equals( <font color="#A31515">"admin"</font> )) <br> { <br> MessageBox.Show(Properties.Resources.LoginSuccessfullMessage); <br> } <br> <font color="#0000ff">else</font> <br> { <br> ErrorMessage.Text = Properties.Resources.LoginFailedMessage; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Everything is simple and clear.  But now the turn of the most interesting is localization of XAML markup.  Of course, you can act in the forehead - assign a name to each element and, at the time of initializing the components, assign values ‚Äã‚Äãfrom resources to the desired properties - but this is not the Jedi way.  As I noted above, Studio generates a class for a resource file with a set of static properties for accessing each resource line ... and ‚ÄúOf course, x: Static!‚Äù Immediately comes to mind.  Markup-Extension x: Static is used to initialize the property values ‚Äã‚Äãof XAML elements through static properties.  But first, you need to declare your namespace, through which we will refer to the static class in the markup: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Window</font> <font color="#ff0000">x:Class</font> <font color="#0000ff">="WpfAppLocalized.MainWindow"</font> <br> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</font> <br> <font color="#ff0000">xmlns:x</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml"</font> <br> <font color="#ff0000">xmlns:res</font> <font color="#0000ff">="clr-namespace:WpfAppLocalized.Properties"</font> <br> <font color="#ff0000">Title</font> <font color="#0000ff">="Login"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="150"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="270"</font> <font color="#ff0000">MaxWidth</font> <font color="#0000ff">="270"</font> <font color="#ff0000">MinWidth</font> <font color="#0000ff">="270"</font> <font color="#ff0000">MaxHeight</font> <font color="#0000ff">="150"</font> <font color="#ff0000">MinHeight</font> <font color="#0000ff">="150"</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The most important line for us is ‚Äúxmlns: res =‚Äú clr-namespace: WpfAppLocalized.Properties ‚Äù.‚Äù  This is the actual binding of the XML namespace res to the namespace in the code.  Now you can fill in the values ‚Äã‚Äãof the properties of the controls via Static - and this is how it looks for the Login tag: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">TextBlock</font> <font color="#ff0000">HorizontalAlignment</font> <font color="#0000ff">="Right"</font> <font color="#ff0000">VerticalAlignment</font> <font color="#0000ff">="Center"</font> <font color="#ff0000">Grid</font> . <font color="#ff0000">Column</font> <font color="#0000ff">="0"</font> <font color="#ff0000">Text</font> <font color="#0000ff">="{x:Static res:Resources.LoginLabel}"</font> <font color="#0000ff">/&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  As you noticed, the Text property is now initialized via extension Static ‚Äî i.e.  The value of the LoginLabel static property of the Resources class is taken.  However, if you try to do this in Visual Studio, the editor will say that ‚ÄúType 'res: Resources' does not contain a static member named 'LoginLabel'‚Äù, and when launched, the exception ‚Äú'WpfAppLocalized.Properties.Resources.LoginLabel' StaticExtension cannot be resolved to an enumeration, static field, or static property ".  The reason is very simple - by default, the proxy class for resources is generated with the internal modifier - i.e.  these resources are not available to the XAML loader.  You just need to change the modifier to public - after that the application will work. <br><img src="https://habrastorage.org/getpro/habr/post_images/5cd/858/d3b/5cd858d3b6caac2f4f887fd223d08f0d.png"><br><br>  So, at this stage, all interface elements and all messages use only texts from resources - now it‚Äôs time to add support for various languages.  This is done very simply - you just need to copy the source file of Resources Resources.resx - to the new Resources. {Cl-LN} .resx, where cl is the culture (country) and LN is the language.  For example, for the Russian language in Russia, the resource file will be called Resources.ru-RU.resx.  For, for example, Canada - we can make two files Resources.ca-EN.resx, Resources.ca-FR.resx - for English and French.  If there is no need for division into languages, then it can be omitted, Resources.ru.resx - will be applied to the country of Russia.  So, we open a new resource file - and we see that it is now filled in the same way as the main one - but now you can safely translate the inscriptions in English into your native Russian - and to avoid unnecessary files in the project, put an access modifier for this resource No code generation ( Yes, weird such a modifier). <br><img src="https://habrastorage.org/getpro/habr/post_images/a90/8ad/8aa/a908ad8aae03da80089e4023b03e61d4.png"><br>  Great, translation is complete.  Now it's time to ask - where do you need to code the logic of resource selection depending on the culture?  The answer is - but nowhere is it necessary.  After a successful build of the application, another folder will appear in the EXE folder, containing the WpfAppLocalized.resources.dll file.  These are localized resources.  At the time of launch, the .NET Framework application, depending on the culture and language of the operating system, will load one or another satellite assembly and, accordingly, certain resources will be used.  Here is the localized version of the application: <br><img src="https://habrastorage.org/getpro/habr/post_images/c5c/a7a/e6b/c5ca7ae6ba9683f279016936fdc93413.png"><br><br>  That's all, thank you for your attention. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      PS While re-reading the article, I thought - what questions could potentially arise and decided to answer right away. <br><br>  <b>Q:</b> How to forcefully change the application language (give a choice to the user, for example)? <br>  <b>A:</b> The system determines which culture resources to load using the value System.Threading.Thread.CurrentThread.CurrentUICulture.  Accordingly, to change the language of the application to Russian in the WpfAppLocalization constructor before InitializeComponent you need to add: <br>  System.Threading.Thread.CurrentThread.CurrentUICulture = System.Globalization.CultureInfo.GetCultureInfo ("en-US"); <br><br>  <b>Q:</b> Can I use the same resource assembly in different applications? <br>  <b>A:</b> Yes, you can - only the namespace connection will change a little - the assembly name will be added there - xmlns: res = "clr-namespace: WpfAppLocalized.Properties, assembly = GlobalRes.dll". <br><br>  <b>Q:</b> What if the application is launched with a language for which there is no satellite assembly? <br>  <b>A:</b> The resources of the main assembly will be used. <br><br>  UPD: <a href="http://narod.ru/disk/18612298000/WpfAppLocalized.zip.html">Laid out the WpfAppLocalized</a> project. </div><p>Source: <a href="https://habr.com/ru/post/86778/">https://habr.com/ru/post/86778/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../86770/index.html">Good CSS Rules</a></li>
<li><a href="../86773/index.html">CDP (Cisco Discovery Protocol) on Linux</a></li>
<li><a href="../86774/index.html">Medvedev suggested that Yanukovych think about using a single navigation and time space</a></li>
<li><a href="../86776/index.html">HDin.tv closes</a></li>
<li><a href="../86777/index.html">What is a genetic algorithm?</a></li>
<li><a href="../86781/index.html">Habra-colorer - script for coloring your handy tools</a></li>
<li><a href="../86783/index.html">Invented "larks" and "owls"</a></li>
<li><a href="../86787/index.html">Steam on MAC - officially!</a></li>
<li><a href="../86789/index.html">How interface management works through finger gestures and touches</a></li>
<li><a href="../86790/index.html">Grails - the holy grail of a web developer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>