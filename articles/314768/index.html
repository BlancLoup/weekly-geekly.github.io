<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Interplanetary File System IPFS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="InterPlanetary File System is a new decentralized file sharing network. It also acts as a content delivery network . 


 The difference from other dec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Interplanetary File System IPFS</h1><div class="post__text post__text-html js-mediator-article"><p>  <a href="https://ru.wikipedia.org/wiki/IPFS">InterPlanetary File System</a> is a new decentralized file sharing network.  It also acts as <a href="https://ru.wikipedia.org/wiki/Content_Delivery_Network">a content delivery network</a> . </p><br><p>  The difference from other decentralized networks is that the unit itself is the unit transmitted in the network.  A block can contain both part of a file and links to other blocks.  A <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B0%25D0%25BF%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BA%25D0%25BB%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584">directed acyclic graph is</a> built from the blocks from which a file or directory is subsequently collected. </p><br><p>  Such a system allows a more flexible approach to the storage and transmission of data in the network.  <s>The disadvantage of this approach is that everything that is loaded into the network is cut into blocks and put in a separate directory on your disk.</s>  (Corrected: <a href="https://habrahabr.ru/post/331010/">"no longer need to copy to the network"</a> ) Search by file name or directory in IPFS is absent as well as in the BitTorrent network. </p><br><p> <a href="https://habrahabr.ru/post/314768/"><img src="https://habrastorage.org/getpro/habr/post_images/fd3/316/1e3/fd33161e38ad164adb32a3e384cd2f5d.svg" alt="image"></a> </p><a name="habracut"></a><br><br><h2 id="multihesh">  Multikhesh </h2><br><pre><code class="hljs vbscript">Base58: QmcXx5mKDQAc7tCWLq84Hn7XFxWfBdZpvogJk3tNXQRFiv <span class="hljs-built_in"><span class="hljs-built_in">HEX</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> D2E8A669F85E864B5C285CAB18DE72CF8927DC1643516373FEFF871A69F2A127</code> </pre> <br><p>  The identifier in this decentralized network is the <a href="https://github.com/multiformats/multihash">sha128</a> wrapped in a <a href="https://github.com/multiformats/multihash">multi-</a> hash from the block.  A multi-hash consists of three parts: ID hash function, hash size in bytes, hash.  To store the ID and size is used now one byte, but their values ‚Äã‚Äãcannot be greater than or equal to 128 until they are determined with the <a href="https://github.com/multiformats/unsigned-varint">unsigned-varint format by</a> which they are indicated.  Multihesh in the links is encoded in <a href="https://ru.wikipedia.org/wiki/Base58">Base58 bitcoin</a> . </p><br><p>  The multi-hash is used with a reserve for the future so that the network would have the opportunity to switch to new more stable hash functions. </p><br><p>  Now the multihash is part of <a href="https://habr.com/post/331010/">the content id</a> . </p><br><h2 id="klient">  Customer </h2><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">ipfs</span></span> daemon</code> </pre> <br><img src="https://cdn.rawgit.com/ivan386/51cd3b171b49098dca9c288814eafe80/raw/1bd1c9b5bf54a518ea996bd43d1b37da193a1696/ipfs-files.svg" alt="image"><br><p>  In working condition for the IPFS network, there is a <a href="https://github.com/ipfs/go-ipfs">multiplatform client</a> written by GO.  You can <a href="https://ipfs.io/ipns/dist.ipfs.io/">download</a> it and <a href="https://github.com/ipfs/go-ipfs">compile it</a> yourself. </p><br><p>  The <code>ipfs daemon</code> command starts the client that provides the web interface.  You can enter it at the default address <a href="http://127.0.0.1:5001/webui"></a>  <a href="http://127.0.0.1:5001/webui">http://127.0.0.1 span001/webui</a> </p><br><p>  You can add a file and directory to the network using the command <code>ipfs add [  ]</code> or <code>ipfs add -r [  ]</code> .  You can also add files via webui on page <a href="http://127.0.0.1:5001/webui"></a>  <a href="http://127.0.0.1:5001/webui">http://127.0.0.1 span001/webui#files</a> . </p><br><p>  After adding a file or directory, its multi-cache will be displayed.  <code>ipfs repo gc</code> added in this way are automatically attached, that is, they will not be deleted if you issue the <code>ipfs repo gc</code> command.  They also become available throughout the network through these multi-chests.  If you open the web interface page <a href="http://127.0.0.1:5001/webui"></a>  <a href="http://127.0.0.1:5001/webui">http://127.0.0.1</a> span001/webui#objects you can see how the files are represented on the network by entering their multi-hash in the search bar.  It shows the contents of the block. </p><br><h2 id="blok">  Block </h2><br><p>  Above, I said that a separate unit on the network is a block.  If you take from the page <a href="http://127.0.0.1:5001/webui"></a>  <a href="http://127.0.0.1:5001/webui">http://127.0.0.1</a> span001/webui#objects a multi-cache of a file block and add to it <code>http://127.0.0.1:8080/ipfs/</code> then the network will give part of a file or directory corresponding to the block with this multi-cache. </p><br><p>  For direct work with raw blocks, ipfs also has commands: </p><br><pre> <code class="bash hljs"> ipfs block get &lt;key&gt; -  raw IPFS . ipfs block put &lt;data&gt; -    IPFS . ipfs block rm &lt;<span class="hljs-built_in"><span class="hljs-built_in">hash</span></span>&gt;... -  IPFS (). ipfs block <span class="hljs-built_in"><span class="hljs-built_in">stat</span></span> &lt;key&gt; -    raw IPFS .</code> </pre> <br><p>  With the help of <code>ipfs block get []</code> I found out what corresponds to the multi-cache from the test file I just uploaded with the command <code>ipfs add [   ]</code> using <a href="http://rhash.anz.ru/">RHash</a> and the <a href="http://lenschulwitz.com/base58">Base58 online decoder</a> .  Files smaller than 262158 bytes are stored on the network in one block.  The format of this block, <s>I have not figured out</s> the default is the <a href="https://habr.com/post/423073/">data packaged in Protocol Buffers</a> . </p><br><p>  It is interesting that webui is stored in a decentralized network and part of the client‚Äôs code is also stored in it.  The code is downloaded from the network automatically before compiling the client.  Why this is done I do not know.  This makes reading the source code a bit difficult. </p><br><h2 id="shlyuz">  Gateway </h2><br><p>  The IPFS network has access to a regular network.  That is, through the website gateway.ipfs.io, you can access any file or directory available on the IPFS network.  To do this, it is enough to know its multihash and add it to the address <code>http://gateway.ipfs.io/ipfs/[]</code> . </p><br><p>  Some clients of decentralized networks have learned to pull data on http (s).  The website <a href="https://gateway.ipfs.io/">gateway.ipfs.io</a> can be used as a WebSeed.  And if you have both IPFS and another WebSeed client installed at the same time, then the second will be able to use IPFS locally via <code>http://127.0.0.1:8080/ipfs/[]</code> . </p><br><p>  In this article ‚Äú <a href="https://habrahabr.ru/post/268275/">Why the Internet needs IPFS, it‚Äôs not too late</a> ‚Äù, browsers suggest adding an extension that will change the address of <code>ipfs.io</code> to <code>127.0.0.1:8080</code> .  This is necessary to view IPFS content through a local client in a browser. </p><br><h2 id="eksperimenty-s-ipfs-i-bittorrent">  Experiments with IPFS and BitTorrent </h2><br><p>  Experimenting with IPFS <a href="https://ru.wikipedia.org/wiki/BitTorrent_(%25D0%25BF%25D1%2580%25D0%25BE%25D1%2582%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25BB)">WebSeed</a> and qBittorent, I noticed that the local IPFS is very slow in sending the data requested in a random order.  Only when I turned on the serial download speed increased to 1MB / s.  And that all distribution blocks are in the local storage.  Also IPFS heavily loads the processor. </p><br><p>  For BitTorrent IPFS, the client can serve as a good deduplicator.  He can find copies of files on IPFS multihash directory or file.  To do this, add it as a WebSeed to the torrent. </p><br><h3 id="ipfs-webseed">  IPFS WebSeed </h3><br><p>  In order to distribute the contents of a directory using IPFS WebSeed, you need <s>to transfer to another empty directory before uploading to IPFS and</s> add it to the download <code>ipfs add -w -r [  ]</code> command <code>ipfs add -w -r [  ]</code> .  The source directory will be accessed via the link <code>http://gateway.ipfs.io/ipfs/[]/[  ]</code> or <code>http://127.0.0.1:8080/ipfs/[]/[  ]</code> . </p><br><p>  BitTorrent clients automatically add the full path to the file from the torrent to the WebSeed link in case it is a torrent directory.  It‚Äôs enough to add a link like WebSeed <code>http://gateway.ipfs.io/ipfs/[]</code> or <code>http://127.0.0.1:8080/ipfs/[]</code> . </p><br><p>  For a single-file torrent, simply adding the file with the <code>ipfs add [  ]</code> command <code>ipfs add [  ]</code> and WebSeed links to it will be of the same kind <code>http://gateway.ipfs.io/ipfs/[]</code> or <code>http://127.0.0.1:8080/ipfs/[]</code> . </p><br><p>  To ensure that files do not occupy double space on the disk, you need to use the - <code>--nocopy</code> key.  How to enable and use it in the article <a href="https://habrahabr.ru/post/331010/">"no longer need to copy to the network</a> . <a href="https://habrahabr.ru/post/331010/">"</a> </p><br><p>  After that, the obtained links can be added to the created <a href="https://ru.m.wikipedia.org/wiki/.torrent">torrent file</a> or <a href="https://ru.m.wikipedia.org/wiki/Magnet-%25D1%2581%25D1%2581%25D1%258B%25D0%25BB%25D0%25BA%25D0%25B0">magnet</a> . </p><br><p>  Magnet example: </p><br><pre> <code class="hljs 1c">magnet:?xt=urn:btih:aaaaaaa...<span class="hljs-meta"><span class="hljs-meta">&amp;ws=http:</span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//gateway.ipfs.io/ipfs/[]</span></span></span></span></code> </pre> <br><h3 id="webtorrent-i-ipfs-webseed">  WebTorrent and IPFS WebSeed </h3><br><p>  WebTorrent can only work with the local IPFS gateway and only after configuration, as the gateway must give permission for WebTorrent to use the HTTP header Range. </p><br><p>  To do this, open <a href="http://127.0.0.1:5001/webui"></a>  <a href="http://127.0.0.1:5001/webui">http://127.0.0.1 span001/webui#config</a> </p><br><p>  And in the line: </p><br><pre> <code class="javascript hljs"> <span class="hljs-string"><span class="hljs-string">"Access-Control-Allow-Headers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"X-Requested-With"</span></span> ],</code> </pre> <br><p>  add "Range": </p><br><pre> <code class="javascript hljs"> <span class="hljs-string"><span class="hljs-string">"Access-Control-Allow-Headers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"X-Requested-With"</span></span>, <span class="hljs-string"><span class="hljs-string">"Range"</span></span> ],</code> </pre> <br><p>  then save and restart IPFS </p><br><h2 id="mezhplanetnaya-sistema-imyon">  Interplanetary Name System </h2><br><p>  Also, each client has the opportunity to bind an object to the multi-cache of his public key.  At the <code>gateway.ipfs.io</code> site, <code>gateway.ipfs.io</code> can access this object by adding the multi-key public key to the address <code>http://gateway.ipfs.io/ipns/</code> .  In order to bind or retrieve an object through a multi-key of a public key, there are commands: </p><br><pre> <code class="bash hljs"> ipfs name publish &lt;ipfs-path&gt; -    IPNS. ipfs name resolve [&lt;name&gt;] -     IPNS .</code> </pre> <br><p>  The combination of free DNS, <code>http://gateway.ipfs.io/ipns/[  ]</code> and IPFS client allows you to distribute a small static site from your home server even while you are behind NAT. </p><br><h2>  Interplanetary File System and Magnet </h2><br><p>  Now IPFS does not know how to work with <a href="https://ru.wikipedia.org/wiki/Magnet-%25D1%2581%25D1%2581%25D1%258B%25D0%25BB%25D0%25BA%25D0%25B0">magnet links,</a> and yes, it is not described by the <a href="https://ru.wikipedia.org/wiki/URN">URN</a> which contains the multi-cache used in the network. </p><br><p>  I suggest this: urn: ipfs: [Base58 bitcoin encoded IPFS multihash] </p><br><p>  In the magnet link, it will accordingly look like this: </p><br><pre> <code class="hljs">magnet:?xt=urn:ipfs:[Base58 bitcoin encoded IPFS multihash]</code> </pre> <br><p>  <u>Example:</u> </p><br><pre> <code class="hljs">magnet:?xt=urn:ipfs:QmcXx5mKDQAc7tCWLq84Hn7XFxWfBdZpvogJk3tNXQRFiv</code> </pre> <br><p>  By writing a small script, you can teach IPFS to work with magnets or other decentralized clients to use IPFS as WebSeed. </p><br><p>  I think the use of magnet links will get rid of the ipfs.io site with which the same story can happen as with the <a href="https://habrahabr.ru/post/21119/">shareaza domain</a> .  And more clearly identify IPFS multihash. </p><br><h2 id="nemnogo-ne-po-teme">  A bit off topic </h2><br><p>  I drew for magnets (actually wrote) a logo for free use.  I want to present it so that it becomes a recognizable magnet-reference symbol and was used to designate it.  Maybe then I can roll back the cancellation of my edits in the article on the magnet links and return the logo to the article. </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/67f/663/d40/67f663d40d524138f1e3dcc9fc606dd2.svg" alt="magnet link"></a>  he's on <a href="https://github.com/ivan386/magnet-uri-logo">github</a> </p><br><p>  The colors for the magnet are taken from the customers' logos of the decentralized networks.  I am not a designer.  I tried to make drawing simple and compact.  You are free to copy and modify it. </p><br><h4 id="istochniki">  Sources </h4><br><ul><li>  <a href="https://ru.wikipedia.org/wiki/IPFS">IPFS</a> </li><li>  <a href="https://ipfs.io/docs/commands/">IPFS command reference</a> </li><li>  <a href="https://github.com/multiformats/multihash">Multikhesh</a> </li><li>  " <a href="https://habr.com/post/268275/">Why does the Internet need IPFS before it's too late</a> ?" </li><li>  " <a href="https://habr.com/post/310554/">Work in IPFS with a human face</a> " </li></ul><br><h4 id="prodolzhenie">  Continuation </h4><br><ol><li>  <a href="https://habr.com/post/316468/">We publish the site in the interplanetary file system IPFS</a> <br>  In this article I will tell you how to start a static site in it that will be accessible both directly and by IPNS.  The site will have a normal domain name due to the use of DNS.  The domain name can be used to access the site directly, through a global and local gateway. <br></li><li>  <a href="https://habr.com/post/325176/">We host a site in the interplanetary IPFS file system under Windows</a> <br>  Some time has passed since the beginning of my experiments with hosting simple sites in IPFS.  I launched my IPFS client under Windows and now I have something to add to the previous article. </li><li>  <a href="https://habr.com/post/331010/">No need to copy to the network</a> <br>  The idea of ‚Äã‚ÄãIPFS is good for everyone, but there was only one flaw with it.  Data uploaded to the network were copied to the block storage by doubling the space they occupied.  Moreover, the file was cut into blocks that are of little use for reuse. <br><br>  There is an experimental option --nocopy, which eliminates this drawback.  In order to use it, it is necessary to fulfill several conditions. </li><li>  <a href="https://habr.com/post/334584/">Switch your site to localhost (local IPFS gateway)</a> <br>  It makes little sense in IPFS, if you use it only as a free hosting for a site on the Internet.  Therefore, we will learn how to download our site through the user's local IPFS gateway. <br></li><li>  <a href="https://habr.com/post/331014/">Localize the global gateway or sites in IPFS</a> <br>  We will learn to switch to your local IPFS gateway sites that do not automatically do this themselves yet.  Let's create them a shared SSL certificate using OpenSSL bundled with Stunnel. <br></li><li>  <a href="https://habr.com/post/423073/">Trivial hash (identity), DAG block and Protocol Buffers</a> <br>  Recently, I added support for a trivial (identity) hash in IPFS.  The trivial hash is the data itself.  The data does not change at all and, accordingly, the size of the ‚Äúhash‚Äù is equal to the size of the data.  In my article I will tell about it and show how it can be used. <br></li></ol></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/314768/">https://habr.com/ru/post/314768/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../314756/index.html">Programmer Archeology</a></li>
<li><a href="../314758/index.html">Can a computer book remain relevant 30 years after writing?</a></li>
<li><a href="../314762/index.html">Early release or sustained?</a></li>
<li><a href="../314764/index.html">The basis of the system business - basic analytics</a></li>
<li><a href="../314766/index.html">Chrome extension hot reboot</a></li>
<li><a href="../314770/index.html">Configuring the internal navigation system using the tools Aruba</a></li>
<li><a href="../314772/index.html">3CX v15 VPS replaces the multi-tenant version of 3CX Phone System 14</a></li>
<li><a href="../314774/index.html">The remote proxy class is not (very) painful</a></li>
<li><a href="../314776/index.html">Know the competitor in person: how we conducted a competitive analysis</a></li>
<li><a href="../314778/index.html">NetApp ONTAP & ESXi 6.x tuning</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>