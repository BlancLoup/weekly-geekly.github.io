<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Universal Startup Class</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After reading this habratopik. I decided to share my autoloader class (if someone comes in handy), who can recursively search for the necessary files,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Universal Startup Class</h1><div class="post__text post__text-html js-mediator-article">  After reading <a href="http://habrahabr.ru/blogs/php/136761/">this</a> habratopik.  I decided to share my autoloader class (if someone comes in handy), who can recursively search for the necessary files, not only classes, but any other file transferred to him, well, if there is no file found where indicated, it searches the entire server starting from the root , if the file is found somewhere not there, generates a corresponding message, is able to work with the namespace and log its actions if necessary. <br><a name="habracut"></a><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">youNameSpace</span></span> { /** *    * *     ,    .&lt;<span class="hljs-title"><span class="hljs-title">br</span></span>/&gt; *     ,  &lt;<span class="hljs-title"><span class="hljs-title">br</span></span>/&gt; *         ,&lt;<span class="hljs-title"><span class="hljs-title">br</span></span>/&gt; *      (   ),   . * * @<span class="hljs-title"><span class="hljs-title">author</span></span> :   * @<span class="hljs-title"><span class="hljs-title">version</span></span> 1.0 * @<span class="hljs-title"><span class="hljs-title">copyright</span></span>:   */ <span class="hljs-title"><span class="hljs-title">class</span></span> <span class="hljs-title"><span class="hljs-title">Autoloader</span></span> { /** *,    * * @<span class="hljs-title"><span class="hljs-title">var</span></span> <span class="hljs-title"><span class="hljs-title">type</span></span> <span class="hljs-title"><span class="hljs-title">const</span></span> * */ <span class="hljs-title"><span class="hljs-title">const</span></span> <span class="hljs-title"><span class="hljs-title">debug</span></span> = 0; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ; } <span class="hljs-comment"><span class="hljs-comment">/** *      .&lt;br/&gt; *   ,    . * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $file  ( ) * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $ext  ( ) * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $dir   (    ) * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> false * */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">autoload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($file, $ext = FALSE, $dir = FALSE)</span></span></span><span class="hljs-function"> </span></span>{ $file = str_replace(<span class="hljs-string"><span class="hljs-string">'\\'</span></span>, <span class="hljs-string"><span class="hljs-string">'/'</span></span>, $file); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ext === <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span>) { $path = $_SERVER[<span class="hljs-string"><span class="hljs-string">'DOCUMENT_ROOT'</span></span>] . <span class="hljs-string"><span class="hljs-string">'/classes'</span></span>; $filepath = $_SERVER[<span class="hljs-string"><span class="hljs-string">'DOCUMENT_ROOT'</span></span>] . <span class="hljs-string"><span class="hljs-string">'/classes/'</span></span> . $file . <span class="hljs-string"><span class="hljs-string">'.php'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $path = $_SERVER[<span class="hljs-string"><span class="hljs-string">'DOCUMENT_ROOT'</span></span>] . (($dir) ? <span class="hljs-string"><span class="hljs-string">'/'</span></span> . $dir : <span class="hljs-string"><span class="hljs-string">''</span></span>); $filepath = $path . <span class="hljs-string"><span class="hljs-string">'/'</span></span> . $file . <span class="hljs-string"><span class="hljs-string">'.'</span></span> . $ext; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file_exists($filepath)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ext === <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Autoloader::debug) Autoloader::StPutFile((<span class="hljs-string"><span class="hljs-string">' '</span></span> .$filepath)); <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span>($filepath); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Autoloader::debug) Autoloader::StPutFile((<span class="hljs-string"><span class="hljs-string">'   '</span></span> .$filepath)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $filepath; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $flag = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Autoloader::debug) Autoloader::StPutFile((<span class="hljs-string"><span class="hljs-string">'    &lt;b&gt;'</span></span> . $file . <span class="hljs-string"><span class="hljs-string">'&lt;/b&gt;  &lt;b&gt;'</span></span> . $path . <span class="hljs-string"><span class="hljs-string">'&lt;/b&gt;'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Autoloader::recursive_autoload($file, $path, $ext, $flag); } } <span class="hljs-comment"><span class="hljs-comment">/** *      . * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $file  ( ) * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $path    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $ext   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $flag         * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> bool * */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">recursive_autoload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($file, $path, $ext, &amp;$flag)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span> !== ($handle = opendir($path)) &amp;&amp; $flag) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">FAlSE</span></span> !== ($dir = readdir($handle)) &amp;&amp; $flag) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos($dir, <span class="hljs-string"><span class="hljs-string">'.'</span></span>) === <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span>) { $path2 = $path .<span class="hljs-string"><span class="hljs-string">'/'</span></span> . $dir; $filepath = $path2 . <span class="hljs-string"><span class="hljs-string">'/'</span></span> . $file .(($ext === <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span>) ? <span class="hljs-string"><span class="hljs-string">'.php'</span></span> : <span class="hljs-string"><span class="hljs-string">'.'</span></span> . $ext); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Autoloader::debug) Autoloader::StPutFile((<span class="hljs-string"><span class="hljs-string">'  &lt;b&gt;'</span></span> .$file .<span class="hljs-string"><span class="hljs-string">'&lt;/b&gt; in '</span></span> .$filepath)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file_exists($filepath)) { $flag = <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ext === <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Autoloader::debug) Autoloader::StPutFile((<span class="hljs-string"><span class="hljs-string">' '</span></span> .$filepath )); <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span>($filepath); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Autoloader::debug) Autoloader::StPutFile((<span class="hljs-string"><span class="hljs-string">'   '</span></span> .$filepath )); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $filepath; } } $res = Autoloader::recursive_autoload($file, $path2, $ext, $flag); } } closedir($handle); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $res; } <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $data    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void * */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">StPutFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($data)</span></span></span><span class="hljs-function"> </span></span>{ $dir = $_SERVER[<span class="hljs-string"><span class="hljs-string">'DOCUMENT_ROOT'</span></span>] .<span class="hljs-string"><span class="hljs-string">'/Log/Log.html'</span></span>; $file = fopen($dir, <span class="hljs-string"><span class="hljs-string">'a'</span></span>); flock($file, LOCK_EX); fwrite($file, (<span class="hljs-string"><span class="hljs-string">'‚ïë'</span></span> .$data .<span class="hljs-string"><span class="hljs-string">'=&gt;'</span></span> .date(<span class="hljs-string"><span class="hljs-string">'dmY H:i:s'</span></span>) .<span class="hljs-string"><span class="hljs-string">'&lt;br/&gt;‚ïë&lt;br/&gt;'</span></span> .PHP_EOL)); flock($file, LOCK_UN); fclose ($file); } } \spl_autoload_register(<span class="hljs-string"><span class="hljs-string">'youNameSpace\Autoloader::autoload'</span></span>); } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/136887/">https://habr.com/ru/post/136887/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136879/index.html">Some file sharing services suspend</a></li>
<li><a href="../136880/index.html">Justin's robot has become even more agile.</a></li>
<li><a href="../136883/index.html">Size of java objects. We use the knowledge gained</a></li>
<li><a href="../136885/index.html">Advertising in the mobile version of LJ</a></li>
<li><a href="../136886/index.html">Three approaches to the methodology of building a complex client application</a></li>
<li><a href="../136888/index.html">How I stopped being afraid and fell in love with the UEFI Security Boot</a></li>
<li><a href="../136893/index.html">Windows Azure Toolkits for Devices - using Windows Azure on mobile platforms</a></li>
<li><a href="../136894/index.html">I do not share the tribulation of MegaUpload</a></li>
<li><a href="../136895/index.html">Dependency injection in the MVC 3 Framework by the example of Autofac</a></li>
<li><a href="../136896/index.html">Glonass in Ukraine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>