<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About networks: a little bit of everything</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently we had small training courses to increase our competence in the network part of our infrastructure. The main idea of ‚Äã‚Äãthese courses, coverin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About networks: a little bit of everything</h1><div class="post__text post__text-html js-mediator-article">  Recently we had small training courses to increase our competence in the network part of our infrastructure.  The main idea of ‚Äã‚Äãthese courses, covering OSPF / BGP / MPLS, I will not repeat here because: <br><ul><li>  Not yet competent enough. </li><li>  There are many more objective resources about these topics. </li></ul><br>  So here I will describe interesting near-network points that were affected in the learning process.  Some of this may seem trivial to you, but I will try to compensate for the boredom when you read it with an abundance of references to additional materials. <br><br>  <em>Links to wikis are often more remarkable in the ‚ÄúExternal links‚Äù and ‚ÄúReferences‚Äù sections than in the content itself.</em> <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Ethernet Frame Format </h2><br>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Ethernet_frame">Ethernet frame</a> is actually not such a simple thing.  Everyone knows about DMAC, <br>  SMAC and VLAN Tag.  However, about Preamble, Start of frame and Interframe gap are usually <br>  forget.  I'm not talking about the FCS about which to forget is very bad.  Field <br>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Ethertype">Size / Type</a> is generally worth refreshing from time to time. <br><br><br><h2>  Switch Modes </h2><br>  There are several modes of switching.  Here are the most popular ones: <br><ul><li>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Store_and_forward">Store and forward</a> - Handles the entire package.  Checks FCS.  Teaches SMAC. <br>  More reliably, because it defines broken frames. </li><li>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Cut-through_switching">Cut-through</a> - Looks only at DMAC.  Moden in Infiniband and the rest HPC <br>  for reduces delays.  Requires manual filling of the switching table.  there is <br>  its subspecies: Fragment-free, however, is used only in domains where possible <br>  collisions. </li></ul><br><br><br><h2>  Mask / 31 </h2><br>  There is a special RFC on the use of the mask 255.255.255.254 - <a href="https://tools.ietf.org/html/rfc3021">RFC 3021</a> . <br>  In short - by making point-to-point links, you can save the space of IP addresses using 31 masks. <br><br><br><h2>  Selective ACK </h2><br>  While talking about TCP in general and <a href="https://secure.wikimedia.org/wikipedia/en/wiki/TCP_congestion_avoidance_algorithm">TCP congestion avoidance</a> in particular, <br>  started talking about the definition of drops.  Normal ACK (also called <br>  cumulative acknowledgment) allows you to identify only one lost packet per <br>  one RTT, and given the current network speeds and window sizes (about the <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Window_scaling">Window</a> <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Window_scaling"><br></a>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Window_scaling">I</a> also recommend reading <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Window_scaling">Scaling</a> .  For those who are lazy: WND must be greater than <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Bandwidth-delay_product">BDP</a> ) there is a big chance of multiple drops in one window.  In case of one <br>  drop in TCP is stored in <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Slow-start">Fast recovery</a> .  However, several packages are lost at once. <br>  and the link‚Äôs RTT is large, then TCP performance drops dramatically. <br>  By the way, <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Explicit_Congestion_Notification">ECN</a> protects against drops, if you have not heard, you can read about it, too. <br><br><br><h2>  MAC address </h2><br>  In fact, the <a href="https://secure.wikimedia.org/wikipedia/en/wiki/MAC_address">MAC</a> address structure is not entirely random.  Most admins <br>  know that MAC is divided into two parts: <a href="http://standards.ieee.org/develop/regauth/oui/public.html">OUI</a> (which uniquely indicates <br>  manufacturer) and NIC Specific (unique network number). <br>  But there are two more special bits in MAC: 7th and 8th bits of the first octet.  If 8th <br>  the bit is set to 1, then the multicast address, otherwise unicast.  If the 7th bit is <br>  one, the address is so-called.  locally administered by address, i.e.  address <br>  assigned to the network card manually (well, or it is used by hardware / software, which IEEE <br>  did not allocate OUI). <br>  For example, the Virtual Box interface on my machine has a MAC <br>  0a: 00: 27: 00: 00: 00 - notice that he is unicast and is locally administered <br>  for 0x0a = 0b00001010. <br>  And the STP protocol multicast MAC 01: 80: C2: 00: 00: 00 - the eighth bit of the first octet <br>  set to one. <br>  If anyone suddenly had a question, why did they choose such strange bits, 7 and 8, <br>  then the answer is pretty darn simple: when transferring bytes over the network, each byte is transmitted <br>  backwards, as detailed in <a href="https://tools.ietf.org/html/rfc2469">RFC 2469</a> . <br><br><br><h2>  Wi-Fi </h2><br>  There was quite a lot of new things for me. <br><ul><li>  802.11n can use <a href="https://secure.wikimedia.org/wikipedia/en/wiki/IEEE_802.11_RTS/CTS">RTS / CTS</a> !  Etozh straight RS-232 some =).  By the way <br>  RTS / CTS is a implementation of <a href="https://secure.wikimedia.org/wikipedia/en/wiki/CSMA/CA">Carrier</a> <a href="https://secure.wikimedia.org/wikipedia/en/wiki/CSMA/CA"><br></a>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/CSMA/CA">avoidance</a> (CSMA / CA) and <a href="https://secure.wikimedia.org/wikipedia/en/wiki/CSMA/CD">Carrier is</a> used in Ethernet segments with hubs <a href="https://secure.wikimedia.org/wikipedia/en/wiki/CSMA/CD"><br></a>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/CSMA/CD">sense multiple access with collision detection</a> (CSMA / CD). </li><li>  <a href="">802.11s</a> - mesh networking - peer-to-peer for Wi-Fi.  I read a lot of commits <br>  in FreeBSD on this topic, but never touched. </li><li>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/LWAP">Access Point</a> Management and Provisioning Protocols: <a href="https://secure.wikimedia.org/wikipedia/en/wiki/LWAP">Lightweight Access Point</a> <a href="https://secure.wikimedia.org/wikipedia/en/wiki/LWAP"><br></a>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/LWAP">Protocol</a> and <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Capwap">Control And Provisioning of Wireless Access Points</a> </li></ul><br>  And in general, about <a href="">802.11,</a> I know very, very little, I am glad that <a href="http://serverfault.com/questions/72767/why-is-internet-access-and-wi-fi-always-so-terrible-at-large-tech-conferences">I am</a> not the only <a href="http://serverfault.com/questions/72767/why-is-internet-access-and-wi-fi-always-so-terrible-at-large-tech-conferences">one</a> =) <br><br><br><h2>  Bgp </h2><br><h4>  N WLLA OMNI </h4><br><br>  The letters above are the mnemonic record of the process of choosing the best BGP route. <br>  N valid next-hop, W weights, L - local preferency, L - locally originated, A - <br>  as path, O - origin, M - med, N - High type, I - IGP metric. <br>  Taken from the <a href="http://www.amazon.com/CCIE-Routing-Switching-Certification-Guide/dp/1587201968/ref%3Dsr_1_5%3Fie%3DUTF8%26amp%3Bqid%3D1315438880%26amp%3Bsr%3D8-5">CCIE Routing and Switching Exam Certification Guide (3rd Edition)</a> . <br><br><br><h2>  Autonomous system </h2><br><pre> An IP is a prefixes run by one IP group.
 or more network operators who have a SINGLE and CLEARLY DEFINED
 routing policy.
</pre><br>  This must be realized.  AS is not only a 32-bit number.  It is also recommended to <br>  <a href="https://tools.ietf.org/html/rfc1930">RFC 1930</a> reading <br><br><br><h2>  Internet voice dial </h2><br><h3>  Organization </h3><br><ul><li>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Icann">ICANN</a> is the governing organization for IANA. </li><li>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Internet_Assigned_Numbers_Authority">IANA</a> - Organization managing distribution of IP'shnikov.  They also hold <br>  root-dns server.  By the way, she has a great page with numbers on the site, <br>  Direct read not reread: <a href="http://www.iana.org/protocols/">Protocol Registries</a> </li><li>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Regional_Internet_registry">RIR</a> - Regional Recorders.  Do all the black work for IANA.  On <br>  currently there are 5 of them. Back in 2002 there were only 3. So you see, Antarctica has its own <br>  will appear. </li><li>  <a href="https://en.wikipedia.org/wiki/National_Internet_registry">NIR</a> - National Recorders.  There are only some countries (for example, Japan, China, Korea, etc.) </li><li>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Local_Internet_registry">LIR</a> - Any large provider with a large block can become one. <br>  IP'shnikov. </li></ul><br><br><h3>  Address types </h3><br><ul><li>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Provider-independent_address_space">PI</a> - Provider Independent Addresses - drag yourself wherever you want. </li><li>  <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Provider-aggregatable_address_space">PA</a> - Addresses attached to the higher provider - if it leaves you - remain without them. </li></ul><br>  More information about their differences can be read in <a href="http://www.ripe.net/ripe/docs/ripe-127">ripe-127</a> <br><br><br><br><h2>  Bfd </h2><br>  While discussing every legacy type RIP and its holddown timer'y remembered <br>  the beautiful thing is <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Bidirectional_Forwarding_Detection">Bidirectional Forwarding Detection</a> , which allows two <br>  directly connected glands to determine the vigor of Forwarding Engine <br>  Sub-second Link Side and Integrity: <a href="https://tools.ietf.org/html/rfc5880">RFC 5880</a> .  There is also <br>  option to check ipv4 / ipv6 connectivity between, again, directly connected <br>  Hosts: <a href="https://tools.ietf.org/html/rfc5881">RFC 5881</a> . <br>  As an alternative to BFD, you can unscrew the timers from IGP, but this method has <br>  its disadvantages, which writes itself Cisco: <a href="http://www.cisco.com/en/US/technologies/tk648/tk365/tk480/technologies_white_paper0900aecd80244005.html">Bidirectional Forwarding Detection</a> <a href="http://www.cisco.com/en/US/technologies/tk648/tk365/tk480/technologies_white_paper0900aecd80244005.html"><br></a>  <a href="http://www.cisco.com/en/US/technologies/tk648/tk365/tk480/technologies_white_paper0900aecd80244005.html">for OSPF</a> <br><br><br><h2>  Network Architecture </h2><br><h3>  CDA </h3><br>  The 3-tier architecture was developed and proposed by Cisco as a standard.  Meaning <br>  is to divide the network into parts: Core, Distribution and Access.  Our <br>  The lecturer highly recommended to use L3 switches at each level in order to <br>  terminate L2 as far as possible from the kernel.  However, for mere mortals come down and <br>  scheme from L2 to Access. <br>  On the subject is written the car and a small truck (in the form of QoS), so that it does not repeat <br>  I will, and I will only make a reference to <a href="http://www.cisco.com/en/US/docs/solutions/Enterprise/Campus/campover.html">Enterprise Campus 3.0 Architecture: Overview</a> <a href="http://www.cisco.com/en/US/docs/solutions/Enterprise/Campus/campover.html"><br></a>  <a href="http://www.cisco.com/en/US/docs/solutions/Enterprise/Campus/campover.html">and Framework</a> . <br><br><h3>  CE-PE </h3><br>  A scheme that recognizes the existence of different AS within our architecture. <br>  For the first time along with CDA, I saw it in the book <a href="http://www.amazon.com/Junos-High-Availability-Practices-Network/dp/0596523041">Junos High Availability: Best</a> <a href="http://www.amazon.com/Junos-High-Availability-Practices-Network/dp/0596523041"><br></a>  <a href="http://www.amazon.com/Junos-High-Availability-Practices-Network/dp/0596523041">Practices for High Network Uptime</a> , I recommend you read it (p. <br>  339). <br><br><br><h2>  Discontiguous subnet masks aka "ripped" masks </h2><br>  Everyone is used to the fact that a subnet mask can be expressed by a prefix, that is, to have <br>  consecutive set of units on the left (or their complete absence)  However masks <br>  may be torn, so for example, a mask of the form: <br> <code>11111111.11111111.11111111.00000001</code> <br>  can be quite valid and will match every second host / 24 <br>  subnet.  Of course, not all equipment supports torn masks. <br>  The use of torn masks outside the test environment is extremely contraindicated.  You've <br>  been warned. <br><br><br><h2>  Anycast </h2><br>  Extremely often, anycast is mentioned in the IPv6 context only.  Of course, back in the distant <br>  RFC1886, already three times obsolete, was called such a type of address as Anycast. <br>  However, this is not the first RFC describing them (one of the first mentions of Anycast, I <br>  found in <a href="https://tools.ietf.org/html/rfc1546">RFC1546: Host Anycasting Service</a> ) and it has been used for a long time already in <br>  IPv4 is often bundled with BGP / IGP.  So for example the DNS part of the root servers is <br>  Anycast addresses. <br>  According to GOST ^ W RFC anycast is: <br><blockquote>  Anycast: the practice of making a particular Service Address <br>  available in multiple, discrete, autonomous locations, such that <br>  datagrams sent are routed to one of several available locations. </blockquote><br>  Note: not a protocol, not a standard, but simply a methodology (or how is it still fashionable? <br>  call Best Practice) to create a failover, decentralized <br>  service.  <code>anycast-best-practices</code> themselves can be read in RFC 4786: <a href="https://tools.ietf.org/html/rfc4786">Operation</a> <a href="https://tools.ietf.org/html/rfc4786"><br></a>  <a href="https://tools.ietf.org/html/rfc4786">of Anycast Services</a> <br><br><blockquote>  Anycast addresses are allocated from the unicast address space, using <br>  any of the defined unicast address formats.  Thus, anycast addresses <br>  are syntactically indistinguishable from unicast addresses.  When a <br>  unicast address is assigned <br>  it is an address <br>  assigned must be explicitly configured <br>  address. </blockquote><br>  The above-described <a href="https://tools.ietf.org/html/rfc4291">RFC 4291</a> hints at us to distinguish anycast. <br>  the address from unicast "by eye" is generally not realistic. <br>  PS  Of course, you should pay tribute to IPv6 in which the concept of Anycast is still more <br>  less formalized, for example, the first and the last 128 hosts of the subnet <br>  are by definition anycast addresses.  You can read more in <a href="https://tools.ietf.org/html/rfc2526">Reserved</a> <a href="https://tools.ietf.org/html/rfc2526"><br></a>  <a href="https://tools.ietf.org/html/rfc2526">IPv6 Subnet Anycast Addresses</a> <br><br><br><h2>  Address selection in general. </h2><br>  In the IPv4 world, everything was very simple: there was <code>gethostbyname(3)</code> , which had <br><br>  <code>h_addr</code> or, as a last resort, own logic around <code>h_addr_list</code> .  WITH <br>  the advent of IPv6, everything has become much more interesting: now there is <a href="https://tools.ietf.org/html/rfc3493">getaddrinfo (3)</a> in <br>  where the <code>addrinfo</code> list is sorted according to non-trivial rules: <a href="https://tools.ietf.org/html/rfc3484">Default Address</a> <a href="https://tools.ietf.org/html/rfc3484"><br></a>  <a href="https://tools.ietf.org/html/rfc3484">Selection for Internet Protocol version 6 (IPv6)</a> .  Here is a list of BSD's <code>libc</code> : <br><pre>
 / *
 * Rule 1: Avoid unusable destinations.
 * XXX: we exist.
 * /

 / * Rule 2: Prefer matching scope.  * /

 / * Rule 3: Avoid deprecated addresses.  * /

 / * Rule 4: Prefer home addresses.  * /
 / * XXX: not implemented yet * /

 / * Rule 5: Prefer matching label.  * /

 / * Rule 6: Prefer higher precedence.  * /

 / * Rule 7: Prefer native transport.  * /
 / * XXX: not implemented yet * /

 / * Rule 8: Prefer smaller scope.  * /

 / *
 * Rule 9: Use longest matching prefix.
 * We compare the match length in a AF.
 * /

 / * Rule 10: Otherwise, leave the order unchanged.  * /
</pre><br>  This actually means that DNS round-robin is not quite honest now. <br>  Looking for additional information and default values ‚Äã‚Äãyou can look at: <br>  Linux: <code>cat /etc/gai.conf</code> <br>  FreeBSD: <code>ip6addrctl show</code> <br><br><br><h2>  "Special" IPv4 addresses </h2><br>  Just an interesting article for self-development: <a href="https://tools.ietf.org/html/rfc5735">Special Use IPv4 Addresses</a> .  If a <br>  remove all the banal (private addresses and multicast) and not really <br>  interesting (test networks), then there is a stash (in the form of <code>240.0.0.0/4</code> ) and <a href="https://tools.ietf.org/html/rfc3068">6to4 Relay Anycast</a> . <br><br><br><h2>  IPv6 </h2><br>  We also spent a lot of time discussing IPv6 and dual-stack.  I already wrote about this, so I will not repeat it, but just leave a link to the <a href="http://habrahabr.ru/blogs/sysadm/64592/">Basics of IPv6</a> <br><br><br><h2>  Instead of conclusion </h2><br>  Here are such notes in the margins.  If you find any inaccuracies - say - discuss, correct </div><p>Source: <a href="https://habr.com/ru/post/130871/">https://habr.com/ru/post/130871/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../130866/index.html">One of the most sought-after windows features was found in LXDE.</a></li>
<li><a href="../130867/index.html">iOS 5 Tech Talk World Tour 2011</a></li>
<li><a href="../130868/index.html">I want to take and shoot, or an educational program about why you should not use make install</a></li>
<li><a href="../130869/index.html">WP7 social client. network "Vkontakte" open source</a></li>
<li><a href="../130870/index.html">Drupal Bundle Inherit - module for inheriting entity types</a></li>
<li><a href="../130872/index.html">TV monitor</a></li>
<li><a href="../130873/index.html">Interpolation: draw smooth graphics with PHP and GD</a></li>
<li><a href="../130875/index.html">Build DebWRT on the example of Ubiquity RouterStation Pro</a></li>
<li><a href="../130876/index.html">The hunt for bugs: Understanding the architecture of AI through the epic Fail</a></li>
<li><a href="../130877/index.html">Eliza</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>