<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HackerSIM: Debriefing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, many articles ( 1 , 2 , 3 , 4 , 5 , 6 , 7 ) have appeared on Habr√© and Hiktaimes about a SIM card endowed with unprecedented and unheard of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HackerSIM: Debriefing</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/pt/blog/269525/"><img src="https://habrastorage.org/files/7b9/89d/e2a/7b989de2a88044f4ab36240f79043fa2.png"></a> <br><br>  Recently, many articles ( <a href="http://habrahabr.ru/post/266709/">1</a> , <a href="http://geektimes.ru/company/neuronspace/blog/263506/">2</a> , <a href="http://habrahabr.ru/post/268403/">3</a> , <a href="http://habrahabr.ru/post/268789/">4</a> , <a href="http://habrahabr.ru/post/268831/">5</a> , <a href="http://habrahabr.ru/post/268591/">6</a> , <a href="http://geektimes.ru/company/neuronspace/blog/263810/">7</a> ) have appeared on Habr√© and Hiktaimes about a SIM card endowed with unprecedented and unheard of possibilities, which has caused concern and interest in various circles.  There was a lot of skepticism and controversy, and then various theories, sometimes amazing for its fantastic.  Let's try to open the veil of secrecy from the technical side.  Naturally, these tests would not have been possible without this SIM card, which <a href="http://habrahabr.ru/users/magisterludi/" class="user_link">MagisterLudi</a> kindly provided us. <br><br>  For those who do not want to read many letters, I summarize: there is no forced encryption, there is no protection against interception complexes, there is no connection to the second level of the BS signal, there is a number substitution, there is a voice substitution, there is no billing, there is no IMSI hiding . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's start in order. <br><a name="habracut"></a><br><h4>  First disappointment </h4><br>  There is no Anonymus logo on the SIM card, which was depicted in the very <a href="http://habrahabr.ru/post/266709/">first article</a> .  Here‚Äôs what HackerSIM actually looks like: <br><br><img src="https://habrastorage.org/files/0aa/a16/bb4/0aaa16bb4cf947c5b47105315f77610c.png"><br><br>  Here we decided not to continue the study - after all, the logo was the main feature. <br><br><img src="https://habrastorage.org/files/f8d/006/6ba/f8d0066ba2c74c2aaa3dc1e18d23a083.png"><br><br><h4>  Whose is she? </h4><br>  The ICCID of the SIM card (printed on it) tells us the following: <br><br><img src="https://habrastorage.org/files/667/c48/5b1/667c485b126a4dbb85a0a557e7388417.png"><br><br>  We insert the SIM card into the phone, and the first thing we see is that we are roaming, connected to the MTS, and the third line, which is impossible not to pay attention: AY Security - it immediately says whose SIM it really is : <a href="http://www.aysecurity.co.uk/ru/aysim.html">www.aysecurity.co.uk/ru/aysim.html</a> <br><br><img src="https://habrastorage.org/files/702/90f/351/70290f3511d944bab2d3ac1d9a95cd89.png"><br><br>  Interestingly, but in a modern phone completely different information is displayed (it remains a mystery, which means ‚ÄúGT‚Äù) <br><br><img src="https://habrastorage.org/files/453/9f6/dc3/4539f6dc3eba4bfdaeabf0efdbc19ae7.png"><br><br>  The site claimed the following "unique" features: <br><br><ul><li>  caller ID replacement, </li><li>  force encryption </li><li>  protection from interception systems, </li><li>  voice substitution </li><li>  cost optimization </li><li>  hiding the real IMSI, </li><li>  hide real location </li><li>  virtual number. </li></ul><br>  The first and fourth points have already been actively discussed at Habr√©, so we will not touch them, but try to understand the rest, much more "muddy." <br><br><h4>  Force encryption </h4><br><blockquote>  ‚ÄúThis function prohibits your SIM card from reducing the level of encryption and forces you to ignore commands from operators or interception complexes to disable the encryption key generation algorithm (A8) stored in the SIM module.  Thus, all your conversations are encrypted using the A5.1 algorithm. ‚Äù </blockquote><br>  In fact, initially the entire transfer is carried out without the use of encryption, and the inclusion of encryption is carried out on command from the operator Ciphering Mode Command.  Here is an example from a real network (using HackerSIM): <br><br><img src="https://habrastorage.org/files/3fe/141/fb0/3fe141fb0dff417f9b55ae214fb3f9d5.png"><br><br>  However, this also works on all other SIMs, since encryption is usually used in all Russian networks.  To check the "ban" of work without encryption, connect to OpenBTS and try to call: <br><br><img src="https://habrastorage.org/files/42b/582/776/42b582776f084696b6fc15bbf27551fa.png"><br><br>  At first, it really seems that the SIM card somehow proclaimed that there is no encryption, and blocked the call.  (But in reality, everything is not so, about this below, and pay attention to the ‚ÄúCalling ...‚Äù window at the bottom of the screen.) However, if you try to call several times in a row (in our case three times), the call passes: <br><br><img src="https://habrastorage.org/files/262/2a4/e6b/2622a4e6b19c4bd1b1778c1c5adb3569.png"><br><br>  Incoming calls go without problems and the conversation also happens without problems: <br><br><img src="https://habrastorage.org/files/7b9/89d/e2a/7b989de2a88044f4ab36240f79043fa2.png"><br><br><img src="https://habrastorage.org/files/a3f/f92/2cc/a3ff922cc0274092a6d1e507da6a2afd.png"><br><br>  It is worth noting: the manufacturer claims that it is for the voice that there is a ban on the lack of encryption; in a fake network without encryption, both incoming and outgoing SMS are transmitted without problems. <br><br><h4>  Protection against interception complexes </h4><br><blockquote>  This function allows the subscriber to become invisible for mobile interception complexes.  The principle of the interception complex is based on the substitution of a real base station, thus, becoming, in fact, a priority for all phones within its radius of action.  A phone with our software package ignores the bases with the highest signal level. </blockquote><br>  Generally speaking, the phone chooses not by the signal level, but by the C2 parameter, which depends on the current signal level, on the minimum acceptable signal for this BS and on the BS priority.  Therefore, the very idea that it saves from a fake BS is a delusion.  For example, OpenBTS, deployed on SDR, has a power of about 100 mW, which is less than the phone itself can (up to 1 W), and much less than a standard base station.  Thus, interception is achieved not by a high power level, but by a high priority.  And the fact that the phone uses a less powerful BS means only that its priority is higher. <br><br>  To measure power, parameters C1 and C2, we used the <a href="http://green-head.ru/">Greenhead</a> app. <br><br>  Well, some screenshots - a list of neighbor and serving channels (BCCH - arfcn, SC - serving cell, N1 - neigbour cell 1, etc.). <br><br>  1. HackerSIM on the most powerful and highest priority BS <br><br><img src="https://habrastorage.org/files/337/e79/647/337e7964709d428aa4589f2d98bda9c7.png"><br><br>  2. HackerSIM on not the most powerful, but the most priority BS <br><br><img src="https://habrastorage.org/files/9ca/2b6/591/9ca2b65912af4d109f1fa9d5a6d52acc.png"><br><br>  3. We turn on the "interception complex", and ... HackerSIM quietly connects to it, although, to be precise, this phone connects, since the SIM card does not control the cell selection, and HackerSIM is not an exception: <br><br><img src="https://habrastorage.org/files/e5e/484/719/e5e48471984b47d79b687420d21ea389.png"><br><br>  4. By capturing the phone, the fake network no longer reports its neighbors, so the phone has no choice but to be in the fake network as long as the attacker wishes, or until he leaves the area of ‚Äã‚Äãits operation: <br><br><img src="https://habrastorage.org/files/f74/9d6/aef/f749d6aefcf44108b673ff031329295b.png"><br><br><h4>  Cost optimization </h4><br>  This item sounds very original, taking into account the cost of both the SIM-card and its service. <br><br><h4>  Hiding the real IMSI.  Hiding the real location.  Lack of billing.  Virtual number </h4><br>  No billing is declared, and that is why it is supposedly impossible to track this subscriber.  However, if there is no billing, who issues this information? <br><br><img src="https://habrastorage.org/files/c47/802/0cc/c478020ccf5348ff873f692449c98d57.png"><br><br>  Location tracking is carried out through the SS7 network using the attacks described by us [http://www.ptsecurity.ru/download/PT_SS7_security_2014_rus.pdf].  It‚Äôs enough to know the subscriber‚Äôs IMSI.  Usually they recognize him by phone number;  we do not know the phone number of our HackerSIM, and according to the instructions from the site, it for some reason is not shown to us (there must be another DID by which we can call): <br><br><img src="https://habrastorage.org/files/b8b/3b2/ef4/b8b3b2ef417f486c87b389cfad182a29.png"><br><br>  We cannot verify the ‚Äúvirtuality‚Äù of this number, because we do not know it.  But IMSI can be learned from the radio, for example, when you connect your phone to the network: <br><br><img src="https://habrastorage.org/files/964/094/b7e/964094b7e8384c27b651f7d8cedaa15e.png"><br><br><img src="https://habrastorage.org/files/31a/04b/9e3/31a04b9e396e45b1b650563372567c11.png"><br><br>  The phone sends the Location Update Request, the network requests the IMSI (Identity Request), the phone speaks its IMSI (Identity Response), then the session keys (Authentication Request and Authentication Response) are generated, and then the encryption command is received.  In other words, IMSI can be intercepted in the radio network, even without breaking the encryption, but it cannot be otherwise: this is how the cellular network works. <br><br>  There is one more unsolved point mentioned on Habr√©.  When registering a phone in a roaming network, a request is made to the home network, but then all calls must pass through the guest network.  So how do all outgoing calls go through a PBX?  The answer is original, but simple enough. <br><br>  When we tried to call through the Motorola C118, the call was dropped, and no one returned the call.  The same is true when using the mobile utility from the osmocom-bb package: <br><br><img src="https://habrastorage.org/files/7b9/869/c6b/7b9869c6ba104146a746df9a70e10570.png"><br><br>  By the way, SMS is reset with an even more interesting reason: <br><br><img src="https://habrastorage.org/files/16e/ce7/5e1/16ece75e1e7a4a6e9c9bc2e0f32e2a94.png"><br><br>  But let us return to the question of why in the old Motorola the outgoing call does not work, and in the modern phone it is dropped, and then the PBX calls back.  Radio dump reveals the secret: <br><br><img src="https://habrastorage.org/files/ae1/28c/eea/ae128ceea3d541fcab2b95e332e5360f.png"><br><br>  When an outgoing call instead of a call setup message (Setup), the phone sends USSD with the number of the called subscriber, who has been walking around the world for a long time, getting to the home of the Netherlands, then a USSD answer comes with a simple Calling start phrase, and then the incoming call is received with the usual sequence Setup, Call Confirmed, Assigned Command. <br><br><img src="https://habrastorage.org/files/614/539/b30/614539b30d5e466ebed3a9a4292a58da.png"><br><br>  Thus, any outgoing activity, except for USSD, is prohibited for the SIM card and is prohibited by the home network.  And the call itself is intercepted by the application on the SIM card and is replaced by a USSD with the called number, this goes into the home network, at this time the application ends the call, displays the message ‚ÄúCalling ...‚Äù on the screen and waits for a response to the USSD;  it also checks the use of "encryption" on the network.  If the USSD fails or the Calling start does not answer, it simply blocks the call (what we saw on the fake network). <br><br>  However, apparently, the performance of the SIM card does not allow to intercept all calls, and having filled it with calls, they start to leave directly. <br><br>  We tried to repeat this in a real network in order to make a call bypassing the PBX, but there all the calls are ‚Äúfought off‚Äù by the network, because, as already mentioned, all outgoing activities are prohibited for HackerSIM. <br><br>  The most attentive ones could have noticed the Identity Request request in the previous screenshot before the USSD response.  This message is used by the network to receive an IMSI or IMEI from the phone. <br><br><img src="https://habrastorage.org/files/0e3/8c8/db8/0e38c8db8daf49d3a317356add08c347.png"><br><br><img src="https://habrastorage.org/files/f87/cea/785/f87cea7856294fa292bef439be25ae16.png"><br><br>  Recall that IMEI is generally an optional identifier in the cellular network and may never be requested.  So someone collects them and not by chance.  There is no anonymity when using HackerSIM: they know who, where, when, and where. <br><br>  Now, knowing the secret of outgoing calls, we can call both from the old Motorola and from the mobile utility of the osmocom-bb package. <br><br><img src="https://habrastorage.org/files/d5a/ff3/414/d5aff34148d6482fb8da85bc7e043a79.png"><br><br><h4>  Multi IMSI / Ki </h4><br>  For the IMSI / Ki shift pair, you must use the SIM card menu: <br><br><img src="https://habrastorage.org/files/b4a/e47/184/b4ae471843d04d619f3ac7b207427f9c.png"><br><br>  <b>Callback on / off</b> - turns on (off) the SIM card application, replacing outgoing calls to USSD. <br><br>  <b>Menu</b> - there is nothing there except Exit. <br><br>  <b>Reset sim profile</b> - resets TMSI and Kc (session key). <br><br>  <b>About</b> - <br><br><img src="https://habrastorage.org/files/1f6/104/cc3/1f6104cc320c4f71b73816ad51eec9fd.png"><br><br>  <b>Select Location</b> ‚Äî select IMSI / Ki. <br><br><img src="https://habrastorage.org/files/eb7/7b9/86a/eb77b986accc480da2d6d8f19b2fcc89.png"><br><br>  <b>Global</b> - IMSI 22201xxxxxxxxxxxx, owned by the Italian operator TIM. <br><br>  <b>Global +</b> - IMSI 20404xxxxxxxxxx, owned by the Dutch operator Vodafone Libertel. <br><br>  <b>USA</b> - IMSI 310630xxxxxxxxx, not owned by a specific operator, used in various Global SIM. <br><br>  <b>Prime</b> - IMSI 23418xxxxxxxxxx, owned by the British Cloud9 / wire9 Tel. <br>  All IMSI, except <b>Global +</b> , are not registered in Russia for one of these two reasons: <br><br><img src="https://habrastorage.org/files/a0e/c76/c8b/a0ec76c8b9484d05bb18d61310a1c103.png"><br><br><img src="https://habrastorage.org/files/318/f84/a91/318f84a913a6447a93024e9f8f370faa.png"><br><br>  In <b>Global +</b> mode, too, not everything is smooth. <br><br>  The list of preferred networks (where exactly it will work): <br><br><pre><code class="bash hljs">List of preferred PLMNs: MCC |MNC -------+------- 234 |15 (Guernsey, Vodafone) 262 |02 (Germany, Vodafone) 208 |10 (France, SFR) 222 |10 (Italy, Vodafone) 214 |01 (Spain, Vodafone) 505 |03 (Australia, Vodafone) 228 |01 (Switzerland, Swisscom) 206 |01 (Belgium, Proximus) 404 |20 (India, Vodafone IN) 404 |11 (India, Vodafone IN) 404 |27 (India, Vodafone IN) 404 |05 (India, Vodafone IN) 404 |46 (India, 46) 272 |01 (Ireland, Vodafone) 202 |05 (Greece, Vodafone) 232 |01 (Austria, A1) 655 |01 (South Africa, Vodacom) 286 |02 (Turkey, Vodafone) 238 |01 (Denmark, TDC) 268 |01 (Portugal, Vodafone) 260 |01 (Poland, Plus) 230 |03 (Czech Republic, Vodafone) 250 |01 (Russian Federation, MTS) 216 |70 (Hungary, Vodafone) 226 |01 (Romania, Vodafone) 244 |05 (Finland, Elisa) 602 |02 (Egypt, Vodafone) 219 |10 (Croatia, VIPnet) 620 |02 (Ghana, Ghana Telecom Mobile / Vodafone) 255 |01 (Ukraine, MTS)</code> </pre> <br>  There are no prohibited networks, but when you try to register with Beeline and TELE2, a failure comes from your home network, MegaFon is working, MTS is preferable (in the SIM card) <br><br>  Here is what happens when you try to connect to Beeline: <br><br><img src="https://habrastorage.org/files/bc1/939/535/bc1939535a2e4ea5bcad70cbc64689b1.png"><br><br>  So, if this SIM works in any country of the world, it definitely does not work in any network of the world. <br><br><h4>  findings </h4><br>  The outgoing call scheme used may cause problems in the search for the call initiator, but only if the PBX is located abroad and does not contact the special services, and telecom operators do not know and do not want to know about the existence of such specific SIM cards.  However, if you want to track the activity of all those who use such SIM-cards, it is easy: the only difference is that you will need to look for a slightly different information than usual. <br><br>  There are no fantastic and hacker properties of the SIM card itself. </div><p>Source: <a href="https://habr.com/ru/post/269525/">https://habr.com/ru/post/269525/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269513/index.html">Email Security Overview</a></li>
<li><a href="../269515/index.html">What version control system do you use (in real work, most of all)?</a></li>
<li><a href="../269517/index.html">Integrating Admob Native Ads into ListView</a></li>
<li><a href="../269519/index.html">Cryptanalysis "Enigma"</a></li>
<li><a href="../269521/index.html">German intelligence agencies have discovered new traces of the Regin virus</a></li>
<li><a href="../269527/index.html">Participation in the competition LudumDare # 33</a></li>
<li><a href="../269529/index.html">Cisco switch stacking. Part 1</a></li>
<li><a href="../269531/index.html">Why writing scripts to fight Amigo browser is evil?</a></li>
<li><a href="../269533/index.html">Undocumented app in Thinstation</a></li>
<li><a href="../269535/index.html">PC Tuneup feature in Panda antivirus to optimize PC performance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>