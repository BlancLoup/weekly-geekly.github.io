<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating and registering the Metro style component for WinRT</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The official release of Windows 8 is approaching every day, and more and more developers are thinking about creating their own Metro style app. And if...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating and registering the Metro style component for WinRT</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/91f/499/761/91f4997610f7d670c2b87869d21a0013.png" align="left">  The official release of Windows 8 is approaching every day, and more and more developers are thinking about creating their own Metro style app.  And if you make several such applications at once, then most likely you will need to use the same code in different projects. <br><br>  This article provides step-by-step instructions for creating a simple Metro style component, as well as features for registering such a library for future use in WinRT projects. <br><br>  As an example of a component, we chose an animated Metro style download indicator, similar to the one that many of us have already seen in the new version of Windows.  By the end of this article, you will not only know everything about the registration of components, but also be able to add a ready download indicator to your Metro app. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  System requirements </h2><br>  If you have not had time to write your first program for Windows 8, then make sure that your development environment meets the following requirements: <br><br><ul><li>  <b>Development should be carried out in the operating system Windows 8</b> .  At the time of this writing, Windows 8 is available in the Release Preview stage and can be downloaded from this link: <br>  <a href="http://windows.microsoft.com/ru-RU/windows-8/download">http://windows.microsoft.com/ru-RU/windows-8/download</a> <br></li><li>  <b>For development, you will need the Visual Studio 2012 development environment</b> , which is currently in the Release Candidate stage and is available for download from <a href="http://www.microsoft.com/visualstudio/11/ru-ru/downloads">http://www.microsoft.com/visualstudio/11/ru-ru/downloads</a> . <br>  If you are not able to use the professional version of Visual Studio, you can always install Visual Studio Express 2012 for Windows 8 for free. In this article, all actions will be given for the interface of the professional version of Visual Studio 2012. <br></li></ul><br><br><h2>  Creating a library </h2><br>  So, we launched Visual Studio 2012 and are ready to make our first Metro-style component. <br>  To do this, create a new project of type <b>Class Library (Metro style apps)</b> and call it <b>MyCustomControls</b> : <br><br><img src="https://habrastorage.org/storage2/817/9da/6e3/8179da6e3f659662a4744463e3cad752.png"><br><br>  As a result, an empty project with one class will be created.  Since in our case this class will not be needed, we will delete the <b>Class1.cs</b> file from the project: <br><br><img src="https://habrastorage.org/storage2/52a/35d/bf5/52a35dbf535e8832cde655f55b6c99ff.png"><br><br>  Then add the stock to our future component.  To do this, in the <b>Add New Item</b> dialog, select the new template - <b>Templated Control</b> - and give it the name <b>MyCustomControl</b> : <br><br><img src="https://habrastorage.org/storage2/95b/4d8/789/95b4d8789e5752befcb81db5a8f221ff.png"><br><br>  After these actions, two new files will appear in the project: <br><br><ul><li>  <b>MyCustomControl.cs</b> , which contains the definition of our component as a descendant from the control: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">MyCustomControls</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyCustomControl</span></span> : <span class="hljs-title"><span class="hljs-title">Control</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyCustomControl</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.DefaultStyleKey = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(MyCustomControl); } } }</code> </pre> <br>  Replace it with the code below: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">MyCustomControls</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyCustomControl</span></span> : <span class="hljs-title"><span class="hljs-title">Control</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> radius = <span class="hljs-number"><span class="hljs-number">30</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> DependencyProperty DataProperty = DependencyProperty.Register(<span class="hljs-string"><span class="hljs-string">"Data"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Geometry), <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(MyCustomControl), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PropertyMetadata(<span class="hljs-literal"><span class="hljs-literal">null</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Geometry Data { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (Geometry)GetValue(DataProperty); } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { SetValue(DataProperty, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } } DispatcherTimer timer; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> progress = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; Size arrangeSize = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Size(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); DateTime lastTime = DateTime.Now; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyCustomControl</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.DefaultStyleKey = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(MyCustomControl); timer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DispatcherTimer(); timer.Tick += timer_Tick; timer.Interval = TimeSpan.FromMilliseconds(<span class="hljs-number"><span class="hljs-number">5</span></span>); timer.Start(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">timer_Tick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> e</span></span></span><span class="hljs-function">)</span></span> { DateTime time = DateTime.Now; progress += <span class="hljs-number"><span class="hljs-number">0.5</span></span> * (time - lastTime).TotalSeconds; lastTime = time; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (progress &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) progress -= <span class="hljs-number"><span class="hljs-number">1</span></span>; Data = CreateGeometry(progress); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CalcAngle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> progress</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> factor = <span class="hljs-number"><span class="hljs-number">0.5</span></span> * Math.Cos(Math.PI * progress - Math.PI) + <span class="hljs-number"><span class="hljs-number">0.5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> * Math.PI * factor; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CalcDistance</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> angle</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0.3</span></span> * (Math.PI - Math.Abs(Math.PI - angle)); } <span class="hljs-function"><span class="hljs-function">Geometry </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateGeometry</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> progress</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> angle = CalcAngle(progress); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> distance = CalcDistance(angle); GeometryGroup newGeometry = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GeometryGroup() { FillRule = FillRule.Nonzero }; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">3</span></span>; i &gt; <span class="hljs-number"><span class="hljs-number">-4</span></span>; i--) { Point location = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point(<span class="hljs-number"><span class="hljs-number">0.5</span></span> * arrangeSize.Width + radius * Math.Cos(angle + i * distance - Math.PI / <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0.5</span></span> * arrangeSize.Height + radius * Math.Sin(angle + i * distance - Math.PI / <span class="hljs-number"><span class="hljs-number">2</span></span>)); newGeometry.Children.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EllipseGeometry() { Center = location, RadiusX = <span class="hljs-number"><span class="hljs-number">5</span></span>, RadiusY = <span class="hljs-number"><span class="hljs-number">5</span></span> }); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> newGeometry; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> Size </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MeasureOverride</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Size availableSize</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.MeasureOverride(availableSize); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Size(!<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.IsInfinity(availableSize.Width) ? availableSize.Width : <span class="hljs-number"><span class="hljs-number">0</span></span>, !<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.IsInfinity(availableSize.Height) ? availableSize.Height : <span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> Size </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ArrangeOverride</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Size arrangeBounds</span></span></span><span class="hljs-function">)</span></span> { arrangeSize = arrangeBounds; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.ArrangeOverride(arrangeBounds); } } }</code> </pre> <br></li><li>  <b>Themes \ Generic.xaml</b> , where the style description is located, which will be applied by default to our controls.  Let's enter the <b>Path</b> element in the markup: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ResourceDictionary</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:local</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"using:MyCustomControls"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">TargetType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"local:MyCustomControl"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Setter</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Property</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Template"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Setter.Value</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ControlTemplate</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">TargetType</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"local:MyCustomControl"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Border</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"{TemplateBinding Background}"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">BorderBrush</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"{TemplateBinding BorderBrush}"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">BorderThickness</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"{TemplateBinding BorderThickness}"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Path</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Fill</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Aqua"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Data</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"{Binding Path=Data, RelativeSource={RelativeSource TemplatedParent} }"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Border</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ControlTemplate</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Setter.Value</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Setter</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ResourceDictionary</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></li></ul><br><br>  Then you can quickly test the work of the written component.  To do this, add another project such as the <b>Blank App (XAML)</b> : <br><br><img src="https://habrastorage.org/storage2/27f/2b8/a8d/27f2b8a8d9a27fd8ca03aed010e51b1a.png"><br><br>  Now add to this project a link (of the Project Reference type) to our <b>MyCustomControls</b> assembly: <br><br><img src="https://habrastorage.org/storage2/9d4/665/f35/9d4665f350641f07bd10f3f1c8f96db5.png"><br><br>  Next, you need to change the contents of the <b>MainPage.xaml</b> file, as shown below: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Page</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"App1.MainPage"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IsTabStop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:local</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"using:App1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:d</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/expression/blend/2008"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:mc</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:my</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"using:MyCustomControls"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mc:Ignorable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"White"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">my:MyCustomControl</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Page</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Then we will make the <b>App1</b> starting application: <br><br><img src="https://habrastorage.org/storage2/f46/251/464/f46251464810349ee1cc16b11193b4ae.png"><br><br>  Now we launch our project and see the Metro style download indicator - which means that our component is operational! <br><br><img src="https://habrastorage.org/storage2/f4f/211/69a/f4f21169a7017a1b5553641e9b868972.gif"><br><br><h2>  Creating Extension SDK </h2><br>  Now you can go directly to creating your own Extension SDK.  Using the Extension SDK, you can combine several libraries into one set that can be plugged into a Visual Studio project by adding one link to the entire SDK at once. <br><br>  To begin with, we will create on the hard disk the following directory structure, which will contain everything necessary for our SDK: <br><blockquote>  MySDK <br>  - - 1.0 <br>  - - - - References \ CommonConfiguration \ neutral \ MyCustomControls.dll <br>  - - - - Redist \ CommonConfiguration \ neutral \ MyCustomControls.pri <br>  - - - - Redist \ CommonConfiguration \ neutral \ MyCustomControls \ Themes \ generic.xaml <br>  - - - - SDKManifest.xml <br></blockquote><br>  In this structure, <b>MySDK</b> is the root folder containing all other SDK files.  It can have any name that reflects the name of your SDK.  <b>1.0</b> is the version of your SDK. <br><br>  <b>References</b> directory should contain all modules that will be included in the SDK, assembled in the appropriate configuration and for a specific architecture.  That is, the next level defines the configuration, and perhaps only three options: <b>Debug</b> , <b>Retail</b> and <b>CommonConfiguration</b> .  The last level, respectively, indicates the architecture for which these modules were collected: <b>neutral</b> , <b>x64</b> , <b>x86</b> and <b>ARM</b> .  In this case, the build was made in <b>Debug</b> or <b>Release</b> under <b>AnyCPU</b> . <br><br>  The <b>Redist</b> directory <b>contains</b> the files that are needed for debugging and execution, and they will be packaged.  And again, it all depends on the configuration and architecture - just like for <b>References</b> . <br><br>  The <b>SDKManifest.xml</b> file should have the following contents: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FileList</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DisplayName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"My Custom Controls"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ProductFamilyName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"My Controls"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MinVSVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"11.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MinToolsVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">CopyRedistToSubDirectory</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"."</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AppliesTo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"WindowsAppContainer+WindowsXAML+Managed"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">File</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Reference</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MyCustomControls.dll"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ContainsControls</span></span></span><span class="hljs-tag">&gt;</span></span>True<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ContainsControls</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">File</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FileList</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  This file describes all the assemblies that are in the <b>References</b> folder.  The <b>CopyRedistToSubDirectory</b> parameter specifies where the files from the <b>Redist</b> folder will be copied to the package root.  We installed it as "."  - this means that all files will be copied to the root of the package. <br><br><h2>  Register Extension SDK </h2><br>  Now you can register your SDK in one of the following ways: <br><br><ul><li>  copy the <b>MySDK</b> folder to the "% ProgramFiles% \ Microsoft SDKs \ Windows \ v8.0 \ Extension SDKs \" folder <br></li><li>  add a key to the registry that will contain the path to our SDK.  I will give an example of the * .reg file, which will add the relevant data to the registry: <br><pre> <code class="hljs tex">REGEDIT4 [HKEY_LOCAL_MACHINE<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOFTWARE</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Microsoft</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Microsoft</span></span></span></span> SDKs<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v</span></span></span></span>8.0<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExtensionSDKs</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MySDK</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span></span>1.0] @="C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>Sources<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>MySDK<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span>1.0"</code> </pre><br></li></ul><br>  After the SDK has been created and registered, you can create a new test project such as the <b>Blank App (XAML)</b> . <br><br>  In this case, we see that when adding a link to <b>MyCustomControls.dll</b> in the <b>Windows-&gt; Extentions</b> section, <b>MySDK</b> will be visible. <br><br><img src="https://habrastorage.org/storage2/7d5/7a1/77b/7d57a177b15e65516fb15f2df6496f1c.png"><br><br>  To check whether everything works in this case, modify the <b>MainPage.xaml</b> file in the same way as we did in the previous test example, then build and run the project - and see our download indicator in action! <br><br><h2>  useful links </h2><br>  More information on how to create your Extension SDK can be found at the following link: <br>  <a href="http://msdn.microsoft.com/library/hh768146(v%3DVS.110).aspx">http://msdn.microsoft.com/library/hh768146(v=VS.110).aspx</a> <br><br>  If you want to learn more about WinRT, here are links to other useful resources: <br><ul><li>  Windows 8 Development Center <br>  <a href="http://msdn.microsoft.com/ru-ru/windows/">msdn.microsoft.com/en-us/windows</a> <br></li><li>  Windows Metro Style Forums <br>  <a href="http://social.msdn.microsoft.com/Forums/en-US/category/windowsapps">social.msdn.microsoft.com/Forums/en-US/category/windowsapps</a> <br></li><li>  Windows 8 Metro style App Samples <br>  <a href="http://code.msdn.microsoft.com/windowsapps">code.msdn.microsoft.com/windowsapps</a> <br></li><li>  DevExpress - maker of visual components for the .NET platform, including WinRT <br>  <a href="http://www.devexpress.com/">www.devexpress.com</a> <br></li></ul></div><p>Source: <a href="https://habr.com/ru/post/148928/">https://habr.com/ru/post/148928/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148922/index.html">Objective-C Runtime from the inside</a></li>
<li><a href="../148924/index.html">LTE in the regions or we are also not lucky</a></li>
<li><a href="../148925/index.html">Results and statistics of the first Habrakamp</a></li>
<li><a href="../148926/index.html">We write a simple map using Nokia Maps JS API</a></li>
<li><a href="../148927/index.html">Visual Studio 2012 will be available on September 12</a></li>
<li><a href="../148929/index.html">Yandex.Money from Europe with a low commission</a></li>
<li><a href="../148930/index.html">Simple things. Settings file and a small utility trailer</a></li>
<li><a href="../148933/index.html">Fast zombies</a></li>
<li><a href="../148937/index.html">Free ebooks from Microsoft</a></li>
<li><a href="../148938/index.html">Simple as java</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>