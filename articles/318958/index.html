<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>json-api-normalizer: an easy way to make friends with Redux and the JSON API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, the JSON API standard for developing web services is gaining popularity. In my opinion, this is a very good solution that finally standardiz...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>json-api-normalizer: an easy way to make friends with Redux and the JSON API</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/325/507/e71/325507e71b1c43399d89018f3601ae6f.jpg" alt="JSON API + redux"></p><br><p>  Recently, the <a href="http://jsonapi.org/">JSON API</a> standard for developing web services is gaining popularity.  In my opinion, this is a very good solution that finally standardizes the API development process at least a little bit, and instead of the next invention of the bicycle, we will use libraries both on the server side and the client to exchange data, focusing on interesting tasks instead of writing serializers and parsers first time. </p><br><a name="habracut"></a><br><h1 id="json-api-vs-tipichnye-veb-servisy">  JSON API vs typical web services </h1><br><p>  I really like the JSON API, as it immediately provides the data in a normalized form, preserving the hierarchy, and also supports pagination, sorting and filtering out of the box. </p><br><h4 id="tipichnyy-veb-servis">  Typical web service </h4><br><pre><code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"123"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"author"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Paul"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"My awesome blog post"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"comments"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"324"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"Great job, Bro!"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"commenter"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Nicole"</span></span> } } ] }</code> </pre> <br><h4 id="json-api">  JSON API </h4><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"post"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"123"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"My awesome blog post"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"relationships"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"author"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"comments"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"comment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"324"</span></span> } } }], <span class="hljs-attr"><span class="hljs-attr">"included"</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Paul"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Nicole"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"comment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"324"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"attributes"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">324</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"Great job, Bro!"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"relationships"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"commenter"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span> } } }] }</code> </pre> <br><p>  The main disadvantage of the JSON API when compared with traditional APIs is its ‚Äútalkativeness‚Äù, but is it really so bad? </p><br><table><thead><tr><th>  Type of </th><th>  Before compression (bytes) </th><th>  After compression (bytes) </th></tr></thead><tbody><tr><td>  Traditional JSON </td><td>  264 </td><td>  170 </td></tr><tr><td>  JSON API </td><td>  771 </td><td>  293 </td></tr></tbody></table><br><p>  After gzip, the difference in size becomes much smaller, and since we are talking about structured data of a small amount, in terms of performance, everything will be fine too. </p><br><p>  If you wish, you can come up with a synthetic test, where the size of the data in the JSON API view will be less than in traditional JSON: take a bunch of objects that refer to another object, for example, blog posts and their author, and then the author object will appear in the JSON API only once, while in traditional JSON it will be included for each post. </p><br><p>  Now about the merits: the data structure returned by the JSON API will always be flat and normalized, that is, each object will have no more than one level of nesting.  Such a presentation not only avoids duplication of objects, but also perfectly corresponds to the best practices for working with data in redux.  Finally, object type typing is built into the JSON API, so on the client side it is not necessary to define "schemes", as <a href="https://github.com/paularmstrong/normalizr">normalizr</a> requires.  This feature allows you to simplify work with data on the client, as we will soon be able to see. </p><br><p>  <em>Note: here and hereafter redux can be replaced by many other state management libraries, but according to the latest <a href="http://stateofjs.com/2016/statemanagement/">State of JavaScript in 2016</a> survey, redux is far more popular than any other existing solution, so redux and state management in JS for me is almost the same same</em> </p><br><h1 id="json-api-i-redux">  JSON API and redux </h1><br><p>  The JSON API out of the box is quite good for integration with redux, however, there are a few things that can be done better. </p><br><p>  In particular, for an application, the separation of data into <code>data</code> and <code>included</code> may make sense, because sometimes it is necessary to separate which data we asked for and which ones we received "into the bargain."  However, store data in the store should be uniform, otherwise we risk having multiple copies of the same objects in different places, which is contrary to the best practices of redux. </p><br><p>  Also, the JSON API returns us a collection of objects as an array, and in redux it is much more convenient to work with them as with a Map. </p><br><p>  To solve these problems, I developed a <a href="https://github.com/yury-dymov/json-api-normalizer">json-api-normalizer</a> library that can do the following: </p><br><ol><li>  normalizes data by performing merge <code>data</code> and <code>included</code> ; </li><li>  converts collections of objects from an array into a Map of the form <code>id =&gt; </code> ; </li><li>  preserves the original JSON API structure of the document in a special <code>meta</code> object; </li><li>  combines one-to-many relationships into one object. </li></ol><br><p>  Let us dwell a little more on points 3 and 4. </p><br><p>  Redux, as a rule, accumulates data in the store incrementally, which improves performance and simplifies the implementation of offline mode.  However, if we work with the same data objects, it is not always possible to say unequivocally which data should be taken from the store for a particular screen.  For each request, the json-api-normalizer stores in the special <code>meta</code> object the structure of the JSON API document, which allows us to uniquely receive only the data from the store that we need. </p><br><p>  json-api-normalizer converts a description of relationships </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"relationships"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"comments"</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"comment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"comment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>, }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"comment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3"</span></span>, }] } }</code> </pre> <br><p>  in the next view </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"relationships"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"comments"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"comment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1,2,3"</span></span> } } }</code> </pre> <br><p>  Such a representation is more convenient when updating the redux state through merge, since in this case it is not necessary to solve the complex problem of deleting one of the collection objects and references to it: in the merge process, we replace one line with the "id" with another, and the problem will be solved in one step.  Probably, this solution will not be optimal for all scenarios, so I will be happy to pull requests, which will allow you to redefine the existing implementation using options. </p><br><h1 id="prakticheskiy-primer">  Practical example </h1><br><h2 id="1-skachivaem-zagotovku">  1. Download the blank </h2><br><p>  As a source of JSON API documents, I wrote a simple web application on the <a href="http://www.phoenixframework.org/">Phoenix Framework</a> .  I will not dwell on its implementation, but I recommend <a href="https://github.com/yury-dymov/phoenix-json-api-example">looking at the source code</a> to see how easy it is to make such web services. </p><br><p>  As a client, I wrote a <a href="https://github.com/yury-dymov/json-api-react-redux-example/tree/initial">small application on React</a> . </p><br><p>  We will work with this blank.  Make a git clone of this thread. </p><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/yury-dymov/json-api-react-redux-example.git --branch initial</code> </pre> <br><p>  And you will have: </p><br><ul><li>  React and ReactDOM </li><li>  Redux and Redux DevTools </li><li>  Webpack </li><li>  Eslint </li><li>  Babel </li><li>  Web application entry point, two components, customized build, working eslint config and redux store initialization </li><li>  Styles of all components that will be used in the application. </li></ul><br><p>  All this is configured and works out of the box. </p><br><p>  To run the example, type in the console </p><br><pre> <code class="bash hljs">npm run webpack-dev-server</code> </pre> <br><p>  and open <a href="http://localhost:8050/"><code>http://localhost:8050</code></a> in the browser. </p><br><h2 id="2-integriruemsya-s-api">  2. Integrate with API </h2><br><p>  First we write redux middleware, which will interact with the API.  This is where it is logical to use json-api-normalizer to avoid doing data normalization in many redux actions and repeating the same code. </p><br><h4 id="srcreduxmiddlewareapijs">  src / redux / middleware / api.js </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fetch <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'isomorphic-fetch'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> normalize <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'json-api-normalizer'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> API_ROOT = <span class="hljs-string"><span class="hljs-string">'https://phoenix-json-api-example.herokuapp.com/api'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> API_DATA_REQUEST = <span class="hljs-string"><span class="hljs-string">'API_DATA_REQUEST'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> API_DATA_SUCCESS = <span class="hljs-string"><span class="hljs-string">'API_DATA_SUCCESS'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> API_DATA_FAILURE = <span class="hljs-string"><span class="hljs-string">'API_DATA_FAILURE'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callApi</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">endpoint, options = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fullUrl = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">endpoint.indexOf(API_ROOT</span></span></span><span class="hljs-function">) === -1) ? </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">API_ROOT</span></span></span><span class="hljs-function"> + </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">endpoint</span></span></span><span class="hljs-function"> : </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">endpoint</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fetch</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fullUrl, options</span></span></span><span class="hljs-function">) .</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">then</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response =&gt; response.json(</span></span></span><span class="hljs-function">) .</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">then</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(json</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!response.ok) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.reject(json); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign({}, normalize(json, { endpoint })); }), ); } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CALL_API = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(<span class="hljs-string"><span class="hljs-string">'Call API'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">store</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nxt</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">next</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">action</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> callAPI = action[CALL_API]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> callAPI === <span class="hljs-string"><span class="hljs-string">'undefined'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> next(action); } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> { endpoint } = callAPI; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { options } = callAPI; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> endpoint === <span class="hljs-string"><span class="hljs-string">'function'</span></span>) { endpoint = endpoint(store.getState()); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> endpoint !== <span class="hljs-string"><span class="hljs-string">'string'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'Specify a string endpoint URL.'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionWith = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> finalAction = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign({}, action, data); <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> finalAction[CALL_API]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> finalAction; }; next(actionWith({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: API_DATA_REQUEST, endpoint })); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> callApi(endpoint, options || {}) .then( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function"> =&gt;</span></span> next(actionWith({ response, <span class="hljs-attr"><span class="hljs-attr">type</span></span>: API_DATA_SUCCESS, endpoint })), error =&gt; next(actionWith({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: API_DATA_FAILURE, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: error.message || <span class="hljs-string"><span class="hljs-string">'Something bad happened'</span></span> })), ); }; }; }</code> </pre> <br><p>  This is where all the ‚Äúmagic‚Äù happens: after receiving the data in the middleware, we transform it with the help of the json-api-normalizer and transfer it further down the chain. </p><br><p>  <em>Note: if the error handler is slightly ‚Äúdoped‚Äù, then this code will fit perfectly for production.</em> </p><br><p>  Add middleware to the store configuration: </p><br><h4 id="srcreduxconfigurestorejs">  src / redux / configureStore.js </h4><br><pre> <code class="javascript hljs">... +++ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> api <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./middleware/api'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialState = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = createStore(rootReducer, initialState, compose( --- applyMiddleware(thunk), +++ applyMiddleware(thunk, api), DevTools.instrument(), ...</code> </pre> <br><p>  Now create the first action: </p><br><h4 id="srcreduxactionspostjs">  src / redux / actions / post.js </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { CALL_API } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../middleware/api'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { [CALL_API]: { <span class="hljs-attr"><span class="hljs-attr">endpoint</span></span>: <span class="hljs-string"><span class="hljs-string">'/test'</span></span>, }, }; }</code> </pre> <br><p>  Write a reducer: </p><br><h4 id="srcreduxreducersdatajs">  src / redux / reducers / data.js </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> merge <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'lodash/merge'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { API_DATA_REQUEST, API_DATA_SUCCESS } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../middleware/api'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">meta</span></span>: {}, }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = initialState, action</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> API_DATA_SUCCESS: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> merge( {}, state, merge({}, action.response, { <span class="hljs-attr"><span class="hljs-attr">meta</span></span>: { [action.endpoint]: { <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } } }), ); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> API_DATA_REQUEST: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> merge({}, state, { <span class="hljs-attr"><span class="hljs-attr">meta</span></span>: { [action.endpoint]: { <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } }); <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state; } }</code> </pre> <br><p>  Add our reducer to the redux store configuration: </p><br><h4 id="srcreduxreducersdatajs-1">  src / redux / reducers / data.js </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { combineReducers } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./data'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> combineReducers({ data, });</code> </pre> <br><p>  Model layer is ready!  Now you can associate business logic with UI. </p><br><h4 id="srccomponentscontentjsx">  src / components / Content.jsx </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PropTypes } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap-button-loader'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { test } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../../redux/actions/test'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> propTypes = { <span class="hljs-attr"><span class="hljs-attr">dispatch</span></span>: PropTypes.func.isRequired, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: PropTypes.bool, }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Content</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ loading = false, dispatch }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ dispatch(test()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div&gt; &lt;Button loading={loading} onClick={(</span></span></span><span class="hljs-function">) =&gt;</span></span> { fetchData(); }}&gt;Fetch Data <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> API&lt;<span class="hljs-regexp"><span class="hljs-regexp">/Button&gt; &lt;/</span></span>div&gt; ); } Content.propTypes = propTypes; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mapStateToProps</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {}; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> connect(mapStateToProps)(Content);</code> </pre> <br><p>  Open the page in the browser and click on the button - thanks to Browser DevTools and Redux DevTools, you can see that our application receives data in the JSON API format, converts it into a more convenient presentation and stores it in the redux store.  Fine!  It is time to display this data in the UI. </p><br><h2 id="3-ispolzuem-dannye">  3. We use data </h2><br><p>  The <a href="https://github.com/yury-dymov/redux-object">redux-object</a> library turns data from the redux-store into a JavaScript object.  To do this, it needs to pass the address of the redser, the type of the object and the id, and then she will do everything herself. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> build, { fetchFromMeta } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-object'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(build(state.data, <span class="hljs-string"><span class="hljs-string">'post'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// ---&gt; post console.log(fetchFromMeta(state.data, '/posts')); // ---&gt; array of posts</span></span></code> </pre> <br><p>  All links will turn into a JavaScript property with lazy loading support, that is, the child object will be loaded only when it is needed. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> post = build(state.data, <span class="hljs-string"><span class="hljs-string">'post'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ---&gt; post object; `author` and `comments` properties are not loaded post.author; // ---&gt; user object</span></span></code> </pre> <br><p>  Add some new UI components to display data on the page. </p><br><p>  <em>Note: I deliberately omit work with styles so as not to distract attention from the main topic of the article.</em> </p><br><p>  First we need to pull the data from the store and pass it to the components via the connect function: </p><br><h4 id="srccomponentscontentjsx-1">  src / components / Content.jsx </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PropTypes } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-bootstrap-button-loader'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> build <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-object'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { test } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../../redux/actions/test'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Question <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../Question'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> propTypes = { <span class="hljs-attr"><span class="hljs-attr">dispatch</span></span>: PropTypes.func.isRequired, <span class="hljs-attr"><span class="hljs-attr">questions</span></span>: PropTypes.array.isRequired, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: PropTypes.bool, }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Content</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ loading = false, dispatch, questions }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ dispatch(test()); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> qWidgets = questions.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">q</span></span></span><span class="hljs-function"> =&gt;</span></span> &lt;Question key={q.id} question={q} /&gt;); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div&gt; &lt;Button loading={loading} onClick={(</span></span></span><span class="hljs-function">) =&gt;</span></span> { fetchData(); }}&gt;Fetch Data <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> API&lt;<span class="hljs-regexp"><span class="hljs-regexp">/Button&gt; {qWidgets} &lt;/</span></span>div&gt; ); } Content.propTypes = propTypes; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mapStateToProps</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (state.data.meta[<span class="hljs-string"><span class="hljs-string">'/test'</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> questions = (state.data.meta[<span class="hljs-string"><span class="hljs-string">'/test'</span></span>].data || []).map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">object</span></span></span><span class="hljs-function"> =&gt;</span></span> build(state.data, <span class="hljs-string"><span class="hljs-string">'question'</span></span>, object.id)); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> loading = state.data.meta[<span class="hljs-string"><span class="hljs-string">'/test'</span></span>].loading; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { questions, loading }; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">questions</span></span>: [] }; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> connect(mapStateToProps)(Content);</code> </pre> <br><p>  Here we take the data from the query metadata '/ test', pull out the IDs and build on them objects of the type "Question", which we will pass to the component in the "questions" collection. </p><br><div class="spoiler">  <b class="spoiler_title">src / components / Question / package.json</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.0.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"private"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"./Question"</span></span> }</code> </pre> </div></div><br><h4 id="srccomponentsquestionquestionjsx">  src / components / Question / Question.jsx </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PropTypes } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Post <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../Post'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> propTypes = { <span class="hljs-attr"><span class="hljs-attr">question</span></span>: PropTypes.object.isRequired, }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Question</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ question }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> postWidgets = question.posts.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">post</span></span></span><span class="hljs-function"> =&gt;</span></span> &lt;Post key={post.id} post={post} /&gt;); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"question"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {question.text} {postWidgets} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } Question.propTypes = propTypes; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> Question;</code> </pre> <br><p>  We display questions and answers to them. </p><br><div class="spoiler">  <b class="spoiler_title">src / components / Post / package.json</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Post"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.0.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"private"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"./Post"</span></span> }</code> </pre> </div></div><br><h4 id="srccomponentspostpostjsx">  src / components / Post / Post.jsx </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PropTypes } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Comment <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../Comment'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> User <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../User'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> propTypes = { <span class="hljs-attr"><span class="hljs-attr">post</span></span>: PropTypes.object.isRequired, }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Post</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ post }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> commentWidgets = post.comments.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">c</span></span></span><span class="hljs-function"> =&gt;</span></span> &lt;Comment key={c.id} comment={c} /&gt;); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">User</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">user</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{post.author}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> {post.text} {commentWidgets} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ); } Post.propTypes = propTypes; export default Post;</span></span></code> </pre> <br><p>  Here we display the author of the answer and comments. </p><br><div class="spoiler">  <b class="spoiler_title">src / components / User / package.json</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"User"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.0.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"private"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"./User"</span></span> }</code> </pre> </div></div><br><h4 id="srccomponentsuseruserjsx">  src / components / User / User.jsx </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PropTypes } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> propTypes = { <span class="hljs-attr"><span class="hljs-attr">user</span></span>: PropTypes.object.isRequired, }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ user }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"user"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{user.name}: </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>; } User.propTypes = propTypes; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> User;</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">src / components / Comment / package.json</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Comment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.0.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"private"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"./Comment"</span></span> }</code> </pre> </div></div><br><h4 id="srccomponentscommentcommentjsx">  src / components / Comment / Comment.jsx </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PropTypes } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> User <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../User'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> propTypes = { <span class="hljs-attr"><span class="hljs-attr">comment</span></span>: PropTypes.object.isRequired, }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Comment</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ comment }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"comment"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">User</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">user</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{comment.author}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> {comment.text} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ); } Comment.propTypes = propTypes; export default Comment;</span></span></code> </pre> <br><p>  That's all!  If something does not work, you can compare your code with the <a href="https://github.com/yury-dymov/json-api-react-redux-example">master branch of my project.</a> </p><br><p>  Live demo is available <a href="https://yury-dymov.github.io/json-api-react-redux-example">here.</a> </p><br><h1 id="zaklyuchenie">  Conclusion </h1><br><p>  The json-api-normalizer and redux-object libraries appeared recently.  It may seem from the outside that they are quite simple, but, in fact, before coming to such an implementation, I managed to step on a lot of very different and unobvious rakes during the year and therefore I am sure that these simple and convenient tools can be useful. community and save a lot of time. </p><br><p>  I invite you to take part in the discussion, as well as help me in the development of these tools. </p><br><h1 id="ssylki">  Links </h1><br><ol><li>  <a href="http://jsonapi.org/">JSON API specification</a> </li><li>  <a href="https://github.com/yury-dymov/json-api-normalizer">Json-api-normalizer repository</a> </li><li>  <a href="https://github.com/yury-dymov/redux-object">Redux object repository</a> </li><li>  <a href="https://phoenix-json-api-example.herokuapp.com/api/test">Sample JSON API based web services implemented on Phoenix Framework</a> </li><li>  <a href="https://github.com/yury-dymov/phoenix-json-api-example">Sample JSON API Web Services Sample Code</a> </li><li>  <a href="https://yury-dymov.github.io/json-api-react-redux-example">Sample React client application using JSON API</a> </li><li>  <a href="https://github.com/yury-dymov/json-api-react-redux-example/tree/initial">Source code of client application on React, original version</a> </li><li>  <a href="https://github.com/yury-dymov/json-api-react-redux-example">Source code of client application on React, final version</a> </li></ol></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/318958/">https://habr.com/ru/post/318958/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318946/index.html">How to find a way to win the Russian AI Cup 2016, but in the wrong direction</a></li>
<li><a href="../318948/index.html">Finding GDI Object Leaks: How to Drive a Mastodon</a></li>
<li><a href="../318950/index.html">NativeScript, what kind of beast and what is it for?</a></li>
<li><a href="../318952/index.html">Let's Encrypt and nginx: configuration in Debian and Ubuntu</a></li>
<li><a href="../318954/index.html">Processing preprocessor directives in Objective-C</a></li>
<li><a href="../318960/index.html">Scala type classes (with a little overview of the cats library)</a></li>
<li><a href="../318962/index.html">About string formatting in modern C ++</a></li>
<li><a href="../318964/index.html">Towers of Hanoi - a theoretical solution without recursion</a></li>
<li><a href="../318966/index.html">Features of the development of mobile MMO RTS. Part 2</a></li>
<li><a href="../318968/index.html">Security in IoT: Security Architecture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>