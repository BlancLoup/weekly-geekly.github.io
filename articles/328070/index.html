<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating custom IP auto-configuration patterns for 3CX V15 phones</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article we will look at a very useful technology - custom IP phone templates 3CX. The 3CX autotuning templates allow you to automatically and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating custom IP auto-configuration patterns for 3CX V15 phones</h1><div class="post__text post__text-html js-mediator-article">  In this article we will look at a very useful technology - custom IP phone templates 3CX.  The 3CX autotuning templates allow you to automatically and consistently configure a large fleet of IP phones in your organization.  However, 3CX comes with ready-made templates customized by 3CX developers to suit most consumers.  If your organization has any special requirements for the configuration of IP phones, for example, its own ‚Äúlayout‚Äù of programmable buttons under the phone‚Äôs display, configuration of ringing tones, specific SIP parameters, etc.  - modify the stock template to suit your needs.  How to do this is described below. <br><br><h2>  Beginning of work </h2><br>  First of all, make a copy of the stock template 3CX.  And continue to work with a copy. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ab9/556/c3d/ab9556c3deaf5096f6c336c5212fb7cb.png"></div><br><a name="habracut"></a><br><ol><li>  In the 3CX control interface, go to <strong>Settings - Templates</strong> . </li><li>  In the drop-down list, select the stock template for auto-configuring the IP phone to be changed (1) </li><li>  Make sure that the phone model for which the user pattern will be created (2) is indicated inside the template file. </li><li>  At the top, click the <strong>Copy</strong> button (3), enter a new template name, and click <strong>OK</strong> .  This name will be attached to the name of the stock template.  You will see the full name of the custom template in the drop-down list, as shown below. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/251/2d3/a1f/2512d3a1fb06763b6658af6fc687b8c1.png"></div><br><h2>  Alteration </h2><br>  Please note that in order to apply changes to the template, you need to restart the <strong>Management Console Service (MC01)</strong> .  This is caused by the loss of connections in MyPhone / Web Client clients, which are responsible for the status and indication of user presence.  Therefore, it is recommended to debug the templates on the 3CX test system and the test group of IP phones - not in the working environment. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The parameters transmitted to the phone begin with this line in the <code>&lt;![CDATA[</code> <br><br>  All parameters specified above this line are necessary for the operation of the 3CX control interface, and they should not be changed.  An error in these lines may result in the user template not being visible in the drop-down list in the 3CX control interface.  The parameters for the extension in the interface will also be unavailable.  In this case, you will need to restore the last working copy of the contents of the template file or completely remove this extension number (user). <br><br><h2>  General recommendations </h2><br><ul><li>  Avoid duplicating the same autotuning parameters in the template. </li><li>  To clarify the parameters, refer to the auto-tuning documentation of the IP phone manufacturer, but not to 3CX technical support. </li><li>  You can also ask a question in the <a href="https://www.3cx.ru/forum/general/">3CX public forum</a> . </li><li>  If any parameter should be changed from the set value <strong>B</strong> to the default value <strong>A</strong> , do not just delete this parameter, but explicitly set its value to <strong>A.</strong> </li><li>  Never change the definition of the phone model <b>‚Äúua =‚Äù</b> XXXXX ‚Äù‚Äù specified in the template.  It is used by the system. </li><li>  After making changes to the template, do not forget to restart the <strong>Management Console Service (MC01)</strong> and force the phone to re-configure after making the changes. </li><li>  If you do not re-tune the phone forcibly, the automatic application of template parameters occurs, as a rule, within 24 hours. </li></ul><br><h2>  Validation of changes </h2><br>  There are several ways to make sure that the changes you make will be correctly processed by the IP phone. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c95/71f/8b1/c9571f8b13a4b2de18174a9914a3f2f9.png"><br><br>  If the IP phone is currently connected to 3CX, select it in the interface (section <strong>Phones</strong> ) and click the <strong>+ Config</strong> button.  This forces the configuration specified in the pattern to the phone. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f4/a76/a4f/5f4a76a4f3f4ee43619df33aa2cdfba6.png"><br><br>  You can also go to the <strong>Provisioning</strong> tab and copy the autotune URL.  Instead of {mac}, specify the MAC address of the IP phone.  For example, a URL might be <a href="http://mypbx.3cx.eu/provisioning/ads234cfsda/cfg123456787890">http://mypbx.3cx.eu/provisioning/ads234cfsda/cfg123456787890</a> .  Paste it into any browser, and you will receive a ready-made XML configuration file for a specific IP phone.  Some browsers immediately display the contents of the file, if it has the correct XML format.  To see the content in text form, right-click and select <strong>Show Source</strong> . <br><br><h2>  Apply custom pattern to IP phone </h2><br><h3>  Application to an unconfigured or reset IP phone </h3><br><ol><li>  In the 3CX interface, go to the <b>Phones</b> section. </li><li>  Highlight the new phone you want to configure. </li><li>  Select <strong>Add / Assign Ext</strong> , depending on what you need. </li><li>  In the <b>Phone Provisioning</b> tab, copy the phone's MAC address. </li><li>  In the same tab, in the drop-down list of your phones, delete the attached phone by clicking the <strong>Delete</strong> button on the right. </li><li>  At the top, click the <strong>Add</strong> button. </li><li>  In the drop-down list, select your custom template. </li><li>  Paste the previously copied MAC address of the phone. </li><li>  Click <strong>OK</strong> twice to save the user settings. </li><li>  Go to the <strong>Phones</strong> section, select the phone and click <strong>Reprovisioning</strong> . </li></ol><br><h3>  Application to configured and connected IP phone </h3><br><ol><li>  In the 3CX management interface, go to the <strong>Extensions</strong> section, click on the number (user) for which you want to apply the template, and go to the <strong>Phone Provisioning</strong> tab. </li><li>  In the drop-down list with your phones, select the IP phone to which you want to apply a custom template. </li><li>  Copy the MAC address of the phone. </li><li>  Delete the attached phone by clicking the <strong>Delete</strong> button on the right. </li><li>  At the top, click the <strong>Add</strong> button. </li><li>  In the drop-down list, select your custom template. </li><li>  Paste the previously copied MAC address of the phone. </li><li>  Click <strong>OK</strong> twice to save the user settings. </li><li>  Go to the <strong>Phones</strong> section, select the phone and click <strong>Reprovisioning</strong> . </li></ol><br><h2>  Pattern Features </h2><br>  Depending on the changes made to the templates, you may need to completely reset the IP phone before auto-tuning the user template. <br><h3>  Yealink Custom Templates </h3><br>  Unlike other manufacturers, Yealink for autotuning uses 2 configuration files.  Because of this, the template has two sections &lt;! [CDATA [, which generate two autotune files for each phone. <br><br><ul><li>  The first section &lt;! [CDATA [defines the general parameters of this phone <strong>model</strong> ( <strong>model</strong> ) and corresponds to file names of the form <strong>y0000000000xx.cfg</strong> .  Here <strong>xx</strong> is the identifier of a specific model as defined by Yealink.  You can not change it.  In this article, these files are called <b>y-files</b> . </li><li>  The second section &lt;! [CDATA [defines the individual configuration of the device with a given MAC address.  It includes the extension number and other parameters of a particular user. </li></ul><br>  In order for the custom Yealink template to work correctly, you must manually edit the template before applying the template: <br><br><ul><li>  The name of the custom template changes the name of the corresponding Yealink phone model.  Therefore, this new name should be indicated above section <strong>&lt;! [CDATA [</strong> for the corresponding model (right screenshot).  Please note that the model name corresponds to the correct <strong>xx</strong> index in the <strong>y-file</strong> (for example, the <strong>y-file</strong> T19P has the index <strong>53</strong> , and it cannot be changed!). </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/aee/9b7/c5b/aee9b7c5be8821bf67fc97f61204f906.png"><br><br><ul><li>  The names <strong>y0000000000xx.cfg</strong> must be unique in the different user templates.  The easiest way to achieve this is to select the contents of the file and copy it into a text editor.  Then, using the <strong>Replace All</strong> function, find the test y0000000000 and replace it with y1000000000 for the first custom template, y2000000000 for the second custom template, etc. </li></ul><br><img title="image" src="https://habrastorage.org/getpro/habr/post_images/c97/c92/c0d/c97c92c0d94a6b08f423a58f3765f363.png" alt="y file.png"><br><br><h2>  Universal Templates </h2><br>  <strong>It is strongly not recommended to explicitly specify in the template such parameters as port numbers, IP address or FQDN of the 3CX server, user credentials, etc.</strong>  If the template does not contain such hard-coded information, it can be called universal (portable).  It can be transferred to another installation of the 3CX system.  This is very useful for integrators who modify patterns to solve specific user tasks.  Universal templates should be placed in the folder <br><pre>  C: \ ProgramData \ 3CX \ Instance1 \ Data \ Http \ Interface \ provisioning \ XXXXXXXXXX \ CustomTemplates \ phones </pre><br>  When updating the system, files in this directory are saved (backed up and then restored).  <strong>Do not use the file name of the custom template matching the name of the stock template</strong> .  Stock templates are overwritten with every 3CX update.  Thus, your custom templates will be overwritten without warning. <br><br>  If the <b>CustomTemplate \ phones</b> path is missing, create these folders (case sensitive) and restart the <strong>MC01</strong> service. <br><br><h2>  3CX custom template support </h2><br>  3CX supplies stock templates for all supported IP phones, as well as for some legacy IP phones.  Patterns for outdated phones allow them to be automatically correctly configured and provide many of the latest features of 3CX.  <strong>However, modifying stock templates deprives you of official 3CX support, as described</strong> <a href="https://www.3cx.com/ordering/procedures/"><strong>here</strong></a> <strong>.</strong>  If you have problems with a specific IP phone, before opening the application, you should reset it to the default settings and configure the stock template.  After this, repeat the actions that caused the problem, and only after that open the application in 3CX technical support. <br><br>  In other words, 3CX does not provide any additional support for custom templates, with the exception of this manual.  In addition, if you have created a custom template, you must constantly monitor updates to the corresponding stock template.  Since the stock patterns correspond to the IP phones' firmware, an outdated user pattern may cause the IP phone to work incorrectly with the updated firmware. </div><p>Source: <a href="https://habr.com/ru/post/328070/">https://habr.com/ru/post/328070/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328060/index.html">New version of HPE Recovery Management Central 4.0 is available for download.</a></li>
<li><a href="../328062/index.html">Services on Go in Badoo: how we write and support them</a></li>
<li><a href="../328064/index.html">3D modeling and animation: a guide for beginners</a></li>
<li><a href="../328066/index.html">Internet of things - marketing or a real threat</a></li>
<li><a href="../328068/index.html">Ensuring data and service availability: RPO, RTO performance and SLA planning</a></li>
<li><a href="../328072/index.html">‚Äú55% of our users do not use the web version at all‚Äù - Tinkoff.ru about mobile development</a></li>
<li><a href="../328074/index.html">Do not miss the online broadcast of the conference Build 2017</a></li>
<li><a href="../328076/index.html">Unusual hackathon May 20-21: S7 Airlines</a></li>
<li><a href="../328078/index.html">Working with Dunno - Proactive Reading Technologies and Hybrid Storage</a></li>
<li><a href="../328080/index.html">‚ÄúRunn Me!‚Äù - tells us another PHP framework *. And heard "Throw Me!". Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>