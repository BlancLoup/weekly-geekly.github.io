<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Is Telegram Safe? v2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the very moment Telegram appeared, only lazy did not criticize it. The residents of Reddit, Hacker News, etc. did it with equal enthusiasm. 

 In...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Is Telegram Safe? v2</h1><div class="post__text post__text-html js-mediator-article">  From the very moment Telegram appeared, only lazy did not criticize it.  The residents of Reddit, Hacker News, etc. did it with equal enthusiasm. <br><a name="habracut"></a><br>  In a rush to reason the fiercest critics, a contest was announced with the main prize of $ 200,000 for the first person who could break the protocol and read the contents of a secret chat between two imaginary users. <br>  The competition, as the organizers apparently expected, attracted attention, but caused a <a href="https://news.ycombinator.com/item%3Fid%3D6931457">flurry of</a> even more criticism due to the limited potential of researchers in choosing tools for analysis: only the encrypted contents of the correspondence were available, without being able to influence its contents or enter into or interaction with its authors (thus excluding opportunities for MITM, replay attacks, etc). <br><br>  In response, <a href="http://twitter.com/moxie">some</a> even offered a counter <a href="http://www.thoughtcrime.org/blog/telegram-crypto-challenge/">challenge</a> on similar conditions, with a deliberately vulnerable protocol, pointing to the unrealistic nature of the proposed scenario. <br><br>  A year later, taking into account the criticism, Telegram announced a new <a href="https://core.telegram.org/contest300K">contest</a> with a prize fund of $ 300,000 for breaking the protocol and an additional $ 100,000 for a successful attack, the result of which would be the bot receiving the encrypted message from the attacker. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At this time, any researcher can act not only in the passive role of an observer, but also has the ability to conduct active attacks (MITM, CPA, tampering, etc.). <br><br>  The wide scope of opportunities for researchers, however, hides an inexorable fact: banal <i>implementation</i> errors are more often a threat to protocols than a vulnerable scheme.  Everyone makes mistakes, and programmers here, unfortunately, are no exception: <br><br>  Apple's 'goto fail' ( <a href="http://web.nvd.nist.gov/view/vuln/detail%3FvulnId%3DCVE-2014-1266">CVE-2014-1266</a> ) <br>  OpenSSL's 'Heartbleed' ( <a href="http://web.nvd.nist.gov/view/vuln/detail%3FvulnId%3DCVE-2014-0160">CVE-2014-0160</a> ). <br>  Bash's 'ShellShock' ( <a href="http://web.nvd.nist.gov/view/vuln/detail%3FvulnId%3DCVE-2014-6271">CVE-2014-6271</a> ) <br><br>  This is just a small list of those that have found significant resonance due to their criticality and coverage. <br><br>  Bearing in mind that programmers make mistakes more often than mathematics *, I decided to start research not from a protocol, but from clients implementing this protocol.  It was decided to start with the <a href="https://github.com/vysheng/tg">console client</a> . <br><br><img src="https://habrastorage.org/files/1dc/ac8/1d8/1dcac81d835e49a4b761be38bb12f11e.png"><br><br>  What a surprise it was when it was discovered that all the data of the <i>‚Äúsecret‚Äù chat</i> (including the _private_ key) are stored on the disk in the <b>unencrypted</b> form: <br><br><img src="https://habrastorage.org/files/404/e28/c3a/404e28c3ae964e7bbefe02c7fa9e4535.png"><br><br><img src="https://habrastorage.org/files/fb3/a82/3be/fb3a823beac64ef5bf98602a87f3a57e.png"><br><br>  And read by two functions `read_secret_chat_file` <br><br><img src="https://habrastorage.org/files/a33/861/063/a3386106374e4c19ba098c4adbbd8fcb.png"><br><br>  And `read_secret_chat`: <br><br><img src="https://habrastorage.org/files/f5d/756/a89/f5d756a8980e4d978a0e9849665ca73f.png"><br><br>  Which is easily confirmed by the debugger: <br><br><img src="https://habrastorage.org/files/3b6/6a9/a69/3b66a9a694e34397924eddd8d39f3117.png"><br><br>  What does this mean for the end user? <br><br>  Since Telegram does not guarantee <i>forward secrecy</i> ( <a href="http://en.wikipedia.org/wiki/Forward_secrecy">PFS</a> ), this means that an attacker who has been in passive <i>listening</i> mode ( <i>eavesdropping</i> ) for a long time, gaining control of your device, in addition to the contents of <b>all</b> secret chats (opened on this device), will also be able to <b>continue</b> <i>on your behalf of</i> any of them, not being forcibly completed by that moment. <br><br>  How reliable is the protocol from this perspective? <br><br>  Not too much.  Because in this case, the reliability of all your correspondence begins to be determined not by the stability of the protocol, but by the reliability of the weakest component of your system, be it a browser ... or a shell. <br><br>  Stay tuned. <br><br>  <b>PS</b> The problem turned out to be endemic not only for the console client but also for the Android client (https://github.com/DrKLO/Telegram) <br><br><img src="https://habrastorage.org/files/abf/d45/33e/abfd4533ef234ee691d69ad5f1b5899d.png"><br><br>  <b>PPS</b> Telegram developers are <a href="https://core.telegram.org/mtproto">aware of the</a> problem and consider it an <b><i>acceptable</i></b> compromise: <br><br><blockquote>  If you‚Äôre an interrupted, you‚Äôll be able to take care of the interrogated messages and then <i>appropriately</i> select the interrogated messages.  It can <b>not be a problem</b> .  however, the following steps could be taken to overcome this weakness. </blockquote><br>  Silent, however, is the fact that the attacker will be able not only to decrypt all ** messages <i>post factum</i> , but also to intercept and continue the session in such a way that the interlocutor of the compromised user will not notice the substitution. <br><br>  <b>PPPS The</b> newly introduced ratcheting mechanism in the protocol (re-keying protocol) does not solve the problem, and in some circumstances only aggravates: because ratchet (re-keying protocol) designed to guarantee a <i><a href="http://en.wikipedia.org/wiki/Forward_secrecy">perfect forward secrecy</a></i> does not guarantee <a href="http://en.wikipedia.org/wiki/Forward_secrecy">PFS</a> in strict sense (the window for a ratchet is 100 messages or 1 week), an attacker can intercept the session and force a new ratchet to be forced, ‚Äúcutting off‚Äù the compromised user from the session. <br><br>  * Which, of course, is not true. <br>  ** Until the 20th version (20 layer) of the protocol, <i>absolutely</i> everything, starting with the 20th version of the protocol, everything, starting with the last ratchet. </div><p>Source: <a href="https://habr.com/ru/post/244735/">https://habr.com/ru/post/244735/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244723/index.html">Hacker's guide to neural networks. Schemes of real values. Strategy # 1: Random local search</a></li>
<li><a href="../244725/index.html">Grunt quick setup for comfortable development</a></li>
<li><a href="../244727/index.html">Why 1C is bad and why 1C programmers don‚Äôt like it so much</a></li>
<li><a href="../244729/index.html">Expanding the canvas of Van Gogh's ‚ÄúStarry Night‚Äù with the help of the Wolfram Language (Mathematica)</a></li>
<li><a href="../244731/index.html">GPS monitoring for personal use (part 2. Systems overview)</a></li>
<li><a href="../244737/index.html">rusEfi: results of 2014 and plans</a></li>
<li><a href="../244741/index.html">"Iron" vulnerability in DRAM allows you to change the contents of someone else's memory</a></li>
<li><a href="../244743/index.html">Digital Guard Key_P1: creation history and first results</a></li>
<li><a href="../244745/index.html">Thinking out loud about developing javascript applications on the example of a small Line Of Business framework</a></li>
<li><a href="../244747/index.html">IT Pro Community Day December 17: from server to cloud</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>