<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Debian Server for a newbie</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Somehow I was worried about having my own FTP server. Especially under this case "in the trash" was given a computer that way a decade ago. Since I am...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Debian Server for a newbie</h1><div class="post__text post__text-html js-mediator-article">  Somehow I was worried about having my own FTP server.  Especially under this case "in the trash" was given a computer that way a decade ago.  Since I am a person though Windows, but I started with pure DOS (who remembers about Comrade Figurnov‚Äôs books?), I decided to do everything on Linux.  In Linux, I was zero full.  Also complicated the task - only the console, no lawsuits (as well - this is Linux).  Distribution was chosen by Debian.  It so happened that the need for a 2TB personal vault disappeared a year later and the computer was given in good hands, and the hard drive was attached to the right place.  But a good experience of a 100% newcomer was gained.  What stupid mistakes I made at first!  And Habr read, by the way, while I dealt with problems.  Therefore, I dedicate this debut (first) article on Habr√© to those who want to do Linux from scratch and this article is designed for smooth input "into the topic", being, in fact, filtering and systematizing everything I found on the Internet.  Earlier I already published this material, but, I think, on Habr√© it will be useful too. <br><a name="habracut"></a><br>  What and how we want to get as a result: <br>  - console installation of OS from the USB stick; <br>  - console management skills; <br>  - create your own repository; <br>  - providing remote access via FTP / SFTP; <br>  - providing remote control via SSH protocol; <br>  - remote inclusion of the server behind the router; <br>  - creating conditions for the web server (ideally, a bunch of nginx + apache). <br><br>  In the internet a lot of step by step instructions.  Sometimes there are annoying bugs, and if there is still a linuksoid and snotty yet, then you can spend a couple of hours just to understand that you don‚Äôt need an extra stick or a dot - everything is important in Linux!  The following is done for the practical purposes of the tasks set ‚Äî it is not necessary to take everything as a serious instruction for creating a serious server.  Especially in the process of ‚Äúrestoring experience‚Äù there can be mistakes in me too ... <br><br><h4>  - Once </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, there is an empty computer with connected peripherals.  First you need to install the OS itself.  There are also images of all the Debian 6.0.0 stable disks.  I have long refused laser carriers, i.e.  To install, you need to make a bootable USB flash drive.  The flash drive was found on 2Gb.  After searching, it turned out that it is possible to make, but from the Linux environment itself.  I had to install debian from the image of the first disk to a virtual machine (we connect the image to the virtual machine as a virtual CD-ROM and the installation is done ‚Äúhonestly‚Äù as if from a laser disk).  Set "wholesale" - i.e.  and the GUI too (in version 6 there was only GNOME).  However, after everything is done, load the deabian, connect the USB flash drive to the virtual machine and open the console. <br><br>  Execute the command: <br><br>  <b># dmesg</b> <br><br>  We see something like this: <br><pre><code class="bash hljs">[373982.581725] sd 8:0:0:0: [sdc] 4001760 512-byte hardware sectors (2049 MB) [373982.582718] sd 8:0:0:0: [sdc] Write Protect is off [373982.582718] sd 8:0:0:0: [sdc] Mode Sense: 03 00 00 00 [373982.582718] sd 8:0:0:0: [sdc] Assuming drive cache: write through [373982.584152] sd 8:0:0:0: [sdc] 4001760 512-byte hardware sectors (2049 MB) [373982.585718] sd 8:0:0:0: [sdc] Write Protect is off [373982.585718] sd 8:0:0:0: [sdc] Mode Sense: 03 00 00 00 [373982.585718] sd 8:0:0:0: [sdc] Assuming drive cache: write through [373982.585718] sdc: [373982.589280] sd 8:0:0:0: [sdc] Attached SCSI disk</code> </pre> <br><br>  This means that the flash drive is defined in the system. <br><br>  Download the boot.img.gz file (debian.org) for the required architecture (in my case i386) and copy it to some directory.  Next, execute the command from this directory: <br><br>  <b># zcat boot.img.gz&gt; / dev / sdc</b> <br><br>  Now you need to pull out and plug back the USB flash drive so that the new structure / partition table is recognized.  This will update the partition table stored by udev.  For verification, execute the following commands: <br><br>  <b># mkdir / mnt</b> <b><br></b>  <b># mount / dev / sdc / mnt /</b> <b><br></b>  <b># ls / mnt</b> <br><br>  and see installation files such as syslinux.cfg, setup.exe, and so on.  So everything is fine - the flash drive was mounted. <br><br>  Next, download the ISO image of netinstall (debian.org) with a size of 150-180MB for the corresponding architecture (in my case i386).  Netinstall installs the base system, no network needed.  Copy this image to some directory and from this directory execute and unmount the USB flash drive: <br><br>  <b># cp debian-6.0.1a-i386-netinst / mnt</b> <b><br></b>  <b># umount / dev / sdc</b> <br><br>  Phew  Now with you there is always a flash drive for installation. <br><br>  If you need to enable such an installer on a flash drive with other OS, then you can contact the grub bootloader.  I already have a bootable flash drive with grub4dos.  Create a debian folder in the root of the flash drive and drop it there: debian-6.0.1a-i386-netinst.iso, initrd.gz, initrdg.gz, linux - the last 3 files can be pulled from the first Debian 6.0.0 stable installation disk or downloaded (debian .org).  And in the menu grub'a (menu.lst) you need to add the following: <br> <code>title Debian 6.0.1a - Netinstall (Basic System, VGA Install) <br> kernel /debian/linux video=vesa:ywrap,mtrr vga=788 -- quiet <br> initrd /debian/initrdg.gz <br> <br> title Debian 6.0.1a - Netinstall (Basic System, TXT Install) <br> kernel /debian/linux -- quiet <br> initrd /debian/initrd.gz</code> <br> <br>  Now we stick the flash drive into our improvised server, select the boot from the flash drive through the BIOS and install Debian on a regular basis.  When installing anything special, I did not find: select the installation with the graphical interface and then the interactive mode.  You can mark up the file system automatically - for the first time come down.  After installation and reboot, as well as logging in, we will be happy to see a black screen with a command line prompt - the basic installation is complete! <br><br><h4>  - Two </h4><br><br>  Next, you need to set up access and control over the SSH protocol.  Also, in order not to bathe with the console, you would need to install mc (Midnight Commander) - an analogue of nc (Norton Commander) in DOS or tc (TotalCommander) in Windows.  But to install, you need to copy the package from the network and install it.  There is no network.  At the same time, almost all of the necessary software is available on Debian 6.0.0 stable disks (disks, it seems, 6).  But I refused to work with disks.  You can set up a network and use the official network repository - there is no easier way.  However, this decision is not for us - we need broad autonomy at the first stage.  Yes, and since when we go the easy way - acquaintance is still more research in nature.  So you need to make your local repository. <br><br>  1) preparation ... <br><br>  We'll have to go back to the virtual machine again.  We log in to the console as root (on the server, we will configure sudo in the future, so as not to shine for every nonsense).  Create directories: <br><br>  <b># mkdir debian / pool</b> <b><br></b>  <b># mkdir debian / pool / contrib</b> <b><br></b>  <b># mkdir debian / pool / main</b> <br><br>  In these directories we copy the contents of the same directories from all disks.  It will turn out one daddy with a volume of 30GB.  After the contents of all disks are copied, create directories to store information about packages in the repository: <br><br>  <b># cd / debian</b> <b><br></b>  <b># mkdir -p debian / dists / stable / contrib / binary-i386</b> <b><br></b>  <b># mkdir -p debian / dists / stable / main / binary-i386</b> <br><br>  Further, all commands are executed based on the current debian directory - we are not going beyond its borders!  We collect lists of packages: <br><br>  <b># apt-ftparchive packages pool / main /&gt; dists / stable / main / binary-i386 / Packages</b> <b><br></b>  <b># apt-ftparchive packages pool / contrib /&gt; dists / stable / contrib / binary-i386 / Packages</b> <br><br>  Compress the lists: <br><br>  <b># gzip -c dists / stable / contrib / binary-i386 / Packages&gt; dists / stable / contrib / binary-i386 / Packages.gz</b> <b><br></b>  <b># gzip -c dists / stable / main / binary-i386 / Packages&gt; dists / stable / main / binary-i386 / Packages.gz</b> <br><br>  Create Release files: <br><br>  <b># apt-ftparchive release pool / contrib /&gt; dists / stable / contrib / binary-i386 / Release</b> <b><br></b>  <b># apt-ftparchive release pool / main /&gt; dists / stable / main / binary-i386 / Release</b> <b><br></b>  <b># cd / debian / pool / dists / stable</b> <b><br></b>  <b># apt-ftparchive release.</b>  <b>&gt; Release</b> <br><br>  Now the / debian folder can be copied to the hard disk and, if desired, connect and organize local repositories on other systems.  What we are doing - copy the folder to removable USB-hard. <br><br>  2) connect ... go to the server as root <br><br>  We connect USB-hard to the server.  Next, we understand how to determine the hard: <br><br>  <b># dmesg</b> <br><br>  We mount it and merge everything that we have done before: <br>  <b># mount / dev / sda1 / mnt /</b> <b><br></b>  <b># mkdir / dpool</b> <b><br></b>  <b># cp -r / mnt / * / dpool</b> <br><br>  Edit the file /etc/apt/sources.list - comment all repositories and write ours: <br><br>  <i>deb file: / debian / stable contrib main</i> <br><br>  Here we must make a brief digression.  How to fix file if one console?  There is a vi editor for this: <br><br>  <b># cd / etc / apt</b> <b><br></b>  <b># sudo vi sources.list</b> <br><br>  Next, do what you need: move the cursor to the desired position and click "i".  This is the input mode.  Do what you need.  Done and press ESC to return to command mode.  Next - all new.  After everything is completed, press the sequence ‚ÄúESC: w!  Enter ‚Äùis a return command with saving changes.  Fearfully?  After installing mc, life will be easier ... <br><br>  Making an update: <br><br>  <b># apt-get update</b> <b><br></b>  <b># apt-cache gencaches</b> <br><br>  Our local storage is done! <br><br><h4>  - Three </h4><br><br>  Now we‚Äôve finally gotten close to SSH. <br><br>  1) not all the same life as root to work ... <br><br>  But first, make life easier for yourself - let's set up sudo.  Sudo is a system that allows you to delegate certain privileged resources to users with a protocol of work.  Simply put, user will be able to perform actions that were originally intended to be performed only as root. <br><br>  Go to the server as root and open the file / etc / sudoers.  Use again the vi editor: <br><br>  <b># cd / etc</b> <b><br></b>  <b># vi sudoers</b> <br><br>  Looking for the string: <br><br>  <i>root ALL = (ALL) ALL</i> <br><br>  And under it we add: <br><br>  <i>user ALL = (ALL) ALL</i> <br><br>  We leave with the preservation.  Done!  Now you can log in as a user, but when performing critical commands, just add ‚Äúsudo‚Äù before the command.  For the first time, the system will request the current password for identification.  Logout and log in as user.  The root password can now be written down on a piece of paper - we will use it very rarely, you can also forget it) <br><br>  2) tortured the console and vi ... <br><br>  Put the package: <br><br>  <b># sudo apt-get install mc</b> <br><br>  After installation, enter the command <br><br>  <b># mc</b> <br><br>  Now you can rejoice and forget about the commands mkdir, cp, ls, cd, as well as console control in vi.  Edit files can now be on F4.  Nostalgia for the 2000s - then on the 386th I only used north and ... <br><br>  3) finally SSH ... <br><br>  Put the package: <br><br>  <b># sudo apt-get install ssh</b> <br><br>  After a successful installation, you need to add a line to the end of the / etc / ssh / sshd_config file to restrict access: <br><br>  <i>AllowUsers root user</i> <br><br>  We carry out: <br><br>  <b># sudo mc</b> <br><br>  Next, go to the specified path and edit the file.  After editing, problems with saving will not be - mc is running as root.  After editing, you need to update the ssh service - exit to the console and restart the service: <br><br>  <b># sudo /etc/init.d/ssh restart</b> <br><br><h4>  - Four </h4><br><br>  1) network ... <br><br>  For the final touch, you only need to configure the network before moving to remote control.  My situation is simple: the computer is connected to the router with a wire.  Since DHCP is enabled on the router, the Internet will be received from it automatically. <br><br>  Network interface settings are stored in the file: / etc / network / interfaces <br><br>  Here is an example of the working contents of the file: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># The loopback network interface auto lo iface lo inet loopback # The primary network interface allow-hotplug eth0 iface eth0 inet static address 10.0.0.10 netmask 255.0.0.0 network 10.0.0.0 broadcast 10.255.255.255 gateway 10.0.0.1 # dns-* options are implemented by the resolvconf package, if installed dns-nameservers 10.0.0.1 dns-search debian</span></span></code> </pre> <br><br>  Run mc via sudo and edit this file according to the network settings that are valid for your network. <br><br>  Setting the server name and hosts are: / etc / hostname, / etc / hosts <br>  If our server is called ‚Äúdebian‚Äù, then we check: <br>  In the hostname is only: <br><br>  <i>debian</i> <br><br>  And in the first line of the host: <br><br>  <i>127.0.0.1 localhost debian</i> <i><br></i>  <i>10.0.0.10 debian.localhost debian</i> <br><br>  After all this we extinguish the computer: <br><br>  <b># sudo poweroff</b> <br><br>  2) remote control ... <br><br>  We disconnect all cables, pull our server to the farthest corner and connect it to the outlet and to the network.  In this case, you need to take care in advance that during the BIOS boot phase, you would not wait for the button called ‚Äúany‚Äù to be pressed after it was surprised to find that the keyboard and mouse are not detected.  Press the power button and go back to the working computer.  I have a Windows on this computer.  How now to connect to the server? <br><br>  There is such a program putty.  You can get it on the Internet.  After its launch, in the ‚ÄúSession‚Äù tab, we register the IP address of our server, leaving 22 as the port (this is the standard port for the Shell).  We check that the UTF-8 is set in the ‚ÄúTranslation‚Äù tab in order to prevent the cracks from displaying the Cyrillic alphabet.  We return to ‚ÄúSession‚Äù and open the channel: ‚ÄúOpen‚Äù.  After connecting, we will be asked to confirm the creation of connection keys with us - we confirm.  Enter username: user.  Next, enter the password - the password is not displayed when you enter  this is normal.  After the connection, we see the server prompt and the native console, but not on the entire monitor, but in a small window, which can also be adjusted with the mouse.  This means ‚ÄúHooray, comrades!‚Äù. <br><br><h4>  - Five </h4><br><br>  In principle, WinSCP can be used to access the file system.  This will give the opportunity to copy files between machines.  But it will not be very correct, because  after SSH authorization, access to the entire system will be opened.  Ideally, I would just like to make one network folder on the server and open access to it.  And there is a solution for this. <br><br>  Put the package: <br><br>  <b># sudo apt-get install samba</b> <br><br>  Now edit the file /etc/samba/smb.conf.  Here is an example of working content: <br><pre> <code class="bash hljs">[global] workgroup = WORKGROUP server string = %h server dns proxy = no <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> file = /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/samba/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>.%m max <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> size = 1000 syslog = 0 panic action = /usr/share/samba/panic-action %d security = share encrypt passwords = <span class="hljs-literal"><span class="hljs-literal">true</span></span> passdb backend = tdbsam obey pam restrictions = yes unix password sync = yes passwd program = /usr/bin/passwd %u passwd chat = *Enter\snew\s*\spassword:* %n\n *Retype\snew\s*\spassword:* %n\n *password\supdated\ssuccessfully* . pam password change = yes [homes] comment = Home Directories browseable = no <span class="hljs-built_in"><span class="hljs-built_in">read</span></span> only = yes create mask = 0700 directory mask = 0700 valid users = %S [printers] comment = All Printers browseable = no path = /var/spool/samba printable = yes guest ok = no <span class="hljs-built_in"><span class="hljs-built_in">read</span></span> only = yes create mask = 0700 [<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>$] comment = Printer Drivers path = /var/lib/samba/printers browseable = yes <span class="hljs-built_in"><span class="hljs-built_in">read</span></span> only = yes guest ok = no [user] path = /ftp/pub <span class="hljs-built_in"><span class="hljs-built_in">readonly</span></span> = no guest ok = yes</code> </pre> <br><br>  As a comment you can see the following: <br>  - it is necessary to indicate the working group in which the screw machines work; <br>  - the security parameter must be set to share; <br>  - in the ‚Äúuser‚Äù section, you need to specify the real path and allow guest access - we add this section to the file itself. <br><br>  After all this business we create the specified directories: <br><br>  <b># mkdir / ftp</b> <b><br></b>  <b># mkdir / ftp / pub</b> <br><br>  And we understand the rights to these folders: <br><br>  <b># sudo chmod 0755 / ftp</b> <b><br></b>  <b># sudo chmod 0777 / ftp / pub</b> <b><br></b>  <b># sudo chown -R root / ftp</b> <br><br>  In this case, access will be made to the ftp folder, but nothing will be changed in it.  But in the pub folder - do anything.  Naturally, you can simplify everything by throwing out the daddy pub and correcting the rights for ftp ... <br><br>  And finally, we restart the service so that all the settings work: <br><br>  <b># sudo /etc/init.d/samba restart</b> <br><br><h4>  - Six </h4><br><br>  Now it's time to release our baby in the network))) <br><br>  For a start, it would be nice to make network file access and management from anywhere on the network.  But what do we have in topology? <br>  We must have Internet access with a static real IP address.  Those.  access from outside must be done directly, and not through the switching of the provider's networks.  For example, users of the Ramnet network are all sitting behind a large NAT, since  go online through multiple pools.  This means that the IP issued during registration does not even coincide with the IP that is ‚Äúimprinted‚Äù, for example, when visiting sites.  Real IP is uniquely the IP that is registered in the network settings of the network card driver.  To find out the real IP or not, you can use some network service on the Internet that shows your IP address.  Suppose we have a real IP. <br>  Further, if the network wire is directly connected to the server, then there are no special problems - the server is already on the network.  And if there is some kind of routing device (router, or intermediate splitter-switch based on the same Linux)?  In this case, we are already behind our NAT, which needs to be configured a little: forward ports.  There is a port for each network service on the machine: SSH - 22, FTP - 21. That is, the router needs to be configured so that when accessing the port via our real IP it will be accessed to the server on this port.  If our server has an address of 10.0.0.10, and the provider has issued a real IP of 172.122.34.89, then in the router it is necessary to perform port forwarding (Port Forwarding) 21 and 22 from outside (172.122.34.89) to the server (10.0.0.10).  It is easy to configure a couple of lines in the admin panel of the router, or the marshurtization table of the intermediate Linux switch is correct.  Let's say it all done too. <br><br>  In this case, to get through SSH via putty, you just need to specify the real IP address, port 22 (see above, where a small configuration of the putty client is described).  We log in and access the server console. <br><br>  And file access?  It's a little more complicated here.  You can use WinSCP, but as already mentioned, this is not our method.  Samba works only in LAN.  Have to set up FTP access ... <br><br>  For FTP we use the proftpd service.  Put the package: <br><br>  <b># sudo apt-get install proftpd</b> <br><br>  The configuration file is here: /etc/proftpd/proftpd.conf.  Here is an example of a work file: <br><pre> <code class="bash hljs">Include /etc/proftpd/modules.conf ServerName <span class="hljs-string"><span class="hljs-string">"Debian"</span></span> ServerType standalone DeferWelcome off MultilineRFC2228 on DefaultServer on ShowSymlinks on TimeoutNoTransfer 600 TimeoutStalled 600 TimeoutIdle 1200 DisplayLogin welcome.msg DisplayChdir .message <span class="hljs-literal"><span class="hljs-literal">true</span></span> ListOptions <span class="hljs-string"><span class="hljs-string">"-l"</span></span> DenyFilter \*.*/ DefaultRoot ~ RequireValidShell off Port 21 &lt;IfModule mod_dynmasq.c&gt; <span class="hljs-comment"><span class="hljs-comment"># DynMasqRefresh 28800 &lt;/IfModule&gt; MaxInstances 10 User nobody Group nogroup Umask 022 022 AllowOverwrite on TransferLog /var/log/proftpd/xferlog SystemLog /var/log/proftpd/proftpd.log &lt;IfModule mod_quotatab.c&gt; QuotaEngine off &lt;/IfModule&gt; &lt;IfModule mod_ratio.c&gt; Ratios off &lt;/IfModule&gt; &lt;IfModule mod_delay.c&gt; DelayEngine on &lt;/IfModule&gt; &lt;IfModule mod_ctrls.c&gt; ControlsEngine off ControlsMaxClients 2 ControlsLog /var/log/proftpd/controls.log ControlsInterval 5 ControlsSocket /var/run/proftpd/proftpd.sock &lt;/IfModule&gt; &lt;IfModule mod_ctrls_admin.c&gt; AdminControlsEngine off &lt;/IfModule&gt; &lt;Anonymous /home/ftp/pub&gt; User user1 Group nogroup UserAlias anonymous user1 #RequireValidShell off MaxClients 10 TransferRate RETR,STOR 4096 &lt;Limit LOGIN&gt; AllowAll &lt;/Limit&gt; &lt;Limit READ&gt; AllowAll &lt;/Limit&gt; &lt;Limit WRITE&gt; AllowAll &lt;/Limit&gt; &lt;/Anonymous&gt; &lt;Anonymous /home/ftp/pub&gt; User user2 Group nogroup #UserAlias anonymous user2 #RequireValidShell off MaxClients 3 #TransferRate RETR,STOR 4096 &lt;Limit LOGIN&gt; AllowAll &lt;/Limit&gt; &lt;Limit READ&gt; AllowAll &lt;/Limit&gt; &lt;Limit WRITE&gt; AllowAll &lt;/Limit&gt; &lt;/Anonymous&gt;&lt;/code&gt; : -  FTP    "standalone",         ; -  "Anonymous"  :  user1         4/      10,  user2   ,        3.  ftp-: &lt;b&gt;# sudo /etc/init.d/proftpd restart&lt;/b&gt;            FTP-    . ,   21      .         /      /.          .        : &lt;b&gt;# sudo useradd user1 # sudo useradd user2&lt;/b&gt;    : &lt;b&gt;# sudo passwd user1 # sudo passwd user2&lt;/b&gt;      - - )))       SFTP .  proftpd   mod_sftp.    (3 )          .        10     ,   .           .   SFTP    SSH -      .               , ..  ,  ,      . SFTP    ( FTP      ,     ),     .    -   mod_sftp.   ,       SSH: &lt;source lang="bash"&gt;&lt;IfModule mod_sftp.c&gt; SFTPEngine on SFTPLog /var/log/proftpd/sftp.log TransferLog /var/log/proftpd/xferlog-sftp.log Port 2220 SFTPHostKey /etc/ssh/ssh_host_rsa_key SFTPHostKey /etc/ssh/ssh_host_dsa_key SFTPAuthorizedUserKeys file:~/.sftp/authorized_keys SFTPCompression delayed MaxLoginAttempts 6 &lt;/IfModule&gt;</span></span></code> </pre> <br><br>  This case is inserted into proftpd.conf and accessed via port 2220. But at the same time mod_sftp must be installed along with proftpd.  In the regular repoft, proftpd is built without mod_sftp.  He will have to "dobosirah" independently.  I ‚Äúpatched up‚Äù according to some English instructions ‚Äî I no longer remember.  The process is no less creative than building your own repository, but the result is still not pleased, so I will not describe all this. <br><br><h4>  - Seven </h4><br><br>  So we set up FTP.  Now I would like to be able to turn on the server when necessary.  For example, you need to take something from a network folder. <br><br>  There is one subtlety.  Only power and network are connected to our server.  But network cards have long learned to ‚Äúwake up‚Äù a computer: you just need to turn on such support in the computer's BIOS and send the ‚Äúmagic packet‚Äù to it.  We read in wikipedia: <br><br>  Magic packet is a special byte sequence that can be inserted into UDP or IPX packets for normal transmission over local networks.  Typically, for WOL, packets of top-level protocols are broadcast out, since in the case of dynamic assignment of addresses, it is not known which, say, IP address corresponds to which MAC address.  However, to correctly pass through a router that bans broadcasting packets, you can send a packet to a specific address. <br><br>  Composition magic packet <br><br>  First comes the so-called ‚Äúsynchronization chain‚Äù: 6 bytes, equal to 0xFF.  Then - the MAC address of the network card repeated 16 times.  That is, if the address of the board looked like 01: 02: 03: 04: 05: 06, then the magic packet would be: <br><br><pre> <code class="bash hljs">FFFFFFFFFFFF010203040506010203040506010203040506010203040506 010203040506010203040506010203040506010203040506010203040506 010203040506010203040506010203040506010203040506010203040506 010203040506010203040506</code> </pre> <br><br>  There are a lot of programs, half of which work, and the other not, which form and send such packets to the specified IP.  But this is true only in the local network.  But after all, we have a real IP - then you can simply try to send a packet to it, and configure the router to relay this packet to the server.  Packets for "wake-up" are usually sent on ports 7 or 9. We push them through the router to the server IP.  Next, the easiest way to use the network resource is wakeonlan.ru: we hammer in our real IP address and MAC address of the server's network card.  Click the button "Turn on the computer!".  After a couple of dispatches, the system may well write about the inclusion failure ‚Äî the server is still behind NAT, and it is more reasonable to turn off the response to router ping in the router settings.    ,     IP  MAC.       ‚Äî           14 ?)         (      GPRS ). <br><br>       .   ,              .      ,   ,    .     ¬´¬ª         .      .        DD-WRT (  ).           .   )     ,       (  -  ).      -  ,          -‚Ä¶    ‚Äî      ARP .              .   ,  : <br> <code>ip neigh change 10.0.0.10 lladdr 00:10:20:1F:C4:57 nud permanent dev br0 <br> ip neigh add 10.0.0.10 lladdr 00:10:20:1F:C4:57 nud permanent dev br0</code> <br> <br> ,            ¬´¬ª   MAC- (        )   ¬´¬ª   IP      (               ‚Äî          ARP)  . <br><br>   ‚Äî         .  -   ‚Äî  . </div><p>Source: <a href="https://habr.com/ru/post/126944/">https://habr.com/ru/post/126944/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126929/index.html">Cheap iPhone 4 will be available</a></li>
<li><a href="../126930/index.html">Introduction to parallel computing</a></li>
<li><a href="../126937/index.html">Droider Chart. Release 66, honey</a></li>
<li><a href="../126941/index.html">PHP 5.3.8 released</a></li>
<li><a href="../126942/index.html">Internet Desktop Threat Activity Monitor</a></li>
<li><a href="../126945/index.html">Original texts: Yandex against copy-paste</a></li>
<li><a href="../126947/index.html">iPIF Margin notes about your second app</a></li>
<li><a href="../126948/index.html">Positive bias or what is common to the global crisis with a broken deadline</a></li>
<li><a href="../126949/index.html">Professional</a></li>
<li><a href="../126950/index.html">HeidiSQL - client to mysql / mssql servers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>