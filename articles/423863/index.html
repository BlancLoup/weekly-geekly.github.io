<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÄúStandoff‚Äù on PHDays 8 - A View from SOC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In May of this year, the Positive Hack Days 8 conference was held, where we again participated in the role of SOC in the already traditional Confronta...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>‚ÄúStandoff‚Äù on PHDays 8 - A View from SOC</h1><div class="post__text post__text-html js-mediator-article">  In May of this year, the Positive Hack Days 8 conference was held, where we again participated in the role of SOC in the already traditional Confrontation (The Standoff). <br><br>  This year, the organizers took into account past mistakes and the standoff began on time.  The attackers are great!  They attacked almost continuously for 30 hours, so our night shift could not even take a nap. <br><br><img src="https://habrastorage.org/webt/i0/yw/im/i0ywimlu0or4ejkdbbxgzqygo7m.jpeg" alt="image"><br><a name="habracut"></a><br><h1>  What is what </h1><br>  We talked about the event in our last year‚Äôs <a href="https://habr.com/company/pm/blog/329730/">article</a> , but briefly to refresh. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The battle takes place between the Defenders and the Attackers.  Defenders can defend alone, and can use the services of expert monitoring centers (SOS) and keep the defense ‚Äúlooking in both‚Äù.  Defenders also allocate means of defense and protection from hackers, villains. <br><br>  This year, the organizers built 7 objects that had to be protected: <br><br><ul><li>  Offices </li><li>  Telecom operator </li><li>  CHP </li><li>  Oil company </li><li>  Railway company </li><li>  Bank </li><li>  IoT devices </li></ul><br><img src="https://habrastorage.org/webt/64/uk/ho/64ukho6r9qvu8mtoos6hdxde3xg.jpeg" alt="image"><br><br>  And 3 SOC teams participated: <br><br><ul><li>  Prospective monitoring </li><li>  Angara Technologies Group </li><li>  Rostelecom </li></ul><br><img src="https://habrastorage.org/webt/te/br/bx/tebrbxiyutpo2oba5phqjnxshiu.jpeg" alt="image"><br><br>  Hackers could have fun at their discretion.  In fact, the only rule was not to attack the infrastructure directly, on which the Confrontation was ‚Äúspinning‚Äù.  In addition, the organizers periodically "played up" to the attacker, deploying holey services.  And in the end, the anti-fraud systems in the city were completely turned off. <br><br>  For hackers, a special cryptocurrency currency and miners were developed, which they could implement in compromised objects.  ‚ÄúThe miner is spinning, bitcoin is muddling‚Äù - according to the apt remark of a member of the Kazakh team Tsark. <br><br>  This year we again acted as SOC for one of the office segments.  The defenders of this segment were the guys from Servionics, already familiar to us from last year‚Äôs event. <br><br><h1>  What defended </h1><br>  For defense, we used: <br><br><ul><li>  ViPNet IDS for DMZ. </li><li>  ViPNet IDS for LAN. </li><li>  ViPNet HIDS (host IDS) to monitor key Office servers. </li><li>  ViPNet Threat Intelligence Analytics System (TIAS) for log analysis, monitoring and analytics. </li></ul><br>  And of course, in our sensors, we use our own developed rules, which also include signatures on the latest attacks that frightened the whole world! <br><br><h1>  What was fixed </h1><br>  During the period of opposition by SoC analysts, prospective monitoring recorded about 2 million events, 30 information security incidents were revealed. <br><br>  The alignment of forces on the battle map was as follows: <br><br><img src="https://habrastorage.org/webt/-0/x8/my/-0x8myvsukbtvpot_6cfesem9a8.jpeg" alt="image"><br><br><ul><li>  Office-R2 is the border router of the Office 1 object, through which it connected to two Internet providers F-telecom and Backup ISP. </li><li>  Office-FW1 - firewall for access control between local network segments and external resources (DMZ). </li><li>  Office-R1 - used for routing within the office segment. </li></ul><br>  Our colleagues, the Servionika team, were responsible for supporting the infrastructure facilities of Office 1.  Our task was to inform when something goes wrong with the guys. <br><br>  After the start of the game, the majority of events took place around the DMZ-zone.  The attackers tried to break through the external barrier through the exploitation of web vulnerabilities.  It all started according to tradition with scanning.  The attackers launched DirBuster and Acunetix scanners and walked through the addresses in the DMZ. <br><br>  The attacker with ip 100.110.255.127 persistently tried to establish a connection with the MySQL database of the online store on the protected node 100.64.100.167.  All enumeration attempts were successfully blocked by the server. <br><br>  After some time, traditionally began to pick up passwords for SSH and RDP. <br><br>  At node 100.64.100.183, when scanning an attacker with address 100.110.255.17, a vulnerability was found in SMB.  There was no MS17-010 update on the <a href="https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010">server</a> . <a href="https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010">Docs.microsoft.com/en-us/security-updates/SecurityBulletins/2017/ms17-010</a> .  What defenders were timely informed. <br><br>  It is noteworthy that the test for the possibility of exploiting vulnerabilities in EternalBlue was carried out a great number of times.  These events were among the most frequent during the Confrontation.  But this is not surprising.  Despite the fact that a year has passed since the moment of mass infection, there are still a lot of machines vulnerable to this attack. <br><br><img src="https://habrastorage.org/webt/ck/ah/dv/ckahdvs16slz98jogamz29_pkzm.jpeg" alt="image"><br><br>  Also, the attackers massively tried to exploit the vulnerability CVE-2014-6271 (remote code execution in Bash). <br><br>  At around 4:00 pm on the first day, the successful exploitation of the SambaCry vulnerability at node 100.64.100.167 was fixed.  Advocates lost access to this site until the next day.  The attacker with the address 100.110.255.176 after the operation conducted a reconnaissance of the perimeter using NMAP and took outfile with the data on scanning. <br><br>  On the night of the compromised node, connections were made to port 443 of node 100.100.100.202.  After resetting all sessions, the activity has ended.  Presumably, the miner from the hacked 100.64.100.167 was flooded to the node 100.100.100.202. <br><br><img src="https://habrastorage.org/webt/xe/k7/2r/xek72rnsuiz-l4bmeu9kebpudpi.jpeg" alt="image"><br>  <i>The main investigation tool is a sheet of paper and a pen.</i> <br><br>  At night, the attackers actively took up the hacking of the Zabbix monitoring system.  Attempts were made to exploit the eternalblue vulnerability, pick up a password for ssh and try to flood the shell via /zabbix/zabbix.php. <br><br><img src="https://habrastorage.org/webt/ec/fn/ma/ecfnmaxek-51d_5sagcv0bhctk8.jpeg" alt="image"><br><br>  On the morning of the second day, suspicious activity was recorded from the protected node 100.100.100.202.  A connection to ip from the external network 100.64.100.242 was established from it and suspicious certificates were sent.  The conducted investigation showed that the ssh password was stranded on this node and the miner was flooded.  Also stole the database file bd.frm.  In general, the attacker "slept" on a self-signed certificate.  We immediately reacted to this car, watched the session, and there still sits a hacker.  Warm. <br><br>  Almost in parallel with this, the breaking of another node 100.64.100.242 (Wordpress) was discovered.  It had some pretty interesting credentials.  For login "Shaggy" picked up a password.  And he turned out to be ... of course Scooby. <br><br><img src="https://habrastorage.org/webt/p1/or/to/p1orto-puc94dpfgemdaqai_hci.gif" alt="image"><br><br>  After a compromise from this site, perimeter reconnaissance was performed.  We scanned ports 20, 25, 80.  Hacker kicked out, took the car. <br><br>  Until recently, hackers tried to conduct attacks like sql-injections, bruteed FTP, RDP, SSH.  In general, they acted according to the classical scheme. <br><br><h1>  Results </h1><br><img src="https://habrastorage.org/webt/wb/6h/ou/wb6houzrc_phazbmclvjjjvcdfq.jpeg" alt="image"><br><br>  "Confrontation" succeeded!  Of course, this time we did not manage to ‚Äúget dry out of the water.‚Äù  The attackers managed to partially penetrate the defense of the office.  However, this event brought invaluable experience.  The obtained information will help to better understand modern attack vectors and take measures to counter them in practice. </div><p>Source: <a href="https://habr.com/ru/post/423863/">https://habr.com/ru/post/423863/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423851/index.html">Introducing the new plugin for Grafana - Statusmap panel</a></li>
<li><a href="../423853/index.html">How S3 DataLine Storage is arranged</a></li>
<li><a href="../423855/index.html">Zyxel Nebula - ease of management as the basis for savings</a></li>
<li><a href="../423857/index.html">6 problems that you will encounter while learning programming yourself</a></li>
<li><a href="../423861/index.html">Solar lanterns - we need brighter</a></li>
<li><a href="../423865/index.html">Roskomnadzor publicly reported</a></li>
<li><a href="../423867/index.html">The founder of 3D printing studio - about his work</a></li>
<li><a href="../423869/index.html">The future of jobs. The main thing from the report of the World Economic Forum</a></li>
<li><a href="../423871/index.html">Solve a logical problem for students in SQL</a></li>
<li><a href="../423873/index.html">PICASO 3D Designer X 3D Printer Review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>