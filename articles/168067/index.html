<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Evolution of agents managed by a neural network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Let's look at the environment: there may be particles of "food" and agents in it. Using sensors, agents can obtain information about the environment. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Evolution of agents managed by a neural network</h1><div class="post__text post__text-html js-mediator-article">  Let's look at the environment: there may be particles of "food" and agents in it.  Using sensors, agents can obtain information about the environment.  If the agent is close enough to the food particle, then it is considered ‚Äúeaten‚Äù and disappears, and at that very moment a new food particle appears in a random place of the environment.  The task of a group of agents is to collect food.  Efficiency is considered based on the total amount of food collected. <br><br>  Let's simulate a competitive environment to automatically search for the optimal behavior of a group of agents.  The algorithm of the behavior of agents will be constructed in the form of a neural network. <br><a name="habracut"></a><br>  To simulate a competitive environment, you can use a genetic algorithm and conduct tournaments: all agents are assigned a neural network of a certain configuration (‚Äúbrain‚Äù) and after a certain period of time the number of food particles eaten is recorded.  Those neural networks, under whose management agents were able to collect more food, win ‚Äî based on them a new population of neural networks, etc., are winning. <br><br>  Of course, there are specialized algorithms for learning neural networks, but I used exactly the genetic algorithm, because: <br><ul><li>  I did not want to be limited to a specific topology of the neural network (if more objectively, this is due to the lack of theoretical assumptions as to which network topology and the number of neurons should be used in this case) </li><li>  I wanted to check the possibility of using a genetic algorithm for training a neural network </li><li>  reused the implementation of the genetic algorithm that he created to solve <a href="http://habrahabr.ru/post/163195/">another problem</a> </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Let's look at the details of our model. </h3><br>  The medium is characterized by the size (width and height), as well as the number of agents and food particles.  The environment is closed - agents cannot go beyond it. <br>  Food particles are characterized by coordinates (x, y). <br>  Each agent is characterized by a position (x, y) and a direction vector. <br><br>  Sensors of agents receive from the environment the following indicators: a signal about the presence of food nearby, the distance to the food particle, the cosine of the angle between the direction vector of the agent and the vector directed at the food, the signal of the presence of other agents nearby (and accordingly the distance and cosine of the angle between the direction of our agent and vector directed to another agent).  The ability of an agent to obtain information about the environment is limited to the "scope" - roughly speaking, an agent can only see ahead of himself. <br><br>  The agent interacts with the environment by changing its own position and direction.  That is, the sensors are fed to the input of the neural network, and the output reads the value of the angle by which to rotate, as well as the value of the value by which the agent‚Äôs velocity should be changed. <br><br><img src="https://habrastorage.org/storage2/bfc/d3b/a1b/bfcd3ba1b648aa6aee9a793174832b1c.png"><br><br><h4>  Genetic operations on the neural network </h4><br>  For convenience, the neural network can be transformed into a linear form.  To do this, it is enough to write all the parameters of the neural network into a one-dimensional array.  The parameters include the weights of connections, as well as the type and parameters of the transition functions of neurons.  The operation of crossing and mutation of linear chromosomes is quite simple. <br><img src="https://habrastorage.org/storage2/978/4dd/d70/9784ddd70577040ba3ed2e09a08fb5ff.png"><br><br><h3>  Model in action </h3><br>  We will observe agents in an environment with dimensions of 600 x 400, but to speed up calculations, tournament competitions are held in an environment with more compact parameters: medium sizes are 200 x 200, the number of agents is 10, the number of food particles is 5. <br><br>  The neural network of optimal configuration is obtained quite quickly.  In the video, you can observe how the behavior of agents changes as a result of the tournament selections (if you look at YouTube, the image will look a little clearer): <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/QV1EML_BWDc%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhgM4TBYNOPTa2boGHD2ePiVxmgGjg" frameborder="0" allowfullscreen=""></iframe><br><br><h4>  Interesting observations </h4><br><ol><li>  The environment can be complicated by allowing food particles to move.  Interestingly, the neural networks obtained for the environment with static food particles show good results in an environment where food can move (at the end of the video I demonstrated moving food particles). <br><br></li><li>  The environment in which agents operate is partially observable (agents can only see ahead of themselves, and cannot see the position of all the objects of the environment at the same time). <br>  Also, the environment is non-deterministic (food particles may appear in random places and move in different directions). <br><br>  But as a result of ‚Äúevolution‚Äù, such configurations of neural networks are quite often formed, which, while moving toward the goal, ‚Äúforce‚Äù the agent to ‚Äúturn around‚Äù (this can also be seen in the video).  This behavior is effective because there is always the possibility that as the agent approaches the target, some other agent may eat this bit of food, or a new piece of food will appear on the way to the goal, which can be eaten faster. <br><br>  If to generalize, those neural networks that help to cope with environmental constraints turn out to be more efficient. <br><br><img src="https://habrastorage.org/storage2/8ab/5e9/419/8ab5e9419ba94e026e1158ddbd74630e.png"><br><br></li><li>  Generally speaking, observing the behavior of agents, sometimes it seems that they behave quite ‚Äúnaturally‚Äù - like a group of some bugs or fish. <br><br>  I implemented the ability to save the configuration of a neural network to a file, and the following video is a demonstration of various behavioral strategies that I have observed: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/3nZETrsCMgw%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhhp6YOUP8_yGCW0p07l2wK1SRx4ng" frameborder="0" allowfullscreen=""></iframe><br></li></ol><br><br><h3>  If you want to experiment </h3><br><ol><li>  You must have <a href="">Java</a> runtime installed <br><br></li><li>  The emulator can be downloaded <a href="https://github.com/lagodiuk/evo-neural-network-agents/tree/master/bin">from here.</a> <br><br></li><li> Emulator emulation: <br> <code>java -jar simulator.jar</code> <br> </li></ol><br>  <a href="https://github.com/lagodiuk/evo-neural-network-agents/tree/master/brains">Here</a> are the neural network configuration files that I used in the demonstration videos. <br><br>  The emulator is equipped with a simple graphical interface.  By pressing the left mouse button, you can add food, and by pressing the right button - new agents. <br><br><img src="https://habrastorage.org/storage2/075/7fe/ee1/0757feee1e4b3beca5107be1baaa011f.png"><br><br><h3>  Technical details </h3><br>  The architecture of the main components of the application is as follows: <br><br><img src="https://habrastorage.org/storage2/919/09d/932/91909d932bb8afd0ebee4cd6867e854d.png"><br><br>  The genetic algorithm is performed in a separate stream, and at the end of it, all agents are established with a new neural network configuration, which entails a change in the behavior of agents on the screen.  The neural network configuration can be saved - the xml format is quite convenient for this. <br><br><h3>  Instead of conclusion </h3><br>  The use of a genetic algorithm to train a small neural network has been crowned with success. <br><br>  Working on such a small task you get a lot of pleasure: it is very interesting to observe the evolution and collective behavior of artificial creatures. <br><br><h3>  Links </h3><br><ol><li>  In this you can read about the agent-based approach for creating intelligent systems, about various environmental options and decision-making strategies: <br>  <a href="http://www.amazon.com/Artificial-Intelligence-A-Modern-Approach/dp/0131038052">Stuart J. Russell, Peter Norvig, Artificial Intelligence: A Modern Approach</a> (available in translation) <br><br></li><li>  Project sources on <a href="https://github.com/lagodiuk/evo-neural-network-agents">githab</a> <br><br></li><li>  Generic implementation of the genetic algorithm - <a href="https://github.com/lagodiuk/genetic-algorithm">source</a> <br></li></ol><br></div><p>Source: <a href="https://habr.com/ru/post/168067/">https://habr.com/ru/post/168067/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168049/index.html">Google agreed with French publishers for 60 million euros</a></li>
<li><a href="../168055/index.html">Announced the first smartphones based on Clover Trail and Lexington</a></li>
<li><a href="../168059/index.html">Quick start with phpDaemon based WebSocket</a></li>
<li><a href="../168061/index.html">Interesting possibilities of storage systems HP 3PAR. Part 1 - Persistent Ports</a></li>
<li><a href="../168063/index.html">Redmine - one-time password authentication (OTP)</a></li>
<li><a href="../168069/index.html">I2P network has accelerated</a></li>
<li><a href="../168073/index.html">Hi, JavaFX! Let's get acquainted?</a></li>
<li><a href="../168075/index.html">Working with structures or how I learned to write readable code</a></li>
<li><a href="../168077/index.html">Hor + vert + FOV, or adaptive field of view</a></li>
<li><a href="../168079/index.html">The story of a single SQL injection</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>