<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cubietruck. Road mini server. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The idea of ‚Äã‚Äãsuch a server was born on vacation. In the evening, I wanted to watch online TV shows on the tablet, but because of the unstable 3G rece...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cubietruck. Road mini server. Part 1</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/ba9/e1a/c81/ba9e1ac81eaf43aa96a7e8f2a72b2577.jpg" alt="image"><br>  The idea of ‚Äã‚Äãsuch a server was born on vacation.  In the evening, I wanted to watch online TV shows on the tablet, but because of the unstable 3G reception, the viewing turned into flour.  As an option, it was possible to download the series, but again, when downloading, the signal constantly floated, the speed jumped and the tablet had to be kept constantly on and on charging (application specifics).  By evening, a couple of episodes were downloaded and you could easily watch the serials. <br>  At this time, the idea of ‚Äã‚Äãcreating this device was born.  In an Internet, a large number of implementations of information storage on single-board computers of different manufacturers, but no combination of several solutions was found. <br><a name="habracut"></a><br>  <b>What are the plans:</b> <br>  The brain of the whole Cubietruck system <br>  HDD - 500Gb <br>  USB modem HUAWEI E3372 <br>  AC-DC 5V power supply <br>  Power supply DC-DC 12V - 5V (for car) <br><br>  How it will work: <br>  At home, this will be an ordinary NAS connected via a network cable (lan) and attached to the computer as a simple network drive. <br>  CubieTruck will constantly operate the WI-FI access point (in case there is no Wi-FI, but there is only a cable with DHCP). <br>  In the case that a network cable (lan) is connected to Cubietruck, the device connected to the access point Cubietruck must be connected to the Internet via a network cable, not 3G.  The modem should start its work when no network cable is connected to Cubietruck. <br><br>  When setting up relied on the post <a href="http://habrahabr.ru/post/225371/"><b>Cubietruck.</b></a>  <a href="http://habrahabr.ru/post/225371/"><b>Cozy, home server</b></a> so I will not describe the installation process. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>Network settings</b> </h4><br>  All the settings did on Windows. <br>  Write the image of the system on the USB flash drive, put it in its place and turn on Cubietruck. <br>  The system itself is installed and rebooted.  After that, Cubietruck with Cubian installed is ready to go. <br>  In the absence of a monitor with HDMI and keyboard, we need <a href=""><b>Putty</b></a> . <br>  Go to the device with DHCP (router and server), find the ip of our Cubietruck <br>  We make the connection on port <b>36000</b> , since this is the default port in SSH Cubian. <br>  <b>Cubie / cubie</b> login / password <br>  In the process of setting did not change. <br><br>  I personally changed the port. <br>  To do this, rule <b>sshd_config</b> <br><pre><code class="bash hljs">sudo nano /etc/ssh/sshd_config</code> </pre> <br>  Find the port with port 36000 <br>  <b>Port 36000</b> <br>  Change to <br>  <b>Port 22</b> <br>  We save.  In the <b>nano</b> editor to save, <b>press Ctrl + O</b> then <b>Enter</b> and exit <b>Ctrl + X.</b> <br>  Reboot <br><pre> <code class="bash hljs">sudo reboot</code> </pre><br>  All can now connect to the standard port <b>22</b> <br>  Since the cube is planned as something portable, in the future, the <b>eth0</b> interface, that is, the Enternet port will work via <b>DHCP</b> , but now, for convenience of configuration, I will assign it a static address: <br>  Interface settings are stored in the <b>/ etc / network / interfaces</b> file <br><pre> <code class="bash hljs">sudo nano /etc/network/interfaces</code> </pre><br>  Default configuration <br><pre> <code class="bash hljs">auto lo iface lo inet loopback <span class="hljs-comment"><span class="hljs-comment"># auto eth0 iface eth0 inet dhcp</span></span></code> </pre><br>  Change interface <b>eth0</b> .  <u>Do not forget that everyone changes the settings for themselves</u> <br><pre> <code class="bash hljs">auto eth0 allow-hotplug eth0 iface eth0 inet static address 192.168.1.247 netmask 255.255.255.0 gateway 192.168.1.10 dns-nameserver 192.168.1.7</code> </pre><br>  Reboot <br><pre> <code class="bash hljs">sudo reboot</code> </pre><br>  We ping the host ya.ru check its availability. <br><pre> <code class="bash hljs">cubie@Cubian:~$ ping ya.ru PING ya.ru (213.180.193.3) 56(84) bytes of data. 64 bytes from www.yandex.ru (213.180.193.3): icmp_req=1 ttl=56 time=2.04 ms 64 bytes from www.yandex.ru (213.180.193.3): icmp_req=2 ttl=56 time=1.82 ms 64 bytes from www.yandex.ru (213.180.193.3): icmp_req=3 ttl=58 time=1.95 ms</code> </pre><br>  The answer is, the network is configured <br><h4>  <b>Auto mount HDD partition</b> </h4><br>  Create a folder where the HDD will be mounted. <br><pre> <code class="bash hljs">sudo mkdir /media/files</code> </pre><br>  We give read / write access for all users. <br><pre> <code class="bash hljs">sudo chmod 777 /media/files</code> </pre><br>  View HDD partitions. <br><pre> <code class="bash hljs">sudo fdisk -l</code> </pre><br>  I have a 500Gb disk installed <br><pre> <code class="bash hljs">Disk /dev/sda: 500.1 GB, 500107862016 bytes 255 heads, 63 sectors/track, 60801 cylinders, total 976773168 sectors Units = sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x82e3ff7e</code> </pre><br>  Let's format the disk in <b>ext4</b> file system <br><pre> <code class="bash hljs">sudo mkfs.ext4 /dev/sda</code> </pre><br>  We recognize the <b>UUID of</b> our HDD <br><pre> <code class="bash hljs">sudo blkid</code> </pre><br><pre> <code class="bash hljs">/dev/mmcblk0p1: LABEL=<span class="hljs-string"><span class="hljs-string">"cubieboard"</span></span> UUID=<span class="hljs-string"><span class="hljs-string">"2a1124a9-6108-4da0-932f-78ccbfd92458"</span></span> TYPE=<span class="hljs-string"><span class="hljs-string">"ext4"</span></span> /dev/sda: UUID=<span class="hljs-string"><span class="hljs-string">"ff0caf96-39b9-4aff-a4d0-5892abfdca8f"</span></span> TYPE=<span class="hljs-string"><span class="hljs-string">"ext4"</span></span></code> </pre><br>  We need UUID / dev / sda <br>  Copy UUID without quotes <br>  <b>ATTENTION.</b>  <u>Each disk has its own UUID</u> <br>  Now add an entry to <b>/ etc / fstab</b> <br><pre> <code class="bash hljs">sudo nano /etc/fstab</code> </pre><br>  At the very end we add <br><pre> <code class="bash hljs">UUID=ff0caf96-39b9-4aff-a4d0-5892abfdca8f /media/files ext4 defaults,acl,user,user_xattr,errors=remount-ro</code> </pre><br>  * exhibit attributes to your liking <br>  Records are separated either by a space or a tab <br>  Reboot: <br><pre> <code class="bash hljs">sudo reboot</code> </pre><br>  After reboot check <br><pre> <code class="bash hljs">mount</code> </pre><br>  The disk is mounted in the system <br><pre> <code class="bash hljs">/dev/sda on /media/files <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> ext4 (rw,nosuid,nodev,noexec,relatime,errors=remount-ro,data=ordered)</code> </pre><br>  <u>If the disk is formatted in the <b>NTFS</b> system and needs to be mounted into the system</u> <br><pre> <code class="bash hljs"> Device Boot Start End Blocks Id System /dev/sda1 2048 234438655 117218304 7 HPFS/NTFS/exFAT</code> </pre><br>  To begin, we will update the list of repositories and search for indexes of updated versions of programs, drivers, the kernel, and everything else: <br><pre> <code class="bash hljs">sudo apt-get update</code> </pre><br>  In order to install the utility <b>ntfs-3g</b> <br><pre> <code class="bash hljs">sudo apt-get install ntfs-3g</code> </pre><br>  We recognize the <b>UUID of</b> our section <br><pre> <code class="bash hljs">sudo blkid</code> </pre><br><pre> <code class="bash hljs">/dev/sda1: LABEL=<span class="hljs-string"><span class="hljs-string">"M-PM-^]M-PM-&gt;M-PM-2M-QM-^KM-PM-9 M-QM-^BM-PM-&gt;M-PM-&lt;"</span></span> UUID=<span class="hljs-string"><span class="hljs-string">"E8923D15923CE9A8"</span></span> TYPE=<span class="hljs-string"><span class="hljs-string">"ntfs"</span></span></code> </pre><br>  We need a UUID = "E8923D15923CE9A8" <br>  Now add an entry to <b>/ etc / fstab</b> <br><pre> <code class="bash hljs">sudo nano /etc/fstab</code> </pre><br>  At the very end we add <br><pre> <code class="bash hljs">UUID= E8923D15923CE9A8 /media/files ntfs-3g defaults,acl,user,user_xattr,errors=remount-ro</code> </pre><br>  * exhibit attributes to your liking <br>  Records are separated either by a space or a tab <br>  Reboot: <br><pre> <code class="bash hljs">sudo reboot</code> </pre><br>  After reboot check <br><pre> <code class="bash hljs">mount</code> </pre><br>  Disk with NTFS mounted <br><pre> <code class="bash hljs">/dev/sda1 on /media/files <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> fuseblk (rw,nosuid,nodev,noexec,relatime,user_id=0,group_id=0,allow_other,blksize=4096)</code> </pre><br><h4>  <b>Install samba</b> </h4><br>  To begin, we will update the list of repositories and search for indexes of updated versions of programs, drivers, the kernel, and everything else: <br><pre> <code class="bash hljs">sudo apt-get update</code> </pre><br>  Install <b>samba</b> <br><pre> <code class="bash hljs">sudo apt-get install samba samba-common-bin</code> </pre><br>  There are a lot of settings in samba, but now we need to configure only the main ones in order to access our disk. <br>  Open the <b>smb.conf</b> file <br><pre> <code class="bash hljs">sudo nano /etc/samba/smb.conf</code> </pre><br>  You can delete all the many settings, or you can add the necessary settings to the appropriate sections. <br><pre> <code class="bash hljs">[global] workgroup = WORKGROUP guest ok = yes netbios name = CubieNAS security = share browseable = yes [files] path = /media/files writeable = yes browseable = yes</code> </pre><br>  Restart Samba <br><pre> <code class="bash hljs">sudo /etc/init.d/samba restart</code> </pre><br>  We try to enter <br>  <b>\\ CubieNAS</b> or <b>\\ ip</b> <br>  If everything is set up correctly we will see the <b>files</b> folder <br><br>  I have a speed gigabit network: <br>  <b>EXT4 disc</b> <br>  File 1 Gb is transmitted at a speed of 24-29 Mb / s <br>  Folder with 300 files of various formats 16-34 Mb / s <br>  Copy from the cube <br>  File 1 Gb is transmitted at a speed of 26-34 Mb / s <br>  Folder with 300 files of various formats 22-33Mb / s <br>  <b>NTFS disk</b> <br>  Copy to dice <br>  File 1 Gb is transmitted at a speed of 8-9 Mb / s <br>  Folder with 300 files of various formats 3-8 Mb / s <br>  Copy from the cube <br>  File 1 Gb is transmitted at a speed of 24-28Mb / s <br>  Folder with 300 files of different formats 12-27Mb / s <br>  Not fast, but it works. <br><br>  <a href="http://habrahabr.ru/post/235199/"><b>Cubietruck.</b></a>  <a href="http://habrahabr.ru/post/235199/"><b>Road mini server.</b></a>  <a href="http://habrahabr.ru/post/235199/"><b>Part 2</b></a> <br>  <a href="http://habrahabr.ru/post/235361/"><b>Cubietruck.</b></a>  <a href="http://habrahabr.ru/post/235361/"><b>Road mini server.</b></a>  <a href="http://habrahabr.ru/post/235361/"><b>Part 3</b></a> </div><p>Source: <a href="https://habr.com/ru/post/235355/">https://habr.com/ru/post/235355/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235333/index.html">JavaScript method insertAdjacentHTML and beforeend</a></li>
<li><a href="../235343/index.html">Opportunity rover memory format</a></li>
<li><a href="../235345/index.html">Segment - corporate data networks, Huawei equipment testing report</a></li>
<li><a href="../235347/index.html">As we laid the cable under the river bottom</a></li>
<li><a href="../235353/index.html">Smartphone Meizu MX4 officially presented</a></li>
<li><a href="../235357/index.html">Conversion increase: how to create a product card that you want to buy</a></li>
<li><a href="../235361/index.html">Cubietruck. Road mini server. Part 3</a></li>
<li><a href="../235365/index.html">The book "When I spoke ... About education, IT and not only"</a></li>
<li><a href="../235367/index.html">Incoming and outgoing calls in the call center</a></li>
<li><a href="../235369/index.html">Version Control Systems: Fossil Part I</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>