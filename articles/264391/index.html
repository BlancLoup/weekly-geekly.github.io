<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Build USB HID under BeagleBone</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In one of the publications we wrote about setting up a Chinese USB-WiFi for Beagledone. Today we want to give a way to build your own device managemen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Build USB HID under BeagleBone</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/246/2ab/abc/2462ababc9d346aaa870f991f2aec34a.jpg"><br><br>  In one of the publications we wrote about setting up a Chinese <a href="http://embeddedsoft.ru/index.php%3Fpage%3D38%26f%3D0%26id%3D113%26place%3D1%26page_id%3D3">USB-WiFi for Beagledone.</a> Today we want to give a way to build your own device management class via the HID protocol.  The <a href="http://www.signal11.us/oss/hidapi/">hidapi</a> library was taken as a <a href="http://www.signal11.us/oss/hidapi/">basis</a> , and then a method of cross-compiling under beaglebone and building a test program for working with a USB device was made. <br><br>  One of the easiest and most reliable ways to make USB control over Linux is to use the libusb-1.0 library.  Hidapi is a ‚Äúadd-on‚Äù above libusb, and is used to easily connect hid devices to a programmable device.  If you build on a ‚Äúclean‚Äù hidapi system, you will have to compile libusb separately and only then build hidapi.  In this article we will consider the assembly exactly hidapi.  Looking ahead, let's say that android ndk refused to collect hidapi without intervention. <br><a name="habracut"></a><br>  To get started, we downloaded the library and unpacked it into the working directory; we used the Linux Mint distribution for building and testing.  In the unpacked folder (in our case it is hidapi-0.7.0), read the instructions readme.txt.  Since BeagleBone uses Linux, we go to the hidapi-0.7.0 / linux folder and see there another readme.txt file with instructions for building under Linux.  In short, the library offers us two options for building: using hid-libusb.c or with hid.c.  In the first case, the library libusb is used, which must be installed in the system.  In the second case, hidraw is used, requiring libudev-devel. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We note right away that we tried to collect both options;  only hid-libusb.c was successfully assembled, and hid.c produced various kinds of errors.  Next, the developers offer us to put the package libusb-1.0-0-dev or libudev-devel.  After installing the packages, you can build the project in the linux folder.  We execute make, the hidapi-0.7.0 / hidtest / project is being built, and it is being built in our hidapi-0.7.0 / linux folder.  At the command prompt, you can see the compiler commands.  Further, the essence of the assembly under BeagleBone is to substitute the cross-compiler instead of the regular gcc and g ++, respectively.  But there is one subtlety, if you look inside the makefile, then you can see there <br><div class="spoiler">  <b class="spoiler_title">lines</b> <div class="spoiler_text">  LIBS = `pkg-config libusb-1.0 libudev --libs` -lpthread <br>  INCLUDES? = -I ../ hidapi `pkg-config libusb-1.0 --cflags` </div></div><br>  These lines add the paths to the libraries (includes), and set the library assembly keys (libs) dynamically.  To understand what loads the script into the assembly, you can run it in the console: `pkg-config libusb-1.0 libudev --libs` and` pkg-config libusb-1.0 --cflags`.  When building software under BeagleBone, we did not change the path to include (there are only header files .h, and cross-platform ones), and either we wrote it directly without pkg-config.  Perhaps this is not the best solution, but still working. <br><br>  In general, it looks like <div class="spoiler">  <b class="spoiler_title">in the following way</b> <div class="spoiler_text">  INCLUDEPATH + = / usr / include / libusb-1.0 <br>  Libs + = -lusb-1.0 -ludev -g <br>  hidapi.h add to the source folder. <br>  gcc -Wall -g -c -I / usr / include / libusb-1.0 hid-libusb.c -o hid-libusb.o` </div></div><br>  We fix the filefile by directly turning on the libraries, prescribe the cross-compiler and build the program under BeagleBone.  That's all, the program for working with USB HID device is ready. </div><p>Source: <a href="https://habr.com/ru/post/264391/">https://habr.com/ru/post/264391/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264381/index.html">Magic of tensor algebra: Part 18 - Mathematical modeling of the Janibekov effect</a></li>
<li><a href="../264383/index.html">Tox developers disassociate themselves from the Tox Foundation</a></li>
<li><a href="../264385/index.html">The study "The global state of information security 2015" (GSISS 2015). Part 1</a></li>
<li><a href="../264387/index.html">Announcement Rust 1.2</a></li>
<li><a href="../264389/index.html">We measure power consumption for ASIC digital blocks (even before manufacturing)</a></li>
<li><a href="../264395/index.html">Debugging the rules of RewriteRule, or a little about the intimate life of mod_rewrite</a></li>
<li><a href="../264397/index.html">Pipeline with spark.ml</a></li>
<li><a href="../264399/index.html">The digest of interesting materials for the mobile # 115 developer (August 2-9)</a></li>
<li><a href="../264401/index.html">IBM Launches 50 Projects for the Open Source Developer Community</a></li>
<li><a href="../264405/index.html">Ministry of Defense accused of sending sensitive information through public postal services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>