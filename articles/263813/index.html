<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Underground carders market. Translation of the book "Kingpin". Chapter 5. ‚ÄúCyberwar!‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kevin Poulsen, editor of the magazine WIRED, and in his childhood blackhat, the hacker Dark Dante, wrote a book about " one of his acquaintances ." 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Underground carders market. Translation of the book "Kingpin". Chapter 5. ‚ÄúCyberwar!‚Äù</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/353/64b/a0e/35364ba0e409475fbd05cd11e8132734.jpg" align="right">  Kevin Poulsen, editor of the magazine WIRED, and in his childhood blackhat, the hacker Dark Dante, wrote a book about " <a href="https://en.wikipedia.org/wiki/Max_Butler">one of his acquaintances</a> ." <br><br>  The book shows the path from a teenager-geek (but at the same time pitching), to a seasoned cyberpahan, as well as some methods of the work of special services to catch hackers and carders. <br><br>  The beginning and the translation plan are here: ‚Äú <a href="http://habrahabr.ru/post/261491/">Shkvoren: schoolchildren translate a book about hackers</a> ‚Äù. <br>  <a href="http://habrahabr.ru/post/261491/">Prologue</a> <br>  <a href="http://habrahabr.ru/post/264227/">Chapter 1. "The Key"</a> <br>  <a href="http://habrahabr.ru/post/263819/">Chapter 3. ‚ÄúThe Hungry Programmers‚Äù</a> <br>  <a href="http://habrahabr.ru/post/263813/">Chapter 5. ‚ÄúCyberwar!‚Äù</a> <br>  <a href="http://habrahabr.ru/post/264349/">Chapter 6. "I miss crime"</a> <br>  <a href="http://habrahabr.ru/post/265149/">Chapter 8. ‚ÄúWelcome to America‚Äù</a> <br>  <a href="http://habrahabr.ru/post/263293/">Chapter 34. DarkMarket</a> <br>  <i>(we publish as soon as the translations are ready)</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The logic of choosing a book for working with schoolchildren is as follows: <br><ul><li>  there are few books about hackers in Russian (one and a half) </li><li>  There are no books about carding in Russian at all (there was <a href="http://habrahabr.ru/company/piter/blog/204042/">one</a> <b>UPD</b> ) </li><li>  Kevin Poulsen - WIRED Editor, No Stupid Comrade, Authoritative </li><li>  to introduce young people to the translation and creativity in Habr√© and get feedback from elders </li><li>  schoolchildren-students-specialists work very sparingly for learning and show the significance of the work </li><li>  The text is not very hardcore and is accessible to a wide range, but it touches on issues of information security, vulnerabilities of payment systems, the structure of the carding underground, basic concepts of the Internet infrastructure </li><li>  the book illustrates that "feeding" in underground forums - ends badly </li></ul><br>  Who wants to help with the translation of other chapters write in a personal <a href="https://habrahabr.ru/users/magisterludi/" class="user_link">magisterludi</a> . <br><br><h4>  Chapter 5. Cyber ‚Äã‚ÄãWar! </h4> <i>(for the translation thanks to the Habrawser <a href="https://habrahabr.ru/users/shiawasenahoshi/" class="user_link">ShiawasenaHoshi</a> )</i> <br><br>  Upon returning home to San Francisco, Max was tempted by the following line of code: <br>  bcopy (fname, anbuf, alen = (char *) * cpp - fname); <br><a name="habracut"></a><br>  It was one of 9 thousand lines in the Berkeley Internet Name Domain (BIND) source code - an old beam in the Internet infrastructure, just as important as any router or fiber-optic cable.  Developed in the early 80s by a DARPA grant (Defense Advanced Research Projects Agency - an agency of advanced defense research projects), BIND implemented a scalable Domain Name System (DNS), which, like a distributed telephone directory, translates human-readable strings like Yahoo.com into numeric addresses that the network operates on.  Without BIND or its analogs, we would read online news at 157.166.226.25 instead of CNN.com and go to 74.125.67.100 to use Google search.  <i>( <a href="http://habrahabr.ru/post/137587/">Habrapost about BIND</a> )</i> <br><br>  BIND was one of the innovations that made the rapid growth of the Internet possible.  He replaced the raw mechanism, which would not allow the Internet to expand.  But in the 90s, BIND was one of the legacy programs that created the biggest problem of Internet security.  His code was a product of times of honesty and simplicity, when the network was secluded and there were very few network threats.  Now, hackers have comprehended all the nuances and depths and returned with a seemingly endless set of security holes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/48e/a28/298/48ea2829895dcc6507808a42ba2360a5.png" alt="image" align="right">  The high priest of network experts named the <a href="https://ru.wikipedia.org/wiki/Internet_Systems_Consortium">Internet Software Consortium</a> ( <a href="https://ru.wikipedia.org/wiki/Internet_Systems_Consortium">Internet Software Consortium</a> - ISC) appointed itself as the guardian of the Internet code and frantically rewritten it.  But at the same time, the majority of modern complex networks in the world with glittering new servers and workstations were launched with a leaky computer program from the past era. <br><br>  In the 98th, security experts discovered the latest vulnerability in the code.  It came down to that lonely line of code at the beginning of the chapter.  She received a request from the Internet and, as expected, copied it byte-by-byte to a temporary ‚Äúunbuf‚Äù buffer in the server's memory.  But she did not correctly check the size of the incoming data.  Consequently, a hacker could intentionally send a too long request to the BIND server by overflowing the buffer and throwing the data into the rest of the memory, like oil from Exxon Valdez (see ‚Äú <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D1%258B%25D0%25B1%25D1%2580%25D0%25BE%25D1%2581_%25D0%25BD%25D0%25B5%25D1%2584%25D1%2582%25D0%25B8_%25D0%25B8%25D0%25B7_%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BA%25D0%25B5%25D1%2580%25D0%25B0_%25D0%25AD%25D0%25BA%25D1%2581%25D0%25BE%25D0%25BD_%25D0%2592%25D0%25B0%25D0%25BB%25D0%25B4%25D0%25B5%25D0%25B7">Ejection of oil from the tanker Exxon Valdez</a> ‚Äù from Wikipedia) <br><br>  If you perform such an operation unsystematically, it will lead to the collapse of the program.  However, a cautious hacker can do something more creepy.  He can load his own piece of executable code into the buffer and then, avoiding a fall, rise to the top of the program's memory space, reaching a zone of short-term data storage called ‚Äústack‚Äù. <br><br>  Stack is the place where the processor stores information about what it does - all the time the program takes the computer to the subroutine, the processor ‚Äúpushes‚Äù the current address into the stack as a bookmark, and therefore the processor knows where to return the data when they are ready. <br><br>  After the hacker is in the stack, he can rewrite the address to return the data to the address with a malicious code.  When the computer finishes with the current subroutine, it will return not to where it started, but to the hacker's instructions, and since BIND started up with administrator privileges (root), the hacker code will also run as root.  Now the computer is under the control of a hacker. <br><br>  Two weeks after Max and Kimi got married, the government-funded computer emergency <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D0%25BC%25D0%25BF%25D1%258C%25D1%258E%25D1%2582%25D0%25B5%25D1%2580%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B3%25D1%2580%25D1%2583%25D0%25BF%25D0%25BF%25D0%25B0_%25D1%2580%25D0%25B5%25D0%25B0%25D0%25B3%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25BD%25D0%25B0_%25D1%2587%25D1%2580%25D0%25B5%25D0%25B7%25D0%25B2%25D1%258B%25D1%2587%25D0%25B0%25D0%25B9%25D0%25BD%25D1%258B%25D0%25B5_%25D1%2581%25D0%25B8%25D1%2582%25D1%2583%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8">response team</a> at Carnegie Mellon University ( <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D0%25BC%25D0%25BF%25D1%258C%25D1%258E%25D1%2582%25D0%25B5%25D1%2580%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B3%25D1%2580%25D1%2583%25D0%25BF%25D0%25BF%25D0%25B0_%25D1%2580%25D0%25B5%25D0%25B0%25D0%25B3%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25BD%25D0%25B0_%25D1%2587%25D1%2580%25D0%25B5%25D0%25B7%25D0%25B2%25D1%258B%25D1%2587%25D0%25B0%25D0%25B9%25D0%25BD%25D1%258B%25D0%25B5_%25D1%2581%25D0%25B8%25D1%2582%25D1%2583%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8">Computer Emergency Response Team</a> (CERT) at Carnegie Mellon University), which launched the Hole SSP, issued a warning about vulnerability BIND with a link to a simple way to fix it: two additional lines of code that sifted out too long queries.  But the CERT fix also contained two other vulnerabilities, which were the result of the fix and reflected an underestimate of the importance of the hole.  Thus, not everyone was aware of the seriousness of the situation. <br><br>  Max knew her well. <br><br>  He read the CERT recommendations with amazement.  BIND was pre-installed on Linux and started on servers in corporate, non-commercial, educational, military networks and ISPs.  He was everywhere.  Was with so defective code line.  The only thing that kept the fierce attacks from the fact that no one wrote an exploit (exploiting vulnerability program) for this hole.  But it was a matter of time. <br><br>  Of course, on May 18th, an exploit appeared on Rootshell.com, a site with news about computer security created by enthusiasts.  Max picked up the phone and called Chris Bison, his contact at the FBI.  The situation is serious, he explained.  Anyone who did not install the patch on BIND could be hacked by any script kiddie capable of downloading an exploit and entering a command. <br><br>  If you plunge into history, it turns out that government computers were particularly vulnerable.  Just a month earlier, a less serious bug in Sun Solaris led to the cracking of computers at dozens of US military bases, which the deputy secretary of defense called "the most organized and systematic attack to date" on missile defense systems.  These attacks raised the cyberwar's full-scale alarm: the Pentagon gave them the code name Sunrise and considered Saddam Hussein to be the main suspect until investigators hit a young Israeli hacker who was just playing. <br><br>  The next day, Max called Beeson again when the hacker group ADM released a ready-to-use version of the BIND exploit, which scanned the Internet for unpatched servers, invaded them, installed itself and used the infected computer for subsequent scans and hacks.  Definitely, now someone could take over the entire Internet.  The question is ‚ÄúWho?‚Äù. <br>  He hung up and thought.  Someone was going to do it ... <br><br>  In enthusiastic, boyish colors, Max shared his plans with his bride.  Max could be the author of his own attack on BIND.  His version could close the vulnerability wherever it can be found, how the fruit flies fill everything with their larvae.  He would limit his attack to the targets most in need of security upgrades: the US Army and the government. <br><br>  ‚ÄúDon't get caught,‚Äù Kimi said.  She learned not to argue with Max when he was hostage to the idea. <br><br>  Max struggled with the dual nature of his personality: a married professional faced with a world threat and an impulsive child who loves to fool around.  The child won.  He sat down at the keyboard and began to program frantically. <br><br>  His code worked in three short steps.  It began with the fact that the program was throwing a virtual hook, through a hole in BIND, executed a command that caused the machine to access the Internet and import 230 bytes of the script.  In turn, this script was connected to already infected hosts, from where a large malicious package, called the rootkit, was downloaded. <br><br>  A rootkit is a set of standard system programs modified to serve a hacker: a modified login program works just like the original, but now it includes a backdoor (backdoor = back door, loophole) through which a cracker can again enter on the car.  The ‚Äúpasswd‚Äù program still allows users to change passwords, but now it also records and stores these passwords where they can be obtained later.  The new ‚Äúlist‚Äù displays the contents of the directory as usual, with the exception of hiding files that are part of the rootkit. <br><br>  After the rootkit was installed, the Max code could have done what the government could not do: it could update BIND on the hacked computer and close the security hole through which he entered.  The computer would now be safe, but as a friendly invader, Max could still log in again if he wanted to.  Max corrected the problem and used it.  He was both black hat and white hat at the same time. <br><br>  The attack itself will take just a couple of minutes.  At first, the computer is controlled by system administrators.  In the next instant, the hook is thrown, the script is downloaded, the rootkit is downloaded, and now the computer belongs to Max. <br><br>  Max was still programming when the FBI called him to ask about a report about a hole in BIND.  But the feds profuked their chance.  Now only the Max code has spoken to him.  It took him a little time to hack a couple of college cars, to use as a springboard, and then, on May 21, he went to the Internet through a stolen Verio account and ... launched the code. <br>  Excellent results were obtained immediately.  Max‚Äôs grappling-hook code reported success to his computer through Verio dial-up, so that he could watch the attack spread.  The hacked machines reported to him on the Xterm pop-up window on his computer.  Brooks Air Force Base is now owned by Max Vision ... Mc-Chord, Tinker, Offutt, Scott, Maxwell, Kirtland, Keesler, Robins ... His code penetrated Air Force servers, army computers, a car in the secretary‚Äôs office.  Each machine now had a backdoor that Max could use when he wanted. <br><br>  Max noted his conquests as control points in a computer game.  When his code embraced the network space of the Navy, he discovered so many unpatched BIND servers that a steady stream of pop-up windows became a bubbling mountain river.  When you try to cope with it, Max's computer went out. <br><br>  After a little tuning, the code was restarted.  For five days, Max was absorbed in his growing power over cyberspace.  He ignored the e-mails of the FBI, which was still waiting for a report. <br>  ‚ÄúWhere is the report?‚Äù Agent Beeson wrote.  "Call" <br><br>  He could do anything with such power and hack almost any network he wants.  Max ran his exploit on Id Software servers (Mesquite, Texas), a computer company that developed the third part of the world-famous first-person shooter Quake. <br>  Max loved such shooters.  He instantly found himself in the company's network and after a short search, he left it with a trophy.  He told Kimi that he had received the source code (= virtual drawings) of Quake III, the most anticipated game of the year. <br><br>  Kimi was adamant: "Can you get them back in place?" <br><br>  Soon, Max realized that his attacks attracted some attention.  Vern Pakson, a researcher at Lawrence Berkeley National Laboratory, noticed a network scan using the BRO system - Big Brother.  BRO was an experimental anti-hacking system with a single function.  He quietly worked on the network, sifted traffic in search of suspicious activity and, if found, informed the administrators that something was wrong. <br><br>  Paxon wrote a full attack report in CERT.  Max intercepted him and was amazed.  The researcher not only discovered the attack, but also made a list of servers attacked through the network of the University.  Lawrence - Max used it as a second starting point.  He sent an anonymous message to Pakson via the lab's root account: <br><br>  <i>Verne, I apologize for the inconvenience, but I alone correct the HUGE DEPTH SAFETY of many of your systems.</i>  <i>I admit that new holes have appeared, but they are all password-protected and would never have harmed anyone‚Äôs computer.</i> <i><br></i>  <i>If I had not done this, someone else would have done it and could have fouled.</i>  <i>For example, schoolchildren leaving warez, cutting down IRC BS and quietly erasing files through / bin / rm when they are in a bad mood.</i>  <i>Poverty.</i> <i><br></i>  <i>You may not appreciate what I did, but this is for great good.</i>  <i>I dropped all the hosts from the list you compiled.</i>  <i>I did not touch them, as I know that you transferred the list to CERT.</i>  <i>CERT should hire people with my skill level.</i>  <i>Of course, with a decent payment, I would never leave rootkits or something like that.</i> <i><br></i>  <i>Very clever, right?</i>  <i>Heh.</i>  <i>This is a bomb.</i>  <i>Owners of hundreds, even thousands of systems, and knowing that their systems have been fixed in between cases ... Hmm, I will not do this shit anymore.</i>  <i>Now you have all my tools.</i>  <i>It makes me mad ...</i> <i><br></i>  <i>Hm</i>  <i>Anyway, I do not want this to happen again.</i>  <i>I'm going to leave it at that.</i> <i><br></i>  <i>"Cracker"</i> <br><br>  So ended the five-day attack by Max on the government, with the number of hacked systems more than he could count.  He was pleased that he had made the Internet safer than before: thousands of computers that were previously vulnerable to any hacker are now vulnerable to only one - Max Vision. <br><br>  Max immediately dived into a new, more socially acceptable project: he wrote a Web application that would allow anyone on the Internet to scan their network for vulnerabilities to an attack on BIND.  He also conceived a better version of the siege than he had just completed.  As before, he scanned government and military networks.  But instead of breaking into vulnerable computers, he automatically sent an e-mail with a warning to administrators.  There was no need to hide on the hacked dial-up.  Both services now lived on the new site WhiteHats.com. <br><br>  After two days and nights of work, Max was knee-deep in his new legal hacking project, when Beeson wrote to him again.  "What happened?  I thought you would send me a letter. ‚Äù <br><br>  Max could hardly explain to his friend at the FBI that he was busy studying one of the largest computer gaps in history.  That is, he focused on his new project.  ‚ÄúI‚Äôve almost finished creating a public vulnerability scanner and a patch site, but there are still some points that need to be completed,‚Äù Max wrote in response. <br><br>  ‚ÄúAh, and here‚Äôs another <a href="http://virus.wikidot.com/adm">ADM worm,</a> ‚Äù he added, ‚ÄúI don‚Äôt think it will spread much‚Äù <br><br><hr><br><h4>  For in-depth study: </h4><br>  <a href="http://www.ouah.org/admworm.htm">A Brief Analysis of the ADM Internet Worm</a> <br>  Max Vision &lt;vision@whitehats.com&gt; <br><br>  <a href="">Net-Worm.Linux.Adm</a> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/301/70d/4e1/30170d4e18062aa5989236431628a19e.jpg" alt="image"><br>  Available for free <a href="http://www.williamspublishing.com/Books/5-8459-0785-3.html">on the publisher site</a> </div><p>Source: <a href="https://habr.com/ru/post/263813/">https://habr.com/ru/post/263813/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263803/index.html">Sock cyborg your trainer and friend</a></li>
<li><a href="../263805/index.html">InfoboxCloud Cloud Infrastructure Calculator</a></li>
<li><a href="../263807/index.html">Button "Return" and other trifles in the assembly Vivaldi 1.0.233.3</a></li>
<li><a href="../263809/index.html">Writing extensions for the game Balanced Annihilation based on the Spring Engine</a></li>
<li><a href="../263811/index.html">The formation of musical preferences in the neural network - an experiment to create a smart player</a></li>
<li><a href="../263817/index.html">Video reports from the conference IT NonStop Odessa 2015</a></li>
<li><a href="../263819/index.html">Translation of the book "Kingpin". Chapter 3. ‚ÄúThe Hungry Programmers‚Äù</a></li>
<li><a href="../263821/index.html">Django ORM. Add sugar</a></li>
<li><a href="../263823/index.html">Implementing a search engine with Python rankings (Part 1)</a></li>
<li><a href="../263825/index.html">RailsClub Moscow 2015, we start</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>