<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>OSSIM - we use integrated open source security management system</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is written under the impression of the article " OSSIM - Deploying a comprehensive open source security management system ." I will not r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>OSSIM - we use integrated open source security management system</h1><div class="post__text post__text-html js-mediator-article">  This article is written under the impression of the article " <a href="https://habrahabr.ru/post/255433/">OSSIM - Deploying a comprehensive open source security management system</a> ."  I will not repeat and describe the process of installing the system.  I just want to make some clarifications and explanations related to practical experience in the use of OSSIM. <br><a name="habracut"></a><br><h4>  What to put?  Iron or virtualka? </h4><br>  In any instructions you read that "uniquely on the virtual".  My answer: "definitely on iron."  Both answers are correct.  Why? <br><br>  The first answer is correct, since OSSIM is installed ‚Äúbundled‚Äù with the operating system and the image disk may not contain the drivers necessary for your hardware.  If you come across this, it will be your problem that you will have to solve yourself.  Installation on a virtual machine provides some versatility and no problems.  In addition, there is no guarantee that after an update, problems will not have to be solved anew.  There are official commercial "iron implementations" that are sold as an appliance and, accordingly, are supported, but we are looking at Open Source OSSIM and all the iron problems here are your problems. <br><br>  The second answer is correct, since any hypervisor is a brake.  Advocates of universal virtualization can trumpet as much as they want into pipes, beat into drums, swing flags, but hypervisors dramatically reduce the performance of the guest system.  As a rule, this can be neglected, but OSSIM likes speed.  As a result, a mini-computer with a 4-core atom, 16GB DDR3 and a 128GB SATA3 SSD self-assembled on a barebone takes the virtual machine to HP dl380 easily.  You will need to give the virtual machine far more resources than the physical needs.  And it will cost more.  As for the drivers, during installation you will be asked to insert a USB flash drive with drivers, if required. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Important.</b>  On the iron machine, the installer will start only from the boot CD.  If you upload an image to a flash drive, the OSSIM installation will not happen, but you can install Debian. <br><br>  <b>Very important.</b>  Never try to put OSSIM "second system" on a work computer.  The installer believes that he is put on a bare car and does not ask idiotic questions "how to partition the disc?".  First of all, it will rewrite the partition table without asking for it and format the disk. <br><br>  Installing OSSIM does not take ‚Äú15 minutes‚Äù at all.  Much longer.  At the last stage, it will even seem to you that the installer is frozen and everything is gone.  Wait.  He works. <br><br><h4>  The most important resources for OSSIM in descending order of importance </h4><br>  <b>The speed of the disk subsystem.</b>  Properly use SSD.  Volumes are not important.  100GB is enough.  But speed is very important.  There are two reasons for this.  First, the text logs that go to syslog and then read by OSSIM plugins.  Secondly, a database that runs on the same machine.  SSD dramatically improves system performance. <br><br>  <b>The number of processor cores.</b>  The performance of each core is not as important as the number of cores.  OSSIM performs very simple operations, but there are many of them at once and they can be executed in parallel.  This is also important for its Network IDS (Suricata), as you know, it is multi-threaded. <br><br>  <b>The amount of RAM.</b>  It is less critical, but it is better that nothing is pushed into the paging file. <br><br>  A suitable configuration for a virtual machine based on a daily flow of 2 million events in the logs and 10 terabytes of traffic on the ‚Äúillegible‚Äù interface: 8 cores, 16GB.  But it is butt.  Resources will be eaten to capacity. <br><br><img src="https://habrastorage.org/files/6c8/b29/9c9/6c8b299c9e3a4728b497e950ceffc88d.jpg" alt="image"><br><br>  And yes, of course, an illegible interface, to which you intend to throw traffic from the span port of your switch, collected for the analysis of meerkats from all the networks of your network, should be 10Gbs.  Otherwise he will simply choke. <br><br>  If you are going to manage the OSSIM server from a Windows machine, you will need putty and WinSCP.  Well, or FAR, if you love him.  It's more pleasant to drive from a Ubuntu machine.  At least it is not necessary to be checked every time whether it is not accidentally recorded in any script the end of the lines in the form of CRLF. <br><br>  After installation, you will not be able to connect to the server via SSH from a remote machine.  In Debian 8, the default configuration for sshd is `PermitRootLogin without-password`, which must be changed from` / etc / ssh / ssh_config` to `PermitRootLogin yes`. <br><br><h4>  Time zone </h4><br>  Another important thing is the correct configuration of the time zone of plug-ins.  The fact is that even when all the sources of the logs are in the same time zone, they are not necessarily using the same local time.  For example, System Center Configuration Manager considers that time is reasonable to store in a database in UTC.  And if you have a plugin that reads new events from its database (and I have), then you need to take into account that they are not recorded in local time. <br><br>  The time zone for plugins is set in two places: firstly, in `/ etc / ossim / agent / config.cfg`, the default time zone is set for all plugins, and secondly, it can be overridden in the config file of each individual plug-in.  Determining the time zone means the instruction for the plugin generator "to assume that data comes from such a time zone and convert the time into ours."  In this case, ‚Äúour‚Äù is the local server time.  In fact, the time will be recorded in the database in UTC, but there is a separate field in which the ‚Äúlocal system‚Äù offset will be recorded. <br><br>  Interesting things start when you have two of the same type in different time zones.  For example, you take logs of cisco-asa routers from different branches.  In this case, you will need to process them with different plugins, in the config files of which you specify a different parameter `tzone =`.  This parameter is specified in the `[default]` section.  I am writing about this because in the documentation you will not find it, I do not know why.  POSIX format: `tzone = Europe / Moscow`. <br><br><h4>  What is the best way to collect Windows logs? </h4><br>  My answer: AlienVault HIDS ‚Äúnative‚Äù means, OSSEC.  Of course I will briefly explain this. <br><br>  In theory, you can use any of the many agents to send a Windows event log to syslog or use WMI.  OSSIM has a WMI client and there is a standard plugin for reading Windows logs.  There is also a standard plugin for the SNARE agent, but if you are dealing with Russian Windows, then it will not be useful to you.  The thing is that SNARE sends data from Russian Windows in cp1251 encoding, and the standard parser for SNARE is written under cp1252.  We'll have to edit the regulars. <br><br>  But the most interesting thing will start when you collect logs from "multilingual" systems.  For example, you have Russian Windows on workstations, and English on servers.  And how to analyze it now?  In fact, this is a common problem for all SIEM.  They solve it in different ways.  For example, ArcSight uses a rather convoluted system of collecting Windows logs, which allows you to collect logs only in English, regardless of the localization of the system.  OSSEC uses a very simple technique.  When installing the agent on Windows, a csv file with a table of string messages of the Windows log in English is written into its working directory.  Therefore, the ‚Äúessential part‚Äù of a message that is needed for analysis always comes in the same language, regardless of the localization of the system.  But the "data" come "in the original language."  It is quite convenient. <br><br>  In addition, the standard plugin for the OSSEC agent is very well defined.  He carefully examines events by type.  If you use a different way to collect logs, you will have to sweat a great deal over the unfolding of events on the shelves.  Well, finally, OSSEC is not just ‚Äúsending logs‚Äù - this is really Host IDS and is not very bad.  Not for nothing TrendMicro decided to use this engine in its "advanced" antivirus.  And yes, OSSEC is reliable, as a control shot.  You can safely install the agent on any critical system. <br><br>  And further.  Rabbits are not only valuable fur, but also 3-4 kilograms of dietary meat.  OSSEC is not a log collector, it is SIEM itself.  In OSSIM, it does not transmit the Windows log at all, but its own alert.log, which is formed on the basis of preprocessing of events received from agents.  There will be, for example: events for changing monitored files, or such aggregated events as ‚Äúmultiple error‚Äù or ‚Äúmultiple change of the checksum of the key in the registry‚Äù.  It is more useful than just a collector.  OSSEC is very widely distributed over the Internet, it is very often used to protect web servers, so the community is large and active. <br><br>  Of course, you can play around with other ways of collecting Windows logs.  It is interesting. <br><br><h4>  Something about OSSEC Agent Configuration </h4><br>  On Windows machines, the agent is installed with some default configuration file.  This file is here: `/ usr / share / ossec-generator / installer / ossec.conf`.  OSSEC supports downloading configurations from the server.  The file `/ var / ossec / etc / shared / agent.conf` is used for this purpose.  By default it is absent.  This file can be created from the web interface of the OSSIM console (Environment - Detection - Agents - agent.conf).  Or just write in a text editor. <br><br>  There should be contained in the format of XML configuration directives that will be "merged" with the local agent configuration file.  Directive blocks for different agents can be labeled to apply only to the agents they need.  You can mark by OS type, agent name, profile name (in the local configuration of the agent, in this case, the name of his profile must be specified). <br><br> <code>&lt;agent_config name="agent001|agent002|agent018"&gt; <br>  <br> &lt;/agent_config&gt; <br> <br> &lt;agent_config os="Linux|FreeBSD"&gt; <br>  <br> &lt;/agent_config&gt; <br> <br> &lt;agent_config os="Windows"&gt; <br>  <br> &lt;/agent_config&gt; <br> <br> &lt;agent_config profile="web-server"&gt; <br>  <br> &lt;/agent_config&gt; <br></code> <br>  In this way, agent configurations can be changed centrally and pointwise.  The term "merged" requires clarification.  What happens if the local section of the configuration file is overridden?  The theory says that the local file is read first, then the server file, the rule read last overrides all previous ones.  In practice, I have never tried such an intersection of configuration parameters.  It just wasn't necessary.  Hope, when needed, will work as I think. <br><br>  Another important point.  The template for the local configuration of agents indicates the method of connecting to the server: <br><br> <code>&lt;server-ip&gt;172.17.2.10&lt;/server-ip&gt; <br> &lt;notify_time&gt;120&lt;/notify_time&gt; <br> &lt;time-reconnect&gt;240&lt;/time-reconnect&gt; <br> <br></code> <br>  As you can see here ip address.  I do not know why the authors preferred such a pattern.  You can specify the FQDN then this section should look different: <br><br> <code>&lt;server-hostname&gt;fqdn&lt;/server-hostname&gt; <br> ... <br> <br> <br></code> <br>  However, this is not done.  This means that when changing the server‚Äôs ip address, all agents will fall off.  Not a good idea.  Of course, SIEM is not a device where ip address is changed, but somehow unpleasant.  Of course, you can change this section in the template, but most likely, with the next update, the template will be generated anew.  It will be necessary to constantly monitor this.  I don‚Äôt care about this problem because I don‚Äôt have the habit of changing addresses. <br><br><h4>  Notes on installing agents on hosts </h4><br>  On the Windows agent, it is most convenient to install from the OSSIM web console, using the Automatic deployment button.  But you will need the local administrator's credentials of the target host (or domain).  Installation from group policies or using SCCM is very difficult.  The fact is that each installation file is individual for a particular host, because it contains a unique key for encrypting the exchange with the server.  Such is the secrecy at the PCI DSS level.  Pechalka. <br><br>  For Linux, agentless can work, but it requires setting up connections to hosts over SSH.  In my opinion, this is a bad idea.  I prefer to put agents.  In this case, a completely manual installation with compilation of the agent on the target machine from the raw.  Version 2.8.2 is officially supported, but version 2.8.3 also works without problems.  In fact, there are packages for different systems, for example, for Debian.  Read more <a href="http://ossec.github.io/downloads.html">here.</a> <br><br><h4>  Where to look for documentation and what is best to read </h4><br>  Click the support button in the web console menu and get links.  Required to read: <br><br>  <a href="https://www.alienvault.com/doc-repo/usm/security-intelligence/AlienVault-USM-Plugins-Management-Guide.pdf">USM 5.x Plugins Management Guide</a> <br>  <a href="https://www.alienvault.com/doc-repo/usm/security-intelligence/AlienVault_Correlation_Customization.pdf">Customizing Correlation Directives or Cross Correlation Rules</a> <br>  <a href="https://www.alienvault.com/doc-repo/usm/threat-detection/AlienVault_Intrusion_Detection.pdf">Intrusion Detection in AlienVault</a> <br>  <a href="https://www.alienvault.com/doc-repo/usm/policies-and-actions/AlienVault_Policy_Management.pdf">Policy Management Fundamentals</a> <br>  <a href="https://www.alienvault.com/doc-repo/usm/security-intelligence/AlienVault-Using-USM-and-OSSIM-5.1-with-OTX.pdf">Using USM and OSSIM 5.1 with OTX - AlienVault</a> <br>  <a href="https://www.alienvault.com/doc-repo/usm/asset-management/AlienVault_Assets_Groups_Networks.pdf">Assets, Groups &amp; Networks</a> <br>  <a href="https://www.alienvault.com/doc-repo/usm/system-maintenance/AlienVault_System_Errors__Warnings_and_Suggestions.pdf">System Errors, Warnings and Suggestions</a> <br><br><h4>  Why do I need a SIEM? </h4><br>  It seems everyone understands, but as it comes to the point, it turns out that people, for the most part, do not truly understand the purpose of SIEM.  First of all, it is not a means of protection.  And not even a "security management system", excuse me the title of the article, but not the first one I started.  In fact, it is a means of detecting successful security breaches.  The standard scheme of building protection begins with the identification of possible attacks (actual threats) and the methods of their commission.  Then technical and organizational protection measures are invented and implemented, which are placed on possible ‚Äúattack vectors‚Äù.  And after all this, ‚Äúcontrols‚Äù are set up, the purpose of which is to see that all your protective measures do not work.  SIEM belongs to this class. <br><br>  This is what you need to understand.  SIEM is designed to detect violations or circumvention of protective measures, both technical and organizational, that have already occurred.  This is something like a video surveillance system.  First of all, you must determine by what signs you will detect these violations, how SIEM will detect these signs, from where it will take the necessary information.  Do you have any "dead zones" that SIEM does not see.  Situations may be the most unexpected. <br><br><img src="https://habrastorage.org/files/714/0f3/b6e/7140f3b6e5824b7eb89cebcdd27e8c21.jpg" alt="image"><br><br>  OSSIM saves a suspicious package in pcap format for analysis.  Here he is: <br><br><img src="https://habrastorage.org/files/e1d/732/f65/e1d732f65da34c0e919fff5e0b6701e0.png"><br><br>  What was it? <br><br>  And so it was.  In one office, IT specialists tested some kind of thing that was spinning in the tomcat application server environment.  They installed this thing on the first server that came up, of course, leaving the login to the console with an empty password.  By tested and forgotten.  The first available server was Terminal Services.  And, as you know, tomcat worked under the system account.  An evil phishing hacker slipped a Trojan onto a computer of one of the employees and looked at what was useful on the network.  Found this forgotten web server and was delighted.  I poured a library on it to support console commands.  It is the moment of testing this library is shown in the picture.  The net user command was run, and suricata whistled when she saw the output of this command in http-responce.  While we figured out what kind of garbage, the evil hacker had already put a mimicacu there and started collecting user passwords, since they all go to the terminal server. <br><br>  The situation is very vital.  People always make mistakes.  Not only IT pros, but also hackers. <br><br>  Or here's a simpler story.  Here is the alarm page is very fresh. <br><br><img src="https://habrastorage.org/files/a27/e55/c0e/a27e55c0e406462a9a7a37ae46b89ba7.jpg"><br><br>  This is the so-called OTX Pulse.  Here are its details: <br><br><img src="https://habrastorage.org/files/2ba/dd3/c4b/2badd3c4b3b341a88b160534221c28b7.jpg"><br><br>  What was it? <br><br>  And this is the browser of one of the employees when he looked through one of the forum threads on the site bankir.ru, rushed to the url owqkq.ne1t3v8.top, and this is one of the parking pages that use the Angler Exploit Toolkit.  Also an interesting story. <br><br>  In order to avoid ‚Äúdead zones‚Äù, it is necessary first of all to place the HIDS agents (OSSEC) on ALL hosts on the network.  Then, set up the transfer to the "illegible" OSSIM interface of ALL traffic on your internal network so that it is processed by NIDS (Suricata).  Be sure to configure and run periodic vulnerability scans with the OpenVAS scanner of at least all DMZ nodes.  It is important.  Observations show that even a very small company passes 20-50 enemy scanners every day.  It will be better if you find a vulnerability earlier than they.  I do not exaggerate, only understate.  Here is a real fragment of the daily report: <br><br> <code>       2016:02:18 - 2016:02:19 <br> <br>   IP    <br> 2016-02-18 09:22:46 180.97.106.37 Nanjing Malicious Host <br> 2016-02-18 09:38:37 216.218.206.123 Fremont Malicious Host <br> 2016-02-18 09:52:57 85.25.214.226 Germany Scanning Host <br> 2016-02-18 10:08:11 146.185.250.105 Saint Petersburg Malicious Host <br> 2016-02-18 10:22:54 178.62.14.193 London Malicious Host <br> 2016-02-18 10:23:24 94.102.49.79 Netherlands Malicious Host <br> 2016-02-18 10:47:52 195.88.209.6 Moscow Malicious Host <br> 2016-02-18 10:53:29 222.186.34.177 Nanjing Malicious Host <br> 2016-02-18 11:07:48 71.6.135.131 San Diego Malicious Host <br> 2016-02-18 11:58:17 193.105.134.220 Sweden Malicious Host <br> 2016-02-18 11:58:51 62.210.206.219 France Malicious Host <br> 2016-02-18 12:28:13 193.109.69.150 Russia Malicious Host <br> 2016-02-18 12:43:40 216.218.206.96 Fremont Malicious Host <br> 2016-02-18 13:08:50 209.126.124.67 St Louis Malicious Host <br> 2016-02-18 13:53:19 178.33.17.241 France Malicious Host <br> 2016-02-18 14:23:52 198.20.70.114 Chicago Malicious Host <br> 2016-02-18 14:32:49 104.219.238.10 Rye Malicious Host Scanning Host <br> 2016-02-18 14:38:38 198.23.112.119 Dallas Scanning Host <br> 2016-02-18 15:02:58 198.20.69.98 Chicago Malicious Host <br> 2016-02-18 15:03:29 64.125.239.136 United States Malicious Host <br> 2016-02-18 15:28:35 162.248.74.2 Clarks Summit Malicious Host <br> 2016-02-18 15:43:36 222.174.5.28 Jinan Malicious Host <br> 2016-02-18 15:57:42 66.240.236.119 San Diego Malicious Host <br> 2016-02-18 16:13:09 74.82.47.45 Fremont Malicious Host <br> 2016-02-18 16:13:44 64.125.239.92 United States Malicious Host <br> 2016-02-18 17:07:57 142.54.162.74 Kansas City Malicious Host <br> 2016-02-18 17:22:41 64.125.239.107 United States Malicious Host <br> 2016-02-18 17:58:54 23.239.66.99 United States Malicious Host <br> 2016-02-18 18:07:50 61.216.2.14 Taiwan Malicious Host <br> 2016-02-18 18:08:03 198.20.69.74 Chicago Malicious Host <br> 2016-02-18 18:08:18 141.212.122.84 Ann Arbor Malicious Host <br> 2016-02-18 18:08:18 141.212.122.81 Ann Arbor Malicious Host <br> 2016-02-18 19:52:53 185.94.111.1 Russia Malicious Host <br> 2016-02-18 19:58:27 162.244.35.24 United States Malicious Host <br> 2016-02-18 20:23:00 162.244.35.22 United States Malicious Host <br> 2016-02-18 20:23:37 89.248.160.192 Netherlands Malicious Host <br> 2016-02-18 20:43:55 222.174.5.17 Jinan Malicious Host <br> 2016-02-18 21:23:55 185.130.5.201 Republic of Lithuania Malicious Host <br> 2016-02-18 21:47:39 92.60.184.34 Ukraine Scanning Host <br> 2016-02-18 22:33:48 209.126.102.181 St Louis Malicious Host <br> 2016-02-18 22:57:37 71.6.167.142 San Diego Malicious Host <br> 2016-02-18 23:13:37 212.83.148.78 France Malicious Host <br> 2016-02-19 00:07:54 185.130.5.240 Republic of Lithuania Scanning Host <br> 2016-02-19 00:48:22 64.125.239.224 United States Malicious Host <br> 2016-02-19 01:13:11 66.240.192.138 San Diego Malicious Host Scanning Host <br> 2016-02-19 02:33:05 198.204.234.74 Kansas City Scanning Host Malicious Host <br> 2016-02-19 02:57:03 104.243.223.8 Tampa Malicious Host <br> 2016-02-19 02:58:02 198.20.99.130 Netherlands Malicious Host <br> 2016-02-19 03:27:43 162.244.35.25 United States Malicious Host <br> 2016-02-19 03:28:13 89.163.251.200 Germany Malicious Host <br> 2016-02-19 04:28:25 71.6.165.200 San Diego Malicious Host <br> 2016-02-19 04:52:08 93.174.93.181 Netherlands Malicious Host <br> 2016-02-19 04:58:24 184.105.247.238 Fremont Malicious Host <br> 2016-02-19 05:23:07 192.162.101.79 Russia Malicious Host <br> 2016-02-19 05:23:20 64.125.239.112 United States Malicious Host <br> 2016-02-19 06:12:43 188.138.1.218 Germany Malicious Host Scanning Host <br> 2016-02-19 06:12:44 74.82.47.55 Fremont Malicious Host <br> 2016-02-19 06:43:55 209.239.123.106 St Louis Malicious Host <br> 2016-02-19 07:13:45 185.56.28.67 Netherlands Malicious Host <br> 2016-02-19 08:13:09 184.105.247.228 Fremont Malicious Host <br> 2016-02-19 08:28:51 184.105.139.72 Fremont Malicious Host <br></code> <br>  And this is only the part that belongs to the well-known community of villains, and there is another part of the report with a list of unknown villains.  Of course, most of them do not press hard.  For example: like this (this is a cut from the same report): <br><br> <code> Netflow  180.97.106.37 : Nanjing : Malicious Host <br>         <br> 2016-02-18 09:22:46.585 0.000 ICMP 91.111.111.9:0 180.97.106.37:3.0 1 56 1 <br> 2016-02-18 09:22:46.586 0.000 TCP 180.97.106.37:46024 91.111.111.9:3128 1 40 1 <br> 2016-02-18 20:32:23.247 0.000 TCP 180.97.106.37:37254 91.111.111.101:22 1 40 1 <br> 2016-02-18 20:43:38.783 0.000 TCP 180.97.106.37:45840 91.111.111.25:22 1 40 1 <br> 2016-02-18 20:43:38.783 0.000 ICMP 91.111.111.25:0 180.97.106.37:3.0 3 204 1 <br> 2016-02-18 22:07:25.502 0.000 TCP 180.97.106.37:54895 91.111.111.36:22 2 80 1 <br> 2016-02-18 22:41:06.739 0.000 TCP 91.111.111.13:22 180.97.106.37:48365 1 40 1 <br> 2016-02-18 23:16:01.974 0.996 TCP 180.97.106.37:13302 91.111.111.32:80 10 539 1 <br> 2016-02-18 23:16:01.975 0.679 TCP 91.111.111.32:80 180.97.106.37:13302 7 3048 1 <br> 2016-02-18 23:20:07.473 0.000 TCP 180.97.106.37:43667 91.111.111.9:22 2 80 1 <br> 2016-02-18 23:20:07.473 0.000 ICMP 91.111.111.9:0 180.97.106.37:3.0 1 56 1 <br> 2016-02-19 05:50:52.757 12.217 TCP 91.111.111.44:80 180.97.106.37:53461 5 260 1 <br></code> <br>  But there are also very intrusive personalities. <br><br>  You will also need firewall logs.  This is the minimum that is in any office.  And then there are already internal things: access logs to the DBMS and separate business applications, web server logs, etc.  etc.  You can collect anything.  If there is no standard log parsing plugin, it‚Äôs very easy to write your own.  True easy.  Developing your first plug-in won't take you more than a couple of days.  And the development of the second will take a couple of hours. <br><br>  As for the control of violation of organizational security measures, for example, in your office it is forbidden to make changes to the configuration of the production environment without coordinating the information security service.  OSSEC will tell you about any configuration changes and you can check whether it was agreed or not.  The most interesting thing begins when it turns out that no one has made this change. <br><br>  I will not give advice on which rules of control should be applied.  Each village has its own traditions.  If you have questions, ask. <br><br>  <b>Important.</b>  AlienVault OSSIM is not only SIEM in the classic sense.  This is a complete shelf that includes: Host IDS, Network IDS, Wireless IDS, Volnurability Scaner, NetFlow Collector.  That is, it is a complete classic set of "controls" for the organization of video surveillance over the company's network. <br><br><h4>  Trouble and Shooting </h4><br>  If it seems to you that something is wrong, you should start looking at the logs.  Where? <br><br>  OSSEC logs and errors: <br><br>  `/var/ossec/logs/ossec.log`- here you will see OSSEC errors.  The most common mistake is the loss of communication with the agent, it happens with some fatal communication failure on the network, or after reinstalling the agent.  Rare, but with a large number of agents may not be so rare.  If on the console you see that any agent is not active, and you know that the computer is turned on, it means you are here.  In the log, the error looks like `ERROR: Duplicated counter for agent-name '.  Eliminated simply.  On the web console (environment - detection - agents) or in the `/ var / ossec / etc / client.keys` file, look for an agent with this name and look at its number (the number in the leftmost column).  Then we climb into the directory `/ var / ossec / queue / rids` and delete the file with the name - agent number in it.  We go to SSH on the server console, exit to the command line and do `/etc/init.d/ossec restart`.  All things.  To be honest, I did not see any other errors with OSSEC. <br><br>  `/var/ossec/logs/alerts/alerts.log` is the log in which OSSEC adds chewed events from agents, it is from here that OSSIM reads events and processes them with a plugin for OSSEC.  Here you can see what falls there and how it looks. <br><br>  The rest of the logs in the traditional `/ var / log` of them are useful` / var / log / alienvault / agent / agent.log` and in the same place `agent_error.log`.  They can be useful when debugging your own plugins.  Note that on a production system, the size of `agent.log` is in gigabytes. <br><br>  I have never seen any serious errors in the work of OSSIM.  Once after the next update of the system, the regular backup stopped working.  It turned out they incorrectly assigned the rights to one of the files.  This is fixed literally the next day.  Information about such problems is held on the community forum.  One more time, after the next update, the following updates stopped working.  This time it was a warning that the update that was posted four hours ago contains a bug and that it needs to be fixed this way, but the corrected update was posted at such and such time.  By the way, if the update standard means (from the web or ssh console) falls and does not work, it can be done with the commands <br><br> <code>apt-get update <br> apt-get upgrade <br></code> <br>  from the server console. <br><br>  Perhaps this is all I wanted to say.  And most importantly.  This is open source.  Whatever you want, Python is with you.  And if you do not want it to be with you, look at the commercial version - Python with them.  And here we come to the last question. <br><br><h4>  Open Source or Enterprise? </h4><br>  My answer: if you need a SIEM for the needs of the company, then Enterprise.  You will never have enough human and technical resources to bring the Open Source version to the Enterprise level, of course, unless your company aims to develop its own SIEM.  But, if this is not your business, get yours.  Unfortunately, any Enterprise SIEM is very expensive.  But they are so expensive not because they have some unusual correlation server engines, but because they have enormous costs for creating libraries of correlation rules for events, analyzing the "signatures" of complex attacks and how to detect them, debugging these methods.  This is a job that you cannot do on your own.  I do not want to talk about the benefits of commercial products here, these advantages seem obvious to me and not worth discussing. <br><br>  So why do I spend time on this open source?  First, I like him.  Of all such open source projects, this is a good one.  Secondly, something like ‚Äúwe want to make security accessible to all‚Äù is written on the AlienVault website.  Not bad idea.  I support.  Many companies simply can not afford to buy a commercial product of this class.  I know that there is a whole army of system administrators, freelancers, let's call them so serving small companies.  It makes sense to look in this direction.  It‚Äôs not for nothing that I mentioned a mini-computer at the very beginning.  The little SIEM is the real thing. <br><br>  Enterprise - enterprise, and the community - community.  Land - to peasants, factories - to workers, money - to bank employees.  ‚ÄúHappiness to everyone, and to have enough for everyone‚Äù (A. and B. Strugatsky. ‚ÄúRoadside Picnic‚Äù). <br><br>  Used sources: <br><br>  <a href="https://www.alienvault.com/documentation">https://www.alienvault.com/documentation</a> <br>  <a href="https://alienvault.ru/open-threat-exchange/">https://alienvault.ru/open-threat-exchange/</a> <br>  <a href="http://ossec.github.io/docs/">http://ossec.github.io/docs/</a> <br>  <a href="http://suricata-ids.org/docs/">http://suricata-ids.org/docs/</a> </div><p>Source: <a href="https://habr.com/ru/post/278809/">https://habr.com/ru/post/278809/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278797/index.html">In Google Summer of Code 2016 with KolibriOS</a></li>
<li><a href="../278801/index.html">Custom configuration file in Rails</a></li>
<li><a href="../278803/index.html">I invite to the programming championship</a></li>
<li><a href="../278805/index.html">Charts and other usefulness for UWP applications</a></li>
<li><a href="../278807/index.html">Intel RealSense SDK Plug-in for Unreal Engine 4</a></li>
<li><a href="../278811/index.html">How to organize the transfer of financial data on the American stock exchange Nasdaq: ITCH and OUCH protocols</a></li>
<li><a href="../278813/index.html">Register for the webinar ‚ÄúUsing Panda SaaS Solutions to Protect and Manage Enterprise IT Assets‚Äù</a></li>
<li><a href="../278815/index.html">Android application architecture</a></li>
<li><a href="../278817/index.html">ReactiveCocoa. Concurrency. Multithreading</a></li>
<li><a href="../278819/index.html">Security in the hands of a smartphone: the first car without keys is on its way</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>