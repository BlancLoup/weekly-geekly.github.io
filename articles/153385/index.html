<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Painless migration from Gitosis to Gitolite</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gitosis is no longer supported, and the stable release of Debian Wheezy, on which it will no longer be, is not far off. Therefore, it was decided to m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Painless migration from Gitosis to Gitolite</h1><div class="post__text post__text-html js-mediator-article">  Gitosis is no longer supported, and the stable release of Debian Wheezy, on which it will no longer be, is not far off.  Therefore, it was decided to migrate to gitolite.  Despite the fact that there is a corresponding <a href="http://sitaramc.github.com/gitolite/gsmigr.html">manual</a> , it does not give an answer to the question - ‚ÄúHow to do it and not break anything?‚Äù.  This is now and will be discussed. <br><a name="habracut"></a><br>  The idea is this: to raise gitolite on the same user, check its operation and replace gitosis with gitolite with minimal downtime. <br><br>  Since the installation is conducted on a single user, conflicts are possible.  Therefore, it was found that with default configurations, conflicts are possible in the following places: in the folder where the repositories are located <i>~ / repositories</i> and in the file <i>~ / .ssh / authorized_keys</i> , which is automatically generated by these applications.  In the first case, it is possible to change the default path, but for the second case, the author of gitolite did not provide for such a possibility.  Although there is perl, it does not matter - break through.  A small commit <a href="https://github.com/f0y/gitolite/commit/25f7729dfd68bfa48d0b7188ea076618a7045bff">fixed the</a> situation.  Installation is advisable to make from source, because it gives more flexibility.  An alternative way is to rebuild the package, but then the advantage associated with simply updating the package is lost.  So the first option is preferable. <br><br>  I will not paint the full installation, as it has already been <a href="http://sitaramc.github.com/gitolite/install.html">done</a> for me, and I will describe only specific moments.  Before running <i>gitolite setup,</i> you need to change the <i>GL_REPO_BASE and SSH_AUTH_KEY</i> parameters in the <i>src / lib / Gitolite / Rc.pm</i> <i>file</i> .  For example, replace <i>authorized_keys</i> with <i>authorized_keys_gitolite</i> , and in <i>GL_REPO_BASE</i> we specify another folder.  Now you can safely continue the installation, since conflicts are excluded. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Gitolite and gitosis cannot simultaneously use one copy of ssh, therefore we will raise the second.  To do this, copy the config to <i>/ etc / ssh / sshd_config,</i> say in <i>/ etc / ssh / sshd_config_gitolite,</i> and change the latter. <br>  You should uncomment the <i>AuthorizedKeysFile</i> field in it and register the file that was specified earlier in the gitolite config (in our case, <i>authorized_keys_gitolite</i> ).  And also replace the <i>Port</i> parameter with another one, let it be <i>22222</i> . <br><br>  Now we run ssh in debug mode <i>sudo / usr / sbin / sshd -ddd -f / etc / ssh / sshd_config_gitolite</i> and check its operation.  To do this, we <i>clone the git clone</i> test repository <i>ssh: // git @ git-server: 22222 / testing</i> .  Next, go to the migration, which is described in the gitolite <a href="http://sitaramc.github.com/gitolite/gsmigr.html">manual</a> : add keys, migrate the config and test access rights. <br><br>  The last step is to switch from gitosis to gitolite.  To do this, we cut off the access to all to git (so that there are no new changes) by moving the <i>.ssh / authorized_keys</i> file to another location.  Then there are two ways: either copy the repositories from <i>~ / repositories</i> to <i>~ / repo</i> or make symlinks on them.  After moving the repositories run <i>gitolite setup</i> , as described in the manual.  The last <i>step is</i> to replace <i>SSH_AUTH_KEY</i> with the default value and rename the <i>authorized_keys_gitolite</i> file to <i>authorized_keys</i> .  Therefore, the migration was successfully completed. <br><br>  What is the result: the method is fairly painless, because the installation of gitolite is done independently and the configuration can be tested in advance.  The advantage of this method is that time downtime goes to zero. <br><br>  Successful migration! </div><p>Source: <a href="https://habr.com/ru/post/153385/">https://habr.com/ru/post/153385/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../153375/index.html">"Java-Oscar" has found its new owner</a></li>
<li><a href="../153377/index.html">Catalog of services for searching contacts of customers and performers on free-lance.ru</a></li>
<li><a href="../153379/index.html">Interview with astrophysicist Neil Tyson</a></li>
<li><a href="../153381/index.html">Finger Prostheses</a></li>
<li><a href="../153383/index.html">Through thorns to Haskell (translation). 2/2</a></li>
<li><a href="../153387/index.html">Connecting an ASP.NET MVC project to an ASP.NET WebForms project</a></li>
<li><a href="../153389/index.html">Everything you wanted to know about implantable tags, but were afraid to ask</a></li>
<li><a href="../153391/index.html">Getting Genuine Windows Subsystem (csrss.exe) Process</a></li>
<li><a href="../153395/index.html">Weather station on STM32L-DISCOVERY</a></li>
<li><a href="../153399/index.html">Lockitron: the world's smartest door lock</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>