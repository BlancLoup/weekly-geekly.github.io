<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>OOBD without OOP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Personally, I do not need to explain what OOP is. I myself first think of nouns and only the second - with verbs. 
 But it is not about how one thinks...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>OOBD without OOP</h1><div class="post__text post__text-html js-mediator-article">  Personally, I do not need to explain what OOP is.  I myself first think of nouns and only the second - with verbs. <br>  But it is not about how one thinks;  I want to discuss a situation where the abandonment of familiar OOP mechanisms simplifies work with objects. <br><br>  As an example, you can recall the good word Lotus Notes, where the name of the form was stored inside the document.  Creating the form LN, we thereby describe a new UI class in which you can add properties and override methods (Queryopen, Postsave, etc.).  At the same time, a new object created using this form is not associated with the inheritance mechanism.  A form is a property of an object, and in LN there is a ‚ÄúSwitchForm‚Äù command, with which you can open an object with a different form, naturally, with a call to other methods.  In this case, undefined properties will return an empty string. <br><a name="habracut"></a><br>  There is a certain terminological fog in the part of document-oriented and object-oriented databases.  It is considered that DOBD is NoSql, and class methods should be stored in OODD.  However, the same LN stored in the database the descriptions of forms and other design and at the same time was considered a DBMS, which shortly before his death, ported to relational DB2. <br><br>  I hope the fog will not increase, if I call the objects stored in OODB documents, and their properties - fields. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      An example of a form is easily implemented in OOP: <br><br>  We create a new class inherited from the base FORM class, override several properties and methods.  A new document is associated with a specific form if created by a user from the frontend.  If it is created programmatically, the FORM property may remain empty; in this case, the default form will be used when opening. <br><br>  Those.  we determine the visual behavior of the object not by adding methods to the class, but by storing in the object a link to the form in which these methods are described, more precisely, we store the name of the form class in the document. <br><br>  ORM experts may have comments.  I propose to temporarily forget about the ORM, and better forever. <br><br>  Go ahead.  The form is an important part of the UI, but the application has other classes that are not related to the form.  For example, the methods and properties used when creating a linked object. <br><br>  When designing the QMS, the ‚ÄúCorrective Impact‚Äù object can be created differently depending on the underlying object.  The basis of the incident can be both a marriage complaint and B. Obama's letter, and the methods for creating a new object should be different. <br><br>  Similarly, and vice versa: a bound object can act on a base object as it sees fit, as its class essence dictates. <br><br>  We implement in OOP: <br><br>  Create a LinkRule class and inherit classes from it to create related objects. <br>  We create the ResponseRule class and inherit classes from it to affect the base objects. <br>  When saving a document in the database, we can predetermine the future behavior of the object by filling in the fields with the appropriate links. <br><br>  Example: <br>  For clarity, let's call the field ‚ÄúLinkRule‚Äù, it will store the names of classes generated from the base class LinkRule. <br><br>  As a result, we have: <br><br>  1. If the document has a LinkRule field, it can serve as a basis for meaningful creation of other objects. <br>  Example: the document has the field {'LinkRule': 'Action'}, - the linked document will be created as ordered by the object of the class "Action" (Action inherited from the class LinkRule). <br>  2. Suppose a document has a field {'LinkRule': ['Action', 'Run']}.  In this case, the application can call two methods to initialize the associated object (composite creation - it sounds unusual), or it can ask the user what he wants. <br>  3. During the operation, the object can change the {'LinkRule': ['Action', 'Run']} field to {'LinkRule': ['Action', 'Stop']}, the class membership will change accordingly.  Sometimes people change gender.  For example, they sent an outgoing document from the Ministry of Finance to the Ministry of Finance, it got into the database of the Ministry of Education and became incoming.  The form remained old (the fields ‚ÄúSigned‚Äù, ‚ÄúVisas‚Äù, ‚ÄúArtist‚Äù, etc.) remained, and the habits should be changed.  The mail agent must replace the rules of the game for the object as specified in the class specified in the ‚ÄúMailRule‚Äù field of this object.  The mail agent also plays by the rules originating in the base class MailRule. <br><br>  There is a document with fields in it: <br><br><pre><code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">'UUID'</span></span> : <span class="hljs-string"><span class="hljs-string">'301D8348DEE65E9B3C5C5D3DF9864CF2'</span></span>, <span class="hljs-string"><span class="hljs-string">'Form'</span></span> : <span class="hljs-string"><span class="hljs-string">'Bullgrader'</span></span>, <span class="hljs-string"><span class="hljs-string">'LinkRule'</span></span> : [<span class="hljs-string"><span class="hljs-string">'Action'</span></span>, <span class="hljs-string"><span class="hljs-string">'Run'</span></span>], <span class="hljs-string"><span class="hljs-string">'ResponseRule'</span></span> : <span class="hljs-string"><span class="hljs-string">'Eight8'</span></span>, <span class="hljs-string"><span class="hljs-string">'MailRule'</span></span> : <span class="hljs-string"><span class="hljs-string">'Mailware'</span></span>, ‚Ä¶,    , ‚Ä¶ }</code> </pre> <br><br>  And there is an application where all the necessary classes are described. <br>  The application knows what to do with these fields: you need to create an object of the corresponding class, pass the document to it and call the required method. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doc.getField(<span class="hljs-string"><span class="hljs-string">"Form"</span></span>) == <span class="hljs-string"><span class="hljs-string">"Bullgrader"</span></span> ) uiDoc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bullgrader(doc); <span class="hljs-comment"><span class="hljs-comment">//     ‚Ä¶ uiDoc.queryOpen(); ‚Ä¶</span></span></code> </pre><br><br>  Everything is clear, except for one: has the database become object-oriented? <br><br>  On the one hand, yes.  Objects are stored within themselves belonging to a particular class and are associated with specific methods.  On the other hand, what kind of OODB is this, such things can be done in a normalized RDBMS, and conceptual analysts in general will call the use of such mechanisms in ORM general-schizophrenia. <br><br>  In addition, in OODB methods themselves must be stored in the database, but here it is not. <br><br>  The proposed mechanism is rather clumsy, using interpreted languages, it can be made more flexible and convenient by discarding classes and transferring scripts to the database. <br><br>  Experience has shown that document-related classes, with the exception of the FORM class, are very simple, they usually consist of one constructor and several properties. <br><br>  Replace the word CLASS with the RULE.  In the database we create reference books of all the rules: <br>  LinkRules - a set of rules for creating linked objects; <br>  ResponseRule - a set of rules that describe the effects on base objects; <br>  Forms - list of form descriptions; <br>  etc. <br><br>  Rules are a collection of scripts and constants, but they cannot be considered methods of the document.  The application does not execute the script as an object method, but as a function.  In this case, the object itself is passed as a parameter or stored in a variable with a specific name. <br>  The rules (as a rule) are small scripts, personally, I prefer to store them in the database, but it is believed that everything should be stored as files.  It is possible and so and so. <br><br>  Most rules are documents with the following set of fields: <br><br><pre> <code class="javascript hljs">{ ‚Ä¶, <span class="hljs-string"><span class="hljs-string">'Form'</span></span> : <span class="hljs-string"><span class="hljs-string">'LinkRule'</span></span>, <span class="hljs-string"><span class="hljs-string">'Name'</span></span> : <span class="hljs-string"><span class="hljs-string">'Action'</span></span>, <span class="hljs-string"><span class="hljs-string">'File'</span></span> : <span class="hljs-string"><span class="hljs-string">'linkrule_action.py'</span></span>, <span class="hljs-string"><span class="hljs-string">'Rule'</span></span> : <span class="hljs-string"><span class="hljs-string">"linkedDoc.sendDa = today()\nlinkedDoc.title = ''"</span></span> }</code> </pre><br><br>  Rules, however, like other directories, it makes sense to load at server start and store in memory.  This greatly speeds up the work of the programmer and speeds up the application a little (well, they will all take 10 MB or 100 on the server, I don‚Äôt feel sorry). <br><br>  In order to create a rule, you need to fill out a form of 4 fields.  This means you need to develop a form 'LinkRule', make a filter for selecting rules, write a script to load them when the server starts. <br><br>  The Python example demonstrates the initialization of a linked document (linkedDoc) according to the rule specified in the base document (doc).  The getRule function returns the necessary rule as text, danger (lr) checks it for maliciousness, exec performs initialization. <br><br><pre> <code class="python hljs"> lr = getRule( <span class="hljs-string"><span class="hljs-string">'linkRules'</span></span>, doc.linkRule ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> lr <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> danger( lr ): <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: exec( lr, globals(), { <span class="hljs-string"><span class="hljs-string">'doc'</span></span> : doc, <span class="hljs-string"><span class="hljs-string">'linkedDoc'</span></span> : linkedDoc } ) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: snd (<span class="hljs-string"><span class="hljs-string">'setLinkedFields: %s\n%s'</span></span> % (lr, ex)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre><br><br>  Since the forms for most rules differ only in name, you can make one form description for several rules: <br><br><pre> <code class="javascript hljs">{ ‚Ä¶, <span class="hljs-string"><span class="hljs-string">'Form'</span></span> : <span class="hljs-string"><span class="hljs-string">'Form'</span></span>, <span class="hljs-string"><span class="hljs-string">'Name'</span></span> : [<span class="hljs-string"><span class="hljs-string">'LinkRule'</span></span>, <span class="hljs-string"><span class="hljs-string">'MailRule'</span></span>, <span class="hljs-string"><span class="hljs-string">'ResponseRule'</span></span>], ‚Ä¶ }</code> </pre><br><br>  Filters can also be saved by making a categorical representation of the rules. <br><br>  In one of the projects, more than 200 rules of 11 types were stored in the database.  This is a lot and it means that the center of gravity of the system is slipping towards the description of the rules, i.e.  in the settings area.  Flexibility increases, and most importantly, this architecture allows you to execute the vagaries of the customer, without touching the source codes of the instrumental part of the system.  At the same time, changing and debugging the rules does not even require rebooting the server; it‚Äôs enough to reload directories. <br><br>  The rules can describe not only the behavior of objects, but also the composition of tables, statements, buttons on the screen and much more.  And all this is almost without OOP: to work with the rules, objects of only one Document class should be stored in the database. <br><br>  All of the above is not a theory.  For those who want to see and touch, I posted a simple free crm-sova from DOBD to SQLite.  The owl is written to comfort his beloved wife after she bought a very uncomfortable CRM and was upset.  This is not an advertisement, I do not give a link, but it is easy to find.  Immediately I warn you: from IE does not work, this is a property of the framework. <br><br>  - Dear, but on SQLite it is impossible to make DOBD. <br>  - Why do you think so? <br>  - Ask anyone, I asked anyone, - he said that it is impossible. <br>  - And the arguments? <br>  - Wikipedia says so. <br>  - Yes.  It's hard to argue with that. <br>  - Goodbye. <br>  - Good luck. </div><p>Source: <a href="https://habr.com/ru/post/235725/">https://habr.com/ru/post/235725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235715/index.html">Sony's latest news at IFA 2014</a></li>
<li><a href="../235717/index.html">How we fought the brakes in AndEngine</a></li>
<li><a href="../235719/index.html">Battle Arsenal of Erlang Developer</a></li>
<li><a href="../235721/index.html">Biological sensory surfaces as a new step in the evolution of gadgets</a></li>
<li><a href="../235723/index.html">Creating plug-ins for AutoCAD using the .NET API (part 1 - first steps)</a></li>
<li><a href="../235727/index.html">Uploading sketches to Arduino via Bluetooth</a></li>
<li><a href="../235729/index.html">Realistic gravity lensing on Unity</a></li>
<li><a href="../235731/index.html">Ideal development environment for PIC - personal experience</a></li>
<li><a href="../235735/index.html">3D mode in Diablo 2</a></li>
<li><a href="../235739/index.html">Recycling Gadgets</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>