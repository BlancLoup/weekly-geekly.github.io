<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The guy accidentally stopped the global spread of cryptographer WannaCrypt</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="These days everyone is talking about the WannaCry / Wcry / WannaCrypt cryptogenerator , which hit tens of thousands of computers all over the world on...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The guy accidentally stopped the global spread of cryptographer WannaCrypt</h1><div class="post__text post__text-html js-mediator-article">  These days everyone is talking about the <a href="https://geektimes.ru/post/289115/">WannaCry / Wcry / WannaCrypt cryptogenerator</a> , which hit tens of thousands of computers all over the world on Friday, but then its distribution suddenly stopped. <br><br>  Microsoft promptly released patches to fix the vulnerability (a patch can tear down pirated Windows): <br><br><ul><li>  <a href="https://technet.microsoft.com/en-us/library/security/ms17-010.aspx">Microsoft Security Bulletin MS17-010</a> </li><li>  <a href="https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/">Patch, for older systems</a> (Windows XP, Winows Server 2003R2) </li></ul><br>  The vulnerability can also be closed in Windows 8.1 and higher versions by completely disabling SMBv1 support: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs pgsql">dism /online /norestart /<span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-feature /featurename:SMB1Protocol</code> </pre> <br>  According to the latest information, the cryptographer managed to hit more than 75,000 Windows computers in at least 99 countries around the world.  But the scale of the spread of WannaCrypt could have been an order of magnitude greater if it were not for the actions of one security specialist, the author of the blog <a href="https://www.malwaretech.com/">MalwareTech Blog</a> .  He <a href="https://www.malwaretech.com/2017/05/how-to-accidentally-stop-a-global-cyber-attacks.html">tells</a> how everything was. <br><a name="habracut"></a><br>  This hero is a 22-year-old hacker and blogger from the UK, whose name has not yet become public.  He writes that on Friday he had a day off.  He woke up around 10:00 and logged into the national cyber threat tracking system to watch the spread of banking malware Emotet, the most significant event of recent days.  I did not notice anything unusual and went to breakfast.  When I returned home around 2:30 pm, I found a bunch of reports about the infection of various hospitals and medical systems with cryptographer.  Such infections <a href="https://geektimes.ru/post/273326/">occurred before</a> , but here, as if the scale was larger than before. <br><br>  With the help of his friend, a hacker under the nickname Kafeine, the guy quickly took out a sample of the malware, launched it in a virtual machine and saw that it was sending requests to an unregistered domain.  It was interesting. <br><br>  Cisco Umbrella statistics showed that requests to this domain began on Friday at 8:00 am and grew like an avalanche. <br><br><img src="https://habrastorage.org/web/9cf/e03/5eb/9cfe035eb11e43bfabdce849d39dc9de.png"><br><br>  The blogger registered the domain on himself for 8 pounds ($ 10.69).  This is standard practice, he says.  Botnets often generate domain names for command servers (C2C) each according to their own algorithm.  The algorithm is known to intruders, so they can register this domain in advance.  Sometimes, researchers and antivirus companies manage to get ahead of them, and then they have the opportunity from the inside to study the work of the botnet command center, collect data on the geographical distribution of bots, and reverse engineer the software.  So registration of these domains is a normal thing.  The author of the blog MalwareTech Blog says that over the past year he has registered several thousand domains. <br><br>  While after registration records were updated in the DNS systems, the guy studied the behavior of the malware in the virtual machine.  It turned out that after encrypting files, he starts scanning random IP addresses on port 445 (using SMB).  Already this suggested that WannaCrypt could somehow be connected with the NSA exploit for SMB, which just a month ago <a href="https://geektimes.ru/post/287880/">appeared in the public domain due to hacking of NSA servers by the hacker group ShadowBrokers</a> . <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); width: 500px; margin: 10px auto; max-width: 100%; min-width: 220px;" data-tweet-id="863054290360946688"></twitter-widget><blockquote class="twitter-tweet" align="center" data-twitter-extracted-i155229639689578436="true"><p lang="en" dir="ltr">  Sample I found scans SMB after dropping WannaCrypt.  Can anyone confirm it's the same thing?  P2P spreading ransomware would be significant.  <a href="https://t.co/zs5Td4ovvL">pic.twitter.com/zs5Td4ovvL</a> </p>  - MalwareTech (@MalwareTechBlog) <a href="https://twitter.com/MalwareTechBlog/status/863054290360946688">May 12, 2017</a> </blockquote><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  Since all infected people knocked on this domain, after gaining control over it, the researcher was able to compile a list of IP addresses and <a href="https://intel.malwaretech.com/WannaCrypt.html">an infection map</a> using log files. <br><br>  Yesterday at about 18:23 BST, a hacker asked an employee to study the malware code for generating new domain names ‚Äî it was necessary to check that the domain for communication would not change.  Five minutes later, the employee appeared in a panicked state.  He said that domain registration is related to file encryption - that is, the guys are responsible for encrypting files on all computers (it later turned out that this was not the case).  They quickly got in touch with the hacker Kafeine, and he showed a <a href="https%253A%252F%252Fwww.malwaretech.com%252F2017%252F05%252Fhow-to-accidentally-stop-a-global-cyber-attacks.html">fresh tweet</a> from ProofPoint‚Äôs company Diren Huss (Darien Huss), who analyzed the malware code more thoroughly after reverse engineering.  It turned out that the opposite is true - it was the registration of the domain that stopped the further spread of the cryptographer. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/60f/3a5/eb5/60f3a5eb5d4f8747b33ffb4bff56f8c9.jpg"><br><br>  As can be seen in the screenshot of the code, the malware performs an HTTP request to an unregistered domain.  <b>If the request is successful, then it stops working</b> .  If the request fails, the program code is executed and file encryption begins. <br><br>  Tweet posted May 12 at 8:29 pm. <br><br>  Armed with this information, the guy again uploaded his virtual environment, launched the malware - and nothing happened, he no longer worked. <br><br>  The first thought was that the request to this domain was used as a kind of ‚Äúemergency stop-crane‚Äù, which should work if something went wrong.  But it is more likely that the authors of the malware simply incorrectly implemented protection against the analysis of their program (protection against the virtual environment).  Probably, when running in a virtual environment, a request to such a domain should have given a positive answer - emulators are trying to convince the malware that the virtual environment is normal and everything works as it should.  Therefore, they intercept all such requests and return the IP address of the sandbox.  A similar technique to protect against virtual environment uses the Necurs Trojan. <br><br>  Accordingly, if the request to the domain returns a successful response, the malware thinks that it is in the sandbox and crashes. <br><br>  It was so completely by chance that one researcher managed to stop the spread of a global viral infection, which is now spoken of in all the news. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-1" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); width: 500px; margin: 10px auto; max-width: 100%; min-width: 220px;" data-tweet-id="863187378705510400"></twitter-widget><blockquote class="twitter-tweet" align="center" data-twitter-extracted-i155229639689578436="true"><p lang="en" dir="ltr">  So I can only add to my R√©sum√©.  ^^ </p>  - MalwareTech (@MalwareTechBlog) <a href="https://twitter.com/MalwareTechBlog/status/863187378705510400">May 13, 2017</a> </blockquote><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  But you should not relax.  This time, people were just lucky that the attacker made a mistake with one function in the code, but the next time there will be no error - and the ‚Äúcyberacalypse‚Äù may turn out to be real.  We assume that it was a test check.  New versions for sure will appear in the coming days. <br><br>  <b>UPD.</b>  <a href="https://geektimes.ru/post/289153/">Discovered the second and third variants of WannaCry, including those without a stop-tap</a> </div><p>Source: <a href="https://habr.com/ru/post/357342/">https://habr.com/ru/post/357342/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357332/index.html">Ministry of Communications proposes not to release Russian traffic outside the country in order to avoid wiretapping</a></li>
<li><a href="../357334/index.html">New Information Society Development Strategy</a></li>
<li><a href="../357336/index.html">Macron's headquarters used hanipotes with fake documents to feed hackers</a></li>
<li><a href="../357338/index.html">Security Week 16: Twitter passwords, misery</a></li>
<li><a href="../357340/index.html">Discovered the second and third variants of WannaCry, including those without a stop-tap</a></li>
<li><a href="../357344/index.html">Kaspersky Lab: WannaCry malware was actively spreading through the network due to a vulnerability in Windows 7</a></li>
<li><a href="../357346/index.html">Tsarka Kazakhstan team won at Positive Hack Days 2017 international forum on practical security</a></li>
<li><a href="../357348/index.html">Close-up of the notorious group of hackers APT32 in action</a></li>
<li><a href="../357350/index.html">Block surveillance by Windows 10 is very difficult, says a security specialist</a></li>
<li><a href="../357352/index.html">How Sberbank Online Merges User Data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>