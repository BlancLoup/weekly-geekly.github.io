<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zxcvbn program: realistic password strength assessment</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For the past few months, password strength analyzers have come across to me in almost every online registration form. In this area today there is a pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zxcvbn program: realistic password strength assessment</h1><div class="post__text post__text-html js-mediator-article">  For the past few months, password strength analyzers have come across to me in almost every online registration form.  In this area today there is a particularly rapid growth. <br><img title="meter_screenshot" src="https://habrastorage.org/getpro/habr/post_images/dd4/23b/923/dd423b92382bf10309b2484a9b08f94c.png" height="59" width="300"><br>  The only question is, does such a program really help protect a user account?  This aspect of Internet security is of course not as important as some others, for example: <br><ul><li>  Prevent hacking of web pages due to increasing delay or using CAPTCHA; </li><li>  prevention of offline hacking by using a fairly slow hash function with a ‚Äúsalt‚Äù individualized at the user level; </li><li>  password hashes protection. </li></ul><br><a name="habracut"></a><br>  If we take into account the above factors, then yes, I am sure that programs testing password security are really <em>very promising and can help the user</em> .  In his book, published in 2006, entitled <a href="http://www.amazon.com/Perfect-Password-Selection-Protection-Authentication/dp/1597490415">‚ÄúPerfect Passwords: Choice, Protection, Authentication‚Äù (Perfect Passwords: Selection, Protection, Authentication)</a> , Mark Burnett (Mark Burnett), calculated the frequency of several million passwords used as a result of various leaks data.  He writes that every ninth user chose a password from this <a href="">list of the most popular</a> .  Among them are such "tough nuts" as: password1, compaq, 7777777, merlin and rosebud.  Last year, Burnett conducted a <a href="http://xato.net/passwords/more-top-worst-passwords">new study</a> , examining 6 million passwords, and this time it turned out that 99.8% of them are on the list of 10,000 most popular, and 91% are on the list of 1000 most common.  Of course, the result was largely influenced by the <a href="http://xato.net/passwords/how-i-collect-passwords">research methodology and sample offset</a> - for example, since most of these passwords were obtained from already cracked hashes, the entire list was initially shifted to easily cracked passwords. <br><br>  Only easily guessed passwords are listed here, but I bet that a large percentage of the rest are still quite predictable and can be cracked as a result of a small network attack.  Therefore, I believe that thanks to direct interaction with users, such analyzers can really help in choosing a more reliable password.  However, at the moment they, for the most part, only harm (not counting several programs with closed code).  That is why it happens. <br>  Password strength is best measured by the amount of entropy expressed in bits.  Entropy is calculated as the number of options for dividing into two possible passwords.  Here is the simplest password strength estimation algorithm: <br><br><pre><code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># n:   # c:  :    # (26  ,     , 62 ‚Äî  ,      ,   )  = n * lg(c) #    2</span></span></code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Such an analysis by the method of direct selection is applicable to passwords consisting of random sequences of letters, numbers and symbols.  However, in most cases, and only with rare exceptions (for which special thanks to <a href="https://agilebits.com/onepassword">1Password</a> / <a href="http://keepass.info/">KeePass</a> ), people choose ordered combinations of characters as a password ‚Äî vocabulary words, simple keyboard sequences, for example qwerty, asdf and zxcvbn, repetitions (aaaaaaa), sequences (for example , abcdef or 654321), as well as combinations of the above elements.  If the password contains upper case letters, then the first letter of the password is likely to be that letter.  The use of numbers and special characters is also often predictable, in particular through the use of l33t network jargon (number 3 replaces the letter e, 0 - o, @ or 4 - a), year, date, zip code, etc. <br><br>  As a result, simplified methods for analyzing the reliability of a password prove to be unreliable.  Without testing the use of common combinations, the recommendation to use numbers and symbols in the password will slightly complicate hacking, but it will significantly complicate memorization.  One of the comics on xkcd describes this situation perfectly: <br> <a href="https://xkcd.com/936/"><img title="Xkcd in translation" src="http://blog.perevedem.ru/wp-content/uploads/2012/05/komiks.bmp" alt=""></a>  &gt; <br><br>  That's why I decided as an independent project for another <a href="http://techcrunch.com/2012/03/26/a-peek-inside-dropboxs-company-wide-hack-week-at-its-big-new-sf-offices/">‚ÄúCracker Week‚Äù</a> conducted by Dropbox to create an open source password strength analyzer that would eliminate simple combinations and, accordingly, would not prohibit quite complex phrase passwords such as correcthorsebatterystaple (right horse battery).  Now this utility is available on <a href="https://www.dropbox.com/register">dropbox.com/register</a> and <a href="https://github.com/lowe/zxcvbn">is available for use</a> on github.  You can experiment yourself with the <a href="http://dl.dropbox.com/u/209/zxcvbn/test/index.html">demo version</a> and evaluate several passwords. <br><br>  The table below compares zxcvbn with other password strength analyzers.  The point of comparison is not to prove the failure of other applications ‚Äî indeed, each site has its own password policy ‚Äî but to give you a better idea of ‚Äã‚Äãthe features of zxcvbn. <br><br><table><tbody><tr><th></th><th> <code>qwER43@!</code> </th> <th> <code>Tr0ub4dour&amp;3</code> </th> <th> <code>correcthorsebatterystaple</code> </th> </tr><tr><th>  zxcvbn </th><td><img src="https://habrastorage.org/storage2/524/212/4f3/5242124f389a24a48997191e0b2327ee.png"></td><td><img src="https://habrastorage.org/storage2/37a/b48/f2b/37ab48f2b77a4f5c9b356f7429150597.png"></td><td><img src="https://habrastorage.org/storage2/48d/1e1/095/48d1e10959cb265eff85c015429b50e4.png"></td></tr><tr><th>  Dropbox (old) </th><td><img src="https://habrastorage.org/storage2/48d/1e1/095/48d1e10959cb265eff85c015429b50e4.png"></td><td><img src="https://habrastorage.org/storage2/48d/1e1/095/48d1e10959cb265eff85c015429b50e4.png"></td><td><img src="https://habrastorage.org/storage2/37a/b48/f2b/37ab48f2b77a4f5c9b356f7429150597.png"></td></tr><tr><th>  Citibank </th><td><img src="https://habrastorage.org/storage2/a79/948/c2c/a79948c2c4d8963cfd1f9f619aa72de5.jpg"></td><td><img src="https://habrastorage.org/storage2/64c/0f8/866/64c0f886669c6d4a3d716c5276f6f551.jpg"></td><td><img src="https://habrastorage.org/storage2/622/127/0c2/6221270c2fa1b85a88e5e552dcf5f34b.jpg"></td></tr><tr><th>  Bank of America </th><td>  Invalid </td><td>  Invalid </td><td>  Invalid </td></tr><tr><th>  Twitter </th><td><img src="https://habrastorage.org/storage2/91b/eb1/3f9/91beb13f92ac5e9d6c362b51ae8cf591.jpg"></td><td><img src="https://habrastorage.org/storage2/91b/eb1/3f9/91beb13f92ac5e9d6c362b51ae8cf591.jpg"></td><td><img src="https://habrastorage.org/storage2/91b/eb1/3f9/91beb13f92ac5e9d6c362b51ae8cf591.jpg"></td></tr><tr><th>  Paypal </th><td><img src="https://habrastorage.org/storage2/0dd/e6f/235/0dde6f2353dd66843645714a4fc024b0.jpg"></td><td><img src="https://habrastorage.org/storage2/ef4/8fd/25e/ef48fd25e9c0cdd92f679eba46e23676.jpg"></td><td><img src="https://habrastorage.org/storage2/0dd/e6f/235/0dde6f2353dd66843645714a4fc024b0.jpg"></td></tr><tr><th>  ebay </th><td><img src="https://habrastorage.org/storage2/a3f/4b6/997/a3f4b699726424a9b06eff17571669f2.jpg"></td><td><img src="https://habrastorage.org/storage2/a3f/4b6/997/a3f4b699726424a9b06eff17571669f2.jpg"></td><td>  Invalid </td></tr><tr><th>  Facebook </th><td><img src="https://habrastorage.org/storage2/36e/d0e/95d/36ed0e95df677b2ff7b0ae004736b579.jpg"></td><td><img src="https://habrastorage.org/storage2/36e/d0e/95d/36ed0e95df677b2ff7b0ae004736b579.jpg"></td><td><img src="https://habrastorage.org/storage2/999/969/177/9999691774e61f262f911b8e6a68c5e5.jpg"></td></tr><tr><th>  Yahoo! </th><td><img src="https://habrastorage.org/storage2/3ce/a5d/691/3cea5d691b945e01c9450613f0357e42.jpg"></td><td><img src="https://habrastorage.org/storage2/3ce/a5d/691/3cea5d691b945e01c9450613f0357e42.jpg"></td><td><img src="https://habrastorage.org/storage2/f55/125/d74/f55125d74080e7b9a59647f70e0abf20.jpg"></td></tr><tr><th>  Gmail </th><td><img src="https://habrastorage.org/storage2/d50/102/b5f/d50102b5fb8d1d55610bbd3f8c748d2a.jpg"></td><td><img src="https://habrastorage.org/storage2/d50/102/b5f/d50102b5fb8d1d55610bbd3f8c748d2a.jpg"></td><td><img src="https://habrastorage.org/storage2/34d/683/688/34d6836880f4bd7a75e3ce0e7d443140.jpg"></td></tr></tbody></table><br>  A few notes: <br><br><ul><li>  I made these screenshots on April 3, 2012. </li><li>  Zxcvbn considers correcthorsebatterystaple to be the most secure password out of three.  The remaining applications either consider it the most inefficient, or do not allow it at all.  (Twitter assigned the same degree of reliability to the three passwords, but if you look closely, you will notice a slight difference.) </li><li>  Zxcvbn considers qwER43 @!  inefficient password because it is an encrypted QWERTY keyboard sequence.  For each change of direction and shift of the symbol, he increases her entropy. </li><li>  Password Analyzer PayPal counted qwER43 @!  ineffective password, but aaAA11 !!!  - reliable.  It can be assumed that he recognizes keyboard sequences. </li><li>  The Bank of America registration form does not allow the use of passwords longer than 20 characters, including correcthorsebatterystaple.  According to their rules, some special characters can be used in passwords, but ‚Äú&amp;‚Äù and ‚Äú!‚Äù Are not allowed, respectively, the use of the two remaining passwords is prohibited.  eBay also does not allow passwords longer than 20 characters. </li><li>  It seems that with rare exceptions, the tested programs are not guided by the same primitive criteria as I, otherwise correcthorsebatterystaple would receive the highest rating due to its length.  The previous version of Dropbox Password Analyzer added password points for each lower case letter, capital letter, number and special character used up to a certain limit for each of these groups of characters.  This approach only protects against brute-force attacks, although this system has the option of checking a new password against the dictionary of the most commonly used words.  I don‚Äôt know the principles of the rest of the tested programs, but it is known that developers often use such <a href="http://www.passwordmeter.com/">tables of reliability criteria</a> (which, however, check the password using a small set of combinations). </li><li>  For the base word of the password in the second column I took Troubadour, not Troubador, as in xkcd (the last spelling is rare). </li></ul><br><br><h4>  Installation </h4><br>  The zxcvbn system is not limited to the type of browser and works with Internet Explorer (since version 7) / Opera / FireFox / Safari / Google Chrome.  The easiest way to add it to your registration page is the following: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"zxcvbn-async.js"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  The size of the zxcvbn-async.js script is only 350 bytes.  After executing window.load, when the page loads and displays, the download of zxcvbn.js will begin - a ‚Äúheavy‚Äù file of 680 KB (or 320 KB in gzip), most of which is in the dictionary.  I have never seen that the size of the script created any problems: since before choosing a password the user usually enters other data on the registration form, there is plenty of time to load the script.  Here is a <a href="http://friendlybit.com/js/lazy-loading-asyncronous-javascript/">complete description of the</a> asynchronous script download in different browsers. <br>  Zxcvbn adds one function to the global namespace: <br><br><pre> <code class="coffeescript hljs">zxcvbn(password, user_inputs)</code> </pre><br><br>  It takes one required argument (password) and returns a result object with the following properties: <br><br><pre> <code class="coffeescript hljs">result.entropy <span class="hljs-comment"><span class="hljs-comment">#  result.crack_time #     (.) result.crack_time_display #    ,    : # ¬´¬ª, ¬´6 ¬ª, ¬´¬ª  . . result.score #  ,  0, 1, 2, 3  4, #     10**2, 10**4, 10**6, # 10**8  , . # (        ) result.match_sequence #   ,   #   result.calculation_time #    ();    </span></span></code> </pre><br><br>  The optional user_inputs argument is an array of strings that zxcvbn will add to its built-in dictionary.  Theoretically, it can include any lines, but it is assumed that this will be data entered by the user in other fields of the form (for example, name or email address).  Thus, the reliability of the password containing the user's personal data can be rated very low.  This list is also convenient for taking into account a special dictionary of a specific site (for example, in my program the specific dictionary of the Dropbox site is taken into account). <br><br>  The zxcvbn program is written in CoffeeScript.  The zxcvbn.js and zxcvbn-async.js files are <a href="https://developers.google.com/closure/compiler/">processed by a closure converter</a> , but if you want to improve the zxcvbn, send me a pull request, the <a href="https://github.com/lowe/zxcvbn">README file</a> contains information about setting up the development environment. <br>  Hereinafter, I describe in detail the principle of operation of zxcvbn. <br><br><h4>  Model </h4><br>  Zxcvbn works in three stages: match (reconciliation), score (calculation), search (search). <br><br><ul><li>  The <strong>match</strong> function performs a reconciliation of all known combinations (including intersecting ones).  Currently, zxcvbn supports matching with several dictionaries (a dictionary of English words, first and last names, as well as a list of 10,000 most common Burnett passwords), sequential keyboard combinations (QWERTY, Dvorak and digital), repetitions (aaa), numeric and character sequences ( 123, gfedcba), for years in the range from 1900 to 2019, as well as dates (in formats 3-13-1997, 13.3.1997, 1331997).  All dictionaries recognize upper case and common equivalents of l33t. </li><li>  The <strong>score</strong> function calculates the degree of entropy for each matched combination separately from the rest of the password (assuming that the burglar knows this combination).  A simple example is rrrrr.  In this case, the hacker needs to go through all the options for repeating from 1 to 5, starting with a lowercase letter: </li></ul><br><pre> <code class="coffeescript hljs">entropy = lg(<span class="hljs-number"><span class="hljs-number">26</span></span>*<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  7 </span></span></code> </pre><br><ul><li>  The <strong>search</strong> function uses the principle of "Occam's razor";  from the full set of possibly intersecting coincidences, the search yields the simplest non-intersecting sequence (with minimal entropy).  For example, if the password is damnation, it can be broken into 2 words: dam and nation, or be treated as one.  In this case, it is important to treat the word exactly as a single whole, because the hacker will select the password as a single word that goes through the words much faster than two.  By the way, overlapping combinations are also the main cause of the emergence of such unintentionally fatal domain names as childrens-laughter.com, but without a hyphen (note: children's laughter - children's laughter, children slaughter - infanticide). </li></ul><br>  The search function is the cornerstone of the model.  I'll start with her and go back to the beginning. <br><br><h4>  Entropy Minimum Search </h4><br>  Zxcvbn calculates the degree of entropy of a password as the sum of the entropies of its constituent parts.  Any parts of the password between identified combinations are considered as brute force guesses that also have their own entropy.  Here is an example of entropy, consisting of the entropy of the last name, the entropy of the search and the entropy of the keyboard: <br><br><pre> <code class="coffeescript hljs">entropy(<span class="hljs-string"><span class="hljs-string">"stockwell4$eR123698745"</span></span>) == surname_entropy(<span class="hljs-string"><span class="hljs-string">"stockwell"</span></span>) + bruteforce_entropy(<span class="hljs-string"><span class="hljs-string">"4$eR"</span></span>) + keypad_entropy(<span class="hljs-string"><span class="hljs-string">"123698745"</span></span>)</code> </pre><br><br>  Here we make a serious assumption that the password entropy is the sum of the entropies of its parts.  However, this assumption is very conservative.  Disregarding the ‚Äúentropy of the configuration‚Äù ‚Äîthat is, the entropy of the number and location of the password parts ‚Äî zxcvbn intentionally underestimates the total entropy without attributing any value to the password structure: the program assumes that the password structure is already known to the hacker (for example, -numbers "), and counts only the number of attempts to guess the password elements.  Thus, the entropy of passwords with a complex structure is greatly underestimated.  Cracking the correcthorsebatterystaple password (word-word-word-word), a cracker using programs such as L0phtCrack or John the Ripper, as a rule, first goes through a lot of simpler structures (word, word-number, word-word) until it reaches word word word word word.  However, there are three reasons why this lack of a program does not bother me: <br><ul><li>  Developing a good structural entropy model is not easy;  I do not have statistics on which structures are most often used by users, so for accuracy it is better to underestimate the password entropy. </li><li>  With a complex password structure, the sum of the entropy of its parts often already provides it with an excellent complexity rating.  For example, even knowing the structure of the word-word-word-word password correcthorsebatterystaple, a cracker will crack this password for centuries. </li><li>  Most people do not use complex structures when creating passwords.  And neglecting the structure, as a rule, reduces the total entropy by just a few bits. </li></ul><br>  Having dealt with this assumption, let's consider the effective dynamic algorithm on CoffeeScript, which allows us to find the minimum non-intersecting sequence of matches.  Its operation time is O (n ‚Ä¢ m) for a password of length n, including m possible matches of character combinations (including overlapping ones). <br><br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># :    ,    #       (match.i)    # (match.j)   ,  minimum_entropy_match_sequence = (password, matches) -&gt; # , 26 ‚Äì  ,       bruteforce_cardinality = calc_bruteforce_cardinality password up_to_k = [] #    k,  backpointers = [] #      k,  #    (match.j = k). #  ,      for k in [0...password.length] #      : #         #   k-1. up_to_k[k] = (up_to_k[k-1] or 0) + lg bruteforce_cardinality backpointers[k] = null for match in matches when match.j = k [i, j] = [match.i, match.j] # ,     i-1 +   #      j candidate_entropy = (up_to_k[i-1] or 0) + calc_entropy(match) if candidate_entropy &lt; up_to_k[j] up_to_k[j] = candidate_entropy backpointers[j] = match #    ,    match_sequence = [] k = password.length ‚Äì 1 while k &gt;= 0 match = backpointers[k] if match match_sequence.push match k = match.i ‚Äì 1 else k -= 1 match_sequence.reverse() #  ¬´¬ª    , #   #       : # 1.j = 2.i ‚Äì 1    1, # 2. make_bruteforce_match = (i, j) -&gt; pattern: 'bruteforce' i: i j: j token: password[i..j] entropy: lg Math.pow(bruteforce_cardinality, j ‚Äì i + 1) cardinality: bruteforce_cardinality k = 0 match_sequence_copy = [] for match in match_sequence #     [i, j] = [match.i, match.j] if i ‚Äì k &gt; 0 match_sequence_copy.push make_bruteforce_match(k, i ‚Äì 1) k = j + 1 match_sequence_copy.push match if k &lt; password.length #  ¬´¬ª   match_sequence_copy.push make_bruteforce_match(k, password.length ‚Äì 1) match_sequence = match_sequence_copy #    ‚Äî    ¬´ ¬ª min_entropy = up_to_k[password.length - 1] or 0 crack_time = entropy_to_crack_time min_entropy #    password: password entropy: round_to_x_digits min_entropy, 3 match_sequence: match_sequence crack_time: round_to_x_digits crack_time, 3 crack_time_display: display_time crack_time score: crack_time_to_score crack_time</span></span></code> </pre><br><br>  The backpointers [j] array stores a match with a sequence ending in the password position j or a null value if there is no such match in the sequence.  With dynamic programming, it is customary to start building the optimal sequence from the end and move in the opposite direction. <br>  Performance is especially important for this script because it works in the browser during the password entry process.  To ensure the work of the program, I started with a simple O (2 <sup>m</sup> ) approach to calculating sums for all possible non-overlapping subsets, and the process was very quickly slowed down with the complexity of the task.  Now, a full analysis of most passwords for zxcvbn takes no more than a few milliseconds.  By the roughest estimate, in Google Chrome on 2.4 GHz Intel Xeon, the correcthorsebatterystaple password is analyzed on average in about 3 ms.  The password coRrecth0rseba ++ ery9 / 23 / 2007staple $ takes about 12 ms on average. <br><br><h4>  Threat Model: The Ratio Between Entropy and Break Time </h4><br>  The concept of entropy is not too transparent indicator.  How to understand if the 28-bit password is strong enough?  In other words, how to move from entropy estimation directly to the time of hacking?  For this, a threat model is applied.  Let's pretend that: <br><ul><li>  Passwords are stored in the form of hashes with "salt" and "salt" for each user selected randomly, which makes the attack using the rainbow table impractical; </li><li>  the cracker managed to steal all the hashes and all the "salt" and now he picks up the password in offline mode at the highest possible speed; </li><li>  at the disposal of the hacker several processors. </li></ul><br>  Some indicative numbers are: <br><br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment">#   -,  bcrypt/scrypt/PBKDF2,        #   10 . #      ‚Äî     ,     #      #   ; #     -   ,    #   ‚Äî ,   ! SINGLE_GUESS = .010 #  NUM_ATTACKERS = 100 #     SECONDS_PER_GUESS = SINGLE_GUESS / NUM_ATTACKERS entropy_to_crack_time = (entropy) -&gt; .5 * Math.pow(2, entropy) * SECONDS_PER_GUESS</span></span></code> </pre><br><br>  Here I entered a coefficient of 0.5, since we calculate the average time of hacking, and not the time for searching the entire search space. <br>  Perhaps these calculations are too conservative.  Large-scale theft of hashes happens quite rarely, and unless an attack is directed directly at you, the attacker is unlikely to transfer 100 cores to your password alone.  Typically, an attacker has to guess online, where he is annoyed by network latency, incremental latency and CAPTCHA. <br><br><h4>  Entropy calculation </h4><br>  Now consider how zxcvbn calculates the entropy of each combination of characters in a password.  The entry point is calc_entropy ().  This is a simple choice: <br><br><pre> <code class="coffeescript hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calc_entropy</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(match)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> match.entropy <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> match.entropy? entropy_func = <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> match.pattern <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'repeat'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> repeat_entropy <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'sequence'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> sequence_entropy <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'digits'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> digits_entropy <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'year'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> year_entropy <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'date'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> date_entropy <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'spatial'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> spatial_entropy <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'dictionary'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> dictionary_entropy match.entropy = entropy_func match</code> </pre><br><br>  Above, I outlined how the repeat_entropy function works.  The <a href="https://github.com/lowe/zxcvbn/blob/master/scoring.coffee">full text of the entropy calculation code</a> can be independently reviewed on github, but to give you some idea of ‚Äã‚Äãit, I will describe two other calculation functions: spatial_entropy (the entropy of keyboard combinations) and dictionary_entropy (dictionary entropy). <br>  Consider the qwertyhnm keyboard shortcut.  It starts with the q character, its length is 9 characters, and it has three directions of movement: first movement to the right, then down and to the right, then again down and to the right.  Parameterize this combination: <br><br><pre> <code class="coffeescript hljs">s <span class="hljs-comment"><span class="hljs-comment">#     # 47 ‚Äî   QWERTY/Dvorak, 15 ‚Äî    PC  16 ‚Äî #    Macintosh L #  ; L &gt;= 2 t #   ; t &lt;= L ‚Äì 1 # ,   3     2   (¬´qaw¬ª) d #  ¬´¬ª        ; #   QWERTY/Dvorak    4,6 (  g ‚Äì 6 , #   ‚Äì  1)</span></span></code> </pre><br><br>  Then the total space of possibilities includes all possible keyboard combinations of length L or less, having t or less direction changes: <br> <a href=""><img title="formula" src="http://blog.perevedem.ru/wp-content/uploads/2012/05/formula.bmp"></a> <br><br>  The function ‚Äú <em>binomial coefficient from (i - 1) to (j - 1)</em> ‚Äù calculates possible configurations of direction changes for a keyboard combination of length i, which has j direction changes.  ‚Äú-1‚Äù is added to both elements, since the first change of direction always occurs on the first letter.  For each of the j shifts of directions, there are d possible directions, i.e. there are only dj possibilities for each configuration.  The burglar must also go through all the initial characters, hence the coefficient s in the formula.  The formula itself is very approximate - in particular, because many of the options considered in it are impossible on a real keyboard: for a keyboard combination of length 5 with 1 direction change, the operation ‚Äústart with‚Äú q ‚Äùand move to the left‚Äù is taken into account, but impossible. <br><br>  This CoffeeScript expression can be written like this: <br><pre> <code class="coffeescript hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lg</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function"> -&gt;</span></span> Math.log(n) / Math.log(<span class="hljs-number"><span class="hljs-number">2</span></span>) nPk = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n, k)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> k &gt; n result = <span class="hljs-number"><span class="hljs-number">1</span></span> result *= m <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> m <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [n-k+<span class="hljs-number"><span class="hljs-number">1.</span></span>.n] result nCk = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n, k)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> k = <span class="hljs-number"><span class="hljs-number">0</span></span> k_fact = <span class="hljs-number"><span class="hljs-number">1</span></span> k_fact *= m <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> m <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [<span class="hljs-number"><span class="hljs-number">1.</span></span>.k] nPk(n, k) / k_fact spatial_entropy = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(match)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> match.graph <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [<span class="hljs-string"><span class="hljs-string">'qwerty'</span></span>, <span class="hljs-string"><span class="hljs-string">'dvorak'</span></span>] s = KEYBOARD_STARTING_POSITIONS d = KEYBOARD_AVERAGE_DEGREE <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s = KEYPAD_STARTING_POSITIONS d = KEYPAD_AVERAGE_DEGREE possibilities = <span class="hljs-number"><span class="hljs-number">0</span></span> L = match.token.length t = match.turns <span class="hljs-comment"><span class="hljs-comment">#      L,  t     for i in [2..L] possible_turns = Math.min(t, i ‚Äì 1) for j in [1..possible_turns] possibilities += nCk(i ‚Äì 1, j ‚Äì 1) * s * Math.pow(d, j) entropy = lg possibilities #   ,     # (%  5, A  a) #     ,  #        # . .   if match.shifted_count S = match.shifted_count U = match.token.length ‚Äì match.shifted_count #     possibilities = 0 possibilities += nCk(S + U, i) for i in [0..Math.min(S, U)] entropy += lg possibilities entropy</span></span></code> </pre><br><br>    : <br><br><pre> <code class="coffeescript hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dictionary_entropy</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(match)</span></span></span><span class="hljs-function"> -&gt;</span></span> entropy = lg match.rank entropy += extra_uppercasing_entropy match entropy += extra_l33t_entropy match entropy</code> </pre><br><br>    ‚Äî :      <strong>  </strong> :  ,  <em>the</em>  <em>good</em>   ,    <em>photojournalist</em>  <em>maelstrom</em> ‚Äî .   zxcvbn         , ,       ,       .    ,     correcthorsebatterystaple     xkcd  zxcvbn (45,2   44  ).  xkcd     211 ( 2000 ),  zxcvbn      .  zxcvbn.js   ,    <a href="http://en.wikipedia.org/wiki/Bloom_filter"> </a> ,        ,     . <br>    ,   ¬´¬ª,  ,     . ,      ,   : <br><br><pre> <code class="coffeescript hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extra_uppercase_entropy</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(match)</span></span></span><span class="hljs-function"> -&gt;</span></span> word = match.token <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> word.match ALL_LOWER <span class="hljs-comment"><span class="hljs-comment">#       ‚Äî  #    , #          ( + # ): #  1   . #           #   , #     ,   , #   ,  1  for regex in [START_UPPER, END_UPPER, ALL_UPPER] return 1 if word.match regex #   ,      #   # U+L     U    # ,   ,   (, PASSwORD), ‚Äî  #      U+L   L    U = (chr for chr in word.split(‚Äù) when chr.match /[AZ]/).length L = (chr for chr in word.split(‚Äù) when chr.match /[az]/).length possibilities = 0 possibilities += nCk(U + L, i) for i in [0..Math.min(U, L)] lg possibilities</span></span></code> </pre><br><br>  ,  1      ¬´ ¬ª    .          ,   : <br><img title="formula2" src="http://blog.perevedem.ru/wp-content/uploads/2012/05/formula2.bmp"><br><br>     l33t ,                . <br><br><h4>   </h4><br>         ,    ,  zxcvbn   .       ‚Äî   :          : <br><pre> <code class="coffeescript hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dictionary_match</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(password, ranked_dict)</span></span></span><span class="hljs-function"> -&gt;</span></span> result = [] len = password.length password_lower = password.toLowerCase() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [<span class="hljs-number"><span class="hljs-number">0.</span></span>..len] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [i...len] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> password_lower[i..j] <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ranked_dict word = password_lower[i..j] rank = ranked_dict[word] result.push( pattern: <span class="hljs-string"><span class="hljs-string">'dictionary'</span></span> i: i j: j token: password[i..j] matched_word: word rank: rank ) result</code> </pre><br><br> Ranked_dict    .     ,        ,       .  l33t   ,     dictionary_match.   (, bvcxz)     ,      .        .   matching.coffee  github        . <br><br><h4>  Data </h4><br>    , <a href="http://xato.net/passwords/more-top-worst-passwords"> 10 000   </a>    ,   2011 . <br><br> <a href="http://www.census.gov/genealogy/names/names_files.html">    </a>         2000 ,    .   zxcvbn       Internet Explorer 7,       80 % (. . 80 %   ,    ),    ‚Äî  90 %. <br><br>  40 000           <a href="http://en.wiktionary.org/wiki/Wiktionary:Frequency_lists">   Wiktionary</a> ,     29 .      ,   .    ,   ,     ,           (,     ),       ‚Äî     .      , , Frasier   824-    . <br><br><h4>  Conclusion </h4><br>     ,            ,       .    ,    ‚Äî ,  ¬´ ¬ª         ,      (  )   .          ,   ,        .     : ,        ,          ,   (   ,      ). <br><br>       ,        . Zxcvbn   ,             ;   n-;     ;    (, qzwxec)   .   (, <a href="http://en.wikipedia.org/wiki/Catalan_number"> </a> )    ,    ,   zxcvbn,   ,       ‚Äî      .    : <br><ul><li>     zxcvbn     ,              .            .    <a href="http://en.wikipedia.org/wiki/Keyboard_layout"> </a> zxcvbn   .                 . </li><li>   <a href="http://www.lightbluetouchpaper.org/2012/03/07/some-evidence-on-multi-word-passphrases/">,   </a> ,           .  zxcvbn   ,    ¬´ ¬ª   ,         . <a href="http://www.ldc.upenn.edu/Catalog/catalogEntry.jsp%3FcatalogId%3DLDC2009T25"> n- Google</a>   ,         ,            .           ,    Google. </li><li> Zxcvbn       (  )  .         ( ,     ).    ,    ‚Äî  ,       l33t. </li></ul><br>   ,  ,      , zxcvbn           ,      . ,       . ¬´¬ª   <a href="https://github.com/lowe/zxcvbn">github</a>  ! <br>    ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,         . <br><br>   <a href="http://blog.perevedem.ru/2012/08/09/realistichnaya-ocenka-nadezhnosti-parolya/">ABBYY Language Services</a> <br><br> <b>ps</b>       ¬´    ¬ª, ¬´    ¬ª     ‚Äî   . </div><p>Source: <a href="https://habr.com/ru/post/149396/">https://habr.com/ru/post/149396/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149388/index.html">ImageCMS 3.3.6.72 release and major company news</a></li>
<li><a href="../149389/index.html">Phishing site advertising in Yandex.Direct and fake Skype</a></li>
<li><a href="../149390/index.html">SQLite is a great embedded database (part 2)</a></li>
<li><a href="../149391/index.html">Business analysis in the social network Odnoklassniki</a></li>
<li><a href="../149392/index.html">A bit of fire on pure CSS (Firefox)</a></li>
<li><a href="../149397/index.html">Browser API for registering on the site and making instant payments</a></li>
<li><a href="../149399/index.html">How income is distributed between applications</a></li>
<li><a href="../149400/index.html">Two Open Source organizations have argued over a logo that could violate a trademark.</a></li>
<li><a href="../149401/index.html">Create a walking robot</a></li>
<li><a href="../149402/index.html">HelloWorld for iOS with jailbreak</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>