<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>nginx magento ssl postfix - server and do-it-yourself shop</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The last post was about building a server from source. 
 Many said that now this is not rolling, give them packages. 

 But mostly it was whining, lik...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>nginx magento ssl postfix - server and do-it-yourself shop</h1><div class="post__text post__text-html js-mediator-article">  The last post was about building a server from source. <br>  Many said that now this is not rolling, give them packages. <br><br>  But mostly it was whining, like - I‚Äôm smarter than you, you don‚Äôt work correctly, the config is not a boy‚Äôs ... no one said how to fix it, where to do it correctly and differently, what other configuration options are there, and so on.  Yes, and heck with him, everyone has his views, I accept it. <br>  Yet someone took note of himself, well, someone passed by. <br>  Why am I writing about this?  There are websites, forums with mailing lists, there are many manuals, but people continue to go crazy in search of a normal explanation of the settings and settings.  They pay other grief to specialists, and they put everything crooked and not full configs, without optimization.  And if there is no difference - why pay more (c) ???  Anyone would like to set up their server and put the store, and for a start he needs a start, to show that it is very simple, what can be saved at the beginning, then, when everything works, think about it - is it so difficult?  But can I continue to do everything myself?  to do better picking up the experience?  Yes, everything can be done by yourself.  Not for nothing the old wisdom says - if you want it to be good, do it yourself! <br><br>  In order not to write empty, we will specifically do the installation and launch of the server for the store, under management - MAGENTO 1.4.0.1 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  ================================================= =========================== <br><br>  I rummaged through no, and found an interesting site and repository with the latest versions of packages for Sentos 5. <br>  here is the repository itself: <br>  <a href="http://centos.alt.ru/pub/repository/centos/5/i386/">centos.alt.ru/pub/repository/centos/5/i386</a> <br><br><h4>  <b>Install repository</b> </h4><br>  The CentALT repository requires the EPEL repository to work. <br>  Installation is the same as always: <br><br>  1. Install the epel repository. <br>  rpm -ihv <a href="">download.fedora.redhat.com/pub/epel/5/i386/epel-release-5-3.noarch.rpm</a> <br><br>  2. Install the CentALT repository. <br>  rpm -ihv <a href="">centos.alt.ru/repository/centos/5/i386/centalt-release-5-3.noarch.rpm</a> <br><br>  and then the end of the line implies pressing -enter- :) <br><br><h4>  <b>We look that it is possible and it is necessary to update:</b> </h4><br>  # yum list updates <br>  # yum update <br><br><h4>  <b>Look what is installed</b> </h4><br>  # rpm -qa <br>  # yum list installed <br><br><h4>  <b>Install the necessary software:</b> </h4><br><br>  # yum install nginx <br>  # yum install php-fpm php-mysql php-gd php-mcrypt php-dom <br>  # yum install mysql-server <br>  # yum install openssl <br>  # yum install vsftpd <br>  # yum install postfix dovecot <br>  # yum install phpmyadmin <br>  # yum update <br><br><h4>  <b>We include autostart services:</b> </h4><br><br>  # / sbin / chkconfig nginx on <br>  # / sbin / chkconfig mysqld on <br>  # / sbin / chkconfig php-fpm on <br>  # / sbin / chkconfig dovecot on <br><br>  # /etc/init.d/sendmail stop <br>  # / sbin / chkconfig sendmail off <br><br>  Now we need to remove the installed sendmail package: <br>  # yum remove sendmail <br><br>  # / sbin / chkconfig postfix on <br>  # /etc/init.d/postfix start <br><br>  link phpMyAdmin to our working directory <br>  # find / -name 'phpmyadmin *' <br>  # ln -s / usr / share / phpMyAdmin <b>version?</b>  / var / www / html / phpmyadmin <br><br><h4>  <b>If you need to use ssl, generate a certificate request and server key:</b> </h4><br><br>  The trick is that now you can get a certificate for free, your hoster or domain registrar should have an affiliate with COMODO, when you buy a domain or server, they are given a certificate. <br><br>  # cd <br>  # openssl req -nodes -newkey rsa: 1024 -keyout myserver.key -out server.csr <br><br>  server.csr -&gt; filling out, answering all the questions <br><br>  <a href="https://support.comodo.com/index.php%3F_m%3Dknowledgebase%26_a%3Dviewarticle%26kbarticleid%3D3%26nav%3D0">support.comodo.com/index.php?_m=knowledgebase&amp;_a=viewarticle&amp;kbarticleid=3&amp;nav=0</a> , 96.1 <br><br>  Country Name (2 letter code) [AU]: <br>  State or Province Name (full name) [Some-State]: <br>  Locality Name (eg, city) []: <br>  Organization Name (eg, company) [Internet Widgits Pty Ltd]: <br>  Organizational Unit Name (eg, section) []: IT <br>  Common Name (eg, YOUR name) []: <b><a href="http://www.mysite.com/">www.mysite.com</a></b> <br>  Email Address []: <br><br>  A challenge password []: <br>  An optional company name []: <br><br>  open the file and send the data through <br>  a special form from the provider to issue a certificate. <br><br>  Further, having received all necessary certificates from the provider, we put them all in one bundle: <br>  see instructions <br>  # <a href="https://support.comodo.com/index.php%3F_m%3Dknowledgebase%26_a%3Dviewarticle%26kbarticleid%3D1209">support.comodo.com/index.php?_m=knowledgebase&amp;_a=viewarticle&amp;kbarticleid=1209</a> <br><br>  We throw everything in the root directory, for example. <br><br>  then we move all this to the folder from where nginx will read all https for requests <br>  # mkdir / etc / nginx / cert <br>  # cd <br>  # mv myserver.key / etc / nginx / cert / <br>  # mv bundle.crt / etc / nginx / cert / <br><br><h4>  <b>Configuring nginx (/etc/nginx/nginx.conf file).</b> </h4><br>  # In this example, the store is located on the path / in the / var / www / html / folder. <br>  # for php used PHP-FPM connected via unix socket. <br><br> <code><font color="#adadad">### config starts ###</font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad"># USER -     ,       .</font> &lt;br/&gt; <br> <font color="#adadad">#    ,   ,      .</font> &lt;br/&gt; <br> <font color="#00007f">user</font> nginx;&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#   .</font> &lt;br/&gt; <br> worker_processes <font color="#ff0000">1</font> ;&lt;br/&gt; <br> &lt;br/&gt; <br> error_log /var/log/nginx/error.log;&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad"># ,     .</font> &lt;br/&gt; <br> pid /var/run/nginx.pid;&lt;br/&gt; <br> <font color="#adadad">#</font> &lt;br/&gt; <br> events {&lt;br/&gt; <br> worker_connections <font color="#ff0000">1024</font> ;&lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> http {&lt;br/&gt; <br> <font color="#adadad"># include -     .        .</font> &lt;br/&gt; <br> <font color="#00007f">include</font> /etc/nginx/mime.types;&lt;br/&gt; <br> default_type application/octet-stream;&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#      </font> &lt;br/&gt; <br> <font color="#adadad"># configure log format</font> &lt;br/&gt; <br> <font color="#adadad"># log_format main '$remote_addr - $remote_user [$time_local] '</font> &lt;br/&gt; <br> <font color="#adadad">#                  '"$request" $status  $body_bytes_sent "$http_referer" '</font> &lt;br/&gt; <br> <font color="#adadad">#                  '"$http_user_agent" "$http_x_forwarded_for"';</font> &lt;br/&gt; <br> <font color="#adadad"># access_log /var/log/nginx/access.log main;</font> &lt;br/&gt; <br> <font color="#adadad">#      </font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#           Linux   FreeBSD 4.x.</font> &lt;br/&gt; <br> <font color="#adadad">#     .</font> &lt;br/&gt; <br> tcp_nopush <font color="#0000ff">on</font> ;&lt;br/&gt; <br> <font color="#adadad">#  keep-alive.</font> &lt;br/&gt; <br> <font color="#adadad">#       ( , )</font> &lt;br/&gt; <br> tcp_nodelay <font color="#0000ff">off</font> ;&lt;br/&gt; <br> &lt;br/&gt; <br> sendfile <font color="#0000ff">on</font> ; <font color="#adadad">#  sendfile().</font> &lt;br/&gt; <br> keepalive_timeout <font color="#ff0000">65</font> ; <font color="#adadad">#         .</font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#  ngx_http_gzip_module -  ,    gzip,        2   .</font> &lt;br/&gt; <br> <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_gzip_module.html</font> &lt;br/&gt; <br> gzip <font color="#0000ff">on</font> ; <font color="#adadad">#     gzip.</font> &lt;br/&gt; <br> gzip_proxied any; <font color="#adadad">#      .</font> &lt;br/&gt; <br> <font color="#adadad">#    gzip   MIME-    "text/html". "text/html"  !</font> &lt;br/&gt; <br> gzip_types text/plain text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript; &lt;br/&gt; <br> gzip_http_version <font color="#ff0000">1.1</font> ;&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#       FastCGI-.</font> &lt;br/&gt; <br> <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_fastcgi_module.html</font> &lt;br/&gt; <br> fastcgi_connect_timeout <font color="#ff0000">300</font> ;&lt;br/&gt; <br> fastcgi_send_timeout <font color="#ff0000">300</font> ;&lt;br/&gt; <br> fastcgi_read_timeout <font color="#ff0000">300</font> ;&lt;br/&gt; <br> <font color="#adadad">#    ,       ,   FastCGI-.</font> &lt;br/&gt; <br> fastcgi_buffer_size 64k;&lt;br/&gt; <br> <font color="#adadad">#         ,     ,   FastCGI-.</font> &lt;br/&gt; <br> fastcgi_buffers <font color="#ff0000">4</font> 64k;&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad"># fastcgi nodes</font> &lt;br/&gt; <br> <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_upstream.html#upstream</font> &lt;br/&gt; <br> <font color="#adadad">#    .</font> &lt;br/&gt; <br> upstream backend {&lt;br/&gt; <br> server unix:/tmp/fcgi.sock; <font color="#adadad">#    unix </font> &lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#      .</font> &lt;br/&gt; <br> <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_core_module.html#server</font> &lt;br/&gt; <br> server {&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_core_module.html#listen</font> &lt;br/&gt; <br> <font color="#adadad">#     ,     .</font> &lt;br/&gt; <br> <font color="#00007f">listen</font> <font color="#ff0000">80</font> ; &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#      .</font> &lt;br/&gt; <br> <font color="#adadad">#       , ,    unix-.</font> &lt;br/&gt; <br> <font color="#adadad">#       ,   .</font> &lt;br/&gt; <br> server_name www.name.com; <font color="#adadad">#  </font> &lt;br/&gt; <br> root /var/www/html; <font color="#adadad">#      .</font> &lt;br/&gt; <br> autoindex <font color="#0000ff">off</font> ; <font color="#adadad">#    , directory listing - off</font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#   URI,      .</font> &lt;br/&gt; <br> <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_core_module.html#error_page</font> &lt;br/&gt; <br> error_page <font color="#ff0000">404</font> error/404.html;&lt;br/&gt; <br> error_page <font color="#ff0000">502</font> <font color="#ff0000">503</font> <font color="#ff0000">504</font> error/500.html;&lt;br/&gt; <br> <font color="#adadad"># error_page   404 = @magento;</font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_core_module.html#location</font> &lt;br/&gt; <br> <font color="#adadad">#       URI .</font> &lt;br/&gt; <br> <font color="#adadad"># ,  ...</font> &lt;br/&gt; <br> <font color="#00007f">location</font> ~ (/(app/|includes/|lib/|pkginfo/|var/|report/config.xml)|/\.svn/|/.hta.+)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#00007f">deny</font> <font color="#00007f">all</font> ; <font color="#adadad"># ...  </font> &lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#</font> &lt;br/&gt; <br> <font color="#00007f">location</font> ~ (\.php|/downloader/?|/report/?)$ {&lt;br/&gt; <br> try_files /error/404.html $uri/ = <font color="#ff0000">404</font> ;&lt;br/&gt; <br> <font color="#adadad">#    FastCGI-.</font> &lt;br/&gt; <br> fastcgi_pass backend;&lt;br/&gt; <br> <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_fastcgi_module.html</font> &lt;br/&gt; <br> <font color="#00007f">include</font> /etc/nginx/fastcgi_params;&lt;br/&gt; <br> fastcgi_param script_FILENAME $document_root$fastcgi_script_name;&lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#    </font> &lt;br/&gt; <br> <font color="#adadad"># </font> &lt;br/&gt; <br> <font color="#00007f">location</font> = /downloader { rewrite ^ /downloader/ permanent; }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#       </font> &lt;br/&gt; <br> <font color="#00007f">location</font> = /downloader/ {&lt;br/&gt; <br> try_files /error/404.html $uri/ = <font color="#ff0000">404</font> ;&lt;br/&gt; <br> fastcgi_pass backend;&lt;br/&gt; <br> <font color="#00007f">include</font> /etc/nginx/fastcgi_params;&lt;br/&gt; <br> fastcgi_param script_FILENAME $document_root/downloader/index.php;&lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> = /report { rewrite ^ /report/ permanent; }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> = /report/ {&lt;br/&gt; <br> try_files /error/404.html $uri/ = <font color="#ff0000">404</font> ;&lt;br/&gt; <br> fastcgi_pass backend;&lt;br/&gt; <br> <font color="#00007f">include</font> /etc/nginx/fastcgi_params;&lt;br/&gt; <br> fastcgi_param script_FILENAME $document_root/report/index.php;&lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> / {&lt;br/&gt; <br> <font color="#adadad"># set expire headers</font> &lt;br/&gt; <br> if ($request_uri ~* <font color="#7f007f">" <font color="#000099">\.</font> (ico|css|js|gif|jpe?g|png)$"</font> ) {&lt;br/&gt; <br> expires max; <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_headers_module.html#expires</font> &lt;br/&gt; <br> }&lt;br/&gt; <br> <font color="#adadad">#  "@"   location.</font> &lt;br/&gt; <br> <font color="#adadad">#  location      ,</font> &lt;br/&gt; <br> <font color="#adadad">#        .</font> &lt;br/&gt; <br> try_files $uri $uri/ @magento;&lt;br/&gt; <br> index index.php;&lt;br/&gt; <br> expires max;&lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#  "@" ( )    </font> &lt;br/&gt; <br> <font color="#00007f">location</font> @magento {&lt;br/&gt; <br> fastcgi_pass backend;&lt;br/&gt; <br> <font color="#00007f">include</font> /etc/nginx/fastcgi_params;&lt;br/&gt; <br> fastcgi_param script_FILENAME $document_root/index.php;&lt;br/&gt; <br> }&lt;br/&gt; <br> } &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#     HTTPS , , ,    .</font> &lt;br/&gt; <br> <font color="#adadad">#          </font> &lt;br/&gt; <br> server {&lt;br/&gt; <br> <font color="#00007f">listen</font> <font color="#ff0000">443</font> ; <font color="#adadad"># SSL port</font> &lt;br/&gt; <br> server_name www.name.com;&lt;br/&gt; <br> root /var/www/html;&lt;br/&gt; <br> autoindex <font color="#0000ff">off</font> ;&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad"># error_page   404 495 496 497        error/400.html;</font> &lt;br/&gt; <br> <font color="#adadad"># error_page   502 503 504  error/500.html;</font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_ssl_module.html</font> &lt;br/&gt; <br> ssl <font color="#0000ff">on</font> ; <font color="#adadad">#    HTTPS    .</font> &lt;br/&gt; <br> ssl_protocols SSLv3 TLSv1; <font color="#adadad">#    .</font> &lt;br/&gt; <br> ssl_ciphers HIGH:!ADH:!MD5; <font color="#adadad">#    .</font> &lt;br/&gt; <br> <font color="#adadad">#  ,     SSLv3  TLSv1     ,  .</font> &lt;br/&gt; <br> ssl_prefer_server_ciphers <font color="#0000ff">on</font> ;&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#      CA     .</font> &lt;br/&gt; <br> ssl_certificate /etc/nginx/cert/bundle.crt;&lt;br/&gt; <br> <font color="#adadad">#          .</font> &lt;br/&gt; <br> ssl_certificate_key /etc/nginx/cert/myserver.key;&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">#          .</font> &lt;br/&gt; <br> ssl_session_cache    shared:SSL:10m;&lt;br/&gt; <br> <font color="#adadad">#   ,         ,   </font> &lt;br/&gt; <br> ssl_session_timeout  10m;&lt;br/&gt; <br> &lt;br/&gt; <br> &lt;br/&gt; <br> keepalive_timeout <font color="#ff0000">65</font> ;&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad"># http://sysoev.ru/nginx/docs/http/ngx_http_headers_module.html#add_header</font> &lt;br/&gt; <br> add_header Front-End-Https <font color="#0000ff">on</font> ;&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> ~ (/(app/|includes/|lib/|pkginfo/|var/|report/config.xml)|/\.svn/|/.hta.+)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#00007f">deny</font> <font color="#00007f">all</font> ;&lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> ~ (\.php|/downloader/?|/report/?)$ {&lt;br/&gt; <br> try_files /error/404.html $uri/ = <font color="#ff0000">404</font> ;&lt;br/&gt; <br> fastcgi_pass backend;&lt;br/&gt; <br> <font color="#00007f">include</font> /etc/nginx/fastcgi_params;&lt;br/&gt; <br> fastcgi_param script_FILENAME $document_root$fastcgi_script_name;&lt;br/&gt; <br> fastcgi_param HTTPS <font color="#0000ff">on</font> ; <font color="#adadad">#    ssl</font> &lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> = /downloader { rewrite ^ /downloader/ permanent; }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> = /downloader/ {&lt;br/&gt; <br> try_files /error/404.html $uri/ = <font color="#ff0000">404</font> ;&lt;br/&gt; <br> &lt;br/&gt; <br> fastcgi_pass backend;&lt;br/&gt; <br> <font color="#00007f">include</font> /etc/nginx/fastcgi_params;&lt;br/&gt; <br> fastcgi_param script_FILENAME $document_root/downloader/index.php;&lt;br/&gt; <br> fastcgi_param HTTPS <font color="#0000ff">on</font> ; <font color="#adadad">#    ssl</font> &lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> = /report { rewrite ^ /report/ permanent; }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> = /report/ {&lt;br/&gt; <br> try_files /error/404.html $uri/ = <font color="#ff0000">404</font> ;&lt;br/&gt; <br> &lt;br/&gt; <br> fastcgi_pass backend;&lt;br/&gt; <br> <font color="#00007f">include</font> /etc/nginx/fastcgi_params;&lt;br/&gt; <br> fastcgi_param script_FILENAME $document_root/report/index.php;&lt;br/&gt; <br> fastcgi_param HTTPS <font color="#0000ff">on</font> ; <font color="#adadad">#    ssl</font> &lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> / {&lt;br/&gt; <br> try_files $uri $uri/ @magento;&lt;br/&gt; <br> index index.php;&lt;br/&gt; <br> expires max;&lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#00007f">location</font> @magento {&lt;br/&gt; <br> fastcgi_pass backend;&lt;br/&gt; <br> <font color="#00007f">include</font> /etc/nginx/fastcgi_params;&lt;br/&gt; <br> fastcgi_param script_FILENAME $document_root/index.php;&lt;br/&gt; <br> fastcgi_param HTTPS <font color="#0000ff">on</font> ; <font color="#adadad">#    ssl</font> &lt;br/&gt; <br> }&lt;br/&gt; <br> <font color="#adadad">#   phpmyadmin,     https://www.mysite.com/phpmyadmin/</font> &lt;br/&gt; <br> <font color="#00007f">location</font> = /phpmyadmin { rewrite ^ /phpmyadmin/ permanent; }&lt;br/&gt; <br> }&lt;br/&gt; <br> &lt;br/&gt; <br> } &lt;br/&gt; <br> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#adadad">### config ends ###</font> &lt;br/&gt; <br> <br> <br></code> <br><br><h4>  <b>PHP-FPM configuration (/etc/php-fpm.conf file).</b>  <b>A local socket is used.</b> </h4><br><pre>
 &lt;configuration&gt;
         &lt;section name = "global_options"&gt;
                 &lt;value name = "pid_file"&gt; / var / run / php-fpm.pid &lt;/ value&gt;
                 &lt;value name = "error_log"&gt; / var / log / php-fpm.log &lt;/ value&gt;
                 &lt;value name = "log_level"&gt; notice &lt;/ value&gt;
                 &lt;value name = "emergency_restart_threshold"&gt; 10 &lt;/ value&gt;
                 &lt;value name = "emergency_restart_interval"&gt; 1m &lt;/ value&gt;
                 &lt;value name = "process_control_timeout"&gt; 5s &lt;/ value&gt;
                 &lt;value name = "daemonize"&gt; yes &lt;/ value&gt;
         &lt;/ section&gt;
         &lt;workers&gt;
                 &lt;section name = "pool"&gt;
                         &lt;value name = "name"&gt; default &lt;/ value&gt;
                         &lt;value name = "listen_address"&gt; / tmp / fcgi.sock &lt;/ value&gt;
                         &lt;value name = "listen_options"&gt;
                                 &lt;value name = "owner"&gt; &lt;/ value&gt;
                                 &lt;value name = "group"&gt; &lt;/ value&gt;
                                 &lt;value name = "mode"&gt; 0666 &lt;/ value&gt;
                         &lt;/ value&gt;
                         &lt;value name = "php_defines"&gt;
                         &lt;/ value&gt;
                         &lt;value name = "user"&gt; nginx &lt;/ value&gt;
                         &lt;value name = "group"&gt; nginx &lt;/ value&gt;
                         &lt;value name = "pm"&gt;
                                 &lt;value name = "style"&gt; static &lt;/ value&gt;
                                 &lt;value name = "max_children"&gt; 10 &lt;/ value&gt;
                                 &lt;value name = "apache_like"&gt;
                                         &lt;value name = "StartServers"&gt; 20 &lt;/ value&gt;
                                         &lt;value name = "MinSpareServers"&gt; 5 &lt;/ value&gt;
                                         &lt;value name = "MaxSpareServers"&gt; 35 &lt;/ value&gt;
                                 &lt;/ value&gt;
                         &lt;/ value&gt;
                         &lt;value name = "request_terminate_timeout"&gt; 0s &lt;/ value&gt;
                         &lt;value name = "request_slowlog_timeout"&gt; 0s &lt;/ value&gt;
                         &lt;value name = "slowlog"&gt; logs / slow.log &lt;/ value&gt;
                         &lt;value name = "rlimit_files"&gt; 1024 &lt;/ value&gt;
                         &lt;value name = "rlimit_core"&gt; 0 &lt;/ value&gt;
                         &lt;value name = "chroot"&gt; &lt;/ value&gt;
                         &lt;value name = "chdir"&gt; &lt;/ value&gt;
                         &lt;value name = "catch_workers_output"&gt; yes &lt;/ value&gt;
                         &lt;value name = "max_requests"&gt; 500 &lt;/ value&gt;
                         &lt;value name = "allowed_clients"&gt; 127.0.0.1 &lt;/ value&gt;
                         &lt;value name = "environment"&gt;
                                 &lt;value name = "HOSTNAME"&gt; $ HOSTNAME &lt;/ value&gt;
                                 &lt;value name = "PATH"&gt; / usr / local / bin: / usr / bin: / bin &lt;/ value&gt;
                                 &lt;value name = "TMP"&gt; / tmp &lt;/ value&gt;
                                 &lt;value name = "TMPDIR"&gt; / tmp &lt;/ value&gt;
                                 &lt;value name = "TEMP"&gt; / tmp &lt;/ value&gt;
                                 &lt;value name = "OSTYPE"&gt; $ OSTYPE &lt;/ value&gt;
                                 &lt;value name = "MACHTYPE"&gt; $ MACHTYPE &lt;/ value&gt;
                                 &lt;value name = "MALLOC_CHECK _"&gt; 2 &lt;/ value&gt;
                         &lt;/ value&gt;
                 &lt;/ section&gt;
         &lt;/ workers&gt;
 &lt;/ configuration&gt;
 &lt;/ code&gt; </pre><br><br><h4>  <b>Run nginx and php-fpm:</b> </h4><br><br>  # /etc/init.d/php-fpm start <br>  # /etc/init.d/nginx start <br><br><h4>  <b>We start mysqld, and we assign the password for mysql</b> </h4><br><br>  # /etc/init.d/mysqld start <br>  # / usr / bin / mysql_secure_installation <br><br><h4>  <b>Now add the user and the magento database:</b> </h4><br><br>  # mysql --user = root -p <br>  # mysql&gt; CREATE USER 'magento' @ 'localhost' IDENTIFIED BY 'my_password'; <br>  # mysql&gt; CREATE DATABASE magento; <br>  # mysql&gt; GRANT ALL PRIVILEGES ON `magento`. * TO 'magento' @ '%' WITH GRANT OPTION; <br><br><h4>  <b>Installing Magento Via SSH</b> </h4><br><br>  swing here and install magento here <br>  # cd / var / www / html / <br>  # wget <a href="">www.magentocommerce.com/downloads/assets/1.4.0.1/magento-1.4.0.1.tar.gz</a> <br><br>  download demo products and installations <br>  # wget <a href="">www.magentocommerce.com/downloads/assets/1.2.0/magento-sample-data-1.2.0.tar.gz</a> <br><br>  unpacking <br>  # tar -zxvf magento-1.4.0.1.tar.gz <br><br>  unpacking <br>  # tar -zxvf magento-sample-data-1.2.0.tar.gz <br><br>  we collect everything in one pile <br>  # mv magento-sample-data-1.2.0 / media / * magento / media / <br><br>  pulling up the database <br>  # mv magento-sample-data-1.2.0 / magento_sample_data_for_1.2.0.sql magento / data.sql <br><br>  and throw everything on the root <br>  # mv magento / * magento / .htaccess. <br><br>  correct rights <br>  # chmod o + w var var / .htaccess app / etc <br><br>  correct rights <br>  # chmod -R o + w media <br><br>  we push the base with your values ‚Äã‚Äã- DBHOST DBUSER DBPASS DBNAME <br>  # mysql -h DBHOST -u DBUSER -pDBPASS DBNAME &lt;data.sql <br><br>  setting <br>  # ./pear mage-setup. <br><br>  setting <br>  # ./pear install magento-core / Mage_All_Latest-stable <br><br>  we clean the garbage <br>  # rm -rf downloader / pearlib / cache / * downloader / pearlib / download / * <br><br>  we clean the garbage <br>  # rm -rf magento / magento-sample-data-1.2.0 / <br><br>  we clean the garbage <br>  # rm -rf magento-1.4.0.1.tar.gz magento-sample-data-1.2.0.tar.gz data.sql <br><br><h4>  <b>We assign the correct owner to all files:</b> </h4><br>  # cd / var / www / <br>  # chown -R nginx: nginx html <br><br>  READY !!! <br><br>  Now go to the magento configuration step, indicating in the browser the address of our installation, <br>  for example <a href="http://www.mysite.com/">www.mysite.com</a> <br>  Must earn magento installation wizard. <br>  In the database settings we specify the user magento (and the password you assigned), the host address is localhost. <br>  Also note the ‚ÄúSkip Base URL validation before next step‚Äù flag. <br><br><h4>  <b>Create FTP user 'masterftp' and password:</b> </h4><br><br>  <a href="http://centos.name/%3Fpage/howto/Install-Vsftpd">centos.name/?page/howto/Install-Vsftpd</a> <br>  -&gt; Configure vsftpd <br><br>  new user in the nginx group only FTP access: <br>  # useradd -g nginx -s / sbin / nologin masterftp <br>  # passwd masterftp <br><br>  for a user who is already in the system only FTP access: <br>  # usermod -g nginx -s / sbin / nologin <b>username</b> <br><br>  FTP server config itself (just in case) <br>  # vi /etc/vsftpd/vsftpd.conf <br><br>  Start / Stop <br>  # service vsftpd start <br>  # service vsftpd stop <br><br><h4>  <b>Setting up the soap - we will take everything and forward to another address:</b> </h4><br><br>  maybe you need a mail user (john)? <br>  # adduser mailuser <br><br>  Now you need to minimally configure postfix for receiving and sending mail <br>  The most optimal setting option can be found here. <br>  on an example make your own changes <br>  <a href="http://wiki.centos.org/HowTos/postfix">wiki.centos.org/HowTos/postfix#head-761bdd5d364ddb0dcbb4e1fcdc5af9d8f41286e5</a> <br><br>  Create a file / etc / postfix / virtual for redirection. <br>  # vi / etc / postfix / virtual <br><br>  We indicate that we accept everything and send further: <br>  @ yourdomain.com mymail@gmail.com <br><br>  We save. <br><br>  we specify new mail rules: <br>  # postmap / etc / postfix / virtual <br><br>  Also put in /etc/postfix/main.cf: <br>  virtual_alias_maps = hash: / etc / postfix / virtual <br><br>  update mailer: <br>  # service postfix reload <br><br>  Now run postfix: <br>  # service postfix restart <br><br>  ================================================= ============== <br>  server is configured, the store is running, mail is flying ... beer is pouring ... <br><br>  Thanks for attention. <br>  sorry if something goes wrong :) </div><p>Source: <a href="https://habr.com/ru/post/98306/">https://habr.com/ru/post/98306/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../98295/index.html">Tesla Motors IPO - Interim Results</a></li>
<li><a href="../98296/index.html">Python 2.7 released</a></li>
<li><a href="../98297/index.html">HTC Hero, the week with official Android 2.1</a></li>
<li><a href="../98299/index.html">IPhone 4 antenna testing</a></li>
<li><a href="../98303/index.html">PlayerOK</a></li>
<li><a href="../98308/index.html">Nano Rush</a></li>
<li><a href="../98309/index.html">How Macsolutions my laptop repaired. Part Four - Answer Rospotrebnadzor</a></li>
<li><a href="../98310/index.html">Guided Tours + iPhone</a></li>
<li><a href="../98311/index.html">Added jQuery FormNavigate or ‚Äúdon't let the user lose data‚Äù</a></li>
<li><a href="../98312/index.html">Yogurt for Optimus. LG confirms Froyo tablet release in fourth quarter 2010</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>