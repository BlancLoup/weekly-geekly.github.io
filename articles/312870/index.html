<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we built our mini data center. Part 3 - Relocation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing Part 1 - Colocation 
 In continuation of Part 2 - Hermoson 
 Hello! Judging by the reviews, letters and comments to the past two parts of o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we built our mini data center. Part 3 - Relocation</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  Continuing <a href="https://habrahabr.ru/post/312310/">Part 1 - Colocation</a> <br>  In continuation of <a href="https://habrahabr.ru/post/312496/">Part 2 - Hermoson</a> </blockquote><br>  Hello!  Judging by the reviews, letters and comments to the past two parts of our article - you liked it, and this is important.  I remind you that we owe the construction of our own mini data center to the ‚Äúresidents‚Äù of Habr, it was you who helped us with the implementation of our ideas with our articles.  Therefore, this series of articles is grateful to users and commentators, from whose ideas we ‚Äúdrew‚Äù inspiration. <br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/10d/e3c/3b6/10de3c3b63cc70977fccd72e4f84866c.jpg" width="740"><br><a name="habracut"></a><br>  Just want to say.  We do not claim to be certified according to the TIER class (we simply cannot), we do not say that we have done something new or perfect, we only tell what we have done in a short period of time in less than 14 days with our needs and abilities.  Treat this article as a ‚Äúvisual food for the brain,‚Äù this is not ideal, it‚Äôs just the experience of one project that may help you avoid mistakes in your business.  We have not allowed them enough. <br><br>  So, let's begin.  We had literally a couple of days before the physical relocation of all the equipment, in our mini data center almost everything was ready, except for the main one ‚Äî the Internet channels.  We quickly agreed to connect two independent providers, but as we wrote earlier, they set deadlines for us, up to 6 months.  It turned out that we chose a place of deployment near a group of providers and complicated the broach only coordination with the owners of wells / supports. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After talking with the technical director of the first provider, we still persuaded him to do ‚Äúquickly‚Äù and submit a link as soon as possible.  The brigade left and literally the next day of signing the contract gave us optics (it was, by the way, about 100 meters).  I could not photograph the whole process, I traveled between data-cents, solved related issues. <br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/201/dda/5a7/201dda5a704405c8affe545ea06627be.jpg" width="740"><br><br>  The second provider had a central office in Kiev and this connected us hand and foot.  Sorry for the details, but without the central office they cannot even "sneeze", let alone stretch the cable.  We were announced the final term of 11 months and we finally numb.  After talking with the provider, the manager suggested a way out.  Namely - contractors.  They can stretch quickly and efficiently without additional papers (since they already have permission).  Contact them. <br><br>  Unlike the first provider (sewage), they offered to stretch along the ‚Äúairway‚Äù.  In general, we don‚Äôt care, this is a backup channel and we didn‚Äôt count on it, but its absence did not give us the opportunity to start, because  everything should be ‚Äúin mind‚Äù.  Paid, agreed - work went.  At first they offered to pull through the houses, then through the pillars, then through both, as a result, because of the creation of OSMD, they were forced to do only through the pillars (not to get to the roofs and not to agree) on the treetops jumping from branch to branch.  Indeed, this broach had to be seen, the guys risked their lives literally every second, pushing the cable through the tree, climbing on it without insurance and jumping onto the next one.  We must pay tribute to the guys - professionals. <br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/4bd/3f9/e5b/4bd3f9e5b5566a08fa67e2b78c349abe.jpg" width="740"><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/91f/20f/668/91f20f668e8be4b3b80f52cf0ec01c3a.jpg" width="740"><br><br>  And it would seem that everything, optics is laid out, there is a link on the first provider, on the second they still claim and wait for people at the ‚Äúbase station‚Äù to join in there, they said it was a question for 1-2 days.  We are generally satisfied and are thinking about moving. <br><br><h3>  Moving day </h3><br>  Probably the most difficult for us - it was to think about how to move with minimal downtime.  It turned out that we moved on Friday.  One of the hardest things to do is raise a BGP tunnel.  I will try to explain what it is on the fingers.  BGP - Border Gateway Protocol, a protocol by which one provider with its AS (autonomous network) communicates with another provider and with its AS (autonomous network).  Roughly speaking, this is a junction that allows you to transfer traffic from one provider to another and so along the chain. <br><br><img height="186" src="https://habrastorage.org/getpro/habr/post_images/58c/4c5/022/58c4c5022699f0aa41f0873d5dba1bda.png" width="555"><br><br>  The difficulty in this situation arose in the fact that at that time we had one AS to which our IPs were attached.  In order to change data from one provider to another, you first need to reconfigure the main router (our Cisco), and then also make changes to the RIPE and the provider.  Thus, it is impossible to do this before the move, everything will be laid down.  And to do in time - there are risks of big downtime.  Based on the fact that we moved according to plan - we warned all users in advance by mailing, on Twitter and on the forums.  Therefore, we decided to change the settings after the move.  But more about that later. <br><br>  So, we started to turn off the equipment.  We take out the glands. <br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/1d4/46c/b3a/1d446cb3abd47f7878a14cea852f90b7.jpg" width="740"><br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/036/e02/836/036e02836a2e0383955e6328551d6f8b.jpg" width="740"><br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/686/c38/c75/686c38c751ee2ca9a9220692aeb3d104.jpg" width="740"><br><br>  Wipe from dust. <br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/d54/144/bd6/d54144bd6b73a765ee2fd0a523997b8c.jpg" width="740"><br><br>  Considering that we drove there with three servers and added them little by little (carrying on hands on the 5-6 floor) - we didn‚Äôt know how much it would not just be disconnecting and carrying everything, because  servers at the time of the move was already 14 pieces, plus IBM IP-KVM.  But the blessing we brought along with the guys to help and another machine (because everything in my car would not fit). <br><br>  Having run between the floors several times, we realized that we wouldn‚Äôt let it all down, and asked to turn on the freight elevator (in order to turn it on you need to look for the building owner, take keys, arrange, etc.), in general it was just the case when it was needed.  Thanks for this guys. <br><br>  Junk has accumulated quite a bit, 14 servers, 1 client, PDU sockets, disks, and other stuff for SCS installation.  Loaded and go. <br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/64b/064/97c/64b06497c15a9e9ffc455e0b2378cc89.jpg" width="740"><br><br>  To go not so far, about 5-8 km, so we go slowly, carefully.  In our new mini-tsoda, colleagues are already waiting for us to unload and connect.  We arrived, unloaded the iron on the table. <br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/730/1e1/262/7301e126278d21e20e84987a0e238996.jpg" width="740"><br><br>  Began to engage in the installation of network equipment, its connection, broach and laying of cables.  For this case also bought lugs.  It is very convenient with them. <br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/730/1e1/262/7301e126278d21e20e84987a0e238996.jpg" width="740"><br><br>  We mount APC PDU (we managed to buy one managed one). <br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/3e3/5b7/f99/3e35b7f9900a464c853aef4fd00773d5.jpg" width="740"><br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/1d3/1b6/9dd/1d31b69ddd58a0a099b588f1aed5fb72.jpg" width="740"><br><br>  Begin to fill the cabinet. <br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/621/c93/6bb/621c936bb6847ca18852a50c83072516.jpg" width="740"><br><br>  Inserted glands, tsiska, while the test cable was thrown only to the tsiska. <br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/cd4/1aa/3c9/cd41aa3c929a36373a24db9997961411.jpg" width="740"><br><br>  Started to configure tsiska.  These were also those perversions. The monitor on the floor, the sistemnik on the chair, all in a ‚Äúsuspended‚Äù state.  Yes, it happens like that :) <br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/3be/8ab/d2a/3be8abd2a904f9f61f354e2a1e458bc7.jpg" width="740"><br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/87e/517/51f/87e51751f6e062fcf31cb14a9e90c4e9.jpg" width="740"><br><br>  While setting up a tsiska, we began a census of equipment, Cisco ports, and APC PDU ports.  This is a very important point, it helped us more than once. <br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/f9f/cd7/6c4/f9fcd76c42398163894cc3e79222e699.jpg" width="740"><br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/78a/065/a32/78a065a32564c351885d7e162f4d5026.jpg" width="740"><br><br>  It was already evening, 4 hours, maybe half past four ... it would seem that the main work was done .., but if we knew how wrong ... We started to lift the BGP tunnel (we received the settings in advance) - and the FIG ... Link is there, but he does not want to work.  The problem emerged quickly and turned out because of our inexperience.  We connected a gigabit link through optical fiber.  Our Cisco supports 2x10GB.  We boldly inserted optics into it (in fact, this is my joint, I did not consult with our admins, they scolded me for a long time) - and nothing.  It turned out that if the port is gigabit and the module is 10 gigabit, it will not work.  We started urgently calling the provider, asking for help, how and what to do ... but then it turned out that everyone had gone home (Friday, before the 3rd weekend and holiday) ... and we became stupor. <br><br>  There was an option to connect everything through a media converter (as we did in the future), optics is included - a twisted pair goes out, but we did not have it, and the shops were all closed, and they would start working only after 3 days.  I had to call those through friends.  director of the company, to tear his employee from home, so that he in the office took the module 10G for their site and connected.  And only then, our tsiska began to perceive the link adequately and it all worked (joint). <br><br>  We finished all the work and waited ... when the records, routes and everything were updated, and everything would work.  It was already 8 in the evening, everyone was tired, one guy was even called an ambulance, one of ours scratched his hand, and the other of the guys whom we called for help as a physical.  Strength - splashed from the sight of blood with his nose on the threshold and cut his chin. <br><br>  At about 3-4 o'clock in the morning, traffic began to rise slowly.  Everything worked, we ran and eliminated problems on the go.  But IPv6 did not work.  Neither in the morning, nor in a day ... When communicating with the provider, it turned out that the manager entered into an agreement (including on IPv6) without knowing that the provider physically does not have IPv6 networks, and even less the ability to route them.  It was a collapse.  But thanks again to the connection with those.  director of the provider, he found a way to ‚Äúpush‚Äù traffic past them through a neighboring provider with IPv6 and everything worked for us, though it was already a little late, some of the clients left us. <br><br>  Upon completion of all the work, our data center looked like this: <br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/1b4/faf/1b5/1b4faf1b59a8eab1c02b8a25c6ac778a.jpg" width="740"><br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/641/fb2/deb/641fb2debbcff9ba23b43b9d338c22d3.jpg" width="740"><br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/cf4/fc1/1b1/cf4fc11b1699a3602ca56b9468236aca.jpg" width="740"><br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/ca1/3c7/881/ca13c7881ba0772eaf955ffa100ea997.jpg" width="740"><br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/013/44f/8bf/01344f8bf544fcea9ce92df40dda7a6b.jpg" width="740"><br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/ecd/768/cb2/ecd768cb254ef22e5f83911b79f15959.jpg" width="740"><br><br><img height="555" src="https://habrastorage.org/getpro/habr/post_images/022/dcd/54c/022dcd54cea8c3996d5a838ed5b27d96.jpg" width="740"><br><br><img height="987" src="https://habrastorage.org/getpro/habr/post_images/10d/e3c/3b6/10de3c3b63cc70977fccd72e4f84866c.jpg" width="740"><br><br>  This is the end of our move.  As you can see, there were a lot of little things we didn‚Äôt think about right away, made a lot of mistakes for which we paid later.  We sincerely hope that this article will help to avoid our mistakes - to other people who try their luck in a similar matter. <br><br>  Well, as always, there is one nice bonus.  We plan to write a separate article on the financial part of our project (perhaps without specific numbers, but in a comparative analysis it will be clear).  From it you will understand what is cost-effective, what is not, where you can save and much more. <br><br>  We will also continue to publish articles on Habr√© about the work of our mini data center, about the difficulties that arise and about our innovations.  In one of the upcoming articles, you will see how we selected the "self-assembly" equipment for specific purposes and what we ultimately chose.  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/312870/">https://habr.com/ru/post/312870/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312856/index.html">New Intel RealSense SDK 2016 R2 Features</a></li>
<li><a href="../312858/index.html">Why do we spend $ 2 million a year at 99.99% accuracy in data processing at Dadat?</a></li>
<li><a href="../312862/index.html">Banks are adapting the blockchain faster than they could have imagined.</a></li>
<li><a href="../312864/index.html">How to reduce the response time to users in social networks?</a></li>
<li><a href="../312868/index.html">Video chat via browser. WebRTC is easy if there is a library</a></li>
<li><a href="../312872/index.html">Cremes rootkit scan</a></li>
<li><a href="../312874/index.html">Package for working with Firebird in Laravel</a></li>
<li><a href="../312876/index.html">Hybrid Android apps for kids</a></li>
<li><a href="../312878/index.html">ASP.NET Core: Creating your first web API using ASP.NET Core MVC and Visual Studio</a></li>
<li><a href="../312880/index.html">Math in javascript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>