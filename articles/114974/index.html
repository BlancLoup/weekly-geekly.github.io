<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Anonymous networks and timing attacks: Tor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction | Tor | Tarzan and MorphMix | Low-cost attack | Low-cost attack on Tarzan and Morphmix | Principles of building secure systems (conclusio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Anonymous networks and timing attacks: Tor</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/blogs/infosecurity/112860/">Introduction</a> |  Tor |  <a href="http://habrahabr.ru/blogs/infosecurity/117586/">Tarzan and MorphMix</a> |  <a href="http://habrahabr.ru/blogs/infosecurity/121078/">Low-cost attack</a> |  <a href="http://habrahabr.ru/blogs/infosecurity/121209/">Low-cost attack on Tarzan and Morphmix</a> |  <a href="http://habrahabr.ru/blogs/infosecurity/121210/">Principles of building secure systems (conclusion)</a> <br><br>  I present to you the second part of the translation of the remarkable article <a href="http://crpit.com/confpapers/CRPITV68Wiangsripanawan.pdf" rel="nofollow">Principles of building anonymizing systems with low latency opposing timing attacks</a> .  This chapter is entirely devoted to the currently most popular anonymizing <a href="http://www.torproject.org/" rel="nofollow">Tor network</a> . <br><br>  Do not be lazy to read the <a href="http://habrahabr.ru/blogs/infosecurity/112860/">introduction</a> . <br><a name="habracut"></a><br><hr><br><h2>  Tor </h2><br>  Tor, the second generation of Onion Routing, is a system of anonymous communication with low latency <sup>*</sup> based on chains of transmission nodes.  This is an improved version of Onion Routing.  Onion Routing (OR) is an anonymous communication system for tasks such as browsing the Internet, instant messaging and SSH.  To avoid the drawbacks and limitations of OR, the Tor developers have included several new features.  Here are some of them: perfect forward secrecy, congestion control, directory services, integrity checkin, configurable exit policies, rendezvous point, and hidden services.  Something that has been removed: mixing <sup>*</sup> and alignment of flows by traffic volume <sup>6</sup> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are three main actors in Tor: the Tor client, the Tor servers (nodes) and the stream receiver.  Logically, the Tor client is a sender who wants to anonymously contact the recipient.  In OR it was called Onion Proxy.  Tor servers are transfer nodes (Onion Routers in OR).  They transmit streams to the following nodes, following the instructions of the Tor client.  As in OR, the last node in the chain before the receiver is called the output node.  The recipient does not have to be part of the Tor network.  The output node acts as a transmission link between the open world (recipients) and the Tor network. <br><br>  As in OR, the Tor client chooses which Tor servers to include in the chain (the path in Tor is called the chain).  In OR, one chain can be used for only one TCP connection, Tor allows you to conduct many TCP connections on one chain.  Chains are determined in advance.  The main function of the Tor client is to define a chain and establish shared keys between the client and all intermediate nodes.  The keys will be needed later when the client starts sending network packets to the recipient and vice versa.  In Tor, the size of the chain is fixed and is 3 knots. <br><br>  When a client wants to anonymously send data to a recipient, for example, when a user opens a web site, the packet stream is divided into segments of fixed size - 512 bytes.  Then, with the help of predefined shared session keys, the segments are wrapped in encryption layers - for each transfer node (Tor server) its own layer.  This is done in such a way that when the Tor server expands its layer, it recognizes only the predecessor node and the next node in the chain.  Unlike OR, which provides for mixing, the Tor-packets entering the node (the ones with 512 bytes) are simply lined up and processed and sent in the ‚Äúfirst in, first out‚Äù mode. <br><br><br><img src="http://lh3.googleusercontent.com/_W11D2fUUV1g/TXIBEstKPRI/AAAAAAAAAD4/itrlzktCnEE/image05.png" alt="Tor"><br>  Figure 1. Tor Architecture <br><br><h4>  Tor Threat Model </h4><br>  The attacker's goal is to establish both the sender and the recipient.  Like all other real-life anonymizing networks with low latencies, Tor cannot protect against a global observer.  However, he successfully confronts the attacker who: <br><ul><li>  can observe part of the traffic between network nodes; </li><li>  can create, modify, delete or delay traffic; </li><li>  can create several own transmission nodes; </li><li>  may compromise (capture) several transmission units. </li></ul><br>  Attacks using traffic can be divided into two categories: traffic confirmation attacks (traffic confirmation attacks) and traffic analysis attacks.  In each category, attacks are divided into active and passive. <br><br>  Traffic confirmation attacks (attacks confirmation attacks) are attacks in which the attacker already has an assumption about the connection between the sender and the recipient, and he tests his guess using the traffic pattern <sup>*</sup> .  Suppose the attacker suspects that Alice is talking to Bob and wants to make sure of it.  As an example of a passive attack, you can give a situation where an attacker <br><ul><li>  monitors traffic at the two ends of the intended connection ‚Äî both on Alice‚Äôs side and Bob‚Äôs, </li><li>  and using measurements of the send / receive time or packet sizes at both ends, it checks its assumption. </li></ul><br>  If the attacker acts more actively, and not only observes, but also brings distinctive features to the traffic - marks the traffic (for example, creating artificial delays or otherwise changing its characteristics) - then this will be an example of an active attack. <br><br>  Traffic analysis attacks are attacks by which an attacker detects network nodes, to which traffic he should look at and try to use traffic identification attacks.  <sup>7</sup> For example, a passive attacker can monitor the edges of the network and try to find the relationship between the incoming and outgoing flows, relying in their guesses on the time of entry / exit of packets or their sizes.  Or, to act more actively - to introduce the characteristics of the stream, trying to simplify its identification at the exit from the network. <br><br><h4>  Tor and traffic analysis attacks </h4><br>  The Tor developers decided not to waste their forces on traffic detection attacks and focused only on traffic analysis attacks.  Due to the fact that the global observer is not part of the Tor threat model, some traffic analysis attacks may be ignored.  More information about how Tor is opposed to traffic analysis attacks can be found in Dingledine and Mathewson (Dingledine et al. 2004).  Also in (Dingledine et al. 2004), other attacks that are beyond the scope of this article, for example, attacks on directory services and meeting points (rendezvous point), are considered. <br><br><hr><br>  <b>Translator's Note</b> <br><br>  <sup>6</sup> Align traffic to traffic volume. <br><br>  For example, a user created five sharp bursts of traffic per second.  So that its stream does not stand out on load, traffic from empty packets is mixed into other streams. <br><br><br>  <sup>7</sup> Attacks to traffic identification are a special case of a traffic analysis attack. <br><br><br>  <sup>*</sup> See ‚ÄúAnonymous Low-latency Communication System‚Äù, ‚ÄúTraffic Blending‚Äù and ‚ÄúTraffic Pattern‚Äù in the <a href="http://habrahabr.ru/blogs/infosecurity/112860/">introduction</a> . </div><p>Source: <a href="https://habr.com/ru/post/114974/">https://habr.com/ru/post/114974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../114967/index.html">Selection of key phrases for narrow subjects</a></li>
<li><a href="../114969/index.html">In the shoes of a web developer</a></li>
<li><a href="../114970/index.html">LiveJournal distributes paid limited-use accounts (two weeks) ‚Äúto try‚Äù</a></li>
<li><a href="../114971/index.html">Why we started the countdown for Internet Explorer 6</a></li>
<li><a href="../114972/index.html">On the basis of the Lenovo laptop PC is created with the management of the eye</a></li>
<li><a href="../114975/index.html">Where do you bet {?</a></li>
<li><a href="../114976/index.html">Computer advises perfect makeup</a></li>
<li><a href="../114977/index.html">Conference Program on Wireless Technologies - BESSEDA-2011</a></li>
<li><a href="../114978/index.html">.Smallian pirates</a></li>
<li><a href="../114979/index.html">Amazon Mobile World</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>