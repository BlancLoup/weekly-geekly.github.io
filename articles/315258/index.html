<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Comparing objects by value - 4, or Inheritance & Equality operators</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous publication, we obtained an implementation variant of comparing objects by value for the .NET platform, using the example of the Perso...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Comparing objects by value - 4, or Inheritance & Equality operators</h1><div class="post__text post__text-html js-mediator-article"><h4 id="v-predyduschey-publikaciihttpshabrahabrrupost315168-my-poluchili-variant-realizacii-sravneniya-obektov-po-znacheniyu-dlya-platformy-nethttpswwwmicrosoftcomnet-na-primere-klassa-person-vklyuchayuschiy">  In the <a href="https://habrahabr.ru/post/315168/">previous publication,</a> we obtained an implementation variant of comparing objects by value for the <a href="https://www.microsoft.com/net">.NET</a> platform, using the example of the Person class, which includes: </h4><br><ul><li>  overlapping methods <a href="https://msdn.microsoft.com/library/system.object.gethashcode.aspx">Object.GetHashCode ()</a> , <a href="https://msdn.microsoft.com/library/bsc2ak47.aspx">Object.Equals (Object)</a> ; </li><li>  <a href="https://msdn.microsoft.com/library/ms131187.aspx">IEquatable</a> interface <a href="https://msdn.microsoft.com/library/ms131187.aspx">implementation (Of T)</a> ; </li><li>  implementation of the Type-specific static Equals (Person, Person) method and == (Person, Person),! = (Person, Person) operators. </li></ul><br><p>  Each of the comparison methods for any one and the same pair of objects returns the same result: </p><br><div class="spoiler">  <b class="spoiler_title">Code example</b> <div class="spoiler_text"><pre><code class="cs hljs">Person p1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Person(<span class="hljs-string"><span class="hljs-string">"John"</span></span>, <span class="hljs-string"><span class="hljs-string">"Smith"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(<span class="hljs-number"><span class="hljs-number">1990</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); Person p2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Person(<span class="hljs-string"><span class="hljs-string">"John"</span></span>, <span class="hljs-string"><span class="hljs-string">"Smith"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(<span class="hljs-number"><span class="hljs-number">1990</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-comment"><span class="hljs-comment">//Person p2 = new Person("Robert", "Smith", new DateTime(1991, 1, 1)); object o1 = p1; object o2 = p2; bool isSamePerson; isSamePerson = o1.Equals(o2); isSamePerson = p1.Equals(p2); isSamePerson = object.Equals(o1, o2); isSamePerson = Person.Equals(p1, p2); isSamePerson = p1 == p2; isSamePerson = !(p1 == p2);</span></span></code> </pre> </div></div><br><p>  At the same time, each of the comparison methods is commutative: <br>  x.Equals (y) returns the same result as y.Equals (x), etc. </p><br><p>  Thus, the client code can compare objects in any way - the result of the comparison will be determined. </p><br><h4 id="odnako-trebuet-raskrytiya-vopros">  However, the issue requires disclosure: </h4><br><p>  How exactly is the determinism of the result ensured when implementing static methods and comparison operators in the case of inheritance - taking into account the fact that static methods and operators do not have polymorphic behavior. </p><a name="habracut"></a><br><p>  For clarity, we present the Person class from the <a href="https://habrahabr.ru/post/315168/">previous publication</a> : </p><br><div class="spoiler">  <b class="spoiler_title">class Person</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">HelloEquatable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Person</span></span> : <span class="hljs-title"><span class="hljs-title">IEquatable</span></span>&lt;<span class="hljs-title"><span class="hljs-title">Person</span></span>&gt; { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetHashCodeHelper</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] subCodes</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>)subCodes == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || subCodes.Length == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result = subCodes[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; subCodes.Length; i++) result = <span class="hljs-keyword"><span class="hljs-keyword">unchecked</span></span>(result * <span class="hljs-number"><span class="hljs-number">397</span></span>) ^ subCodes[i]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NormalizeName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name</span></span></span><span class="hljs-function">)</span></span> =&gt; name?.Trim() ?? <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> DateTime? NormalizeDate(DateTime? date) =&gt; date?.Date; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> FirstName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> LastName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DateTime? BirthDate { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Person</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> firstName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lastName, DateTime? birthDate</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.FirstName = NormalizeName(firstName); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.LastName = NormalizeName(lastName); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.BirthDate = NormalizeDate(birthDate); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetHashCode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; GetHashCodeHelper( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.FirstName.GetHashCode(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.LastName.GetHashCode(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.BirthDate.GetHashCode() } ); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EqualsHelper</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Person first, Person second</span></span></span><span class="hljs-function">)</span></span> =&gt; first.BirthDate == second.BirthDate &amp;&amp; first.FirstName == second.FirstName &amp;&amp; first.LastName == second.LastName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Person other</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//if ((object)this == null) // throw new InvalidOperationException("This is null."); if ((object)this == (object)other) return true; if ((object)other == null) return false; if (this.GetType() != other.GetType()) return false; return EqualsHelper(this, other); } public override bool Equals(object obj) =&gt; this.Equals(obj as Person); public static bool Equals(Person first, Person second) =&gt; first?.Equals(second) ?? (object)first == (object)second; public static bool operator ==(Person first, Person second) =&gt; Equals(first, second); public static bool operator !=(Person first, Person second) =&gt; !Equals(first, second); } }</span></span></code> </pre> </div></div><br><h4 id="i-sozdadim-klass-naslednik-personex">  And create a class-successor PersonEx: </h4><br><div class="spoiler">  <b class="spoiler_title">class PersonEx</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">HelloEquatable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PersonEx</span></span> : <span class="hljs-title"><span class="hljs-title">Person</span></span>, <span class="hljs-title"><span class="hljs-title">IEquatable</span></span>&lt;<span class="hljs-title"><span class="hljs-title">PersonEx</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> MiddleName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PersonEx</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> firstName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> middleName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lastName, DateTime? birthDate </span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">firstName, lastName, birthDate</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.MiddleName = NormalizeName(middleName); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetHashCode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; GetHashCodeHelper( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.GetHashCode(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.MiddleName.GetHashCode() } ); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EqualsHelper</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonEx first, PersonEx second</span></span></span><span class="hljs-function">)</span></span> =&gt; EqualsHelper((Person)first, (Person)second) &amp;&amp; first.MiddleName == second.MiddleName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonEx other</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//if ((object)this == null) // throw new InvalidOperationException("This is null."); if ((object)this == (object)other) return true; if ((object)other == null) return false; if (this.GetType() != other.GetType()) return false; return EqualsHelper(this, other); } public override bool Equals(Person other) =&gt; this.Equals(other as PersonEx); // Optional overloadings: public override bool Equals(object obj) =&gt; this.Equals(obj as PersonEx); public static bool Equals(PersonEx first, PersonEx second) =&gt; first?.Equals(second) ?? (object)first == (object)second; public static bool operator ==(PersonEx first, PersonEx second) =&gt; Equals(first, second); public static bool operator !=(PersonEx first, PersonEx second) =&gt; !Equals(first, second); } }</span></span></code> </pre> </div></div><br><h4 id="v-klasse-naslednike-poyavilos-esche-odno-klyuchevoe-svoystvo-middlename-poetomu-pervym-delom-neobhodimo">  Another key property MiddleName appeared in the heir class.  Therefore, the first step is to: </h4><br><ul><li>  Implement the IEquatable (Of PersonEx) interface. </li><li>  Implement the PersonEx.Equals (Person) method, overlapping the inherited Person.Equals (Person) method (note that the latter was initially declared virtual to take into account the possibility of inheritance) and trying to cast the Person object to the PersonEx type. </li></ul><br><p>  (Otherwise, a comparison of objects that have all key fields equal, except MiddleName, will return the result of "objects are equal," which is not correct from an objective point of view.) </p><br><p>  Wherein: </p><br><ul><li>  The implementation of the PersonEx.Equals (PersonEx) method is similar to the implementation of the Person.Equals (Person) method. </li><li>  The implementation of the PersonEx.Equals (Person) method is similar to the implementation of the Person.Equals (Object) method. </li><li>  The implementation of the static protected-method EqualsHelper (PersonEx, PersonEx) is similar to the implementation of the EqualsHelper method (Person, Person);  to reuse code, the latter is used in the first method. </li></ul><br><h4 id="dalee-realizovan-metod-personexequalsobject-perekryvayuschiy-unasledovannyy-metod-equalsobject-i-predstavlyayuschiy-soboy-vyzov-metoda-personexequalspersonex-s-privedeniem-vhodyaschego-obekta-k-tipu-personex-s-pomoschyu-operatora-ashttpsmsdnmicrosoftcomlibrarycscsdfbtaspx">  Next, the PersonEx.Equals (Object) method is implemented, which overlaps the inherited Equals (Object) method and represents a call to the PersonEx.Equals method (PersonEx), casting the incoming object to the PersonEx type using the <a href="https://msdn.microsoft.com/library/cscsdfbt.aspx">as</a> operator. </h4><br><p>  It is worth noting that the implementation of PersonEx.Equals (Object) is not mandatory, since  in case of its absence and calling the client code of the Equals (Object) method, the inherited method Person.Equals (Object) would be called, which internally calls the <em>virtual</em> method PersonEx.Equals (Person), resulting in a call to PersonEx.Equals (PersonEx). <br>  However, the PersonEx.Equals (Object) method is implemented for code "completeness" and greater speed (by minimizing the number of type conversions and intermediate method calls). </p><br><h4 id="drugimi-slovami-sozdavaya-klass-personex-i-nasleduya-klass-person-my-postupali-takim-zhe-obrazom-kak-pri-sozdanii-klassa-person-i-nasledovanii-klassa-objecthttpsmsdnmicrosoftcomlibrarysystemobjectaspx">  In other words, when creating the PersonEx class and inheriting the Person class, we acted in the same way as when creating the Person class and inheriting the <a href="https://msdn.microsoft.com/library/system.object.aspx">Object</a> class. </h4><br><p>  Now, no matter what method we called to the object of the class PersonEx: <br>  Equals (PersonEx), Equals (Person), Equals (object), <br>  for any one and the same pair of objects, the same result will be returned (when changing operands in some places, the same result will also be returned). <br>  Polymorphism allows for this behavior. </p><br><h4 id="takzhe-my-realizovali-v-klasse-personex-staticheskiy-metod-personexequalspersonex-personex-i-sootvetstvuyuschie-emu-operatory-sravneniya-personexpersonex-personex-i-personexpersonex-personex-takzhe-deystvuya-takim-zhe-obrazom-kak-i-pri-pri-sozdanii-klassa-person">  We also implemented the PersonEx static method PersonEx.Equals (PersonEx, PersonEx) and the corresponding comparison operators PersonEx. == (PersonEx, PersonEx) and PersonEx.! = (PersonEx, PersonEx) in the PersonEx class, also acting in the same way as when creating the class Person. </h4><br><p>  Using the PersonEx.Equals method (PersonEx, PersonEx) or the PersonEx. == (PersonEx, PersonEx) and PersonEx.! = (PersonEx, PersonEx) operators for any one and the same pair of objects will give the same result as using the Equals instance methods. class PersonEx. </p><br><h4 id="a-vot-dalshe-stanovitsya-interesnee">  But then it becomes more interesting. </h4><br><p>  The PersonEx class "inherited" from the Person class the static Equals method (Person, Person) and the corresponding comparison operators == (Person, Person) and! = (Person, Person). </p><br><h4 id="kakoy-rezultat-budet-poluchen-esli-vypolnit-sleduyuschiy-kod">  What result will be received if to execute the following code? </h4><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isSamePerson; PersonEx pex1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PersonEx(<span class="hljs-string"><span class="hljs-string">"John"</span></span>, <span class="hljs-string"><span class="hljs-string">"Teddy"</span></span>, <span class="hljs-string"><span class="hljs-string">"Smith"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(<span class="hljs-number"><span class="hljs-number">1990</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); PersonEx pex2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PersonEx(<span class="hljs-string"><span class="hljs-string">"John"</span></span>, <span class="hljs-string"><span class="hljs-string">"Bobby"</span></span>, <span class="hljs-string"><span class="hljs-string">"Smith"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(<span class="hljs-number"><span class="hljs-number">1990</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-comment"><span class="hljs-comment">//PersonEx pex2 = new PersonEx("John", "Teddy", "Smith", new DateTime(1990, 1, 1)); Person p1 = pex1; Person p2 = pex2; isSamePerson = Person.Equals(pex1, pex2); isSamePerson = PersonEx.Equals(p1, p2); isSamePerson = pex1 == pex2; isSamePerson = p1 == p2;</span></span></code> </pre> </div></div><br><p>  Although the Equals method (Person, Person) and the == (Person, Person) and! = (Person, Person) comparison operators are static, the result will always be the same as when you called the Equals method (PersonEx, PersonEx ), operators == (PersonEx, PersonEx) and! = (PersonEx, PersonEx), or any of the instance Equals virtual methods. </p><br><h4 id="imenno-dlya-polucheniya-takogo-polimorfnogo-povedeniya-staticheskie-metody-equals-i-operatory-sravneniya--i--na-kazhdom-iz-etapov-nasledovaniya-realizuyutsya-s-pomoschyu-ekzemplyarnogo-virtualnogo--metoda-equals">  To obtain this polymorphic behavior, the Equals static methods and the comparison operators "==" and "! =" Are implemented at each of the inheritance stages using the instance virtual Equals method. </h4><br><p>  Moreover, the implementation of the Equals method (PersonEx, PersonEx) and == (PersonEx, PersonEx) and! = (PersonEx, PersonEx) operators in the PersonEx class, as well as the PersonEx.Equals (Object) method, is optional. <br>  The Equals method (PersonEx, PersonEx) and operators == (PersonEx, PersonEx) and! = (PersonEx, PersonEx) are implemented for code ‚Äúcompleteness‚Äù and faster performance (by minimizing the number of type conversions and intermediate method calls). </p><br><p>  The only obscure point in the "polymorphism" of static Equals, "==" and "! =" Is that if two objects of type Person or PersonEx are reduced to type <a href="https://msdn.microsoft.com/library/9kkx3h3c.aspx">object</a> , then the comparison of objects with the help of <a href="https://msdn.microsoft.com/library/53k8ybth.aspx">==</a> and <a href="https://msdn.microsoft.com/library/3tz250sf.aspx">! =</a> Operators will be done by reference , and using the <a href="https://msdn.microsoft.com/library/w4hkze5k.aspx">Object.Equals (Object, Object)</a> method - by value.  But this is a ‚Äúby design‚Äù platform. </p><br><h4 id="v-prodolzheniihttpshabrahabrrupost315622-rassmotrim-osobennosti-realizacii-sravneniya-po-znacheniyu-dlya-obektov---ekzemplyarov-strukturhttpsmsdnmicrosoftcomlibraryah19swz4aspx-a-takzhe-pogovorim-o-keysah-kogda-deystvitelno-celesoobrazno-realizovyvat-dlya-svoih-tipov-sravnenie-obektov-po-znacheniyu-i-kak-eto-delat-v-tch-s-predmetnoy-tochki-zreniya">  In the <a href="https://habrahabr.ru/post/315622/">continuation,</a> we will consider the features of the implementation of comparison by value for objects - instances of <a href="https://msdn.microsoft.com/library/ah19swz4.aspx"><em>structures</em></a> , and also talk about cases when it is really advisable to implement for their types comparison of objects by value, and how to do it, incl.  from the subject point of view. </h4></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/315258/">https://habr.com/ru/post/315258/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315246/index.html">Repair a damaged NTFS partition if it has been reduced to the minimum size (0 bytes free)</a></li>
<li><a href="../315248/index.html">Connect (); // 2016: Program, Live Broadcast and Bonus</a></li>
<li><a href="../315252/index.html">Creating a blog engine with Phoenix and Elixir / Part 3. Add roles</a></li>
<li><a href="../315254/index.html">Simple migrations with PHPixie Migrate</a></li>
<li><a href="../315256/index.html">A smart reference for css-properties for a beginner</a></li>
<li><a href="../315260/index.html">A little bit about empty interfaces. Quick look inside</a></li>
<li><a href="../315262/index.html">MegaFon Laboratory: How a Mobile Operator Tests a Technique</a></li>
<li><a href="../315264/index.html">We learn the current weather and forecast with a simple Python script</a></li>
<li><a href="../315266/index.html">Telnet and botnet</a></li>
<li><a href="../315268/index.html">Sculpt microservice</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>