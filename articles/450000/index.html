<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>(Left to right (Through the Looking Glass)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It seems that something is wrong with the title? This is one of the problems web developers face when adding support for languages ‚Äã‚Äãsuch as Arabic. I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>(Left to right (Through the Looking Glass)</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/690/580/8e0/6905808e0ef7bce14dcf1c451bb8db79.png"></div><br>  It seems that something is wrong with the title?  This is one of the problems web developers face when adding support for languages ‚Äã‚Äãsuch as Arabic.  In this article, we‚Äôll tell you about the problems we encountered and the solutions we‚Äôve come up with to support the Arabic language in the Spotify desktop client and the web player. <br><br>  Localization in Spotify is important.  Our mission is to ‚Äúunleash the potential of human creativity, giving millions of musicians the opportunity to earn their art for a living, and billions of fans to enjoy and be inspired by them.‚Äù  To achieve this mission, it is important that users from different countries can effectively communicate in their languages.  We recently launched Spotify in North Africa and West Asia.  One of the languages ‚Äã‚Äãin these regions is Arabic.  Unlike English, Arabic is read from right to left.  This affects websites that want to support Arabic. <br><a name="habracut"></a><br><h1>  Table of contents </h1><br><ul><li>  <a href="https://habr.com/ru/post/450000/">Mirror Layout</a> <br></li><li>  <a href="https://habr.com/ru/post/450000/">English language RTL</a> <br></li><li>  <a href="https://habr.com/ru/post/450000/">Arabic letter</a> <br></li><li>  <a href="https://habr.com/ru/post/450000/">Quality standards</a> <br></li><li>  <a href="https://habr.com/ru/post/450000/">Useful sources</a> </li></ul><br>  In the article we will use the following abbreviations: <br><br>  <b>LTR</b> (Left To Right): text that is read from left to right, for example, English or Spanish. <br>  <b>RTL</b> (Right To Left): text that is read from right to left, for example, Arabic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="1"></a><h1>  Mirror Layout </h1><br>  Right-to-left in Arabic is distributed not only the text, but the whole page layout.  For example, you should turn the image indicating the direction.  We are faced with a few exceptions, which will be discussed below in the icon section. <br><br><h3>  How dir attribute works </h3><br>  The direction of the text in the element to the browser is reported by the <code>dir</code> attribute.  To set the global page direction, you must set the <code>dir</code> attribute for the entire page. <br><br>  Attribute values: <br><br><ul><li>  <b>ltr</b> - used to write from left to right (for example, English, Swedish).  This is the default value. <br></li><li>  <b>rtl</b> - used for writing from right to left (for example, Arabic, Hebrew, Persian). <br></li><li>  <b>auto</b> - used for dynamic content.  The browser itself chooses the direction.  <a href="http://unicode.org/reports/tr9/">Unicode Bidirectional Algorithm is</a> used to process elements and determine direction.  See details in the section <a href="https://habr.com/ru/post/450000/">‚ÄúEnglish in RTL format‚Äù</a> . </li></ul><br><h3>  CSS </h3><br>  Both the CSS Flexbox and CSS Grid look at the <code>dir</code> attribute to determine the direction of the element.  For example, <code>flex-start</code> automatically switches to RTL when the <code>dir</code> attribute is set to <code>"rtl"</code> . <br><br>  But the <code>dir</code> attribute using flexbox or grid may not be enough to reflect the entire user interface on RTL.  There are too many asymmetric CSS properties that need to be followed when designing a website that supports both LTR and RTL.  For example, <code>margin-left: 20px</code> and <code>text-align: right</code> in RTL will change and become <code>margin-right: 20px</code> and <code>text-align: left</code> . <br><br>  There are many tools to automate this work.  We chose <a href="https://github.com/vkalinichev/postcss-rtl">PostCSS-RTL</a> , which at the assembly stage generates RTL rules with ‚Äúinverted‚Äù properties. <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.foo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">margin-left</span></span>: <span class="hljs-number"><span class="hljs-number">15px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">text-align</span></span>: right; <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: rebeccapurple; }</code> </pre> <br>  <i><font color="gray">CSS input</font></i> <br><br><pre> <code class="css hljs"><span class="hljs-selector-attr"><span class="hljs-selector-attr">[dir]</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.foo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: rebeccapurple; } <span class="hljs-selector-attr"><span class="hljs-selector-attr">[dir="ltr"]</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.foo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">margin-left</span></span>: <span class="hljs-number"><span class="hljs-number">15px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">text-align</span></span>: right; } <span class="hljs-selector-attr"><span class="hljs-selector-attr">[dir="rtl"]</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.foo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">margin-right</span></span>: <span class="hljs-number"><span class="hljs-number">15px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">text-align</span></span>: left; }</code> </pre> <br>  <i><font color="gray">CSS output</font></i> <br><br><h3>  Icons </h3><br>  Icons and items that are directional or related to progress should be converted to RTL.  For example, the back and forth navigation buttons must be swapped. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc6/da3/296/bc6da3296a68dd91614e5f75ef74ab02.png"></div><br>  <i><font color="gray">Back button in LTR</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/58d/da3/d10/58dda3d10386bc3b5a4274e053a2f605.png"></div><br>  <i><font color="gray">Back button in RTL (English text is used instead of Arabic)</font></i> <br><br>  All animations with the direction of movement must also be flipped.  For example, carousels should slide in the other direction. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b9e/21c/898/b9e21c8982c169d580dcdf5a596d3da8.gif"><br><br><h3>  Exceptions </h3><br>  Initially, we assumed that everything would be mirrored.  But pretty quickly saw some exceptions.  For example, the media playback buttons and the progress bar do not require mirroring, as they relate to the direction of the tape being played.  Arabic-speaking users expect playback controls and a progress bar to look the same as in LTR. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/763/fd0/71c/763fd071c996cd935e770f4cdab98b15.png"></div><br>  <i><font color="gray">LTR play indicator</font></i> <br><br><a name="2"></a><h1>  English language RTL </h1><br>  Often, LTR and RTL texts are mixed on one page.  Spotify has over 40 million songs by musicians from around the world and more than 3 billion playlists.  Content is presented in many languages ‚Äã‚Äãfor users from all over the world.  Therefore, in Spotify clients, LTR and RTL content is often mixed. <br><br><h3>  (Hello (World: the problem of punctuation and brackets </h3><br>  One of the first problems we encountered was this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/125/395/e5a/125395e5a4ae0d889f47bcd21fa32dda.png"></div><br>  <i><font color="gray">Problem brackets</font></i> <br><br>  This happens because the browser sets the base text direction based on the value of the <code>dir</code> attribute of our element.  Punctuation marks, such as <code>( ) . !</code> <code>( ) . !</code>  and the rest are not described by the direction in Unicode.  They inherit the base text direction. <br><br>  The bidirectional Unicode Bidirectional Algorithm considers each character in the string from right to left.  As an example, take the string <code>"Hello (World)"</code> on the page. <br><br><ul><li>  The algorithm starts parsing the string on the right.  He sees the non-directional symbol <code>)</code> , so he looks at the basic direction of the text and sees that the text is going from right to left.  The algorithm decides to move <code>)</code> to the beginning of the line. <br><br><pre>  ‚ÄúHello (World)‚Äù -&gt; ‚Äú(Hello (World‚Äù </pre></li><li>  The algorithm sees <code>d</code> with the direction of the LTR.  It does not need to be moved.  The same applies to other English characters up to <code>(</code> . <br></li><li>  The algorithm sees <code>(</code> without direction. He remembers the prevailing base direction (specified by the previous character <code>W</code> ) from left to right. The algorithm decides not to move <code>(</code> . The same applies to the space and all the characters in <code>"Hello‚Äù</code> </li></ul><br>  For more information on how Unicode Bidirectional Algorithm works, see <a href="https://www.w3.org/International/articles/inline-bidi-markup/uba-basics">here</a> . <br><br>  As a result, we get the string <code>"(Hello (World"</code> . We solved this problem by specifying the <code>auto</code> value for the <code>dir</code> attribute in all dynamic content, for example, in artist names, album and song names. This isolates the content and sets the base direction in accordance with the first a strongly typed direction symbol. In this case, the non-directional characters will always inherit the direction from the surrounding characters, not the page. Therefore, the string <code>"Hello (World)"</code> obtained. To maintain the correct alignment, use the attribute only for embedded  inline elements, otherwise you have to add the <code>text-align</code> property to the elements. <br><br><h3>  ... ello World: truncation problem </h3><br>  Mixed content also presents a problem if you want to add a truncation that does not fit the element. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2a9/3c8/c5d/2a93c8c5d2e5e2c80b3d77fe1ce38ed6.png"></div><br>  <i><font color="gray">LTR UI: Arabic text truncated from the wrong side</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/64f/30f/35b/64f30f35b62b928880ef8f0eceaff04d.png"></div><br>  <i><font color="gray">RTL UI: English text truncated from the wrong side</font></i> <br><br>  Truncation occurs on the wrong side, because the browser sets the direction of the text from the <code>dir</code> attribute.  The problem is solved by the setting of the attribute <code>"auto"</code> for the element with truncated text. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a17/e57/60a/a17e5760ae0395cee1f63f9bc19b1c2f.png"></div><br>  <i><font color="gray">LTR UI: Arabic text truncated to the right</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ca4/ba0/749/ca4ba0749c6f6f6146c61d3da5bcec80.png"></div><br>  <i><font color="gray">RTL UI: English text truncated from the right side</font></i> <br><br><a name="3"></a><h1>  Arabic letter </h1><br>  When developing a multilingual UI, it is important to ensure that the interface works correctly for all alphabets.  Here, in brief, what you need to check when adding Arabic. <br><br><h4>  Intercharacter spacing </h4><br>  Arabic writing is a ligature.  Most, if not all, characters in a word are related to each other.  For this reason, do not use the character spacing in Arabic.  He breaks the symbols, breaking the natural ligature. <br><br><h4>  Font size </h4><br>  Arabic characters typically have more complex glyphs than English characters.  There are more lines and nuances that should fit into the same space.  Because of this, Arabic writing with the same font size is less legible than English.  Characters too small.  We decided to increase the minimum font size in Arabic from 11 to 12px.  We also made sure that the font does not complicate Arabic glyphs.  A good choice would be <a href="https://www.google.com/get/noto/">Google Noto</a> , which is more legible than Arial ‚Äî the default backup font for Arabic in the browser. <br><br><h4>  Vertical Trimming </h4><br>  Some Arabic letters are higher than English.  This can lead to vertical clipping of characters.  Perhaps for Arabic you will need to increase the line spacing (line-height). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/abf/2be/34a/abf2be34a6d8dd423878c1ee6d009592.png"></div><br>  <i><font color="gray">Vertical Trimming</font></i> <br><br><h4>  Capital letters </h4><br>  In Arabic, there are no capital letters, so it makes no sense to highlight something in capital letters on the page. <br><br><h4>  Arabic commas </h4><br>  In many languages, comma is used,.  In Arabic, another delimiter: <code>ÿå</code> . <br><br>  We have often encountered the command <code>array.join(', ')</code> in the code.  To support different delimiters depending on the user's language settings, we added the <code>getSeparator()</code> method. <br><br><h4>  Arabic numbers </h4><br>  Arabic language two numeral systems <br><br><ul><li>  Western Arabic numerals: 0 1 2 3 4 5 6 7 8 9 <br></li><li>  Eastern Arabic numerals: Ÿ© Ÿ£ Ÿ§ Ÿ• Ÿ¶ Ÿß Ÿ® Ÿ° Ÿ¢ Ÿ† </li></ul><br>  Select one system and use it consistently throughout the application.  We chose Western Arabic numerals. <br><br><h4>  Transparent text color </h4><br>  Arabic glyphs may overlap.  Transparent text color does not work, because overlapping parts do not get the expected transparency.  The solution to the problem is completely opaque color and opacity for the text element. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/048/377/e20/048377e20bf912c0ea94b7fbd0ff2e35.png"></div><br>  <i><font color="gray">Transparency problem</font></i> <br><br><a name="4"></a><h1>  Quality standards </h1><br>  Here are some things we have done to qualitatively introduce the Arabic language: <br><br><ul><li>  Test sessions in a team <br></li><li>  Beta test with Arabic speaking staff <br></li><li>  Test UI and transfers by external agencies. </li></ul><br>  To ensure the quality of the Arabic UI, some tools were needed. <br><br>  We decided to create a GitHub bot.  It publishes comments on pull requests that correspond to potential problems.  The comment does not impose anything: it is just a reminder to check how the change will affect the Arabic language, with reference to the testing instructions.  The bot comments on the modified lines corresponding to the fill, intersymbol spacing, conversions, etc. The CSS code is converted by PostCSS-RTL, so it is usually enough to look at the change in Arabic and make sure it looks good.  CSS properties can be set via JS, but PostCSS-RTL does not convert JS.  Bot also checks the JS-files and comments on them, too, if there are relevant properties. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d70/563/b9e/d70563b9ec3e074981f05550c90219ec.png"></div><br>  <i><font color="gray">Comment tob-bot</font></i> <br><br><h1>  Useful sources </h1><br><ol><li>  <a href="https://material.io/design/usability/bidirectionality.html">Material Design - bidirectional</a> </li><li>  <a href="https://www.w3.org/International/techniques/authoring-html">Internationalization Methods: HTML &amp; CSS Authoring</a> </li><li>  <a href="https://www.w3.org/TR/i18n-html-tech-bidi/">HTML authoring: right to left writing</a> </li><li>  <a href="https://w3c.github.io/alreq/gap-analysis/">Comparative analysis of Arabic and Persian languages</a> </li><li>  <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl">ECMAScript Internationalization API</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/450000/">https://habr.com/ru/post/450000/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449996/index.html">Understanding the FFT algorithm</a></li>
<li><a href="../449998/index.html">FAQ: what a traveler should know about vaccinations before the trip</a></li>
<li><a href="../45/index.html">Ratings for comments.</a></li>
<li><a href="../450/index.html">Changes in the search interface Webalta</a></li>
<li><a href="../4500/index.html">Mark Kyuban about creating GooTube: this is crazy</a></li>
<li><a href="../450004/index.html">Fast C / C ++ cache, thread safety</a></li>
<li><a href="../450006/index.html">Chiller cooling data center: which coolant to choose?</a></li>
<li><a href="../450010/index.html">Photo storage, backup and cataloging</a></li>
<li><a href="../450016/index.html">Creating a system of formal verification from scratch. Part 1: symbolic virtual machine in PHP and Python</a></li>
<li><a href="../450018/index.html">Mathematical duet mapped an infinite area of ‚Äã‚Äãminimal surfaces</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>