<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We distribute 3G Internet throughout the apartment (Anydata ADU-300A and D-Link DIR-320)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The only opportunity I have at home to go online is to connect to a wireless CDMA Wellcom (a local analogue of SkyLink). And since there are several c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We distribute 3G Internet throughout the apartment (Anydata ADU-300A and D-Link DIR-320)</h1><div class="post__text post__text-html js-mediator-article">  The only opportunity I have at home to go online is to connect to a wireless CDMA Wellcom (a local analogue of SkyLink).  And since there are several computers, it is advisable to distribute this very Wellcom to everyone, independently of each other.  An excellent solution is to use a D-Link DIR-320 wi-fi router with a USB port, with an alternative firmware that allows you to connect a AnyData ADU-300A USB modem to it. <br><br>  Theoretically, this question has already been repeatedly discussed in the vast expanses of the network, but I decided to reduce everything into one ‚Äúinstruction for the lazy.‚Äù <br><a name="habracut"></a><br><ul><li>  After the initial switch-on of the router, it was registered in my home LAN with the address 192.168.0.1.  Set the IP address of the computer network card to 192.168.0.2.  We connect the router with the supplied cord to the network card of the computer.  It is important - everything else, if suddenly it is, disconnect from the router! </li><li>  Downloading the <a href="http://narod.ru/disk/15443613000/WL500gpv2-1.9.2.7-d-r566.7z.html">firmware</a> I tested, which is <a href="http://wl500g.info/showthread.php%3Ft%3D17641%26langid%3D3">Oleg‚Äôs firmware</a> version.  Rename it to <i>firmware.bin</i> </li><li>  Download <a href="http://narod.ru/disk/15438756000/tftp2.7z.html">tftp2.exe</a> .  We start, specify in the settings the address of the router (192.168.0.1, do not forget?) And the path to the firmware.  The path must not have spaces and other than English characters.  I put everything in c: \ temp and ran it from there. </li><li>  Turning off the power of the router.  Clamp reset. </li><li>  Without releasing the reset, we turn on the power of the router and wait for the indicator to appear, a ‚Äúcloud‚Äù of the network device connection. </li><li>  Let's release the reset and at the same time click on the ‚ÄúUpgrade‚Äù button in the tftp2 program.  From the first time it is not always possible to do it on time, you need to practice. </li><li>  In case of a hit, we observe frequent flashing of the LAN indicator (~ 3-4 sec). </li><li>  We are waiting for about 5 minutes while the firmware is ‚Äúdeployed‚Äù, then the ‚Äústatus‚Äù indicator will light up. </li><li>  We set the IP of the network card of the computer to automatically obtain the address. </li><li>  We come into a router under the telnet protocol (address 192.168.1.1) login / pass: admin / admin.  To work with telnet under Windows, I recommend using putty. </li></ul><br> <code>c:\&gt; telnet 192.168.0.1 <br> Login: admin <br> Password: admin <br></code> <br>  Further we exercise in the console of the Telnet session (better through copy / paste, so as not to be mistaken in writing).  First we need to determine the vendor and product code for our modem.  For each device they are unique.  In an open telnet session, we give the command: <br><br>  <code>$tail -f /usr/tmp/syslog.log</code> - we look at the system kernel logs in real time. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now we insert the modem into the USB port of the router and watch what is happening.  Something similar should appear on the screen: <br><br> <code>Okt 29 05:02:09 kernel: hub.c: new USB device 00:03.0-1, assigned address 2 <br> Okt 29 05:02:09 kernel: usb.c: USB device 2 (vend/prod 0x16d5/0x6506) is not claimed by any active driver.</code> <br> <br>  We write down the parameters vendor and product.  Exit by Ctrl-C. <br><br>  Check the launch of the modem port: <br><br> <code>$insmod usbserial vendor=0x16d5 product=0x6506 (     !) <br> <br> $ls -l /dev/usb/*</code> <br> <br>  That should appear on the screen like these lines: <br><br> <code>crw------- 1 admin root 188, 0 Okt 29 2009 0 <br> crw------- 1 admin root 188, 1 Okt 29 2009 1</code> <br> <br>  Fine!  We now have ports / dev / usb / tts / 0 and / dev / usb / tts / 1, of which we will need the first one - tts0. <br><br>  Now we add scripts for dialing ppp connections: <br><br>  Create the file / tmp / ppp / peers / dialup, but first the missing peers directory: <br><br> <code>$mkdir /tmp/ppp/peers</code> <br> <br>  Run the editor and use the usual "copy-paste": <br><br> <code>$vi</code> <br> <br>  In the vi editor, go to edit mode by pressing "i", and paste the code starting from the top left corner: <br><br> <code>debug <br> /dev/usb/tts/0 <br> 115200 <br> crtscts <br> noipdefault <br> ipcp-accept-local <br> lcp-echo-interval 60 <br> lcp-echo-failure 5 <br> usepeerdns <br> noauth <br> nodetach <br> mtu 1400 <br> mru 1400 <br> user 'cdma' <br> password 'cdma' <br> connect "/usr/sbin/chat -s -S -V -t 60 -f /tmp/ppp/dialup.chat 2 &gt; /tmp/chat.log"</code> <br> <br>  We press "Esc" and save to the file with the command <br><br> <code>:w /tmp/ppp/peers/dialup</code> <br> <br>  We leave from the editor <br><br> <code>:q</code> <br> <br>  To check, we can view the created file with the command: <br><br> <code>$cat /tmp/ppp/peers/dialup</code> <br> <br>  The result should be exactly the same as in the above lines: <br><br> <code>debug <br> /dev/usb/tts/0 <br> 115200 <br> crtscts <br> noipdefault <br> ipcp-accept-local <br> lcp-echo-interval 60 <br> lcp-echo-failure 5 <br> usepeerdns <br> noauth <br> nodetach <br> mtu 1400 <br> mru 1400 <br> user 'cdma' <br> password 'cdma' <br> connect "/usr/sbin/chat -s -S -V -t 60 -f /tmp/ppp/dialup.chat 2&gt;/tmp/chat.log"</code> <br> <br>  The following file /tmp/ppp/dialup.chat is similar to copy-paste: <br><br> <code>$vi <br> <br> '' '' <br> '' 'ATZ' <br> 'OK' 'ATD #777' <br> 'CONNECT' '' <br> <br> Esc -&gt; :w /tmp/ppp/dialup.chat -&gt; :q <br></code> <br>  result: <br> <code>$cat /tmp/ppp/dialup.chat <br> <br> '' '' <br> '' 'ATZ' <br> 'OK' 'ATD #777' <br> 'CONNECT' ''</code> <br> <br>  Add the created files to /tmp/local/.files with the commands: <br><br> <code>$echo /tmp/ppp/peers/dialup &gt; /tmp/local/.files <br> $echo /tmp/ppp/dialup.chat &gt;&gt; /tmp/local/.files</code> <br> <br>  Stored in the memory of the router <br><br> <code>$flashfs save &amp;&amp; flashfs commit &amp;&amp; flashfs enable</code> <br> <br>  And we overload the router with the command: <br><br> <code>$reboot</code> <br> <br>  Now you can smoke, and at the same time and test the performance of the connection before the final stage.  The dialer files have already been saved, you only need to manually start the modem port again. <br><br> <code>$insmod usbserial vendor=0x16d5 product=0x6506</code> <br> <br>  Now we can try to connect.  Please note that in our <i>dialup</i> script the <i>nodetach</i> parameter is <i>specified</i> , so we will remain in the open session until you press Ctrl-C.  Thus, it will be possible to see what happens in the process of dialing: <br><br> <code>$pppd call dialup</code> <br> <br>  After entering the command, something like this should happen in our Telnet terminal session: <br><br> <code>Script /usr/sbin/chat -s -S -V -t 60 -f /tmp/ppp/dialup.chat 2&gt;/tmp/chat.log finished (pid 162), status = 0x0 <br> Serial connection established. <br> using channel 2 <br> Using interface ppp0 <br> Connect: ppp0 &lt;--&gt; /dev/usb/tts/0 <br> ............................................................ <br> local IP address 10.50.29.187 <br> remote IP address 10.50.29.148 <br> primary DNS address 80.255.144.8 <br> secondary DNS address 80.255.1.9 <br> Script /tmp/ppp/ip-up started (pid 165) <br> Script /tmp/ppp/ip-up finished (pid 165), status = 0x0</code> <br> <br>  Now you can open the browser, ask Google for something (or Yandex, to taste), go to your favorite site ... You can also check the connection speed via <a href="http://www.testinternet.ru/">http://www.testinternet.ru/</a> or similar, to make sure that it does not lower than it was when connected directly to a computer. <br>  To end the connection, go back to the telnet window and press Ctrl-C. <br><br>  In order not to permanently register all these interesting and fascinating things every time the router is turned on, we will create a startup file for the modem port and the connection - / tmp / local / sbin / post-boot <br><br> <code>$mkdir /tmp/local/sbin</code> <br> <br>  Fill the startup file: <br><br> <code>$vi <br> <br> #!/bin/sh <br> insmod usbserial vendor=0x16d5 product=0x6506 <br> sleep 5 <br> pppd call dialup <br> <br> Esc -&gt; :w /tmp/local/sbin/post-boot -&gt; :q</code> <br> <br>  In order for our file to be executed by the system when it is loaded, we assign the execution attribute to it: <br><br> <code>$chmod +x /tmp/local/sbin/post-boot</code> <br> <br>  And do not forget to persist <br><br> <code>$flashfs save &amp;&amp; flashfs commit</code> <br> <br>  All is ready!  Reboot and try! <br><br> <code>$reboot</code> <br> <br>  To control the execution of commands, you can open a telnet session with the command: <br><br> <code>$tail -f /usr/tmp/syslog.log</code> <br> <br>  Enjoy the system! <br><br>  Important! <br>  The Vendor and Product codes in the article are for my modem!  Do not forget to change them for your devices! </div><p>Source: <a href="https://habr.com/ru/post/78195/">https://habr.com/ru/post/78195/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../78189/index.html">Integrating InfoSphere Warehouse data mining with IBM Cognos reports</a></li>
<li><a href="../78190/index.html">Keyboard fan</a></li>
<li><a href="../78191/index.html">Running with obstacles or creating one project</a></li>
<li><a href="../78192/index.html">Programmer and Antivirus II - end of story</a></li>
<li><a href="../78194/index.html">Hollywood Record Year</a></li>
<li><a href="../78196/index.html">iPhone for credit cards: a continuation of the story</a></li>
<li><a href="../78197/index.html">Video of Belarusian IT events in November. In open access</a></li>
<li><a href="../78199/index.html">KolibriOS 0.7.7.0 release</a></li>
<li><a href="../78201/index.html">Kievstar / DJuice, DoS attack my phone</a></li>
<li><a href="../78207/index.html">New Sberbank logo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>