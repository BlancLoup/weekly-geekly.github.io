<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>InterSystems iKnow. Part one. iKnow and beach holidays</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have long wanted to write my article on iKnow technology. Three years have passed since its appearance, but so far there have been no publications a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>InterSystems iKnow. Part one. iKnow and beach holidays</h1><div class="post__text post__text-html js-mediator-article">  I have long wanted to write my article on iKnow technology.  Three years have passed since its appearance, but so far there have been no publications about the applications of this technology in Russian-speaking solutions.  The explanation for this is quite simple - there was no full support for the Russian language.  But with each new release, starting with Cache 2013.1, the situation changed for the better.  And finally, we decided to implement the first project on iKnow.  How it was, what happened, and what did not, read later in my article. <br><a name="habracut"></a><br>  So, as I said, until now there were no applications and real Russian-language solutions created using iKnow, although support for the semantic model for the Russian language first appeared in version 2013.1.  At some point, it became clear that what works for Latin languages ‚Äã‚Äãis not suitable for Russian (as for all Slavic languages).  And the matter is that the variety of forms that one word can take.  When iKnow analyzes the text, the concepts are counted (here we can assume that the concept is a noun), and the concepts of ‚Äúapple‚Äù, ‚Äúapples‚Äù and ‚Äúapples‚Äù are completely different terms and they are counted separately.  According to this, for example, the recipe of cooking charlottes, iKnow will be able to understand as an article on the maintenance of electric ovens, because the term "oven" (turn on "oven", open "oven", turn off "oven", etc.) will appear more often in the text than the form of the word "apple" separately.  That was the difficulty.  The use of <a href="http://ru.wikipedia.org/wiki/%25D0%25BB%25D0%25B5%25D0%25BC%25D0%25BC%25D0%25B0%25D1%2582%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">lemmatization</a> , a tool for bringing the word to normal form, helped to cope with it. <br>  And so, in Cache 2015.1 FieldTest, there was support for lemmatization, implemented using the Hunspell library.  And this means that it became possible to create full-fledged applications for analyzing data from texts in Russian and Ukrainian.  And I immediately wanted to do something that would be an excellent practical example of the use of iKnow and not a useless analogue of the ‚ÄúHello world‚Äù.  And such a task was found! <br>  We were given a base of 27,000 reviews on the 100 most popular hotels in Turkey and Egypt.  The circle of priorities that were to be solved was immediately determined.  However, I will tell about everything in order. <br>  What is a tourist review.  First of all, this is unstructured data or text (the concept of ‚Äúunstructured text‚Äù, which many people like to use, seems meaningless to me).  People returning from a holiday (we considered a beach holiday), go to the portal, give ratings to the hotel in which they lived, or the categories of this hotel, such as service, food, hospitality, etc.  Then describe the rest in your own words, they note what was good and what was bad.  Numeric recreation scores (for example, on a five-point scale) are metadata that the portal administration can easily use to calculate hotel ratings.  But, often, people just write the text, and forget to rate.  There are quite a few such cases - in our project, more than half of the reviews contain only text, without numerical estimates.  It turns out that for rating such a review is useless.  This is the first task that had to be solved - to teach iKnow to calculate the hotel's rating solely on the text of a review. <br>  The remaining tasks were also formulated fairly quickly: <br><ul><li>  calculate the rating of individual categories of the hotel (comfort, service, food, hospitality, territory, location); </li><li>  to assess how much this calculation corresponds to the estimates that the authors of the reviews set themselves </li><li>  to synthesize the final phrase about the rest at the hotel (for example, ‚ÄúOf 653 guests at the hotel, 278 people (43%) noted the courtesy and friendliness of the staff, 220 holidaymakers (34%) liked the food in restaurants, and 76 guests (12%) would like to again rest here ‚Äù); </li><li>  learn to identify the most useful reviews in order to first of all offer them to portal visitors; </li><li>  find suspicious and customized reviews that are written for gingerbread for promotional purposes, and often have little to do with the sad reality; </li></ul>  There were other tasks, but I‚Äôll stop on the description of how I solved the above. <br>  Now I need to explain what <a href="">iKnow is</a> and what can be achieved from it without significant efforts.  iKnow is a technology that allows you to analyze texts.  iKnow API - a set of functions for working with unstructured data.  There is also a GUI that allows you to visualize the results of indexing texts and extract useful information from the data.  When we load something into iKnow, we have the same text as the output, but divided into <a href="">concepts</a> and connections between them.  Concepts in the proposals, as a rule, are the subject and additions.  Connections between concepts in most cases are verbs, verb forms or prepositions.  In addition, iKnow can carefully calculate how many times the term ‚Äúhotel‚Äù, ‚Äúsea‚Äù, ‚Äúbeach‚Äù or ‚Äúfood poisoning‚Äù is mentioned in a tourist review. <br><br><img src="https://habrastorage.org/files/df7/b60/349/df7b6034953743479b74e9a9ef5a943e.png" alt="image"><br>  Example of splitting a sentence into concepts and relationships.  Yellow highlighted concepts, underlined - relationships, gray marked insignificant words. <br><br>  What else we can get from the text depends mainly on our imagination, and a little more on the diversity of the iKnow API. <br>  How can I rate the hotel on the text of the review?  Below is one of the approaches for calculating the numerical characteristics of the text. <br>  The first thing to do is to break the whole text into parts.  iKnow API allows splitting into <a href="">offers</a> or <a href="">paths</a> .  With sentences everything is simple, it is a part of the text, bounded by dots, question or exclamation marks, as well as a semicolon.  The path is a part of a sentence in which interrelated concepts are presented.  In practice, in most cases, the paths and sentences are the same.  And only complex or complex sentences consist of several paths. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>The room found the ants promised in the reviews</b> , <i>called the reception desk and informed them about our problem.</i> <br><br>  All together this proposal, and in parts - the way. <br>  We divided the text into sentences. <br>  The second task is to understand what is being said in the proposal.  In other words, we need to determine which category of hotel is referred to in this proposal.  For this you will need dictionaries of so-called functional markers.  For example, if the sentence has the term ‚Äúrestaurant‚Äù, ‚Äújuice‚Äù, ‚Äútea‚Äù, then we are talking about the category ‚Äúfood‚Äù, and the terms themselves are included in the dictionary of markers for this category. <br><br>  <b><i>The drinks in the restaurant and bars include powdered juices, carbonated drinks, tea, instant coffee, wine and beer, and strong alcohol in bars.</i></b> <br><br>  Our functional marker dictionary contained about 300 terms specific to 6 rated hotel categories.  And what is important is that if there were no lemmatization, then for the system to work properly, it would be necessary to register all forms of these 300 words in the dictionary.  Yes, at first it is not an impossible task.  But if the dictionary will grow? <br>  At the first stage, the marker dictionaries were formed manually.  They included terms that were met when proofreading the first 200 reviews.  At the second stage, the dictionary expanded automatically with the help of a dictionary learning algorithm built using iKnow features.  As a result, the volume of the dictionary increased on average by an order of magnitude. <br>  Well, now we know what the sentence says.  It remains to be seen whether the author liked this or not.  In other words, it is required to determine the emotional color of the sentence.  For this, a dictionary of emotional markers was formed.  As a rule, in Russian emotional coloring is given by adjectives (delicious coffee, convenient entry into the sea, etc.).  We can also take into account the nouns that have a clear color (dirt, mass alcohol poisoning, joy). <br>  And now that ‚Äúmagic‚Äù begins, when numerical assessments, graphs and tables are formed from the text.  We can count the number of positive and negative terms in relation to hotel categories for each individual review, and then determine the proportion of positive.  For the calculation, I used the following formula: <br><br>  Score = positive / (positive N + negative) <br><br>  You get a number from 0 to 1. Moreover, the better the hotel, the closer this value is to 1. If you multiply this number by a certain factor, for example, 5, you can get a hotel rating on a five-point scale, which was done. <br>  The next task is to make sure that all this makes sense.  This was perhaps the key moment in the work.  To understand how much the estimates calculated with the help of iKnow correlate with the author's estimates, we built a graph, which includes all the hotels we rate. <br><br><img src="https://habrastorage.org/files/3f9/64b/310/3f964b31063941e5a0a370a5344c40d8.png" alt="image"><br>  Figure 1. Correlation of copyright and calculated ratings. <br><br>  The blue values ‚Äã‚Äãhere indicate the average values ‚Äã‚Äãof the author's hotel ratings, and the green calculated iKnow values.  As you can see, the correlation is clearly present.  And although it is early to draw final conclusions, it is already clear that this approach works and can be developed further.  Of course, a similar algorithm for quantifying hotels and their parameters works with a statistically large number of reviews: in our case, the estimates were formed with at least 20 reviews for each hotel.  By the way, I would like to note that to build analytics, I used another Intersystems technology - <a href="">DeepSee</a> . <br>  The following tasks that had to be solved - search for useful and customized reviews.  It's all pretty simple, you just need to formulate the appropriate criteria.  Here, for example, the criteria for the usefulness of the review: <br><ul><li>  The review describes the maximum number of hotel categories.  That is, you can read about the level of service, room comfort, quality of food, etc. </li><li>  feedback must be balanced emotionally.  There should not be only naked criticism or just a delighted description.  As a rule, people like some things, while others are unhappy with them.  That is, there must be both positive and negative emotional markers in the recall. </li><li>  Hotel rating, calculated on such a review, should be close to the average rating. </li></ul>  Similar criteria were formulated to assess the suspicion of reviews.  It should be noted that it is unequivocal to assert that a customized response would be too presumptuous for iKnow, but it is quite possible to call the review suspicious and draw the attention of the administrator of the tourist portal to it. <br>  Separately, I want to say about DeepSee, which supports the ability to use measurements and metrics on data from iKnow.  There are a lot of interesting, and most importantly, useful information for tourists, which can be obtained from reviews in addition to static ratings.  With the help of the analyzer, it was found that the estimates vary depending on the month, from year to year.  And all this is clearly seen on the DeepSee charts. <br><br><img src="https://habrastorage.org/files/093/ba3/caf/093ba3caf39240d6a7249be46a7e1ea6.png" alt="image"><br>  Figure 2. Monthly hotel rating change <br><br>  I will try to summarize the work done.  We managed to implement the first meaningful project on iKnow in Russian.  With enough imagination and wealth of the iKnow API, you can build quite complex solutions.  In the future, we plan to develop a review analyzer for hotels, into a universal tool, because there are a lot of reviews on the Internet: about movies, cars, phones, etc. <br>  But it would be wrong to talk only about the merits, without mentioning the problems that had to be faced.  There are two such problems: <br><ul><li>  processing negative sentences; </li><li>  imperfection of lemmatization. </li></ul> <a href="">Negative bid</a> handling first appeared in iKnow in version 2014.1.  But using it in a review analyzer is quite problematic.  How, for example, the system to evaluate this phrase: <br><br>  <i><b>I can not say that we did not like the beach.</b></i> <i><br><br></i>  or <br><br>  <b><i>The result, our personal rest, was WELL, but I would never go to this hotel again!</i></b> <b><i><br><br></i></b>  iKnow is able to find the presence of negation in a sentence, however, it is difficult to determine with certainty what exactly is negated.  This problem is especially characteristic of the Russian language, where there is no rigidly established word order in the sentence.  How to deal with such offers, you decide the options are: turn the assessment of emotional markers (multiply by -1), ignore such offers at all, or leave everything as it is.  In any case, this will lead either to a loss of information or to a loss of accuracy in the analysis of individual sentences.  And it is not at all clear how to analyze sarcasm. <br>  There is also a problem with lemmatization.  It is and works, but sometimes gives absolutely wonderful things.  For example, the prepositional case from a hotel noun ‚Äúabout a hotel‚Äù is referred to the livestock term ‚Äúcalving‚Äù, and ‚Äúgreen wild plum‚Äù is transformed into sanitary ‚Äúgreen wild plum‚Äù. <br>  However, I think we should be optimistic and believe that over time these problems will be solved.  Work on improving iKnow continues. <br>  This article has no technical details.  I will be happy to tell you about them and how to create your own iKnow-applications in the sequel. </div><p>Source: <a href="https://habr.com/ru/post/243217/">https://habr.com/ru/post/243217/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243207/index.html">Python implementation of the event-driven paradigm using coroutines</a></li>
<li><a href="../243209/index.html">Are you a pirate? Are you a pirate?</a></li>
<li><a href="../243211/index.html">Oil Rows in R</a></li>
<li><a href="../243213/index.html">Asterisk + Lua + regular update of DEF codes</a></li>
<li><a href="../243215/index.html">Internet Explorer: Moving to live Edge mode - the next step for the web to just work</a></li>
<li><a href="../243219/index.html">RFM analysis on the knee (Excel)</a></li>
<li><a href="../243221/index.html">Meeting of mobile game developers, November 27, Moscow</a></li>
<li><a href="../243225/index.html">What is silent technical task?</a></li>
<li><a href="../243227/index.html">Setting up automatic restart of Windows services in Nagios XI</a></li>
<li><a href="../243229/index.html">Analyze friendships VK using Python. Continuation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>