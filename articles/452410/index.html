<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Run bash in detail</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you found this page in the search, you are surely trying to solve a problem with running bash. 

 Perhaps bash does not set the environment variabl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Run bash in detail</h1><div class="post__text post__text-html js-mediator-article">  If you found this page in the search, you are surely trying to solve a problem with running bash. <br><br>  Perhaps bash does not set the environment variable in your environment and you do not understand why.  You may have stuck something in various bash boot files or profiles, or all files at random, until it worked. <br><br>  In any case, the point of this note is to explain how to start bash as easily as possible so that you can deal with the problems. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Diagram </h2><br>  This flowchart summarizes all the processes running bash. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c6d/dca/884/c6ddca8846f8c34fd80e003c91c4356b.png"><br><br>  Now take a closer look at each part. <br><a name="habracut"></a><br><h2>  Login Shell? </h2><br>  First you need to choose whether you are in the login shell (login shell) or not. <br><br>  The login shell is the first shell you get into when logging in for an interactive session.  The login shell does not require entering a username and password.  You can force the launch of the login shell by adding the <code>--login</code> flag when invoking <code>bash</code> , for example: <br><br><pre>  bash --login </pre><br>  The login shell sets up the base environment when the bash shell is first launched. <br><br><h2>  Interactive? </h2><br>  Then you determine whether the shell is interactive or not. <br><br>  This can be checked by the presence of the variable <code>PS1</code> (it sets the function to enter commands): <br><br><pre>  if ["$ {PS1-}"];  then
   echo interactive
 else
   echo non-interactive
 fi </pre><br>  Or see if the <code>-i</code> option is set using a special dash variable in bash, for example: <br><br><pre>  $ echo $ - </pre><br>  If in the output there is a symbol <code>i</code> , then the shell is interactive. <br><br><h2>  In the login shell? </h2><br>  If you are in the login shell, bash looks for the file <code>/etc/profile</code> and starts it if it exists. <br><br>  Then searches for any of these three files in the following order: <br><br><pre>  ~ / .bash_profile
 ~ / .bash_login
 ~ / .profile </pre><br>  When it finds one, it launches it and skips the others. <br><br><h2>  In an interactive shell? </h2><br>  If you are in an interactive shell without a login (non-login shell), it is assumed that you have already been in the login shell, the environment is configured and will be inherited. <br><br>  In this case, the following two files are executed in order, if they exist: <br><br><pre>  /etc/bash.bashrc
 ~ / .bashrc </pre><br><h2>  Neither option? </h2><br>  If you are neither in the login shell nor in the interactive shell, then your environment will really be empty.  This causes a lot of confusion (see below for cron tasks). <br><br>  In this case, bash looks at the <code>BASH_ENV</code> variable of your environment and executes the corresponding file that is listed there. <br><br><h2>  Typical difficulties and rules of thumb </h2><br><h4>  Cron jobs </h4><br>  <b>In 95% of cases, I debug bash startup due to the fact that the cron job does not work as expected.</b> <br><br>  This damned task <b>works fine when I run it on the command line, but it fails when I run it in crontab</b> . <br><br>  Here are <b>two reasons</b> : <br><br><ul><li>  Cron jobs are not interactive. <br></li><li>  Unlike scripts on the command line, cron jobs do not inherit the shell environment. </li></ul><br>  Usually you do not notice or care that the shell script is not interactive, because the environment is inherited from the interactive shell.  This means that all <code>PATH</code> and <code>alias</code> configured as you expect. <br><br>  This is why it is often necessary to set a specific <code>PATH</code> for the cron task, like this: <br><br><pre>  * * * * * PATH = $ {PATH}: / path / to / my / program / folder myprogram </pre><br><h4>  Scripts calling each other </h4><br>  Another common problem is when scripts are mistakenly configured to call each other.  For example, <code>/etc/profile</code> refers to <code>~/.bashrc</code> . <br><br>  Usually this happens when someone tried to correct a mistake and everything seemed to work.  Unfortunately, when you need to separate these different types of sessions, new problems arise. <br><br><h2>  Docker image in the sandbox </h2><br>  To experiment with running the shell, I created a Docker image that you can use to debug the shell launch in a safe environment. <br><br>  Run: <br><br><pre> <code class="bash hljs">$ docker run -n bs -d imiell/bash_startup $ docker <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> -ti bs bash</code> </pre> <br>  Dockerfile is <a href="https://github.com/ianmiell/bash_startup/blob/master/Dockerfile">here</a> . <br><br>  To force login and login shell simulation: <br><br><pre> <code class="bash hljs">$ bash --login</code> </pre> <br>  To check the <code>BASH_ENV</code> variable <code>BASH_ENV</code> : <br><br><pre> <code class="bash hljs">$ env | grep BASH_ENV</code> </pre> <br>  To debug a <code>crontab</code> simple script (in <code>/root/ascript</code> ) will be executed every minute: <br><br><pre> <code class="bash hljs">$ crontab -l $ cat /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/script.log</code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/452410/">https://habr.com/ru/post/452410/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../4524/index.html">Alexander Militsky told how providers sell subscribers</a></li>
<li><a href="../452400/index.html">Non-business</a></li>
<li><a href="../452402/index.html">Experiments with analog tunnel diode</a></li>
<li><a href="../452404/index.html">Five key ITSM trends for this year</a></li>
<li><a href="../452408/index.html">Toilet for Maine Coon</a></li>
<li><a href="../452412/index.html">Data Privacy, IoT and Mozilla WebThings</a></li>
<li><a href="../452414/index.html">HP Reverb - New VR Set Review</a></li>
<li><a href="../452416/index.html">Skeletal animation on the side of the video card</a></li>
<li><a href="../452418/index.html">How to make a product presentation that will involve the client?</a></li>
<li><a href="../45242/index.html">About PNG format. Short test drive</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>