<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Development of BPEL business process stubs based on Oracle SOA Suite and Weblogic</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, I‚Äôll explain how to implement BPEL business process web service stubs using Oracle SOA Suite and Weblogic server 
 Task 


 There is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Development of BPEL business process stubs based on Oracle SOA Suite and Weblogic</h1><div class="post__text post__text-html js-mediator-article"><p>  In this article, I‚Äôll explain how to implement BPEL business process web service stubs using Oracle SOA Suite and Weblogic server </p><br><h3>  Task </h3><br><p>  There is a project for load testing of one system.  In the scheme of interaction between servers, there are external systems that do not participate in the test object ‚Äî they must be replaced with emulators or plugs.  SOAP protocol.  Composites on BPEL.  There is no stand.  Terribly interesting! </p><br><p> <a href="http://habrahabr.ru/company/bellintegrator/blog/307132/"><img src="https://habrastorage.org/files/ae6/b61/c80/ae6b61c803164129907b8d53846684be.jpg"></a> <br></p><a name="habracut"></a><br><h3>  Decision </h3><br><p>  Well, I think everything is simple.  I will request WSDL, XSD schemas, examples of requests and responses.  I'll take my favorite Eclipse, Tomcat, quickly generate classes, insert an example of the answer, then deploy and check. </p><br><p>  Eclipse was very indignant: WSDL does not have the necessary information for the normal generation of classes.  I began to edit it, register the endpoint, but it still did not work.  Then I found out that this is a BPEL process, and it should be done differently. </p><br><p>  <abbr title="Business Process Execution Language">BPEL</abbr> itself is an XML-based language for formally describing business processes and protocols for their interaction with each other.  And Eclipse can do it all, there are plugins, there is an Apache ODE application server.  It seems that the project of a BPEL process in Eclipse must be collected manually; it does not create those files that are in the composite.  Import of the unloaded composite from the functional stand also does not work.  It was surprising if he imported the composite from Weblogic into Eclipse. </p><br><p>  I thought to do it the same way as in production: Oracle Database + Oracle Weblogic + Oracle SOA Suite, development in Oracle JDeveloper. </p><br><p>  Next, I will tell you about: </p><br><ul><li>  Unfolding your stand </li><li> <abbr title="MetaData Services">MDS</abbr> connection </li><li>  Import existing composite </li><li>  Cutting out a call to external systems </li><li>  Insert a successful response example </li><li>  Examples of the use of operators </li><li>  Adding to the composite a new web service </li><li>  Call Asynchronous Service </li><li>  Composite composite </li><li>  Modified composite check </li><li>  Analysis of problems during testing </li><li>  Monitoring and comments on work </li></ul><br><p>  BPEL is an XML-based language for the formal description of business processes and protocols for their interaction with each other. </p><br><p>  I must say that BPEL is quite a big and handy thing, allowing you to insert different operators, debag and pieces of code, such as Java. </p><br><p>  The business process looks like this: </p><br><p><img src="https://habrastorage.org/files/63d/da5/acb/63dda5acbd93458bbf49726319e7a36d.png"><br></p><br><p>  Let's turn our booth.  And so, what do we need and which versions: </p><br><ul><li>  JDK 1.7.79 </li><li>  Oracle Database 11g release 2 </li><li>  Oracle SOA Suite 11.1.1.7.0 </li><li>  Oracle RCU 11.1.1.7.0 </li><li>  Weblogic 10.3.6 </li><li>  JDeveloper 11.1.1.7.0 </li><li>  Ready business process composites </li><li>  MDS Archive </li><li>  Request and Answer Examples </li></ul><br><h4>  <b>Unfolding your stand</b> </h4><br><p>  Instructions for installing and configuring software </p><br><div class="spoiler">  <b class="spoiler_title">Weblogic installation</b> <div class="spoiler_text"><ol><li><p>  Run the installer. </p><br><pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">java</span></span> -jar wls1036_generic.jar</code> </pre> <br></li><li><p>  Select the path for the home folder. <br><br><img src="https://habrastorage.org/files/17f/8a9/0a7/17f8a90a7c7a4bbe90b425497daf8392.png"><br></p><br></li><li><p>  Skip registration for updates. <br><br><img src="https://habrastorage.org/files/ce3/d43/cb2/ce3d43cb2cac46628111fa33e4207d5c.png"><br></p><br></li><li><p>  Choose a typical installation. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/0b9/f8e/727/0b9f8e72764f4a36b8e2ccff55b229e9.png"><br></p><br></li><li><p>  Specify the folder with the JDK. <br><br><img src="https://habrastorage.org/files/dd2/2ef/ea2/dd22efea2dd04e3685168321fabe2dc3.png"><br></p><br></li><li><p>  Next, we specify the folder where to put Weblogic. <br><br><img src="https://habrastorage.org/files/cff/598/1a3/cff5981a3763459587a7c322d2677d66.png"><br></p><br></li><li><p>  Installation and greetings. </p><br></li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Oracle installation</b> <div class="spoiler_text"><p>  There is nothing difficult in the installation, I‚Äôll dwell only on some moments. <br>  Let's skip the minimum requirements and set up Oracle Database 11g Release 2 x32 for Windows, choose Desktop Class.  We have enough for development. <br>  On the Internet, including on Habr√©, there are many articles on installation.  I will note only installation under the local administrator and the task of environment variables.  Although the error with the absence of ORACLE_UNQNAME did not prevent and everything started. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/files/c31/138/f3a/c31138f3a4a644eb8db97844d322b2de.png"></div><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Install SOA Suite</b> <div class="spoiler_text"><ol><li><p>  To run the installer, you must specify the path to the JRE or JDK. </p><br><pre> <code class="hljs tex">ofm_soa_generic_11.1.1.7.0/Disk1/setup.exe -jreLoc c:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Oracle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Middleware</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jdk</span></span></span></span>160_24</code> </pre> <br></li><li><p>  Skip the update software. <br><br><img src="https://habrastorage.org/files/529/5cb/5b1/5295cb5b1f8e468bb590c3d94d96a4c2.png"><br></p><br></li><li><p>  Checking the operating system and physical memory in case of an error can be ignored. <br><br><img src="https://habrastorage.org/files/f1c/6a4/0cd/f1c6a40cd25b4a05b0b01fc93e2127d5.png"><br></p><br></li><li><p>  Choosing Middleware Home and the directory name for our SOA. <br><br><img src="https://habrastorage.org/files/027/fab/cea/027fabcea41946208f8def576cab33fe.png"><br></p><br></li><li><p>  Next, the installer found Weblogic in the home folder. <br><br><img src="https://habrastorage.org/files/7cf/3f7/90b/7cf3f790b49340ffa375ab5569fde407.png"><br></p><br></li><li><p>  Installation and greetings.  Check the connection. </p><br><pre> <code class="hljs kotlin">sqlplus <span class="hljs-symbol"><span class="hljs-symbol">sys@</span></span>ORCL <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sysdba</code> </pre> <br></li><li><p>  Or run SQL Developer and set up the connection. </p><br><pre> <code class="hljs tex">c:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">app</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">admin</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">product</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span></span>11.2.0<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dbhome</span></span></span></span>_1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sqldeveloper</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sqldeveloper</span></span></span></span>.exe</code> </pre> <br></li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Creating a repository for Oracle SOA using RCU</b> <div class="spoiler_text"><ol><li><p>  Run RCU. </p><br><pre> <code class="hljs">ofm_rcu_win_11.1.1.7.0_64_disk1_1of1/rcuHome/bin/rcu.bat</code> </pre> <br></li><li><p>  Choose Create Repository. <br><br><img src="https://habrastorage.org/files/a04/6e8/c0f/a046e8c0f32c4f8dafb80e150c50ccd3.png"><br></p><br></li><li><p>  Specify the parameters of the database, in our case it is localhost, 1521, sys and password.  Next comes the check. </p><br></li><li><p>  Next you need to specify the prefix for the data schema names (the default is DEV) and select the components of the repository, we need Metadata Services and SOA Infrastructure, the User Messaging Service is automatically selected. <br><br><img src="https://habrastorage.org/files/f8a/959/d04/f8a959d04c194ae8a2dadef632e84f99.png"><br></p><br></li><li><p>  We specify the password for users, owners of data schemes for the repository. <br><br><img src="https://habrastorage.org/files/367/e27/2aa/367e272aa2574e7c8d43048cbfd6a78d.png"><br></p><br></li><li><p>  You can then select the tablespaces for the repository data schemas. <br><br><img src="https://habrastorage.org/files/621/e3a/021/621e3a0210804e47beac93868d7daae9.png"><br></p><br></li><li><p>  Start creating tablespaces. <br><br><img src="https://habrastorage.org/files/46c/115/90d/46c11590d80d4042997ee3a0f63411a8.png"><br></p><br></li><li><p>  Is done. <br><br><img src="https://habrastorage.org/files/90a/25e/783/90a25e783c6a4716a7c0c5b21aad49b7.png"><br></p><br></li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Creating a WebLogic domain and starting servers</b> <div class="spoiler_text"><ol><li><p>  Run the installation. <br>  To create it, run the config.cmd file in the folder </p><br><pre> <code class="hljs tex">C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Oracle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Middleware</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Oracle</span></span></span></span>_SOA1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">common</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bin</span></span></span></span></code> </pre> <br><p>  I have JDK 1.7, so he cursed <br><br><img src="https://habrastorage.org/files/016/673/dfd/016673dfd4de49ecb6c37caea33313ea.png"><br>  We will go around it - change javaw to java in the file </p><br><pre> <code class="hljs tex">c:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Oracle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Middleware</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wlserver</span></span></span></span>_10.3<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">common</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bin</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span></span>.cmd</code> </pre> <br><p>  and get the description of the Unrecognized VM option 'UseSpinning' <br>  Remove the option <b>-XX: + UseSpinning</b> (which is no longer with 1.6) in the file </p><br><pre> <code class="hljs tex">c:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Oracle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Middleware</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wlserver</span></span></span></span>_10.3<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">common</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bin</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">commEnv</span></span></span></span>.cmd</code> </pre> <br><p>  and run again. </p><br></li><li><p>  Select the creation of a new domain. <br><br><img src="https://habrastorage.org/files/b73/a70/dd4/b73a70dd4cc74b63b039a4073e7c4259.png"><br></p><br></li><li><p>  We select Oracle SOA Suite, Enterprise Manager.  WSM Policy Manager and JRF will be selected automatically. <br><br><img src="https://habrastorage.org/files/058/15c/5bf/05815c5bfc314e69acb8af9bad1c6c96.png"><br></p><br></li><li><p>  Specify the name and path to the domain and applications. <br><br><img src="https://habrastorage.org/files/179/3b5/caf/1793b5caf20f45b0a90f3027f16f112a.png"><br></p><br></li><li><p>  Password for weblogic user. <br><br><img src="https://habrastorage.org/files/bbf/ac9/fec/bbfac9fecee94f1084e2435437fa7b15.png"><br></p><br></li><li><p>  JDK and installation type.  Leave Development Mode. <br><br><img src="https://habrastorage.org/files/9f6/bbc/e58/9f6bbce58e81475484f53a9ec53824b6.png"><br></p><br></li><li><p>  We assign passwords to your schemes, host and sid :. <br><br><img src="https://habrastorage.org/files/443/a39/f54/443a39f543b249cebfa8a92940eeeb95.png"><br></p><br></li><li><p>  Check. <br><br><img src="https://habrastorage.org/files/7a2/de6/137/7a2de61371b44f9fa4522b885f1e9a3b.png"><br></p><br></li><li><p>  We will not configure, we will leave empty. <br><br><img src="https://habrastorage.org/files/00b/461/520/00b4615207424035b6d04b7194304fcd.png"><br></p><br></li><li><p>  Click to create. </p><br></li><li><p>  Is done.  Run the admin server. <br><br><img src="https://habrastorage.org/files/7e8/1ab/77e/7e81ab77ef6d4c8cb81df9d8f74cfea2.png"><br></p><br></li><li><p>  Let's wait for the message "Server state changed to RUNNING" </p><br></li><li><p>  Run soa_server1. </p><br><pre> <code class="hljs tex">c:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Oracle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Middleware</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span></span>_projects<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">domains</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">base</span></span></span></span>_domain<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bin</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">startManagedWebLogic</span></span></span></span>.cmd soa_server1</code> </pre> <br></li><li><p>  When will ask for a login and password, enter from the domain administrator.  To no longer asked to create a file. </p><br><pre> <code class="hljs tex">c:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Oracle</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Middleware</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span></span>_projects<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">domains</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">base</span></span></span></span>_domain<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servers</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soa</span></span></span></span>_server1<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">boot</span></span></span></span>.properties</code> </pre> <br><hr><br><pre> <code class="hljs pgsql">username=weblogic <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>=welcome1</code> </pre> <br></li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Check Consoles and Configure JDeveloper</b> <div class="spoiler_text"><ol><li><p>  Verify the WebLogic Administration Console: <a href="http://localhost:7001/console">http: // localhost: 7001 / console</a> (if you used the default port during installation). <br><br><img src="https://habrastorage.org/files/af0/78d/1e3/af078d1e38c2433191fbe79fb4dd4142.png"><br></p><br></li><li><p>  Enterprise Manager Verification: <a href="http://localhost:7001/em">http: // localhost: 7001 / em</a> <br>  The Enterprise Manager should have the ‚ÄúSOA‚Äù tab available in the tree on the left. </p><br></li></ol><br><p><img src="https://habrastorage.org/files/d8f/35c/a49/d8f35ca4907c4fb286c56bbc03477e3b.png"><br></p><br><ol><li><p>  You need to install JDeveloper to create composites.  We are taking version 11.1.1.9.0. <br>  Set using existing Middleware Home. </p><br></li><li><p>  To work with composites, you need to install an extension for our JDeveloper. <br><br><img src="https://habrastorage.org/files/3e7/99f/1af/3e799f1af66b48109e92208a89731de9.png"><br><br><img src="https://habrastorage.org/files/ee5/405/f07/ee5405f0741b42a6b740896e1b00d356.png"><br><br><img src="https://habrastorage.org/files/f22/a71/7be/f22a717be257481baf9dbba30f911c7b.png"><br></p><br></li></ol></div></div><br><h4>  <b>Preparation for development</b> </h4><br><p>  Composites that we deploy will use schemas that are stored in MDS in the database.  It can be requested or deflated from the stand for functional testing. </p><br><div class="spoiler">  <b class="spoiler_title">Connect to MDS and import archive</b> <div class="spoiler_text"><ol><li><p>  Import MDS archive. <br><br><img src="https://habrastorage.org/files/72f/8d3/760/72f8d376093e41ef9e771695aa128ef1.png"><br><br> <a href=""><img src="https://habrastorage.org/files/4f7/a66/0eb/4f7a660ebb6c47aa832ab80a954c434e.png"></a> <br></p><br></li><li><p>  Creating a database connection under an MDS user.  View-&gt; Resource palette-&gt; New Connection-&gt; Database <br><br><img src="https://habrastorage.org/files/23f/db2/c92/23fdb2c921a643b881a26562141ece00.png"><br></p><br></li><li><p>  Create a connection to MDS.  View-&gt; Resource palette-&gt; New Connection-&gt; SOA-MDS <br><br><img src="https://habrastorage.org/files/b99/982/0f8/b999820f8b4848d1bef0e2d54d838884.png"><br></p><br></li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Import existing composite</b> <div class="spoiler_text"><ol><li><p>  Creating an empty project.  (File-&gt; New). <br><br><img src="https://habrastorage.org/files/45e/0b3/b21/45e0b3b215e448599a3c8b6057b6415a.png"><br><br><img src="https://habrastorage.org/files/5b7/a1c/716/5b7a1c716ae844ccb23d573b3d8a4764.png"><br><br><img src="https://habrastorage.org/files/c17/fb7/3bc/c17fb73bc1824c4395abe9ff8ec8d8d4.png"><br></p><br></li><li><p>  Import existing composite.  Composites can also be deflated from a functional stand.  Select the created project, File-&gt; Import. <br><br><img src="https://habrastorage.org/files/c4b/357/b23/c4b357b2333c4428a9e415e63b0b3f04.png"><br><br><img src="https://habrastorage.org/files/812/135/9e8/8121359e832f4b1db4fd6ef2a33e9901.png"><br><br> <a href=""><img src="https://habrastorage.org/files/5b2/bec/ff2/5b2becff230345a1a7822eab1132827f.png"></a> <br></p><br></li></ol></div></div><br><h4>  <b>Development</b> </h4><br><p>  Scratch the composite and close </p><br><div class="spoiler">  <b class="spoiler_title">Cutting out calls to external systems.</b>  <b class="spoiler_title">Editing a BPEL file</b> <div class="spoiler_text"><p>  In the picture above you can see on the right side there is an external system and the business process is invoked by the invoke method. <br>  Let's remove this unnecessary.  I will do it in a notebook.  But it is possible and in the interface. </p><br><p><img src="https://habrastorage.org/files/931/78a/7f6/93178a7f6f2e430e9c2c324116e536a6.png"><br></p><br><ol><li><p>  A brief digression. <br>  The file consists of blocks, variations more, I will list some: <br>  process - the root tag for the process <br>  partnerLinks - partnership agreements between services <br>  variables - declaration variables <br>  faultHandlers - error handlers <br>  sequence main - business process <br>  receive - receive a request from a client <br>  assign - the variable assignment block <br>  copy - copy data from one object to another <br>  invoke - a web service call <br>  if, elseif, else - conditions declaration <br>  condition - condition description <br>  forEach - cycle declaration <br>  startCounterValue - start of the loop <br>  finalCounterValue - end of loop <br>  scope - union </p><br></li><li><p>  Remove part of the agreement concerning the external system. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">partnerLink</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GetCustomerPartyAccountBS"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">partnerLinkType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ns2:GetCustomerPartyAccount"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">partnerRole</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GetCustomerPartyAccountProvider"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">myRole</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GetCustomerPartyAccountRequester"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br></li><li><p>  For simplicity, I also delete the error handler.  The entire tag is faultHandlers. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">faultHandlers</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br></li><li><p>  We remove the assign request to the external system, leaving only the copying of data from the request to identify the request. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span>$inputVariable.payload/SYSTEM/MSG_ID/@Value<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span>$outputVariable.payload/SYSTEM/MAIN_ID/@Value<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li><p>  We delete all calls to the external invoke systems, except the last one in the file where the response to our client should be. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">invoke</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"callbackClient"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">partnerLink</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"getcustomerpartyaccountsystreqa_client"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">portType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ns1:GetCustomerPartyAccountsystReqACallback"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">operation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"processResponse"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">inputVariable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"outputVariable"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br></li><li><p>  Let's look at the variable in which to write the answer.  In our case, this is the <b>outputVariable</b> </p><br></li><li><p>  We take the example of the answer that our developers gave in a friendly way, or we ourselves pulled it out of the SOA on a functional stand.  And write the values ‚Äã‚Äãin the right tags.  for example <br>  The payload method, the response operation AnsSearchGetCustomerPartyAcc and xpath set our own. <br>  BEGIN <em>[$ itr] - an element in the loop, means the $ itr -th element of BEGIN</em> inside the parent. </p><br></li></ol><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bpelx:insertMissingToData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ignoreMissingFromData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span>"0"<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span>$outputVariable.payload/DATA/AnsSearchGetCustomerPartyAcc/BEGIN_/accClntList/BEGIN_[$itr]/accClnt/BEGIN_/status/BEGIN_/code/@Value<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Cutting out calls to external systems.</b>  <b class="spoiler_title">Rule composit.xml</b> <div class="spoiler_text"><ol><li>  Remove the wsdl import from the external service. <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">importType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oramds:/apps/EDM/EnterpriseBusinessServiceLibrary/GetCustomerPartyAccountBS/V1/GetCustomerPartyAccountBSV1.wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.ru/EnterpriseBusinessServiceLibrary/GetCustomerPartyAccountBS/V1"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> </li><li>  Remove another link to an external service. <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GetCustomerPartyAccountBS"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </li><li>  And another wire connection to the service <b>GetCustomerPartyAccountBS</b> <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wire</span></span></span><span class="hljs-tag">&gt;</span></span> ```GetCustomerPartyAccountsystReqA/GetCustomerPartyAccountBS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source.uri</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target.uri</span></span></span><span class="hljs-tag">&gt;</span></span>GetCustomerPartyAccountBS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target.uri</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wire</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Cutting out calls to external systems.</b>  <b class="spoiler_title">Rule .componentType and soaconfigplan.xml</b> <div class="spoiler_text"><ol><li>  We remove the link to the external service in these files. <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GetCustomerPartyAccountBS"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </li><li>  We try to collect.  Right Click on the project -&gt; Make. <br>  If everything is OK, then deploy, no - we understand. </li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Deploy stubs on local weblogic</b> <div class="spoiler_text"><ol><li><p>  We try to cover it. <br><br><img src="https://habrastorage.org/files/29a/ee0/a59/29aee0a5945648cd98b36016da931d9a.png"><br></p><br></li><li><p>  The choice of operation. <br><br><img src="https://habrastorage.org/files/6aa/9e0/d93/6aa9e0d9321a4708864de89803cfc26d.png"><br></p><br></li><li><p>  You can create several services with the same name but different versions. <br>  You can call everything, but only default revisions will work at the standard address.  In Enterprise Manager, you can apply a default on a composite. <br><br><img src="https://habrastorage.org/files/232/7ee/349/2327ee34901e4f1893d854163ea05627.png"><br></p><br></li><li><p>  Server selection. <br><br><img src="https://habrastorage.org/files/969/4c4/91d/9694c491de0249f4b398f7b9cde31ba9.png"><br></p><br></li><li><p>  Add a local server.  We press plus. <br><br><img src="https://habrastorage.org/files/eb9/0ed/34f/eb90ed34f56648ac9502932cfa855317.png"><br><br><img src="https://habrastorage.org/files/e65/ec8/96d/e65ec896db844736b3962dd08649a6f1.png"><br></p><br></li><li><p>  Select SOA server. <br><br><img src="https://habrastorage.org/files/19a/370/bab/19a370bab02547478f97c405d49cce35.png"><br></p><br></li><li><p>  Summary. <br><br><img src="https://habrastorage.org/files/60c/5ed/948/60c5ed9485924c489acea2507cf0db5d.png"><br></p><br></li><li><p>  Deploy log <br><br><img src="https://habrastorage.org/web/fc3/23a/d58/fc323ad5868c46259555306c36eb8aae.png"><br></p><br></li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Examples of the use of operators</b> <div class="spoiler_text"><p>  Some examples of interesting features. </p><br><ol><li><p>  Regular expressions. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">if</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"If_ChooseSync"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">documentation</span></span></span><span class="hljs-tag">&gt;</span></span>sender_bic<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">documentation</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">condition</span></span></span><span class="hljs-tag">&gt;</span></span>xp20:matches($sender_bic,'(?!044525716|046577413|044030811|043602955|045004751|042007738|040349585|040813827)\d{9}') = true()<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">condition</span></span></span><span class="hljs-tag">&gt;</span></span> ...</code> </pre> <br></li><li><p>  Assign string </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extId</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0000000001CA3B1"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ignoreMissingFromData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bpelx:insertMissingToData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span>"0000000001CA3B1"<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span>$CITResponse/DATA/ReqSyncFinancialTransactionBatch/BEGIN_/documentList/BEGIN_/document/BEGIN_/extId/@Value<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li><p>  Cycle and iterator. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">forEach</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">parallel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"no"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">counterName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ForEach1CounterSync"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ForEachSync"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">startCounterValue</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">startCounterValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">finalCounterValue</span></span></span><span class="hljs-tag">&gt;</span></span>count($onMessage_ExecuteFinancialTransactionBatch_InputVariable.part1/DATA/ReqExecFinancialTransactionBatch/BEGIN_/documentList/BEGIN_)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">finalCounterValue</span></span></span><span class="hljs-tag">&gt;</span></span> ...</code> </pre> <br></li><li><p>  Use an iterator in a loop. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ignoreMissingFromData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bpelx:insertMissingToData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span>"BQ.00000.1415807097.277059967"<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span>$CITResponse/DATA/ReqSyncFinancialTransactionBatch/BEGIN_/documentList/BEGIN_[$ForEach1CounterInc]/document/BEGIN_/extId/@Value<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li><p>  Many built-in functions, such as guid generation. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span>oraext:generate-guid()<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span>$CITResponse/SYSTEM/MSG_ID/@Value<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li><p>  Or a comparison. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">condition</span></span></span><span class="hljs-tag">&gt;</span></span>xp20:compare($sender_bic,$recipient_bic) != 0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">condition</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li><p>  Tasty.  You can insert Java. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensionActivity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bpelx:exec</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"java"</span></span></span><span class="hljs-tag">&gt;</span></span> &lt;![CDATA[XMLElement elem = (XMLElement) getVariableData("output", "payload"); String t = elem.getTextContent(); elem.setTextContent(t + ", set by java exec 2");]]&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bpelx:exec</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensionActivity</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Adding to the composite service call</b> <div class="spoiler_text"><p>  There is a business process that calls an external system, which after some time makes a request to the system under test.  This is not in our business process. <br>  We need to set up partnership agreements with the new service, set the variables and insert the invoke of the service with the ReqSyncFinancialTransactionBatch request into our business process. <br>  The service provider that accepts the ReqSyncFinancialTransactionBatch request is also built on SOA and, by good coincidence, there is a composite from it. <br>  It is necessary to unpack and drag it all that relates to the call provider in our composite. </p><br><ol><li><p>  We add name spaces from provider and type of request to the list. </p><br><pre> <code class="xml hljs">xmlns:ns27="urn:syst-ws:ws_soap-provider_ta" xmlns:ns28="http://www.mybank.ru/ApplicationObjectLibrary/syst/Providers/DistributedFinancialTransactionProcessingBatchsystProvA/V1/SyncFinancialTransactionBatch_Request"</code> </pre> <br></li><li><p>  Add affiliate agreement. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oramds:/apps/EDM/mybank/ApplicationObjectLibrary/syst/wsdls/ProviderTA/V1/PROVIDER_TA.wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">importType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.xmlsoap.org/wsdl/"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br></li><li><p>  I also needed to import the schemas. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oramds:/apps/EDM/mybank/ApplicationObjectLibrary/syst/wsdls/ProviderTA/V1/PROVIDER_TA.wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">importType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.xmlsoap.org/wsdl/"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.mybank.ru/ApplicationObjectLibrary/syst/Providers/DistributedFinancialTransactionProcessingBatchsystProvA/V1/SyncFinancialTransactionBatch_Request"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oramds:/apps/EDM/mybank/ApplicationObjectLibrary/syst/schemas/Providers/DistributedFinancialTransactionProcessingBatchsystProvA/V1/SyncFinancialTransactionBatch_Request.xsd"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">importType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br></li><li><p>  We write the variables. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CITResponse"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">element</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ns28:CIT_REQUEST"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">variable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"processPutSoapIn"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">messageType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ns27:PROCESSPUTSoapIn"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br></li><li><p>  We make the assignments in the new request, where necessary in accordance with the scheme. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AssignOK"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ignoreMissingFromData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bpelx:insertMissingToData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span>"cm.System.syst"<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span>$CITResponse/DATA/ReqSyncFinancialTransactionBatch/BEGIN_/systemTo/@Value<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ignoreMissingFromData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bpelx:insertMissingToData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span>"cm.System.BQ"<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span>$CITResponse/DATA/ReqSyncFinancialTransactionBatch/BEGIN_/systemFrom/@Value<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ignoreMissingFromData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bpelx:insertMissingToData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span>$onMessage_ExecuteFinancialTransaction_InputVariable.part2/DATA/ReqExecFinancialTransaction/BEGIN_/document/BEGIN_/id/@Value<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span>$CITResponse/DATA/ReqSyncFinancialTransactionBatch/BEGIN_/documentList/BEGIN_/document/BEGIN_/id/@Value<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li><p>  Assigning a variable to an input variable to call the service.  We look in the wsdl provider for the message, which he understands. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wsdl:message</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PROCESSPUTSoapIn"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wsdl:part</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"parameters"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">element</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tns:PROCESSPUT"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wsdl:message</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"assignResponse"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ignoreMissingFromData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bpelx:insertMissingToData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span>$CITResponse<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">from</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span>$processPutSoapIn.parameters/ns27:REQUESTPUT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">to</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li><p>  Call the invoke service, and read the answer, receive, if needed. <br>  If necessary, put the necessary headers to the request using bpelx: toProperties. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sequence</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">invoke</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sendResponse"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">inputVariable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"processPutSoapIn"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">partnerLink</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ProviderTAWSImport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">portType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ns27:PROVIDER_TASoap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">operation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Async_PROCESSPUT"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bpelx:invokeAsDetail</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"no"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bpelx:toProperties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bpelx:toProperty</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"replyToAddress"</span></span></span><span class="hljs-tag">&gt;</span></span>'null'<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bpelx:toProperty</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bpelx:toProperties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">invoke</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receive</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"receiveResponse"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">createInstance</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"no"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">partnerLink</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ProviderTAWSImport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">portType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ns27:PROVIDER_TACallbackSoap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">operation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Async_PROCESSPUTCallback"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">variable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"processPutSoapOut"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://docs.oasis-open.org/wsbpel/2.0/process/executable"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sequence</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li><p>  Add a relation to the new service in the .componentType file </p><br><pre> <code class="xml hljs">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ProviderTAWSImport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ui:wsdlLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PROVIDER_TAWrapper.wsdl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface.wsdl</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">interface</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta#wsdl.interface(PROVIDER_TASoap)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">callbackInterface</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta#wsdl.interface(PROVIDER_TACallbackSoap)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">componentType</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li><p>  Put the wsdl PROVIDER_TAWrapper.wsdl from the service to our project </p><br></li><li><p>  Add reference to the cfgplan file </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">composite</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DistributedFinancialTransactionProcessingBatchsystReqA"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ProviderTAWSImport"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">binding</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ws"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attribute</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">replace</span></span></span><span class="hljs-tag">&gt;</span></span>@@@systDistributedFinancialTransactionProviderTAWSDL@@@<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">replace</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attribute</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oracle.webservices.httpConnTimeout"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">replace</span></span></span><span class="hljs-tag">&gt;</span></span>@@@systDistributedFinancialTransactionTAWSDL_httpConnTimeout@@@<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">replace</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oracle.webservices.httpReadTimeout"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">replace</span></span></span><span class="hljs-tag">&gt;</span></span>@@@systDistributedFinancialTransactionTAWSDL_httpReadTimeout@@@<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">replace</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">binding</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">composite</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></li><li><p>  Add the import wsdl, reference and wire to the file composit.xml <br>  Pay attention to the link to the service provider <b>location = " <a href="http://k10systwp.mybank.ru:7030/webproxy/WS/PROVIDER_TA%3Fwsdl">http://k10systwp.mybank.ru:7030/webproxy/WS/PROVIDER_TA?wsdl</a></b> </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">importType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PROVIDER_TAWrapper.wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">importType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PROVIDER_TAWrapper1.wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">importType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PROVIDER_TAWrapper2.wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br></li></ol><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ProviderTAWSImport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ui:wsdlLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oramds:/apps/EDM/mybank/ApplicationObjectLibrary/syst/wsdls/ProviderTA/V1/PROVIDER_TA.wsdl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface.wsdl</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">callbackInterface</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta#wsdl.interface(PROVIDER_TACallbackSoap)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">interface</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta#wsdl.interface(PROVIDER_TASoap)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">binding.ws</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://k10systwp.mybank.ru:7030/webproxy/WS/PROVIDER_TA?wsdl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta#wsdl.endpoint(PROVIDER_TA/PROVIDER_TASoap)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soapVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">many</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"weblogic.wsee.wsat.transaction.flowOption"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xs:string"</span></span></span><span class="hljs-tag">&gt;</span></span>WSDLDriven<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">binding.ws</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">callback</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">binding.ws</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:syst-ws:ws_soap-provider_ta#wsdl.endpoint(PROVIDER_TA/PROVIDER_TACallbackSoap_pt)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">callback</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wire</span></span></span><span class="hljs-tag">&gt;</span></span> ```DistributedFinancialTransactionProcessingBatchsystReqA/ProviderTAWSImport<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source.uri</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target.uri</span></span></span><span class="hljs-tag">&gt;</span></span>ProviderTAWSImport<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target.uri</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wire</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><ol><li>  Everything, we try to collect and deploy </li></ol></div></div><br><h4>  <b>Composite testing</b> </h4><br><p>  Check what we have done. </p><br><div class="spoiler">  <b class="spoiler_title">Check your service</b> <div class="spoiler_text"><ol><li>  We take SoapUI, we generate mosk-service, using wsdl from the service we provide. </li><li>  We take an example of a request to our service, we write in the settings in ReplyTo the address of mosk, which we have just created.  In Action we register operation.  The picture is clickable. <br><br> <a href=""><img src="https://habrastorage.org/files/6a0/218/5fe/6a02185fec174507acd4c16fb7417931.png"></a> <br></li><li>  Make a request </li><li>  We look, the service has worked and sent a response.  The picture is clickable. <br><br> <a href=""><img src="https://habrastorage.org/files/c37/04c/06b/c3704c06b92a446f81a917e6f7cda67e.png"></a> <br></li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Check embedded call service</b> <div class="spoiler_text"><ol><li>  We also take SoapUI, we generate a mosk-service using wsdl from the service provider. </li><li>  We copy the address wsdl and we register it in the file composite.xml in our service.  Thus we specify where the embedded query will go. <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">binding.ws</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://k10-emul:8089/mockPROVIDER_TASoap?WSDL"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:ws:ws_soap-provider_ta#wsdl.endpoint(PROVIDER_TA/PROVIDER_TASoap)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soapVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.1"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </li><li>  We save, deploy with another version.  We also remove the tick in default so that our debug doesn‚Äôt bother anyone. <br><br><img src="https://habrastorage.org/files/16a/ac2/66d/16aac266ddad44f592741f487004c481.png"><br></li><li>  Check that everything is assembled without errors and go to EM.  We are looking for our service with a new revision. <br><br><img src="https://habrastorage.org/files/e25/d7e/b8a/e25d7eb8a8e04146b960ba80a15b73a1.png"><br><br><img src="https://habrastorage.org/files/f63/6b6/e48/f636b6e489fa4276a8854ad52309573a.png"><br></li><li>  We make a request and check that the embedded call came to our stub.  The picture is clickable. <br><br> <a href=""><img src="https://habrastorage.org/files/d58/672/718/d58672718b4e4a3e9e708466b2247e63.png"></a> <br></li></ol></div></div><br><h4>  <b>Problem analysis at work</b> </h4><br><p>  What to do if the developers say that our plug slows down, but everything is fine with them? <br>  We'll figure out. </p><br><div class="spoiler">  <b class="spoiler_title">Search queries in the database SOA</b> <div class="spoiler_text"><p>  It took to find requests for content to understand what happened to him.  The CUBE_INSTANCE table in our DEV_SOAINFRA schema contains the entire history of composites.  But for viewing it is necessary to pull it out of the blob. <br>  Found here the function that does it </p><br><div class="spoiler">  <b class="spoiler_title">code</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PACKAGE</span></span> SOA_UTIL <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-comment"><span class="hljs-comment">------------------------------------------------------------------------------------------- -- Written by : Gilberto Holms (https://gibaholms.wordpress.com/) -- Last update : 07/11/2014 -- Version : 1.1 -- Description : Utility code to handle Oracle SOA Suite tables -- Release notes: -- 1.0: Initial release -- 1.1: Bug fix to work properly on SOA 10g ------------------------------------------------------------------------------------------- FUNCTION GET_AUDIT_TRAIL(P_SCHEMA_NAME VARCHAR2, P_CIKEY NUMBER) RETURN CLOB; END SOA_UTIL; / CREATE OR REPLACE PACKAGE BODY SOA_UTIL AS ------------------------------------------------------------------------------------------- -- Written by : Gilberto Holms (https://gibaholms.wordpress.com/) -- Last update : 07/11/2014 -- Version : 1.1 -- Description : Utility code to handle Oracle SOA Suite tables -- Release notes: -- 1.0: Initial release -- 1.1: Bug fix to work properly on SOA 10g ------------------------------------------------------------------------------------------- FUNCTION GET_AUDIT_TRAIL(P_SCHEMA_NAME VARCHAR2, P_CIKEY NUMBER) RETURN CLOB AS V_AUDIT_BLOB BLOB; V_AUDIT_CLOB CLOB; V_CUR_AUDIT SYS_REFCURSOR; TYPE TP_AUDIT_RECORD IS RECORD( BLOCK NUMBER(38,0), LOG BLOB ); TYPE TP_AUDIT_ARRAY IS TABLE OF TP_AUDIT_RECORD; V_AUDIT_ARRAY TP_AUDIT_ARRAY; V_AUDIT_COMPLETE BLOB; V_BUFFER_LENGTH PLS_INTEGER := 32767; V_BUFFER VARCHAR2(32767); V_READ_START PLS_INTEGER := 1; BEGIN DBMS_LOB.CREATETEMPORARY(V_AUDIT_BLOB, TRUE); DBMS_LOB.CREATETEMPORARY(V_AUDIT_CLOB, TRUE); DBMS_LOB.CREATETEMPORARY(V_AUDIT_COMPLETE, TRUE); OPEN V_CUR_AUDIT FOR 'SELECT BLOCK, LOG FROM ' || P_SCHEMA_NAME || '.AUDIT_TRAIL WHERE CIKEY = :cikey ORDER BY COUNT_ID' USING P_CIKEY; FETCH V_CUR_AUDIT BULK COLLECT INTO V_AUDIT_ARRAY; CLOSE V_CUR_AUDIT; FOR j IN 1..V_AUDIT_ARRAY.COUNT LOOP IF j = 1 THEN DBMS_LOB.APPEND (V_AUDIT_BLOB, V_AUDIT_ARRAY(j).LOG); ELSE IF ( V_AUDIT_ARRAY(j).BLOCK = V_AUDIT_ARRAY(j-1).BLOCK ) THEN DBMS_LOB.APPEND (V_AUDIT_BLOB, V_AUDIT_ARRAY(j).LOG); ELSE DBMS_LOB.APPEND (V_AUDIT_COMPLETE, UTL_COMPRESS.LZ_UNCOMPRESS(V_AUDIT_BLOB)); DBMS_LOB.CREATETEMPORARY(V_AUDIT_BLOB, TRUE); DBMS_LOB.APPEND (V_AUDIT_BLOB, V_AUDIT_ARRAY(j).LOG); END IF; END IF; END LOOP; DBMS_LOB.APPEND (V_AUDIT_COMPLETE, UTL_COMPRESS.LZ_UNCOMPRESS(V_AUDIT_BLOB)); V_AUDIT_ARRAY.DELETE; FOR i IN 1..CEIL(DBMS_LOB.GETLENGTH(V_AUDIT_COMPLETE) / V_BUFFER_LENGTH) LOOP V_BUFFER := UTL_RAW.CAST_TO_VARCHAR2(DBMS_LOB.SUBSTR(V_AUDIT_COMPLETE, V_BUFFER_LENGTH, V_READ_START)); DBMS_LOB.WRITEAPPEND(V_AUDIT_CLOB, LENGTH(V_BUFFER), V_BUFFER); V_READ_START := V_READ_START + V_BUFFER_LENGTH; END LOOP; RETURN V_AUDIT_CLOB; END; END SOA_UTIL; /</span></span></code> </pre> </div></div><br><p>  and usage example </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ci.ecid, CI.COMPOSITE_NAME, SOA_UTIL.GET_AUDIT_TRAIL(<span class="hljs-string"><span class="hljs-string">'DEV_SOAINFRA'</span></span>, CI.CIKEY) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> AUDIT_TRAIL_XML, ci.* <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DEV_SOAINFRA.CUBE_INSTANCE CI <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> CI.CREATION_DATE &gt; <span class="hljs-keyword"><span class="hljs-keyword">to_date</span></span>(<span class="hljs-string"><span class="hljs-string">'21.04.2017 09:57:00'</span></span>,<span class="hljs-string"><span class="hljs-string">'dd.mm.yyyy hh24:mi:ss'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> CI.CREATION_DATE &lt; <span class="hljs-keyword"><span class="hljs-keyword">to_date</span></span>(<span class="hljs-string"><span class="hljs-string">'21.04.2017 19:59:00'</span></span>,<span class="hljs-string"><span class="hljs-string">'dd.mm.yyyy hh24:mi:ss'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> CI.CREATION_DATE &gt; <span class="hljs-keyword"><span class="hljs-keyword">sysdate</span></span><span class="hljs-number"><span class="hljs-number">-0.3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> SOA_UTIL.GET_AUDIT_TRAIL(<span class="hljs-string"><span class="hljs-string">'DEV_SOAINFRA'</span></span>, CI.CIKEY) <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> <span class="hljs-string"><span class="hljs-string">'%40702810312080005917%'</span></span>;</code> </pre><br><p>  Pictures are clickable. </p><br><ol><li>  We are looking for a problem request.  The picture is clickable. <br><br> <a href=""><img src="https://habrastorage.org/files/890/c25/46a/890c2546a72f4851a623ee4ac922565b.png"></a> <br></li><li>  We take it ECID </li><li>  Go to EM and look for a query on ECID <br><br> <a href=""><img src="https://habrastorage.org/files/0d3/538/c44/0d3538c44d79489690b98eb5ebc2bb28.png"></a> <br></li><li>  We look what happened and most importantly for what we answered the system <br><br> <a href=""><img src="https://habrastorage.org/files/cdb/647/f24/cdb647f244dd401ba97ea93ddda8f353.png"></a> <br><br> <a href=""><img src="https://habrastorage.org/files/fed/dbd/5de/feddbd5de4c045bdb1d349be7c754fb4.png"></a> <br></li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Monitoring and comments on work</b> <div class="spoiler_text"><p>  There is nothing complicated </p><br><ol><li>  For monitoring system resources and metrics soa there is a wonderful tab Perfomace summary. <br><br><img src="https://habrastorage.org/files/421/7db/817/4217db8172ec405789fcff0bfca33c2f.png"><br></li><li>  There is a script that will send soap requests to the stub every 30 seconds and measure the response time.  You can tie it to anything, Grafana, Zabbix, Sitescope </li><li>  During the works, it was necessary to increase the memory for heap to 4096, the machine itself with 16 gb ram. </li><li>  As the query history grows, the soa schema also swells accordingly.  It was necessary to expand the tablespace.  The code can be found on the Internet, I will give just in case </li></ol><br><div class="spoiler">  <b class="spoiler_title">Tablespace expansion</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLESPACE</span></span> DEV_SOAINFRA <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DATAFILE</span></span> <span class="hljs-string"><span class="hljs-string">'C:\APP\KALISTRATOVKA\ORADATA\ORCL\DEV_SOAINFRA07.DBF'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">size</span></span> <span class="hljs-number"><span class="hljs-number">20000</span></span>M <span class="hljs-keyword"><span class="hljs-keyword">AUTOEXTEND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEXT</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>M <span class="hljs-keyword"><span class="hljs-keyword">MAXSIZE</span></span> <span class="hljs-number"><span class="hljs-number">20000</span></span>M;</code> </pre> </div></div><br><p>  Table space size can be viewed in the dba_tablespace_usage_metrics table </p></div></div><br><h4>  <b>Conclusion</b> </h4><br><p>  For the unknown, you can and should take it and not be afraid to make a mistake.  Yes, and I liked JDev more than Eclipse. </p><br><p>  References to sources: </p><br><blockquote>  <a href="http://www.oracle-adf.info/2014/03/oracle-soa-suite.html">http://www.oracle-adf.info/2014/03/oracle-soa-suite.html</a> <br>  <a href="https://shouab.wordpress.com/oracle-soa-11g-step-by-step-installation-guide/">https://shouab.wordpress.com/oracle-soa-11g-step-by-step-installation-guide/</a> <br>  <a href="http://www.theserverside.com/news/1364554/BPEL-and-Java">http://www.theserverside.com/news/1364554/BPEL-and-Java</a> <br>  <a href="http://samolisov.blogspot.ru/2009/06/soa-bpel.html">http://samolisov.blogspot.ru/2009/06/soa-bpel.html</a> <br>  <a href="http://docs.oracle.com/cd/E15586_01/integration.1111/e10224/bp_java.htm">http://docs.oracle.com/cd/E15586_01/integration.1111/e10224/bp_java.htm</a> <br>  <a href="https://gibaholms.wordpress.com/2014/02/03/export-audit-trail-from-database-soa-10g-and-11g/">https://gibaholms.wordpress.com/2014/02/03/export-audit-trail-from-database-soa-10g-and-11g/</a> </blockquote></div><p>Source: <a href="https://habr.com/ru/post/307132/">https://habr.com/ru/post/307132/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307116/index.html">Creating and using extensions for UWP applications using App Services</a></li>
<li><a href="../307118/index.html">&? Trim? Heisenberg? No, have not heard</a></li>
<li><a href="../307120/index.html">As a result of hacking a famous opensource hosting, distributions of Audacity, Classic Shell and others were infected.</a></li>
<li><a href="../307126/index.html">Summer Deadline: Top 10 Microsoft Virtual Academy Courses</a></li>
<li><a href="../307130/index.html">How to easily work with OneDrive from UWP apps</a></li>
<li><a href="../307134/index.html">Un-FuckUp-able Development Protocol (UDP)</a></li>
<li><a href="../307136/index.html">About clouds and sensors: connecting Intel NUC and Genuino 101 to the IBM Watson IoT platform</a></li>
<li><a href="../307138/index.html">We charge Xcode</a></li>
<li><a href="../307140/index.html">Do it yourself web service with asynchronous queues and parallel execution</a></li>
<li><a href="../307142/index.html">Configuring public preview VNET Peering in Azure</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>