<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The story of the mobile Internet. Paranoia or have something to think about?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, colleagues. 

 Just want to make a reservation that this note ... this is just a note on some technical problem, which, as it seems to the a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The story of the mobile Internet. Paranoia or have something to think about?</h1><div class="post__text post__text-html js-mediator-article"> Good day, colleagues. <br><br>  Just want to make a reservation that this note ... this is just a note on some technical problem, which, as it seems to the author, has something to do with the subject of the section where it is published. <br>  Here, <a href="http://habrahabr.ru/post/148200/">habrahabr.ru/post/148200</a> has already touched on the topic of proxying through free VPN services, now we will focus on the mobile Internet. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In general, the author of the note didn‚Äôt overlap with such ‚Äúbeasts‚Äù as GPRS / 2G / 3G and so on.  But once had to. <br><br>  Once on one remote object the channel disappeared (or rather all the channels) to the head object.  And it was very bad.  An interim solution was urgently needed and considering the whole mass of accompanying factors (very unhappy), nothing ‚Äúdance‚Äù was better than pptp via the usual USB ‚Äúwhistle‚Äù.  But will it work?  And the author notes and colleagues "in the shop" took doubts.  Come mobile operator cuts the whole thing.  But decided to try.  Have tried.  When the dial-up connection started up, we quickly found out through which real IP our traffic from the operator, looked at whois, got the mask with mask / 21, opened it on the firewall of the border equipment, where the pptp tunnel was to be terminated, tried it - the VPN started up. <br><br>  Good news, the operator does not cut TCP 1723 and GRE.  The temporary scheme worked out, the channels were repaired.  But at one "beautiful" moment they fell again, while the previously tested temporary scheme did not work.  Small troubleshooting and a result that was a little surprised. <br><br>  Traffic that is different from pptp (test ping, connection to arbitrary non-standard ports) the operator will get through one external IP (well, not just one, it is clear that they have a certain pool, which means the same for a particular modem connection), but pptp - through some other.  Moreover, this other one is separated from the gprs-pool (/ 21), revealed earlier and opened in access sheets quite seriously.  And it does not resolve to the name, unlike the IP from the gprs pool.  And whois doesn't clarify anything. <br><br>  Corrected access sheets, the tunnel was wound up.  Since the risk of a repeated accident on conventional channels was high for some time, this ‚Äúcrutch‚Äù did not completely remove.  And as a result, a curious statistic was gathered.  When ‚Äúwhistles‚Äù were dropped and repeated connections, naturally, different gray IPs were issued, the external IP, from which the normal traffic ran, but the IP from which the operator pptp remained constant. <br>  At the same time, the tunnel periodically fell and did not want to wind up, sometimes for a very long time, up to a work shift, and even a couple of times up to several days.  Then suddenly he began to work as if nothing had happened. <br><br>  The author of the note has long drove away various little thoughts, convincing himself that there is nothing to suffer with paranoia, you never know what is there in the ‚Äúblack box‚Äù of the operator's network, but ... I decided to improve the situation in more detail. <br><br>  As a result, nothing suspicious with pptp traffic was noticed (except for the initial situation with nat from an incomprehensible IP).  But during this debug, interesting details surfaced regarding HTTP traffic. <br>  Data. <br><br>  1. The connection to the IP of a server controlled by the author on a closed / un-listenable port 80 was successfully passed (in the absence of incoming traffic on the target server at the time of the connection). <br><br>  2. This was not always, no tendency could be traced. <br><br>  3. When netcat was launched on port 80 on the target server, it turned out that proxying is present in an explicit form, it is not clear. <br><br>  In the case when it is presumably not present, nothing appears on L7 superfluous and is not modified, the protocol version, headers, etc. Moreover, if you send to the channel, for example, erroneous requests, they are transmitted as they are through and through to break the connection it does not lead. <br><br>  When proxying is exactly there, when sending a minimalist "GET /" netcat on the server gave an curious <br><br>  GET / HTTP / 1.1 <br>  X-Via: Harmony proxy <br>  Host: xx.xx.xx.xx <br><br>  and telnet at break timeout <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Error</span></span> <span class="hljs-number"><span class="hljs-number">504</span></span> Gateway Timeout <br> <br> HTTP ERROR: <span class="hljs-number"><span class="hljs-number">504</span></span> Gateway Timeout <br> RequestURI=http://xx.xx.xx.xx/ <br> <br> <br> <span class="hljs-number"><span class="hljs-number">4</span></span>.  ,  TTL  IP  MSS  TCP        <span class="hljs-number"><span class="hljs-number">80</span></span> . ,         IP    Win  TTL <span class="hljs-number"><span class="hljs-number">128</span></span>,        TTL <span class="hljs-number"><span class="hljs-number">167</span></span>. ,    ,     <span class="hljs-number"><span class="hljs-number">194</span></span>,         .   MSS   <span class="hljs-number"><span class="hljs-number">1210</span></span>.         <span class="hljs-number"><span class="hljs-number">80</span></span> .     ,  MSS  , TTL       . <br> <br>  ,  ?    Harmony proxy      ? <br>    pptp     , . .       ,   . <br> <br> <b>UPD:</b>  -          -<span class="hljs-string"><span class="hljs-string">""</span></span>? VPN  :)</code> <h2> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Error</span></span> <span class="hljs-number"><span class="hljs-number">504</span></span> Gateway Timeout <br> <br> HTTP ERROR: <span class="hljs-number"><span class="hljs-number">504</span></span> Gateway Timeout <br> RequestURI=http://xx.xx.xx.xx/ <br> <br> <br> <span class="hljs-number"><span class="hljs-number">4</span></span>.  ,  TTL  IP  MSS  TCP        <span class="hljs-number"><span class="hljs-number">80</span></span> . ,         IP    Win  TTL <span class="hljs-number"><span class="hljs-number">128</span></span>,        TTL <span class="hljs-number"><span class="hljs-number">167</span></span>. ,    ,     <span class="hljs-number"><span class="hljs-number">194</span></span>,         .   MSS   <span class="hljs-number"><span class="hljs-number">1210</span></span>.         <span class="hljs-number"><span class="hljs-number">80</span></span> .     ,  MSS  , TTL       . <br> <br>  ,  ?    Harmony proxy      ? <br>    pptp     , . .       ,   . <br> <br> <b>UPD:</b>  -          -<span class="hljs-string"><span class="hljs-string">""</span></span>? VPN  :)</code> </h2> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Error</span></span> <span class="hljs-number"><span class="hljs-number">504</span></span> Gateway Timeout <br> <br> HTTP ERROR: <span class="hljs-number"><span class="hljs-number">504</span></span> Gateway Timeout <br> RequestURI=http://xx.xx.xx.xx/ <br> <br> <br> <span class="hljs-number"><span class="hljs-number">4</span></span>.  ,  TTL  IP  MSS  TCP        <span class="hljs-number"><span class="hljs-number">80</span></span> . ,         IP    Win  TTL <span class="hljs-number"><span class="hljs-number">128</span></span>,        TTL <span class="hljs-number"><span class="hljs-number">167</span></span>. ,    ,     <span class="hljs-number"><span class="hljs-number">194</span></span>,         .   MSS   <span class="hljs-number"><span class="hljs-number">1210</span></span>.         <span class="hljs-number"><span class="hljs-number">80</span></span> .     ,  MSS  , TTL       . <br> <br>  ,  ?    Harmony proxy      ? <br>    pptp     , . .       ,   . <br> <br> <b>UPD:</b>  -          -<span class="hljs-string"><span class="hljs-string">""</span></span>? VPN  :)</code> </pre> <code>Error 504 Gateway Timeout <br> <br> HTTP ERROR: 504 Gateway Timeout <br> RequestURI=http://xx.xx.xx.xx/ <br> <br> <br> 4.  ,  TTL  IP  MSS  TCP        80 . ,         IP    Win  TTL 128,        TTL 167. ,    ,     194,         .   MSS   1210.         80 .     ,  MSS  , TTL       . <br> <br>  ,  ?    Harmony proxy      ? <br>    pptp     , . .       ,   . <br> <br> <b>UPD:</b>  -          -""? VPN  :)</code> </div><p>Source: <a href="https://habr.com/ru/post/148260/">https://habr.com/ru/post/148260/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148251/index.html">Dropbox investigates possible hacking</a></li>
<li><a href="../148252/index.html">ALEAR project robots create their own language</a></li>
<li><a href="../148253/index.html">17-year-old businessman founded four startups</a></li>
<li><a href="../148254/index.html">Are there many science fiction writers in Habr√©?</a></li>
<li><a href="../148258/index.html">Greet your old new friend</a></li>
<li><a href="../148261/index.html">Django do-it-yourself part 3: Routes, debugging, middleware, bottle, beaker</a></li>
<li><a href="../148266/index.html">Corky</a></li>
<li><a href="../148268/index.html">Managing freelance projects on their own experience</a></li>
<li><a href="../148270/index.html">RoboSub 2012 reconnaissance in battle and reaching the final</a></li>
<li><a href="../148271/index.html">Problems in corporate use of SAAS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>