<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>5 free Microsoft tools for monitoring Active Directory health</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gary Olsen, MVP in Directory Services and Solution Architect at HP, recently published a review of 5 free Microsoft tools that can be used to evaluate...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>5 free Microsoft tools for monitoring Active Directory health</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage2/8c1/d9a/1a3/8c1d9a1a30da587b94d7f93874704cba.jpg">  Gary Olsen, MVP in Directory Services and Solution Architect at HP, recently published a <a href="http://redmondmag.com/Articles/2012/07/01/5-Free-Microsoft-Tools-for-Top-Active-Directory-Health.aspx%3FPage%3D1">review of 5 free Microsoft tools</a> that can be used to <b>evaluate Active Directory health</b> .  This review seemed to us quite useful, so we decided to give a translation here. <br>  We invite interested persons under cat. <br><a name="habracut"></a><br><br>  Evaluation of AD health is already a problem in itself, especially for small and medium-sized companies that cannot afford to purchase expensive third-party solutions or hire an administrator who would only deal with AD administration. <br>  The first manifestation of the ‚Äúsick‚Äù Active Directory is the increasing flow of calls to the support service, which indicates a impending crisis.  Fortunately, Active Directory itself can ‚Äúrecover‚Äù and even without being 100% healthy, it still works.  However, it is precisely because of this that the problems that have arisen can be ignored, and the IT service switches to solving more important tasks. <br>  I remember as a couple of years ago, as one of the employees told me that the domain controller does not want to replicate.  After analyzing the logs, it turned out that this CD was not replicated for almost three years. <br>  Therefore, I decided to collect here 5 basic tools that help me in conducting a basic health assessment of Active Directory.  All are free and relatively easy to use. <br><br><h4>  1. Active Directory Best Practices Analyzer </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      By releasing the Active Directory Best Practices Analyzer (ADBPA) utility that is present in Windows Server 2008 R2, Microsoft has opened up extensive health information about Active Directory.  Many administrators know the Exchange Best Practices Analyzer (ExBPA) utility.  I expected from ADBPA the same level of detail of the reports and in-depth analysis of the best AD practices as from ExBPA in terms of solving the problems that arise.  ADBPA, of course, provides useful information, but I would like it to be more.  ADBPA is available under the Active Directory Domain Services role in Server Manager, as shown in Figure 1. <br><br><img src="https://habrastorage.org/storage2/142/63e/b43/14263eb430fa901a1dd86e260cc69dba.jpg"><br><br>  Please note that you can get a description of each entry by simply clicking on it.  This example shows that all domain controllers marked in green correspond to the list of best practices of AD.  Errors and warnings are also displayed.  What is checked: all the lipermic domain controllers are configured to a valid time source (? - valid time source), all domains have two functioning CDs, all OUs are protected from accidental deletion when the last backups were made;  Whether DNS is configured correctly, whether Group Policy and FRS replications work. <br>  ADBPA is suitable for the primary review of AD health, but I would still like to receive more information.  For example, it does not show information about Active Directory replication or whether there are CDs that have not replicated for a certain period of time (for example, during the lifetime of tombstone objects).  The utility shows whether DNS works in such a way that allows clients to connect, nothing indicates that the DNS server may be incorrectly configured. <br><br><h4>  2. MPS Reports </h4><br><br>  In the old days of Windows 2000, Microsoft released Microsoft Product Support (MPS) Reports, a script for diagnosing AD.  First, it was released for Microsoft partners, and then for everyone.  For me, this utility is a key tool for assessing AD health or resolving problems.  The utility can be downloaded <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D24745">here</a> .  You must select either the x86 or x64 version of the installer.  When MPSReports.exe is launched, the dialog box shown in Figure 2 appears. Note that MPS Reports requires administrative rights to collect correct information and requires the following components to be installed: Microsoft .NET Framework 2, Windows PowerShell 1.0, Windows Installer 3.1 and Microsoft Core XML Services 6.0. <br><br><img src="https://habrastorage.org/storage2/770/4cf/6dc/7704cf6dc4243b3ec83bd66bf485c4ac.jpg"><br><br>  Figure 3 shows the running diagnostic menu.  Previously, there were several versions of MPS Reports for Networking, SQL, Exchange, Active Directory and other components.  Now everything is included in one package and you just choose what you need.  To resolve AD issues, check General, Internet and Networking, Business Networks, Server Components, and Exchange Servers. <br><br><img src="https://habrastorage.org/storage2/e6b/591/cf2/e6b591cf2726c31986225983bfdb4b4d.jpg"><br><br>  Select ‚ÄúLink to more info‚Äù and you will see the files to which the utility collects information.  Click ‚ÄúNext‚Äù to start collecting data for diagnostics - it will take some time. <br>  The utility of MPS Reports is that the utility launches a number of command-line tools and procedures and provides the results in a simple file in which it is easy to find information.  For example, event logs can be collected in txt, ectx and cvs formats.  I like the cvs format the most.  You can open it in Excel and easily find or sort something, for example, by error text, event ID, etc.  Along with the txt version, cvs displays a description of the event for applications - so when you read them on your computer, you can see the description of events without downloading the application (for example, Exchange and SQL). <br>  MPS Reports allow you to save a CAB file to any location, or you can open it right away (Figure 4).  In the CAB file there will be one or several XML files (Fig. 5) that show different reports, so you will not need to run the micro reports one by one. <br><br><img src="https://habrastorage.org/storage2/574/f64/497/574f64497ab49cd9c661919e8b852660.jpg"><br><br><img src="https://habrastorage.org/storage2/410/0cb/56a/4100cb56a5400468fa6781a86c4a5463.jpg"><br><br><h4>  3. Repadmin and Replsum </h4><br><br>  Repadmin is a powerful command line tool for troubleshooting Active Directory issues.  The Replication Summary option, or the Replsum command, provides information on the replication status of all domain controllers in all domains in the forest.  When evaluating Active Directory health, it is extremely important to know whether all domain controllers are replicated - and for those that do not, you undoubtedly come to find out lately when replication took place and why it became unsuccessful. <br>  Repadmin allows you to quickly get answers to these questions.  You can save a lot of time with it, as opposed to the widely used Repadmin / showrepl, which shows all domain controllers in a long list.  The Replsum option analyzes all domain controllers in all domains in the forest and places information about them in a table that is easy to read.  Use the following command: <br>  Repadmin / bysrc / bydest sort: Delta&gt; repadmin.txt <br>  There are also other options and formats for this command, but I only use this one and it works great.  Table 1 shows an example of what we get at the output. <br><br><img src="https://habrastorage.org/storage2/f79/c5d/79f/f79c5d79fa691b86cdf8113a88d8252d.jpg"><br>  Notice that the Source DC is the Outbound Replication list and the Destination DC is the Inbound Replication list.  For example, at the top of the list, WTEC-DC2 is the source domain controller and has not replicated for more than five days.  This is outbound replication because WTEC-DC2 is the source when we get an error message.  Also, WTEC-DC1 did not perform inbound replication in the lower list, as it is the final domain controller.  (Destination DC).  The reason for this is indicated by event id 1722: RPC server is unavailable.  This error usually indicates that there is a communication error at the physical level in this domain controller. <br>  Here is my advice: if replication did not occur during the tomstone lifetime, the entry ‚Äúthe largest delta‚Äù will be displayed for&gt; 60 days.  This means that the domain controller does not have to be returned online, because it can introduce lingering objects.  You must manually downgrade and then upgrade the domain controller again. <br><br><h4>  4. DCDiag / Test: DNS </h4><br><br>  Besides replication, another common cause of AD problems is DNS.  DNS is often the cause of failed replication.  The problem is that in a large number of environments DNS servers are installed on all domain controllers in AD, and this leads to the fact that the likelihood that the DNS can fall is increased.  The study of each of them can take a lot of time.  In Windows Server 2003, / Test: DNS was added to the DC diag command.  Run the following command: <br><br>  DCDiag / Test: DNS / e / v&gt; DcdiagDNS.txt <br><br>  This command will analyze each DNS server on the network and test DNS server authentication, basic connection, sender configuration, delegation, dynamic registration and resource record registration.  For the last flagged one, DCDiag creates a test resource record and tries to register it.  If this cannot be done, new entries cannot be registered (which will lead to other problems). <br>  The team displays three potential outcomes: Pass (Pass), Fail (Failure) and Warn (Warning).  A warning is not yet a problem, but rather an occasion to conduct additional analysis.  For example, Warn in the Dynamic Registration (DYN) column means that protected dynamic updates are not activated.  This does not indicate a failure, but you must be 100% sure that you want everything to remain as it is. <br>  Table 2 shows typical team results. <br><br><img src="https://habrastorage.org/storage2/ee2/0fd/494/ee20fd49460b66a8e901975647786da5.jpg"><br><br>  Table 2 shows a complete and accurate report on all DNS servers in all domains on the network.  So we can check the health of the DNS.  This table appears at the end of the DCDiag output.  Details of these tests for each server are included in the DCDiag report before the final summary table is displayed.  If the user who ran the command does not have permissions in this domain, the tests will fail. <br>  In the above case, tests of the EMEA domain were unsuccessful, because the user who launched DCDiag did not have the necessary permissions.  ‚ÄúN / A‚Äù appears when the previous tests were unsuccessful, therefore, the remaining tests will depend on this ‚Äúfailure‚Äù.  For example, in the EMEA-DC03 domain, the Auth and Basc tests failed.  The remaining texts are shown as N / A.  DCDiag does not carry out further tests, but only places N / A in each column.  The Ext column is the fifth test to test external connectivity.  DCDiag / Test: DNS does not check it by default. <br>  Therefore, a tip: The list of domains and CD in the table is a convenient display of all domains in the forest and all CDs (which are DNS servers) in each domain.  Thus, we get a map of the structure of domains and CD.  In most environments, all CDs are DNS servers, so this is a convenient way to see domain and CD structures. <br><br><h4>  5. DNSCMD command line tool </h4><br>  If you are working on a remote system in an environment you are not familiar with, or if you just want to get information about the DNS environment you are working with, the DNSCMD team will give you all the necessary information.  Please note that I need this level of detail, because I diagnose problems without access to the environment, and therefore I depend on reports that could give me a complete picture.  Those commands that I use are presented in Table 3. I would recommend using them even if you can access the DNS server - sometimes it is much easier to look at the necessary information in a report than to ‚Äúroam‚Äù the DNS interface.  Also, these reports are periodically saved to files, so you can analyze the changes - especially if someone changed the config, and you want to know what the parameters were before.  And, of course, these commands can be presented as a table. <br><br><img src="https://habrastorage.org/storage2/2eb/384/9cb/2eb3849cb29ea5ebc8a32cd606708414.jpg"><br><br>  There are other tools, such as the Group Policy Management Console (GPMC), which is great for analyzing group policies.  GPMC also allows you to save a report on group objects as HTML in order to subsequently send it to support service for analysis.  GPMC is not included in MPS Reports. <br><br><h4>  Staying healthy! </h4><br><br>  The above tools allow you to quickly generate reports about the health of Active Directory, and indicate the presence of problems.  Of course, the administrator should make some effort to run them, but the process itself is simple - especially if you use MPS Reports.  In conclusion, my advice is: <br>  1. Use ADPBA as a tool for the widest perspective on AD health. <br>  2. Download and run MPS Reports to delve deeper into solving the problem. <br>  3. Run DCDiag / Test: DNS, Repadmin and Replsum as described above to get a quick and easy-to-understand snapshot of the replication and DNS configuration for the entire health of Active Directory and to highlight problem areas. <br>  4. Use DNSCMD to obtain detailed DNS configuration information for offline analysis and comparison with previous configurations. <br>  Nobody says that Active Directory management is a simple matter.  But the application of the recommendations described should provide better monitoring and management of Active Directory, providing a more secure administration environment. <br><br>  Source: <a href="http://redmondmag.com/Articles/2012/07/01/5-Free-Microsoft-Tools-for-Top-Active-Directory-Health.aspx%3FPage%3D1">redmondmag.com/Articles/2012/07/01/5-Free-Microsoft-Tools-for-Top-Active-Directory-Health.aspx?Page=1</a> <br><br>  <i>PS Want to keep abreast of changes in Active Directory?</i>  <i>Our NetWrix AD Change Reporter program allows you to receive notifications and reports on any changes in AD.</i>  <i>Learn more about the program's features by downloading a <a href="http://www.netwrix.com/ru/active_directory_change_reporting_freeware.html">20-day trial version</a> or by <a href="http://www.netwrix.com/ru/weekly_adcr_webinar.html">registering for a regular webinar</a> .</i> </div><p>Source: <a href="https://habr.com/ru/post/147965/">https://habr.com/ru/post/147965/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../147958/index.html">Basics of programming for children and the humanities - no computers in the classroom!</a></li>
<li><a href="../147959/index.html">Attack on Steve Mann due to augmented reality glasses</a></li>
<li><a href="../147960/index.html">Blackberry jam for green men</a></li>
<li><a href="../147963/index.html">Python Prefix Trees</a></li>
<li><a href="../147964/index.html">Simple automation: photo album</a></li>
<li><a href="../147966/index.html">Coursera is a small revolution: +12 universities,> 100 online courses</a></li>
<li><a href="../147969/index.html">Project vs Department</a></li>
<li><a href="../147970/index.html">Wireless chargers: updates, work principles and good news</a></li>
<li><a href="../147971/index.html">The next interview - the look of the employer</a></li>
<li><a href="../147973/index.html">K-means clustering with Euclidean and Mahalanobis distance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>