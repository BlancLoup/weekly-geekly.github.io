<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Meeting Room Little Helper</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I will tell you about the application that was created in Arcadia for the convenience of booking meeting rooms. 

  

 There are two main scenar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Meeting Room Little Helper</h1><div class="post__text post__text-html js-mediator-article">  Today I will tell you about the application that was created in Arcadia for the convenience of booking meeting rooms. <br><br> <a href=""><img src="https://habrastorage.org/webt/in/13/mz/in13mzeaark_jofotlnhcini5uw.jpeg"></a> <br><br>  There are two main scenarios for using this application: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>1. Search for free room</b> <br>  A lot of meetings are held in the company every day; managers, developers and employees of the HR department reserve negotiations.  Finding a meeting room can be quite a long and routine exercise.  To understand which room is currently free, you need to go to the Outlook calendar (or open the door, distracting the attention of the meeting participants), view the full schedule by room, find an empty time slot and create an appointment.  During this time, someone from the staff can book a room, and then you need to start the search again.  It is much more convenient to make a reservation by pressing a single button using the application, having received prompts about the status of rooms in advance. <br><br>  <b>2. Ad hoc booking</b> <br>  Quite often there is a situation when you need to gather for 15 minutes to briefly discuss the current project tasks.  In this case, it makes no sense to occupy a room for a whole hour, but there may not be free slots for the selected time.  But if it remains at least 10 minutes before the next rally, the application will allow you to book a room, and for a short meeting this may be quite enough.  Also sometimes there is a situation when the room was booked for a long time, for example, 2 hours, but the rally ended earlier.  In this case, at the end of the rally, you can click on the cancel button and empty the room. <br><a name="habracut"></a><br><h4>  Choosing a platform to solve </h4><br>  Android was originally chosen as the operating system, since it supports customization (including on-off on schedule, autorun applications), and a large number of device models are on sale. <br><br>  It was considered several options.  As an information board, there is no need to choose a top tablet model: a separate device is required for each room, and as the price of one tablet rises, the cost of the final solution increases significantly.  But at the same time, it is impossible to take the cheapest devices - they have a weak, "muddy" IPS matrix, low resolution, outdated OS version, and such a solution would look very unpresentable.  As a result, we made a choice in favor of the Alcatel OneTouch Pixi 3 (10) 3G - a tablet with quite average characteristics: 1280x800 TFT IPS, Android 5.1, 1 GB RAM, MediaTek MT8321 1300 MHz processor, in which the 3G module goes in addition for a fairly reasonable price - about 8 thousand rubles (currently the cost of the device is lower). <br><br>  To lock the hardware keys and screen system elements, we ordered a black Plexiglas housing.  The housing acts as a protective cover and mounting the device on the wall and has holes for installation.  At the moment, there are 5 tablets installed at the entrance to each of the meeting rooms.  Our conversations are named after classic programming languages: Cobol, Prolog, Fortran, Ada, Pascal, each has its own icon that is displayed on the screen next to the room number. <br><br> <a href=""><img src="https://habrastorage.org/webt/cm/wz/fe/cmwzfekk6fadtqi9iddmajrjjwu.png"></a> <br><br>  The application allows you to book a room (create an appointment) for a specified period of time: 15, 30, 45 minutes, as well as 1, 1.5, 2 hours.  If the user chooses to choose an interval of 2 hours, and the room is free only a fraction of this time, then the reservation will be offered, taking into account restrictions.  The bottom panel of the application displays the current statuses of other meeting rooms: red - the room is busy, green - free, and gray if you have problems getting status (for example, a failure occurred while requesting status). <br><br>  Key application functionality and wow factor is face recognition using the <a href="https://azure.microsoft.com/ru-ru/services/cognitive-services/face/">Microsoft Face API</a> .  Each time you make a reservation using the front camera, a snapshot of the user is created, which is used to match the previously processed list of photos of employees from Exchange.  If the user was successfully recognized, the name of the reservation is indicated in the reservation name, i.e.  you do not need to manually enter the author of the rally, which saves time.  Recognition is affected by the lighting of the room, and most importantly - the original photo of the user, loaded as an avatar. <br><br><h4>  Development and Planning </h4><br>  At the planning stage of development, the question arose which of the existing access solutions could be used to book rooms and get statuses - the Office 365 Android SDK or EWS API.  As it turned out, the functionality of the <a href="https://github.com/alipov/ews-android-api">EWS Java API</a> adapted for Android (the <a href="https://github.com/OfficeDev/ews-java-api">official version of the EWS Java API</a> ) is more universal and allows you to connect to both the cloud version and the local Exchange. <br><br>  Initially, the company set up an on-premises Exchange, but our IT specialists were just planning to migrate to Office 365 Exchange Online, so the task was to use the most versatile solution so that the transition would not lead to a significant change in the code.  Migrating to the cloud API required changing the accounts in the application and changing the URL (setUrl method of the ExchangeService class): On-premises Exchange requires the base URL <a href="">https: //mail.DOMAIN/EWS/Exchange.asmx</a> , where DOMAIN is the company's domain name, and for Office 365 Exchange Online - <a href="">https://outlook.office365.com/EWS/Exchange.asmx</a> .  (manual configuration is required if Autodiscover does not work) <br><br><h4>  Integration features </h4><br>  When integrating the EWS API, there were difficulties due to the fact that the library was written primarily for Java SE and pulls the outdated Apache Http Client and DNS client (unlike the Office 365 SDK, which is built on a more modern architecture). <br>  The problem with the Apache Http Client was solved by adding a line to the defaultConfig build.gradle of the application module: <br><br><pre><code class="bash hljs">useLibrary <span class="hljs-string"><span class="hljs-string">'org.apache.http.legacy'</span></span></code> </pre> <br>  Client support has been removed since Android SDK 23 (6.0), therefore at this time this setting is required for all legacy libraries using the apache client.  As a DNS client, the minimalistic <a href="https://github.com/MiniDNS/minidns">MiniDNS</a> (minidns-core) was perfect. <br><br>  Calls to the API are most conveniently wrapped using RxJava, since  they are processed synchronously and block the UI stream.  For example (RxJava 1): <br><br><pre> <code class="java hljs">Observable.create(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Observable.OnSubscribe&lt;Boolean&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Subscriber&lt;? </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">super</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Boolean&gt; subscriber)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  Exchange API } }) .subscribeOn(Schedulers.io());</span></span></code> </pre><br>  If the room was booked using the app, you can cancel the reservation or extend it.  In the case of extension, the user will be offered the maximum available time.  To cancel reservations made under the user's personal account, use the desktop or mobile version of Outlook. <br><br> <a href=""><img src="https://habrastorage.org/webt/op/9n/t8/op9nt8xddaruhemuzagqxmjcu9g.png"></a> <br><br>  If the user who created the current rally has an avatar installed, it will be displayed by clicking on the room icon.  Photos are stored at (for Office 365 Exchange Online): <br>  <a href="https://outlook.office365.com/EWS/Exchange.asmx/s/GetUserPhoto%3Femail%3DEMAIL%26size%3DSIZE">https://outlook.office365.com/EWS/Exchange.asmx/s/GetUserPhoto?email=EMAIL&amp;size=SIZE</a> <br><br>  Where EMAIL is the user's email address, and SIZE is the size of the photo, for example, HR96x96.  More information can be found on the <a href="https://msdn.microsoft.com/en-us/library/jj194329(v%3Dexchg.80).aspx">MSDN</a> page. <br><br>  When setting up accounts for rooms there is one important feature.  There should be two types of accounts - one to get information about the status of all rooms (with full rights) and the second to book.  If you make a reservation using the admin account, the appointment may be created on top of existing ones, this must be remembered so that there is no confusion. <br><br>  To simplify the installation of future updates, devices are configured to receive Firebase Push Notifications.  When creating a push message, you can specify a specific device (room number) or all devices to update simultaneously.  As soon as the notification arrives, the download of the installation package (APK) from the company's internal FTPS server begins.  Android security restrictions require manual confirmation of the installation, but usually this process does not take more than a couple of minutes. <br><br>  You may have noticed the QR code next to the room icon.  It is made for receiving feedback, you can open the link on your mobile device and leave feedback about the application if you have any problems with the use. <br><br> <a href=""><img src="https://habrastorage.org/webt/sr/k9/qt/srk9qtzisfqiwao7paxxvlhq_tc.png"></a> <br><br><h4>  Problems and solutions </h4><br>  As it turned out, it is rather difficult to negotiate with the business center about connecting electricity to installed tablets (there are no outlets on the walls and under the ceiling), so it was decided to make power based on compact 18 Ah lithium batteries (power bank).  To save energy, the tablets are set to turn off at 20:00 and turn on daily at 8:00 on weekdays, which allows for less frequent battery changes. <br><br>  Our sysadmins set up a separate Wi-Fi network for devices and turned on filtering by IP addresses (Cisco‚Äôs software does not have URL filtering) for security.  Unfortunately, it was not possible to use familiar tools, such as Fabric Crashlytics, for tracking errors, since  IP addresses periodically changed, but it was possible to open access to Firebase without problems (which allows using push notifications and storing logs in a database) and Azure Cloud (Microsoft Face API). <br><br>  At the moment, our solution for booking rooms is actively used, the tablets are synchronized daily for one and a half years.  After initial debugging and testing of the application, no problems were found, except for one bug with updating the data on the screen, which was decided to clear the application cache.  Customers visiting our office show interest in the product and appreciate its convenience.  In the future we plan to add additional logging in Firebase, as well as the possibility of notifications by mail to inform about the status of the charge (the need to change the Powerbank). </div><p>Source: <a href="https://habr.com/ru/post/348034/">https://habr.com/ru/post/348034/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348022/index.html">Game development under NES in C. Chapters 1-3. From introduction to Hello World</a></li>
<li><a href="../348024/index.html">SecurityWeek 2: army of clones, Google hunts for ghosts, Blizzard patches</a></li>
<li><a href="../348026/index.html">Installing Linux without .ISO and virtualization</a></li>
<li><a href="../348028/index.html">Convolutional neural network, part 2: training in the error back-propagation algorithm</a></li>
<li><a href="../348032/index.html">Mobility Express - when they decided to migrate and scale the wireless network, but as always, there is no money</a></li>
<li><a href="../348036/index.html">Software sound synthesis on early personal computers. Part 1</a></li>
<li><a href="../348038/index.html">WSTester - JS library for testing web services with WebSocket</a></li>
<li><a href="../348040/index.html">How Atlassian has built a $ 10 billion business. Part 2</a></li>
<li><a href="../348042/index.html">Developing a PCI device driver for Linux</a></li>
<li><a href="../348044/index.html">Rook - "self-service" data store for Kubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>