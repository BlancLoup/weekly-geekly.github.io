<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Windows Installer: what the vendor ordered</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing the theme of working with Windows Installer, today I propose to talk about ready-made installers provided by software manufacturers - the t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Windows Installer: what the vendor ordered</h1><div class="post__text post__text-html js-mediator-article">  Continuing the theme of working with Windows Installer, today I propose to talk about ready-made installers provided by software manufacturers - the term vendor MSI is widely used to refer to them. <br><br>  As you remember from the <a href="http://habrahabr.ru/company/infopulse/blog/134119/">previous article</a> , Windows Installer is an industry standard installation file and is used in most application deployment systems.  Vendor MSI is very convenient for system administrators involved in deploying software in corporate networks.  It would seem that it is enough to take the installation parameters from the documentation, use them in the command line or in the transform - and it's done.  Is everything so simple? <br><br>  I suggest to look inside several vendor MSI and deal with their device. <br><a name="habracut"></a><br>  There are exceptions to every rule.  Despite the fact that the installation package was tested by the manufacturer, be prepared to face unforeseen behavior during the installation process that arises precisely in your unique conditions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Naturally, when preparing an application for deployment in a corporate environment, one should be guided primarily by the recommendations of the software manufacturer.  However, sometimes the deployment system understands only the MSI format, and the vendor provides only an exe-installer - in this case it makes sense to try to get exactly the vendor MSI. <br><br><h5>  Where to get vendor MSI? </h5><br>  Suppose you need to deploy some application in our network.  We usually have an installation package received from the software manufacturer - copied from the installation disk, downloaded from the official site, etc. <br>  If we do not have the installation package, go to the <s>manufacturer‚Äôs root-tracker</s> site and look for the package there.  The site does not have a package in the format of MSI, only the online installer or setup.exe?  Let's try to look better.  Often, the msi file for corporate users, along with the deployment instructions, is not on the main page, but in the section of the site with a loud name like ‚ÄúFor business‚Äù (for example, <a href="http://www.google.com/apps/intl/en/business/chromebrowser.html">Google Chrome</a> or <a href="http://www.skype.com/intl/en-us/business/download/">Skype</a> ), or on the manufacturer's <a href="">ftp</a> .  If there is a choice of online and offline installer - choose the offline option. <br><br>  A simple rule - the installation package (in any format) can be downloaded only from the official site (or ftp) of the manufacturer.  NEVER download the installer from the ‚Äúfile archives‚Äù and ‚Äúprogram directories‚Äù, so as not to face an <a href="http://habrahabr.ru/blogs/infosecurity/135716/">unpleasant surprise</a> . <br>  Naturally, the full version of paid applications like Adobe Creative Suite you will not find in the public domain.  If you have a license for the corporate version, but there are no installation files, feel free to contact the manufacturer's support service. <br><br>  So, we have an installation package.  If it is a file with the .msi extension, we are dealing with vendor MSI (thanks, Cap!).  If the installer contains a set of files, among which there is a file (s) with the .msi extension, this is also a candidate for the title of vendor MSI.  If the installer is a file with the .exe extension, it should not be immediately discounted - there are chances that this is a ‚Äúwrapper‚Äù and the vendor MSI will show up inside again. <br><br>  This can be verified by: <br>  ‚Ä¢ Try to open the exe file using an archiver (7-zip, WinRAR). <br>  ‚Ä¢ Start the installation of the application from the existing exe-file and look into the temporary folders (% temp%).  Usually, during installation, a folder with a random name is created, it contains installation files, including the msi file.  Copy the installation files in a safe place - after the installation process is completed, the temporary folder is deleted. <br>  ‚Ä¢ Look at the event logs at the end of the installation and check for the presence of fresh event records with the MsiInstaller source. <br>  ‚Ä¢ <i>your option?</i> <br><br>  Let's start with a simple experiment on the <a href="http://www.apple.com/itunes/download/">iTunes</a> installer - open the iTunesSetup.exe file using 7-zip and see that it includes five msi files at once (I suggest you decide how many of them are ‚Äúsuperfluous‚Äù). <br>  Making sure that we are dealing with vendor MSI, we continue to research. <br><br>  For convenience, I propose to highlight the main categories of vendor MSI.  The classification is completely conditional and based only on personal experience. <br><br><h5>  By type of resources: </h5><br>  ‚Ä¢ ‚ÄúClean MSI‚Äù <br>  ‚Ä¢ "Combined MSI" <br><br><h5>  By type of setting: </h5><br>  ‚Ä¢ MSI with easy setup via transform or parameters <br>  ‚Ä¢ MSI with setup wizard <br>  ‚Ä¢ MSI with answer file <br><br>  Now about each a little more detail and with examples. <br><br><h4>  "Pure MSI" </h4><br>  A common property of this type of installer is the use of Windows Installer native mechanisms for installing files and registry keys.  The records corresponding to these resources are present in the MSI tables (File, Registry, Shortcut, etc.).  To make changes to the installation, it is enough to edit the records of these tables in the transform - you have almost complete control over the installation process. <br><br>  Simple examples of "pure MSI" - <a href="http://www.skype.com/intl/en-us/business/download/">Skype</a> , <a href="http://www.instedit.com/download.html">InstEd</a> . <br>  To diagnose problems with such installers, the standard features are used - reading event log entries (Application log, events with the MsiInstaller source) or full installation logging (running msiexec with the / l * v &lt;install.log&gt; parameter). <br><br><h4>  "Combined MSI" </h4><br>  In this category, I took installers in the Windows Installer format, installing resources in a way that is not standard for Windows Installer.  In this case, the Windows Installer is used for auxiliary tasks, and the binary Custom Action (.dll or .exe) performs the bulk of the work. <br><br>  Example one is Google Chrome for Business. <br><img src="https://habrastorage.org/storage2/299/944/352/299944352e28b6566b79b76c548387e1.png"><br>  It is clearly seen that the File table in the installer is absent altogether, and the main part of the installation is performed by a binary Custom Action called DoInstall, inside it there are files that will be installed into the system. <br><br>  Another interesting example is the Java Runtime Environment.  Extract the msi-file with the accompanying cab-file from the <a href="&amp;xid=17259,15700002,15700019,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhgr4NBrJOD7FwjpnFA">offline installer</a> , distributed in the format of the exe-file. <br>  The File Table of this vendor MSI contains only four entries, the main application files are located inside the zip archive (which in turn is inside the cab file) and then unpacked during the installation process: <br><img src="https://habrastorage.org/storage2/9d7/000/5a9/9d70005a9b4174c8aeece75508f35610.png"><br>  The regutils.dll file is responsible for the main part of the installation process, the Custom Actions names are quite eloquent: <br><img src="https://habrastorage.org/storage2/71c/b80/a36/71cb80a3651c6fe8c46f69d5c7b2150c.png"><br><br>  This type of installer is somewhat harder to diagnose errors - the Windows Installer logs will give us useful information only until the launch of the internal exe-file, and the exe-file does not always generate intelligible messages when errors occur.  Also such vendor MSI harder to customize.  Rather, our ability to customize the installation process is often limited only by the settings provided by the software manufacturer.  For example, a software manufacturer does not always provide for the ability to disable the installation of shortcuts or make changes to the application settings files during its installation. <br><br>  Installers of this type sometimes present unpleasant surprises during the installation process (you had to deal with the JRE and Adobe Flash Player, which fell to the execution of the Custom Action), and it may take some time to diagnose and correct errors. <br><br>  We now turn to the options for customizing packages offered to us by software manufacturers. <br><br><h4>  MSI with easy setup via transform or parameters </h4><br>  This is the most common way - most vendor MSIs have the ability to do this.  Typically, the manufacturer has already provided the most popular settings, such as disabling the auto-updates of the application and the settings for connecting to the server, and described this in the documentation.  Settings can be described as installer command-line parameters, MSI parameters (MSI properties), or even registry entry descriptions that you can add to the transform for a package. <br>  It is worth mentioning that sometimes in a newer version of the vendor MSI, the parameters may not behave as in the previous one (or stop working altogether, as once happened with the <a href="http://bugs.sun.com/bugdatabase/view_bug.do%3Fbug_id%3D6294083">JRE</a> autoupdate disable options that stopped working), but this is extremely rare. <br><br><h4>  MSI with setup wizard </h4><br>  Some vendors are not limited to publishing a list of command line parameters for installing and configuring the package.  They provide a utility for tweaking the installer that performs several useful functions: <br>  ‚Ä¢ An intuitive interface saves the system administrator from having to open the msi file in the editor and manually change a large number of records in the tables. <br>  ‚Ä¢ The utility usually provides some ‚Äúprotection against a fool‚Äù and checks the correctness of the values ‚Äã‚Äãof variable parameters. <br><br>  As a result of the configuration wizard for the msi file, a transform is formed that will be used when the package is deployed.  Naturally, you can view the contents of the saved transform by applying it to the open msi file in the editor. <br>  A good example of this approach is the <a href="http://www.adobe.com/support/downloads/detail.jsp%3FftpID%3D4950">Adobe Customization Wizard</a> , which is used to customize the Adobe Reader and Adobe Acrobat installation settings: <br><img src="https://habrastorage.org/storage2/594/85a/10a/59485a10a04a291ad8be98b3d44dde73.png"><br><br>  Another example of a famous wizard is the <a href="http://technet.microsoft.com/ru-ru/library/cc764476(v%3Doffice.12).aspx">Office Customization Tool (OCT)</a> .  This utility allows you to configure a large number of parameters related to the installation and user settings of MS Office.  As a result of the wizard, an MSP file is created (a patch in the terminology of the Windows Installer), which is used in the further <a href="http://technet.microsoft.com/ru-ru/library/cc179097(v%3Doffice.12).aspx">deployment of</a> MS Office in a corporate environment. <br><br><h4>  MSI with answer file </h4><br>  This type of installation package should rather be called ‚ÄúSetup.exe with an Answer File‚Äù.  The idea is that a certain installation file (let's call it Setup.exe) reads a configuration file previously generated by the system administrator (config.xml) and generates a set of parameters for running the installation msi-file located next to it (or several msi-files). <br>  This approach does not provide for our work directly with the msi-file, so we will not dwell on it in too much detail.  I will mention examples of such installers ‚Äî Adobe Creative Suite <a href="http://kb2.adobe.com/cps/400/kb400588.html">configuration files</a> (CS2-CS3 versions), as well as the use of the <a href="http://technet.microsoft.com/en-us/library/cc179195.aspx">config.xml</a> answer file for installing MS Office. <br>  Usually for diagnostics in case of installation problems you can use the log file created by the installer with a description of the stages of execution;  Additional information from the Windows Installer also gets into the event logs. <br><br>  As you can see, completely different installers sometimes hide behind the generic name vendor MSI.  I hope this review article helped you get an idea of ‚Äã‚Äãtheir diversity and possible installation problems and how to diagnose them. </div><p>Source: <a href="https://habr.com/ru/post/139213/">https://habr.com/ru/post/139213/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../139204/index.html">trace DTMF on cisco</a></li>
<li><a href="../139205/index.html">Winner Lenovo Do Network will develop a personal 3D printer</a></li>
<li><a href="../139206/index.html">Cofoja: A practical library for contract programming. Part 1</a></li>
<li><a href="../139207/index.html">To February 23 live well</a></li>
<li><a href="../139210/index.html">HTML data- * attributes for storing parameters and getting them in js</a></li>
<li><a href="../139217/index.html">Excursion to the Moscow data center Rostelecom</a></li>
<li><a href="../139218/index.html">Insurgent Games makes all games free and translates into open source</a></li>
<li><a href="../139219/index.html">7 major trends in the mobile industry</a></li>
<li><a href="../139220/index.html">Wireless HD video and audio transmission using video senders, digest - spring'12</a></li>
<li><a href="../139223/index.html">Windows Server 8 Beta</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>