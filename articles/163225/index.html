<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ASP.NET MVC 4 Mobile Features Obsolete Faster than Appeared</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What are Mobile Features in ASP.NET MVC 4 
 ASP.NET MVC 4 came out with a very expected and long-awaited new feature - what is in English called Mobil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ASP.NET MVC 4 Mobile Features Obsolete Faster than Appeared</h1><div class="post__text post__text-html js-mediator-article"><h4>  What are Mobile Features in ASP.NET MVC 4 </h4><br>  ASP.NET MVC 4 came out with a very expected and long-awaited new feature - what is in English called Mobile Features - support for mobile devices.  By and large, the name was immediately surprised, since it differs slightly from the technical description of the innovation.  But promotion is promotion.  All references to page templates (layout) with HTML 5 support, specifying viewport, CSS media - all this has no direct relation to the MVC framework. <br><br>  Only two points can be attributed to the new features of the framework itself: <br><ul><li>  creation of View and templates specific to mobile browsers </li><li>  the ability to change on the fly what the View will be rendered to the user - namely, to switch in runtime between the various View </li></ul><br>  And here it is immediately worth noting that the word ‚Äúmobile‚Äù is mentioned exclusively for promotional purposes.  MVC 4 allows you to create multiple View for each of the required pages and determine for which browser each of them should be displayed.  That is, the possibilities are in no way limited to mobile browsers. <br><br><h4>  All ingenious is simple - ‚Äúhook‚Äù in ViewEngine </h4><br>  The implementation of this feature is very simple.  This is just a ‚Äúhook‚Äù in ViewEngine. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You make different pages (Views) for different devices or browsers.  Name the files by adding the keyword: <br><ul><li>  Catalog.cshtml </li><li>  Catalog.iPhone.cshtml </li></ul><br>  Specify the criterion by which the desired View will be selected - using the DisplayModeProvider, specify the desired DefaultDisplayMode with the desired name. <br><br><pre><code class="cs hljs">DisplayModeProvider.Instance.Modes.Insert(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DefaultDisplayMode(<span class="hljs-string"><span class="hljs-string">"iPhone"</span></span>) { ContextCondition = (context =&gt; context.GetOverriddenUserAgent().IndexOf (<span class="hljs-string"><span class="hljs-string">"iPhone"</span></span>, StringComparison.OrdinalIgnoreCase) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) });</code> </pre> <br>  In runtime, when the controller's method has been processed, the prepared ViewResult is passed to the View Engine, the DisplayModeProvider conditions are checked, it changes the name of the View file to be loaded. <br><br><h4>  Can we really use it? </h4><a name="habracut"></a><br>  Of course we can.  But only in very simple cases.  The main disadvantage is that <b>all the Views you make for the page are processed by the same controller method.</b>  Sooner or later, it becomes a problem. <br><br>  The time has already come when the website should support browsers not only on desktop computers, laptops and mobile devices, but also on TVs.  And to mobile devices include ordinary phones, smartphones and tablet computers.  And you will agree - if the appearance on the tablet and smartphone can still be the same, with the same JavaScript widgets, then for ordinary cell phones, of which there are still many, it is difficult to provide the same presentation and the same Web UI capabilities. <br><br>  Support simultaneously smartphones and tablets at a glance does not look so complicated - the difference in screen size.  But in a larger area you can place more information or more user-defined functions, and not just increase the size of the images. <br><br>  TV support looks like a very simple task.  Full HD means the same screen size in pixels.  But the pros are over. <br><br>  It turns out that if your site was opened from TV, it could be opened in browsers on: <br><ul><li>  Phillips Smart TV - NetTV SDK - site on CE-HTML </li><li>  Samsung Smart TV - Samsung has its own SDK, the possibilities are very different from NetTV </li><li>  LG Smart TV </li><li>  with XBOX 360 - Internet Explorer </li><li>  from PlayStation 3 </li><li>  from Wii console </li><li>  with Google TV, Sony TVs with integrated Google TV </li><li>  with Apple TV </li><li>  Boxee box, Kylo browser, Roku and others </li></ul><br>  To make the version of the site equally convenient for all these devices is not very realistic.  If you want to take advantage of all the additional features that these devices provide you as developers, then doing it in one version of the site becomes not rational.  And some opportunities, believe, are worth to use them. <br><br>  For example, the usual Internet Explorer works on XBOX, the screen width is quite sufficient to work with the usual desktop version of the site, but the user is forced to move the cursor on the joystick.  In order to press a button on the screen, he needs to hover the cursor on it and press the button on the joystick.  It becomes obvious that a more suitable interface is an interface for tablets, with large rectangular buttons.  Comboboxes are also not convenient.  Scrolling through the page on the joystick is quite convenient. <br><br>  On SmartTV, you will have to rely on the fact that there is no cursor and the user runs along the buttons and inputs on the page by pressing the up / down / left / right buttons on the remote.  In order to support other buttons on the console that simplify navigation, you will have to read the documentation from the SDK and write JavaScript specific to a particular device - the key codes are different. <br><br>  And this is only if you start looking at televisions.  There are also many interesting things with smartphones and tablets, but this is a more common and often discussed topic. <br><br>  It is necessary to start working in this direction and very quickly the question arises that the versions of sites for desktops, mobile devices and TVs should be different.  And should differ not only in View.  There should be different models, which means it is best when different methods of controllers work with them. <br><br><h4>  What can be offered in return? </h4><br>  It is clear that the simplest thing is to immediately make different sites for different devices and redirect to the right one.  Discard such a solution as too simple.  You can roll back to this option at any time. <br><br>  Of course, you can make different methods for different devices in the same controller, but I would like a more convenient and beautiful solution. <br><br>  Given the architecture of ASP.NET MVC 4, there is only one option.  Inside the MVC application (project), each version of the site must be executed in its own Area.  According to the User Agent String, we can determine from which device / browser the request arrives and send it to the desired Area. <br><br>  To forward to the desired Area, you need to add a restriction (Constraint) for each route (Route) in the routing table. <br><br>  <b>The disadvantage of this approach is that such a restriction must be remembered to be added to all routes.</b> <br><br>  For example, if we made the Area to which you want to redirect everyone with the Chrome browser, then Area Registration will look like this: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ChromeAreaRegistration</span></span> : <span class="hljs-title"><span class="hljs-title">AreaRegistration</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> AreaName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Chrome"</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RegisterArea</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AreaRegistrationContext context</span></span></span><span class="hljs-function">)</span></span> { context.MapRoute( <span class="hljs-string"><span class="hljs-string">"Chrome_default"</span></span>, <span class="hljs-string"><span class="hljs-string">"{controller}/{action}/{id}"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { controller = <span class="hljs-string"><span class="hljs-string">"Home"</span></span>, action = <span class="hljs-string"><span class="hljs-string">"Index"</span></span>, id = UrlParameter.Optional }, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { isChromeBrowser = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IsChromeConstraint() } ); } }</code> </pre><br>  In this case, the restriction will look like this: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">IsChromeConstraint</span></span> : <span class="hljs-title"><span class="hljs-title">IRouteConstraint</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Match</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpContextBase httpContext, Route route, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> parameterName, RouteValueDictionary values, RouteDirection routeDirection</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> userAgent = httpContext.Request.UserAgent; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(userAgent)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> userAgent.Contains(<span class="hljs-string"><span class="hljs-string">"Chrome"</span></span>); } }</code> </pre><br>  At the same time, we have a main Area where all other browsers except Chrome should go. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DesktopAreaRegistration</span></span> : <span class="hljs-title"><span class="hljs-title">AreaRegistration</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> AreaName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Desktop"</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RegisterArea</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AreaRegistrationContext context</span></span></span><span class="hljs-function">)</span></span> { context.MapRoute( <span class="hljs-string"><span class="hljs-string">"Desktop_default"</span></span>, <span class="hljs-string"><span class="hljs-string">"{controller}/{action}/{id}"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { controller = <span class="hljs-string"><span class="hljs-string">"Home"</span></span>, action = <span class="hljs-string"><span class="hljs-string">"Index"</span></span>, id = UrlParameter.Optional }, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { isNotChromeBrowser = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IsNotChromeConstraint() } ); } }</code> </pre><br>  in it, we also need to use a restriction that filters browsers cutting off Chrome: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">IsNotChromeConstraint</span></span> : <span class="hljs-title"><span class="hljs-title">IRouteConstraint</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Match</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpContextBase httpContext, Route route, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> parameterName, RouteValueDictionary values, RouteDirection routeDirection</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> userAgent = httpContext.Request.UserAgent; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(userAgent)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !userAgent.Contains(<span class="hljs-string"><span class="hljs-string">"Chrome"</span></span>); } }</code> </pre><br>  It is necessary to set restrictions for all routes in all Area, despite the fact that routes in runtime are viewed from top to bottom.  The fact is that the procedure for registering an AreaRegistration at random is random.  This can be avoided by registering the routes of all Area in one place - in Global.asax - clearly indicating their order.  Then you can guarantee that the check on Chrome browser will always happen first. <br><br><h4>  P.S </h4><br>  If you get bored with it, you can always easily bring each Area into a separate application and host on different domains. </div><p>Source: <a href="https://habr.com/ru/post/163225/">https://habr.com/ru/post/163225/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../163209/index.html">How much are unsuccessful online projects for the studio?</a></li>
<li><a href="../163215/index.html">Barmen, relay race and rattling pears</a></li>
<li><a href="../163217/index.html">Qt 5.0.0 is out!</a></li>
<li><a href="../163221/index.html">Announcement of Shop-Script 5</a></li>
<li><a href="../163223/index.html">Mozilla developers: ‚ÄúIf you don‚Äôt want to pay 30% tax, you will like Firefox OS!‚Äù Include an open-source alternative to iOS and Android in your plans!</a></li>
<li><a href="../163227/index.html">Connection of third-party tools in IntelliJ IDEA using pylint as an example</a></li>
<li><a href="../163229/index.html">Classic hosting model vs Windows Azure</a></li>
<li><a href="../163231/index.html">We make a charge indicator and mileage for electric cars</a></li>
<li><a href="../163233/index.html">Kodak has already found buyers for their patents.</a></li>
<li><a href="../163237/index.html">The end of the world is not a reason not to program with pleasure!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>