<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Standards symmetric encryption CIS countries in Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The first weeks of the new year are the best time to sit comfortably at the window, to remember what the past year brought us. 
 And he brought us two...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Standards symmetric encryption CIS countries in Python</h1><div class="post__text post__text-html js-mediator-article"><img width="20%" height="20%" src="https://habrastorage.org/files/7d8/0ed/ee6/7d80edee6cf044c983f366cbb12ccd53.png" alt="image" align="left"><br>  The first weeks of the new year are the best time to sit comfortably at the window, to remember what the past year brought us. <br>  And he brought us two new encryption standards.  Russian standard GOST R 34.12-2015 (Grasshopper block cipher).  And Ukrainian DSTU 7624: 2014 (Kalina Kalina block code).  On cold, winter evenings, one cannot miss such a good reason to swim.  Under the cat a brief description of the algorithms and their implementation in Python.  And in order for the new ciphers to be more fun, we will dilute their society with the Belarusian STB 34.101.31-2007. <br><a name="habracut"></a><br><h4>  GOST R 34.12-2015 </h4><br>  I propose to start with the Russian standard - the block cipher Grasshopper.  The length of the input cipher block is 128 bits, the key length is 256 bits. <br>  The following transformations are used in the cipher: <br><ul><li>  <b>X</b> - bitwise modulo addition with the key: <br><img src="https://habrastorage.org/files/dc7/6b4/0a3/dc76b40a3f404b17ab19109ddcba14f9.PNG"></li><li>  Nonlinear transformation <b>S is</b> carried out by replacing each byte by substituting from table œÄ: <br><img src="https://habrastorage.org/files/8f9/f6e/26b/8f9f6e26b102409ca7f875456737ed6c.PNG"></li><li>  The linear transformation <b>L</b> is realized by multiplying over a Galois field modulo a polynomial <img src="https://habrastorage.org/files/b1e/043/e29/b1e043e292f64d7c81454ff8b86f42b4.PNG">  : <br>  Œî is the mapping that associates a binary line with an element of a finite field. <br><img src="https://habrastorage.org/files/ea5/948/420/ea59484202f34d37b6b7b4d617fb2671.PNG">  - mapping associating a binary string to an element of the target field. <br><img src="https://habrastorage.org/files/573/dc2/d97/573dc2d976a54463ab813982e11cb6f1.PNG"><br>  When calculating <img src="https://habrastorage.org/files/62e/206/839/62e20683911b457db90140ff96f7fc47.PNG">  operations of addition and multiplication are performed in a finite field. <br><img src="https://habrastorage.org/files/8e8/575/3fa/8e85753fa3124722893185001ae686ad.PNG"><br><img src="https://habrastorage.org/files/a2c/3aa/f14/a2c3aaf14503495aa9271ff231552a74.PNG"></li></ul><br>  The procedure for encrypting a 128-bit block <b>a is</b> formally described by the expression: <br><img src="https://habrastorage.org/files/063/f9b/276/063f9b2768dc4c4395c4e4e712e0fee8.PNG">  . <br>  What in a more visual form looks like this: <br><img width="30%" height="30%" src="https://habrastorage.org/files/819/fad/591/819fad5913e84248a47716cfe313f100.png"><br><br>  The 128-bit round keys K <sub>1</sub> , K <sub>2</sub> are obtained by splitting the main 256-bit key in half. <br>  With their help, the following round keys are calculated: <br><img src="https://habrastorage.org/files/d56/134/551/d56134551d9c4deca19b49d15c81b199.PNG"><br><img src="https://habrastorage.org/files/f25/d63/1c6/f25d631c62324992ae0b9c1ac3dff16a.PNG"><br><img src="https://habrastorage.org/files/10a/0d3/8c8/10a0d38c8a2a4b0ab85f5ee979d526b1.PNG"><br><br>  In decryption, the inverse transforms are used: <br><img src="https://habrastorage.org/files/a48/c49/fd0/a48c49fd0e6544aba37327fd3067dd09.PNG">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Python usage example: <br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: mtest = list(binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">'1122334455667700ffeeddccbbaa9988'</span></span>)) ktest = list(binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">'8899aabbccddeeff0011223344556677fedcba98765432100123456789abcdef'</span></span>)) gost =gost2015(ktest) print(<span class="hljs-string"><span class="hljs-string">'GOST 34.12-2015'</span></span>) print(datetime.datetime.now()) c = gost.encryption(mtest) d = gost.decryption(c) print(datetime.datetime.now())</code> </pre> <br><br><h4>  DSTU 7624: 2014 </h4><br>  The Kalina cipher introduced in July 2015 as a Ukrainian standard supports several options for the length of the block and key.  Here I will describe the version of the cipher with a block length and a key length of 128 bits. <br><br>  The internal state of the cipher is a matrix with 8 rows and 2 columns.  Before encryption begins, the matrix is ‚Äã‚Äãfilled with plaintext bytes.  Then 10 elements of the following transformations are performed on the elements of the matrix. <br><ul><li><img src="https://habrastorage.org/files/87e/db6/35f/87edb635fbe14c469adfae7302cf2e6a.PNG">  - addition of columns of the state matrix with columns of a round key, represented in the form of a matrix, modulo 2 <sup>64</sup> . </li><li><img src="https://habrastorage.org/files/ad3/cd5/fbd/ad3cd5fbd8fc415db2415922f0cc82b9.PNG">  (SubBytes) - replacement of each byte of the state matrix by substitution from one of the four tables œÄ <sub>0</sub> , œÄ <sub>1</sub> , œÄ <sub>2</sub> , œÄ <sub>3</sub> . </li><li><img src="https://habrastorage.org/files/1bc/d9c/5e9/1bcd9c5e98354f75b99e9b8fab2fb34a.PNG">  (SiftRows) - rotate right by one position of rows from the 4th to the 8th. </li><li><img src="https://habrastorage.org/files/b55/f9c/bc1/b55f9cbc120043968272cb813026d0f5.PNG">  (MixColumns) - transformation of columns of the state matrix.  Each element of the new matrix is ‚Äã‚Äãcalculated by the formula: <img src="https://habrastorage.org/files/fff/b3d/f6f/fffb3df6f75b427a95055d6a0009e72d.PNG">  where ‚äó is the scalar product of vectors, v is a vector, <img src="https://habrastorage.org/files/f52/a66/d6d/f52a66d6d1074bc09718c698076f3c1d.PNG">  , G <sub>j</sub> - matrix column.  The multiplication and addition operations are performed in a finite field modulo a polynomial. <img src="https://habrastorage.org/files/fd7/f34/b05/fd7f34b0555646849c4270d82ff62430.PNG"></li><li><img src="https://habrastorage.org/files/ed4/fe6/4e3/ed4fe64e3b8947bf972de0c8e5a31bce.PNG">  - bitwise addition modulo 2 of the matrix of the internal state of the cipher and the round key K <sub>v</sub> </li></ul><br>  The encryption process is described by the following expression: <br><img src="https://habrastorage.org/files/c71/2d4/545/c712d454557849dab445606eabee9bd7.PNG"><br>  Or in a more visual form: <br><img src="https://habrastorage.org/files/09c/bd4/f62/09cbd4f621384a22927455ec0f1903cf.png"><br>  For the formation of round keys, first, using the master key K, an intermediate key is calculated <img src="https://habrastorage.org/files/f49/59b/b16/f4959bb1650e42999177c2207ac37d9a.PNG">  : <br><img src="https://habrastorage.org/files/de5/595/bb6/de5595bb6a8f4bfd880ab721e522cee5.PNG">  where <img src="https://habrastorage.org/files/2eb/8e2/3b8/2eb8e23b84c1472eb5bbed8497c9923b.PNG">  for cases when the block length is equal to the key length. <br>  Keys for even rounds are generated based on the intermediate key: <br><img src="https://habrastorage.org/files/d64/ce4/82a/d64ce482a1bb43daa503b582b3048c70.PNG">  where i is the round number, and <img src="https://habrastorage.org/files/3ba/e96/6cd/3bae966cd165474db6b8b85a80146aab.PNG">  and <img src="https://habrastorage.org/files/45b/715/25e/45b71525e00e4314a4589b58c7f8c38e.PNG">  0x01000100010001000100010001000100 <br>  The keys for odd rounds are calculated as follows: <br><img src="https://habrastorage.org/files/ad9/51c/826/ad951c8267454ce986dbe75fba294490.PNG">  where l is the length of the block. <br><br>  In decryption, the inverse transforms are used: <br><img src="https://habrastorage.org/files/204/600/47e/20460047e0614163a1b68a4dac6ff009.PNG"><br><br>  Python usage example: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: key = list(binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">'000102030405060708090a0b0c0d0e0f'</span></span>)) pt = list(binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">'101112131415161718191a1b1c1d1e1f'</span></span>)) dstu =dstu2014(key) key2 = list(binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">'0f0e0d0c0b0a09080706050403020100'</span></span>)) ct = list(binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">'1f1e1d1c1b1a19181716151413121110'</span></span>)) dstu2 = dstu2014(key2) print(datetime.datetime.now()) c = dstu.encryption(pt) d = dstu2.decryption(ct) print(datetime.datetime.now())</code> </pre><br><br><h4>  STB 34.101.31-2007 </h4><br>  The BelT cipher, having a block length of 128 bits and a key length of 256 bits, was adopted as the standard for symmetric encryption of the Republic of Belarus in 2011.  Encryption is performed by 8 rounds of transformations applied to the input block. <br>  The encryption procedure consists of the following steps: <br><ul><li>  The input block is written as <img src="https://habrastorage.org/getpro/habr/post_images/196/dc0/53a/196dc053a66db18b239e1a945a8cac98.png" alt="image"></li><li>  The key is written as <img src="https://habrastorage.org/getpro/habr/post_images/59b/55f/413/59b55f413783843523cce94c6afa9a7e.png" alt="image">  and round keys are determined <img src="https://habrastorage.org/files/eb4/996/9ea/eb49969eaa2f42acab31965d956d03d8.PNG"></li><li>  Additional variables a, b, c, d are assigned values <img src="https://habrastorage.org/getpro/habr/post_images/66d/775/697/66d77569742027ba23c30027c704c92c.png" alt="image"></li><li><img src="https://habrastorage.org/files/dc7/140/78e/dc714078e00347cd83f09aff77359bb0.PNG"><br>  Where G <sub>r</sub> is the operation to convert a 32-bit input string and <img src="https://habrastorage.org/files/44a/b67/47b/44ab6747b5d94083b34b39776dae2726.PNG">  ;  RotHi <sup>r</sup> - cyclic left shift by r bits;  <i>H (u)</i> - the operation of replacing the 8-bit input string by substituting from the table; <img src="https://habrastorage.org/files/0dd/d99/573/0ddd995736374bb2982d8632380b0046.PNG">  and <img src="https://habrastorage.org/files/c45/686/e32/c45686e32a6447fa9162369814ad887f.PNG">  - addition and subtraction operations modulo 2 <sup>32</sup> . </li><li><img src="https://habrastorage.org/getpro/habr/post_images/6ad/19f/15d/6ad19f15d078eafa09de26fd166b70e1.png" alt="image">  returned as a ciphertext. </li></ul><br>  When decrypting, the same operations are applied in the reverse order. <br><br>  Python usage example: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: key = list(binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">'E9DEE72C8F0C0FA62DDB49F46F73964706075316ED247A3739CBA38303A98BF6'</span></span>)) belt1 = belt(key) m = list(binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">'B194BAC80A08F53B366D008E584A5DE4'</span></span>)) key2 = list(binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">'92BD9B1CE5D141015445FBC95E4D0EF2682080AA227D642F2687F93490405511'</span></span>)) belt2 = belt(key2) c = list(binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">'E12BDC1AE28257EC703FCCF095EE8DF1'</span></span>)) print(datetime.datetime.now()) c1 = belt1.encryption(m) d1 = belt2.decryption(c) print(datetime.datetime.now())</code> </pre><br><br><h4>  PS </h4><br>  Implementation of all described algorithms in Python can be found on <a href="https://github.com/NeverWalkAloner/Cryptography-standards">GitHub</a> . <br><br><h4>  Links </h4><br><ol><li>  A more detailed description of the Grasshopper cipher is also given in <a href="http://habrahabr.ru/post/266359/">this</a> article by <a href="http://habrahabr.ru/users/ru_crypt/" class="user_link">ru_crypt</a> , from which I borrowed a few illustrations. </li><li>  The text of the standard GOST R 34.12-2015 can be found <a href="http://tc26.ru/standard/gost/GOST_R_3412-2015.pdf">here</a> . </li><li>  Description Kalin cipher available <a href="https://eprint.iacr.org/2015/650.pdf">here</a> . </li><li>  Standard STB 34.101.31-2007 is <a href="http://apmi.bsu.by/assets/files/std/belt-spec27.pdf">here</a> . </li></ol></div><p>Source: <a href="https://habr.com/ru/post/273895/">https://habr.com/ru/post/273895/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273883/index.html">About languages</a></li>
<li><a href="../273885/index.html">On the issue of timers in RTOS</a></li>
<li><a href="../273889/index.html">Engineers train robotic arms with IKEA furniture</a></li>
<li><a href="../273891/index.html">Farmers offer a quarter of a million for collecting blueberries</a></li>
<li><a href="../273893/index.html">Implement the ‚ÄúOnboarding Experience‚Äù in your application</a></li>
<li><a href="../273897/index.html">Git and Github. Simple recipes</a></li>
<li><a href="../273901/index.html">We join the tox community or install the node in 5 minutes</a></li>
<li><a href="../273903/index.html">Microsoft begins active struggle with adware type Superfish</a></li>
<li><a href="../273905/index.html">DotNext 2015 in Moscow: pushing the boundaries</a></li>
<li><a href="../273907/index.html">Great overview of beautiful multi-level menus with codepen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>