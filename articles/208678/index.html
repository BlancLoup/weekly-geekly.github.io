<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Convenient URL generation (CNC). Laravel 4 + third-party packages</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I would like to share handy tools for generating URLs and examples of their use. 

 The task is not so big, but it arises constantly, and I want to re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Convenient URL generation (CNC). Laravel 4 + third-party packages</h1><div class="post__text post__text-html js-mediator-article">  I would like to share handy tools for generating URLs and examples of their use. <br><br>  The task is not so big, but it arises constantly, and I want to reduce the time it takes to <s>write a bicycle</s> to solve it.  You also want to get rid of the ubiquitous use of calls to different classes, methods, functions, and so on with each need to generate a URL.  Oh yeah, I use <b>Laravel</b> and the tools are sharpened for it. <br><br><h4>  Tool links </h4><br><ul><li>  <a href="https://github.com/IvanLemeshev/laravel4-cyrillic-slug">Laravel 4 Cyrillic Slug</a> </li><li>  <a href="https://github.com/cviebrock/eloquent-sluggable">Eloquent sluggable</a> </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is enough for us. <br><br><h4>  Formulation of the problem </h4><br>  Automatic generation of unique URLs for records in the database table for accessing them at <b>/ resource / unique-resource-url</b> instead of <b>/ resource / 1</b> . <br><a name="habracut"></a><br><br><h4>  Getting started </h4><br>  Suppose we need to break the search on the site by Country and City, but so that the user can easily find out which region / city is selected when viewing the list of Site Products. <br><br>  Let's start by creating a new project: <br><br><pre><code class="bash hljs">composer create-project laravel/laravel habr_url --prefer-dist</code> </pre> <br>  Next, open <i>composer.json</i> in the <i>habr_url</i> root and <i>add the</i> packages to <b>require</b> : <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"laravel/laravel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The Laravel Framework."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"keywords"</span></span>: [<span class="hljs-string"><span class="hljs-string">"framework"</span></span>, <span class="hljs-string"><span class="hljs-string">"laravel"</span></span>], <span class="hljs-attr"><span class="hljs-attr">"license"</span></span>: <span class="hljs-string"><span class="hljs-string">"MIT"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"require"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"laravel/framework"</span></span>: <span class="hljs-string"><span class="hljs-string">"4.1.*"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ivanlemeshev/laravel4-cyrillic-slug"</span></span>: <span class="hljs-string"><span class="hljs-string">"dev-master"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"cviebrock/eloquent-sluggable"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.0.*"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"way/generators"</span></span>: <span class="hljs-string"><span class="hljs-string">"dev-master"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"autoload"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"classmap"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"app/commands"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/controllers"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/models"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/database/migrations"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/database/seeds"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/tests/TestCase.php"</span></span> ] }, <span class="hljs-attr"><span class="hljs-attr">"scripts"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"post-install-cmd"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"php artisan optimize"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"post-update-cmd"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"php artisan clear-compiled"</span></span>, <span class="hljs-string"><span class="hljs-string">"php artisan optimize"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"post-create-project-cmd"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"php artisan key:generate"</span></span> ] }, <span class="hljs-attr"><span class="hljs-attr">"config"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"preferred-install"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"minimum-stability"</span></span>: <span class="hljs-string"><span class="hljs-string">"dev"</span></span> }</code> </pre><br>  <code>"way/generators": "dev-master"</code> add for quick prototyping. <br><br>  After we execute the <code>composer update</code> command in the console, and after successfully installed packages we make changes to <i>app / config / app.php</i> : <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-comment"><span class="hljs-comment">// ... 'providers' =&gt; array( // ... 'Ivanlemeshev\Laravel4CyrillicSlug\SlugServiceProvider', 'Cviebrock\EloquentSluggable\SluggableServiceProvider', 'Way\Generators\GeneratorsServiceProvider', ), // ... 'aliases' =&gt; array( // ... 'Slug' =&gt; 'Ivanlemeshev\Laravel4CyrillicSlug\Facades\Slug', 'Sluggable' =&gt; 'Cviebrock\EloquentSluggable\Facades\Sluggable', ), ); </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  The <b>Slug</b> class will give us the opportunity to generate URLs from the Cyrillic, since the standard class <b>Str</b> can work only with the Latin alphabet.  I will tell you about <b>Sluggable</b> later. <br><br><h5>  We generate code </h5><br><pre> <code class="bash hljs">php artisan generate:scaffold create_countries_table --fields=<span class="hljs-string"><span class="hljs-string">"name:string:unique, code:string[2]:unique"</span></span> php artisan generate:scaffold create_cities_table --fields=<span class="hljs-string"><span class="hljs-string">"name:string, slug:string:unique, country_id:integer:unsigned"</span></span> php artisan generate:scaffold create_products_table --fields=<span class="hljs-string"><span class="hljs-string">"name:string, slug:string:unique, price:integer, city_id:integer:unsigned"</span></span></code> </pre><br>  Modify new files by adding foreign keys: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/database/migrations/____create_cities_table.php class CreateCitiesTable extends Migration { // ... public function up() { Schema::create('cities', function(Blueprint $table) { $table-&gt;increments('id'); $table-&gt;string('name'); $table-&gt;string('slug')-&gt;unique(); $table-&gt;integer('country_id')-&gt;unsigned()-&gt;index(); $table-&gt;foreign('country_id')-&gt;references('id')-&gt;on('countries')-&gt;onDelete('cascade'); $table-&gt;timestamps(); }); } // ... }</span></span></code> </pre><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/database/migrations/____create_products_table.php class CreateProductsTable extends Migration { // ... public function up() { Schema::create('products', function(Blueprint $table) { $table-&gt;increments('id'); $table-&gt;string('name'); $table-&gt;string('slug')-&gt;unique(); $table-&gt;integer('price'); $table-&gt;integer('city_id')-&gt;unsigned()-&gt;index(); $table-&gt;foreign('city_id')-&gt;references('id')-&gt;on('cities')-&gt;onDelete('cascade'); $table-&gt;timestamps(); }); } // ... }</span></span></code> </pre><br>  And also add a few countries and cities in the database through the <code>seeds</code> .  Open the <i>app / database / seeds</i> folder and change two files: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/database/seeds/CountriesTableSeeder.php class CountriesTableSeeder extends Seeder { public function run() { $countries = array( array('name' =&gt; '', 'code' =&gt; 'ru'), array('name' =&gt; '', 'code' =&gt; 'ua') ); // Uncomment the below to run the seeder DB::table('countries')-&gt;insert($countries); } }</span></span></code> </pre><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/database/seeds/CitiesTableSeeder.php class CitiesTableSeeder extends Seeder { public function run() { // Uncomment the below to wipe the table clean before populating // DB::table('cities')-&gt;truncate(); $cities = array( array('name' =&gt; '', 'slug' =&gt; Slug::make(''), 'country_id' =&gt; 1), array('name' =&gt; '-', 'slug' =&gt; Slug::make('-'), 'country_id' =&gt; 1), array('name' =&gt; '', 'slug' =&gt; Slug::make(''), 'country_id' =&gt; 2), ); // Uncomment the below to run the seeder DB::table('cities')-&gt;insert($cities); } }</span></span></code> </pre><br>  It uses <code>Slug::make($input)</code> , which takes <code>$input</code> as a string and generates something like <code>moskva</code> or <code>sankt-peterburg</code> . <br><br>  Now we change the database settings: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/config/database.php return array( // ... 'connections' =&gt; array( // ... 'mysql' =&gt; array( 'driver' =&gt; 'mysql', 'host' =&gt; 'localhost', 'database' =&gt; 'habr_url', 'username' =&gt; 'habr_url', 'password' =&gt; 'habr_url', 'charset' =&gt; 'utf8', 'collation' =&gt; 'utf8_unicode_ci', 'prefix' =&gt; '', ), ), // ... );</span></span></code> </pre><br>  And we bring the scheme and the data in a DB. <br><br><pre> <code class="bash hljs">php artisan migrate --seed</code> </pre><br>  And that's what we got: <br><img src="https://habrastorage.org/getpro/habr/post_images/6ba/9a4/8df/6ba9a48dfa4c7ede35e1650f08969922.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/046/6a8/036/0466a8036234c783ce5d51f418a132be.png"><br><br>  Add to the relationship model and add rules for attributes: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/models/Product.php class Product extends Eloquent { protected $guarded = array(); public static $rules = array( 'name' =&gt; 'required|alpha_num|between:2,255', 'slug' =&gt; 'required|alpha_num|between:2,255|unique:products,slug', 'price' =&gt; 'required|numeric|between:2,255', 'city_id' =&gt; 'required|exists:cities,id' ); public function city() { return $this-&gt;belongsTo('City'); } }</span></span></code> </pre><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/models/City.php class City extends Eloquent { protected $guarded = array(); public static $rules = array( 'name' =&gt; 'required|alpha_num|between:2,255', 'slug' =&gt; 'required|alpha_num|between:2,255|unique:cities,slug', 'country_id' =&gt; 'required|exists:countries,id' ); public function country() { return $this-&gt;belongsTo('Country'); } public function products() { return $this-&gt;hasMany('Product'); } }</span></span></code> </pre><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/models/Country.php class Country extends Eloquent { protected $guarded = array(); public static $rules = array( 'name' =&gt; 'required|alpha_num|between:2,255|unique:countries,name', 'code' =&gt; 'required|alpha|size:2|unique:countries,code' ); public function cities() { return $this-&gt;hasMany('City'); } public function products() { return $this-&gt;hasManyThrough('Product', 'City'); } }</span></span></code> </pre><br>  <code>CitiesController</code> <code>store</code> methods in <code>CitiesController</code> and <code>ProductsController</code> . <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/models/CitiesController.php class CitiesController extends BaseController { // ... public function store() { $input = Input::all(); $input['slug'] = Slug::make(Input::get('name', '')); // ! $validation = Validator::make($input, City::$rules); if ($validation-&gt;passes()) { $this-&gt;product-&gt;create($input); return Redirect::route('products.index'); } return Redirect::route('products.create') -&gt;withInput() -&gt;withErrors($validation) -&gt;with('message', 'There were validation errors.'); } // ... }</span></span></code> </pre><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/models/ProductsController.php class ProductsController extends BaseController { // ... public function store() { $input = Input::all(); $input['slug'] = Slug::make(Input::get('name', '')); // ! $validation = Validator::make($input, Product::$rules); if ($validation-&gt;passes()) { $this-&gt;product-&gt;create($input); return Redirect::route('products.index'); } return Redirect::route('products.create') -&gt;withInput() -&gt;withErrors($validation) -&gt;with('message', 'There were validation errors.'); } // ... }</span></span></code> </pre><br>  And remove from <i>app / views / cities / create.blade.php</i> , <i>app / views / cities / edit.blade.php</i> , <i>app / views / products / create.blade.php</i> , <i>app / views / products / edit.blade.php</i> corresponding form elements. <br><br>  Ok, <code>URL</code> generated, but what happens with their duplication?  An error will occur.  And to avoid this - if there is a <code>slug</code> match, we will have to add a prefix, and if there is a prefix every time, then increment it.  A lot of work, but no elegance.  To avoid these gestures we will use the <code>Eloquent Sluggable</code> . <br><br>  First of all let's throw off the configuration for <code>Eloquent Sluggable</code> in our project: <br><br><pre> <code class="bash hljs">php artisan config:publish cviebrock/eloquent-sluggable</code> </pre><br>  In the configuration file, which is here <i>app / config / cviebrock / eloquent-sluggable / config.php,</i> change the option <code>'method' =&gt; null</code> to <code>'method' =&gt; array('Slug', 'make')</code> .  Thus, the task of converting from Cyrillic characters to translit and creating a <code>URL</code> will fall on the <b>Slug</b> class (instead of the standard <b>Str</b> , which does not know how to work with a Cyrillic) and its <i>make</i> method. <br><br>  What is this package good for?  It works according to the following principle: it waits for <code>eloquent.saving*</code> events, which is responsible for saving the record in the database, and writes the generated <code>slug</code> into the field specified in the Model settings.  Configuration example: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/models/City.php class City extends Eloquent { protected $guarded = array(); public static $rules = array( 'name' =&gt; 'required|alpha_num|between:2,255', 'country_id' =&gt; 'required|exists:countries,id' ); //   public static $sluggable = array( 'build_from' =&gt; 'name', 'save_to' =&gt; 'slug', ); public function country() { return $this-&gt;belongsTo('Country'); } public function products() { return $this-&gt;hasMany('Product'); } }</span></span></code> </pre><br>  If it coincides with an existing <code>slug</code> , the prefix <b>-1</b> , <b>-2</b> , and so on will be added to the new one.  In addition, we can get rid of the <code>CitiesController@store</code> rule for <code>slug</code> and in the <code>CitiesController@store</code> method, remove the line <code>$input['slug'] = Slug::make(Input::get('name', ''));</code>  . <br><br>  Do the same for <code>Product</code> : <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/models/Product.php class Product extends Eloquent { protected $guarded = array(); public static $rules = array( 'name' =&gt; 'required|alpha_num|between:2,255', 'price' =&gt; 'required|numeric|between:2,255', 'city_id' =&gt; 'required|exists:cities,id' ); public static $sluggable = array( 'build_from' =&gt; 'name', 'save_to' =&gt; 'slug', ); public function city() { return $this-&gt;belongsTo('City'); } }</span></span></code> </pre><br>  An even more interesting thing we can do with this <code>slug</code> is if we rewrite <code>$sluggable</code> in the <code>City</code> Model this way: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/models/City.php class City extends Eloquent { protected $guarded = array(); public static $rules = array( 'name' =&gt; 'required|alpha_num|between:2,255', 'slug' =&gt; 'required|alpha_num|between:2,255|unique:cities,slug', 'country_id' =&gt; 'required|exists:countries,id' ); public static $sluggable = array( 'build_from' =&gt; 'name_with_country_code', 'save_to' =&gt; 'slug', ); public function country() { return $this-&gt;belongsTo('Country'); } public function products() { return $this-&gt;hasMany('Product'); } public function getNameWithCountryCodeAttribute() { return $this-&gt;country-&gt;code . ' ' . $this-&gt;name; } }</span></span></code> </pre><br>  Yes, we can select a non-existent field from the Object, and add it as a helper. <br><br>  Slightly changing the <code>CitiesTableSeeder</code> achieve the desired result: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/database/seeds/CitiesTableSeeder.php class CitiesTableSeeder extends Seeder { public function run() { // Uncomment the below to wipe the table clean before populating // DB::table('cities')-&gt;truncate(); $cities = array( array('name' =&gt; '', 'country_id' =&gt; 1), array('name' =&gt; '-', 'country_id' =&gt; 1), array('name' =&gt; '', 'country_id' =&gt; 2), ); // Uncomment the below to run the seeder foreach ($cities as $city) { City::create($city); } } }</span></span></code> </pre><br>  Now we will roll back the migrations and fill them in with the new data along with: <br><br><pre> <code class="bash hljs">php artisan migrate:refresh --seed</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a7f/392/dda/a7f392dda08acbf3774e9d905fb7a52a.png"><br><br>  Add a few routes: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/routes.php // ... Route::get('country/{code}', array('as' =&gt; 'country', function($code) { $country = Country::where('code', '=', $code)-&gt;firstOrFail(); return View::make('products', array('products' =&gt; $country-&gt;products)); })); Route::get('city/{slug}', array('as' =&gt; 'city', function($slug) { $city = City::where('slug', '=', $slug)-&gt;firstOrFail(); return View::make('products', array('products' =&gt; $city-&gt;products)); })); Route::get('product/{slug}', array('as' =&gt; 'product', function($slug) { $product = Product::where('slug', '=', $slug)-&gt;firstOrFail(); return View::make('product', compact('product')); }));</span></span></code> </pre><br>  And add a few templates: <br><br><pre> <code class="php hljs">&lt;!--  app/views/nav.blade.php --&gt; &lt;ul <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nav</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nav</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pills</span></span></span><span class="hljs-class">"&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foreach</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Country</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">all</span></span></span><span class="hljs-class">() </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">as</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">country</span></span></span><span class="hljs-class">) &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">li</span></span></span><span class="hljs-class">&gt;&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">href</span></span></span><span class="hljs-class">="</span></span>{{{ route(<span class="hljs-string"><span class="hljs-string">'country'</span></span>, $country-&gt;code) }}}<span class="hljs-string"><span class="hljs-string">"&gt;{{{ $country-&gt;name }}}&lt;/a&gt; @endforeach &lt;/ul&gt;</span></span></code> </pre><br><pre> <code class="php hljs">&lt;!--  app/views/products.blade.php --&gt; @extends(<span class="hljs-string"><span class="hljs-string">'layouts.scaffold'</span></span>) @section(<span class="hljs-string"><span class="hljs-string">'main'</span></span>) @<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(<span class="hljs-string"><span class="hljs-string">'nav'</span></span>) &lt;h1&gt;Products&lt;/h1&gt; @<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($products-&gt;count()) &lt;table <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">striped</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bordered</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">thead</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tr</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Name</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Price</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">City</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tr</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">thead</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tbody</span></span></span><span class="hljs-class">&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foreach</span></span></span><span class="hljs-class"> ($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">products</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">as</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">product</span></span></span><span class="hljs-class">) &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tr</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt;&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">href</span></span></span><span class="hljs-class">="</span></span>{{{ route(<span class="hljs-string"><span class="hljs-string">'product'</span></span>, $product-&gt;slug)}}}<span class="hljs-string"><span class="hljs-string">"&gt;{{{ $product-&gt;name }}}&lt;/a&gt;&lt;/td&gt; &lt;td&gt;{{{ $product-&gt;price }}}&lt;/td&gt; &lt;td&gt;&lt;a href="</span></span>{{{ route(<span class="hljs-string"><span class="hljs-string">'city'</span></span>, $product-&gt;city-&gt;slug) }}}<span class="hljs-string"><span class="hljs-string">"&gt;{{{ $product-&gt;city-&gt;name }}}&lt;/a&gt;&lt;/td&gt; &lt;/tr&gt; @endforeach &lt;/tbody&gt; &lt;/table&gt; @else There are no products @endif @stop</span></span></code> </pre><br><pre> <code class="php hljs">&lt;!--  app/views/product.blade.php --&gt; @extends(<span class="hljs-string"><span class="hljs-string">'layouts.scaffold'</span></span>) @section(<span class="hljs-string"><span class="hljs-string">'main'</span></span>) @<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(<span class="hljs-string"><span class="hljs-string">'nav'</span></span>) &lt;h1&gt;Product&lt;/h1&gt; &lt;table <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">striped</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bordered</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">thead</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tr</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Name</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Price</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">City</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tr</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">thead</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tbody</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tr</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">td</span></span></span><span class="hljs-class">&gt;</span></span>{{{ $product-&gt;name }}}&lt;/td&gt; &lt;td&gt;{{{ $product-&gt;price }}}&lt;/td&gt; &lt;td&gt;&lt;a href=<span class="hljs-string"><span class="hljs-string">"{{{ route('city', $product-&gt;city-&gt;slug) }}}"</span></span>&gt;{{{ $product-&gt;city-&gt;name }}}&lt;/a&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; @stop</code> </pre><br>  That's all. <br><br><h4>  Demo and git </h4><br><ul><li>  <a href="https://github.com/andrewdacenko/habr-url-laravel4">Github</a> </li><li>  <a href="http://habr-url.eu1.frbit.net/">Demo</a> </li></ul><br><br>  Errors, as usual in PM.  Suggestions and criticism - in the comments.  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/208678/">https://habr.com/ru/post/208678/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208662/index.html">Twitter app. Sending tweets and private messages</a></li>
<li><a href="../208664/index.html">Rust 0.9 released</a></li>
<li><a href="../208666/index.html">Monte Carlo method in particle physics</a></li>
<li><a href="../208672/index.html">VKontakte service is not available (at all)</a></li>
<li><a href="../208676/index.html">IPOP - IP over P2P</a></li>
<li><a href="../208680/index.html">Writing a web service on Go (part one)</a></li>
<li><a href="../208684/index.html">Converting a uniformly distributed random variable to a normally distributed one</a></li>
<li><a href="../208688/index.html">Large retail network Overstock began to accept Bitcoin</a></li>
<li><a href="../208690/index.html">CBOR - New Binary Data Format</a></li>
<li><a href="../208692/index.html">Making difficult conditions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>