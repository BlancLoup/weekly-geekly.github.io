<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>King's Bounty III: Advanced remake of the original game under DOS in Javascript / HTML5</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Background and philosophical reflections 
 Like many of my colleagues in the programmer's workshop, especially those who began to try their hand at co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>King's Bounty III: Advanced remake of the original game under DOS in Javascript / HTML5</h1><div class="post__text post__text-html js-mediator-article"><h2>  Background and philosophical reflections </h2><br>  Like many of my colleagues in the programmer's workshop, especially those who began to try their hand at computer technologies early on, I have somewhere in the back of my mind a set of the warmest and most romantic memories of the first experiments.  Once, back in 1987, my father first took me on a day off to his job, where he solemnly sat me on a chair in front of the humming Iskra-1030-11.  About that time I firmly understood what I want to do in my future life. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aad/5e5/c20/aad5e5c20a900a867e4ec5bbb7ce5769.png" alt="image"><br><a name="habracut"></a><br>  Nowadays, running DOSBox, you can easily plunge into the scent of a carefree childhood, remember that wonderful feeling of children's omnipotence, dizzying interest, exciting new knowledge and skills.  Now I am 34, more than a hundred people work under my start, I still write quite a lot of code - especially where complex algorithms are required for intelligent data processing.  Behind - in the arsenal of student achievements - the final of the ACM Olympiad, the victory of my chess engine in the ex-USSR championships, one of the algorithms on search trees called by my name, hundreds of thousands of lines of my code in the prode, but nothing brings such joy and not inspired as a return to the carefree world of childhood. <br><br>  About 10 years ago I got into the hands of the emulator BK-0010-01 - my first home computer.  Then it was worth the hard work not to start programming for it.  However, this time, another wave of nostalgia still led me to a very meaningless step, which can only be justified by the feeling of emotional uplift that I experienced completing my insane enterprise - making a remake / sequel to King's Bounty - the ancient progenitor of all Heroes games of Might &amp; Magic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In general, it is an open secret that the time of single programmers has passed.  Single characters remained in the 90s, when, in the absence of the Internet and a large amount of specialized literature, as well as in an atmosphere of lack of computing resources, the next left-handed person cleverly found 7 caps from an undead bear in a short time.  Today, the work of programmers in most cases is collective, and the success of a developer depends to a great extent not on algorithmic knowledge and technological skills, but on the ability to quickly find the necessary information and communication skills (including the ability to write readable code that meets the specified requirements). <br><br>  In general, the situation when one person today writes a game from beginning to end (including plot development, game interaction logic, graphics creation, music selection, writing game dialogues, direct coding) is completely abnormal for the modern industry.  The shoemaker should tackle the boots, and the oven pie - the pastry cook; otherwise, labor productivity will not be the highest.  But on the other side of the scale lies a high level of motivation, which in some cases makes it possible to more than offset the costs that arise.  The development of mobile platforms and the Web has made possible a kind of flashback - in exact accordance with the law of denial of negation - many modern successful game startups are created either by singles or by microinstructions that demonstrate amazing success thanks to unallocated work. <br><br>  Of course, in my case, the project is purely entertaining - there are no ideas about monetization, and in the case of such an ‚Äúunderground‚Äù remake it is hardly possible at all.  The task was greatly simplified by the fact that the lion‚Äôs share of game graphics and logic was borrowed from the original game.  In this regard, the project OpenKB (http://sourceforge.net/projects/openkb/), which is currently abandoned, helped a great deal by reconstructing the original game logic and analyzing the data formats of the original game.  The manuals written by the author of this project, as well as several other amateur manuals found on the network, have allowed us to seriously save power. <br><br><h2>  Technology </h2><br>  From the very beginning, a bet was made on cross-platform, and since with respect to Javascript and HTML5, such a titanic effort of developers has now been more or less achieved, in general, there was no particular alternative when choosing a development language. <br><br>  Of course, there are a number of languages ‚Äã‚Äãbroadcast in JS and with some advantages, but the desire to create an extra layer in a small project did not arise.  In addition, due to the prevalence of JS, you can always count on the fact that any task that needs to be solved in the course of working on a project has already been decided before you by generously submitting code snippets for public viewing. <br><br>  Due to the comparative simplicity of the game interface of the original game, it was decided to abandon the use of any heavyweight gaming frameworks.  Of the libraries, only jQuery was used (in principle, it would have been possible to do without it - in fact only $ .inArray, $ .trim and working with browser trigger events were needed; to be honest, possible cross-browser problems were scary for events, so jQuery was still left in the project). <br><br>  Graphics and music were implemented using standard mechanisms HTML5 (Canvas, Audio).  Standard Canvas methods are more than enough to implement sprite graphics with minimal effort.  Audio also provides everything you need to supply the game with sound effects.  All required snippets are easily detected on stackoverflow using simple queries, so some practical programming experience in a modern ecosystem of development is quite enough to sort out all the technological nuances in one or two evenings. <br><br><h2>  Working process </h2><br>  The work was conducted in fragments for almost one and a half months.  From the very beginning, I gave myself a half-joking pledge to write 500 lines of code a day, and at first this figure was even able to be observed.  Of course, when it came to the availability of the first conditionally-functional version, the pace slowed down significantly, because  a significant part of the time began to go into the correction of errors and small refactoring of already written code.  Some decisions made in haste in the first week of work did not justify themselves - in particular, I had to write a mini-library to work with dialogues, windows and other GUI components, although at first it seemed that it was possible to get by with very little blood . <br><br>  Special attention is given to work on the logic of conservation in the game.  Here, I succumbed to one more weakness - my love for data compression algorithms, so saves are packed using the built-in compression algorithm (vocabulary + LZW with dynamic bit alignment).  Resorting to retrospective rationalization, I will justify this desire to save space on mobile devices (unpacked save still pulls more than a hundred kilobytes), as well as the desire to at least diversify the life of cheaters. <br><br>  I had already extracted the graphics from the original game once in the late 90s, when I wrote a KB version on C, including only battles (with an expanded set of magic and other entertainment).  True, the old code died along with the dead screw back in 1999, but I remembered roughly what and where to get it.  Add-ons were rendered with the help of Pixlr and images found on the network, taken as a basis.  One of the pictures helped to strip my bride, so strictly speaking, not only I worked on the game. <br><br>  Music is a selection of free-of-charge classics that fit within the network, sound effects are recordings from the original DOSBox -&gt; Audacity game, or slightly processed free samples from <a href="http://freesound.org/">http://freesound.org</a> . <br><br>  From half to 3/4 of the time, the coding took place - in the resulting project a little less than 12,000 lines (not counting jQuery) (380 kilobytes of the script).  The rest is writing of game texts (they, unlike the original game, are noticeably larger, besides the game is bilingual), as well as testing. <br><br><h2>  Result </h2><br>  The mechanics of the game basically repeats the mechanics of the original game - the formulas of attack, magic, etc.  fully consistent with the original.  Also from the original game are taken graphics (supplemented by a small number of new objects) and the map of the first continent (with minimal changes).  The plot is noticeably expanded, the continents are not 4, but 5, while the second map has a larger size than in the original game.  Added all sorts of jokes, secrets, new plot twists.  The whole farm was tested on Chrome, FF, Edge, IE, mobile version of IE. <br><br>  I will be grateful for finding bugs, tips on the development of the project and any feedback in general. <br><br>  The address of the page with the game: <a href="http://genes1s.net/kb/game.html">http://genes1s.net/kb/game.html</a> . </div><p>Source: <a href="https://habr.com/ru/post/266805/">https://habr.com/ru/post/266805/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266795/index.html">RailsClub 2015: Interview with Vladimir Yartsev</a></li>
<li><a href="../266797/index.html">Recent trends in the world of payments</a></li>
<li><a href="../266799/index.html">Configuring Siebel Email Marketing Server</a></li>
<li><a href="../266801/index.html">Publish Android library in jCenter</a></li>
<li><a href="../266803/index.html">Old code: why is it so</a></li>
<li><a href="../266807/index.html">Asterisk and Truecaller. Determining the name of an unknown caller for incoming calls</a></li>
<li><a href="../266809/index.html">Easy to use wrapper over LoadLibrary () and GetProcAddress ()</a></li>
<li><a href="../266811/index.html">How a relational database works</a></li>
<li><a href="../266813/index.html">Why we are engaged in translation of the book from English on the GitHub platform</a></li>
<li><a href="../266817/index.html">Kotlin and its almost language constructs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>