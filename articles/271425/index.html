<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to parse the Internet in goose</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúParse the site‚Äù - a phrase that put me in despair only six months ago. Familiar problems with setting up a phantom, or fussing with selenium, immedia...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to parse the Internet in goose</h1><div class="post__text post__text-html js-mediator-article">  ‚ÄúParse the site‚Äù - a phrase that put me in despair only six months ago.  Familiar problems with setting up a phantom, or fussing with selenium, immediately rushed through my head.  Thoughts about the possible need to replace useragent, pagination and other actions during parsing were forced to postpone this task indefinitely ... <br><br>  But that all changed when I met Goose.  The world of parsing has played with new colors.  Under the cut I want to show a few simple examples that can help parse difficult sites. <br><br>  By the way, having written the parser, Gus decided to make a movie about it, for now you can enjoy the trailer: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/QpQ_ZgUx9xA%3Ffeature%3Doembed&amp;xid=17259,1500004,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgDAwpKUJWS80jSWa8CVPnlarOLSQ" frameborder="0" allowfullscreen=""></iframe><br><br><a name="habracut"></a><br><br><h2>  How to put a goose on the site </h2><br>  Everyone knows, Gus likes to pinch - weed, grandmother, geese ... and of course sites.  In order for Gus to postpone his business and pinch the site for you, you just need to show him the way. <br><br>  At the moment, Gus can parse: <br><br><ul><li>  inside nodejs using PhantomJS; </li><li>  right in the browser (ideally if you are writing a browser plugin) </li><li>  using selenium </li></ul><br>  Each of the methods has its own advantages and disadvantages.  For example, Phantom can work on the server, but it is not very convenient to debug in it, launching Goose in the browser requires an external tool that Gus puts on the site.  Selenium is a fairly universal solution, but at the moment Gus is just learning how to use it. <br><br>  So, to run the Goose on the site, first of all you need to select and create a habitat.  Possible environments: <br><br><ul><li>  PhantomEnvironment </li><li>  BrowserEnvironment </li><li>  SeleniumEnvironment </li></ul><br><br>  In this article I will consider the PhantomEnvironment as the most developed at the moment. <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PhantomEnvironment, Parser } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'goose-parser'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> env = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PhantomEnvironment({ <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'http://www.gooseplanet.ru/'</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> parser = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Parser({env});</code> </pre> <br><br>  Wednesday defines the entry point of the Goose - URL of the site's initial page. <br><br><h3>  Before parsing </h3><br>  Often, before we start to parse, we need to perform any actions on the page.  For example, search on a goose dating site.  Gus will look for you - just ask. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actions = [ { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'type'</span></span>, <span class="hljs-comment"><span class="hljs-comment">//   -  text: '', //    ,    scope: '.field[name=search]' //   }, { type: 'click', scope: 'button[type=submit]', waitForPage: true //         } ];</span></span></code> </pre><br><br><h3>  Declarativity is our everything </h3><br>  Gus is descriptive.  He is simple and laconic. <br><br><h3>  Time to pinch </h3><br>  So, now we know how to find geese.  It's time to shoot them the address.  Suppose the layout of search results looks like this: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"goose-babes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"goose-babe"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://habrastorage.org/getpro/habr/post_images/3df/cbd/088/3dfcbd088e8f5b4ba060a73f8d5e3788.jpg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"photo"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> ‚Ññ5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"goose-babe"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://habrastorage.org/getpro/habr/post_images/a48/283/87b/a4828387bbe8658749cc7a42d53ddcd9.jpg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"photo"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Orient the Goose by setting the rules for the location of the data in this layout: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> rules = { <span class="hljs-attr"><span class="hljs-attr">scope</span></span>: <span class="hljs-string"><span class="hljs-string">'.goose-babe'</span></span>, <span class="hljs-attr"><span class="hljs-attr">collection</span></span>: [[ { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-attr"><span class="hljs-attr">scope</span></span>: <span class="hljs-string"><span class="hljs-string">'.name'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'address'</span></span>, <span class="hljs-attr"><span class="hljs-attr">scope</span></span>: <span class="hljs-string"><span class="hljs-string">'address'</span></span> } ]] };</code> </pre><br><br><h3>  Run the Goose !! </h3><br><pre> <code class="javascript hljs">parser.parse({ actions, rules }).then(<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log);</code> </pre><br><br>  And we get the result: <br><pre> <code class="javascript hljs">[ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">" ‚Ññ5"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> } ]</code> </pre><br><br><h3>  And this is just the beginning. </h3><br>  Of course, this article only introduces readers to the Goose, and does not describe all of its features.  Details about what can Gus can be found in the <a href="">documentation</a> .  But still, let's list some of the tricks that Gus reserved for difficult situations: <br><br><ul><li>  Gus is not afraid of pagination - he can scroll pages or click on links to get new content.  You can even teach Goose custom pagination; </li><li>  Gus is able to walk between pages, it is important and graceful; </li><li>  Gus can perform the necessary actions with the keyboard and mouse to obtain a specific piece of information - he has very nimble legs; </li><li>  Gus can convert the results obtained; </li><li>  Gus is a smart, intelligent animal, you can tell him new parsing chips and he will start using them - the Gus Parser API is very easy to expand; </li><li>  Goose is a communal animal, due to its love for nodejs, it can easily live on a goose farm and parse millions of sites at a time; </li></ul><br><br>  Put the Goose a star - and he will take over the world for your sake <a href="https://github.com/redco/goose-parser">github.com/redco/goose-parser</a> </div><p>Source: <a href="https://habr.com/ru/post/271425/">https://habr.com/ru/post/271425/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271413/index.html">All for watchOS</a></li>
<li><a href="../271417/index.html">Briefly about the architecture of the component Symfony Config</a></li>
<li><a href="../271419/index.html">PHP Digest number 74 - interesting news, materials and tools (November 5 - 22, 2015)</a></li>
<li><a href="../271421/index.html">Knowledge Testing Services [Magento Certification]</a></li>
<li><a href="../271423/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ186 (November 15 - 22, 2015)</a></li>
<li><a href="../271427/index.html">Automated controller testing in Rails</a></li>
<li><a href="../271431/index.html">ZeroNights - about the past hackquest and the upcoming Hardware Village</a></li>
<li><a href="../271433/index.html">Making the code cleaner: working with 64-bit hardware registers in Linux</a></li>
<li><a href="../271435/index.html">Light Speck block cipher, or a speck of dust from an agency that does not exist</a></li>
<li><a href="../271437/index.html">Announced the end date of support for Yii 1.1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>