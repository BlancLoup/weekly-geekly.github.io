<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hack searching the shortest path in starcraft</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the leading developers of Warcraft and Starcraft, Patrick Wyatt periodically publishes memories of his work at Blizzard in the 90s. It is very ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hack searching the shortest path in starcraft</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/d5e/a6d/7c6/d5ea6d7c62c2f075af44687e0e4daff4.jpg"><br><br>  One of the leading developers of Warcraft and Starcraft, Patrick Wyatt periodically publishes memories of his work at Blizzard in the 90s.  It is very interesting to look at the development of games from the inside, which later became iconic.  In the last post, Patrick told a <a href="http://www.codeofhonor.com/blog/the-starcraft-path-finding-hack">wonderful story about</a> how, in a hurry, I had to hurry to fix the bugs in StarCraft before the release of the game and what came of it. <br><a name="habracut"></a><br>  Developers had to work on tight deadlines.  They constantly faced the fact that the release would take place ‚Äúin two months‚Äù, so they had time to fix critical bugs, but there was no time to make fundamental changes and rewrite some of the code to eliminate the cause of these bugs. <br><br>  The final release of the game was postponed again and again, but the deadline "two months" remained unchanged.  This is where the legs grow from those ‚Äúdirty hacks‚Äù that Patrick Wyat tells about. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Why did the company set such a deadline?  The fact is that at the E3 gaming conference in 1996, the company Ion Storm unexpectedly showed an amazing demo Dominion Storm. <br><br><img src="https://habrastorage.org/storage2/5ab/115/426/5ab1154262faacbd04fe4e853d1c93a7.jpg"><br><br>  At this time, almost ready for release StarCraft looked like this. <br><br><img src="https://habrastorage.org/storage2/963/bf3/c1b/963bf3c1bdc90ad8d09e6298fb272588.png"><br><br>  Whatever game you bought, whether you had a choice, Patrick Wyatt asks a rhetorical question.  The Blizzard developers were shocked and decided to rewrite the StarCraft graphics engine under the isometric tiles. <br><br>  The graphics engine was completely redone, and in the deadline, Patrick Wyatt and his colleagues rushed to close bugs.  He says they were "thousands."  Some could be identified and eliminated by one developer in a couple of hours.  Others - like a synchronization bug in multiuser mode - required several developers concentrated work for several days.  There was a third category of bugs that are associated with gaps in the development process.  For example, the code of the protoss aircraft carrier (Protoss Carrier) at one time was allocated to a separate branch, and could not infuse it back.  Thus, this protoss existed separately from the main code, and any changes that were made to all units had to be made separately into it later.  Also, any identified bugs in the game had to be corrected separately in the aircraft carrier.  As a result, it turned out that he did everything in a special way, standing out among all the units.  It would be possible to "kill" this unit, but he was very fond of everyone, so they decided to abandon the aircraft carrier. <br><br>  Patrick Wyatt says that a particularly large number of bugs arose with the engine's job of finding routes for units (path-finding).  If the graphics engine was rewritten for isometric tiles, then the algorithm for finding routes in deadline conditions was decided to take the old one from Warcraft (unlike Diablo, where a full-fledged isometric unit movement engine was built in).  It has been optimized for tiles of 32x32 pixels, made up of 16 cells of 8x8 pixels.  This scheme was chosen at the time to optimize the graphics for the Super Nintendo console, since there was hardware acceleration for rendering 8x8 tiles. <br><br>  Since the camera in Warcraft I and II looks from top to bottom, the edges of the graphic objects (forest, buildings, terrain objects) are either horizontal or vertical, and the route search for the units was carried out without problems.  Each 32x32 tile was either <b>complete</b> or impassable.  In the screenshot, green shows the tile boundaries considered by the algorithm, and red - impassable. <br><br><img src="https://habrastorage.org/storage2/aeb/47a/822/aeb47a8224b97005505cc6d5ae0e1dd2.jpg"><br><br>  But for StarCraft, the graphics were made isometric, so the game became more visually appealing.  For the old route search engine to work on isometric graphics, we had to increase the map resolution: now every 8x8 tile must be passable or impassable.  Although the best resolution allowed to put more units on the map, the load for calculating the route increased 16 times! <br><br>  An additional problem was created by the fact that, due to the diagonal isometric graphics, a lot of borderline situations appeared, when it was not clear whether to mark a tile as passable or not.  The screenshot shows how isometric graphics divide tiles into irregularly shaped shapes. <br><br><img src="https://habrastorage.org/storage2/91f/57f/57e/91f57f57e46bc729717adad90799fa0f.jpg"><br><br>  Because of this, a whole bunch of glitches came out.  Some were quickly fixed, but others were very annoying.  For example, the most unpleasant was a glitch with the appearance of traffic jams during the extraction of resources from working units (SCV terrans, zerg drone, protoss probe).  At some point, one of the units stood on the path of the other, he stopped, blocking the path of the third, etc.  There was a deaf traffic jam, because of which all the mining stopped.  Since the player is usually busy with other tasks (building construction, participation in battles, etc.), he did not notice the problem in time until the entire economy collapsed due to lack of money. <br><br>  The source of the problem is that the players tried to maximize the number of working units, sending them to the same source of resources.  Therefore, units moved along similar routes and could interfere with each other. <br><br>  Patrick Wyat studied the problem and realized that he was not smart enough to solve it in a fundamental way by changing the algorithm.  Units constantly change their coordinates and must, therefore, constantly recalculate the route, depending on the routes of other units (by the way, this task is close to NP-complete tasks).  Therefore, he decided that he could not do without a dirty hack - and he <b>completely removed part of the code that was responsible for preventing collisions of working units with other units</b> . <br><br>  In this way.  working units could literally pass through each other, they solved the problem with traffic jams.  Development continued, and soon the game was released in production.  Although the flaws in the search engine engine made themselves felt.  For example, a protoss dragoon has earned a bad reputation in this regard because he, as the largest land unit, more often than others refused to follow the best route. <br><br>  PS StarCraft was released in May 1998.  By the way, the game Dominion Storm came out only a month after StarCraft, and did not meet expectations at all.  As it turned out, in those years Ion Storm had a sharp conflict between management and developers.  Patrick Wyatt refers to <a href="http://www.dallasobserver.com/1999-01-14/news/stormy-weather/full/">this article</a> and cites "his favorite" quotation as an example, in order to understand how the company communicated: "Also, thank you for writing off your car and house, fucking rat-face with # ka."  Obviously, in such a working atmosphere it was difficult to make an outstanding game.  And the aforementioned demo at the E3 gaming conference in 1996, as it turned out, was fake.  However, Patrick is not offended by the competitors, and even grateful for the fact that they "gave us a good kick in the ass" and forced us to make a game of a qualitatively different level. <br><br>  <b>On this topic:</b> <br>  Patrick Wyatt, "Creating Warcraft" (translation): the <a href="http://habrahabr.ru/post/149298/">first part</a> , the <a href="http://habrahabr.ru/post/149974/">second part</a> , the <a href="http://habrahabr.ru/post/168673/">third part</a> . </div><p>Source: <a href="https://habr.com/ru/post/171529/">https://habr.com/ru/post/171529/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../171517/index.html">We write our extension for the browser Mozilla Firefox</a></li>
<li><a href="../171519/index.html">We load a lot of CSS for IE in development mode</a></li>
<li><a href="../171521/index.html">Maptrix geolocation application: developer explanation</a></li>
<li><a href="../171523/index.html">The combination of geolocation service and social network</a></li>
<li><a href="../171525/index.html">Ethernet weather station</a></li>
<li><a href="../171533/index.html">Secrets of the successful design of the children's application - an interview with the developer</a></li>
<li><a href="../171537/index.html">Intel WiDi. Instructions for use</a></li>
<li><a href="../171539/index.html">Plugin to extract data from sites</a></li>
<li><a href="../171541/index.html">New geolocation service Maptrix: feel the difference</a></li>
<li><a href="../171543/index.html">About JSDB Benefits</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>