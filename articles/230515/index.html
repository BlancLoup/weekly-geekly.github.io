<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How and why to protect Internet access in the enterprise - part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we will cynically talk about the good old task - protecting employees and their workstations when accessing Internet resources. In this article,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How and why to protect Internet access in the enterprise - part 1</h1><div class="post__text post__text-html js-mediator-article">  Today we will cynically talk about the good old task - protecting employees and their workstations when accessing Internet resources.  In this article, we will look at common myths, modern threats, and typical requirements of organizations for the protection of web traffic. <br><br>  If you remember only one fact from the whole article, then you should know that on adult websites there is a tenfold less chance of picking up a malicious program than on ordinary Internet resources. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/89e/794/800/89e794800e01b73c2c95aefebc6ecbf2.jpg"><br><a name="habracut"></a><br>  Today, most Russian companies already provide employees with access to the Internet from work computers.  In this regard, state organizations, law enforcement agencies and companies that process a large amount of personal data usually lag behind.  But even in such organizations there are always separate network segments or workstations connected to the Internet. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Not giving employees access to the Internet has long been considered a bad form.  About a third of the candidates simply will not come to you to work, having learned that you do not have access to the Internet or that the Internet is severely limited, as they consider it to be as necessary as clean water and ventilation.  This is especially true for today's generation of 20-25 year olds, who from school are used to that any information can be quickly found in a search engine, and updates in social networks should be checked in no less than half an hour. <br><br>  Enough introductions, go to the myths. <br><br><h5>  Myth # 1 If you don‚Äôt go through adult sites, then everything will be fine </h5><br>  As if not so.  According to <a href="http://www.symantec.com/content/en/us/enterprise/other_resources/b-istr_main_report_2011_21239364.en-us.pdf%3Fom_ext_cid%3Dbiz_socmed_twitter_facebook_marketwire_linkedin_2012Apr_worldwide_ISTR17">Symantec's Internet Security Threat Report,</a> only 2.4% of adult sites spread malware, which is several times less than blogs, news portals and online stores. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2fb/b75/67f/2fbb7567faaeb7b085bbf892c8e7b6fb.jpg"><br><br>  Suffice it to recall the hacking examples of the New York Times, NBC, Russian Railways, Vedomosti portal, Georgian government sites, TechCrunch Europe and others, from which pages spread viruses and phishing attacks. <br>  On the other hand, as a responsible employee, you can make a strong-willed decision not to visit sites with slippery topics, but can your colleagues be able to resist?  Do they tempt with the temptation to click on the link in the "Nigerian letter" or click on the banner with the message about winning 100,500 thousand dollars? <br><br><h5>  Myth # 2 Even if I get on the infected site, the antivirus will save me </h5><br>  There is a chance, but it is very small.  Before being published, the creators of malware check that their creations are not detected by current versions of antiviruses.  After the detection of the first versions of the malware by antivirus analysts, it takes from 6 to 24 hours for its research and signature development.  The speed of propagation of signatures and patches for vulnerable software depends solely on your infrastructure, but as a rule, it goes on days and weeks.  All this time, users are vulnerable. <br><br><h5>  Myth # 3 The host security solution can filter site categories by risk, and that‚Äôs enough. </h5><br>  Please note that the anti-virus vendors themselves offer dedicated specialized solutions for the protection of web traffic.  Host solutions are possible and have basic functionality for filtering web sites by categories and risks, but they cannot afford to store the malicious database locally and dynamically update it without sacrificing performance.  The host approach to solving the problem is also not applicable for companies in which not all workstations are included in the domain and / or are not managed centrally. <br><br><h5>  Myth # 4 If you pick up a virus, then nothing terrible will happen. </h5><br>  Modern malware is indeed more humane compared to its counterparts from the 90s - most often they try to minimally influence the victim, systematically receiving commands from the master, sending spam, attacking websites and stealing your passwords from bank clients.  In addition to them, there are more aggressive types - cryptococci, encrypting the entire contents of the hard disk and demanding ransom, ‚Äúporno-banners‚Äù, showing lewdness and requiring sending very expensive SMS, network worms that disable the network, not to mention targeted attacks. <br><br>  Imagine that all this can happen to any computer or server in your organization.  Agree, it is unpleasant to lose or allow leakage of all data from the computer of a lawyer, chief accountant or director.  Even the failure of individual components of your infrastructure at the time of treating or refilling a workstation can be detrimental to your business. <br><br>  I hope that the colors have thickened enough and it's time to go to the description of typical tasks and requirements for an ideal solution to protect web traffic.  While I deliberately do not use the names of products or devices as the task can be solved in various ways. <br><br><h3>  Requirements for technical solutions </h3><br><h5>  Filtering Internet resources by reputation </h5><br>  The solution should provide the ability to block access to known malicious websites or their individual sections.  At the same time, information about the level of risk is pulled from the cloud analytics center and is dynamically updated every few minutes.  If the site has recently appeared, the solution should be able to independently analyze the content and decide on the degree of danger. <br><br>  The administrator can only determine the acceptable level of risk and, for example, block all sites with a reputation of less than six on a scale from -10 to +10. <br><br>  By category and reputation should be divided not only sites, but also their subsections and individual elements of the pages.  For example, on the most popular website with weather forecasts, there are links to dubious resources offering to lose weight, if you stop eating just one product, or find out how Pugacheva gave birth to twins.  In this case, employees should leave access to the main site and block the display of doubtful parts of the web page. <br><br><h5>  Filtering Internet resources by category (URL filtering) </h5><br>  It should be possible to block access to certain categories of sites, for example, to file hosting services, online casinos and hacker forums.  Category information should also be pulled from the cloud analytics center.  The more categories the device understands and the more accurately they are defined, the better. <br><br>  You should also pay attention to the speed of response of the analytics center to your requests for changing categories of websites.  Sites that your employees use for business purposes may be incorrectly assigned to a blocked category.  It is possible and the opposite situation, when the site is not assigned to a blocked category.  These difficulties can be solved manually by adding individual resources to the white list or black list, but this approach is inapplicable if you have to do it every day, and even on several devices. <br><br>  Special attention is given to the topic of Cyrillic support and the correct classification of Russian-language sites.  As a rule, Western vendors do not pay them enough attention.  Fortunately, Ironport's divisions, which developed solutions for protecting web traffic and acquired Cisco, are located in / in Ukraine, so there are no problems mentioned above. <br><br><h5>  Scan downloads </h5><br>  It should be possible to scan potentially dangerous files with antivirus engines before giving them to end users.  If there are several such engines, this somewhat increases the chances of detecting malware.  Also, you implement the principle of echeloned defense and reduce the chances of infection if antivirus is disabled, not updated or simply missing on the final host. <br><br>  Riding excellence in analyzing potential malware is the use of the Advanced Malware Protection engine (AMP) or its counterparts to protect against targeted attacks.  In such attacks, malicious files are designed specifically for several organizations, are not common on the Internet, and, as a rule, have not yet fallen into the traps of anti-virus vendors.  VRT Sourcefire and Cisco SIO analytics centers check if this particular file was previously encountered during an attack in another organization, and if not, it tests it in a sandbox, analyzing the actions performed.  Earlier we wrote about <a href="http://habrahabr.ru/company/cisco/blog/226699/">AMP on Habr√©</a> <br><br>  It will also be useful to be able to filter files by extensions and headers, banning executable files, encrypted archives, audio and video files, .torrent files, magnet links, etc. <br><br><h5>  Understanding applications and their components </h5><br>  Traditional access control lists on firewalls almost do not save.  For ten years or more, one could be relatively certain that TCP ports 80 and 443 were used only for accessing the Internet through a web browser, and TCP 25 for sending e-mail.  Today, over HTTP and port 80, Skype, Dropbox, TeamViewer, torrent clients and thousands of other applications work.  English-speaking colleagues call this situation ‚ÄúHTTP is new TCP‚Äù.  Many of these applications can be used to transfer sensitive files, video streams, and even remote control of workstations.  Naturally, these are not the types of activity that we are glad to see in the corporate network. <br><br>  Here we can be helped by a solution that restricts the use of applications and their individual components.  For example, allow Skype and Facebook, but prohibit file transfer and video calls.  It will also be useful to ban as a class all p2p file sharing applications, anonymizers and utilities for remote control. <br><br>  Application definition is based on application signatures, which are automatically updated from the manufacturer‚Äôs website.  The great advantage is the ability to create "application signatures" independently or load them in clear form from the community website.  Many manufacturers are developing "application signatures" only on their own and often do not have time to follow the updates of Russian applications, or simply they are not engaged.  Of course, they are unlikely to undertake the development of signatures for industry-specific applications or applications of their own design. <br><br><h5>  Detection of infected hosts based on connections </h5><br>  As practice shows, many computers can be members of botnets for several years.  The arms race has reached such a level that malware not only tightens updates of its versions from the control center, but also patches holes in the OS and applications through which they hit the computer in order to prevent competitors from appearing.  Not all antivirus solutions are able to establish the fact of infection, given that such malware works at a very low level, hiding its processes, connections and existence in general from the antivirus. <br>  Here, solutions that analyze traffic from workstations to botnet control centers on the Internet come to our aid.  The main detection method is monitoring connections to servers in ‚Äúblacklists‚Äù - already known to control centers of botnets, ‚Äúdark‚Äù areas of the Internet, etc. <br>  If this is a targeted attack or an unknown botnet so far, then detection is performed using behavioral analysis.  For example, the session ‚Äúphone home‚Äù between the zombie and the master can be distinguished by the encryption of the content, the small amount of data transferred and the long connection time. <br><br><h5>  Flexible access control policies </h5><br>  Virtually all modern security tools have the ability to assign policies not only based on IP addresses, but also based on user accounts in AD and their membership in AD groups.  Consider an example of the simplest policy: <br><br><ul><li>  Internet access is obtained by all domain users from computers included in the domain and corporate tablets. </li><li>  With the exception of users included in the domain groups "Call Center Operators" and "Without Internet Access" </li><li>  With a speed of no more than 512 Kbps per employee </li><li>  All employees are denied access to the Online Casino, Job Search, and Adult Sites categories. </li><li>  With the exception of the group "Guide" </li><li>  All employees are denied access to sites with a reputation of less than six </li><li> The use of social networks and video streaming services is prohibited for all employees, except for the group ‚Äúmarketing and public relations department‚Äù </li><li>  Video viewing is limited in speed to 128Kbps </li><li>  It is forbidden to use all gaming applications, except for the game created by the company. </li><li>  It is forbidden to use torrent-clients, instant messengers and utilities for remote administration </li><li>  Scan downloaded files from two of the three anti-virus engines, with the exception of .AVI files </li><li>  Prevent downloading of .mp3 files and encrypted archives </li></ul><br>  As practice shows, in many companies there are organizational difficulties that do not allow immediately begin to restrict access to Internet resources.  A formalized policy is either absent or in practice there are too many exceptions for it in the form of privileged employees and their friends.  In such cases, you should act on the 80/20 principle and start with minimal restrictions, for example, block sites with the highest level of risk, certain categories and sites that are not specifically related to work duties.  It also helps to install the solution in the monitoring mode and provide reports on the use of Internet resources to company management. <br><br><h5>  Interception and verification of SSL traffic </h5><br>  Even today, many email services and social networks encrypt their traffic by default, which does not allow analyzing the transmitted information.  According to <a href="http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840">research</a> data, SSL encrypted traffic in 2013 accounted for 25-35% of the total amount of transmitted data, and its share will only increase. <br>  Fortunately, SSL traffic from a user to Internet resources can be decrypted.  To do this, we replace the server certificate with the device certificate and terminate the connection on it.  After the user's requests have been analyzed and recognized as legitimate - the device establishes a new encrypted connection to the web server on its behalf. <br>  Traffic decoding can be carried out both on the same node that performs the analysis and filtering, and on a dedicated specialized device.  When all tasks on a single node are performed, performance goes down by itself, sometimes by times. <br><br><h5>  Additional requirements </h5><br>  In order for the project to protect web traffic to take place, it is extremely useful to show management and benefits that are not directly related to security: <br><ul><li>  Quoting traffic by time and user, for example, no more than 1 GB of traffic per month or no more than two hours on the Internet per day </li><li>  Limit the bandwidth for individual sites, their parts or applications, for example, a limit of 100 Kbps when downloading streaming video or audio </li><li>  Web traffic caching - allows both to speed up the download speed of popular sites and to save traffic when downloading the same files multiple times </li><li>  Channel shaping - equal bandwidth allocation and prioritization among all users </li></ul><br>  It is also extremely important to understand whether the solution in question is appropriate for your organization; here you should pay attention to: <br><ul><li>  Single sign on - transparent user authorization without additional login / password input, including for smartphones and tablets </li><li>  Supporting multiple ways to integrate into your existing infrastructure </li><li>  The ability to install solutions in the form of specialized hardware devices and virtual machines </li><li>  Centralized management of both the devices themselves and their policies </li><li>  Centralized reporting for all devices with the ability to create custom reports </li><li>  The ability to delegate the administration of specific regions, functions, or policies to other administrators </li><li>  Solution performance </li><li>  Presence of regular functionality for connection logging and leak prevention (DLP) or the ability to integrate with external DLP solutions </li><li>  Ability to integrate with SIEM systems </li><li>  Licensing model - by users or devices or by IP addresses or bandwidth </li><li>  Cost of renewal of annual subscriptions </li></ul><br>  It is naturally impossible to tell about everything in one article and here are some topics that were not covered: <br><ul><li>  Verify domain membership, antivirus, and OS updates before providing Internet access </li><li>  How to protect employees who are more likely to travel than to the office </li><li>  What difficulties arise when protecting web traffic of workstations with removable employees, virtual workstations (VDI), tablets and smartphones </li><li>  When it is cheaper and more convenient to use the cloud service to filter web traffic </li><li>  Is it worth trying to implement similar functionality based on Squid and other open source solutions? </li></ul><br>  The next article is planned to tell with what Cisco solutions and how you can solve the above tasks. <br><br>  I hope that the article was useful for you, I will be glad to hear additions and suggestions about new topics in the comments. <br><br>  Stay tuned;) <br><br>  <a href="http://habrahabr.ru/company/cisco/blog/232863/">Link to the continuation of the article</a> </div><p>Source: <a href="https://habr.com/ru/post/230515/">https://habr.com/ru/post/230515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../230503/index.html">Master in the USA. Fulbright Graduate Student Program. Part 1</a></li>
<li><a href="../230505/index.html">Why a Win32 application manifest?</a></li>
<li><a href="../230507/index.html">Django-orm in search of LEFT JOIN</a></li>
<li><a href="../230511/index.html">Unlocking a Lenovo Phone by Depth Methods</a></li>
<li><a href="../230513/index.html">CentOS 7 Overview. Part 1: Linux Containers</a></li>
<li><a href="../230517/index.html">Using OpenVPN TAP Interface on Synology NAS (with certificate authentication)</a></li>
<li><a href="../230519/index.html">The path to continuous integration. Selenium + TeamCity</a></li>
<li><a href="../230523/index.html">Instagram life after sale</a></li>
<li><a href="../230525/index.html">New Developer Economics Report Released</a></li>
<li><a href="../230529/index.html">MapCode - not an easy short address</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>