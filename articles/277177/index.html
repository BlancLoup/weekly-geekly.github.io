<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Measuring performance using BenchmarkDotNet</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. A week ago, for the third time, I applied the library to create / launch .NET benchmarks BenchmarkDotNet . The library turned out to be quit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Measuring performance using BenchmarkDotNet</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/cca/849/7b4/cca8497b4b5143c3b00ffab8a8401f40.jpg" alt="image" align="left">  Good day.  A week ago, for the third time, I applied the library to create / launch .NET benchmarks <a href="https://github.com/PerfDotNet/BenchmarkDotNet">BenchmarkDotNet</a> .  The library turned out to be quite convenient, but practically not illuminated in Habr√©, which I will now correct. <br><br>  By benchmark, I mean the measurement of the execution time of the method (s).  To begin, imagine the process of writing a benchmark with your hands.  We create a test method, select Release build, create a ‚Äúmeasuring‚Äù method, collect garbage in it, set StopWatch at the beginning and at the end, start the warm-up, run the test method.  If the test method runs faster than one ‚Äútick‚Äù of StopWatch, we run the test method many times (let it be a million), divide the total time by million, we get the result (you need not forget to subtract the time of ‚Äúidle‚Äù cycle run for a million operations from the total time) . <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As you can see, there are already a lot of details, and if you can still live with them, then with measurements, performance for different architectures (x86 \ x64) and different compilers, everything becomes very bad (one of the library's authors, Andrei <a href="https://habrahabr.ru/users/dreamwalker/" class="user_link">DreamWalker,</a> tells in detail about the creation of <a href="https://www.youtube.com/watch%3Fv%3D1B6RRV509Ds">benchmarks</a> and <a href="http://www.youtube.com/watch%3Fv%3DmnPJZxm2yyw">micro-optimization</a> details <a href="https://habrahabr.ru/users/dreamwalker/" class="user_link">)</a> Akinshin).  As you might guess, BenchmarkDotNet takes care of these details on itself. <br><br><h4>  Installation </h4><br>  Nuget package, no dependencies;  at the time of publication of the article version v0.9.1. <br><br><h4>  Simplest example </h4><br>  First of all I checked the library "for lice". <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TheEasiestBenchmark</span></span> { [Benchmark(Description = <span class="hljs-string"><span class="hljs-string">"Summ100"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Test100</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Enumerable.Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>).Sum(); } [Benchmark(Description = <span class="hljs-string"><span class="hljs-string">"Summ200"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Test200</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Enumerable.Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>).Sum(); } } [TestClass] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">UnitTest1</span></span> { [TestMethod] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestMethod1</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { BenchmarkRunner.Run&lt;TheEasiestBenchmark&gt;(); } }</code> </pre> <br><br>  As you can see, for a simple start, it is enough to hang the [Benchmark (Description = "TestName")] attribute on the methods under test, and run the code in the console or in a unit test.  The requirements for the method are small: it must be public (otherwise there will be no measurements) and take no arguments (otherwise we will get an exception).  After the benchmark is completed, a detailed test report will appear in the console, with a summary table at the end. <br><br><table><tbody><tr><th>  Method </th><th>  Median </th><th>  Stddev </th></tr><tr><td>  Summ100 </td><td>  1.0282 us </td><td>  0.1071 us </td></tr><tr><td>  Summ200 </td><td>  1.9573 us </td><td>  0.0648 us </td></tr></tbody></table><br><br>  By default, it specifies the name of the method, median, standard deviation.  If you do not set the ‚ÄúDescription‚Äù property in the [Benchmark] attribute in the Method column, the method name will be displayed.  By the way, the rows of the table are sorted according to the values ‚Äã‚Äãof the Description property (method names).  It is also worth noting that an uncaught exception in the method stops the measurement (specifically this method). <br><br>  To measure the performance of methods with arguments, you can create an additional ‚Äúmeasuring‚Äù method: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SomeBusinessLogic</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arg</span></span></span><span class="hljs-function">)</span></span>{ ... } [Benchmark(Description = <span class="hljs-string"><span class="hljs-string">"Summ100"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MeasurmentMethod</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { SomeBusinessLogic(<span class="hljs-number"><span class="hljs-number">42</span></span>); }</code> </pre><br><br><h4>  Benchmark Settings </h4><br>  Configuring benchmarks by using the Config attribute.  The possibilities are considerable: environment settings \ platform \ jitter, number of launches, output settings, loggers, analyzers ... Examples of configuration can be found on the library page on <a href="https://github.com/PerfDotNet/BenchmarkDotNet">github</a> . <br><br>  The easiest option is to set up: we hang the Config attribute on the class containing the Benchmark methods, and in the constructor we pass a string with the settings.  So, if you want to see the maximum launch time in the summary table, use the following code: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Config(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"columns=Max"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TheEasiestBenchmark</span></span> { [Benchmark(Description = <span class="hljs-string"><span class="hljs-string">"Summ100"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Test100</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Enumerable.Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>).Sum(); } }</code> </pre><br><br><table><tbody><tr><th>  Method </th><th>  Median </th><th>  Stddev </th><th>  Max </th></tr><tr><td>  Summ100 </td><td>  1.0069 us </td><td>  0.0124 us </td><td>  1.0441 us </td></tr></tbody></table><br><br>  Another option is to create a descendant class from ManualConfig, and pass its type to the constructor of the Config attribute. <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Config(typeof(HabrExampleConfig))</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TheEasiestBenchmark</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HabrExampleConfig</span></span> : <span class="hljs-title"><span class="hljs-title">ManualConfig</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HabrExampleConfig</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Add(StatisticColumn.Max); <span class="hljs-comment"><span class="hljs-comment">//    } } [Benchmark(Description = "Summ100")] public int Test100() { return Enumerable.Range(1, 100).Sum(); } }</span></span></code> </pre><br><br><table><tbody><tr><th>  Method </th><th>  Median </th><th>  Stddev </th><th>  Max </th></tr><tr><td>  Summ100 </td><td>  1.0114 us </td><td>  0.0041 us </td><td>  1.0201 us </td></tr></tbody></table><br><br>  On the one hand, there is more code, on the other hand, autocompletion works when creating a class: it is easier to configure, it is more difficult to make a mistake. <br><br><h5>  A little bit about the settings </h5><br>  A lot of settings, and they are divided by type. <br><br>  The first type of settings is Job.  As follows from the documentation, it is necessary to configure the environment: the expected platform (x64 \ x86), jitter, runtime.  In addition, if you are not satisfied with the test run time (the library tries to select the optimum accuracy / start time for the criteria), you can adjust the number of warm-up and target launches, or simply specify the desired run time.  In addition, you need to be careful with the settings of the environment: if the class is in a project oriented to .NET 4.6, and the config is set to .NET 4.5, we get an error during the launch process (which is, in general, logical). <br><br>  The following type of settings: Columns already familiar to us.  Allows you to configure the displayed information.  The full list of available access columns is in the Columns -&gt; default section of the <a href="https://github.com/PerfDotNet/BenchmarkDotNet">documentation</a> .  The main columns used are PropertyColumn. * (For example, PropertyColumn.Runtime), StatisticColumn. * (For example, StatisticColumn.Median). <br><br>  Another item of settings: Exporters.  Specifies which additional results files to generate.  Possible files: html, txt, csv, R plots, markdown markup for SO, github.  So, to create R graphs and csv documents in the MyConfig constructor, we add Add (RPlotExporter.Default, CsvExporter.Default); <br><br>  A class with all these settings might look like this: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HabrExampleConfig</span></span> : <span class="hljs-title"><span class="hljs-title">ManualConfig</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HabrExampleConfig</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Job {IterationTime = <span class="hljs-number"><span class="hljs-number">1</span></span>,WarmupCount = <span class="hljs-number"><span class="hljs-number">1</span></span>,TargetCount = <span class="hljs-number"><span class="hljs-number">1</span></span>}); Add(StatisticColumn.Max); Add(RPlotExporter.Default, CsvExporter.Default); } } [Config(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(HabrExampleConfig ))] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TheEasiestBenchmark</span></span>{...}</code> </pre><br><br>  Almost the same is the result of another configuration method ‚Äî creating your own configuration attribute. <br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">MyConfigSource</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TheEasiestBenchmark</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyConfigSourceAttribute</span></span> : <span class="hljs-title"><span class="hljs-title">Attribute</span></span>, <span class="hljs-title"><span class="hljs-title">IConfigSource</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IConfig Config { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyConfigSourceAttribute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Config = ManualConfig.CreateEmpty() .With(StatisticColumn.Max) .With(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Job {Platform = Platform.X64}) .With(RPlotExporter.Default); } } [Benchmark(Description = <span class="hljs-string"><span class="hljs-string">"Summ100"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Test100</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Enumerable.Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>).Sum(); } }</code> </pre><br><br>  It should be noted that all three configuration methods only add something to the basic configuration.  So, the three basic columns Method \ Median \ StdDev will always be output to the console. <br><br>  If there is a desire to limit the output (and the generation of the resulting files), you can use the UnionRule property. <br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Config(typeof(HabrExampleConfig))</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TheEasiestBenchmark</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HabrExampleConfig</span></span> : <span class="hljs-title"><span class="hljs-title">ManualConfig</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HabrExampleConfig</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Add(PropertyColumn.Method, StatisticColumn.Max); <span class="hljs-comment"><span class="hljs-comment">//       Add(ConsoleLogger.Default); //     UnionRule = ConfigUnionRule.AlwaysUseLocal; //     } } [Benchmark(Description = "Summ100")] public int Test100() { return Enumerable.Range(1, 100).Sum(); } }</span></span></code> </pre><br><br><table><tbody><tr><th>  Method </th><th>  Max </th></tr><tr><td>  Summ100 </td><td>  1.0308 us </td></tr></tbody></table><br><br>  This approach is useful to those who wish to customize the launch of benchmarks in the CI process, because the additional generated files with the results are likely to be redundant. <br><br><h4>  Additional features </h4><br><h5>  Parameterized Tests </h5><br>  If you want to experimentally check the complexity of the algorithm, or just have an idea of ‚Äã‚Äãthe speed of the method with different arguments, you can use the Params attribute. <br>  So, we can measure the speed of counting the inclusions of the character 'a' in different lines: <br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Params(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"habrahabr"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"geektimes"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"toster"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"megamozg"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> arg; [Benchmark(Description = <span class="hljs-string"><span class="hljs-string">"Test"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CountLetterAIncludings</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> res = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; arg.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arg[i] == <span class="hljs-string"><span class="hljs-string">'a'</span></span>){res++;} } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; }</code> </pre><br><br><table><tbody><tr><th>  Method </th><th>  Median </th><th>  Stddev </th><th>  arg </th></tr><tr><td>  Test </td><td>  112.4087 ns </td><td>  1.1556 ns </td><td>  geektimes </td></tr><tr><td>  Test </td><td>  113.0916 ns </td><td>  1.4137 ns </td><td>  habrahabr </td></tr><tr><td>  Test </td><td>  104.3207 ns </td><td>  4.2854 ns </td><td>  megamozg </td></tr><tr><td>  Test </td><td>  80.3665 ns </td><td>  0.4564 ns </td><td>  toster </td></tr></tbody></table><br><br><h5>  Relative start time </h5><br>  Suppose we want to know not only the absolute times of test methods, but also relative ones.  To do this, we select a method whose time is considered ‚Äúnormal‚Äù, and change its Benchmark attribute, setting BaseLine to true. <br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Benchmark(Description = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Summ100"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Test100</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Enumerable.Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>).Sum(); } [Benchmark(Description = <span class="hljs-string"><span class="hljs-string">"Summ200"</span></span>, Baseline = <span class="hljs-literal"><span class="hljs-literal">true</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Test200</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Enumerable.Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>).Sum(); }</code> </pre><br><br><table><tbody><tr><th>  Method </th><th>  Median </th><th>  Stddev </th><th>  Scaled </th></tr><tr><td>  Summ100 </td><td>  1.0113 us </td><td>  0.0055 us </td><td>  0.52 </td></tr><tr><td>  Summ200 </td><td>  1.9516 us </td><td>  0.0120 us </td><td>  1.00 </td></tr></tbody></table><br><br><h4>  Processing results </h4><br>  If there is a desire / need in some way to be perverted with statistics, or you want to write your Exporter, the Summary class is at your service.  Run the test in a unit test. <br><pre> <code class="cs hljs">Summary result = BenchmarkRunner.Run&lt;TheEasiestBenchmark&gt;();</code> </pre><br>  and use all the information about each benchmark <s>completely free of charge and without SMS</s> . <br>  result.Benchmarks [index] contains information about the Job'e and parameters, result.Reports [index] stores data about the time of the test run and its type (warm-up \ combat). <br><br>  In addition, as I wrote above, the library allows you to save test results in html, csv, txt formats, and also supports saving in markdown markup and formed in R png-pictures.  So, all the test results in this article are copied from the generated html files. <br><br><div class="spoiler">  <b class="spoiler_title">Examples of drawings</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/745/378/0f6/7453780f6dc640f793651bb91e16bd67.png" alt="image"><br><img src="https://habrastorage.org/files/fab/72d/326/fab72d32609a4b1fa5e1038b6e671a4b.png" alt="image"><br></div></div><br><br>  Summarizing the above, BenchmarkDotNet takes on routine actions when compiling benchmarks and provides decent opportunities for formatting results with minimal effort.  So, if you want to quickly measure the speed of a method, get accurate results for methods with a short execution time, or get a beautiful schedule for management - you already know what to do.  :) </div><p>Source: <a href="https://habr.com/ru/post/277177/">https://habr.com/ru/post/277177/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277165/index.html">3CX integration with Office 365</a></li>
<li><a href="../277167/index.html">Remote debugging javascript with VS2015. Part 3 (F12 Chooser)</a></li>
<li><a href="../277169/index.html">Will React Native fulfill the programmer‚Äôs dream: single code for web, android and ios?</a></li>
<li><a href="../277171/index.html">Router for Matreshka.js 2</a></li>
<li><a href="../277173/index.html">Critical Vulnerability in Cisco ASA</a></li>
<li><a href="../277179/index.html">Combining video clips from multiple cameras and synchronizing them over time</a></li>
<li><a href="../277183/index.html">Example module for Magento 2 in a different way</a></li>
<li><a href="../277185/index.html">The digest of interesting materials for the mobile developer # 140 (on February 8-14)</a></li>
<li><a href="../277189/index.html">Putting XGBoost under OS X</a></li>
<li><a href="../277191/index.html">Ballad about SharePoint</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>