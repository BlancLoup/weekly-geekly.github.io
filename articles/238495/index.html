<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Let me give you back?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The main enemy of hackers (we will not argue about the original meaning of this word - now we will use this term to designate those who create / sprea...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Let me give you back?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/193/c36/b0c/193c36b0c232478ea5bc0331bcd68feb.jpg"><br><br>  The main enemy of hackers (we will not argue about the original meaning of this word - now we will use this term to designate those who create / spread malware) are antiviruses, which with varying degrees of success detect their crafts and delete.  One way to prevent the detection of illegal activities and the utilities used for this is to attempt to ‚Äúforce‚Äù legal software to serve its purposes.  For example, why download something from the Internet yourself, at the risk of falling out of favor with a firewall or heuristics (not to mention signatures), if you can run wget with parameters?  Why build your mail sending, if there is a blat?  Why do long and hard to do the remote monitoring utility for a computer when there are free remote administration programs? <br><a name="habracut"></a><br>  Recently, the Remote Manipulator System (RMS) program, produced by TektonIT, has earned the greatest popularity among the motley hacker brotherhood. <br><br>  There are several reasons for this, but it is quite difficult to go on to list them - something that they would not perceive as an advertisement, we simply list the main functions: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1. The possibility of hidden installation and operation; <br>  2. Communication through the server, and not to IP directly; <br>  3. The ability to manage a large fleet of computers; <br>  4. Software legally, has EDS; <br>  5. The files of the program itself are detected by a small number of antiviruses - you do not even need to encrypt anything (5-20, depending on the version); <br>  6. Ease of use at the middle school level. <br><br>  In short, the technological essence of the work is as follows: <br><br>  1. RMS files are installed on the victim's computer in stealth mode, sometimes even with the help of an official installer, although more often ‚Äúmanually‚Äù - the script puts the files in the right folder and starts their ‚Äúsilent‚Äù registration or registers them itself; <br>  2. The owner comes to the mail ID and password; <br>  3. In the botnet +1. <br><br>  This is implemented as a SFX archive with a bat file that does everything or as an NSIS installer.  To help beginners there are many articles with beautiful screenshots, which describes in detail how to create such an archive ... the batch file and the files themselves are naturally attached to the article.  For the gifted, even video manuals (in large quantities) are removed and ‚Äúbuilders‚Äù are made - a beautiful window where you need to enter your data (where the password and ID should be sent) - and everything will be done by itself. <br><br><img src="https://habrastorage.org/files/810/c9f/fe6/810c9ffe6438431c8cc50b8a90af0b4e.PNG"><br><br>  In the minds of some intellectuals so firmly established that RMS is a hacking utility that they even ... in general, see for yourself: <br><br><img src="https://habrastorage.org/files/904/bd5/974/904bd5974d0c4fc498ee27529183922e.png"><br><br>  On the other hand, the barricades are not all calm either - nerve admins and users storm support with questions ‚Äúhow long ?!‚Äù, then one antivirus will remove something, then another, then users suspect the admin.  The support throws up his hands, offers to write directly to antiviruses, they say, the more they write, the sooner they will remove the false positive.  Then they release a new version - there are no detections there, but after a while they appear again and everything returns to normal. <br><br>  But there is also a third party barricade, which usually no one notices and does not consider as a party at all, because the wall is generally two sides, as is commonly believed, but everything is not so simple, there are still antiviruses that keep all-round defense: you need to protect users from angry hackers, you need to communicate with managers / lawyers from TektonIT and dismiss admins asking about inconvenience, say our office does not pay for the antivirus so that it can be demolished by legal software. <br><br>  Currently, anti-virus science has reached the following heights: <br><br>  1. In the name of the detective, to the best of imagination, they try to convey information about what it is (there are the following component parts of the names: RemoteAdmin, RMS, Riskware, RemoteUtilities, not-a-virus ... etc, and even three of such hints some manage to put in the name of the detector); <br>  2. Alerts on similar software have a softer color-sound scale, in order not to take the user out of the state of mental balance; <br>  3. Detection of this class of software can be completely disabled in the settings of the antivirus; <br>  4. And yet - this is a purely ‚Äúnational‚Äù problem - this is usually not extended beyond the CIS.  The Russian program, builders in Russian, is distributed by spam and social engineering, so the majority of foreign antivirus companies simply do not know what is happening here.  Of course, files come to their virlaby (from the same virustotal), but they, apparently, have a poorly visible situation in our region, but Russian antivirus programs and some foreign ones (who have a large staff in our country) do their best spoil the blood of virus makers. <br><br>  This is how things work with the NSIS builder: <br><br><img src="https://habrastorage.org/files/147/744/d36/147744d36b474a968f0280f49bd16e1d.PNG"><br><br>  In this builder, you don‚Äôt even need to enter anything - there is no reference to the mail, ID + pass are generated at the assembly stage and saved to a file.  This work to reduce the number of signature-based detectors uses a fairly popular method - creating an archive under a password: all RMS files are in a password-protected archive, and when installed in the command line parameters, the archive is given a password to the archiver.  Such a trick allows you to bypass the scan of the file on the disk (usually antiviruses do not get passwords), but (if there is a detector) during installation, the files will be unpacked and detected by the anti-virus monitor (if enabled, of course). <br><br>  You can put patched versions of RMS as a separate class - when a file is examined by reversing and an extra functionality is ‚Äúcut out‚Äù (knocked, jumped), for example, displaying a window to the user that access data on his computer will be sent to such e- mail address (starting with one of the versions such functionality appeared).  Sometimes patching is used to knock down antivirus detectors and to disguise (versioninfo, lines in the file are interrupted), as a result, the file after a while begins to be detected not as a Remote Tool (these detections are mentioned above), but as a trojan or backdoor, and evilly not 10 antiviruses, but 30 ... after all, the signature on the file flies in such a case and this is obtained from the point of view of an abstract virlab in a vacuum already a common malware. <br><br>  In some cases, the builder serves only to write to the text ini-file with the settings, and all the work on patching / configuring the build itself has already been done by the author. <br><br>  Here is an example of such a builder: <br><br><img src="https://habrastorage.org/files/810/c9f/fe6/810c9ffe6438431c8cc50b8a90af0b4e.PNG"><br><br>  Sometimes crutches can be used in the form of scripts that monitor the appearance of windows from the RMS for their instant concealment and even in the form of a dll library that will put the necessary hooks in the process and will change the logic of the process work in the field of window display.  These two-line scripts are practically not detected, and the library is detected by more than 30 antiviruses, which greatly jeopardizes the whole operation, because it is used extremely rarely. <br><br>  If you search the search engine for the names of the detectors on the RMS, you can see that for the general public (and not for manual infection using social engineering cheaters in the chat), combinations are used that are not derived from public builders, but from articles about this - judging by such assemblies are sold to forums and even the builders to them, their essence is that the installation produces a bat-file - installs in a hidden mode a legal msi-installer.  Accordingly, the antivirus has only two possibilities to stop it - to detect the bat-file (and it is easy to change them and ‚Äúreset‚Äù the detections) and the RMS files themselves.  If the antivirus does not detect the final files, and when such a Trojan elephant hit the computer on the batnik, it was all in vain - even if it starts to be detected with the next updates, it will be late, because for RMS it is no longer needed and it can be scrapped with a clear conscience. <br><br>  It should be noted that this tool is used both by novice hackers (schoolchildren, script kiddies, etc.), and ‚Äúworking on an ongoing basis‚Äù, for those who are bread.  Such accesses are sold on the forums in the hundreds at ridiculous prices: <br><br><img src="https://habrastorage.org/files/a26/63a/aa6/a2663aaa6e4743b9a08014fc3e9dd06a.png"><br><br>  Such attacks are used not only for the extraction of already familiar profit (passwords, money), but also for selling to people with an excess of some kind of hormones - access to the computers of girls, who are often in front of the computer in a nude form. <br><br>  Already in the process of writing this article, Kaspersky Lab published on September 11 <a href="http://securelist.ru/analysis/obzor/22903/rassledovanie-incidentov-xishhenie-v-sisteme-dbo/">‚ÄúInvestigation of incidents: theft in the RBS system‚Äù</a> , which gave us inspiration, they say ‚Äúthe right way to go, comrades!‚Äù, Because it was the malware class we studied that was they were infected.  Therefore, we decided to get the described malware and supplement the Kaspersky Lab article with new buns ... <br><br>  The described distribution of the exploit was made in January 2014.  When the document was opened, the file was downloaded and launched, which was the 7z-sfx archive, which unpacked the archive with the COyNldyU password, transferring it with the command line (the LC could have a different build of this malware, a slightly different modification, but they are extremely close relatives ‚Äî all of the behavior and names match almost completely).  After that, the bat-file was launched, extracted from the password-protected container, which installed the RMS (patched) files into the system.  This batch file is interesting because it worked extremely correctly - previously tried to remove itself from the system by hitting processes and shutting down / removing services, and also checked the system rights, in the event of a shortage of which could be installed in% APPDATA% \ Microsoft \ System, and write settings in HKCU \ SOFTWARE \ System \ System \ Install \ Windows \ User \ Server \ Parameters. <br>  Also carried out the patching and update of the Windows RDP (apparently, so that when the current user is connected remotely, it does not throw out), by running a heap of console utilities in hidden mode. <br><br>  In conclusion, we would like to introduce the situation with detections. <br><br>  Nominations are as follows: <br><br>  1. Detection of the rutserv.exe file from different versions of RMS.  In order not to help the hackers in this matter (it will be too clear which version shows which quantity and which antivirus it detects) we do as follows: If the antivirus detects at least 75% - it‚Äôs plus, less than half - the minus, the remaining interval will give ¬±; <br>  2. Detection of the file from under the second builder (it is always the same, and the config is different); <br>  3. Detection of bat-files to install RMS into the system - they were taken from various articles about the self-assembly of this malware and several from forums where, on the contrary, they try to reverse / get rid of this infection and upload files.  Registration of results - similar to the first paragraph; <br>  4. Bat-file described in the article from KasperskyLab. <br><br><img src="https://habrastorage.org/files/c1d/e18/162/c1de1816246f48b5bc618a8c86202dbf.png"><br><br>  Actually, the image shows the results, but we will try to give them our own interpretation: <br><br>  1. As expected, the three Russian antiviruses showed very good results, which indicates their close attention to this class of malware.  Kaspersky traditionally shows good results, Dr.Web is almost completely focused on the domestic market (especially government offices and big business), the Outpost team - the creators of the legendary firewall, as it turned out, are also stubbornly struggling with the adversary ... And we offer foreign antivirus programs "to increase three times extreme concern. " <br><br>  2. Comrades (VBA32) from the fraternal Republic of Belarus have somehow a little strange attitude to this family.  It is possible that inadvertently ..., but if we want to play conspiracy, then an interesting puzzle will be formed: firstly, this antivirus is purely internal - state.  enterprises there, and secondly, their KGB <a href="http://www.belgazeta.by/ru/2012_01_16/right/80/">has already been noticed</a> in the love of infecting its citizens with the RMS program.  Whether these points are related to each other is an open question, the accuracy of the second point was also not notarized, but we still recommend reading the material by reference at least because of the comments of the ‚Äúprogrammer-cracker‚Äù - in the light of all of the above, you can evaluate carries nonsense.  Their assembly of RMS (since they started talking about it) also does not constitute anything outstanding: archive + crutch + archive + batch file + bulk RMS files. <br><br><h4>  Epilogue </h4><br>  Not a conclusion, but an epilogue.  We do not know which conclusions can be drawn from this.  If it was a diploma / abstract, then, according to the rules, we would have drifted along the tree, and so ... From what we learned, we tried to tell the most interesting and useful things so that the reader would not fall asleep - diluted with funny pictures and tried not to overload the article terminology and narrow moments (ala ACM code listings, screenshots with underscores of important places in red).  Our words about spying through the camera for not very well-dressed persons (and not only) of the weaker sex, we still did not dare to illustrate with screenshots.  We hope that this article did not become less informative and interesting. <br><br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/238495/">https://habr.com/ru/post/238495/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../238485/index.html">Design in the browser</a></li>
<li><a href="../238487/index.html">Sample Magic Spring Data JPA Audit and Version</a></li>
<li><a href="../238489/index.html">Hello from Namibia. Rethinking Postocard Postcards</a></li>
<li><a href="../238491/index.html">Control any AV technology from your phone. IR transceiver for JACK 3.5</a></li>
<li><a href="../238493/index.html">Unicorn interested in KDE</a></li>
<li><a href="../238497/index.html">About encodings and code pages</a></li>
<li><a href="../238499/index.html">Sale of electronic books for 99 rubles</a></li>
<li><a href="../238501/index.html">My experience in building 1-Wire industrial network</a></li>
<li><a href="../238505/index.html">English words. Methods and methods of memorization</a></li>
<li><a href="../238507/index.html">Large-scale price cuts for Azure cloud services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>