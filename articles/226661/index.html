<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we deployed Huawei MicroDC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, Huawei decided that it was crowded in the niche market of telecommunications operators. The result was the creation of a separate IT ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we deployed Huawei MicroDC</h1><div class="post__text post__text-html js-mediator-article">  Not so long ago, Huawei decided that it was crowded in the niche market of telecommunications operators.  The result was the creation of a separate IT division in their Enterprise division.  At the same time, the Chinese approached this issue on a large scale. <br><br>  When Huawei speaks about IT, they really mean all the product lines that cover the enterprise's IT infrastructure, from SOHO / ROBO to the Enterprise level. <br>  It is clear that with such a portfolio, the company can offer its customers truly end-to-end solutions that cover all the needs of the client.  Today I want to tell you about one of them: <b>Huawei MicroDC</b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/936/039/9fd/9360399fd0f57aa73ea95d4f80a7f499.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h5>  Briefly about what this decision is </h5><br>  The Huawei rack (yes, Huawei, honestly) is installed by the Huawei UPS (and everything is correct here, there is no nameplate-gluing), environmental monitoring sensors (temperature, smoke, humidity, door opening, etc.), Cabinet Control Unit (a device that collects data from all these sensors and sends them via SNMP).  In addition, hardworking Chinese prearranged all the switching and carefully marked it. <br>  Depending on the ordered configuration, the solution may include servers, switches / routers, storage systems - in general, everything that is needed for the functioning of a full-fledged infrastructure.  Moreover, when ordering, you can specify your network plan in the form, according to which all switches will be configured at the factory, and the rack will arrive to you with configured VLAN, assigned IP addresses, etc.  You will only need to make high-level settings of the server \ storage equipment and you can run the solution by powering the rack-up UPS. <br><br>  The target audience of this solution is a company with a geographically distributed branch network and integrator companies offering their customers typical solutions ‚Äúturnkey infrastructure from scratch‚Äù.  It is convenient because once you have made a typical solution, you can duplicate it many times, while the time spent on setting up falls entirely on the Huawei factory.  You just need to send MicroDC to the place of operation after the purchase.  Moreover, you do not need to send expensive employees on a business trip to deploy a branch of your bank or NPS infrastructure in the North.  Anyone who can read can connect labeled cables to the marked ports, connect uplink and power the UPS from 220V.  Everything else can be done remotely. <br><br><h6>  ‚ÄúAll this is marketing!‚Äù You say. </h6><br>  Well, let's move on to practice.  In our demo laboratory, the Treolan turned out to be the minimum equipment for this solution: a 24U rack, UPS with 3kVa battery modules, a CCU, an analog KVM rack, and an IP dome camera.  Batteries, KVM and camera came in separate boxes.  However, this did not make it easier for us, both literally and figuratively.  So that you understand my words, here is how it all came: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c5c/91f/da4/c5c91fda460d895376fab283acda63e5.jpg"><br><br>  It should be noted here that all this came not to the Treolan warehouse, equipped with the most modern technology, with professional warehouse staff, loaders and elevators, but to the office, with all the consequences ... The edges of the box were reinforced with a pair of cardboard layers, the stand itself was bolted 4 bolted to the pallet. <br><br>  In order to unload the rack from the car, it took us ~ 1.5 hours of time and 4 people accustomed to the loads. <br><br>  To make the stand more or less transportable (I remind you that we don‚Äôt have a loader or elevators in the office), we made it as easy as possible.  To do this, she was removed from the side walls and UPS.  However, even after that, she was by no means weightless. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/575/943/1c4/5759431c4e078f6b9a19875add2859f2.jpg"><br><br>  Due to the good quality of the metal rack weighs far beyond a centner.  This is a frequent question about build quality.  No burrs, no play, the metal does not flex with a finger (it feels easier to break the cast-iron bridge).  Of course, in the process of carrying and operating a pair of scratches on the roof of the rack still appeared, but here I think no vendor can boast such anti-vandal resistance. <br><br>  By the way, high build quality is inherent in all Huawei products that have passed through our hands. <br><br>  After the rack was delivered to the end point, direct assembly and configuration began. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b51/608/ad5/b51608ad5e9e5ad29d879b9ac8f7ff77.jpg"><br><br>  In this form, the battery modules are transported from the UPS - in accordance with all accepted standards for safety when transporting batteries. <br><br>  Despite the fact that the equipment was minimal, Huawei still offers its customers something like Best-practice - these are their recommendations for placement and the type of units used in the rack.  Just want to note that all the marking on the patch cords and power wires made with these very recommendations. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea8/6d6/30c/ea86d630c7747fe971cb65e7a8fe6e9c.png"><br><br>  For example, UPS and batteries, they are quite logical to offer to install in the lower 8 units.  In this case, the batteries are connected to the control module in series, with foolproof connectors. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ac/07d/325/5ac07d325f82d56ee8e276fd0f7dad77.jpg"><br><br>  However, these recommended solutions are periodically subject to change, so the recommendations differ in different versions of the Installation Guide.  So, for example, in our guide to the unit in which it was proposed to install the switch, there was already a cable entry pre-installed at the factory.  But this is an insignificant minus, anyway, we were not going to follow their recommendations. <br><br><h5>  Working scheme </h5><br>  For ourselves, we decided to build on the basis of this solution the ‚Äúcanonical‚Äù infrastructure of an office for 100-150 employees.  To do this, we decided to use a virtual cluster of 2 Huawei Tecal RH1288 V2 servers and the Huawei FusionCompute hypervisor, a Huawei OceanStor S2600T storage system, and we assembled the core of the network on a stack of two switches S5700-EI.  Under the router, we identified the Huawei AR2200.  And since we are all ‚Äúadult‚Äù, we decided to build an isolated management network based on the Huawei S5700-28X-PWR-LI-AC POE switch. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/317/9d0/5a4/3179d05a439c74978194ee3f7beb0843.png"><br><br>  Here, by the way.  Close up marking patch cords.  Everything is clear and accessible.  Part of the cables they marked according to their layout plan.  Part of - given at the mercy of the client.  However, as I said, we did not comply with these recommendations.  But even so, the labeling was very useful in further switching. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/71e/a2b/310/71ea2b3104dc17f1cfba7352cf39b50f.jpg"><br><br>  In addition, I would like to note that patch cords are laid on the conscience.  Everything is thoughtful and neat, each cable has a label at both ends.  When we had to cut the ties to pull the cable to another unit - my heart was bleeding. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/712/645/881/71264588192d9f31fc0a07aa52f4f6c8.jpg"><br><br>  The switches stacked without any problems; for this, the FOXCONN stacking cable provided for this was used: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/feb/a3b/3a3/feba3b3a34405efb29865d8c2ee769fb.jpg"><br><br>  We installed servers on native sleds with a convenient mounting scheme: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c01/f55/b43/c01f55b43d5938ec271d060ae1e1a44d.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/507/c98/927/507c98927a54c2a9e1731a4d37ecb3c4.jpg"><br><br>  We installed the included HikVision DS-2CD793PF-EI IP camera on the roof (we didn‚Äôt find the Huawei inscription on the camera and on KVM on just two secondary devices in the rack).  A smoke sensor and a telescopic bar are attached to the camera. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/680/dfc/05c/680dfc05c30c65cc08d69ecda7450014.jpg"><br><br>  One of the key components of the MicroDC solution is the <b>CCU</b> - Cabinet Control Unit.  It collects data from environmental sensors uniformly installed across the entire rack, aggregates them and sends them to an SNMP server (which Huawei <b>eSight</b> will play in our installation). <br>  The CCU is installed in the back of the rack and visually looks like a switch.  Signals from smoke and temperature sensors, front / rear doors openings, floor flooding and UPS systems converge on it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/55e/264/c78/55e264c788977651d4335c0a52ceb04c.jpg"><br><br>  A few units already pre-installed slide.  However, due to their ‚Äúversatility‚Äù, they are not suitable for mounting storage systems or servers, and for 1U switches they are simply not needed.  Therefore, in fact, they caused more inconvenience during assembly than they did. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/394/439/4ae/3944394ae5673998bdfd1f652e3365c8.png"><br><br>  As already mentioned, we installed a hypervisor from Huawei: FusionCompute from the FusionSphere solution on the servers.  Their solution is based on Citrix's XenServer product. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b6/977/f2f/3b6977f2fc182afb824cc6e58e3a2a7e.jpg"><br><br>  After all the equipment was installed in the rack and the initial initialization was carried out, reefs began to appear. <br><br><h5>  Software products </h5><br>  According to the scenario proposed by Huawei, the user must use their software product - the <b>Rapid Deployment Tool</b> . <br>  As the name suggests, this tool should help us easily and quickly initialize all the equipment installed in the rack.  However, the logic in this place succumbs. <br><br>  To deploy the Rapid Deployment Tool (hereinafter referred to as RDT), you need to raise a SQL server version 5.5.30 x32 on your local machine.  They have this distribution kit on the site (only there it is for x64 systems, but oh well).  The installation of the sql server takes place without any problems, it‚Äôs good that in the guide they describe everything in detail and post screenshots on almost every step. <br><br>  But when it is necessary to install the RDT itself, a problem arises.  Of the 10 machines on which we tried to install it, the distribution kit ( <b>* .vbe</b> ) was launched only by 1, yielding an error of access rights.  But having started, he again began to make mistakes.  Only after contacting Huawei support, we learned that the distribution kit runs exclusively under two OS versions: Win XP Eng or Win 7 Eng.  It is the English, the only exception is Chinese. <br><br>  When the installation was complete, we wondered: what does this product do? <br><br>  After all, according to its manual, after installation, we need to <b>manually</b> assign IP addresses to the management ports of all devices using the console cable (put them all into one subnet 192.168.2.0/24), configure the SNMP according to the parameters specified in the manual.  And only after that start the RDT, which will be able to poll all these devices via SNMP and give you the opportunity to change their IP.  Those.  You must manually do all the necessary work first, so that you can then do the same thing automatically. <br><br>  Our legitimate question is " <i>WHY</i> ?"  Huawei representatives replied about the following: <br>  1. When ordering a more complete set (with pre-installed servers \ SHD \ switches), hardworking Chinese at the factory will perform part of the manual configuration for you.  It is enough to fill in the form of a network plan when ordering. <br>  2. The main purpose of this software product is to upload the <i>Configuration File</i> .  After you configure all the devices, you can upload these parameters to a separate file.  And this file is already uploaded to another product: Huawei <i>eSight</i> . <br>  In general, there is certainly logic here, but some kind of it ... Eastern, I guess. <br><br>  Now I‚Äôll tell you more about the <b>Huawei eSight</b> software solution.  This is their vision of the actual for many problems of administering the entire infrastructure from ‚Äúone window‚Äù.  One of the advantages of Huawei is that in a number of solutions the entire infrastructure can be built solely on Huawei equipment, which seriously simplifies the administration issue. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/88b/dc2/3cb/88bdc23cb7fcb9fdc035848b30e96c8d.png"><br><br>  Installing and configuring eSight does not cause serious difficulties, everything is described in sufficient detail in the manual.  The solution has a modular structure, when in the installation wizard you can select those segments of your infrastructure that you want to monitor (servers, SAN networks, IPSec tunnels, VoIP, Unified Communication, etc.).  Therefore, proper installation planning will help you avoid unnecessary functionality and, as a result, cluttering the interface. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba0/009/346/ba0009346242e471d0d86c7119c23307.png"><br><br>  In our case, after updating the product to the current version, the process of adding resources was quite simple: with the help of the pre-installed RDT, we imported the Configuration File and got a fully initialized rack: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/da7/2bc/8cf/da72bc8cf1e607d99926891fb613bbdd.png"><br><br>  In addition to importing resources, you can add both manually by IP addresses and auto-discover by address range.  Network devices and servers are managed via SNMP (from v1 to v3), and storage and SAN switches through the SMI-S protocol. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f8/ceb/d3f/1f8cebd3f7787276041cc557b4182a5f.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce8/c40/e3c/ce8c40e3c5f82be26db546106a9cf59f.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/fc8/3c3/ab2/fc83c3ab20c7d9fb4b20434b76cbf9a0.png"><br><br>  The interface is not perfect, but there are no serious complaints, you can even say that it is intuitive.  The system is completely interactive, problem devices are noted on the diagram (by the presence of SNMP alerts), you can either manage them directly from eSight (enable / disable / reboot), or switch to web interfaces. <br><br>  This is what the Tecal RH 1288V2 server management window looks like.  If necessary, by the link <i>Device Management</i> we can go to the iMana web-interface for remote access or deeper settings (firmware updates, etc.) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5e1/5cd/629/5e15cd62919879da867eb5942556430f.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/16d/714/73b/16d71473bdaee896f6abc63a26db1542.png"><br><br>  In the solution there is a functional on the automatic construction of an IP network map and its manual modification.  Again, all elements are interactive, give a brief information on resources and allow you to go to the control window in 1 click. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b54/7c4/667/b547c4667ea42485bca0f5e27c8b012e.png"><br><br><h5>  Summarizing </h5><br>  <i>We liked these solutions</i> , despite some nuances, which, of course, always arise regardless of the vendor.  Building Tecal servers causes only positive emotions.  Configuring network equipment for a Cisco certified specialist should also not raise questions, since the CLI is very similar and there are many detailed documentation and examples on the Huawei website.  Reasonableness of cabling in the closet and, in general, the quality of its assembly, the presence of a camera and KVM in the composition makes a good impression of this infrastructure solution. <br>  With all the functionality of eSight'a, we didn‚Äôt figure it out until the end, we didn‚Äôt have enough time.  But we can say one thing: eSight really allows you to monitor and administer our entire infrastructure from one window, and the MicroDC + eSight bundle shows this most clearly.  At the same time, the product works out of the box, without requiring serious customization by means of a team of qualified developers. <br><br>  Therefore, we believe that these products, both as part of one solution and separately, will quickly occupy their niche and win back a significant market share. </div><p>Source: <a href="https://habr.com/ru/post/226661/">https://habr.com/ru/post/226661/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../226649/index.html">The war with the designer: where does good design come from? Part 2</a></li>
<li><a href="../226653/index.html">Management tools: Mammoth as the main principle of team building</a></li>
<li><a href="../226655/index.html">Spacecraft Solar Probe Plus will go on record rapprochement with the Sun</a></li>
<li><a href="../226657/index.html">Tesla coil from hozmag</a></li>
<li><a href="../226659/index.html">Our experience accelerating iOS apps</a></li>
<li><a href="../226663/index.html">Spring MVC - JavaConfig or project configuration without XML files</a></li>
<li><a href="../226665/index.html">Microsoft moves to proprietary processors</a></li>
<li><a href="../226667/index.html">RaspberryPi + Pioneer System Remote</a></li>
<li><a href="../226669/index.html">Cross-platform file manager? This is reality</a></li>
<li><a href="../226673/index.html">"Eat your own dog food" or how we found the most important client</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>