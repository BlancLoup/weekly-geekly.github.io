<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security defects that PVS-Studio team fixed this week: Issue N3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have decided, as far as possible, to regularly search for and fix potential vulnerabilities and bugs in various projects. You can call this using o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security defects that PVS-Studio team fixed this week: Issue N3</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b68/6c1/0b3/b686c10b311adba53da6e21dc90355ec.png" alt="We rule potential vulnerabilities"></div><br>  We have decided, as far as possible, to regularly search for and fix potential vulnerabilities and bugs in various projects.  You can call this using open-source projects.  You can - a kind of advertising or testing analyzer.  Another option is another way to draw attention to the issues of code quality and reliability.  Actually, the name doesn't matter, we just like to do it.  Let's call it an unusual hobby.  Let's see what interesting things were found in the code of various projects this week.  We took the time to make corrections and invite you to read them. <br><a name="habracut"></a><br><h2>  For those who are not familiar with the PVS-Studio tool yet </h2><br>  <a href="https://www.viva64.com/ru/pvs-studio/">PVS-Studio</a> is a tool that reveals many types of errors and vulnerabilities in the code.  PVS-Studio performs static code analysis and recommends the programmer to pay attention to areas of the program that are likely to contain errors.  The best effect is achieved when static analysis is performed regularly.  Ideologically, analyzer warnings are similar to compiler warnings.  But unlike compilers, PVS-Studio performs a deeper and more versatile code analysis.  This allows him to find errors, including in compilers: <a href="https://www.viva64.com/ru/b/0425/">GCC</a> ;  LLVM <a href="https://www.viva64.com/ru/b/0108/">1</a> , <a href="https://www.viva64.com/ru/b/0155/">2</a> , <a href="https://www.viva64.com/ru/b/0446/">3</a> ;  <a href="https://www.viva64.com/ru/b/0363/">Roslyn</a> . <br><br>  Code analysis in C, C ++ and C # languages ‚Äã‚Äãis supported.  The analyzer runs on Windows and Linux.  In Windows, the analyzer can be integrated as a plugin in Visual Studio. <br><br>  For further acquaintance with the analyzer, we suggest studying the following materials: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Detailed <a href="https://www.slideshare.net/Andrey_Karpov/pvsstudio-static-code-analyzer-windowslinux-ccc-2017">presentation</a> on SlideShare website.  In <a href="https://www.youtube.com/watch%3Fv%3DkmqF130pQW8%26amp%3Bfeature%3Dyoutu.be">video</a> format, it is available on YouTube (47 minutes). </li><li>  <a href="https://www.viva64.com/ru/inspections/">Articles</a> about proven open source projects. </li><li>  <a href="https://www.viva64.com/ru/b/0486/">PVS-Studio: search for security defects</a> . </li></ul><br><h2>  Potential vulnerabilities (weaknesses) </h2><br>  This section lists defects that fall under the CWE classification and, in fact, are potential vulnerabilities.  Of course, not every project has security defects that pose some kind of practical threat, but I want to demonstrate that we can find such situations. <br><br>  <b>1. MSBuild.</b>  <b>CWE-476 (NULL Pointer Dereference)</b> <br><br><ul><li>  V3095 The 'searchLocation' object was used before it was verified against null.  Check lines: 170, 178. Microsoft.Build.Tasks Resolver.cs 170 </li><li>  V3095 The 'searchLocation' object was used before it was verified against null.  Check lines: 249, 264. Microsoft.Build.Tasks Resolver.cs 249 </li><li>  V3095 The 'assemblyName' object was used before it was verified against null.  Check lines: 176, 194. Microsoft.Build.Tasks Resolver.cs 176 </li></ul><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FileMatchesAssemblyName</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( AssemblyNameExtension assemblyName, .... ResolutionSearchLocation searchLocation )</span></span></span><span class="hljs-function"> </span></span>{ searchLocation.FileNameAttempted = <span class="hljs-comment"><span class="hljs-comment">// &lt;= pathToCandidateAssembly; .... if (String.Compare(assemblyName.Name, ....) != 0) // &lt;= { .... } .... if (searchLocation != null) { .... } .... bool isSimpleAssemblyName = assemblyName == null ? false : assemblyName.IsSimpleName; .... searchLocation.Reason = // &lt;= NoMatchReason.ProcessorArchitectureDoesNotMatch; .... if (searchLocation != null) { .... } .... }</span></span></code> </pre> <br>  ‚Üí <a href="https://github.com/Microsoft/msbuild/pull/1891">Report</a> <br><br>  <b>2. MSBuild.</b>  <b>CWE-476 (NULL Pointer Dereference)</b> <br><br>  <a href="http://www.viva64.com/ru/w/v3095/">V3095</a> The 'e' object was used against it.  Check lines: 165, 170. MSBuild InitializationException.cs 165 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Throw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> messageResourceName, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> invalidSwitch, Exception e, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> showStackTrace)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (showStackTrace) { errorMessage += Environment.NewLine + e.ToString(); <span class="hljs-comment"><span class="hljs-comment">// &lt;= } else { errorMessage = ResourceUtilities.FormatString(errorMessage, ((e == null) ? String.Empty : e.Message)); } .... }</span></span></code> </pre> <br>  ‚Üí <a href="https://github.com/Microsoft/msbuild/pull/1891">Report</a> <br><br>  <b>3. Entity Framework.</b>  <b>CWE-670 (Always-Incorrect Control Flow Implementation)</b> <br><br>  <a href="http://www.viva64.com/ru/w/v3014/">V3014</a> It is likely that a variable is being incremented inside the 'for' operator.  Consider reviewing 'i'.  EFCore ExpressionEqualityComparer.cs 214 <br><br>  <a href="http://www.viva64.com/ru/w/v3015/">V3015</a> It is likely that a variable is being compared inside the 'for' operator.  Consider reviewing 'i' EFCore ExpressionEqualityComparer.cs 214 <br><br><pre> <code class="cpp hljs">var memberInitExpression = (MemberInitExpression)obj; .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (var i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; memberInitExpression.Bindings.Count; i++) { var memberBinding = memberInitExpression.Bindings[i]; .... <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (memberBinding.BindingType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> MemberBindingType.ListBinding: var memberListBinding = (MemberListBinding)memberBinding; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(var j=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; memberListBinding.Initializers.Count; <span class="hljs-comment"><span class="hljs-comment">// &lt;= i++) // &lt;= { hashCode += (hashCode * 397) ^ GetHashCode(memberListBinding.Initializers[j].Arguments); } break; .... } }</span></span></code> </pre> <br>  ‚Üí <a href="https://github.com/aspnet/EntityFramework/pull/7909">Report</a> <br><br>  <b>4. Entity Framework.</b>  <b>CWE-670 (Always-Incorrect Control Flow Implementation)</b> <br><br>  <a href="http://www.viva64.com/ru/w/v3081/">V3081</a> The 'j' counter is not used inside a nested loop.  Consider inspecting usage of 'i' counter.  EFCore.Specification.Tests ComplexNavigationsQueryTestBase.cs 2393 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (var i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; result.Count; i++) { var expectedElement = expected .Single(e =&gt; e.Name == result[i].Name); var expectedInnerNames = expectedElement .OneToMany_Optional.Select(e =&gt; e.Name) .ToList(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (var j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; expectedInnerNames.Count; j++) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { Assert.True ( result[i] .OneToMany_Optional.Select(e =&gt; e.Name) .Contains(expectedInnerNames[i]) // &lt;= ); } }</span></span></code> </pre> <br>  ‚Üí <a href="https://github.com/aspnet/EntityFramework/pull/7909">Report</a> <br><br>  <b>5. CoreCLR.</b>  <b>CWE-188 (Reliance on Data / Memory Layout)</b> <br><br>  <a href="http://www.viva64.com/ru/w/v557/">V557</a> Array overrun is possible.  The value of 'dwCode - 1' index could reach 8. cordbdi rsmain.cpp 67 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDebugCodeName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DWORD dwCode)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dwCode &lt; <span class="hljs-number"><span class="hljs-number">1</span></span> || dwCode &gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"!Invalid Debug Event Code!"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> szNames[] = { <span class="hljs-string"><span class="hljs-string">"(1) EXCEPTION_DEBUG_EVENT"</span></span>, <span class="hljs-string"><span class="hljs-string">"(2) CREATE_THREAD_DEBUG_EVENT"</span></span>, .... <span class="hljs-string"><span class="hljs-string">"(8) OUTPUT_DEBUG_STRING_EVENT"</span></span> <span class="hljs-comment"><span class="hljs-comment">// &lt;= "(9) RIP_EVENT", }; return szNames[dwCode - 1]; }</span></span></code> </pre> <br>  ‚Üí <a href="https://github.com/dotnet/coreclr/pull/10417">Report</a> <br><br>  <b>6. FreeBSD.</b>  <b>CWE-561 (Unreachable code detected)</b> <br><br>  <a href="http://www.viva64.com/ru/w/v779/">V779</a> Unreachable code detected.  It is possible that an error is present.  mps.c 1306 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mps_alloc_requests</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(struct mps_softc *sc)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { panic(<span class="hljs-string"><span class="hljs-string">"failed to allocate command %d\n"</span></span>, i); sc-&gt;num_reqs = i; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } .... }</code> </pre> <br>  ‚Üí <a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi%3Fid%3D218002">Report</a> <br><br>  <b>7. FreeBSD.</b>  <b>CWE-561 (Unreachable code detected)</b> <br><br>  <a href="http://www.viva64.com/ru/w/v779/">V779</a> Unreachable code detected.  It is possible that an error is present.  efx_mcdi.c 910 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">efx_mcdi_ev_death</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( __in </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">efx_nic_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *enp, __in </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rc)</span></span></span><span class="hljs-function"> </span></span>{ .... efx_mcdi_raise_exception(enp, emrp, rc); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (emrp != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> &amp;&amp; ev_cpl) emtp-&gt;emt_ev_cpl(emtp-&gt;emt_context); }</code> </pre> <br>  ‚Üí <a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi%3Fid%3D218004">Report</a> <br><br>  <b>8. FreeBSD.</b>  <b>CWE-561 (Unreachable code detected)</b> <br><br>  <a href="http://www.viva64.com/ru/w/v779/">V779</a> Unreachable code detected.  It is possible that an error is present.  sctp_pcb.c 183 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">struct sctp_vrf * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sctp_allocate_vrf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> vrf_id)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vrf-&gt;vrf_addr_hash == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/* No memory */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> INVARIANTS panic(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"No memory for VRF:%d"</span></span></span><span class="hljs-meta">, vrf_id); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> SCTP_FREE(vrf, SCTP_M_VRF); return (NULL); } .... }</span></span></code> </pre> <br>  ‚Üí <a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi%3Fid%3D218005">Report</a> <br><br>  <b>10. FreeBSD.</b>  <b>CWE-570 (Expression is Always False)</b> <br><br>  <a href="http://www.viva64.com/ru/w/v547/">V547</a> Expression 'value &lt;0' is always false.  Unsigned type value is never &lt;0. ar9300_xmit.c 450 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">HAL_BOOL </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ar9300_reset_tx_queue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(struct ath_hal *ah, u_int q)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">u_int32_t</span></span> cw_min, chan_cw_min, value; .... value = (ahp-&gt;ah_beaconInterval * <span class="hljs-number"><span class="hljs-number">50</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span>) - ah-&gt;ah_config.ah_additional_swba_backoff - ah-&gt;ah_config.ah_sw_beacon_response_time + ah-&gt;ah_config.ah_dma_beacon_response_time; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) value = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) value = <span class="hljs-number"><span class="hljs-number">10</span></span>; .... }</code> </pre> <br>  <a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi%3Fid%3D218007">Report</a> <br><br>  <b>11. FreeBSD.</b>  <b>CWE-571 (Expression is Always True)</b> <br><br>  <a href="http://www.viva64.com/ru/w/v617/">V617</a> Consider inspecting the condition.  The '0x00000080' argument of the '|'  bitwise operation contains a non-zero value.  mac_bsdextended.c 128 <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MBO_TYPE_DEFINED 0x00000080 static int ugidfw_rule_valid(struct mac_bsdextended_rule *rule) { .... </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ((rule-&gt;mbr_object.mbo_neg | MBO_TYPE_DEFINED) &amp;&amp; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// &lt;= (rule-&gt;mbr_object.mbo_type | MBO_ALL_TYPE) != MBO_ALL_TYPE) return (EINVAL); if ((rule-&gt;mbr_mode | MBI_ALLPERM) != MBI_ALLPERM) return (EINVAL); return (0); }</span></span></span></span></code> </pre> <br>  ‚Üí <a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi%3Fid%3D218039">Report</a> <br><br><h2>  Other errors </h2><br>  <b>1. FreeBSD</b> <br><br>  <a href="http://www.viva64.com/ru/w/v646/">V646</a> Consider inspecting the application's logic.  It's possible that 'else' keyword is missing.  if_em.c 1944 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">em_if_msix_intr_assign</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">if_ctx_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ctx, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> msix)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (adapter-&gt;hw.mac.type &lt; igb_mac_min) { tx_que-&gt;eims = <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; (<span class="hljs-number"><span class="hljs-number">22</span></span> + i); adapter-&gt;ims |= tx_que-&gt;eims; adapter-&gt;ivars |= (<span class="hljs-number"><span class="hljs-number">8</span></span> | tx_que-&gt;msix) &lt;&lt; (<span class="hljs-number"><span class="hljs-number">8</span></span> + (i * <span class="hljs-number"><span class="hljs-number">4</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (adapter-&gt;hw.mac.type == e1000_82575) <span class="hljs-comment"><span class="hljs-comment">// &lt;= tx_que-&gt;eims = E1000_EICR_TX_QUEUE0 &lt;&lt; (i % adapter-&gt;tx_num_queues); else tx_que-&gt;eims = 1 &lt;&lt; (i % adapter-&gt;tx_num_queues); .... }</span></span></code> </pre> <br>  ‚Üí <a href="https://bugs.freebsd.org/bugzilla/show_bug.cgi%3Fid%3D218041">Report</a> <br><br>  <b>2. CoreCLR</b> <br><br>  <a href="http://www.viva64.com/ru/w/v534/">V534</a> It is likely that a variable is being compared inside the 'for' operator.  Consider reviewing 'i'.  ildasm mdinfo.cpp 1421 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> MDInfo::DisplayFields(mdTypeDef inTypeDef, COR_FIELD_OFFSET *rFieldOffset, ULONG cFieldOffset) { .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (ULONG i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; count; i++, totalCount++) { .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (ULONG iLayout = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; cFieldOffset; ++iLayout) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { if (RidFromToken(rFieldOffset[iLayout].ridOfField) == RidFromToken(fields[i])) { .... } } } .... }</span></span></code> </pre> <br>  <a href="https://github.com/dotnet/coreclr/pull/10414">Report</a> <br><br><h2>  Conclusion </h2><br>  We offer to download the PVS-Studio analyzer and try to check your project: <br><br><ul><li>  Download <a href="https://www.viva64.com/ru/pvs-studio-download/">PVS-Studio for Windows</a> </li><li>  Download <a href="https://www.viva64.com/ru/pvs-studio-download-linux/">PVS-Studio for Linux</a> </li></ul><br>  To remove the demo version <a href="https://www.viva64.com/ru/m/0009/">limitation</a> , you can <a href="https://www.viva64.com/ru/about-feedback/">email</a> us and we will send you a temporary key. <br><br>  For a quick acquaintance with the analyzer, you can use utilities that track compiler launches and collect all the necessary information for verification.  See the <a href="https://www.viva64.com/ru/m/0031/">CLMonitoring</a> and <a href="https://www.viva64.com/ru/m/0036/">pvs-studio-analyzer</a> utility descriptions.  If you are working with a classic project type in Visual Studio, it is still easier: just select the ‚ÄúCheck Solution‚Äù command in the PVS-Studio menu. <br><br><div style="text-align:center;"> <a href="http://www.viva64.com/en/b/0491/"><img src="https://habrastorage.org/files/8d2/41b/5bf/8d241b5bf34747169141ed7c1997143b.png"></a> </div><br><br>  If you want to share this article with an English-speaking audience, then please use the link to the translation: Andrey Karpov.  <a href="http://www.viva64.com/en/b/0491/">Weaknesses detected by PVS-Studio this week: episode N3</a> <br><br><div class="spoiler">  <b class="spoiler_title">Read the article and have a question?</b> <div class="spoiler_text">  Often our articles are asked the same questions.  We collected answers to them here: <a href="http://www.viva64.com/ru/a/0085/">Answers to questions from readers of articles about PVS-Studio, version 2015</a> .  Please review the list. </div></div></div><p>Source: <a href="https://habr.com/ru/post/324802/">https://habr.com/ru/post/324802/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../324792/index.html">Bubble sort and binary PHP search (learning, experimenting)</a></li>
<li><a href="../324794/index.html">What is the difference between UI and UX? Detailed analysis of frequently used terms</a></li>
<li><a href="../324796/index.html">Sending files to the Xamarin.Forms application. Part 2</a></li>
<li><a href="../324798/index.html">Synchronization of rhythm in music games</a></li>
<li><a href="../324800/index.html">Interview with Leonid Vasilyev, Dropbox developer, about work and life in Ireland</a></li>
<li><a href="../324804/index.html">Quake source code analysis</a></li>
<li><a href="../324808/index.html">Convenient C ++ enumerator</a></li>
<li><a href="../324810/index.html">Modular Java applications. How?</a></li>
<li><a href="../324812/index.html">Development for Sailfish OS: Features of working with dates and time zones</a></li>
<li><a href="../324814/index.html">Learn to think in REM. Talk about the obvious and about productivity in a small web studio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>