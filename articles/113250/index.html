<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Lua vs. Javascript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I recently wrote a post about how to make a raytracer. The raytracer code was then written in JavaScript. I wondered how Lua would cope with this task...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Lua vs. Javascript</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/c85e4c05/3b7a2853/f0145aa9/ab9a0eb2.jpg" alt="Smallpic"><br><br>  I recently wrote a <a href="http://habrahabr.ru/blogs/algorithm/112944/">post</a> about how to make a raytracer.  The raytracer code was then written in JavaScript.  I wondered how Lua would cope with this task, namely <a href="http://luajit.org/luajit.html">LuaJIT 2.0</a> .  Below are the results of the comparison. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Chrome 9.0 Beta, Opera 11.01, Firefox 4.0 Beta 9, Explorer 9 Beta and LuaJIT 2.0 Beta 5 took part. All five participants rendered the same scene on a 1000x1000 screen with three beams per pixel.  Here is the scene: <br><br> <a href=""><img src="https://habrastorage.org/storage/66d44fcd/303b3c7e/33cbfa71/7dacdc68.jpg" alt="Bigimage"></a> <br><br>  The results are as follows (RPS means ‚Äúnumber of rays per second‚Äù): <br><br><table><tbody><tr><td>  Chrome </td><td>  20,400 RPS </td></tr><tr><td>  Opera </td><td>  15.700 RPS </td></tr><tr><td>  Firefox </td><td>  9,300 RPS </td></tr><tr><td>  Explorer </td><td>  9,000 RPS </td></tr><tr><td>  LuaJIT </td><td>  5,000 RPS </td></tr></tbody></table><br><br>  Unexpected result: LuaJIT was the slowest, and with a margin from the other participants. <br><br>  As noted by <a href="https://habrahabr.ru/users/freelancer/" class="user_link">FreeLancer</a> , you can change the settings of the garbage collector in Lua.  If you add a collectgarbage line ('setpause', 2000) to the beginning of the code, then the garbage collector will rarely interrupt the raytracer and the speed will increase to 25,000 RPS, but the peak memory consumption will grow to 1.5 gigabytes.  Chrome ‚Äúate‚Äù only 150 MB when it showed a result of 20,400 RPS. <br><br>  Here you can download the code for the examples: <a href="">JavaScript</a> and <a href="">LuaJIT</a> .  The JS and Lua code is identical, except for minor syntactic differences.  To run the Lua example on yourself, you need to make the luajit.exe file for yourself (take it from the LuaJIT website or compile it from source) and run it on the command line <br> <code>luajit main.lua <br></code> </div><p>Source: <a href="https://habr.com/ru/post/113250/">https://habr.com/ru/post/113250/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../113243/index.html">google translate script</a></li>
<li><a href="../113244/index.html">The film, shot on Canon 7D, bought for $ 4 million</a></li>
<li><a href="../113245/index.html">Neural networks and character recognition</a></li>
<li><a href="../113246/index.html">The story of one "violation" of copyright. Part 2</a></li>
<li><a href="../113247/index.html">How following the rules get banned Vkontakte</a></li>
<li><a href="../113252/index.html">Brainfuck - output in decimal format</a></li>
<li><a href="../113253/index.html">PHP Cheat Sheet: FALSE, NULL and values ‚Äã‚Äãassociated with them</a></li>
<li><a href="../113255/index.html">NDIS. NET_BUFFER architecture</a></li>
<li><a href="../113256/index.html">Ten years from the beginning of mass communication in LiveJournal in Russian. And also: a possible start to the pro-Kremlin monitoring of the blogosphere.</a></li>
<li><a href="../113257/index.html">sjFilemanager is a free AJAX file manager. Wheel or know-how?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>