<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tanchiki in the console, the second article: "It is time to redo everything!"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="And yet the game! 
 Hello everyone again! I'm glad you're reading this, because our story about the dispute comes to the final stage. 

 In the last a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tanchiki in the console, the second article: "It is time to redo everything!"</h1><div class="post__text post__text-html js-mediator-article"><h2>  And yet the game! </h2><br>  Hello everyone again!  I'm glad you're reading this, because our story about the dispute comes to the final stage. <br><br>  In the last article, I made sketches of the code and after a few days (thanks to the advice of more experienced programmers) I‚Äôm ready to show you a completely rewritten code with explanations. <br><br>  You can download the finished code at the end of the article from my repository (if you can‚Äôt wait). <br><a name="habracut"></a><br><h2>  Let's start from the beginning, analyze the initial objects. </h2><br>  Here we will analyze what will be in our application and what we will be winding up with electrical tape to this (of course, the code). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1st, of course, the walls (Walls) <br>  2nd, these are our players <br>  3rd, shells (Shots) <br><br>  The question arises, how to systematize and force it to work together? <br><br>  What can create a system?  Of course, the structure, but any structure must have parameters.  Now we will create the first of them - these are coordinates.  To display them conveniently, we will use the following class: <br><br><pre><code class="hljs pgsql">//      <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Position { //    <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> X { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> Y { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Position(<span class="hljs-type"><span class="hljs-type">int</span></span> x, <span class="hljs-type"><span class="hljs-type">int</span></span> y) { X = x; Y = y; } }</code> </pre> <br>  The second parameter is a distinctive number, because each element of the structure must be different, therefore in any of our structure (inside it) there will necessarily be an ID field. <br><br>  Let's start creating structures based on this class. <br>  Next, I will describe the structure and then their interaction. <br><br><h2>  Player Structure (PlayerState) </h2><br>  I singled them out separately, as there is a huge amount of methods in them and they are very important (who else will play and move the models?). <br><br>  I'll just take off the fields and start describing them below: <br><br><pre> <code class="hljs pgsql"> private <span class="hljs-type"><span class="hljs-type">int</span></span> ID { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private Position Position { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private Position LastPosition { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private <span class="hljs-type"><span class="hljs-type">int</span></span>[] Collider_X { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }//  private <span class="hljs-type"><span class="hljs-type">int</span></span>[] Collider_Y { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private <span class="hljs-type"><span class="hljs-type">int</span></span> hp { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } //  static <span class="hljs-type"><span class="hljs-type">int</span></span> dir;</code> </pre><br>  ID - I already managed to explain <br>  Position is an instance of the class of the same name, LastPosition is the previous position <br>  Collider - this is a collider (those points, hitting which you will take away health) <br><br>  The 'Players' structure, must contain methods for handling instances of the structure / preparing our instance for sending to the server, for these tasks we use the following methods: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hp_minus</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PlayerState player, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> hp</span></span></span><span class="hljs-function">) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewPosition</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PlayerState player, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> X, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Y</span></span></span><span class="hljs-function">) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForExeption</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Position startPosition</span></span></span><span class="hljs-function">) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> ShotState </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateShot</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PlayerState player, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dir_player, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> damage</span></span></span><span class="hljs-function">) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteToLastPosition</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PlayerState player, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> TEXT</span></span></span><span class="hljs-function">)</span></span></code> </pre><br>  The first method is the method of taking a certain amount of health from the player. <br>  The second method is necessary to assign a new position to players. <br><br>  The third one we use in the constructor so that there are no mistakes when creating the tank. <br>  The fourth creates a shot (i.e., shoots a bullet from a tank). <br><br>  The fifth one should print the text to the previous position of the player (do not refresh the console screen with each frame by calling Console.Clear ()). <br><br>  Now for each method separately, that is, we analyze their code: <br><br>  1st: <br><br><pre> <code class="hljs ruby"> /<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> &lt;summary&gt; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/summary&gt; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> &lt;param name=<span class="hljs-string"><span class="hljs-string">"player"</span></span>&gt;&lt;<span class="hljs-regexp"><span class="hljs-regexp">/param&gt; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> &lt;param name=<span class="hljs-string"><span class="hljs-string">"hp"</span></span>&gt;  &lt;<span class="hljs-regexp"><span class="hljs-regexp">/param&gt; public static void hp_minus(PlayerState player, int hp) { player.hp -= hp; }</span></span></code> </pre><br>  I think that there is not much to explain here, this operator record is completely equivalent to this one: <br><br><pre> <code class="hljs"> player.hp = player.hp - hp;</code> </pre> <br>  The rest of this method will not be added. <br><br>  2nd: <br><br><pre> <code class="hljs xml"> /// <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">summary</span></span></span><span class="hljs-tag">&gt;</span></span> ///     /// <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">summary</span></span></span><span class="hljs-tag">&gt;</span></span> /// <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"player"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag">&gt;</span></span> /// <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"X"</span></span></span><span class="hljs-tag">&gt;</span></span> X<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag">&gt;</span></span> /// <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Y"</span></span></span><span class="hljs-tag">&gt;</span></span> Y<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag">&gt;</span></span> public static void NewPosition(PlayerState player, int X, int Y) { if ((X &gt; 0 &amp;&amp; X <span class="hljs-tag"><span class="hljs-tag">&lt; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">) &amp;&amp; (</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Y</span></span></span><span class="hljs-tag"> &gt;</span></span> 0 &amp;&amp; Y <span class="hljs-tag"><span class="hljs-tag">&lt; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">)) { </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.LastPosition</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">player.Position;</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.Position.X</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">X;</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.Position.Y</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">Y;</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.Collider_X</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">new</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">int</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">3</span></span></span><span class="hljs-tag">]; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.Collider_Y</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">new</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">int</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">3</span></span></span><span class="hljs-tag">]; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.Collider_Y</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span><span class="hljs-tag">] = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">Y;</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.Collider_Y</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag">] = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">Y</span></span></span><span class="hljs-tag"> + </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag">; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.Collider_Y</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span><span class="hljs-tag">] = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">Y</span></span></span><span class="hljs-tag"> + </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span><span class="hljs-tag">; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.Collider_X</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span><span class="hljs-tag">] = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">X;</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.Collider_X</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag">] = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">X</span></span></span><span class="hljs-tag"> + </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag">; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">player.Collider_X</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span><span class="hljs-tag">] = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">X</span></span></span><span class="hljs-tag"> + </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span><span class="hljs-tag">; } }</span></span></code> </pre><br>  Here we combine the conditions so that another player (we will have lags on the console, suddenly there will be lags) could not leave the playing field.  By the way, the fields we use (Height and Width) they denote the borders of our field (Height and Width). <br><br>  3rd: <br><br><pre> <code class="hljs cs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForExeption</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Position startPosition</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (startPosition.X &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; startPosition.Y &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre><br>  Here we do not give the coordinates to be less than the size of the playing field. <br><br>  By the way: in the console, the coordinate system starts from the upper left corner (point 0; 0) and there is a restriction (which can also be adjusted) to 80 x and 80 y.  If we reach 80 in x, we are painted (that is, the application breaks), and if 80 in y, the field size simply increases (you can adjust these restrictions by clicking on the console and selecting properties). <br><br>  5th: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteToLastPosition</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PlayerState player, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> TEXT</span></span></span><span class="hljs-function">)</span></span> { Console.CursorLeft = player.LastPosition.X; Console.CursorTop = player.LastPosition.Y; Console.Write(TEXT); }</code> </pre><br>  Here we just print the text in the previous position (paint over it). <br><br>  There is no fourth method, since we have not yet declared the structure of the shells. <br>  Let's talk about her now. <br><br><h2>  Structure 'Shells' (ShotState) </h2><br>  This structure should describe the movement of shells and 'forget' (paint over) the path of the projectile. <br><br>  Each projectile must have a direction, starting position and damage. <br><br>  Those.  its fields will be as follows: <br><br><pre> <code class="hljs cs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Position Shot_position { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dir { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ID_Player { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> damage { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; x_way { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; y_way { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre><br>  A copy of the position class is the current position of the projectile, dir is the direction of movement of the projectile, ID_Player is the player ID of the projectile, damage is the damage of this projectile, x_way is movement along X, y_way is movement of projectile along Y. <br><br>  Here are all the methods and fields (described below) <br><br><pre> <code class="hljs pgsql">/// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; ///  ( ) /// &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="shot"&gt;&lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> ForgetTheWay(ShotState shot) { <span class="hljs-type"><span class="hljs-type">int</span></span>[] x = ShotState.x_way_array(shot); <span class="hljs-type"><span class="hljs-type">int</span></span>[] y = ShotState.y_way_array(shot); switch (shot.dir) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; x.Length - <span class="hljs-number"><span class="hljs-number">1</span></span>; i++) { Console.CursorTop = y[<span class="hljs-number"><span class="hljs-number">0</span></span>]; Console.CursorLeft = x[i]; Console.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>("0"); } } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; y.Length - <span class="hljs-number"><span class="hljs-number">1</span></span>; i++) { Console.CursorLeft = x[<span class="hljs-number"><span class="hljs-number">0</span></span>]; Console.CursorTop = y[i]; Console.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>("0"); } } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">180</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; x.Length - <span class="hljs-number"><span class="hljs-number">1</span></span>; i++) { Console.CursorLeft = x[i]; Console.CursorTop = y[<span class="hljs-number"><span class="hljs-number">0</span></span>]; Console.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>("0"); } } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">270</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; y.Length - <span class="hljs-number"><span class="hljs-number">1</span></span>; i++) { Console.CursorTop = y[i]; Console.CursorLeft = x[<span class="hljs-number"><span class="hljs-number">0</span></span>]; Console.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>("0"); } } break; } } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; ///   /// &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="positionShot"&gt; &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="dir_"&gt; &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="ID_Player"&gt;  &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="dam"&gt; &lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> ShotState(Position positionShot, <span class="hljs-type"><span class="hljs-type">int</span></span> dir_, <span class="hljs-type"><span class="hljs-type">int</span></span> ID_Player_, <span class="hljs-type"><span class="hljs-type">int</span></span> dam) { Shot_position = positionShot; dir = dir_; ID_Player = ID_Player_; damage = dam; x_way = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt;(); y_way = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt;(); x_way.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(Shot_position.X); y_way.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(Shot_position.Y); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static string To_string(ShotState shot) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> shot.ID_Player.ToString() + ":" + shot.Shot_position.X + ":" + shot.Shot_position.Y + ":" + shot.dir + ":" + shot.damage; } private Position Shot_position { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private <span class="hljs-type"><span class="hljs-type">int</span></span> dir { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private <span class="hljs-type"><span class="hljs-type">int</span></span> ID_Player { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private <span class="hljs-type"><span class="hljs-type">int</span></span> damage { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private List&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt; x_way { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private List&lt;<span class="hljs-type"><span class="hljs-type">int</span></span>&gt; y_way { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private static <span class="hljs-type"><span class="hljs-type">int</span></span>[] x_way_array(ShotState shot) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> shot.x_way.ToArray(); } private static <span class="hljs-type"><span class="hljs-type">int</span></span>[] y_way_array(ShotState shot) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> shot.y_way.ToArray(); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> NewPosition(ShotState shot, <span class="hljs-type"><span class="hljs-type">int</span></span> X, <span class="hljs-type"><span class="hljs-type">int</span></span> Y) { shot.Shot_position.X = X; shot.Shot_position.Y = Y; shot.x_way.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(shot.Shot_position.X); shot.y_way.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(shot.Shot_position.Y); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> WriteShot(ShotState shot) { Console.CursorLeft = shot.Shot_position.X; Console.CursorTop = shot.Shot_position.Y; Console.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>("0"); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> Position_plus_plus(ShotState shot) { switch (shot.dir) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: { shot.Shot_position.X += <span class="hljs-number"><span class="hljs-number">1</span></span>; } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span>: { shot.Shot_position.Y += <span class="hljs-number"><span class="hljs-number">1</span></span>; } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">180</span></span>: { shot.Shot_position.X -= <span class="hljs-number"><span class="hljs-number">1</span></span>; } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">270</span></span>: { shot.Shot_position.Y -= <span class="hljs-number"><span class="hljs-number">1</span></span>; } break; } Console.ForegroundColor = ConsoleColor.White; Console.CursorLeft = shot.Shot_position.X; Console.CursorTop = shot.Shot_position.Y; Console.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>("0"); shot.x_way.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(shot.Shot_position.X); shot.y_way.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(shot.Shot_position.Y); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static Position ReturnShotPosition(ShotState shot) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> shot.Shot_position; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">int</span></span> ReturnDamage(ShotState shot) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> shot.damage; }</code> </pre><br>  The first method - we forget the path in the console (i.e., paint it over), through collections with this path. <br><br>  The next is the constructor (that is, the main method that sets up our instance of the structure). <br><br>  The third method - displays all information in text form and is used only when sending <br>  to the server. <br><br>  Further methods print / return some fields for further use. <br><br><h2>  Structure 'Wall (WallState)' </h2><br>  All fields of this structure as well as methods for representing the wall and causing damage to it. <br><br>  Here are its fields and methods: <br><br><pre> <code class="hljs pgsql">private Position Wall_block { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private <span class="hljs-type"><span class="hljs-type">int</span></span> HP { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private static <span class="hljs-type"><span class="hljs-type">void</span></span> hp_minus(WallState wall ,<span class="hljs-type"><span class="hljs-type">int</span></span> damage) { wall.HP -= damage; } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; ///    /// &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="bloc"&gt; &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="hp"&gt;&lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> WallState(Position bloc, <span class="hljs-type"><span class="hljs-type">int</span></span> hp) { Wall_block = bloc; HP = hp; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">bool</span></span> Return_hit_or_not(Position pos, <span class="hljs-type"><span class="hljs-type">int</span></span> damage) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pos.X &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> || pos.Y &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> || pos.X &gt;= Width || pos.Y &gt;= Height) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } // // // <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; Walls.Count; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((Walls[i].Wall_block.X == pos.X) &amp;&amp; (Walls[i].Wall_block.Y == pos.Y)) { WallState.hp_minus(Walls[i], damage); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Walls[i].HP &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { Console.CursorLeft = pos.X; Console.CursorTop = pos.Y; Console.ForegroundColor = ConsoleColor.Black; Walls.RemoveAt(i); Console.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>("0"); Console.ForegroundColor = ConsoleColor.White; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> </pre><br>  So here.  Let's sum up some. <br><br>  Why do we need the method 'Return_hit_or_not'?  It returns whether it touched any coordinate, any object, and deals damage to it.  The 'CreateShot' method creates a shell from the constructor. <br><br><h2>  Interaction of structures </h2><br>  In our main thread there are two parallel threads (Task), we will build on them. <br><br><pre> <code class="hljs coffeescript">Task tasc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Task(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { Event_listener(); }); Task task = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Task(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { To_key(); }); tasc.Start(); task.Start(); Task.WaitAll(task, tasc);</code> </pre><br>  What are the streams?  The first one takes the data from the server and processes it, and the second sends the data to the server. <br><br>  So, we need to listen to the server (that is, receive data from it) and process the received data, as well as perform operations on the data transmitted to us. <br><br>  Any received data from the server in our project is an event object, where the arguments (as well as the name of the event) are separated by the ':' symbol, that is, we have the following output at the output: EventName: Arg1: Arg2: Arg3: ... ArgN. <br><br>  So, there are also two types of events (since there is no need for more) and interactions with the elements of the structures in our project, namely, the movement of the tank and the creation + movement of the projectile. <br><br>  But we still don‚Äôt know how to receive this data, not just what to process, so we climb into the nicest site (link at the bottom of the article) and read about the network and sockets (we need UDP), take their code and redo it for ourselves (don‚Äôt forget it is necessary to penetrate the information on this site, and not to copy it thoughtlessly), the output is such code: <br><br><pre> <code class="hljs haskell"> static void <span class="hljs-type"><span class="hljs-type">Event_listener</span></span>() { //  <span class="hljs-type"><span class="hljs-type">UdpClient</span></span>     <span class="hljs-type"><span class="hljs-type">UdpClient</span></span> receivingUdpClient = new <span class="hljs-type"><span class="hljs-type">UdpClient</span></span>(localPort); <span class="hljs-type"><span class="hljs-type">IPEndPoint</span></span> <span class="hljs-type"><span class="hljs-type">RemoteIpEndPoint</span></span> = null; try { /*th -      (     )*/ while (th) { //   byte[] receiveBytes = receivingUdpClient.<span class="hljs-type"><span class="hljs-type">Receive</span></span>(ref <span class="hljs-type"><span class="hljs-type">RemoteIpEndPoint</span></span>); //   string returnData = <span class="hljs-type"><span class="hljs-type">Encoding</span></span>.<span class="hljs-type"><span class="hljs-type">UTF8</span></span>.<span class="hljs-type"><span class="hljs-type">GetString</span></span>(receiveBytes); //<span class="hljs-type"><span class="hljs-type">TYPEEVENT</span></span>:<span class="hljs-type"><span class="hljs-type">ARG</span></span> //      string[] <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> = returnData.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Split</span></span></span><span class="hljs-class">(':').</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ToArray</span></span></span><span class="hljs-class">&lt;string&gt;(); //    </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class"> t = new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class">(() =&gt;{ </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Event_work(data)</span></span></span><span class="hljs-class">; }); t.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Start</span></span></span><span class="hljs-class">(); //       } } catch (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Exception</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ex</span></span></span><span class="hljs-class">) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Console</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Clear</span></span></span><span class="hljs-class">(); </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Console</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WriteLine</span></span></span><span class="hljs-class">(" : " + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ex</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ToString</span></span></span><span class="hljs-class">() + "\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class"> " + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ex</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Message</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">;//  -    } }</span></span></code> </pre><br>  Here we see perfectly prepared code that performs exactly what we said above, that is, using the '.Split (:)' method, we divide the text into an array of strings, then use the '.ToArray () method to assemble this array into the' data 'variable , after which we create a new thread (asynchronous, ie, it is executed independently of the task execution in this method) as well as the ‚ÄúMain‚Äù method, we describe it and run (by the '.Start ()' method). <br><br>  A small explanation in the form of a picture with a code (I used this code to test this idea), this code does not apply to the project, it was simply created to test that code (as similar) and solve one very important task: ‚ÄúIs it possible to perform actions regardless of code is basically a method. "  Spoiler: yes! <br><br><pre> <code class="hljs pgsql"> static <span class="hljs-type"><span class="hljs-type">void</span></span> Main(string[] args) { //<span class="hljs-type"><span class="hljs-type">int</span></span> id = <span class="hljs-number"><span class="hljs-number">0</span></span>; //Task tasc = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Task(() =&gt; { SetBrightness(); }); //Task task = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Task(() =&gt; { SetBrightness(); }); //tasc.<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>(); //task.<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>(); //Task.WaitAll(task, tasc); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>; i++) { Task tasc = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Task(() =&gt; { SetBrightness(); }); tasc.<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>(); //Thread.Sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>); } Console.WriteLine("It's end"); Console.<span class="hljs-keyword"><span class="hljs-keyword">Read</span></span>(); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> SetBrightness() { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; i++) { <span class="hljs-type"><span class="hljs-type">int</span></span> id = i; switch (id) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: { Console.ForegroundColor = ConsoleColor.White; } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: { Console.ForegroundColor = ConsoleColor.Yellow; } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: { Console.ForegroundColor = ConsoleColor.Cyan; } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>: { Console.ForegroundColor = ConsoleColor.Magenta; } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: { Console.ForegroundColor = ConsoleColor.Green; } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>: { Console.ForegroundColor = ConsoleColor.Blue; } break; } Console.WriteLine(""); } }</code> </pre><br>  And here is his job: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a1c/a57/13c/a1ca5713c11ce0e2df2a87169032ba1e.jpg" alt="image"><br><br>  Four running threads (one of which almost completed its work): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ef9/805/5c5/ef98055c525203b13d217ca1a31491b4.jpg" alt="image"><br><br>  Moving further, or rather into the method performed by the thread: <br><br><pre> <code class="hljs pgsql"> static <span class="hljs-type"><span class="hljs-type">void</span></span> Event_work(string[] Event) { //    EventType      //   (    )     //    ,    (  ) <span class="hljs-type"><span class="hljs-type">int</span></span> ID = <span class="hljs-type"><span class="hljs-type">int</span></span>.Parse(Event[<span class="hljs-number"><span class="hljs-number">1</span></span>]), X = <span class="hljs-type"><span class="hljs-type">int</span></span>.Parse(Event[<span class="hljs-number"><span class="hljs-number">2</span></span>]), Y = <span class="hljs-type"><span class="hljs-type">int</span></span>.Parse(Event[<span class="hljs-number"><span class="hljs-number">3</span></span>]), DIR = <span class="hljs-type"><span class="hljs-type">int</span></span>.Parse(Event[<span class="hljs-number"><span class="hljs-number">4</span></span>]); switch (Event[<span class="hljs-number"><span class="hljs-number">0</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> "movetank": { Print_tanks(ID, X, Y, DIR); } break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> "createshot": { ShotState shot = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ShotState(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Position(X, Y), DIR, ID, <span class="hljs-type"><span class="hljs-type">int</span></span>.Parse(Event[<span class="hljs-number"><span class="hljs-number">4</span></span>])); MoveShot(shot); } break; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } break; } }</code> </pre><br>  Now the description scheme starts to emerge, if our type of event is 'movetank', then only the following elements interact: 'Walls' and 'Tank'. <br><br>  But if the event type 'createshot', then everything interacts, literally. <br><br>  If the shot touched the wall - then he took her health away, if the shot touched the player - then he took away his health, if the shot just flew away - then he was gone and cleared. <br><br>  If we have another event - then we leave this method, everything seems simple. <br>  But not everything is so simple, the very juice begins if we dig deeper, or rather, into the called methods. <br><br>  From the name of these methods it is clear that the first is the movement of the tank, that is, it is the drawing and moving of the colliders, and the second is the creation and launch of the shot. <br><br>  Tank painting method: <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Print_tanks(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dir) { PlayerState player = Players[<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>]; Console.ForegroundColor = ConsoleColor.Black; PlayerState.WriteToLastPosition(player, <span class="hljs-string"><span class="hljs-string">"000\n000\n000"</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* 000 000 000 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: { Console.ForegroundColor = ConsoleColor.White; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: { Console.ForegroundColor = ConsoleColor.Yellow; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: { Console.ForegroundColor = ConsoleColor.Cyan; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: { Console.ForegroundColor = ConsoleColor.Magenta; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>: { Console.ForegroundColor = ConsoleColor.Green; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: { Console.ForegroundColor = ConsoleColor.Blue; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } PlayerState.NewPosition(player, x, y); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (dir) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">270</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span>: { Console.CursorLeft = x; Console.CursorTop = y; Console.Write(<span class="hljs-string"><span class="hljs-string">"0 0\n000\n0 0"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 0 0 000 0 0 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">180</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: { Console.CursorLeft = x; Console.CursorTop = y; Console.Write(<span class="hljs-string"><span class="hljs-string">"000\n 0 \n000"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 000 0 000 */</span></span> } }</code> </pre><br>  And the last method (for the projectile (creates and moves it)): <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveShot</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ShotState shot</span></span></span><span class="hljs-function">)</span></span> { ShotState Shot = shot; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((!PlayerState.Return_hit_or_not(ShotState.ReturnShotPosition(Shot), ShotState.ReturnDamage(Shot))) &amp;&amp; (!WallState.Return_hit_or_not(ShotState.ReturnShotPosition(Shot), ShotState.ReturnDamage(Shot)))) { <span class="hljs-comment"><span class="hljs-comment">//     -       ShotState.Position_plus_plus(Shot); } Console.ForegroundColor = ConsoleColor.Black;//   ( ) ShotState.ForgetTheWay(Shot); }</span></span></code> </pre><br>  This is our whole reception and event handling, now let's move on to creating them (the method to the creator and sender of them to the server) <br><br><h2>  Create events (To_key ()) </h2><br>  Here is a whole method of creating events, changing our coordinates and sending it all to the server (description below): <br><br><pre> <code class="hljs ruby">static void To_key() { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   PlayerState MyTank = Players[MY_ID]; System.Threading.Timer time = new System.Threading.Timer(new TimerCallback(from_to_key), null, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { Console.CursorTop = <span class="hljs-number"><span class="hljs-number">90</span></span>; Console.CursorLeft = <span class="hljs-number"><span class="hljs-number">90</span></span>; switch (Console.ReadKey().Key) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">Escape:</span></span> { time.Dispose(); th = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">Spacebar:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_shot) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-string"><span class="hljs-string">"createshot"</span></span> var shot = PlayerState.CreateShot(Players[MY_ID], PlayerState.NewPosition_X(MyTank, <span class="hljs-string"><span class="hljs-string">'\0'</span></span>), <span class="hljs-number"><span class="hljs-number">3</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"createshot:"</span></span> + PlayerState.To_string(MyTank) + <span class="hljs-string"><span class="hljs-string">":3"</span></span>);<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  - <span class="hljs-number"><span class="hljs-number">3</span></span> var thr = new Task(() =&gt; { MoveShot(shot); }); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  for_shot = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">LeftArrow:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_X(MyTank, <span class="hljs-string"><span class="hljs-string">'-'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">UpArrow:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_Y(MyTank, <span class="hljs-string"><span class="hljs-string">'-'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">RightArrow:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_X(MyTank, <span class="hljs-string"><span class="hljs-string">'+'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">DownArrow:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_Y(MyTank, <span class="hljs-string"><span class="hljs-string">'+'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">PrintScreen:</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">A:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_X(MyTank, <span class="hljs-string"><span class="hljs-string">'-'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">D:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_X(MyTank, <span class="hljs-string"><span class="hljs-string">'+'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">E:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_shot) { for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; for_shot = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    ,    <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">Q:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">S:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_Y(MyTank, <span class="hljs-string"><span class="hljs-string">'+'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">W:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_Y(MyTank, <span class="hljs-string"><span class="hljs-string">'-'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">NumPad2:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_Y(MyTank, <span class="hljs-string"><span class="hljs-string">'+'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">NumPad4:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_X(MyTank, <span class="hljs-string"><span class="hljs-string">'-'</span></span>); MessageToServer(PlayerState.To_string(MyTank)); } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">NumPad6:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_X(MyTank, <span class="hljs-string"><span class="hljs-string">'+'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">NumPad7:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_shot) { for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; for_shot = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">NumPad8:</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (for_key) { PlayerState.NewPosition_Y(MyTank, <span class="hljs-string"><span class="hljs-string">'-'</span></span>); MessageToServer(<span class="hljs-string"><span class="hljs-string">"movetank:"</span></span> + PlayerState.To_string(MyTank)); for_key = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ConsoleKey.<span class="hljs-symbol"><span class="hljs-symbol">NumPad9:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-symbol"><span class="hljs-symbol">default:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } }</code> </pre><br>  Here we use the same 'MessageToServer' method, its goal is to send data to the server. <br><br>  And the methods 'NewPosition_Y' and 'NewPosition_X', which assign a new position to our tank. <br>  (in cases - used keys, I mainly use arrows and space - you can choose your own version and copy the code from the '.Spase' case into the best option for you (or write it (specify the key) yourself)) <br><br>  And here is the last method from the interaction of client-server events, sending to the server itself: <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">static</span></span> void <span class="hljs-type"><span class="hljs-type">MessageToServer</span></span>(string <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">) { /*       */ //  </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UdpClient</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UdpClient</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sender</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UdpClient</span></span></span><span class="hljs-class">(); //  </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endPoint</span></span></span><span class="hljs-class">      </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IPEndPoint</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endPoint</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IPEndPoint</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">remoteIPAddress</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">remotePort</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">try</span></span></span><span class="hljs-class"> { //      </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">byte</span></span></span><span class="hljs-class">[] </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytes</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Encoding</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UTF8</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">GetBytes(data)</span></span></span><span class="hljs-class">; //   </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sender</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Send</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytes</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytes</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Length</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endPoint</span></span></span><span class="hljs-class">); } catch (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Exception</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ex</span></span></span><span class="hljs-class">) { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Console</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WriteLine</span></span></span><span class="hljs-class">(" : " + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ex</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ToString</span></span></span><span class="hljs-class">() + "\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class"> " + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ex</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Message</span></span></span><span class="hljs-class">); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">th</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">; } finally { //   </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sender</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Close</span></span></span><span class="hljs-class">(); } }</span></span></code> </pre><br>  Now the most important thing is reloading the movement and the shot (reloading the movement as anti-cheat, and little downtime for processing on other machines). <br><br>  This is done by the timer in the 'To_key ()' method, or rather by 'System.Threading.Timer time = new System.Threading.Timer (from_to_key (), null, 0, 10);'. <br><br>  In this line of code, we create a new timer, assign it a method to control ('from_to_key ()'), indicate that we don‚Äôt send anything to 'null', the time from which the count of the timer '0' will start (zero milliseconds (1000ms (millisecond) - 1s (second) and method call interval (in milliseconds) '10' (by the way, the 'To_key ()' method is fully configured to recharge (this is expressed in the conditions in the cases, they are associated with fields in the Program class)). <br><br>  This method looks like this: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">from_to_key</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ob</span></span></span><span class="hljs-function">)</span></span> { for_key = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; cooldown--; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cooldown &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { for_shot = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; cooldown = <span class="hljs-number"><span class="hljs-number">10</span></span>; } }</code> </pre><br>  Where 'cooldown' is a recharge (shot). <br><br>  Yet most of the elements in this project are fields: <br><br><pre> <code class="hljs ruby"> private static IPAddress remoteIPAddress;<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   private static int remotePort;<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> private static int localPort = <span class="hljs-number"><span class="hljs-number">1011</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  static List&lt;PlayerState&gt; Players = new List&lt;PlayerState&gt;();<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  static List&lt;WallState&gt; Walls = new List&lt;WallState&gt;();<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> /<span class="hljs-regexp"><span class="hljs-regexp">/-------------------------------- static string host = "localhost"; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/-------------------------------- /</span></span>*             *<span class="hljs-regexp"><span class="hljs-regexp">/ static int Width;/</span></span>*      *<span class="hljs-regexp"><span class="hljs-regexp">/ static int Height; static bool for_key = false; static bool for_shot = false; static int cooldown = 10; static int MY_ID = 0; static bool th = true;/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  </span></span></code> </pre><br><h2>  Finally the end </h2><br>  And this is the end of this article with a description of the code for the project of the tanchiki, we were able to implement almost everything except for one - downloading data from the server (walls, tanks (players)) and assigning our initial coordinates to our tank.  This we will do in the next article, where we will already touch the server. <br><br>  Links mentioned in the article: <br><br>  <a href="">My repository</a> <br>  Cool programmers who helped me write this code and taught me something new: <a href="https://habrahabr.ru/users/habra-mikhail/" class="user_link">Habra-Mikhail</a> , <a href="https://habrahabr.ru/users/norver/" class="user_link">norver</a> . <br><br>  Thank you for reading this article, if I somehow turned out to be wrong in your opinion - write in a comment and we will change it together. <br><br>  I also ask you to pay attention to the comments, as they discuss the improvements of both the project and the code.  If you want to help in the translation of the book - please write me a message or mail: koito_tyan@mail.ru. <br><br>  Let the game begin! </div><p>Source: <a href="https://habr.com/ru/post/344686/">https://habr.com/ru/post/344686/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344676/index.html">One + One - Blockchain Charity Marketplace</a></li>
<li><a href="../344678/index.html">Japanese poetry in the service of learning English: an application for memorizing the pronunciation of words</a></li>
<li><a href="../344680/index.html">5-minute guide to esoteric programming languages: try to classify them</a></li>
<li><a href="../344682/index.html">Error on the site ... What to do?</a></li>
<li><a href="../344684/index.html">We learn the car to understand languages</a></li>
<li><a href="../344690/index.html">Tutorial on the Unreal Engine. Part 5: How to create a simple game</a></li>
<li><a href="../344692/index.html">The transfer pattern scala.concurrent.Promise to the actor: usage features and alternatives</a></li>
<li><a href="../344694/index.html">Deploy Parallels RAS to Microsoft Azure in half an hour</a></li>
<li><a href="../344696/index.html">Guide to writing secure PHP applications in 2018</a></li>
<li><a href="../344700/index.html">ATOL Online: a look from the data center</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>