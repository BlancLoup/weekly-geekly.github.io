<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Something about how javascript include javascript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, friends. 

 Everything new is well forgotten old! 
 This is NOT about HTML / JavaScript, but only about JavaScript! 
 I was looking for this to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Something about how javascript include javascript</h1><div class="post__text post__text-html js-mediator-article">  Hello, friends. <br><br>  Everything new is well forgotten old! <br>  This is <b>NOT</b> about HTML / JavaScript, but only about JavaScript! <br>  I was looking for this topic on Habr√©, but I did not find ... <br><br>  I work as a system administrator in my company (windows domain) and therefore I often have to write various scripts.  During the work, a library of functions (from .prototype, to WMI) was made, which always had to be dragged from file to file, which is very annoying and weighing down the code.  It is very unpleasant when modifications of library functions begin (also written in JavaScript).  Then you have to find where this function has already been used?  The search process is tedious, and even debugging several files smacks.  It was then that I remembered that several years ago I read somewhere on the forum (already after so many years and was forgotten on which), that it is possible to make such ‚Äúinclude‚Äù <a name="habracut"></a>  . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This feature is called .WSF.  The technology is ancient, like a chalk period.  When you write one .js, then this technology seems a lot and you don‚Äôt want to exacerbate your vague xml code, but as soon as you remember that you would add a function from ‚Äúthat‚Äù script to ‚Äúthis‚Äù, you can‚Äôt do without this technology. <br>  Here is a good description: <a href="http://www.osp.ru/win2000/2007/08/4684940/">http://www.osp.ru/win2000/2007/08/4684940/</a> <br><br>  From myself I want to add that the volume of the code immediately diminished when the entry appeared at the beginning of the .wsf files <br><pre> &lt;? xml version = "1.0" encoding = "UTF-8"?&gt;
 &lt;package&gt;
   &lt;job id = "id01"&gt;
     &lt;script language = "JScript" src = "\\ server03 \ install \ AdminScripts \ frameWork.js" /&gt;
     &lt;script language = "JScript"&gt;
       &lt;! [CDATA [// Write here our functions ...
 ]]&gt;
     &lt;/ script&gt;
   &lt;/ job&gt;
 &lt;/ package&gt;
</pre><br><br>  In addition, you can make ‚Äúinclude‚Äù not only JavaScript, but also VBScript. <br><br>  But there was another problem.  I would like to highlight the syntax js / vbs, and after all, no editor can disassemble the format .wsf, because there are mixed xml, javascript / vbscript.  NDA, sometimes you wonder how to work with good technology through a notebook.  Already having come to terms with this way of editing wsf-files, I suddenly discovered that it was not me alone who was concerned about such a problem !!!  And it turned out that for this there were smart guys and wrote a great editor: <br>  <a href="http://www.brinesoft.com/ScriptEditor.asp">Script Editor</a> (trial, but ...) <br>  It has good features: the similarity of intellisense (highlights the path to the file from which the function ‚Äútake‚Äù, for example, via ctrl-Space), the ability to run the program directly from the editor‚Äôs window (who uses <a href="http://www.microsoft.com/download/en/details.aspx%3Fdisplaylang%3Den%26id%3D12028">scriptomatic</a> to evaluate: Pasted it into this editor and forward - for revision).  Built-in help for WScript objects, WshNetwork, and so on. The right objects. <br>  With a minus in this editor, I found only the lack of intellectual indents and the almost complete absence of text editor settings.  But the undoubted advantage was that instead of tabulation, four spaces are written (this is for my taste, I really like the four spaces!). <br><br>  Here is an example: <br>  The functions that I write to the frameWork.js file, and place the file in the "\\ server03 \ install \ AdminScripts \ frameWork.js" directory. <br><pre> // Display a message on the screen (in order not to write often WScript.Echo ()):
 // To suppress echo output, simply set this variable to false.
 // Very handy at the end of the debugging process, so that nothing is output.
 var boolShowEchoFunction = true;
 function echo (str)
 {
    if (boolShowEchoFunction == false)
    {
       return;
    }
     if (typeof (window)! = 'undefined')
     {
       window.alert (str);
     }
     if (typeof (WScript)! = 'undefined')
     {
       WScript.Echo (str);
     }
 }

 // Open the file and save the line in it (I write a lot of logs to text files):
 function appendStrToFile (fileName, strData)
 {
    try
    {
      var fso = WScript.CreateObject ("Scripting.FileSystemObject");

      // Expand the path into components and check whether there is a directory in which to write the file:
      var arrPath = new Array ();
          fileName = fileName.replace (/ [\ /] + / gi, "\\"). replace (/ ^ \\\\ /, "//").replace(/\\ / gi ,"\n") .replace (/ ^ \ / \ // gi, "\\\\");
          arrPath = fileName.split ("\ n");
      // Walk along the path and check the presence of each directory:
      var fileName = arrPath [0];
      var n = 0;
          for (n = 1; n &lt;= arrPath.length-2; n ++)
          {
             fileName + = "\\" + arrPath [n];
             if (! fso.FolderExists (fileName))
             {
                  fso.CreateFolder (fileName);
             }
          }
          fileName + = "\\" + arrPath.last ();
          if (! fso. FileExists (fileName))
          {
              var file = fso.CreateTextFile (fileName);
                  file.Close ();
          }
      var f = fso. GetFile (fileName);
      var file = f.OpenAsTextStream (ForAppending, TristateTrue);
          file.Write (strData);
          file.Close ();
    }
    catch (e)
    {
      echo ("Error writing: \ nappendStrToFile (" + fileName + "," + strData + "): \ n" + e.description + ", \ n");
    }
    return;
 }

 // Get the string with today's date (aligned with zeros):

 function getStrToday ()
 {
    var now = new Date ();
    var strNowDate = now.getYear () + "-" + ((now.getMonth () + 1) &lt;= 9? "0": "") + (now.getMonth () + 1) + "-" + ( now.getDate (&lt;= 9? "0": "") + now.getDate ();
    return strNowDate;
 }

 function getStrTime ()
 {
    var now = new Date ();
    var strNowTime = (now.getHours () &lt;= 9? "0": "") + now.getHours () + ":" + (now.getMinutes () &lt;= 9? "0": "") + now .getMinutes () + ":" + (now.getSeconds () &lt;= 9? "0": "") + now.getSeconds ();
    return strNowTime;
 }

 // Return the time with millisecond accuracy.
 function getStrTimeM ()
 {
    var now = new Date ();
    var strNowTime = (now.getHours () &lt;= 9? "0": "") + now.getHours () + ":" + (now.getMinutes () &lt;= 9? "0": "") + now .getMinutes () + ":" + (now.getSeconds () &lt;= 9? "0": "") + now.getSeconds () + ":" + (now.getMilliseconds () &lt;= 99? now.getMilliseconds () &lt;= 9? "00": "0": "") + now.getMilliseconds ();
    return strNowTime;
 }


</pre><br><br>  It's time to use the library. <br>  The script writes to the file the name of the computer on which the script was run (write the file to the path "\\ server03 \ install \ AdminScripts \ powerOnToFile.wsf"): <br><pre> &lt;? xml version = "1.0" encoding = "UTF-8"?&gt;
 &lt;package&gt;
   &lt;job id = "id01"&gt;
     &lt;script language = "JScript" src = "\\ server03 \ install \ AdminScripts \ frameWork.js" /&gt;
     &lt;script language = "JScript"&gt;
       &lt;! [CDATA [// Register event entry
 function logonToFile ()
 {
        WshShell = WScript.CreateObject ("WScript.Shell");
        WshNetwork = WScript.CreateObject ("WScript.Network");

    var maxLen = 0;
    var now = new Date ();
    var fileName = "\\\\ server03 \\ Files \\ log \\ powerOn \\" + getStrToday () + "\\ powerOn - [" + WshNetwork.ComputerName + "] [" + getStrToday () + "]";  // Suffix of the file into which infa will merge.
    var strNowDate = getStrToday ();
    var strNowTime = getStrTime ();
        appendStrToFile (fileName + ". txt", "\ r \ n [" + strNowDate + "] [" + strNowTime + "] [" + WshNetwork.ComputerName + "]");
 }
 logonToFile ();
 ]]&gt;
     &lt;/ script&gt;
   &lt;/ job&gt;
 &lt;/ package&gt;
</pre><br>  Through Active Directory in GPO-&gt; Computer Configuration-&gt; Windows Configuration-&gt; Startup / Completion Scripts-&gt; Startup-&gt; "cscript.exe", "\\ server03 \ Install \ AdminScripts \ powerOnToFile.wsf" <br><br>  Now I know that the computer was turned on today. <br><br>  The second script determines the user's login on the computer on which this script is running: <br>  (write the file to the path "\\ server03 \ install \ AdminScripts \ logonToFile.wsf"): <br><br><pre> &lt;? xml version = "1.0" encoding = "UTF-8"?&gt;
 &lt;package&gt;
   &lt;job id = "id01"&gt;
     &lt;script language = "JScript" src = "\\ server03 \ install \ AdminScripts \ frameWork.js" /&gt;
     &lt;script language = "JScript"&gt;
       &lt;! [CDATA [// Register event entry
 function logonToFile ()
 {
        WshShell = WScript.CreateObject ("WScript.Shell");
        WshNetwork = WScript.CreateObject ("WScript.Network");

    var maxLen = 0;
    var now = new Date ();
    var fileName = "\\\\ server03 \\ Files \\ log \\ powerOn \\" + getStrToday () + "\\ powerOn - [" + WshNetwork.ComputerName + "] [" + getStrToday () + "]";  // Suffix of the file into which infa will merge.
    var strNowDate = getStrToday ();
    var strNowTime = getStrTime ();
        appendStrToFile (fileName + ". txt", "\ r \ n [" + strNowDate + "] [" + strNowTime + "] [" + WshNetwork.ComputerName + "]");
 }
 logonToFile ();
 ]]&gt;
     &lt;/ script&gt;
   &lt;/ job&gt;
 &lt;/ package&gt;
</pre><br><br>  Through Active Directory in GPO-&gt; User Configuration-&gt; Windows Configuration-&gt; Startup / Completion Scripts-&gt; Startup-&gt; "cscript.exe", "\\ server03 \ Install \ AdminScripts \ logonToFile.wsf" <br>  Now, when users turn on computers in the morning and log in to them, they‚Äôre in the directory <br>  \\ server03 \\ Files \\ log <br>  I write files with the information I need, that the computer is turned on and that the user has logged on to a specific computer with a specific login.  As you can see, both files used the echo () and appendStrToFile (), getStrToday () functions, which were taken from the frameWork.js library file. <br><br>  Now, as an administrator, I have information on which computers were turned on today and which users logged on. <br><br>  I hope that such a simple technology with this editor can bring huge benefits to someone. </div><p>Source: <a href="https://habr.com/ru/post/126802/">https://habr.com/ru/post/126802/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126796/index.html">Radically redesigned Evernote extension for Firefox</a></li>
<li><a href="../126797/index.html">New groups connect to Chrome Hackathons and GTUGs and Google!</a></li>
<li><a href="../126799/index.html">Red Calendar Day: New Startup Weekend</a></li>
<li><a href="../126800/index.html">Spin XSS on Yandex (fixed)</a></li>
<li><a href="../126801/index.html">Mouse Track - virtual becomes more real</a></li>
<li><a href="../126803/index.html">VHDL delay element. Another look</a></li>
<li><a href="../126804/index.html">Non-standard use of Get and Set in Javascript</a></li>
<li><a href="../126805/index.html">WAART with joint forces</a></li>
<li><a href="../126806/index.html">Interception of smartphone keystrokes using an accelerometer</a></li>
<li><a href="../126808/index.html">My Exercise2. PaintUp - coloring multi-colored sketches online</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>