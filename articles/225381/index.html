<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>OpenSSL: New Vulnerability: Ability to perform a MITM attack (CVE-2014-0224)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Attack OpenSSL MITM CCS injection 
 Over the past few years, several serious vulnerabilities have been discovered in various cryptographic libraries. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>OpenSSL: New Vulnerability: Ability to perform a MITM attack (CVE-2014-0224)</h1><div class="post__text post__text-html js-mediator-article"><h4>  Attack OpenSSL MITM CCS injection </h4><br>  Over the past few years, several serious vulnerabilities have been discovered in various cryptographic libraries.  Although only a few of them could actually be massively used before their details became publicly available, and patches were released with corrections, serious vulnerabilities such as Heartbleed prompted developers, researchers and ordinary users to heighten the intensity of these products. <br><br>  Among the recent bugs fixed in OpenSSL version 1.0.1h, the main one is the possibility of MITM-attack (CVE-2014-0224) against the OpenSSL and TLS protocols. <br><a name="habracut"></a><br><h5>  What is CVE-2014-0224 and should I worry about it? </h5><br>  The short answer is ambiguous, but as in the case of any other vulnerability in security, it is always better to fix than to postpone and worry. <br>  <i>Translator's note</i> : it seems to me that you just need to run and update.  This vulnerability is reduced to "no" the whole point of SSL. <br><br>  To exploit this vulnerability, the following conditions must be met: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <b>Both client and server must be vulnerable.</b>  On the client side, all versions of OpenSSL are vulnerable.  On the server side, only version 1.0.1 is currently considered vulnerable.  If either the client or the server has the vulnerability fixed, exploiting the vulnerability becomes impossible. <br></li><li>  <b>The attacker must be a "man in the middle."</b>  The attacker must be able to intercept and modify your packets.  Ten years ago, such an attack vector seemed almost impossible for anyone other than Internet service providers, since they have access to all network devices through which Internet traffic goes. <br>  (Translator's note: ten years ago, and unreasonable providers now can listen to neighbor traffic with active sniffers using, for example, arp-poisoning) </li></ul><br>  However, with the advent of various public wireless access points that are freely available in cafes, restaurants, etc., MITM becomes more real.  In addition, there are many software that allows you to create fake access points.  Once a client connects to such an access point, an attacker can become a ‚Äúman in the middle‚Äù for the traffic from the client.  A successful man-in-the-middle attack can make your credentials, confidential information available to an attacker, or provide an attacker with an opportunity to fake the identity of the victim. <br><br><h5>  How does this attack work? </h5><br>  The SSL / TLS session is initialized by negotiation through the ClientHello and ServerHello messages with the appropriate party.  This part of the protocol is responsible for setting the session attributes, such as the version of the protocol used, the encryption protocol, encryption keys, message authentication code (Message Authentication Code (MAC)), initialization vectors and extensions used. <br><br>  For various reasons, both the client and server may decide to modify the cryptographic algorithm selection strategies during the negotiation phase (do not confuse with the negotiation protocol).  This is achieved using a ChangeCipherSpec (CCS) request.  CCS consists of one packet sent from the client and server side to notify that the following data will be protected by new cryptoalgorithms and keys. <br><br>  In accordance with the standards (RFC 2246, RFC 5246) ‚ÄúCCS is sent during the handshake after the security parameters have been agreed, but before checking that the message‚Äú Finished ‚Äùhas been sent‚Äù.  However, in the case of OpenSSL, this is not the case, and it accepts CCS even until the security settings are negotiated.  It is expected that when you accept ChangeCipherSpec in the wrong order, there will be out of sync states between both sides.  This usually leads to the fact that both parties must break the connection if, however, you do not have other vulnerabilities. <br><br>  In order to exploit this vulnerability, the "man in the middle" needs: <br><br>  Wait for the new connection to be established, with subsequent messages from the ClientHello / ServerHello.  Send a CCS packet in both directions, which will cause OpenSSL to use a zero-length master key.  Session keys will be created, based on this ‚Äúzero‚Äù key and future session keys will also be vulnerable. <br>  Re-initialize matching options. <br>  The attacker is able to decrypt and even modify the transmitted packets. <br><br>  OpenSSL fixed this vulnerability as follows: CCS packets cannot be received until the master key is installed, and zero-length master keys are not allowed. <br><br><h5>  How to protect yourself? </h5><br>  Update the OpenSSL package to the latest version provided by your distribution. <br><br><h5>  Translator's Note: </h5><br>  This vulnerability in OpenSSL was reported by KIKUCHI Masashi (Lepidum Co. Ltd.) on May 1, 2014.  Based on his patch, the fix for OpenSSL was developed by Stephen Henson from the OpenSSL team. <br><br>  Corrected versions released for <br>  OpenSSL 0.9.8 - 0.9.8za <br>  OpenSSL 1.0.0 - 1.0.0m <br>  OpenSSL 1.0.1 - 1.0.1h <br><br>  <a href="https://bugs.gentoo.org/show_bug.cgi%3Fid%3D512506">Bug in Ghent</a> (corrected version (openssl-1.0.1h) already in portazh) <br>  <a href="http://changelogs.ubuntu.com/changelogs/pool/main/o/openssl/openssl_1.0.1f-1ubuntu2.2/changelog">In trusty, fixed</a> (openssl (1.0.1f-1ubuntu2.2) trusty-security; urgency = medium) <br>  In <a href="https://security-tracker.debian.org/tracker/CVE-2014-0224">debian wheezy, there is a fix</a> (1.0.1e-2 + deb7u10).  The rest of debian (squeeze, jessie, sid) are currently vulnerable. <br><br>  Thank you <a href="http://habrahabr.ru/users/amarao/" class="user_link">amarao</a> and <a href="http://habrahabr.ru/users/valdikss/" class="user_link">valdikss</a> for help with the translation. </div><p>Source: <a href="https://habr.com/ru/post/225381/">https://habr.com/ru/post/225381/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225365/index.html">How to turn ordinary sites into adaptive?</a></li>
<li><a href="../225367/index.html">30 useful services for web developer</a></li>
<li><a href="../225369/index.html">WWDC 2014. Wednesday News</a></li>
<li><a href="../225371/index.html">Cubietruck. Cozy home server</a></li>
<li><a href="../225375/index.html">ECS LIVA: Mini PC with Intel Bay Trail for $ 180</a></li>
<li><a href="../225383/index.html">Record of the webinar "What's new in Kerio Connect 8.3"</a></li>
<li><a href="../225385/index.html">"Rain", Slon.ru and "Big City" will unite into a holding and will hold an IPO on the Moscow Stock Exchange</a></li>
<li><a href="../225387/index.html">The history of the gaming market, part 2</a></li>
<li><a href="../225395/index.html">Hypertext Vector Fidonet</a></li>
<li><a href="../225397/index.html">Spring bean custom scope</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>