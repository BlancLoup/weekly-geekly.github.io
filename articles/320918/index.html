<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Configure Let's Encrypt on Microsoft Azure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I‚Äôve been looking for a long time how to safely set up SSL certificate from Let's Encrypt on Microsoft Azure. There were problems with this in RuNet, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Configure Let's Encrypt on Microsoft Azure</h1><div class="post__text post__text-html js-mediator-article">  I‚Äôve been looking for a long time how to safely set up SSL certificate from <a href="https://letsencrypt.org/">Let's Encrypt</a> on Microsoft Azure.  There were problems with this in RuNet, but there was a very, very useful <a href="https://gooroo.io/GoorooTHINK/Article/16420/Lets-Encrypt-Azure-Web-Apps-the-Free-and-Easy-Way/21872">article</a> in the vast Internet that I was able to set up this shaitanism.  I think, for beginners who have problems with foreign languages ‚Äã‚Äã(it happens this way, but we all learn), translation of the article is useful. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4c5/ea7/eaf/4c5ea7eaf2965e6411e3d653a666f8a0.png" alt="image"><br><a name="habracut"></a><br>  So, let's begin. <br><br>  1. The service plan for servicing our web application on Azure should be no lower than ‚ÄúStandard‚Äù (in other words, anyone other than Basic - Basic). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/95b/6ab/c9b/95b6abc9b8aa284892f2a81fb2d69d66.png" alt="image"><br><br>  2. Your domain.  To configure an SSL certificate, you need a custom domain, which can be bolted into the ‚ÄúCustom Domains‚Äù menu in the settings panel of your application.  You cannot configure an SSL certificate for a domain like .azurewebsites.net. <br><br><img src="https://habrastorage.org/files/ad2/3e2/0d0/ad23e20d08b44066970913567a2f6693.png"><br><br><div class="spoiler">  <b class="spoiler_title">Magic</b> <div class="spoiler_text">  I don't understand the next two points, but it works great without them.  But I have it, I don‚Äôt know how it will work for you, therefore, if anyone knows what it is and what it is eaten with, I will be glad and add to the article. <br><br>  3. Create a data warehouse account.  Described in detail in <a href="https://docs.microsoft.com/en-us/azure/storage/storage-create-storage-account">this</a> article, but it is in English.  language.  In a simple way: <img src="https://habrastorage.org/files/aab/ca2/0f9/aabca20f9e6440008ca4a1f64d25a84f.png">  .  We create. <br><br>  4. Customize </div></div><br>  5. Set up access to our services. <br><br>  Install and run PowerShell as administrator.  <a href="https://azure.microsoft.com/en-us/documentation/articles/powershell-install-configure/">Install AzurePowerShellModule</a> <br><br><pre><code class="hljs tex"># Install the Azure Resource Manager modules from the PowerShell Gallery Install-Module AzureRM # Install the Azure Service Management module from the PowerShell Gallery Install-Module Azure # To make sure the Azure PowerShell module is available after you install Get-Module -ListAvailable Azure* Import-Module "C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Program</span></span></span></span> Files<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowsPowerShell</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Modules</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Azure</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">XXXX</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">azure</span></span></span></span>.psd1" Import-Module "C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Program</span></span></span></span> Files<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowsPowerShell</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Modules</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Azure</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">XXXX</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">expressroute</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">expressroute</span></span></span></span>.psd1"</code> </pre> <br>  Login to Azure <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Login</span></span>-AzureRmAccount</code> </pre><br>  Set the login and password for further authorization of the Let's Encrypt application: <br><br><pre> <code class="hljs perl">$uri = <span class="hljs-string"><span class="hljs-string">'http://{some random name}'</span></span> $password = <span class="hljs-string"><span class="hljs-string">'{some strong password}'</span></span></code> </pre><br>  We perform several magic commands))) <br><br><pre> <code class="hljs php">$app = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>-AzureRmADApplication -DisplayName {some display name} -HomePage $uri -IdentifierUris $uri -Password $password <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>-AzureRmADServicePrincipal -ApplicationId $app.ApplicationId <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>-AzureRmRoleAssignment -RoleDefinitionName Contributor -ServicePrincipalName $app.ApplicationId $app.ApplicationId</code> </pre> <br>  now we have <br>  ClientSecret = $ password <br>  ClientID = ApplicationID <br>  Remember them. <br><br>  Install Let's Encrypt <br><br>  Go to the SCM console (https: // {your site name} .scm.azurewebsites.net), go to the Site Extentions section, select the Gallery item and look for the Let's Encrypt Azure module there.  Install! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fce/dcd/ad7/fcedcdad70ce4727fac233dfcc241976.png" alt="image"><br><br>  After installing the module, restart the site (the Restart Site button), and launch the module.  Now we have to configure it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a1a/c03/7ac/a1ac037acd575c145330a86ce5fd8709.png" alt="image"><br><br>  Fill in the fields: <br><br>  letsencrypt: Tenant <br>  letsencrypt: SubscriptionId <br>  letsencrypt: ClientId <br>  letsencrypt: ClientSecret <br>  letsencrypt: ResourceGroupName <br><br>  In the following way: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/56a/2af/d32/56a2afd321ce5cbfa1143a73ecdc900f.png" alt="image"><br><br>  letsencrypt: Tenant with tag # 1. <br>  letsencrypt: SubscriptionId of tag # 2 <br>  letsencrypt: ResourceGroupName from tag # 3 <br>  letsencrypt: ClientId = our ClientID, which we remember <br>  letsencrypt: ClientSecret = our ClientSecret, which we remember and do not tell anyone <br><br>  Now, in the settings of the application on the Azure portal, the settings of our extension should be visible: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/738/f6c/bff/738f6cbffc31846d8919f29d525ce56a.png" alt="image"><br><br>  Satisfied with ourselves, in the SCM console, safely click Next and go to issue a certificate. <br>  Everything is simple here - from the drop-down menu, select the domain for which we issue the certificate, and specify the mail we want. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/706/108/bd9/706108bd9b358d8e3526c661532f2e49.png" alt="image"><br><br>  Finishing the setup, just in case, we restart the site (it's Microsoft! Reinstallation often helps from freezes, bugs, sinusitis and a simple sneeze). <br><br>  If everything went well, congratulations, you now have a free SSL certificate, quoted by almost all browsers. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27f/443/c09/27f443c09594972ad794228a7a3af7d8.png" alt="image"><br><br>  And that is not all! <br><br>  Unfortunately, it was not possible to verify this (since I set everything up the other day and the deadline for reissuing the domain has not yet come), but it is assumed that the certificate will automatically reissue when it expires.  In any case, it is possible to enter and reissue a certificate literally at the touch of a button, but it is assumed (and I sincerely hope so) that the reissue of the certificate has already been configured. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8fe/0fb/f2a/8fe0fbf2a33fc568acac335410909123.png" alt="image"><br><br>  PS I ask knowledgeable people to share the missing information to make the article more complete. </div><p>Source: <a href="https://habr.com/ru/post/320918/">https://habr.com/ru/post/320918/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320902/index.html">How we prepared the redis cluster</a></li>
<li><a href="../320904/index.html">Petersburg IT exports underestimated by a large amount</a></li>
<li><a href="../320906/index.html">Yii 2.0.11</a></li>
<li><a href="../320908/index.html">Trends 2016 and 2017 in the Japanese mobile industry</a></li>
<li><a href="../320916/index.html">How to write curve queries with a non-optimal plan and make the DBMS think</a></li>
<li><a href="../320920/index.html">Another look at the development of applications for smart TV</a></li>
<li><a href="../320922/index.html">Target as an antidepressant</a></li>
<li><a href="../320924/index.html">PushAll Auth - user authentication and feedback</a></li>
<li><a href="../320926/index.html">Create anamorphic distortion in Unity</a></li>
<li><a href="../320928/index.html">Pure Python Architecture: A Walkthrough. Part 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>