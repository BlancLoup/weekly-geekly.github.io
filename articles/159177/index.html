<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Wheel speed counter squirrel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="An ordinary analog protein settled in my house. 
 She lived in a cage, lived for herself, spun her wheel. With different speeds. In the morning, usual...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Wheel speed counter squirrel</h1><div class="post__text post__text-html js-mediator-article">  An ordinary analog protein settled in my house. <br>  She lived in a cage, lived for herself, spun her wheel.  With different speeds.  In the morning, usually more energetic, in the evening, tired, slow down.  And all this time one question did not give me rest.  And how fast is the squirrel in the wheel? <br>  I thought long and once ... <br>  I decided to make <i>a wheel speed counter</i> . <br><br>  The photo is a prototype.  Therefore, not everything is done neatly. <br><br><img src="https://lh3.googleusercontent.com/-6y5wzOvftJE/UKZBfDCgfsI/AAAAAAAAAXA/4q0DYrd1_JY/s720/IMG_1766.JPG" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Sortsy, video and final measurement results under the cat. <br><a name="habracut"></a><br><br><h3>  Components. </h3><br><ol><li>  Arduino Uno. </li><li>  Screen LKM-1638. </li><li>  Hall sensor (any suitable). </li><li>  Expansion Board. </li><li>  Bonus - Temperature and humidity sensor DHT11. </li></ol><br><br>  In principle, all I needed was a microcontroller on the board, an LKM-1638 screen, and a simple Hall sensor, but choosing all this, I also took a DHT11 humidity and temperature sensor to immediately pump the squirrel cage into a smart one!  Ordered on dx.com. <br><br>  He did everything himself, with his own hands. <br><br>  I chose a ready-made Arduino Uno board, so as not to waste time on wiring, pickling, programmers, etc., and immediately begin to implement the plan.  The screen took the LKM-1638, because it is bright, <s>chotke</s> , with large and clear numbers. <br><br>  Along the way, the buttons on the display were useful for displaying statistical information. <br><br><h3>  Pressing the corresponding button displays: </h3><br><ol><li>  Total mileage in kilometers. </li><li>  Maximum speed of the circle. </li><li>  Average daily mileage in kilometers. </li><li>  Average speed per lap. </li><li>  Uptime in days </li><li>  Total number of revolutions of the circle </li><li>  Current humidity. </li><li>  Current temperature. </li></ol><br><br>  It turned out almost like in Formula 1.  If there were several squirrels, you could arrange your <s>blackjack</s> tote. <br><br>  Yes, and there, under the buttons on the display, there were LEDs in an amount equal to the number of buttons.  With their help, it was decided to visualize the speed.  Make a semblance of a digital tachometer.  By the principle: the more diodes are lit, the closer the current speed is to the maximum, the smaller, the lower the minimum speed. <br><br>  I gathered everything together, connected the wires and started writing the code. <br>  The library for the screen took ready <a href="http://code.google.com/p/tm1638-library/">here</a> . <br>  For temperature and humidity sensor examples and library <a href="http://arduino-info.wikispaces.com/DHT11-Humidity-TempSensor">here</a> . <br>  For the Hall sensor, I took everything from my head. <br><br>  The logic of the speed counter is very simple. <br>  The Hall sensor is attached to the cell at the point closest to the wheel.  There is a small but very strong neodymium magnet on the wheel, which I pulled out of the head of an old DVD drive. <br>  When the wheel rotates, with each integer turn of the magnet for a short time changes the magnetic field in the radius of measurement of the Hall sensor, changing in the latter state from 1 to 0. With the reverse arrangement of the sensor, the value would change from 0 to 1 (which is probably more correct ), but then the sensor would be worse kept on the cell. <br>  The difference in time between the two occurrences of a magnet in the area of ‚Äã‚Äãthe sensor is recognized for a whole circle.  Further, knowing the inner circumference of the wheel, you can easily calculate the speed of the circle and bring it to the display, which I did. <br>  It should be noted here that this method of measurement has <em>nuances</em> : <br><ol><li>  It is considered only a complete revolution of the wheel.  If the squirrel scrolled, for example, 0.9 turnover and jumped out of it, then this turnover is not counted at all.  Or if she turned the wheel at 1.9, 2.9, 3.9 ... n.9 revolutions and so repeated many times during the device testing process, then there is a big error in the calculation of the total mileage, and the speed of these incomplete circles is not taken into account in calculating the average speed. </li><li>  When the squirrel jumps out of the still rotating wheel in the direction opposite to the rotation, then in opposite direction, if the magnet just passed by the sensor at that time, the magnet passes the sensor again in the other direction, erroneously fixing the whole full turn of the wheel. </li></ol><br>  Measurement errors in these cases can be minimized by increasing the number of sensors, for example, to 4 and placing <br>  they are on opposite sides of the circle (in? / 2 radians or 90 degrees).  Then you can take into account not only every quarter turn, which will definitely increase the accuracy of measurements, but also know the direction of the wheel rotation (i.e. where the protein runs - home or from home to the neighbor). <br><br>  The current wheel speed displayed in real time on the display in kilometers / hour. <br><br>  Next is the code itself.  I note that the code is quite working, but the version is not final.  By the time available, I will optimize it. <br><br><div class="spoiler">  <b class="spoiler_title">All code</b> <div class="spoiler_text"> / * <br>  sketch for counting wheel speed <br>  and output values ‚Äã‚Äãto 8 digital screen <br>  plus output current temperature and humidity <br>  release <br>  * / <br><br>  / ************** For digital DHT11 sensor *************** / <br>  #define dht_dpin A2 <br><br>  byte bGlobalErr; <br><br>  byte dht_dat [5]; <br>  / ************** End for digital sensor DHT11 ********** / <br><br>  / ******* variables for the digital module ****************** / <br><br>  // library for 8-segment digital module <br>  #include "TM1638.h" <br>  // Pins in the data pin 5 module, clock pin 4 and strobe pin 6 <br>  TM1638 module (5, 4, 6); <br>  #define Red TM1638_COLOR_RED <br>  #define Green TM1638_COLOR_GREEN <br>  #define Red_green TM1638_COLOR_GREEN + TM1638_COLOR_RED <br><br>  / ************ end of variables for module *************** <br><br>  / ********* variables for the Hall sensor ******************** / <br><br>  // wheel circumference in meters (it is necessary to clarify) <br>  static float One_round = 0.91; <br><br>  // determine the port for connecting the Hall sensor <br>  #define Hall_port 2 <br>  #define Max_led_light_speed 8 <br>  // interval of 10 seconds, if the larger wheel is recognized only as stopped, <br>  // if less, then it is considered that it is cool <br>  #define Wait_interval 10000 <br>  // interval after which the screen turns off <br>  #define Do_sleeping_interval 60000 <br>  // pause in sensor polls in normal mode <br>  #define Delay_in_work 5 <br>  // pause in sensor polls in sleep mode <br>  #define Delay_in_sleep 50 <br><br>  // wheel spin count <br>  unsigned long Round_counter = 0; <br>  // store the previous time here to calculate speed <br>  unsigned long Prev_time = 0; <br>  // store the previous time here for continuous monitoring <br>  unsigned long Prev_time_mon = 0; <br>  // here is the data to monitor pauses for zeroing and turning off the screen, etc. <br>  unsigned long time_span_mon = 0; <br>  // previous sensor value <br>  byte PrevValue = 1; <br>  // current wheel speed cm / c <br>  double Curr_speed = 0; <br>  // maximum wheel speed m / c <br>  double Max_speed = 0; <br>  // total mileage to be counted by pressing buttons <br>  double Total_run = 0; <br>  // speed of all circles here put to calculate the average <br>  double All_speeds = 0; <br>  // how many days have passed <br>  double Day_passed = 0; <br>  // variable to store the system state <br>  // 0- system in power saving and standby mode - the wheel has not been cool for a long time - the screen is off <br>  // 1- the wheel has just ceased to spin <br>  // 2- sprint wheel <br>  byte Sys_status = 0; <br><br>  / *************** end of variables for Hall ****************** / <br><br>  void setup () { <br><br>  Serial.begin (9600); <br>  InitDHT (); // initialisation sensor DHT11 <br>  Serial.println (‚ÄúRun!‚Äù); <br><br>  // turn on the display, displaying 0 <br>  module.setDisplayToString ("0.", 0, 7); <br>  delay (1000); <br><br>  } <br><br>  void loop () { <br><br>  if (Sys_status == 0) <br>  { <br>  // If sleep mode, then less often we poll sensor <br>  delay (Delay_in_sleep); <br>  } <br>  else <br>  { <br>  // if the operating mode is more often we poll the sensor <br>  delay (Delay_in_work); <br>  } <br>  / ************** start of the buttons ********************************* ******* / <br><br>  // listen to buttons <br>  byte keys = module.getButtons (); <br><br>  // if the button is pressed and the time is longer than the timeout, then turn on the display <br>  if (keys! = 0 &amp;&amp; Sys_status == 0) <br>  { <br>  module.setupDisplay (true, 7); <br>  } <br><br>  switch (keys) { <br>  // if leftmost button is pressed <br>  case 0b00000001: <br><br>  // we blink the corresponding diode the others we extinguish <br>  module.setLEDs (0); <br>  module.setLED (Red, 0); <br>  module.clearDisplay (); <br>  // display the total mileage in kilometers <br>  Total_run = Round_counter * (double) One_round / 1000.00; <br><br>  DoubleToDisp (Total_run); <br>  //module.setDisplayToDecNumber (Total_run, 1, false); <br>  delay (1000); <br>  // if the status is zero, then turn off the screen <br>  if (Sys_status == 0) <br>  { <br>  module.setupDisplay (false, 0); <br>  } <br><br>  break; <br><br>  // if the 2nd is pressed from the left <br>  case 0b00000010: <br>  // we blink the corresponding diode the others we extinguish <br>  module.setLEDs (0); <br>  module.setLED (Red, 1); <br>  module.clearDisplay (); <br>  // display the maximum speed <br>  DoubleToDisp (Max_speed); <br>  //module.setDisplayToDecNumber (Max_speed, 1, false); <br>  delay (1000); <br>  if (Sys_status == 0) <br>  { <br>  module.setupDisplay (false, 0); <br>  } <br>  break; <br><br>  // if left 3 is pressed <br>  case 0b00000100: <br>  // we blink the corresponding diode the others we extinguish <br>  module.setLEDs (0); <br>  module.setLED (Red, 2); <br>  module.clearDisplay (); <br>  // how many days have we passed since we started <br>  Day_passed = millis () / 86400000.00; <br>  // if the whole day passed <br>  if (Day_passed&gt; 1) <br>  { <br><br>  // count the total mileage in kilometers <br>  Total_run = Round_counter * (double) One_round / 1000.00; <br>  // print the average daily run <br>  DoubleToDisp (Total_run / Day_passed); <br>  delay (1000); <br>  module.clearDisplay (); <br>  } <br>  else // if the whole day has not passed <br>  { <br>  module.setDisplayToString ("0", 0); <br>  } <br>  if (Sys_status == 0) <br>  { <br>  module.setupDisplay (false, 0); <br>  } <br><br>  break; <br><br>  // if 4th left is pressed <br>  case 0b00001000: <br>  // we blink the corresponding diode the others we extinguish <br>  module.setLEDs (0); <br>  module.setLED (Red, 3); <br>  module.clearDisplay (); <br>  // count and display the average speed per lap :) <br>  DoubleToDisp (All_speeds / Round_counter); <br><br>  delay (1000); <br>  if (Sys_status == 0) <br>  { <br>  module.setupDisplay (false, 0); <br>  } <br>  break; <br><br>  // if 5th left is pressed <br>  case 0b00010000: <br>  // we blink the corresponding diode the others we extinguish <br>  module.setLEDs (0); <br>  module.setLED (Red, 4); <br>  module.clearDisplay (); <br>  // how many days have we passed since we started <br>  Day_passed = millis () / 86400000.00; <br>  DoubleToDisp (Day_passed); <br><br>  delay (1000); <br>  if (Sys_status == 0) <br>  { <br>  module.setupDisplay (false, 0); <br>  } <br>  break; <br><br>  // if 6th left is pressed <br>  case 0b00100000: <br>  // we blink the corresponding diode the others we extinguish <br>  module.setLEDs (0); <br>  module.setLED (Red, 4); <br>  module.clearDisplay (); <br>  // display the number of circles <br>  module.setDisplayToDecNumber (Round_counter, 0, false); <br><br>  delay (1000); <br>  if (Sys_status == 0) <br>  { <br>  module.setupDisplay (false, 0); <br>  } <br>  break; <br><br>  // if 1st is pressed on the right <br>  case 0b10000000: <br>  // we blink the corresponding diode the others we extinguish <br>  module.setLEDs (0); <br>  module.setLED (Red, 7); <br>  module.clearDisplay (); <br>  // display current humidity <br>  ReadDHT (); // read the sensor <br>  // if there are no errors <br>  if (bGlobalErr == 0) <br>  { <br>  byte humidity = dht_dat [0]; <br>  module.setDisplayToDecNumber (humidity, 0, false); <br>  // DoubleToDisp (humidity); <br>  } <br>  delay (1000); <br>  if (Sys_status == 0) <br>  { <br>  module.setupDisplay (false, 0); <br>  } <br>  break; <br><br>  // if 2nd is pressed on the right <br>  case 0b01000000: <br>  // we blink the corresponding diode the others we extinguish <br>  module.setLEDs (0); <br>  module.setLED (Red, 6); <br>  module.clearDisplay (); <br>  // display the current temperature <br>  ReadDHT (); // read the sensor <br>  // if there are no errors <br>  if (bGlobalErr == 0) <br>  { <br>  byte temperature = dht_dat [2]; <br>  module.setDisplayToDecNumber (temperature, 0, false); <br>  } <br>  delay (1000); <br>  if (Sys_status == 0) <br>  { <br>  module.setupDisplay (false, 0); <br>  } <br>  break; <br>  } <br>  // end of buttons <br>  / **************** end of buttons ******************************* ******* / <br><br>  / **************** here is the whole logic of reading info ************************** / <br><br>  // read data - connect the hall sensor to the 3rd digital port <br>  int sensorValue = digitalRead (Hall_port); <br><br>  // if the sensor state has changed <br>  if (sensorValue! = PrevValue) <br>  { <br>  PrevValue = sensorValue; <br>  // if the sensor gives 0 i.e.  magnet here <br>  if (! sensorValue) <br>  { <br>  Sys_status = 2; <br><br>  // turn on the display if the pause was longer than the interval slip and it has already turned off <br>  if (time_span_mon&gt; Do_sleeping_interval) <br>  { <br>  module.setupDisplay (true, 7); <br>  } <br>  // add the counter <br>  Round_counter ++; <br><br>  // current time we take in millisecs <br>  unsigned long time_now = millis (); <br><br>  // count the difference in ms in time between the current and previous <br>  unsigned long time_span = time_now - Prev_time; <br>  // current write to previous <br>  Prev_time = time_now; <br>  // if the pause is less than 10 seconds, then we recognize that the wheel is cool <br>  if (time_span &lt;Wait_interval) <br>  { <br>  if (Curr_speed&gt; 10.00) <br>  { <br>  module.clearDisplay (); <br>  } <br><br>  Curr_speed = One_round / time_span * 1000 * 3.6;  // kilometers per hour we get speed <br>  All_speeds + = Curr_speed; // to calculate the average <br><br>  // check for maximum <br>  if (Curr_speed&gt; Max_speed) <br>  Max_speed = Curr_speed; <br><br>  byte led_speed = map (Curr_speed, 0, Max_led_light_speed, 0, 7); <br>  // call the backlight <br>  Led_speed_light (led_speed); <br><br>  // debug <br>  // Serial.print ("Round_counter ="); <br>  //Serial.println(Round_counter); <br>  //Serial.print ("curr_speed (km / h) ="); <br>  //Serial.println(Curr_speed, 4); <br><br>  // display current speed <br>  DoubleToDisp (Curr_speed); <br><br>  } <br>  // if the pause is more than 10 seconds, then we believe that the wheel stood before <br>  // and we do not take into account the previous time data, but we start <br>  // count the difference first <br>  else <br>  { <br>  Prev_time = time_now; <br><br>  // debug <br>  //Serial.print ("time_span reset"); <br>  } <br><br>  } <br><br>  } <br><br>  else // if the state of the sensor has not changed <br>  { <br>  // current time we take <br>  unsigned long time_now = millis (); <br><br>  // time difference between the current and previous for post monitoring in ms; <br>  time_span_mon = time_now - Prev_time; <br><br>  // if the interval between touches is more than 10 seconds - then we assume that the wheel <br>  // stopped and output 0 (interval needs to be clarified) <br>  if (time_span_mon&gt; Wait_interval &amp;&amp; Sys_status! = 1) <br>  { <br>  Sys_status = 1; <br>  Curr_speed = 0; <br>  module.clearDisplay (); <br>  module.setDisplayDigit (0, 7, true); <br>  module.setLEDs (0); <br>  } <br><br>  // if the pause is more than 60 seconds <br>  // if the interval between touches is more than 10 seconds - then we assume that the wheel <br>  // stopped and output 0 (interval needs to be clarified) <br>  if (time_span_mon&gt; Do_sleeping_interval &amp;&amp; Sys_status! = 0) <br>  { <br>  Sys_status = 0; <br>  module.setupDisplay (false, 0); <br>  } <br><br>  } <br><br>  } <br>  /// diode illumination depending on wheel speed <br>  // function <br>  void Led_speed_light (byte led_speed) <br>  { <br>  constrain (led_speed, 0, 7); <br><br>  switch (led_speed) { <br>  case 0: <br>  module.setLEDs (0); <br>  module.setLED (Green, 0); <br>  delay (100); <br>  module.setLED (0, 0); <br>  break; <br>  case 1: <br>  module.setLEDs (0); <br>  module.setLED (Green, 0); <br>  module.setLED (Green, 1); <br>  delay (100); <br>  module.setLED (0, 1); <br>  break; <br>  case 2: <br>  module.setLEDs (0); <br>  module.setLED (Green, 0); <br>  module.setLED (Green, 1); <br>  module.setLED (Green, 2); <br>  delay (100); <br>  for (int i = 2; i&gt; 0; i -) { <br>  module.setLED (0, i); <br>  delay (50); <br>  } <br>  break; <br>  case 3: <br>  module.setLEDs (0); <br>  module.setLED (Green, 0); <br>  module.setLED (Green, 1); <br>  module.setLED (Green, 2); <br>  module.setLED (Green, 3); <br>  delay (100); <br>  for (int i = 3; i&gt; 0; i -) { <br>  module.setLED (0, i); <br>  delay (50); <br>  } <br>  break; <br>  case 4: <br>  module.setLEDs (0); <br>  module.setLED (Green, 0); <br>  module.setLED (Green, 1); <br>  module.setLED (Green, 2); <br>  module.setLED (Green, 3); <br>  module.setLED (Green, 4); <br>  delay (100); <br>  for (int i = 4; i&gt; 0; i -) { <br>  module.setLED (0, i); <br>  delay (50); <br>  } <br>  break; <br>  case 5: <br>  module.setLEDs (0); <br>  module.setLED (Green, 0); <br>  module.setLED (Green, 1); <br>  module.setLED (Green, 2); <br>  module.setLED (Green, 3); <br>  module.setLED (Green, 4); <br>  module.setLED (Red, 5); <br>  delay (100); <br>  for (int i = 5; i&gt; 0; i -) { <br>  module.setLED (0, i); <br>  delay (50); <br>  } <br>  break; <br>  case 6: <br>  module.setLEDs (0); <br>  module.setLED (Green, 0); <br>  module.setLED (Green, 1); <br>  module.setLED (Green, 2); <br>  module.setLED (Green, 3); <br>  module.setLED (Green, 4); <br>  module.setLED (Red, 5); <br>  module.setLED (Red, 6); <br>  delay (100); <br>  for (int i = 6; i&gt; 0; i -) { <br>  module.setLED (0, i); <br>  delay (50); <br>  } <br>  break; <br>  case 7: <br>  module.setLEDs (0); <br>  module.setLED (Green, 0); <br>  module.setLED (Green, 1); <br>  module.setLED (Green, 2); <br>  module.setLED (Green, 3); <br>  module.setLED (Green, 4); <br>  module.setLED (Red, 5); <br>  module.setLED (Red, 6); <br>  module.setLED (Red, 7); <br>  delay (100); <br>  for (int i = 7; i&gt; 0; i -) { <br>  module.setLED (0, i); <br>  delay (50); <br>  } <br><br>  break; <br>  } <br><br>  } <br><br>  // function displays LKM1638 fractional values ‚Äã‚Äã(accuracy - 2 characters) <br>  void DoubleToDisp (double num) <br>  { <br>  double mult_num = (double) num * 100.00; <br>  long int_mult_num = (long) mult_num; <br>  String string_mult_num = String (int_mult_num); <br>  int length = string_mult_num.length (); <br>  char str [length + 1]; <br><br>  string_mult_num.toCharArray (str, length + 1); <br><br>  // If the number was less than 1, then the collective farm to stop the correct fraction <br>  if (num &lt;1) <br>  { <br>  module.setDisplayDigit (0, 5, true); <br>  module.setDisplayDigit (str [0], 6, false); <br>  module.setDisplayDigit (str [1], 7, false); <br>  } <br><br>  else // if more than 1 then output <br>  { <br>  for (int i = 0; i &lt;length; i ++) <br>  { <br>  if (i == length - 3) { <br>  module.setDisplayDigit (str [i], i + 8-length, true); <br>  } <br>  else <br>  { <br>  module.setDisplayDigit (str [i], i + 8-length, false); <br>  } <br>  } <br>  } <br><br>  } <br><br>  / ****** functions for DHT11 *** / <br><br>  void InitDHT () { <br><br>  pinMode (dht_dpin, OUTPUT); <br><br>  digitalWrite (dht_dpin, HIGH); <br><br>  } <br><br>  void ReadDHT () { <br><br>  bGlobalErr = 0; <br><br>  byte dht_in; <br><br>  byte i; <br><br>  digitalWrite (dht_dpin, LOW); <br><br>  delay (20); <br><br>  digitalWrite (dht_dpin, HIGH); <br><br>  delayMicroseconds (40); <br><br>  pinMode (dht_dpin, INPUT); <br><br>  // delayMicroseconds (40); <br><br>  dht_in = digitalRead (dht_dpin); <br><br>  if (dht_in) { <br><br>  bGlobalErr = 1; <br><br>  return; <br><br>  } <br><br>  delayMicroseconds (80); <br><br>  dht_in = digitalRead (dht_dpin); <br><br>  if (! dht_in) { <br><br>  bGlobalErr = 2; <br><br>  return; <br><br>  } <br><br>  delayMicroseconds (80); <br><br>  for (i = 0; i &lt;5; i ++) <br><br>  dht_dat [i] = read_dht_dat (); <br><br>  pinMode (dht_dpin, OUTPUT); <br><br>  digitalWrite (dht_dpin, HIGH); <br><br>  byte dht_check_sum = <br><br>  dht_dat [0] + dht_dat [1] + dht_dat [2] + dht_dat [3]; <br><br>  if (dht_dat [4]! = dht_check_sum) <br><br>  { <br>  bGlobalErr = 3; <br>  } <br><br>  }; <br><br>  byte read_dht_dat () { <br><br>  byte i = 0; <br><br>  byte result = 0; <br><br>  for (i = 0; i &lt;8; i ++) { <br><br>  while (digitalRead (dht_dpin) == LOW); <br><br>  delayMicroseconds (30); <br><br>  if (digitalRead (dht_dpin) == HIGH) <br><br>  result | = (1 &lt;&lt; (7-i)); <br><br>  while (digitalRead (dht_dpin) == HIGH); <br><br>  } <br><br>  return result; <br><br>  } <br><br>  / ****** end of functions for DHT11 **** / <br><br></div></div><br><br>  Next, a little video to form a general idea of ‚Äã‚Äãthe resulting design. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/1xYe8cXfsd0%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhiXawmrasJzms1j5lr1Zv98Kj2GIQ" frameborder="0" allowfullscreen=""></iframe><br><br><h3>  Results, interesting facts and conclusions </h3><br><br><ol><li>  From early morning the squirrel usually runs at an average speed of ~ 5-6 km / h (apparently, in search of food and a better share). </li><li>  After a mandatory daytime sleep and taking high-calorie nuts, the squirrel speed drops to 3-4 km / h (I have already found food, I have done everything important in life). </li><li>  When running near the vacuum cleaner, the speed <s>EXTREMELY</s> increases to 12-14 km / h!  Although I met somewhere on foreign resources about the maximum speed of squirrels at 30 km / h, I can responsibly declare that all this is false.  Well, or my squirrel does not belong to the breed of hounds (African Olympic). </li><li>  The maximum speed of the circle is 18 km / h. </li><li>  The average daily mileage of a squirrel, measured in two months, is ~ 15 kilometers. </li></ol><br>  These data can be used as a <abbr title="Feasibility Study">feasibility study of a</abbr> project to create generating facilities - mini power plants for heating a squirrel house in the winter or lighting in the dark.  Or for a school project on computer science. </div><p>Source: <a href="https://habr.com/ru/post/159177/">https://habr.com/ru/post/159177/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../159155/index.html">Write CLI module for Zend Framework 2</a></li>
<li><a href="../159161/index.html">Animals on CSS3 transitions & transforms</a></li>
<li><a href="../159165/index.html">Guitar Tabs 2.0</a></li>
<li><a href="../159171/index.html">Autopsy Meizu MX</a></li>
<li><a href="../159173/index.html">ImapFilter - a powerful tool for sorting mail</a></li>
<li><a href="../159179/index.html">Banned google</a></li>
<li><a href="../159183/index.html">A copyright harm report was removed from the site of one of the US Congress committees one day after publication.</a></li>
<li><a href="../159187/index.html">Google wants to be a wireless internet provider</a></li>
<li><a href="../159189/index.html">How do you set element styles if you do not use ‚Äúforeign‚Äù libraries</a></li>
<li><a href="../159193/index.html">Voluntary limits for cloud servers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>