<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Develop iOS8 application on Apple Swift</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article is a kind of continuation of the article ‚Äú Meet, Swift! ¬ª By Helecta , as well as the free translation of the article Developing iOS Apps ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Develop iOS8 application on Apple Swift</h1><div class="post__text post__text-html js-mediator-article">  The article is a kind of continuation of the article ‚Äú <a href="http://habrahabr.ru/post/225297/">Meet, Swift!</a>  ¬ª <a href="http://habrahabr.ru/users/helecta/" class="user_link">By Helecta</a> , as well as the free translation of the article <a href="http://jamesonquave.com/blog/developing-ios-apps-using-swift-tutorial-part-2/">Developing iOS Apps Using Swift Tutorial Part 2</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/30b/9ae/145/30b9ae145abd07ce9ac222ccdc8691d6.jpg"><br><br>  So, in the first article we wrote a simple Single View application that includes a table with several cells. <br>  This time we will dive a bit and do some more ambitious things.  We will access the iTunes Search API, parse the response received in JSON and display the results in the Table View. <br>  At first glance it may seem that all this is quite difficult and there is a lot of work to be done, but in fact it is not.  All of the above is a fairly simple functionality for iOS applications, and every self-respecting iOS developer should be able to. <br><a name="habracut"></a><br>  We will need a Single View Application with the added Table View.  We will not dwell on this, since all this is simply described in the first article. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Interface connection </h4><br>  First, we need to get a pointer to our Table View in order to use it in the application code.  Go to the ViewController.swift file and immediately in the initialization of the class (class ViewController: UIViewController, UITableViewDataSource, UITableViewDelegate {) add the following line: <br><pre><code class="hljs swift"><span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> appsTableView : <span class="hljs-type"><span class="hljs-type">UITableView</span></span></code> </pre> <br>  This will allow us to associate the Table View in the Storyboard with the variable ‚ÄúappsTableView‚Äù. <br>  Go to Storyboard.  Click on the View Controller with the control held down and drag the cursor to the Table View, thereby linking these objects.  In the Outlets menu that appears, select ‚ÄúappsTableView‚Äù. <br><img src="https://habrastorage.org/getpro/habr/post_images/750/be4/41e/750be441e241a5977d6981a9a938e315.jpg"><br><br><h4>  Execution of the request API </h4><br>  Now, after we have connected the interface, we can execute our API requests. <br>  In the ViewController.swift file inside the initialization of the ViewController class, we create the searchItunesFor (searchTerm: String) function. <br><pre> <code class="hljs pgsql">func searchItunesFor(searchTerm: String) { //  The iTunes API          "+",      . var itunesSearchTerm = searchTerm.stringByReplacingOccurrencesOfString(" ", withString: "+", <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: NSStringCompareOptions.CaseInsensitiveSearch, range: nil) //  ,      URL-friendly var escapedSearchTerm = itunesSearchTerm.stringByAddingPercentEscapesUsingEncoding(NSUTF8StringEncoding) var urlPath = "https://itunes.apple.com/search?term=\(escapedSearchTerm)&amp;media=software" var url: NSURL = NSURL(string: urlPath) var <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> = NSURLSession.sharedSession() var task = <span class="hljs-keyword"><span class="hljs-keyword">session</span></span>.dataTaskWithURL(url, completionHandler: {data, response, error -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> println("Task completed") <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error) { println(error.localizedDescription) } var err: NSError? var jsonResult = NSJSONSerialization.JSONObjectWithData(data, <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: NSJSONReadingOptions.MutableContainers, error: &amp;err) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> NSDictionary <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(err?) { println(error.localizedDescription) } var results: NSArray = jsonResult["results"] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> NSArray dispatch_async(dispatch_get_main_queue(), { self.tableData = results self.appsTableView.reloadData() }) }) task.resume() }</code> </pre><br><br>  Let's take it in order. <br>  We correct our search query so that the iTunes API gets a text like ‚ÄúFirst + Second + Third + Words‚Äù instead of ‚ÄúFirst% 20Second% 20 ...‚Äù.  To do this, we use the stringByReplacingOccurencesOfString method available in NSString, which replaces spaces with a "+". <br>  Next, we clear the resulting string from characters that are not supported by the URL. <br>  The next two lines define the NSURL object that will be used as a request to the API. <br>  Pay attention to the following two lines: <br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> session = NSURLSession.sharedSession() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> task = session.dataTaskWithURL(url, completionHandler: {<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>, response, error -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span></code> </pre><br>  The first takes the standard NSURLSession object that is used for network calls. <br>  The second creates a task that sends the request. <br>  Finally, the task.resume () line starts the query. <br><br><h4>  Preparing to receive a response </h4><br>  We got a method that, when called, performs a search in iTunes.  Paste it at the end of the viewDidLoad method in our ViewController. <br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() searchItunesFor(<span class="hljs-string"><span class="hljs-string">"Angry Birds"</span></span>) }</code> </pre><br>  Now, in order to get an answer, you need to add an object that will store the search results. <br>  Therefore, we add an NSMutableData instance and an NSArray array to store the data for our table (inside the ViewController class initialization, for example, immediately after the @IBOutlet pointer var appsTableView: UITableView). <br><pre> <code class="hljs objectivec">var data: <span class="hljs-built_in"><span class="hljs-built_in">NSMutableData</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">NSMutableData</span></span>() var tableData: <span class="hljs-built_in"><span class="hljs-built_in">NSArray</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">NSArray</span></span>()</code> </pre><br>  Now, let's combine the functions that the NSURLConnection will send to our class.  Since this is a delegate of our request, any information from NSURLConnection will be returned by the protocol methods defined in NSURLConnectionDataDelegate and NSURLConnectionDelegate.  Therefore, in the initialization of ViewController, we also indicate NSURLConnectionDelegate, NSURLConnectionDataDelegate, there will be something like: <br><pre> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UIViewController</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UITableViewDataSource</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UITableViewDelegate</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">NSURLConnectionDelegate</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">NSURLConnectionDataDelegate {</span></span></span></span></code> </pre><br><br><h4>  Getting an answer </h4><br>  We have to add the largest part of the code of our application for processing the received information. <br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(didReceiveResponse: NSURLConnection!, didReceiveResponse response: NSURLResponse!)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.data = <span class="hljs-type"><span class="hljs-type">NSMutableData</span></span>() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(connection: NSURLConnection!, didReceiveData data: NSData!)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.data.appendData(data) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connectionDidFinishLoading</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(connection: NSURLConnection!)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> err: <span class="hljs-type"><span class="hljs-type">NSError</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jsonResult: <span class="hljs-type"><span class="hljs-type">NSDictionary</span></span> = <span class="hljs-type"><span class="hljs-type">NSJSONSerialization</span></span>.<span class="hljs-type"><span class="hljs-type">JSONObjectWithData</span></span>(data, options: <span class="hljs-type"><span class="hljs-type">NSJSONReadingOptions</span></span>.<span class="hljs-type"><span class="hljs-type">MutableContainers</span></span>, error: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-type"><span class="hljs-type">NSDictionary</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> jsonResult.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; jsonResult[<span class="hljs-string"><span class="hljs-string">"results"</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> results: <span class="hljs-type"><span class="hljs-type">NSArray</span></span> = jsonResult[<span class="hljs-string"><span class="hljs-string">"results"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-type"><span class="hljs-type">NSArray</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.tableData = results <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.appsTableView.reloadData() } }</code> </pre><br>  When the NSURLConnection receives a response, the didReceiveResponse method is called. <br>  Here we simply reset our data, if they were, by setting self.data = NSMutableData () to create a new object. <br>  After the connection is established, we begin to receive data in the didReceiveData method.  Here, the data: NSData argument is passed, where all the information we are interested in is located.  We need to keep all the parts received in the response, so we attach them to the self.data object created above. <br>  Finally, after we receive all the information in the response, the connectionDidFinishLoading method is called, where we can already start using the result. <br>  We will use the NSJSONSerialization class to convert raw data into useful information in the form of NSDictionary dictionary objects. <br>  Now that we‚Äôve made sure that we‚Äôve received a response from iTunes, a simple verification of the ‚Äúresults‚Äù key will be enough to make sure that we got exactly what we expected, so we can set the self.tableData object to be equal to the results, and also call the method The appsTableView.reloadData () table to update its contents. <br><br><h4>  Update Table View UI </h4><br>  To initialize the Table View in the first article, we needed to define two functions: one returns the number of rows in the table, the second created the cells and described their contents. <br>  Let's update these functions, according to new functionality. <br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tableView: UITableView!, numberOfRowsInSection section: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tableData.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tableView: UITableView!, cellForRowAtIndexPath indexPath: NSIndexPath!)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UITableViewCell!</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell: <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span> = <span class="hljs-type"><span class="hljs-type">UITableViewCell</span></span>(style: <span class="hljs-type"><span class="hljs-type">UITableViewCellStyle</span></span>.<span class="hljs-type"><span class="hljs-type">Subtitle</span></span>, reuseIdentifier: <span class="hljs-string"><span class="hljs-string">"MyTestCell"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rowData: <span class="hljs-type"><span class="hljs-type">NSDictionary</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.tableData[indexPath.row] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-type"><span class="hljs-type">NSDictionary</span></span> cell.text = rowData[<span class="hljs-string"><span class="hljs-string">"trackName"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-comment"><span class="hljs-comment">//    artworkUrl60       var urlString: NSString = rowData["artworkUrl60"] as NSString var imgURL: NSURL = NSURL(string: urlString) //      NSData      var imgData: NSData = NSData(contentsOfURL: imgURL) cell.image = UIImage(data: imgData) //      formattedPrice      subtitle var formattedPrice: NSString = rowData["formattedPrice"] as NSString cell.detailTextLabel.text = formattedPrice return cell }</span></span></code> </pre><br>  The numberOfRowsInSection function now simply returns the number of objects received in the response. <br>  The cellForRowAtIndexPath function instead of displaying the line number now displays the name of the object, its cover and cost. <br><img src="https://habrastorage.org/getpro/habr/post_images/e79/a1e/8ff/e79a1e8ffb5eb595c3c0c55c0f6d0fd8.jpg"><br>  If everything is good and you managed to launch the application, you may notice some ‚Äúlags‚Äù during its operation.  This is due to the fact that we have not foreseen several things that we will pay attention to in the next article. <br><br>  PS: After the release of my translation, the author has updated the lesson a little by optimizing the code a little.  I tried to bring the translation into conformity. </div><p>Source: <a href="https://habr.com/ru/post/225577/">https://habr.com/ru/post/225577/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225561/index.html">How to create and earn on SaaS / SaaS - the realities of the Russian market</a></li>
<li><a href="../225567/index.html">Useful materials for mobile developer # 56 (June 2-8)</a></li>
<li><a href="../225569/index.html">Study: NASA cannot afford a trip to Mars yet, but deserves funding for this program.</a></li>
<li><a href="../225571/index.html">Online hackathon: Social network in 48 hours</a></li>
<li><a href="../225575/index.html">"Who am I?" - reading thoughts and no fraud (see source)</a></li>
<li><a href="../225581/index.html">Free SSL Certificates for Open Source Projects</a></li>
<li><a href="../225583/index.html">An experiment that forever changed our view of reality</a></li>
<li><a href="../225585/index.html">Exceptions in Java, Part II (checked / unchecked)</a></li>
<li><a href="../225587/index.html">DCaaS - new service model</a></li>
<li><a href="../225589/index.html">Digest of articles on data analysis No. 2 (05/26/2014 - 06/08/2014)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>