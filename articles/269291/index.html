<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Job Search Guide for MDA Specialist (and a little about hierarchy analysis method, Xcore and Sirius)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the 4th article of the model-driven development cycle. In previous articles, we introduced OCL and metamodels , the Eclipse Modeling Framework...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Job Search Guide for MDA Specialist (and a little about hierarchy analysis method, Xcore and Sirius)</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/321/001/8cc/3210018cc53b402ea9f569ce2f69ffcf.jpg"><br><br>  This is the 4th article of the model-driven development cycle.  In previous articles, we introduced <a href="http://habrahabr.ru/company/cit/blog/264963/">OCL and metamodels</a> , the <a href="http://habrahabr.ru/company/cit/blog/266433/">Eclipse Modeling Framework,</a> and <a href="http://habrahabr.ru/company/cit/blog/267335/">Sirius</a> .  Today we will learn to describe metamodels in textual notation (and not in the form of diagrams as before) and get acquainted with the tabular presentation of models in Sirius.  We do this on the example of the middle age crisis and the hierarchy analysis method.  Perhaps this will be useful to you when developing AI in games, when making decisions or at work. <br><a name="habracut"></a><br><h4>  <font color="#902213"><b>Introduction</b></font> </h4><br>  Actually, I was planning an article on DSL development and model conversion.  But my plans suddenly disturbed my thoughts about the meaning of life, about whether I was doing that at all. <br><br>  The most obvious thing a model-driven development specialist can do is 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Choose a method that will provide answers of interest (section 1) </li><li>  Create a metamodel for this method (section 2) </li><li>  Create a model development tool in accordance with the metamodel (section 3) </li><li>  Create model (section 4) </li><li>  ... </li><li>  Profit </li></ul><br>  That is what we are going to do. <br><br><blockquote>  <b>Note</b> <br><br>  If you are interested in the method of analyzing hierarchies, but you do not want to understand metamodels, etc., then an <a href="https://github.com/AresEkb/ahp/blob/master/ahp.xlsx%3Fraw%3Dtrue">Excel calculator of priorities is available</a> . </blockquote><br><img src="https://habrastorage.org/files/2dd/05b/8de/2dd05b8de7cd4dd493c4b86656f92197.jpg"><br><br><h4>  <font color="#902213"><b>1 Hierarchy Analysis Method</b></font> </h4><br>  I was interested in the following questions: <br><br><ul><li>  What am I interested in doing? </li><li>  Do I have enough time for interesting things? </li><li>  What can be changed in life for the better? </li><li>  Wouldn't this change get worse? </li><li>  ... </li></ul><br>  When I studied at the university, we used <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25B0%25D0%25BD%25D0%25B0%25D0%25BB%25D0%25B8%25D0%25B7%25D0%25B0_%25D0%25B8%25D0%25B5%25D1%2580%25D0%25B0%25D1%2580%25D1%2585%25D0%25B8%25D0%25B9">the hierarchy analysis method</a> to get answers to various questions.  The essence of the method is as follows. <br><br><ol><li>  You define <br><ul><li>  target, </li><li>  criteria for achieving the goal and </li><li>  possible alternatives. </li></ul></li><li>  Evaluate the significance of the criteria. </li><li>  Evaluate alternatives for each of the criteria. </li><li>  Calculate the priorities of alternatives. </li><li>  Make a decision. </li></ol><br>  This method is described in more detail in Thomas Saaty‚Äôs book Decision Making.  The method of analyzing hierarchies "(it is easily googled).  By the way, there are many examples from psychology to the global economy. <br><br><h5>  <font color="#902213">1.1 Construction hierarchy</font> </h5><br>  So, in the simplest case, the hierarchy should contain a goal, criteria and alternatives. <br><br>  To sum up all my questions, then, by and large, I‚Äôm wondering if I should change jobs.  Therefore, the goal: <b>to choose a job</b> . <br><br>  When choosing a job I'm interested in <br><br><ul><li>  how much <b>money</b> I will earn </li><li>  how <b>interesting</b> it will be for me to do this </li><li>  will i have <b>time</b> to live </li><li>  <b>career</b> prospects </li><li>  will I be able to go to <b>nature</b> or will I see the sun and trees once a year, </li><li>  how close to me is the <b>culture of</b> colleagues, neighbors and other people. </li></ul><br>  The following alternatives are possible: <br><br><ul><li>  change nothing </li><li>  move to Moscow </li><li>  move abroad, </li><li>  do freelancing or some kind of business. </li></ul><br>  In accordance with the method of analyzing hierarchies, the following hierarchy is constructed: <br><br><img src="https://habrastorage.org/files/9ba/7a9/608/9ba7a960899442ec8da71a33523868cd.png"><br><br><h5>  <font color="#902213">1.2 Evaluation of criteria</font> </h5><br>  Different people may have approximately the same criteria when making decisions.  However, their significance can vary greatly.  Someone works more for the money, someone for the sake of interest, someone just likes to communicate with colleagues, etc. <br><br>  In accordance with their priorities, one person will not hesitate to choose a more monetary job, and another - more interesting.  There is no job that is absolutely suitable for all criteria. <br><br>  Probably, when making decisions, most people explicitly or implicitly rank the criteria from the most significant to the most insignificant.  The latter are discarded, and the first alternatives are compared.  They put a label on every possible job: here, this work is more monetary, but not interesting, but this interesting and good team there, but dubious career prospects, etc. <br><br>  If it is not possible at once to make a choice, then the person begins to overestimate the criteria: there may still be an interest not so important and you can stand for two hours in a traffic jam, but there is more salary, so I will pay the mortgage and I will do something interesting. <br><br>  Such reasoning can go on for a long time, painfully and without guarantee that in the end the optimal decision will really be made. <br><br>  The hierarchy analysis method proposes a formal algorithm for making such decisions: all criteria are compared in pairs with each other on a scale from 1 to 9. <br><br>  For example, what is more important for me: interest or money?  Interest is more important, but not to say that very much.  If the maximum score is 9 to 1, then for myself I rate the priorities as 5 to 1. <br><br>  Or, for example, what is more important: money or time for life, a hobby?  Am I ready for extra money to work on weekends or stand for two hours in traffic jams?  I for myself rate the significance of these criteria as 1 to 7. <br><br>  As a result, a similar table is filled: <br><br><img src="https://habrastorage.org/files/7b4/481/994/7b44819941614a8c80da941359fe68d3.png"><br><br>  Obviously, diagonally there will always be units.  It is also obvious that all estimates will be inversely symmetric with respect to the main diagonal.  For example, if I estimate the importance of ‚Äúinterest-money‚Äù as 5 to 1, then the significance of ‚Äúmoney-interest‚Äù will be 1 to 5. Sometimes such matrices are called back-symmetric. <br><br>  In general, if we compare N criteria, then we need to make (N * (N-1)) / 2 comparisons.  It would seem that everything is only complicated.  If initially there were 6 criteria, now there is a whole matrix of some numbers.  To return to the criteria again, calculate the eigenvector of the matrix.  The elements of this vector will be the relative importance of each criterion. <br><br>  The book by Thomas Saaty suggests several simplified methods for calculating the eigenvector in the mind or on paper.  We will use a more accurate <a href="">iterative algorithm</a> : <br><br><pre><code class="hljs 1c">N =   m =    NxN eigenvector =   N,   <span class="hljs-number"><span class="hljs-number">1</span></span>/N  <span class="hljs-keyword"><span class="hljs-keyword"></span></span> eigenvalue <span class="hljs-keyword"><span class="hljs-keyword"></span></span>      <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span>      x = m * eigenvector eigenvalue = sum(x) eigenvector = x / eigenvalue</code> </pre> <br>  As a result, we obtain the following vector: <br><pre> <code class="hljs json">[ <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0592</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">2323</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3846</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0555</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1220</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1462</span></span> ]</code> </pre><br>  The most significant criterion is time (0.3846), the least significant is the career (0.0555). <br><br>  With pairwise comparisons, some estimates may turn out to be inconsistent.  For example, for me, interest is more important than money, and money is more important than a career.  Obviously, interest must be significantly more important than a career.  In this table it is.  But if the assessment for the ‚Äúinterest-career‚Äù was less or not the opposite, then my estimates would not be consistent with each other. <br><br>  Evaluate the measure of this inconsistency will help the eigenvalue of the matrix of comparisons.  It is equal to 6.7048. <br><br>  Obviously, the eigenvalue is proportional to the number of criteria.  So that the assessment of consistency does not depend on the number of criteria, the so-called consistency index is calculated = (eigenvalue - N) / (N - 1). <br><br>  Finally, in order for the assessment to be completely objective, it is necessary to divide this index by the average index of consistency for random matrices.  If the value obtained (the ratio of consistency) is less than 0.1000, then the pairwise comparisons can be considered more or less consistent.  In our example, it is 0.1137, which means that the calculated priorities can be more or less trusted. <br><br><h5>  <font color="#902213">1.3 Evaluating Alternatives</font> </h5><br>  Now you need to compare all the alternatives for each of the criteria. <br><br><img src="https://habrastorage.org/files/55c/809/2e2/55c8092e2181416ebc2fd3a84cab6b6c.png"><br><br>  For example, when I move to Moscow, I will significantly win in salary.  But work, most likely, will be less interesting, and also there will be less time for life.  Or when moving abroad, I will have to give up my language, adjust to other people's cultural values. <br><br>  For each criterion, an eigenvector and a consistency relation are calculated. <br><br>  The resulting eigenvectors are written in columns: <br><br><img src="https://habrastorage.org/files/455/cb3/78c/455cb378c7964ee8bb434fb6e6ff1e67.png"><br><br>  The consistency relationship for each criterion is recorded in the following vector: <br><pre> <code class="hljs json">[ <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0337</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0211</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1012</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1399</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1270</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">9507</span></span> ]</code> </pre><br>  Most values ‚Äã‚Äãare less or slightly higher than 0.1000.  However, for the ‚Äúculture‚Äù criterion, the consistency ratio was very large.  This is due to the fact that I incorrectly set part of the ratings.  I wanted to put 7 for ‚Äúnot to change anything - to move abroad‚Äù, because living in my hometown is much more comfortable.  But mistakenly set 1/7. <br><br><h5>  <font color="#902213">1.4 Prioritization of Alternatives</font> </h5><br>  So, we evaluated the criteria, put a label on each alternative: which option is more monetary, which is more interesting, etc.  Now you need to evaluate alternatives for all criteria in the amount.  To do this, simply multiply the matrix <br><br><img src="https://habrastorage.org/files/455/cb3/78c/455cb378c7964ee8bb434fb6e6ff1e67.png"><br><br>  by vector <br><pre> <code class="hljs json">[ <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0592</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">2323</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3846</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0555</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1220</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1462</span></span> ]</code> </pre><br>  As a result, we get the following vector: <br><pre> <code class="hljs json">[ <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3184</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1227</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">2049</span></span>; <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3540</span></span> ]</code> </pre><br>  This is the relevance of alternatives to achieving the goal. <br><br><h5>  <font color="#902213">1.5 Decision Making</font> </h5><br>  Now we draw all the calculated values ‚Äã‚Äãin the following image: <br><br><img src="https://habrastorage.org/files/eca/eb2/813/ecaeb2813e3443b29f3e60a8c08c2ee8.png"><br><br>  The brackets indicate the consistency of ratings. <br><br>  The thickness of the lines is proportional to the priorities.  The most interesting and promising career in terms of current work.  Freelance would allow more to be in nature and more time to spend on life.  More monetary work in Moscow and abroad. <br><br>  It is evident that Moscow completely disappears.  A little better abroad, but also not very much.  Change nothing and freelancing about the same level. <br><br><h4>  <font color="#902213"><b>2 Creating a metamodel</b></font> </h4><br>  Now we will describe how all this is drawn and considered. <br><br>  First, it is necessary to describe the metamodel: entity types that are used in the hierarchy analysis method.  Moreover, unlike the <a href="http://habrahabr.ru/company/cit/blog/266433/">previous article,</a> we will not draw the metamodel in the form of a diagram, but describe it in Xcore textual notation. <br><br>  As before, you will need <a href="https://www.eclipse.org/downloads/">Eclipse Modeling Tools</a> .  Install Xcore and Sirius. <br><br>  You can either take the finished <a href="https://github.com/AresEkb/ahp">project</a> or do it yourself.  If on your own, create an Xcore project.  In the model folder, create the file ahp.xcore with the following contents: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Ecore</span></span>(nsURI=<span class="hljs-string"><span class="hljs-string">"http://www.example.org/ahp"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@GenModel</span></span>( modelName=<span class="hljs-string"><span class="hljs-string">"AHP"</span></span>, prefix=<span class="hljs-string"><span class="hljs-string">"AHP"</span></span>, editDirectory=<span class="hljs-string"><span class="hljs-string">"/xctest.edit/src-gen"</span></span>, editorDirectory=<span class="hljs-string"><span class="hljs-string">"/xctest.editor/src-gen"</span></span>, testsDirectory=<span class="hljs-string"><span class="hljs-string">"/xctest.tests/src-gen"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ahp <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hierarchy</span></span></span><span class="hljs-class"> </span></span>{ contains Goal[<span class="hljs-number"><span class="hljs-number">1</span></span>] goal contains Criterion[+] criteria contains Alternative[<span class="hljs-number"><span class="hljs-number">2</span></span>..*] alternatives } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Named</span></span></span><span class="hljs-class"> </span></span>{ String[<span class="hljs-number"><span class="hljs-number">1</span></span>] name } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Goal</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Named</span></span></span><span class="hljs-class"> </span></span>{ } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Criterion</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Named</span></span></span><span class="hljs-class"> </span></span>{ } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Alternative</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Named</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre><br>  The meaning should be intuitive.  We have described a hierarchy that contains one goal, at least one criterion, two or more alternatives.  All three entities have a name. <br><br>  After saving the file, the Java API for working with hierarchies in the src-gen folder is automatically generated.  And also 3 additional projects will be created.  We already did something similar in the <a href="http://habrahabr.ru/company/cit/blog/266433/">EMF article</a> .  Only there were two models (ecore and genmodel), and we ran the code generation manually.  Xcore does this automatically. <br><br>  I think that there‚Äôs no point in describing the entire metamodel in the article, you can look at it <a href="https://github.com/AresEkb/ahp/blob/master/ahp/model/ahp.xcore">yourself</a> . <br><br>  Let's stop only on the most interesting things.  Xcore, unlike Ecore, allows describing not only the structure of the model, but also some logic in a Java-like language.  We describe, for example, the type of data for storing ratings.  Positive ratings will be stored as positive integers.  And inverse estimates of the 1 / n type will be stored as -n.  We could store the estimates as strings or as real numbers, but this is probably a bad idea. <br><br>  At the same time, we need two functions to convert the estimates from or to the string representation.  On Xcore, it will look like this: <br><br><pre> <code class="java hljs">type Weight wraps <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> create { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (it.matches(<span class="hljs-string"><span class="hljs-string">"\\d+"</span></span>)) { Integer.parseInt(it) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (it.matches(<span class="hljs-string"><span class="hljs-string">"1\\s*/\\s*\\d+"</span></span>)) { val result = Integer.parseInt(it.replaceFirst(<span class="hljs-string"><span class="hljs-string">"1\\s*/\\s*"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -result } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NumberFormatException(<span class="hljs-string"><span class="hljs-string">"The weight must be either n or 1/n"</span></span>) } } convert { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (it &gt;= <span class="hljs-number"><span class="hljs-number">1</span></span>) { it.toString } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (it &gt;= -<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-string"><span class="hljs-string">"1"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-string"><span class="hljs-string">"1/"</span></span> + (-it).toString } }</code> </pre><br>  Xcore also makes it possible to describe relatively complex logic. <br><div class="spoiler">  <b class="spoiler_title">Here, for example, the operation of calculating priorities in the hierarchy.</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hierarchy</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">op </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updatePriorities</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ priorities.clear inconsistencies.clear val mat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JudgmentMatrix&lt;Criterion&gt;(criteria) val criteriaJudgments = judgments.filter(typeof(CriterionJudgment)).filter(cj | cj.goal == goal) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (judgment : criteriaJudgments) { mat.set(judgment.first, judgment.second, judgment.weight) } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (criterion : criteria) { val GoalCriterionPriority priority = AHPFactory.eINSTANCE.createGoalCriterionPriority priority.goal = goal priority.criterion = criterion priority.value = mat.findEigenvectorElement(criterion) priorities.add(priority) } val goalInconsistency = AHPFactory.eINSTANCE.createGoalInconsistency goalInconsistency.goal = goal goalInconsistency.value = mat.inconsistency inconsistencies.add(goalInconsistency) val mat2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Matrix(alternatives.size, criteria.size) criteria.forEach[criterion, j| val mat3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JudgmentMatrix&lt;Alternative&gt;(alternatives) val alternativeJudgments = judgments.filter(typeof(AlternativeJudgment)).filter(aj | aj.criterion == criterion) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (judgment : alternativeJudgments) { mat3.set(judgment.first, judgment.second, judgment.weight) } val criterionInconsistency = AHPFactory.eINSTANCE.createCriterionInconsistency criterionInconsistency.criterion = criterion criterionInconsistency.value = mat3.inconsistency inconsistencies.add(criterionInconsistency) alternatives.forEach[alternative, i| val CriterionAlternativePriority priority = AHPFactory.eINSTANCE.createCriterionAlternativePriority priority.criterion = criterion priority.alternative = alternative priority.value = mat3.findEigenvectorElement(alternative) priorities.add(priority) mat2.set(i, j, priority.value) ] ] val mat4 = mat2.multiply(mat.eigenvector) alternatives.forEach[alternative, i| val GoalAlternativePriority priority = AHPFactory.eINSTANCE.createGoalAlternativePriority priority.goal = goal priority.alternative = alternative priority.value = mat4.get(i) priorities.add(priority) ] } }</code> </pre><br></div></div><br>  Finally, for the Xcore model (as for the Ecore model) you can create a class diagram. <br><br><img src="https://habrastorage.org/files/184/a82/e82/184a82e82fc546faa3dc12269bc8a995.png"><br><br>  This is the meta model for the hierarchy analysis method.  This is the most simplified version.  In general, a hierarchy may contain more than three levels (for example, criteria may have subcriteria).  Matrix connections between levels can be sparse.  Ratings can put several experts, not one. <br><br><h4>  <font color="#902213"><b>3 Development of a tool for working with models</b></font> </h4><br>  Metamodel is ready, now you need an editor of hierarchies and matrices.  Probably, it makes no sense to describe in detail how all this is done.  If you're interested, you can read the <a href="http://habrahabr.ru/company/cit/blog/267335/">previous article about Sirius</a> and see the finished <a href="https://github.com/AresEkb/ahp">project</a> . <br><br>  This is the specification of the editor of charts and tables: <br><br><img src="https://habrastorage.org/files/47f/d5c/fea/47fd5cfea0cd40318dadd7a993982535.png"><br><br>  This is what the resulting editor looks like: <br><br><img src="https://habrastorage.org/files/343/b0e/bb0/343b0ebb0baf4d69afba610a58833187.png"><br><br>  It was not possible to completely declare the hierarchy editor, I had to write extensions in Java.  I think it is worthwhile to dwell on this in more detail.  In Sirius there are at least two options for extensions: services (service) and actions (action). <br><br>  Using services you can add some additional operations to the classes from the metamodel.  For example, the following two operations format the priority accordingly and calculate the thickness of the connections between criteria and alternatives. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Priority priority)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> String.format(<span class="hljs-string"><span class="hljs-string">"%.4f"</span></span>, priority.getValue()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getEdgeWidth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Alternative alternative, EdgeTarget targetView)</span></span></span><span class="hljs-function"> </span></span>{ DSemanticDecorator targetNode = (DSemanticDecorator)targetView; Criterion criterion = (Criterion)targetNode.getTarget(); Priority priority = alternative.getPriority(criterion); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (priority.getValue() * <span class="hljs-number"><span class="hljs-number">7</span></span>); } }</code> </pre><br>  Conveniently, you can use these operations directly in AQL expressions.  However, you cannot change the model with their help. <br><br>  To change the model you need to use Java actions.  Actions, unlike services, can no longer be called in AQL expressions.  They can be launched, for example, through the context menu or by pressing a button.  Actions can be rolled back using the Undo command. <br><br><div class="spoiler">  <b class="spoiler_title">An example of an action that recalculates priorities in a hierarchy.</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ahp.design; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Collection; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Iterator; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.emf.ecore.EObject; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.emf.transaction.RecordingCommand; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.emf.transaction.TransactionalEditingDomain; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.sirius.business.api.action.AbstractExternalJavaAction; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.sirius.business.api.session.Session; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.sirius.business.api.session.SessionManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.sirius.diagram.DSemanticDiagram; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ahp.Hierarchy; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UpdatePrioritiesAction</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractExternalJavaAction</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdatePrioritiesAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">canExecute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Collection&lt;? extends EObject&gt; arg0)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Collection&lt;? extends EObject&gt; selections, Map&lt;String, Object&gt; parameters)</span></span></span><span class="hljs-function"> </span></span>{ Iterator&lt;? extends EObject&gt; iter = selections.iterator(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!iter.hasNext()) { System.out.println(<span class="hljs-string"><span class="hljs-string">"Selections is empty"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } EObject obj = selections.iterator().next(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(obj <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> DSemanticDiagram)) { System.out.println(<span class="hljs-string"><span class="hljs-string">"DSemanticDiagram is expected"</span></span>); } DSemanticDiagram diagram = (DSemanticDiagram)obj; EObject target = diagram.getTarget(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(target <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> Hierarchy)) { System.out.println(<span class="hljs-string"><span class="hljs-string">"Hierarchy is expected"</span></span>); } Hierarchy hierarchy = (Hierarchy)target; Session session = SessionManager.INSTANCE.getSession(target); TransactionalEditingDomain ted = session.getTransactionalEditingDomain(); RecordingCommand cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RecordingCommand(ted) { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doExecute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ hierarchy.updatePriorities(); } }; ted.getCommandStack().execute(cmd); } }</code> </pre><br></div></div><br><h4>  <font color="#902213"><b>4 Creating a model</b></font> </h4><br>  Well, actually, I have already created my model and showed it above.  Try to take this <a href="https://github.com/AresEkb/ahp">project</a> and build your hierarchy. <br><br><h4>  <font color="#902213"><b>Profit</b></font> </h4><br>  After reading this article, you should <br><br><ul><li>  get a general idea of ‚Äã‚Äãthe hierarchy analysis method, </li><li>  learn to describe metamodels in Xcore, </li><li>  learn how to create pivot tables using Sirius, </li><li>  Learn how to write extensions for Sirius in Java. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/269291/">https://habr.com/ru/post/269291/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269275/index.html">Creating a MySQL database within Microsoft Azure for students</a></li>
<li><a href="../269281/index.html">Oracle, typical SQL tasks. Guaranteed choice</a></li>
<li><a href="../269285/index.html">3 ways to use the operator? .. wrong in C # 6</a></li>
<li><a href="../269287/index.html">Multiklet became more accessible</a></li>
<li><a href="../269289/index.html">How can you make a fault-tolerant storage system of data from domestic servers</a></li>
<li><a href="../269293/index.html">Implementation of monitoring and integration testing information system using Scalatest. Part 1</a></li>
<li><a href="../269295/index.html">PCEPTPDPTE</a></li>
<li><a href="../269297/index.html">Gaming Digest: September</a></li>
<li><a href="../269299/index.html">Studying net / context in Go</a></li>
<li><a href="../269301/index.html">Pitfalls in the clouds, or failed test online editors on the docx file</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>