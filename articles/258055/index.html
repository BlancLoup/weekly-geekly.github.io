<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The study of someone else's cheat for FarCry 4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago I purchased the game FarCry 4 and I really liked it right away. Over time, I wanted to dig deeper into the guts of this game and write...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The study of someone else's cheat for FarCry 4</h1><div class="post__text post__text-html js-mediator-article">  Not so long ago I purchased the game FarCry 4 and I really liked it right away.  Over time, I wanted to dig deeper into the guts of this game and write a cheat for it. <br><br>  Having a little picked in the game with the help of a debugger, I was able to easily learn how to do the following functions: infinite ammo, shooting without reloading, teleportation of the player, rate of fire, remove returns.  I also learned how to increase the height of a player‚Äôs jump.  But when I began to look for how to make a player immortal (it seemed to me that there would be nothing difficult in this), difficulties arose. <br><a name="habracut"></a><br>  To begin with, with the help of Cheat Engine, I found the address of the character's health and put a record on the record.  Found instructions that change health.  Naturally, as in most games, this instruction is responsible for changing the health of all the characters in the game, whether they are enemies, or their own, or even transport (cars, airplanes).  It‚Äôs not the first time for me to solve such problems, and I know what needs to be found, how the player differs, say, from a car or from an enemy, to inject a code and add a check before the changing instruction.  As a result, this instruction will be executed for all objects - except the player. <br><br>  But in search of this difference, I spent a few days - and all in vain.  I could not find any clues on how to distinguish anything in the game from the player.  However, I didn‚Äôt despair and decided to go in an entirely honest way - just ‚Äúlook‚Äù like other cheats, which have a function of immortality. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I started searching for cheats for FarCry 4 on the Internet and found a cheat for the latest version of the game 1.9.  Downloaded, antivirus sounded the alarm.  The next cheat that I downloaded did not work, but he didn‚Äôt get angry with the antivirus.  The 3rd downloaded cheat seems to be virus-free and working. <br><br>  First of all, I decided to check the executable file of the cheat using PEiD. <br><br><img src="https://habrastorage.org/files/12a/c1a/f01/12ac1af01e424617b851ab869668b6f7.jpg"><br><br>  As you might guess, the inscription ‚ÄúNot a valid PE file‚Äù does not bode well.  This means that the packers, protectors, and other vermin scoffed at him.  But not everything is so bad, because we don‚Äôt want to modify this file, it is completely free and so free and is distributed freely.  All we need to know is where this cheat comes from, what it reads and where it writes it. <br><br>  To write data to someone else's process, there is the WinApi function WriteProcessMemory, and for reading ReadProcessMemory.  Now we will check if the great and powerful protection of this cheat will stand in front of the API monitor.  Before OllyDBG she resisted;  after I tried to open it in this debugger, he wrote that he didn‚Äôt want to work with invalid files. <br><br>  We start the game and, under the control of the monitor API, we launch a cheat.  The API monitor for this file, as it turned out, has no complaints.  Now let's check if it intercepts the calls of the two functions we need.  To do this, activate immortality in the reader and look at the result. <br><br><img src="https://habrastorage.org/files/c25/18e/5c9/c2518e5c99d144848f6ef5d2ad13a0e1.jpg"><br><br>  First, the cheat read one byte from the memory of the game, and then 3 more times made a record.  On the first call, he wrote 5 bytes, on the second, 21 bytes, and on the third call, 5 bytes again.  If you think a little, you can guess what's what.  First, the original instruction is replaced with an unconditional jump, then the 21-byte code is written to the address where the jump will take place, and finally the unconditional jump to the next instruction, which is located behind the original instruction (which changes health), is added to the end of this code. <br><br>  However, in fact, I guessed only with the second and third calls, when I first called at FC64.FCE_Engine_GetCloudTypeCount + 21F923, the following instruction is recorded: <br><blockquote>  comiss xmm9, [rbx + 0C] </blockquote>  . <br>  Below is the image of the main code, which is written in the second call to the WriteProcessMemor function. <br><br><img src="https://habrastorage.org/files/5e6/42a/faf/5e642afafd0c42f9a8c64d9509c9ec24.jpg"><br><br>  In detail, I did not understand how this cheat makes the player immortal.  I decided to just copy this algorithm and add it to my cheat. <br><br>  I also want to add my personal opinion about the trainer type cheats.  I believe that it is almost impossible to protect such cheats from hacking, since their weakness is known, which is that in any case they should call WinApi functions WriteProcessMemory and ReadProcessMemory and no matter how data is encrypted there, they come to these functions in pure the form.  I also want to say that if you are going to write serious cheats with unique functionality, then it is better to implement it as a DLL, which when you start the game, inject it into the process - it will not be so easy to find the address. <br><br>  If the trainer is compiled under .NET, then the API monitor will refuse to work with it.  In this case, you can set a breakpoint on the WriteProcessMemory and ReadProcessMemory functions in the debugger, and when it works, look at the contents of the stack and extract the address from which the data will be written from there. <br><br>  What I wrote above is my personal opinion, and someone may agree with this, but someone does not.  I hope you enjoyed this article. <br><br>  I do not advise you to "copy-paste" the functionality of other cheats, since you are not gaining experience.  Also, creating cheats in this way will not be fun. </div><p>Source: <a href="https://habr.com/ru/post/258055/">https://habr.com/ru/post/258055/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258043/index.html">HP Software Webinars</a></li>
<li><a href="../258045/index.html">Lectures of the Technosphere. Semester 2 Methods for distributed processing of large amounts of data in Hadoop</a></li>
<li><a href="../258047/index.html">io.js integrates with NodeJS</a></li>
<li><a href="../258051/index.html">Designing and embedding .vsix extensions in Visual Studio on C # for dummies</a></li>
<li><a href="../258053/index.html">Sublime Text 3 - custom syntax highlighting</a></li>
<li><a href="../258057/index.html">Event model building projects and solutions of Visual Studio for developers</a></li>
<li><a href="../258059/index.html">VMware Virtual SAN (VSAN): why do you need it and how to prepare it</a></li>
<li><a href="../258061/index.html">Some interesting and useful things for web developer # 43</a></li>
<li><a href="../258063/index.html">Windows 10 on Raspberry Pi 2, first impressions</a></li>
<li><a href="../258065/index.html">As I passed the first hack quest CTF Ratazana</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>