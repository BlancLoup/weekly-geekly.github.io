<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Apache Lenya - an unusual opensource CMS in Java</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the comments to the topic of Spring in action - we are trying to open the CMS in Java, I mentioned Apache Lenya, one of the opensource CMS in Java,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Apache Lenya - an unusual opensource CMS in Java</h1><div class="post__text post__text-html js-mediator-article">  In the comments to the topic of <a href="http://habrahabr.ru/blogs/java2ee/100984/">Spring in action - we are trying to open the CMS in Java,</a> I mentioned Apache Lenya, one of the opensource CMS in Java, and I was asked to write more about it. <br><img src="https://habrastorage.org/getpro/habr/post_images/a44/556/39a/a4455639ac4a10a584e26f2e576bfe46.png" alt="Apache Lenya Logo"><br><br><h4>  Why Apache Lenya </h4><br>  ‚ÄúWhy is CMS in Java?‚Äù - the first question I had when I received requests from the customer.  The answer turned out to be simple: the customer, a large corporation, had experience in developing projects in Java, so he trusted her the most.  ‚ÄúJava EE‚Äù sounds more serious and reliable for a businessman‚Äôs ear than, say, PHP.  How things are with reliability and seriousness is not really important, but still it should be borne in mind that large corporations trust the products of other large corporations. <br><a name="habracut"></a><br>  So, we in the company began to search for CMS Java.  It turned out that there are not so few of them, both paid and freely distributed.  More details can be found <a href="http://en.wikipedia.org/wiki/List_of_content_management_systems">here on Wikipedia.</a> <br>  After analyzing the licenses, and we needed to seriously ‚Äúfinish‚Äù the CMS for the needs of the customer, the choice was made by several candidates: Nuxeo EP, Daisy, Hippo CMS, Alfresco and Apache Lenya itself.  All have been tested.  After analyzing the source code and assessing the complexity of the revision, we decided to stop at Apache Lenya.  This CMS provided the most extensive source code modification options that were easily accessible.  Benefit Apache License allowed to change the code and then use the product for commercial purposes.  The problems that arose at the beginning were solved with the help of a small but rather active community. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/186/d01/a13/186d01a13efbbcf5d377c23d23618e57.png" alt="Main manu bar"><br><h4>  Apache Lenya features </h4><br>  Apache Lenya provides standard CMS features (I only have Joomla experience, so most of the comparisons with it): <br><ul><li>  WYSIWYG content editor.  Even 2: Kupu and BXE.  Easily added to the more familiar FCKEditor. </li><li>  Form editor for cases when a regular WYSIWYG editor fails </li><li>  Block editable pages to prevent situations where the same page is edited by several users </li><li>  Internationalization </li><li>  Setting a schedule for publishing content </li><li>  Moving, copying, archiving, deleting both individual pages and individual parts of the site </li><li>  XHTML + CSS to separate the content and appearance </li><li>  The ability to transfer pages to the archive </li><li>  Differentiation of access rights of users and user groups to different pages or parts of the site </li><li>  Integrated site search (Apache Lucene) </li></ul><br>  <b>And also not the most common:</b> <br><ul><li>  Version control.  Any edited page can be rolled back a few revisions. </li><li>  Editable page life cycle.  One-and two-stage cycle "Drafts-Published" included in the delivery </li><li>  Division of a site into sections: Development, Published and Auxiliary (Staging) </li><li>  All transactions are recorded in the transaction log. </li><li>  Configuration data is stored in files.  If desired, you can replace the classes that provide data reading / writing to classes that work with the database. </li><li>  LDAP User Identification </li></ul><br>  <b>Features:</b> <br><ul><li>  The concept of "Publications" </li></ul><br>  This concept allows you to reuse the already created site structure (or structure and data of one publication) for a new publication.  Different publications may use the general structure of the site, but contain different information.  For example, there is a default publication, default, which already contains XSLT templates, user data, user groups, and other service information.  Production publication is inherited from default.  Then the publication of production has the same appearance (thanks to the general XSLT), access to all users and groups.  However, it can override some user rights, page rendering, or even the whole thing.  In general, a fairly convenient option if you need to maintain several similar sites. <br><ul><li>  Going with Apache Ant </li><li>  Apache cocoon </li></ul><br>  About this web framework it is worth talking separately a little more detail.  He is the heart of Apache Lenya. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Apache cocoon </h4><br>  Apache Cocoon ( <a href="http://cocoon.apache.org/">official site</a> ) - a framework for web development.  It has common features with the Spring Framework, when it was still version 2 or even younger.  Among other things, it is worth noting, in my opinion, two main features of Cocoon: the presence of an IoC container and the concept of ‚Äúchannels‚Äù (pipelines).  It has many other remarkable features, but I needed these two when finalizing Apache Lenya.  What is Inversion of Control, I think, is not worth describing, but about the ‚Äúchannels‚Äù you should say a few words. <br>  Channels are a kind of implementation of the MVC pattern.  The XML configuration looks like this: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="iso-8859-1"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:sitemap</font> <font color="#ff0000">xmlns:map</font> <font color="#0000ff">="http://apache.org/cocoon/sitemap/1.0"</font> <font color="#0000ff">&gt;</font> <br> <br> <font>&lt;!-- define the Cocoon processing pipelines --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:pipelines</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:pipeline</font> <font color="#0000ff">&gt;</font> <br> <font>&lt;!-- respond to *.html requests with</font> <br> <font>our docs processed by doc2html.xsl --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:match</font> <font color="#ff0000">pattern</font> <font color="#0000ff">="*.html"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:generate</font> <font color="#ff0000">src</font> <font color="#0000ff">="{1}.xml"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:transform</font> <font color="#ff0000">src</font> <font color="#0000ff">="doc2html.xsl"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:serialize</font> <font color="#ff0000">type</font> <font color="#0000ff">="html"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">map:match</font> <font color="#0000ff">&gt;</font> <br> <br> <font>&lt;!-- later, respond to *.pdf requests with</font> <br> <font>our docs processed by doc2pdf.xsl --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:match</font> <font color="#ff0000">pattern</font> <font color="#0000ff">="*.pdf"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:generate</font> <font color="#ff0000">src</font> <font color="#0000ff">="{1}.xml"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:transform</font> <font color="#ff0000">src</font> <font color="#0000ff">="doc2pdf.xsl"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">map:serialize</font> <font color="#ff0000">type</font> <font color="#0000ff">="fo2pdf"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">map:match</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">map:pipeline</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">map:pipelines</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">map:sitemap</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  As you can see, mapping has three main steps for creating pages: <br><ol><li>  Generation </li><li>  Transformation </li><li>  Serialization </li></ol><br>  In braces are passed parameters for the generator. <br>  Thus, flexibility and a high level of component reuse are achieved: using the same generator and different transformations and serializations, you can get a wide range of output formats from the banal html to pdf or csv. <br><br>  To implement the IoC container, Apache Cocoon uses the currently closed Apache Avalon framework.  All configuration is in the file cocoon.xconf.  Almost everything is collected here: components, data sources, module declarations (Cocoon has a flexible plug-in system) and so on. <br>  There is not a lot of documentation on all this on the Internet, therefore it is a little more detailed about components. <br>  The concept of components looks like this: several components (components) are combined on the basis of a role (role), implementation of a default role is declared, and in a Java class it is already possible to use a role and its specific implementation.  Roles are interfaces, and components are concrete classes.  I will not give specific file listings, they are very large.  The details of Apache Cocoon and Avalon require a separate article. <br><br><h4>  Install Apache Lenya </h4><br>  After downloading apache-lenya-2.0.3-src.zip and unpacking it, which can take a long time due to the larger number of files, it needs to be compiled.  Here begins the biggest "dancing with a tambourine." <br>  Version 2.0.2 I managed to knock off by executing at the root: <br><blockquote> <code>&gt;build build-cocoon</code> <br> <code>&gt;build build-cocoon</code> <br> <code>&gt;build</code> <br> </blockquote><br>  This is not a slip of the pen, the first command must be executed twice. <br>  For version 2.0.3, everything was much more complicated. <br>  First, in the <i>externals \ cocoon_2_1_x \ lib \ optional</i> <i>directory</i> , you need to update <i>xalan-2.7.1.jar</i> to contain package org.apache.xpath, and add <i>serializer.jar</i> from the <i>xalan-j_2_7_1-bin.zip</i> distribution.  By the way, after updating <i>xalan-2.7.1.jar errors</i> may occur during compilation, then you need to look for another <i>xalan-2.7.1.jar</i> .  I took it from the maven repository, and the serializer from the Xalan distribution. <br>  Next, try to hit the Cocoon.  To do this, perform at the root: <br><blockquote> <code>build.bat build-cocoon -lib externals/cocoon_2_1_x/lib/optional</code> </blockquote> <br>  Times from the 3rd or even from the 4th build must pass successfully. <br>  The <i>-lib externals / cocoon_2_1_x / lib / optional</i> parameter is required, because some libraries with ant tasks are there, and some libraries are needed for compilation. <br>  Then for Windows users, you need to put GnuWin32 ( <a href="http://gnuwin32.sourceforge.net/packages/patch.htm">you can take it from here</a> ), add to PATH from the environment variables the directory where GnuWin32 was installed.  It is necessary that the <i>patch</i> command be executed during the build. <br>  In the end, the team <br><blockquote> <code>build -lib externals/cocoon_2_1_x/lib/optional</code> </blockquote> <br>  must end with a magical message BUILD SUCCESSFUL. <br>  If something did not work out, you can additionally ask me or look for answers in the <a href="http://mail-archives.apache.org/mod_mbox/lenya-user/">mail archive</a> <br><br><h4>  Run Apache Lenya </h4><br>  The launch did not go smoothly with me either.  At first I had to copy jms.jar (javax.jms package) and jta-1.1.jar (javax.transaction package) into <code>build\lenya\webapp\WEB-INF\lib\</code> (I need to fix this in the main ant build) , and only after that Apache Lenya successfully started: <br><img src="https://habrastorage.org/getpro/habr/post_images/a23/2a0/ada/a232a0adad58dde5235ee729c6c7d2fd.png" alt="Lenya homepage"><br><br>  It is launched by Lenya using the lenya.bat or lenya.sh file. <br>  The default is the Jetty servlet container. <br>  It is also possible to run under Tomcat (personally tested).  More information about this can be found <a href="http://lenya.apache.org/docu20/installation20/install20.html">on the official website</a> . <br>  Apache Lenya is partially translated into Russian.  Non-localized labels can be translated by adding the required data in the internationalization files: <i>$ LENYA_HOME $ \ src \ webapp \ lenya \ resources \ i18n</i> <br><br><h4>  Creating a new publication Apache Lenya </h4><br>  To create your publication you must do the following. <br>  On the main page, click 'Create publication', enter the identifier (future context) and the name of the publication: <br><img src="https://habrastorage.org/getpro/habr/post_images/df1/d40/7c7/df1d407c7003e8b3974ad72a3fd42ef4.png" alt="Create publication"><br><br>  After creation, click on the link to the publication and get to the page with the properties of the publication: <br><img src="https://habrastorage.org/getpro/habr/post_images/67a/85a/c8c/67a85ac8cf08de43c5fb0bad00e44b42.png" alt="Publication homepage"><br><br>  Select 'Login for authoring' (allows editing site content and site configuration) <br>  Login as lenya (password levi) <br>  Choose what to do: export the default pages or not create any pages: <br><img src="https://habrastorage.org/getpro/habr/post_images/541/e47/b96/541e47b965e1c3c4218da6306e469542.png" alt="Import pages"><br><br>  Then the user lenya can create pages, edit them and send for approval.  In the "Edit" menu, you can create pages, and in the "Process" menu, manage the status of pages: <br><img src="https://habrastorage.org/getpro/habr/post_images/e24/501/b60/e24501b60b88b60aac15bf7895f2f66b.png" alt="Edit menu"><br><img src="https://habrastorage.org/getpro/habr/post_images/b98/59c/1ab/b9859c1ab61a753f6cc9728aa31bb6c0.png" alt="Workflow menu"><br><br>  The user alice (password levi) has the role of a reviewer and has the right to publish pages.  After the publication of the page appear on the Live View (or tab "Published") <br>  For help, data about users, groups and roles are stored in <i>\ build \ lenya \ webapp \ lenya \ pubs \ default \ config \ access-control \ passwd \</i> Of course, you can change them via the web interface, the 'Admin' tab. <br><br><h4>  findings </h4><br>  Apache Lenya is a flexible Java CMS, based on Apache Cocoon, and therefore its full capabilities, and distributed under the Apache License.  This CMS has many features, as they say, "right out of the box", and the functionality can be easily expanded by writing additional modules.  There are few documentation and manuals on the Internet, but there is a small active community.  Under certain conditions, Lenya can be recommended for use. <br>  This article covers only the basics and part of the capabilities of Apache Lenya.  If someone has an interest in this topic, I can continue the description of this unusual CMS. <br><br>  <b>Resource list</b> <br><ol><li>  Apache Lenya official website <a href="http://lenya.apache.org/">http://lenya.apache.org/</a> </li><li>  Apache Cocoon official website <a href="http://cocoon.apache.org/">http://cocoon.apache.org/</a> </li><li>  Apache Lenya zip archive <a href="http://mail-archives.apache.org/mod_mbox/lenya-user/">http://mail-archives.apache.org/mod_mbox/lenya-user/</a> </li><li>  GnuWin32 <a href="http://gnuwin32.sourceforge.net/packages/patch.htm">http://gnuwin32.sourceforge.net/packages/patch.htm</a> </li><li>  List of <a href="http://en.wikipedia.org/wiki/List_of_content_management_systems">CMS in Java on Wikipedia</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/101294/">https://habr.com/ru/post/101294/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../101283/index.html">Samsung S8000 Jet. Differences in S8000MXEJA1 and S8000XEIG2 firmware</a></li>
<li><a href="../101285/index.html">How Microsoft DevDiv uses TFS - part 6 (+ add-on) and 7</a></li>
<li><a href="../101287/index.html">Half a year with BenQ S6</a></li>
<li><a href="../101290/index.html">The art of programming under Unix (and not only). Part Two, Clarity Better than Cleverness</a></li>
<li><a href="../101293/index.html">Overview of the router NETGEAR WNR3500L</a></li>
<li><a href="../101297/index.html">We consider the reputation of users of social networks</a></li>
<li><a href="../101298/index.html">On the server park, clusters and data centers Intel</a></li>
<li><a href="../101299/index.html">Installing Debian \ Ubuntu 10.04 on a RAID 5 array</a></li>
<li><a href="../101300/index.html">vds64 - silence of the lambs</a></li>
<li><a href="../101301/index.html">Oracle SQL: Model dialect in examples. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>