<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>And a few words about SandCastle, TFS and magic ...</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Based on the just- missed publication Sandcastle and SHFB, I decided to share my pains and sorrows, as well as the success-story while working with th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>And a few words about SandCastle, TFS and magic ...</h1><div class="post__text post__text-html js-mediator-article">  Based on the just- <a href="http://habrahabr.ru/post/243039/">missed</a> publication <a href="http://habrahabr.ru/post/243039/">Sandcastle and SHFB,</a> I decided to share my pains and sorrows, as well as the success-story while working with this product. <br><br>  In the text <b>there will be no</b> screenshots with captions " <i>click ADD</i> " and descriptions of settings / plugins. <br>  The text <b>will</b> describe the process of implementing a specific case: assembling SHFB documentation in TFS. <br><a name="habracut"></a><br>  So, the current environment: <br><ul><li>  Team Foundation Server 2013 </li><li>  VisualStudio 2014 </li></ul><br><br><h2>  What is the problem </h2><br>  My first and main concern in organizing documentation was to keep the developer away from the further process of building documentation.  Those.  so that the conditional junior could write code, commit it to TFS, and the documentation itself was collected with a successful build of the release version. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So we come to the first problem.  It lies just the same in this junior-developer.  How to make him post comments?  This will help us ... <br><br><h4>  Stylecop </h4><br>  Or rather <a href="https://stylecopcheckinpolicy.codeplex.com/">StyleCop checkin policy</a> .  I had to finish it a bit to pick up the config file directly from TFS (so as not to pour out a new version to all developers every time).  But in general, the principle is clear, yes?  We set up the rules we need regarding documentation, turn on the policy and set up a notification for each Policy override in TFS - we cannot completely ban it (technically <a href="http://blogs.msmvps.com/vstsblog/2014/05/13/turning-off-policy-overrides-in-tfs/">we can</a> , but cases where it will really be necessary to do an override will turn into completely transcendent pain) from here over the developer‚Äôs shoulder a minute after he clicked on the " <i>Override policy</i> " and clearly explain what he is wrong.  Conveniently.  Clearly.  Inspires. <br><br>  So, with Chekina and formatting code sorted out.  We go further. <br><br>  Junior regularly whines that he is tired of writing the same thing.  There are regular situations when the method has corrected the description, and in its five overloads it has been forgotten.  This will help us ... <br><br><h4>  &lt;inheritdoc /&gt; </h4><br>  SHFB supports the &lt;inheritdoc /&gt; tag.  It allows you to get rid of the mass copy-paste in the attributes of the description.  For the sake of his acceptable functioning, you need to dance a little with a tambourine, to guess its capabilities ( <i>because the official documentation is quite extensive and does not go into the technical details of the implementation of this function - I had to dig in the raw materials to catch where he came from tree inherited types</i> ). <br><br>  For example, we have a class: <br><br><pre><code class="cs hljs"><span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;inheritdoc /&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment">   NLog.</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public class NLogWrapper : ILogger, IWithTags { </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;inheritdoc /&gt;</span></span></span><span class="hljs-comment"> public virtual bool IsTraceEnabled { get { return InnerLogger.IsTraceEnabled; } } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;inheritdoc /&gt;</span></span></span><span class="hljs-comment"> public string Name { get; set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;inheritdoc cref="IWithTags.Tags"/&gt;</span></span></span><span class="hljs-comment"> public HashSet</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> Tags { get; set; } ... }</span></span></code> </pre> <br><br>  In the resulting <i>NLogWrapper</i> class <i>documentation, the</i> descriptions of IsTraceEnabled and <i>Name</i> are inherited from <i>ILogger</i> , and the <i>Tags</i> from <i>IWithTags</i> .  Conveniently.  It would seem - here it is, happiness!  But no. <br>  Sadness # 1 with this <i>inheritdoc</i> is that it works on etheric matters through astral bodies and you can almost never be sure that any of the cases will work until you try.  For example: <br><ul><li>  You cannot inherit descriptions of overloaded methods within a single class / interface; </li><li>  It is not always enough to hang the label from the inherited method - <i>sometimes you also</i> need to put it on the class itself, so that the SHFB would guess that its ancestors should be scanned; </li><li>  It is necessary to manually add the library with the base classes in <i>DocumentationSources</i> (about this below); </li><li>  <a href="https://shfb.codeplex.com/discussions/551113">Additional manipulations are</a> needed for IntelliSense, because out of the box, in the resulting .xml, these very <i>&lt;inheritdoc /&gt;</i> are obtained, which Visual Studio does not eat. </li></ul><br>  Etc.  In general, a useful thing, but you need to think carefully before using it. <br><br>  Well, we have finished with this preparation, let's get down to the main point. <br><br><h2>  Tfs build </h2><br>  So what do we want?  And we want for our assembly, along with all the projects in it was the documentation. <br>  To begin with, we put SHFB on the server where our build-agent is spinning.  Otherwise it will not work.  It uses environment variables, a bunch of local files ... In general, you have to set. <br><br>  Next, open the gui SHFB, set up the project, add our <b>.sln</b> file as the Documentation Sources, save it.  We read the <a href="http://www.ewoodruff.us/shfbdocs/html/ec822059-b179-4add-984d-485580050ffb.htm">instructions</a> .  Everything looks rather trivial.  Create a build.proj file according to the instructions in order to fool dancing with <i>OutputDir</i> (I tried without it - there it begins with such paths that it‚Äôs true that it‚Äôs better to make an extra .proj wrapper): <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DefaultTargets</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Build"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/developer/msbuild/2003"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ToolsVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Build"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Build source code docs --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MSBuild</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Projects</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"My.Api.shfbproj"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Properties</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Configuration=Release;Platform=AnyCPU;OutDir=$(OutDir)"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Run: <br><br><pre> <code class="dos hljs">SHFB : error BE0040: Project assembly does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span></code> </pre><br>  Ummm, what?  Who are you? <br><br>  And this, friends, is a rake: although the sfhbproj file is in fact an msbuild-project, and even allows you to operate with .sln-files as sources, only <b>it does not build it itself</b> .  Those.  he uses this .sln file only to find a list of projects, and in them to find an OutputFolder for the specified configuration and from there <b>take ready-made .dll / xml files</b> . <br><br>  That is because a lazy beast something.  Okay, now we will teach new tricks.  We climb in the file, we see there <pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Project</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(SHFBROOT)\SandcastleHelpFileBuilder.targets"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br>  Yeah.  After a pretty quick insight, we understand that <i>$ (SHFBROOT)</i> is nothing but the installation folder of the SHFB binaries.  There we find this file.  We are looking at where we should go in ... Yeah, here it is: <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildDependsOn</span></span></span><span class="hljs-tag">&gt;</span></span> PreBuildEvent; BeforeBuildHelp; CoreBuildHelp; AfterBuildHelp; PostBuildEvent <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BuildDependsOn</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Build"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DependsOnTargets</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(BuildDependsOn)"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  Take, for example, <i>BeforeBuildHelp</i> .  Another piece of documentation that will help us live is <a href="http://www.ewoodruff.us/shfbdocs/html/8ffc0d37-0215-4609-b6f8-dba53a6c5063.htm">here</a> .  Slightly modify our build.proj: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DefaultTargets</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Build"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/developer/msbuild/2003"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ToolsVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Build"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Build source code docs --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MSBuild</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Projects</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"My.Api.shfbproj"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Properties</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Configuration=Release;Platform=AnyCPU;OutDir=$(OutDir);CustomAfterSHFBTargets=$(MSBuildThisFileDirectory)shfbcustom.targets"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  (added <i>CustomAfterSHFBTargets</i> ) and create this file shfbcustom.targets: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/developer/msbuild/2003"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ToolsVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BeforeBuildHelp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">XmlPeek</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Namespaces</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"&lt;Namespace Prefix='msb' Uri='http://schemas.microsoft.com/developer/msbuild/2003'/&gt;"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">XmlContent</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"&lt;root&gt;$(DocumentationSources)&lt;/root&gt;"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Query</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//msb:DocumentationSource[@configuration]/@sourceFile"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">TaskParameter</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Result"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Peeked"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">XmlPeek</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MSBuild</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Projects</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@(Peeked)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Properties</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Configuration=Doc;Platform=Any CPU;OutDir=$(OutDir)"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Here is a little bit of magic.  In the file My.Api.shfbproj in the &lt;DocumentationSources&gt; property is stored ... XML.  String.  Here is a tricky move.  Against it, we can use just the same tricky move: our Overload target <i>BeforeBuildHelp</i> takes this line, feeds it to the XmlPeek task and takes out all <i>@sourceFile</i> from the nodes that have <i>@configuration</i> .  It then feeds this array to MSBuild. <br><br>  Yes, at the same time, we lose the Configuration | Platform settings, which could be specified in the SHFB for these sources, but I could just endure this pain: a special assembly configuration called Doc is used for documentation (as seen above in the code).  This is a copy of the release, with disconnected test projects and other unnecessary things that would otherwise prevent the normal dock from generating.  Those.  it would be possible to make this file three times thicker, to parse its parameters for each .sln, but in our case it was not worth it. <br><br>  Run again ... Wow - going! <br>  So, i.e.  we already have a project that can be configured in SHFB, including new .sln, and then just run the build in TFS and get chm + html at the output ?!  Perfectly.  Look ... oh, what is it?  In the error log: <br><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">SHFB: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Warning</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GID0002</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">No</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">comments</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">found</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cref</span></span></span><span class="hljs-function"> '</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T:System</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Web.Http.Dependencies.IDependencyResolver</span></span></span><span class="hljs-function">' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">member</span></span></span><span class="hljs-function"> '</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">T:My</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Api.Server.DependencyResolver</span></span></span><span class="hljs-function">'</span></span></code> </pre><br>  See the code: <br><pre> <code class="cs hljs"> <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> DependencyResolver  Unity </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;inheritdoc cref="System.Web.Http.Dependencies.IDependencyResolver" /&gt;</span></span></span><span class="hljs-comment"> [System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Design", "CA1063:ImplementIDisposableCorrectly", Justification = "IDisposable    .")] public class DependencyResolver : DependencyScope, IDependencyResolver { </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;inheritdoc /&gt;</span></span></span><span class="hljs-comment"> public DependencyResolver(IUnityContainer container) : base(container) { } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;inheritdoc /&gt;</span></span></span><span class="hljs-comment"> public IDependencyScope BeginScope() { Log.Trace("Beginning new scope"); return new DependencyScope(Container.CreateChildContainer()); } }</span></span></code> </pre><br>  It seems that everything is clean, <i>&lt;inheritdoc /&gt;</i> is, it is registered normally - it should be! <br><br><h4>  [cut] </h4><br>  Above cut a few hours of searching, picking in the settings, then in the source code of the SHFB itself and its pieces ... As a result, it turned out: <br><br>  <b>The source for &lt;inheritdoc /&gt; is taken EXCLUSIVELY the data specified in <i>DocumentationSources</i> .</b>  <b>However, they must be written directly in the file.</b> <br><br>  No plugins will help.  No References count.  No MSBuild magic that allows modifying variables on the fly does not help either.  Because in the end, the <i>GenerateInheritedDocs.exe</i> file is launched, which stupidly parses the .shfbproj file, extracts the contents of the node through the XPath and iterates through the files specified there.  Everything has arrived.  I tried, it was, to cut this obscurantism, but there the direct work with the file was inserted at every step - each component in itself climbs into it and reads what it needs - there is no talk of any general context.  So I abandoned this venture. <br><br>  <b>So if you want to insert into your documentation the lines from the components that you use in the project</b> (in this case, I wanted to have a description of the methods from <i>System.Web.Http</i> ), <b>then you will have to include these components in the <i>DocumentationSources</i></b> . <br><br>  Yes, you can include not the assembly itself, but only the .xml file from it.  This is not much easier. <br>  At this point, we clearly get hemorrhoids with the support of the .shfbproj file - we need to update it every time new components are used.  We need to update it every time we update the nuget-package - because the path to the file changes!  Horror-horror.  And do not automate the same. <br><br>  No, of course, you can make such a target, to sort through the contents of <i>/ packages / **</i> and pull out all the .xml from there ... But, no, it is impossible - each package can contain several versions for different versions of the .net runtime.  So, it is necessary to go from the other end - after assembling each project, iterate through the entire contents of $ (OutDir), and from there enter all xml / dll files into ... But where? <br><br>  Here you can beat a little: the inclusion of .shfbproj is supported as a Documentation Source.  So you can create a minimum content file on the fly, which will only have <i>DocumentationSources</i> , and keep it the only inclusion in the main file ... But it smacks of something with this, I think. <br><br>  To (un-) fortunately, I did all this as an elective and out of personal interest, I soon had to take on another project, and it all remained in this form - it is going to, published, but to update / maintain - pain. <br><br><h2>  What is left over? </h2><br><ul><li>  The ‚ÄúBuild project‚Äù button (or the Continuos Integration rule itself) collects and publishes documentation in .chm and html for the project.  It's good; </li><li>  Along the way, they made a rule to control negligent juniors, so that they quickly come to enlightenment.  It's also good; </li><li>  To support and develop it will be someone else.  Just great. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/243171/">https://habr.com/ru/post/243171/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243157/index.html">Personalization for search services</a></li>
<li><a href="../243159/index.html">"Secrets" of the existence of nerdy</a></li>
<li><a href="../243161/index.html">A simple way to stretch a block to the full height of the screen, or CSS3 Viewport Units</a></li>
<li><a href="../243163/index.html">WinJS + universal applications. Studying navigation</a></li>
<li><a href="../243167/index.html">Understanding the experience of gamers with disabilities</a></li>
<li><a href="../243173/index.html">Uptime your sites now in PDF</a></li>
<li><a href="../243175/index.html">A full-fledged Minecraft processor: how does it work, how to program on it and what is it for?</a></li>
<li><a href="../243183/index.html">Under what OS and what are you programming?</a></li>
<li><a href="../243187/index.html">Russian SQL language documentation for Firebird 2.5 DBMS</a></li>
<li><a href="../243191/index.html">SMM? Thanks but no thanks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>