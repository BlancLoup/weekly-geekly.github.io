<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We program Windows 7: Taskbar. Part 3 - OverlayIcon</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This time we will talk about another feature of the Windows 7 taskbar - OverlayIcon. This feature is extremely useful for applications that have some ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We program Windows 7: Taskbar. Part 3 - OverlayIcon</h1><div class="post__text post__text-html js-mediator-article">  This time we will talk about another feature of the Windows 7 taskbar - OverlayIcon.  This feature is extremely useful for applications that have some state from the user's point of view. <br><br>  These applications include instant messaging (IM) programs.  For example, Windows Live Messanger is actively using this feature.  For example, if we open WLM and change the state, then you can see how it is displayed on the taskbar. <br><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.3OverlayIcon_C7CC/image_30699e8f-57c2-405c-bcb2-8881e184380c.png"></div><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.3OverlayIcon_C7CC/image_b39d8b82-52c4-4a6e-b7de-2ec25d8aff92.png"></div><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.3OverlayIcon_C7CC/image_7c543a63-5abb-4b1e-8b7b-f1210513363f.png"></div><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Such functionality can be useful for a variety of applications.  Fortunately, implementing it is not so difficult.  As in the previous examples, we will use the <a href="http://code.msdn.microsoft.com/Windows7Taskbar/Release/ProjectReleases.aspx%3FReleaseId%3D2246">.NET Interop Sample Library</a> . <br><br>  To add a status icon to the main application icon, you need to add a resource file to the project and place the necessary icons there.  Also, we can get Icon objects from another place, if necessary. <br><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.3OverlayIcon_C7CC/image_9709900e-0f2c-49bd-9e91-509bfa3e393f.png"></div><br>  Now all that needs to be done is to use extension methods that allow us to set icons for our application.  For these purposes, the SetTaskbarOverlayIcon method is defined.  We must give him in the parameters of our form, icon and description.  Thus, installing a new icon from the code will look like this. <br><br> <code>WindowsFormsExtensions.SetTaskbarOverlayIcon(this, Icons.Error, "Error");</code> <br> <br>  We can also remove this icon.  To do this, pass the value null instead of the icon itself. <br><br> <code>WindowsFormsExtensions.SetTaskbarOverlayIcon(this, null, String.Empty);</code> <br> <br>  Let's create for example a small application in which we can switch the state.  It will look like this. <br><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.3OverlayIcon_C7CC/image_bef9fb42-c633-4794-97a3-91c7a5e9f820.png"></div><br><br>  Clicking on each of the buttons switches the status that is displayed in the taskbar. <br><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.3OverlayIcon_C7CC/image_66751657-6796-4b65-a460-dd2a636205cb.png"></div><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.3OverlayIcon_C7CC/image_09884187-9273-4aa4-af0a-924ef9112df3.png"></div><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.3OverlayIcon_C7CC/image_c28e808c-5ff0-4ee1-be0d-12970b2050b9.png"></div><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.3OverlayIcon_C7CC/image_8f9770c0-2a96-4b5a-8a93-c23c23181406.png"></div><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7Taskbar.3OverlayIcon_C7CC/image_78f3668a-c48e-491f-9d40-cdef5dbc161a.png"></div><br>  Demo application: <br>  <a href="">Taskbar-Icons.zip</a> </div><p>Source: <a href="https://habr.com/ru/post/60223/">https://habr.com/ru/post/60223/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../60216/index.html">North Korea entered the information security market</a></li>
<li><a href="../60217/index.html">The first million is always the most difficult</a></li>
<li><a href="../60219/index.html">Interactive presentations with Starboard WT-1</a></li>
<li><a href="../60220/index.html">Solving a problem with svn: Revision range is not allowed</a></li>
<li><a href="../60221/index.html">Are Pirates from the Bay against business information?</a></li>
<li><a href="../60224/index.html">Cartoon "Gypsy": Baro and Tagar, an autopsy revealed ...</a></li>
<li><a href="../60225/index.html">Gmail - Inbox preview</a></li>
<li><a href="../60227/index.html">Experts ask for ‚Äúhacker‚Äù Nokia 1100</a></li>
<li><a href="../60229/index.html">Competition: ‚ÄúThink of a replacement tabam‚Äù</a></li>
<li><a href="../60230/index.html">Do you use antivirus in Linux?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>