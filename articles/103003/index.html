<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Where is this street, where is this house ... Or how to determine the area in which the enterprise is located</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the process of developing a new service, we had an interesting problem. It is necessary to determine the ownership of the enterprise to any adminis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Where is this street, where is this house ... Or how to determine the area in which the enterprise is located</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/habraeffect/33/5b/335b05eff17741d65fd8f30961f69695.jpg" alt="image"><br><br>  In the process of developing a new service, we had an interesting problem.  It is necessary to determine the ownership of the enterprise to any administrative-territorial or municipality and assign the enterprise to the district or district in which it is located.  The representation for the end user should be a filter in a search form that would allow organizations to be found only in a given area or district of the city.  And it must be done for companies all over Russia. <br><a name="habracut"></a><br>  Introductory data: we had some accumulated base, numbering quite a large number of organizations throughout Russia.  The database included the addresses of enterprises that were an ordinary line.  Accordingly, there were no obvious ways to make a territorial link. <br><br>  To implement such a seemingly simple task, I had to pretty much break my head.  At first, the idea was to use Google-maps to draw the outlines of areas using custom maps, and get the coordinates of organizations through the Yandex geocoder.  But this idea turned out to be utopian - not everyone will master maps of areas for all of Russia. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A suitable decision came to my head suddenly - to use the ready-made <a href="http://www.gnivc.ru/Document.aspx%3Fid%3D80">bases of administrative and territorial divisions of KLADR</a> .  This database contains a complete list of settlements, streets and houses in Russia.  The KLADR database also contains the OKATO code (All-Russian Classifier of the Objects of Administrative-Territorial Division) for each territorial unit.  It should be noted that the OKATO base itself is not part of KLADR and must be <a href="http://www.classbase.ru/download">downloaded separately</a> . <br><br>  So, the base by which you can determine the district or district is available.  It remains to figure out how to match her existing addresses.  The data on houses in KLADR is stored in a rather specific way: information about a house can contain many different symbols, such as the body, the structure, the parity, which must also be taken into account when determining the area.  So we need to analyze the available addresses.  This can be done in two ways: <br><br>  The first one is the simplest and the most <a href="http://api.yandex.ru/maps/geocoder/">unreliable</a> : feed the address of existing companies <a href="http://api.yandex.ru/maps/geocoder/">to the Yandex geocoder</a> , which will <a href="http://api.yandex.ru/maps/geocoder/">parse the</a> address into pieces.  But there is a big disadvantage of this method - if for some reason there is no such address in the geocoder's base, it will return the structure closest to the specified location.  And maybe nothing at all to return ... <br>  The second way is the Jedi way.  Implement the address parser with your own hand.  Since the accuracy of the address determination was critical for our service, it was decided to implement the parser using our own resources.  The simplest implementation example is <a href="http://github.com/zdanchik/address-parser">here</a> .  In the example, the address string is parsed into an array, the keys of which are the types of territorial units.  In the above example, there is one ‚Äúbut‚Äù: the address must already be in the ‚Äúcorrect‚Äù format.  That is, for example, the house in the address must go after the street, and not in front of it. <br><br>  Now that the address represents a more understandable structure, it can be compared with the existing KLADR base and get the OKATO code.  By itself, the KLADR base does not give an idea of ‚Äã‚Äãthe belonging of a territory to some district or district.  With it, you can determine the maximum of the OKATO code and there is also a zip code.  And the necessary representation can be given by the <a href="http://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2589%25D0%25B5%25D1%2580%25D0%25BE%25D1%2581%25D1%2581%25D0%25B8%25D0%25B9%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25BA%25D0%25BB%25D0%25B0%25D1%2581%25D1%2581%25D0%25B8%25D1%2584%25D0%25B8%25D0%25BA%25D0%25B0%25D1%2582%25D0%25BE%25D1%2580_%25D0%25BE%25D0%25B1%25D1%258A%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BE%25D0%25B2_%25D0%25B0%25D0%25B4%25D0%25BC%25D0%25B8%25D0%25BD%25D0%25B8%25D1%2581%25D1%2582%25D1%2580%25D0%25B0%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25BE-%25D1%2582%25D0%25B5%25D1%2580%25D1%2580%25D0%25B8%25D1%2582%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F">base</a> itself <a href="http://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2589%25D0%25B5%25D1%2580%25D0%25BE%25D1%2581%25D1%2581%25D0%25B8%25D0%25B9%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25BA%25D0%25BB%25D0%25B0%25D1%2581%25D1%2581%25D0%25B8%25D1%2584%25D0%25B8%25D0%25BA%25D0%25B0%25D1%2582%25D0%25BE%25D1%2580_%25D0%25BE%25D0%25B1%25D1%258A%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BE%25D0%25B2_%25D0%25B0%25D0%25B4%25D0%25BC%25D0%25B8%25D0%25BD%25D0%25B8%25D1%2581%25D1%2582%25D1%2580%25D0%25B0%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25BE-%25D1%2582%25D0%25B5%25D1%2580%25D1%2580%25D0%25B8%25D1%2582%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F">OKATO</a> .  It is located in it information on intracity areas, districts of cities of republican, regional, regional subordination. <br><br>  So, the scripts are written, the codes are mapped.  As a result, such functionality appeared on the light: <br><br><img src="https://habrastorage.org/storage/habraeffect/5a/18/5a185aeaec9c16333dfc95fb2ad7e6f8.jpg" alt="image"><br><br>  Implemented and described by <a href="https://habrahabr.ru/users/zdanchik/" class="user_link">zdanchik</a> </div><p>Source: <a href="https://habr.com/ru/post/103003/">https://habr.com/ru/post/103003/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../102972/index.html">My favorite hosting is dreamhost.com</a></li>
<li><a href="../102984/index.html">Rostelecom forgot to renew ssl-certificate gosuslugi.ru</a></li>
<li><a href="../102991/index.html">Bringing the look of Ubuntu to Windows 7</a></li>
<li><a href="../102993/index.html">I am looking for an adequate employer</a></li>
<li><a href="../102998/index.html">The first swallow - VTB24</a></li>
<li><a href="../103004/index.html">The art of programming under Unix (and not only). Part Three, ‚ÄúComposition Rule‚Äù</a></li>
<li><a href="../103005/index.html">Two small problems when upgrading phpmyadmin to 3.3.5.1</a></li>
<li><a href="../103008/index.html">Foursquare continues to gain momentum</a></li>
<li><a href="../103009/index.html">Problems of the .local zone in modern Linux distributions</a></li>
<li><a href="../103010/index.html">Audio processing via Audio Data API</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>