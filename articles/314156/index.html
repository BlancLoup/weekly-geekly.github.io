<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Enums + Associated Values ‚Äã‚Äã= Swift</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Swift means fast. Fast means comprehensible, simple. But to achieve simplicity and clarity is not easy: now in Swift the compilation speed is so-so, a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Enums + Associated Values ‚Äã‚Äã= Swift</h1><div class="post__text post__text-html js-mediator-article"><p>  Swift means fast.  Fast means comprehensible, simple.  But to achieve simplicity and clarity is not easy: now in Swift the compilation speed is so-so, and even some moments of the language raise questions.  Nevertheless, the possibility of enumerations (enum), about which I will tell (associated values), is one of the coolest.  It allows you to reduce the code, make it clearer and more reliable. </p><br><img src="https://habrastorage.org/files/c37/1e2/28c/c371e228cf4e4cfab1b6da9118fddbb0.gif"><br><a name="habracut"></a><br><h2 id="ishodnaya-zadacha">  Initial task </h2><br><p>  Imagine that you need to describe the structure of payment options: in cash, by card, by gift certificate, by paper.  Each payment method may have its own parameters.  Implementation options under such weakly defined conditions - an infinite number, something can be grouped, something to redefine.  You should not find fault, this structure lives here for example. </p><br><pre><code class="hljs cmake">class PaymentWithClass { // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>,   ,  <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> ,  init()   var isCash: Bool = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> // .some,   ,  -,  - var cardNumber: <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>? var cardHolderName: <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>? var cardExpirationDate: <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>? // .some,     var giftCertificateNumber: <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>? //  -     (    ) var paypalTransactionId: <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>? var paypalTransactionAuthCode: <span class="hljs-keyword"><span class="hljs-keyword">String</span></span>? }</code> </pre> <br><p>  (Something a lot of opshnalov happened) </p><br><p>  Working with such a class is hard.  Swift interferes, because unlike many other languages, it will force all opshnals to be processed (for example, <code>if let</code> or <code>guard let</code> ).  There will be a lot of extra code that will hide business logic. </p><br><p>  It is unpleasant and verified.  It‚Äôs still possible to imagine a code that checks the validity of this class, but I don‚Äôt feel like writing anything like that. </p><br><h2 id="struktury">  Structures! </h2><br><p>  Recall that in Swift there are value-types, which are called structures.  They say they are good to use for this kind of model descriptions.  We will try at the same time to break the previous code into several structures corresponding to different types of payment. </p><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PaymentWithStructs</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cash</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Card</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> number: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> holderName: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> expirationDate: <span class="hljs-type"><span class="hljs-type">String</span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GiftCertificate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> number: <span class="hljs-type"><span class="hljs-type">String</span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PayPal</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> transactionId: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> transactionAuthCode: <span class="hljs-type"><span class="hljs-type">String?</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cash: <span class="hljs-type"><span class="hljs-type">Cash?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> card: <span class="hljs-type"><span class="hljs-type">Card?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> giftCertificate: <span class="hljs-type"><span class="hljs-type">GiftCertificate?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> payPal: <span class="hljs-type"><span class="hljs-type">PayPal?</span></span> }</code> </pre> <br><p>  It turned out better.  The correctness of individual payment types is verified by the language itself (for example, it is clear that the PayPal authorization code may be missing, but all fields are required for the card), we only need to validate one (and only one) of the <code>cash</code> , <code>card</code> , <code>giftCertificate</code> , <code>payPal</code> - not null. </p><br><p>  Conveniently?  Full  In this place in many languages ‚Äã‚Äãyou can put an end and consider the work done.  But not in Swift. </p><br><h2 id="enumy-associirovannye-znacheniya">  Enum'y.  Associated Values </h2><br><p>  Swift, like any modern language, provides the ability to create typed enums (enums).  It is convenient to use them when you need to describe that a field can be one of several predefined values ‚Äã‚Äãor inserted into a <code>switch</code> to check that all possible options have been enumerated.  In theory, in our example, the maximum that can be done is to insert a type of payment in order to more precisely validate the structure: </p><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PaymentWithStructs</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kind</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> cash <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> card <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> giftCertificate <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> payPal } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Card</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> number: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> holderName: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> expirationDate: <span class="hljs-type"><span class="hljs-type">String</span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GiftCertificate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> number: <span class="hljs-type"><span class="hljs-type">String</span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PayPal</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> transactionId: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> transactionAuthCode: <span class="hljs-type"><span class="hljs-type">String?</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> kind: <span class="hljs-type"><span class="hljs-type">Kind</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> card: <span class="hljs-type"><span class="hljs-type">Card?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> giftCertificate: <span class="hljs-type"><span class="hljs-type">GiftCertificate?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> payPal: <span class="hljs-type"><span class="hljs-type">PayPal?</span></span> }</code> </pre> <br><p>  Notice that the <code>Cash</code> structure is missing, it is empty and hung only to indicate the type that we have now explicitly entered.  Got better?  Yes, it became easier to check what type of payment we use.  It is written explicitly, no need to analyze which field is not <code>nil</code> . </p><br><p>  The next step is to try to somehow get rid of the need for separate opshnals for each type.  It would be cool if there was an opportunity to bind the appropriate structures to the type.  To the card - the number and owner, to PayPal - the transaction identifier and so on. </p><br><p>  For this purpose, Swift has associated values ‚Äã‚Äã(associated values, not to be confused with associated types, which are used in protocols and not at all about that).  They are recorded like this: </p><br><pre> <code class="hljs vbscript">enum PaymentWithEnums { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> cash <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> card( number: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, holderName: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, expirationDate: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> giftCertificate( number: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> payPal( transactionId: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, transactionAuthCode: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>? ) }</code> </pre> <br><p>  The most important point is the exact type.  It is immediately obvious that <code>PaymentWithEnums</code> can take exactly one of four values, and each value may or may not have certain parameters as a date or <code>transactionAuthCode</code> .  It is physically impossible to put down the parameters immediately for both the card and the gift certificate, as this could be done in the variant with classes or structures. </p><br><p>  It turns out that the previous versions require additional checks.  It was also possible to forget to process any of the payment options, especially if there are new ones.  Enums eliminate all these problems.  If a new case is added, the next recompilation will require adding it to all switches.  No opshnals except really necessary. </p><br><p>  You can use such complex enums as usual: </p><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .cash = payment { <span class="hljs-comment"><span class="hljs-comment">//  -     }</span></span></code> </pre> <br><p>  Parameters are obtained using pattern-matching: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .giftCertificate(<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> number) = payment { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"O_o  ! : \(number)"</span></span>) }</code> </pre> <br><p>  And you can switch over all the options with a switch: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> payment { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .cash: <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">" !"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .card(<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> number, <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> holderName, <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> expirationDate): <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> last4 = <span class="hljs-type"><span class="hljs-type">String</span></span>(number.characters.suffix(<span class="hljs-number"><span class="hljs-number">4</span></span>)) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">", !   \(last4), : \(holderName)!"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .giftCertificate(<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> number): <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"O_o  ! : \(number)"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .payPal(<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> transactionId, <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> transactionAuthCode): <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">" ! : \(transactionId)"</span></span>) }</code> </pre> <br><p>  As an exercise, you can write similar code for a variant with a class / structure.  To complete the exercise, you need not be lazy and handle all the necessary options, including the erroneous ones. </p><br><p>  Kayf.  Swift.  Another would be to compile quickly, and in general there will be happiness.  :-) </p><br><h2 id="nemnogo-grabley">  Little rake </h2><br><p>  Enums are not a panacea.  Here are a few things you can meet. </p><br><p>  First, enums cannot contain stored fields.  If we want to add to <code>PaymentWithEnums</code> , for example, the date of payment (the same field for all payment options), we get the error: <code>enums may not contain stored properties</code> .  How to be?  You can put a date in each enum case.  You can make the structure and put there enum and date. </p><br><p>  Secondly, if ordinary enums can be compared using the <code>==</code> operator (it is synthesized automatically), then as soon as the associated values ‚Äã‚Äãappear, the possibility of comparing ‚Äúdisappears‚Äù.  This can be <code>Equatable</code> easily by supporting <code>Equatable</code> protocol.  However, even after that, it will be inconvenient to compare, since it is impossible to simply write <code>payment == PaymentWithEnums.giftCertificate</code> , you will need to create the right-hand part entirely: <code>PaymentWithEnums.giftCertificate(number: "")</code> .  It is much more convenient in this case to create special methods that return Bool ( <code>isGiftCertificate(_ payment: PaymentWithEnums) -&gt; Bool</code> ), and transfer there <code>if case</code> .  If you need to compare multiple values, then perhaps the <code>switch</code> will be more convenient. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/314156/">https://habr.com/ru/post/314156/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../314142/index.html">Google again revealed unpatched vulnerability in Windows</a></li>
<li><a href="../314144/index.html">Song of the Mighty Deploy: nonstop transparent web service deployment</a></li>
<li><a href="../314146/index.html">How to protect the IP camera from the Mirai botnet with Flussonic Agent</a></li>
<li><a href="../314150/index.html">Hackers stole a billion rubles from four banks with the help of a bot</a></li>
<li><a href="../314152/index.html">What to tell about the company to get feedback from the developers (checklist)</a></li>
<li><a href="../314160/index.html">‚ÄúKeep your hand on the pulse and look around‚Äù - an interview about AI with Intento co-founder Gregory Sapunov</a></li>
<li><a href="../314166/index.html">No - hacking servers! Tips for verification and protection</a></li>
<li><a href="../314168/index.html">Monitoring and Configuring Linux Network Stack: Getting Data</a></li>
<li><a href="../314170/index.html">I'm technilid What to do?</a></li>
<li><a href="../314172/index.html">JavaScript and SEO in 2016</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>