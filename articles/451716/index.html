<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Improving software performance with Intel tools for developer. Numerical modeling of astrophysical objects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We are starting a series of articles about various situations in which the use of Intel tools for developers has significantly increased the speed of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Improving software performance with Intel tools for developer. Numerical modeling of astrophysical objects</h1><div class="post__text post__text-html js-mediator-article">  We are starting a series of articles about various situations in which the use of Intel tools for developers has significantly increased the speed of the software and its quality. <br><br>  Our first story took place at Novosibirsk University, where researchers developed a software tool for numerical simulation of magnetohydrodynamic problems in hydrogen ionization.  This work was carried out in the framework of the global project of modeling astrophysical objects <a href="https://github.com/IgorKulikov/AstroPhi">AstroPhi</a> ;  <a href="https://ark.intel.com/content/www/us/en/ark/products/series/132784/intel-xeon-phi-72x5-processor-family.html">Intel Xeon Phi</a> processors were used as a hardware platform.  As a result of using <a href="https://software.intel.com/en-us/advisor">Intel Advisor</a> and <a href="https://software.intel.com/en-us/trace-analyzer">Intel Trace Analyzer and Collector</a> , the computing performance increased 3 times, and the speed of solving one task was reduced from a week to two days. <br><br><img src="https://habrastorage.org/webt/ve/yz/on/veyzonsqtlwjzsvr8njnsasyu5c.png"><br><a name="habracut"></a><br><h2>  <font color="#0071c5">Task Description</font> </h2><br>  Mathematical modeling plays an important role in modern astrophysics, as in any science;  This is a universal tool for the study of nonlinear evolutionary processes in the universe.  Modeling complex astrophysical processes in high resolution requires huge computational resources.  The AstroPhi NSU project develops astrophysical program code for supercomputers based on Intel Xeon Phi processors.  Students learn to write modeling programs for a highly parallelized runtime environment, gaining important knowledge that they will further need when working with other supercomputers. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The numerical simulation method used in the project had several important advantages: <br><br><ul><li>  no artificial viscosity </li><li>  Galilean invariance, </li><li>  guarantee of non-reduction of entropy, </li><li>  simple parallelization </li><li>  potentially infinite extensibility. </li></ul><br>  The first three factors are key for realistic modeling of significant physical effects in astrophysical problems. <br><br>  A team of researchers has created a new modeling tool for multi-parallel architectures based on Intel Xeon Phi.  Its main task was to avoid bottlenecks in the exchange of data between nodes and simplify the development of the code as much as possible.  The parallelization tool uses MPI, and for vectorization, Intel Advanced Vector Extensions 512 (Intel AVX-512) instructions add support for 512-bit SIMD and allow the program to pack 8 double-precision floating-point numbers or 16 single-precision (32-bit) ) in vectors 512 bits long.  Thus, twice as many data items are processed per instruction as with AVX / AVX2 and fourfold more than with SSE. <br><br><img src="https://habrastorage.org/webt/sr/wp/-t/srwp-tbptms3rmbp_gcwucnq7lk.png"><br><br>  <i>Picture before optimization.</i>  <i>Each point is a processing cycle.</i>  <i>The bigger and redder the point, the longer the cycle lasts and the more noticeable is the effect of its optimization.</i>  <i>The red dot lies well below the DRAM throughput limit and is calculated with a capacity of less than 1 GFLOP.</i>  <i>It has a lot of potential for improvement.</i> <br><br><h2>  <font color="#0071c5">Code optimization</font> </h2><br>  Before optimization, the code had certain problems with dependencies and vector sizes.  The goal of the optimization was to remove vector dependencies and improve data loading operations into memory using the optimal size of vectors and arrays for Xeon Phi.  <a href="https://software.intel.com/en-us/advisor">Intel Advisor</a> and <a href="https://software.intel.com/en-us/trace-analyzer">Intel Trace Analyzer and Collector</a> , two tools from <a href="https://software.intel.com/en-us/parallel-studio-xe">Intel Parallel Studio XE, were</a> used for optimization. <br><br>  <b>Intel Advisor</b> is, as its name implies, Advisor is a software tool that evaluates the degree of optimization ‚Äî vectorization (using AVX or SIMD instructions) and parallelization to achieve maximum performance.  Using this tool, the team was able to do a review of the cycles, highlighting those who work with low productivity, indicating the potential for improvement and determining what could be improved and whether the game was worth the candle.  Intel Advisor sorted out cycles by potential, added messages to the source for better readability of the compiler's report.  He also provided important information such as the number of repetitions of loops, data dependencies, and memory access patterns for safe and efficient vectoring. <br><br>  <b>Intel Trace Analyzer and Collector</b> is another tool for optimizing code.  It includes profiling MPI communications and analysis functionality to improve weak and strong scaling.  This graphical tool helped the team understand the application's MPI behavior, quickly find bottlenecks and, most importantly, increase performance on the Intel architecture. <br><br><img src="https://habrastorage.org/webt/ab/iu/-c/abiu-cytfszydezm2llj5ftyemi.png"><br><br>  <i>Picture after optimization.</i>  <i>During the optimization of the red cycle, the dependencies of the vectorization were removed, load operations into memory were optimized, the sizes of vectors and arrays were adapted for Intel Xeon Phi and AVX-512 instructions.</i>  <i>Performance increased to 190 GFLOPS, i.e., about 200 times.</i>  <i>Now it is above the DRAM limit and is most likely limited by L2 cache characteristics.</i> <br><br><h2>  <font color="#0071c5">Result</font> </h2><br>  So, after all the improvements and optimizations, the team achieved a performance of 190 GFLOPS with an arithmetic intensity of 0.3 FLOP / b, 100% utilization and a memory bandwidth of 573 GB / s. <br><br><img src="https://habrastorage.org/webt/nv/gf/bu/nvgfbuvc9a7cdx0ej1vwh3m56ao.png"><br>  <i>Fragment of optimized code</i> </div><p>Source: <a href="https://habr.com/ru/post/451716/">https://habr.com/ru/post/451716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../45170/index.html">iPhone updated to version 2.2</a></li>
<li><a href="../451702/index.html">As we with Stas plant for 2 months automated</a></li>
<li><a href="../451704/index.html">Swift under the hood: Generic implementation</a></li>
<li><a href="../451708/index.html">How to prepare for the ILV verification of personal data: a complete guide</a></li>
<li><a href="../451710/index.html">Internet for summer resident. We get the maximum speed in 4G networks. Part 2. Selecting an external antenna.</a></li>
<li><a href="../451718/index.html">Creating a voice assistant</a></li>
<li><a href="../451720/index.html">Loading FIAS in DB on MSSQLSERVER with improvised (SQLXMLBULKLOAD) means. How it (probably) does not need to do</a></li>
<li><a href="../451724/index.html">Skyrmion skyrmion discord: three-dimensional polar skyrmions in ferroelastics</a></li>
<li><a href="../451726/index.html">Looking for a job abroad: 7 simple tips for IT specialists</a></li>
<li><a href="../451738/index.html">A brief review of the article "DeViSE: A Deep Visual-Semantic Embedding Model"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>