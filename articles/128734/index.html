<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ARM Microcontrollers STM32F. Quick start with STM32-Discovery</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When studying  any unfamiliar business, especially when it comes to microcontrollers, the question arises - "Where to start." Articles are being searc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ARM Microcontrollers STM32F. Quick start with STM32-Discovery</h1><div class="post__text post__text-html js-mediator-article">  When studying <img align="right" src="https://habrastorage.org/getpro/geektimes/post_images/a9e/e06/25c/a9ee0625c96e8b5f5f26cd36adc95fcb.jpg" alt="image">  any unfamiliar business, especially when it comes to microcontrollers, the question arises - "Where to start."  Articles are being searched for the keywords ‚ÄúGetting Started,‚Äù inevitably there is a dilemma for choosing a development environment and a programmer-debugger.  To help you determine the answers to your questions, I will share my experience in mastering 32-bit controllers of the STM32F family from ST Microelectronics. <br><br><h4>  Controller selection </h4><br>  There were essentially two options - STM32F or NXP (LPC1xxx).  On the STM32F microcontrollers, my choice fell for several reasons. <a name="habracut"></a><br><br>  First, the cheap STM32VL-Discovery debug board.  Some of you, who are engaged in electronics, have probably managed to snatch <a href="http://habrahabr.ru/blogs/DIY/112452/">free Discovery</a> , which is distributed for free when participating in a competition from EBV-Electronik.  Those who did not have time to submit an application or did not know at all about such an opportunity are not upset - the fee costs about 500 rubles.  The price is more than affordable. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Secondly, the controllers themselves are pretty cheap.  The simplest stone STM32F100C4T6 with 16 kilobytes on board costs <b>less than 40 rubles</b> (!), While doing so on the characteristics and peripherals of any ‚ÄúMega‚Äù, which, by the way, still costs more.  The price of the stones of the older line with USB hardware (STM32F103) is also quite humane, about 120 rubles. <br><br>  Thirdly, controllers are actively beginning to gain interest from electronics engineers, articles on the development of the STM32 appear on the Internet one after another.  If it goes on like this, popularity may well reach the level of Atmel controllers. <br><br> <a href=""><img align="left" src="https://habrastorage.org/getpro/geektimes/post_images/a54/b7e/77e/a54b7e77e5405b44da743401ca7ed351.jpg" alt="LQFP48"></a>  The only disadvantage compared to the same Atmel for the radio amateur is the small case.  About DIP you can forget.  The only available case is the <b>LQFP with 0.5 mm pitch legs</b> .  Nevertheless, it is not difficult to make a fee with a certain skill (we have already <a href="http://habrahabr.ru/blogs/controllers/125994/">read</a> about this), so I do not consider a small package a minus.  The photo on the left is my board for the LQFP48 case. <br><br>  A few words about the STM32VL-Discovery debug board: onboard it has the ST-Link programmer-debugger and the STM32F100RBT6 controller (target) controller (128 kb flash, 8 kb operative).  All pins are separated to pins, there are two LEDs and a button.  The SWD connector of the debugger is brought out, so the board can also be used as an ordinary ST-Link.  This is good for us, you do not need to buy a programmer. <br><br><h4>  Choosing a development environment </h4><br>  Here is not so simple, as with atmelovskoy AVR Studio.  There are several options: <br><ul><li>  <a href="http://www.iar.com/">IAR</a> .  A commercial.  Restriction on the amount of executable code.  Nafig </li><li>  <a href="http://www.keil.com/">Keil</a> .  Same.  Nafig </li><li>  <a href="http://www.atollic.com/index.php/truestudio">Atollic TrueStudio</a> .  Based on Eclipse, but nonetheless commercial.  In the free Lite-version there is no limit on the amount of code, but ‚ÄúBuy a PRO version‚Äù advertisement regularly pops up.  Nafig </li><li>  Clean <a href="http://eclipse.org/">Eclipse</a> with ARM plugin and ARM-GCC compiler.  Like here it is, cross-platform happiness, but from nowhere an even more suitable candidate appears: </li><li>  <b><a href="http://coocox.org/CooCox_CoIDE.htm">CooCox IDE</a> (CoIDE).</b>  Also based on Eclipse, but free.  It includes everything to work with ARM, allows you to download the necessary libraries without departing from the cash register.  It knows how to work with various debuggers (although not with ST-Link, but this costs the GNU Debugger installation).  The only negative - the assembly is only under Windows.  Linukssyatnikam have to put Eclipse and tune it with his hands.  As usual.  Well, nothing, we are not used to. </li></ul>  Well, my choice is made.  You can challenge it, offer to write in a notebook, compile with makefiles or even stop at commercial decisions, speaking against the sacred GCC.  But personally, I think CoIDE is just an ideal development environment, at least for a quick start.  Start with her.  And there it will be seen. <br><br><h4>  Actually, Getting Started! </h4><br>  So, we will need: <br><ol><li>  STM32VL Discovery Board </li><li>  Utility STM32 ST-Link Utility </li><li>  CoIDE development environment of the latest version (currently 1.3.0). </li></ol>  Launch CoIDE.  We are kindly offered to choose the manufacturer of the controller, then the chip itself.  Select <b>STM32F100RBT6</b> , it is he who is on Discovery.  Next, we see the page for selecting the link libraries, which played a decisive role in choosing the development environment: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/9d3/a3e/f90/9d3a3ef903331538e9f2e6d8ebbd08e0.png" alt="Coide"><br><br>  There is a CMSIS library for the ARM Cortex M3 core, and an STM32 Peripheral Library (a library for working with peripherals from ST Microelectronics), as well as CooCox‚Äôs own designs for the selected microcontroller.  We need only tick the required libraries and the trick is done.  For the simplest LED blinker ‚Äî namely, ‚ÄúHello World‚Äù on microcontrollers ‚Äî we need CMSIS Core, CMSIS Boot, RCC (peripheral clock control) and GPIO (general-purpose I / O port control). <br><br>  Without further explanation I will write the code of the simplest program: <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stm32f10x.h&gt; #include &lt;stm32f10x_conf.h&gt; #include &lt;stm32f10x_rcc.h&gt; #include &lt;stm32f10x_gpio.h&gt; void Delay(volatile uint32_t nCount) { for (; nCount != 0; nCount--); } int main(void) { /* SystemInit()   startup_stm32f10x_md_vl.c */ GPIO_InitTypeDef GPIO_InitStructure; RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOC , ENABLE); GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9; GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP; GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; GPIO_Init( GPIOC , &amp;GPIO_InitStructure); while (1) { GPIOC-&gt;ODR |= GPIO_ODR_ODR9; Delay(0x1FFFF); GPIOC-&gt;ODR &amp;= ~GPIO_ODR_ODR9; Delay(0x7FFFF); } return 0; }</span></span></span></span></code> </pre> <br><br>  We compile (F7), we observe the executable files appeared in the Debug directory - bin, hex, elf. <br><br><h5>  Controller firmware </h5><br>  We have prepared the program, now we will be busy loading it into the chip.  We connect the board (I will not explain the driver installation), run the ST-Link Utility.  The controller in Discovery is connected via SWD, so the first thing to do is to switch the mode of the programmer-debugger from JTAG to SWD: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/7fa/c6a/7ab/7fac6a7ab0fb72df6e6fd1b6c6baaf09.png" alt="image"><br><br>  Then everything is transparent: menu Target -&gt; Program &amp; Verify ... select the file hex, click Program and the firmware is completed.  It remains only to press the Reset button on the Discovery board - the one with the black cap - and enjoy the blinking LED. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/57e/44d/2c6/57e44d2c6468375c057ffdc5d7c3eddc.jpg" alt="image"><br><br>  Congratulations.  Your first program is written, compiled, flashed into a chip and works successfully.  A start has been made, and then it's up to you: we climb into the template code, as usual we change something, we supplement, we study new peripheral devices, we connect new libraries.  And do not forget to read the Reference Manual, there is a lot of useful information. <br><br>  <i>Update: Starting from version 1.3.0, the CooCox IDE development environment <b>supports ST-Link</b> , so programming and debugging can be done directly from CoIDE, without using the ST-Link Utility.</i>  <i>Selecting an adapter through the menu Debug -&gt; Debug Configuration (ST-Link, port SWD).</i>  <i>Download the program to the controller via the menu Flash -&gt; Program Download.</i> <br><br>  That's all.  I wish you success in the development of ST Microelectronics microcontrollers. <br><br><h5>  Useful resources on the topic </h5><ul><li>  My <a href="http://we.easyelectronics.ru/STM32/rukovodstvo-k-bystromu-startu-po-rabote-s-periferiey-stm32f10x.html">article on STM32 peripherals</a> .  Teach you the method of studying the periphery.  I recommend reading. </li><li>  <a href="http://embedded.su/arm/2010/12/15/nastroyka-svyazki-eclipse-i-arm-gcc-v-linux.html">Setting up the Eclipse bundle + ARM-GCC</a> .  It is recommended to read in order for you to know what CoIDE is doing <i>for you</i> . </li><li>  <a href="http://bsvi.ru/obzor-dokumentacii-stm32/">Video review of</a> STM32 controller <a href="http://bsvi.ru/obzor-dokumentacii-stm32/">documentation</a> .  It will help you figure out how and where to look for documentation on the controller. </li><li>  <a href="http://www.st.com/STM32VL-Discovery">STM32VL-Discovery</a> on ST Microelectronics.  Manual, scheme, drivers, ST-Link Utility and everything else that relates to the board. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/128734/">https://habr.com/ru/post/128734/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128728/index.html">Results scandalous IFA2011: the queue for pills</a></li>
<li><a href="../128729/index.html">$ 99 TouchPad - Available September 28 (for HP employees)</a></li>
<li><a href="../128730/index.html">A modest interview guide: part 2</a></li>
<li><a href="../128732/index.html">Mass manifestations of "Wi-Fi allergy" in America</a></li>
<li><a href="../128733/index.html">Budget Nettop as HTPC</a></li>
<li><a href="../128736/index.html">Helping about .SUshiki</a></li>
<li><a href="../128737/index.html">The problem of 3D particles in After Effects</a></li>
<li><a href="../128740/index.html">The peculiarity of working with smart points in Qt</a></li>
<li><a href="../128741/index.html">Hiding, obfuscating and crypting the client side of web applications</a></li>
<li><a href="../128742/index.html">VPN over L2TP: error 678 - one small registry key</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>