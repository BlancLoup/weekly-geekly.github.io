<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>TCP Congestion Control or Why speed jumps</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 Have you ever had such a thing that you put a file on a download, and the speed slowly but surely increases, then, at some point, decreases ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>TCP Congestion Control or Why speed jumps</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br><br>  Have you ever had such a thing that you put a file on a download, and the speed slowly but surely increases, then, at some point, decreases sharply, then increases again?  Downloading a file in one stream does not provide the full speed of the channel?  Start a torrent client, and ping in the game jumps heavily?  Do you use a 3G modem (or another line with relatively large packet loss) and can not tolerate it? <br>  Surely you blamed your router or blamed your provider for the shaper setting curve?  This affects, but they are not to blame. <br>  So, meet: <br><br><h4>  TCP Congestion Control, or TCP Congestion Avoidance Algorithm. </h4><a name="habracut"></a><br><h4>  What it is? </h4><br>  In short, the algorithms that are trying to do everything possible to ensure the fastest data transfer rate between two nodes that transmit data via TCP.  They control the size of TCP windows and can be guided by RTT (Round Trip Time - the time from sending a request to receiving a response), the loss of packets, the waiting time for sending a packet from a queue, etc.  Each algorithm behaves differently in this or that situation and there is no universal one. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For a long time, Reno algorithms, developed in 1990, and BIC were in use.  The first was used in all Windows operating systems before XP, and the second in Linux up to 2.6.18.  Then, in Windows Vista, the new Compound TCP algorithm appeared, and in Linux they changed BIC to Cubic. <br><br><h4>  What are the algorithms? </h4><br>  There are a lot of them.  In the Linux 3.7 kernel there are: <br><ul><li>  BIC TCP </li><li>  CUBIC TCP </li><li>  Highspeed tcp </li><li>  H-TCP </li><li>  TCP Hybla </li><li>  TCP Illinois </li><li>  TCP Low Priority </li><li>  TCP Vegas </li><li>  TCP NewReno </li><li>  TCP Veno </li><li>  TCP Westwood + </li><li>  YeAH-TCP </li></ul><br>  BIC, CUBIC, Highspeed, H-TCP, NewReno, Illinois - these algorithms are designed for the so-called long fat networks - long (and therefore high RTT) and fast networks.  TCP Hybla behaves well on satellite links, and Veno is designed for high packet loss wireless networks.  TCP Low Priority is generally difficult to call the congestion algorithm, since  it does little, but simply tries to send a packet without a queue, TCP Vegas is sometimes used on servers with a large number of connections, because  it provides almost constant speed, although far from ideal.  Westwood + is a combined algorithm, YeAH-TCP is the youngest of them, but the most interesting, because  behaves more or less in all cases. <br>  More details about the algorithms themselves can be found in the <a href="http://habrahabr.ru/post/161499/">post</a> <a href="https://habrahabr.ru/users/casperrr/" class="user_link">casperrr</a> <br><br><h4>  3G test </h4><br>  Unfortunately, CUBIC, which is used by default in all distributions, is completely inappropriate, for example, for 3G connections.  Below is a graph comparing 4 congestion avoidance algorithms for HSDPA networks for the end of 2012 from <a href="">TCP Congestion Control over HSDPA: an Experimental Evaluation</a> : <br><img src="https://habrastorage.org/getpro/habr/post_images/e92/a5e/0fb/e92a5e0fbfdd45b72ebd74ee8c6466ef.png" alt="image"><br><br>  As you can see, CUBIC is lagging behind.  It has significantly increased RTT on the full utilization of the 3G channel, while Westwood + and NewReno are more or less coping with this problem. <br>  Let's take a look at the number of retransmissions: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b0b/211/f02/b0b211f02130288a42e0dc432bee83af.png" alt="image"><br><br>  As you can see from the graph, CUBIC has a relatively large number of retransmissions. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/805/e17/2aa/805e172aafb49a3b05b339d02e598a04.png" alt="image"><br><br>  At the same time, it leads the data transfer rate per unit of time. <br><br>  What does it mean?  This means that using Westwood + or NewReno you can more comfortably surf the Internet while you are downloading a large file. <br><br><h4>  WiMAX and WiFi channels test </h4><br>  The test is taken from the <a href="http://www.hindawi.com/journals/jcnc/2012/806272/">Comparative Performance Evaluation of the VMAs in WiMAX (and WLANs) Network Configurations</a> - another interesting comparison of algorithms for wireless networks. <br><br>  In test # 1, a computer-wimax.rother-wimax.client connection is used with a bandwidth between a computer and a 100 Mbps router and a RTT of 45 ms and a DL: UL ratio of 1: 1 between the wimax router and client. <br>  Dependence of effective data transfer on packet loss: <br><img src="https://habrastorage.org/getpro/habr/post_images/aed/1d4/d48/aed1d4d480366a904cf94a6f3977b383.png" alt="image"><br><br>  Slightly change the test.  In test number 2, the computer-router1-router2-wimax.router-wimax.client scheme is used, where the RTT is 10 ms.  between the computer and the first router, then a 10 Mbps channel with 25 ms is used.  RTT, between the second and wimax router, the channel is again 100 Mb / s with RTT at 10 ms. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/979/5b3/66f/9795b366f86ee8ecf9bc38c22f4c6f31.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/f2b/1d3/197/f2b1d3197988a5685917de488e037662.png" alt="image"><br><br>  As can be seen from the graphs, Westwood holds the lead. <br>  The picture for WiFi is similar to WiMAX: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d6e/df0/31c/d6edf031cb808b3b36ae80c35e09cf69.png" alt="image"><br><br><h4>  High Speed ‚Äã‚ÄãChannel Test </h4><br>  This test is taken from the <a href="http://infocom.uniroma1.it/~vacirca/yeah/yeah.pdf">technical report of the YeAH-TCP algorithm</a> for 2006.  Theoretically, YeAH is the most advanced algorithm and aims to work as best as possible on high-speed lines, on lines with high latency or high packet loss. <br>  Tests were done using a channel bandwidth of 500 mbit / s <br><br>  YeAH leads in efficient data transfer based on RTT <br><img src="https://habrastorage.org/getpro/habr/post_images/04a/b40/0f8/04ab400f8ebc5cd8b858692568c9b5ec.png" alt="image"><br><br>  Dependence of effective data transfer and packet loss, again YeAH ranks first <br><img src="https://habrastorage.org/getpro/habr/post_images/57b/2d1/a77/57b2d1a7704d93578b6f6736deb1d9d3.png" alt="image"><br><br>  Unfortunately, there are some problems with YeAH on the kernel 3.7, after a while it weighs the software interrupt system.  This behavior is not observed at 3.6. <br><br><h4>  How to change? </h4><br>  Changing the Congestion Algorithm is quite simple, just one line: <br> <code>sysctl -w net.ipv4.tcp_congestion_control=westwood</code> <br>  Where instead of westwood you can insert titles from /lib/modules/.../kernel/net/ipv4/tcp_....ko without the tcp_ prefix. <br><br><h4>  Instead of conclusion </h4><br>  On channels like home wifi, I recommend using Westwood or H-TCP.  For wired channels, YeAH can be a good choice (if you are not experiencing problems with it), H-TCP or Illinois. <br><br>  Some tips.  If you already have a 3.6+ kernel, be sure to enable net.ipv4.tcp_fastopen.  This will not add any problems with incompatible servers, and handshake for supported ones will speed up. <br>  I also recommend setting net.ipv4.tcp_slow_start_after_idle to 0, this will add speed for SPDY and other keep-alive connections. </div><p>Source: <a href="https://habr.com/ru/post/168407/">https://habr.com/ru/post/168407/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168391/index.html">Do not be fooled by your customers.</a></li>
<li><a href="../168393/index.html">Soloten told about mobile technologies in MIRBIS</a></li>
<li><a href="../168397/index.html">CES Results: Samsung New Audio Systems at the International Consumer Electronics Show</a></li>
<li><a href="../168399/index.html">An example of accelerating calculations in R by multithreading</a></li>
<li><a href="../168401/index.html">Update for Nokia 808 PureView: sending photos to Twitter from Gallery</a></li>
<li><a href="../168409/index.html">Atom Quartet. Solution for optimal placement of cheap computers in the rack</a></li>
<li><a href="../168411/index.html">Tablet is not a luxury</a></li>
<li><a href="../168413/index.html">Component for integrating Ext.grid.Panel lines with Ext.toolbar.Toolbar</a></li>
<li><a href="../168417/index.html">Found 48th Mersenne prime</a></li>
<li><a href="../168419/index.html">How many English words do you know?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>