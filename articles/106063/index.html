<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Data synchronizer Developer note</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At work and in everyday life, we often have to deal with various kinds of data synchronization . You synchronize files and folders of your phone with ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Data synchronizer Developer note</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/01c980b0/956ce1e5/031e339b/e1e502ef.png" align="left">  At work and in everyday life, we often have to deal with various kinds of <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D1%2585%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F_%2528%25D0%25B8%25D0%25BD%25D1%2584%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D1%2582%25D0%25B8%25D0%25BA%25D0%25B0%2529">data synchronization</a> .  You synchronize files and folders of your phone with a computer, perform familiar actions in version control systems, use various kinds of Internet-based synchronization services for contacts, emails and documents, and often do not even think about how this process is implemented in one way or another. <br><br>  If you decide to write your own synchronizer, you will most likely encounter a number of questions.  In this article we will share the experience of writing such a component and consider the requirements for it.  The basis of these requirements were all sorts of wishes we received from users, and real scenarios for using the <a href="http://devexpress.com/XtraScheduler">XtraScheduler</a> scheduler event synchronizer.  Therefore, as examples of the code, we will provide code fragments from the specified product. <br><a name="habracut"></a><br>  To begin with, we will determine which objects will participate in the synchronization process. <br>  These are two data sets (source and target / final) and a synchronizer that performs a series of operations on these sets, as a result of which the target set must change in accordance with the implemented scenario. <br><br><h5>  Object synchronizer </h5><br>  The synchronization script will determine what functionality your synchronizer will have.  If synchronization implies only one ‚Äúmain‚Äù copy and will be performed by complete replacement of the contents of the other, then a simple version of the type of importer / exporter will do.  If you plan to synchronize sets of independent entries, you will have to make a more complex implementation of the synchronizer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Base class </h5><br>  Create a base synchronizer class that defines the behavior common to all successors and the interface of methods, properties, and events.  Let's call such a class, for example, SynchronizerBase.  Such a class can define a strictly defined order of abstract method calls for performing the basic necessary synchronization actions in the desired sequence.  The functionality will be expanded by inheritance.  Having a base class will free you from code duplication.  General operations such as initializing internal structures and properties can be implemented once in this class. <br><br>  An additional advantage of this approach will be the fact that you get a single, harmonious API for all successors that are subsequently implemented. <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SynchronizerBase</span></span> { <span class="hljs-comment"><span class="hljs-comment">//... protected SynchronizerBase(StorageBase storage) {...} public event ExchangeExceptionEventHandler OnException; protected internal abstract void SynchronizeCore(); public virtual void Terminate() {...} public virtual void Synchronize() { Storage.BeginUpdate(); try { ResetTermination(); SynchronizeCore(); } finally { Storage.EndUpdate(); } } }</span></span></code> </pre> <br><br><h5>  Segregation of duties </h5><br>  Depending on the scenarios of working with data sets, you can implement the corresponding heirs of SynchronizerBase, who ‚Äúcan‚Äù perform the sequence of actions laid down in the scenario, knowing in advance which set is the ‚Äúmain‚Äù one.  Such specialized classes will be much easier to use than setting up and using the only one, but "who can do everything at once." <br><br>  Thus, you can create several inheritors, for example, ImportSynchronizer and ExportSynchronizer, which implement the basic synchronization logic for each of the scenarios.  These classes can remain abstract if in the future you plan to implement their concrete heirs for different data sets. <br><br>  For example, in <a href="http://devexpress.com/XtraScheduler">XtraScheduler</a> we have the following base class scheme: <br><br><img src="https://habrastorage.org/storage/7c9d1669/63823925/cff2c308/1426d040.png"><br><br><h5>  Allocation of algorithms to subclasses </h5><br>  In order not to make the synchronizer object too heavy, it makes sense to organize the architecture by separating the implementation of the synchronization algorithm from the synchronizer interface itself.  Select a subclass in the class synchronizer, while not forgetting to establish interaction between these objects. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ImportSynchronizeManager</span></span> : <span class="hljs-title"><span class="hljs-title">ImportManager</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ImportSynchronizeManager</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AppointmentExchanger synchronizer</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">synchronizer</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PerformExchange</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Appointments.BeginUpdate(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { PrepareSynchronization(); SynchronizeAppointments(); DeleteNonSynchronizedAppointments(); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { Appointments.EndUpdate(); } } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ExportSynchronizeManager</span></span> : <span class="hljs-title"><span class="hljs-title">ExportManager</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExportSynchronizeManager</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AppointmentExchanger synchronizer</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">synchronizer</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PerformExchange</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { PrepareSynchronization(); SynchronizeOutlookAppointments(); CreateNewOutlookAppointments(); } }</code> </pre> <br><br><h5>  Operations on dataset objects </h5><br>  Depending on the synchronization scenario, data sets can be modified in different ways.  But, as a rule, all actions with objects of sets are reduced to three main actions: <br><ul><li>  create a new copy of the object on the target set based on the object from the source data set; </li><li>  update the corresponding object in the target set with changes to the object in the source set; </li><li>  remove the "extra" objects on the target set that are not in the source. </li></ul><br>  All operations described above can be reduced to the following table: <br><br><img src="https://habrastorage.org/storage/5068b521/77e9c5b9/ac24d021/e87a1de1.png"><br><br>  The described actions should be implemented in one form or another in each of the heirs of your synchronizer.  At the same time, it is necessary to take into account an important point, which copy of the data is considered to be ‚Äúmain‚Äù.  Depending on the choice of source and target sets may be interchanged.  That is why the ImportSynchronizer and ExportSynchronizer classes will perform the opposite actions on data sets. <br><br><h5>  Event support </h5><br>  Undoubtedly, when performing any action on set objects, the user will want to be able to get access to these objects ‚Äúbefore‚Äù and ‚Äúafter‚Äù the operation.  Arrange a pair of Synchronizing and Synchronized events in the base class. <br><br>  Define the SynchronizingEventArgs and SynchronizedEventArgs event handler arguments and add the fields and properties for the corresponding objects from the synchronized sets.  In the case when in the base class it cannot be done immediately, use the inheritance of the arguments and make the missing properties in the heirs. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppointmentEventArgs</span></span> : <span class="hljs-title"><span class="hljs-title">EventArgs</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AppointmentEventArgs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Appointment apt</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Appointment Appointment { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { ... } } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppointmentCancelEventArgs</span></span> : <span class="hljs-title"><span class="hljs-title">AppointmentEventArgs</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AppointmentCancelEventArgs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Appointment apt</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">apt</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> Cancel { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { ... } } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AppointmentSynchronizingEventArgs</span></span> : <span class="hljs-title"><span class="hljs-title">AppointmentCancelEventArgs</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AppointmentSynchronizingEventArgs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Appointment apt</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">apt</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> SynchronizeOperation Operation { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { ... } } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OutlookAppointmentSynchronizingEventArgs</span></span> : <span class="hljs-title"><span class="hljs-title">AppointmentSynchronizingEventArgs</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OutlookAppointmentSynchronizingEventArgs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Appointment apt, _AppointmentItem olApt</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">apt</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> _AppointmentItem OutlookAppointment { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { ... } } }</code> </pre> <br><br>  Consider the need for an exception handling event.  For example, you can implement the OnException event and redirect the exceptions received there.  Let the user decide whether to continue the synchronization process after an exception occurs.  Complete the event arguments with all the necessary information. <br><br><pre> <code class="cs hljs">iCalendarImporter importer; <span class="hljs-comment"><span class="hljs-comment">//... importer.OnException += new ExchangeExceptionEventHandler(importer_OnException); void importer_OnException(object sender, ExchangeExceptionEventArgs e) { iCalendarParseExceptionEventArgs args = e as iCalendarParseExceptionEventArgs; if (args != null) { ShowErrorMessage(String.Format("Cannot parse line {0} with text '{1}'", args.LineIndex, args.LineText)); } else ShowErrorMessage(e.OriginalException.Message); e.Handled = true; // prevent this exception from throwing } }</span></span></code> </pre> <br><br><h5>  Data integrity </h5><br>  Support for the performance of each operation on the objects set the ability to cancel.  This can be done by adding the Cancel property to the arguments of the SynchronizingEventArgs event. <br><br>  Be sure that this will be useful for executing the ‚Äúmerging‚Äù script of two independent data sets, when it makes sense to cancel <b>all</b> deletion operations when synchronizing first, first one way and then the other. <br><br><pre> <code class="cs hljs">AppointmentImportSynchronizer synchronizer; <span class="hljs-comment"><span class="hljs-comment">//... synchronizer.AppointmentSynchronizing += new AppointmentSynchronizingEventHandler(synchronizer_AppointmentSynchronizing); void synchronizer_AppointmentSynchronizing(object sender, AppointmentSynchronizingEventArgs e) { // ... if (ShouldCancelOperation) e.Cancel = true; }</span></span></code> </pre> <br><br><h5>  Cover all object manipulation scenarios </h5><br>  Provide a situation not only to cancel the proposed "default" action on the object, but also to give the opportunity to perform another possible operation. <br><br>  For example, add the additional property SynchronizeOperation {Create, Replace, Delete} to the arguments and let the user specify the desired value.  This way, you will be able to delete the object on the target data set instead of replacing it with a copy from the source set. <br><br>  Such an approach makes it possible to more accurately handle ‚Äúedit conflicts‚Äù in data sets. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">synchronizer_AppointmentSynchronizing</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, AppointmentSynchronizingEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (e.Operation) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> SynchronizeOperation.Replace: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ShouldDeleteInsteadReplace.Checked) e.Operation = SynchronizeOperation.Delete; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre><br><br><h5>  UI Elements </h5><br>  Try to design a synchronizer so that it does not use the issuance of messages, dialogs and other visual elements.  Because there is always a user who needs to use your component, performing synchronization in a stream created from an application or, for example, from a special service. <br><br><h5>  Data caching </h5><br>  Sometimes it makes sense to load a dataset, saving its objects in the synchronizer.  This makes sense when it is desirable to avoid repeated calls to a real data set.  In addition, during synchronization, the target data set may change, which can potentially manifest itself in problems associated with iteration over this set from the synchronizer code. <br><br><h5>  Parameterization of the data set </h5><br>  Sooner or later, the user will want to synchronize not the entire set, but only a part of it, limited, for example, by a time interval or a specific parameter. <br><br>  The solution will be to write the source data provider with the ability for the user to ‚Äúslip‚Äù his own provider, which determines his logic.  In this case, the synchronizer should receive data not directly, but through the provider.  In this case, you will have to use the above data caching inside the synchronizer. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoFilteredImport</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { OutlookImport importer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OutlookImport(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.schedulerStorage1); TimeInterval interval = CalculateCurrentWeekInterval(); ParameterizedCalendarProvider provider = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ParameterizedCalendarProvider(interval); importer.SetCalendarProvider(provider); importer.Import(System.IO.Stream.Null); }</code> </pre> <br><br><h5>  Process completion </h5><br>  Provide the ability to complete the synchronization process as desired by the user.  For example, get the Terminate method in the SynchronizerBase base class.  Such a function can be useful when an exception has occurred during synchronization of large data sets or the collection object does not satisfy certain conditions and it is necessary to immediately stop further execution.  In this case, the user will not have to wait until the end of the process. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">synchronizer_OnException</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, ExchangeExceptionEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ... AppointmentImportSynchronizer synchronizer = (AppointmentImportSynchronizer)sender; synchronizer.Terminate(); e.Handled = true; }</span></span></code> </pre> <br><br><h5>  Extensibility </h5><br>  It may happen that the user wants to synchronize properties other than those that your component synchronizes.  Provide the ability to define this at the level of setting custom properties or objects and provide all the necessary API for this. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exporter_AppointmentExporting</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, AppointmentExportingEventArgs e</span></span></span><span class="hljs-function">)</span></span> { iCalendarAppointmentExportingEventArgs args = e <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> iCalendarAppointmentExportingEventArgs; AddEventAttendees(args.VEvent, ‚Äútest@corp.com‚Äù); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddEventAttendee</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">VEvent ev, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> address</span></span></span><span class="hljs-function">)</span></span> { TextProperty p = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TextProperty(<span class="hljs-string"><span class="hljs-string">"ATTENDEE"</span></span>, String.Format(<span class="hljs-string"><span class="hljs-string">"mailto:{0}"</span></span>, address)); p.AddParameter(<span class="hljs-string"><span class="hljs-string">"CN"</span></span>, address); p.AddParameter(<span class="hljs-string"><span class="hljs-string">"RSVP"</span></span>, <span class="hljs-string"><span class="hljs-string">"TRUE"</span></span>); ev.CustomProperties.Add(p); }</code> </pre> <br><br>  Allow users to inherit from your synchronizer to override any functionality.  Provide this when designing classes and methods. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyOutlookImportSynchronizer</span></span> : <span class="hljs-title"><span class="hljs-title">OutlookImportSynchronizer</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyOutlookImportSynchronizer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SchedulerStorageBase storage</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">storage</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> OutlookExchangeManager </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateExchangeManager</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyExchangeManager(); } }</code> </pre> <br><br><h5>  Helper classes </h5><br>  Create methods for getting synchronizer initialization parameters (for example, a directory pointing to a specific calendar) or any other information necessary for synchronization.  For more convenient use, place them in separate auxiliary classes or make them available directly in the component. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OutlookExchangeHelper</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetOutlookCalendarNames</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetOutlookCalendarPaths</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> ; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> List&lt;OutlookCalendarFolder&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetOutlookCalendarFolders</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OutlookUtils</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> _<span class="hljs-function"><span class="hljs-function">Application </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetOutlookApplication</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReleaseOutlookObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> obj</span></span></span><span class="hljs-function">)</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">iCalendarConvert</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> TimeSpan </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToUtcOffset</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FromUtcOffset</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TimeSpan </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> ; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnescapeString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> str</span></span></span><span class="hljs-function">)</span></span>; }</code> </pre> <br><br>  We really hope that the above ‚Äúcollection of tips‚Äù will help you best determine the amount of functionality you need before writing a synchronizer and provide an opportunity to avoid mistakes in the process of its implementation. </div><p>Source: <a href="https://habr.com/ru/post/106063/">https://habr.com/ru/post/106063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../106049/index.html">Alexey Komissarov - Head of the Business Incubator of the Academy of National Economy</a></li>
<li><a href="../106055/index.html">Kevin Nilsen speaking at Code Camp 2010</a></li>
<li><a href="../106057/index.html">A few words about hybrid encryption and elliptic curves</a></li>
<li><a href="../106059/index.html">Microsoft announces software to synchronize Windows Phone 7 devices with Macs</a></li>
<li><a href="../106061/index.html">Caution - unauthorized traffic!</a></li>
<li><a href="../106064/index.html">USA</a></li>
<li><a href="../106066/index.html">Five favorite iPad apps for primary school</a></li>
<li><a href="../106067/index.html">Developing web applications in Common Lisp (part three)</a></li>
<li><a href="../106068/index.html">Developers, Developers, Developers! Direct broadcast of PDC 2010 in Moscow pub</a></li>
<li><a href="../106070/index.html">HTC does not give preference to WP 7 or Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>