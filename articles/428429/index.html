<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Electronic signature GOST R 34.10 PDF documents in the LibreOffice office suite</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is time, despite all the fires , to fulfill its civic duty - to pay taxes. We will pay taxes through the Gosuslugi portal. We will enter the person...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Electronic signature GOST R 34.10 PDF documents in the LibreOffice office suite</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ds/ly/0g/dsly0gpk3xho5hfte1ksa3pmprg.png" align="left">  It is time, despite all the <a href="https://habr.com/post/422539/">fires</a> , to fulfill its civic duty - to pay taxes.  We will pay taxes through the <a href="https://www.gosuslugi.ru/">Gosuslugi</a> portal.  We will enter the personal account of the portal of state services <a href="https://habr.com/post/334162/">with the help of an</a> electronic signature (the <a href="https://esia.gosuslugi.ru/idp/rlogin%3Fcc%3Dbp">terminology of the</a> portal of state services), i.e.  having a certificate obtained in an accredited certifying center (CA), and a private key.  Both of these are stored on the <a href="https://habr.com/post/316328/">PKCS # 11 token</a> with the support of Russian cryptography: <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/kb/hc/so/kbhcsojl7sh1w4rnu9au8johwje.png"><br><br>  And so, having fulfilled my civic duty, I decided to once again check the operation of the electronic signature in the office <a href="https%253A%252F%252Fru.libreoffice.org%252F%26usg%3DAOvVaw3gUVvWjAPjNT6ugqxNXFbE">libreoffice</a> package. <br><br>  Why did I decide to do this?  To access the <a href="https://www.linux.org.ru/news/mozilla/12799094">Government</a> services portal, I use the Linux OS and <a href="https://www.linux.org.ru/news/mozilla/12799094">the Redfox browser</a> , which is a Mozilla Firefox browser that has been modified to support Russian cryptography.  As you know, libreoffice office suite also uses NSS storage as <a href="https://habr.com/post/357692/">a certificate</a> store. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The Redfox-52 browser was installed in the / usr / local / lib64 / firefox-52 folder. <br><br>  To connect the NSS (Network Security Services) package libraries with GOST-algorithms support, set the value of the LD_LIBRARY_PATH variable as follows: <br><br><pre><code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$export</span></span> LD_LIBRARY_PATH=/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/lib64/firefox-52:<span class="hljs-variable"><span class="hljs-variable">$LD_LIBRARY_PATH</span></span> $</code> </pre> <br>  As a certificate store, libreoffice typically uses a certificate store from a Firefox browser, Thunderbird email client, or the Seamonkey integrated package.  Nothing prevents you from using the Google Chrome / Cromium browser certificate store or <a href="https://habr.com/post/335712/">creating</a> your own independent store (Tools-&gt; Options-&gt; Security-&gt; Certificate): <br><br><img src="https://habrastorage.org/webt/fu/we/8r/fuwe8rrzfjin4gzvntoag8itdfc.png"><br><br>  After the repository is selected, the libraries are connected, we start libreoffice, we create the file of the odt format and we try to sign it (File-&gt; Digital signatures-&gt; Digital signatures). <br><br>  Certificates in the Firefox / NSS repository are successfully displayed and verified: <br><br><img src="https://habrastorage.org/webt/se/ic/bn/seicbnhqivgte6wakn7kym63lck.png"><br><br>  However, the signature after selecting the certificate and clicking the ‚ÄúOK‚Äù button is not formed: <br><br><img src="https://habrastorage.org/webt/di/l0/id/dil0idhl4l_x4zetlzrdiguxkr8.png"><br><br>  It seems that libreoffice does not want to understand Russian cryptoalgorithms, despite the fact that NSS is used from the Redfox browser, which understands GOST-based algorithms, which is confirmed by the successful verification of certificates. <br><br>  We make a second attempt: this time we will try to sign a PDF file.  To do this, export the prepared document to PDF-format.  To sign a PDF file, of course, you need to download it (File-&gt; Digital Signature-&gt; Sign PDF).  After it is downloaded, we try to sign it (File-&gt; Digital Signatures-&gt; Digital Signatures) (see above, select a certificate, prescribe, for example, the purpose of signing a document): <br><br><img src="https://habrastorage.org/webt/s1/eg/wz/s1egwzum3-s8q8krjgljjl8xjo4.png"><br><br>  And the signature is formed !!!  We see that the signature, forming on the basis of the certificate "Test 12 512" with the key GOST R 34.10-2012 512 bits.  The signature is valid. <br><br>  Exit libreoffice.  Run libreoffice again, load the signed pdf-file, check the signatures.  All OK.  View signatories certificates.  All OK.  Miracles!  Signing PDFs works.  We put the second, third signature ... Everything works.  But something is haunted.  We do an additional check. <br><br>  Open the signed PDF file (I used the built-in editor from mc - Midnight Commander - a console file manager for Linux).  Find the electronic signature (/ Type / Sig /): <br><br><img src="https://habrastorage.org/webt/q3/kh/ja/q3khjadn38etedwmwo7jdmiyrhk.png"><br><br>  As you can see, the signature is stored in character hexadecimal.  Copy it and save it in a file.  To convert a file into a binary form (DER encoding), we use the xxd utility: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$xxd</span></span> ‚Äìp ‚Äìr &lt;    PDF&gt; &gt; &lt;&gt;.der $</code> </pre> <br>  The resulting file contains a detached PKCS # 7 format signature in DER-encoding.  Now this signature can be viewed with any asn1-prase, for example, the openssl utility.  But since we are talking about the NSS package, we will use the derdump <a href="https://habr.com/post/406037/">utility</a> or the <a href="https://habr.com/post/406037/">pp utility</a> : <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$pp</span></span> ‚Äìt p7 ‚Äìu ‚Äìi pkcs7_detach.p7 PKCS <span class="hljs-comment"><span class="hljs-comment">#7 Content Info: PKCS #7 Signed Data: Version: 1 (0x1) Digest Algorithm List: Digest Algorithm (1): SHA-256 Content Information: PKCS #7 Data: &lt;no content&gt; Certificate List: Certificate (1): Data: Version: 3 (0x2) Serial Number: 4107 (0x100b) Signature Algorithm: GOST R 34.10-2012 signature with GOST R 34.11-2012-512 Issuer: "E=ca_12_512@lissi.ru,OGRN=1234567890123,INN=1234 56789012,CN= 12_512,O= 12_512,L=GnuPG  -2012-512,ST= ,C=RU" Validity: Not Before: Sat Sep 08 07:17:56 2018 Not After : Tue Sep 12 07:17:56 2023 Subject: "C=RU,ST= ,CN=  ,SN=,givenName= ,E=xx@xx.ru,L= ,STREET=,INN=123456789012,SNILS=12345678901" Subject Public Key Info: Public Key Algorithm: GOST R 34.10-2012 512 Public Key: . . . Digest Encryption Algorithm: GOST R 34.10-2012 Key 512 Encrypted Digest: 34:9d:6f:37:e6:60:00:ed:fe:ef:f7:96:db:52:66:e1: 47:4c:5d:da:7f:9f:f3:20:50:ac:73:6c:97:db:f9:8d: 43:9b:8f:40:61:99:d3:4b:17:08:b8:34:e3:1e:92:76: b1:0c:dd:37:01:1e:2a:30:45:68:06:af:3d:33:5e:2f: 71:c8:17:b3:a9:8a:6b:2f:78:9e:e4:b2:00:59:6f:5a: a0:c5:9e:be:1e:4b:ca:d5:64:25:50:1a:6f:f9:55:b8: 3a:cf:37:a0:04:eb:89:b4:6c:39:77:27:92:de:61:c7: b1:d3:a5:2f:ef:66:9b:f5:71:42:77:0a:d2:10:7f:50 $</span></span></code> </pre> <br>  And then it became clear that not everything is so good.  Yes, the Digest Encryption Algorithm: GOST R 34.10-2012 Key 512 signature algorithm is in accordance with the certificate selected for signing, but the signature is generated from the hash calculated using the SHA-256 algorithm (Digest Algorithm (1): SHA-256).  And this is wrong from the point: the hash for GOST R 34.10-2012 Key 512 should be considered according to the algorithm GOST R 34.11-2012-512. <br><br>  Getting started and analyzing the source code of libreoffice: the devil is not so bad as he is painted.  In this article, we discuss the use of the NSS package for generating electronic signatures.  If someone prefers on the MS Windows platform to use CryptoAPI (and, accordingly, GOST-CSP), it can, by analogy with this material, make the appropriate refinement. <br><br>  Aniliz showed that the changes will have to make only two files: <br>  - <i>~ / libreoffice-5.3.7.2 / vcl / source / gdi / pdfwriter_impl.cxx</i> <br>  - <i>~ / libreoffice-5.3.7.2 / xmlsecurity / source / pdfio / pdfdocument.cxx</i> <br><br>  These changes are associated with the correct choice of hash functions for GOST certificates.  The choice of the hash function will be determined depending on the type of the certificate key.  Choosing a hash algorithm, for example, in PDFWriter :: Sign (pdfwriter_impl.cxx file) will look like this: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> PDFWriter::Sign(PDFSignContext&amp; rContext) { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> _WIN32 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* */</span></span></span><span class="hljs-meta"> SECKEYPublicKey *pubk = NULL; SECOidTag hashAlgTag; HASH_HashType hashType; int hashLen; CERTCertificate *cert = CERT_DecodeCertFromPackage(reinterpret_cast</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;char *&gt;(rContext.m_pDerEncoded), rContext.m_nDerEncoded); if (!cert) { SAL_WARN("vcl.pdfwriter", "CERT_DecodeCertFromPackage failed"); return false; } /*    */ pubk = CERT_ExtractPublicKey(cert); if (pubk == NULL) return NULL; /*   */ switch(pubk-&gt;keyType){ case gost3410Key: hashAlgTag = SEC_OID_GOSTHASH; hashType = HASH_AlgGOSTHASH; hashLen = SHA256_LENGTH; break; case gost3410Key_256: hashAlgTag = SEC_OID_GOST3411_2012_256; hashType = HASH_AlgGOSTHASH_12_256; hashLen = SHA256_LENGTH; break; case gost3410Key_512: hashAlgTag = SEC_OID_GOST3411_2012_512; hashLen = SHA256_LENGTH * 2; hashType = HASH_AlgGOSTHASH_12_512; break; default: hashAlgTag = SEC_OID_SHA256; hashType = HASH_AlgSHA256; hashLen = SHA256_LENGTH; break; } /* */ HashContextScope hc(HASH_Create(hashType)); . . . }</span></span></span></span></code> </pre> <br>  The remaining changes in logic are similar.  The patch for the file ~ / libreoffice-5.3.7.2 / vcl / source / gdi / pdfwriter_impl.cxx is located <br><br><div class="spoiler">  <b class="spoiler_title">here:</b> <div class="spoiler_text"><pre> <code class="diff hljs"><span class="hljs-comment"><span class="hljs-comment">--- pdfwriter_impl_ORIG.cxx 2017-10-25 17:25:39.000000000 +0300 +++ pdfwriter_impl.cxx 2018-10-31 19:48:32.078482227 +0300 @@ -6698,6 +6698,9 @@ CERTCertificate *cert, SECItem *digest) { + SECKEYPublicKey *pubk = NULL; + SECOidTag hashAlgTag; + NSSCMSMessage *result = NSS_CMSMessage_Create(nullptr); if (!result) { @@ -6732,8 +6735,31 @@ NSS_CMSMessage_Destroy(result); return nullptr; } - + pubk = CERT_ExtractPublicKey(cert); + if (pubk == NULL) + return NULL; + switch(pubk-&gt;keyType){ + case gost3410Key: + hashAlgTag = SEC_OID_GOSTHASH; +fprintf(stderr, "CreateCMSMessage: gost3410Key Use HASH_AlgGOSTHASH_=%d\n", hashAlgTag); + break; + case gost3410Key_256: + hashAlgTag = SEC_OID_GOST3411_2012_256; +fprintf(stderr, "CreateCMSMessage: gost3410Key_256 Use HASH_AlgGOSTHASH_=%d\n", hashAlgTag); + break; + case gost3410Key_512: + hashAlgTag = SEC_OID_GOST3411_2012_512; +fprintf(stderr, "CreateCMSMessage: gost3410Key_512 Use HASH_AlgGOSTHASH_=%d\n", hashAlgTag); + break; + default: + hashAlgTag = SEC_OID_SHA256; + break; + } +/* *cms_signer = NSS_CMSSignerInfo_Create(result, cert, SEC_OID_SHA256); +*/ + *cms_signer = NSS_CMSSignerInfo_Create(result, cert, hashAlgTag); + if (!*cms_signer) { SAL_WARN("vcl.pdfwriter", "NSS_CMSSignerInfo_Create failed"); @@ -6773,8 +6799,8 @@ NSS_CMSMessage_Destroy(result); return nullptr; } + if (NSS_CMSSignedData_SetDigestValue(*cms_sd, hashAlgTag, digest) != SECSuccess) - if (NSS_CMSSignedData_SetDigestValue(*cms_sd, SEC_OID_SHA256, digest) != SECSuccess) { SAL_WARN("vcl.pdfwriter", "NSS_CMSSignedData_SetDigestValue failed"); NSS_CMSSignedData_Destroy(*cms_sd); @@ -6982,6 +7008,10 @@ bool PDFWriter::Sign(PDFSignContext&amp; rContext) { #ifndef _WIN32 + SECKEYPublicKey *pubk = NULL; + SECOidTag hashAlgTag; + HASH_HashType hashType; + int hashLen; CERTCertificate *cert = CERT_DecodeCertFromPackage(reinterpret_cast&lt;char *&gt;(rContext.m_pDerEncoded), rContext.m_nDerEncoded); @@ -6990,8 +7020,33 @@ SAL_WARN("vcl.pdfwriter", "CERT_DecodeCertFromPackage failed"); return false; } + pubk = CERT_ExtractPublicKey(cert); + if (pubk == NULL) + return NULL; + switch(pubk-&gt;keyType){ + case gost3410Key: + hashAlgTag = SEC_OID_GOSTHASH; + hashType = HASH_AlgGOSTHASH; + hashLen = SHA256_LENGTH; + break; + case gost3410Key_256: + hashAlgTag = SEC_OID_GOST3411_2012_256; + hashType = HASH_AlgGOSTHASH_12_256; + hashLen = SHA256_LENGTH; + break; + case gost3410Key_512: + hashAlgTag = SEC_OID_GOST3411_2012_512; + hashLen = SHA256_LENGTH * 2; + hashType = HASH_AlgGOSTHASH_12_512; + break; + default: + hashAlgTag = SEC_OID_SHA256; + hashType = HASH_AlgSHA256; + hashLen = SHA256_LENGTH; + break; + } + HashContextScope hc(HASH_Create(hashType)); - HashContextScope hc(HASH_Create(HASH_AlgSHA256)); if (!hc.get()) { SAL_WARN("vcl.pdfwriter", "HASH_Create failed"); @@ -7005,15 +7060,18 @@ HASH_Update(hc.get(), static_cast&lt;const unsigned char*&gt;(rContext.m_pByteRange2), rContext.m_nByteRange2); SECItem digest; - unsigned char hash[SHA256_LENGTH]; + unsigned char hash[SHA256_LENGTH * 2]; + digest.data = hash; - HASH_End(hc.get(), digest.data, &amp;digest.len, SHA256_LENGTH); + HASH_End(hc.get(), digest.data, &amp;digest.len, hashLen); + hc.clear(); #ifdef DBG_UTIL { FILE *out = fopen("PDFWRITER.hash.data", "wb"); - fwrite(hash, SHA256_LENGTH, 1, out); + fwrite(hash, hashLen, 1, out); + fclose(out); } #endif @@ -7078,8 +7136,8 @@ fclose(out); } #endif + HashContextScope ts_hc(HASH_Create(hashType)); - HashContextScope ts_hc(HASH_Create(HASH_AlgSHA256)); if (!ts_hc.get()) { SAL_WARN("vcl.pdfwriter", "HASH_Create failed"); @@ -7090,16 +7148,19 @@ HASH_Begin(ts_hc.get()); HASH_Update(ts_hc.get(), ts_cms_signer-&gt;encDigest.data, ts_cms_signer-&gt;encDigest.len); SECItem ts_digest; - unsigned char ts_hash[SHA256_LENGTH]; + unsigned char ts_hash[SHA256_LENGTH * 2]; + ts_digest.type = siBuffer; ts_digest.data = ts_hash; - HASH_End(ts_hc.get(), ts_digest.data, &amp;ts_digest.len, SHA256_LENGTH); + HASH_End(ts_hc.get(), ts_digest.data, &amp;ts_digest.len, hashLen); + ts_hc.clear(); #ifdef DBG_UTIL { FILE *out = fopen("PDFWRITER.ts_hash.data", "wb"); - fwrite(ts_hash, SHA256_LENGTH, 1, out); + fwrite(ts_hash, hashLen, 1, out); + fclose(out); } #endif @@ -7111,7 +7172,8 @@ src.messageImprint.hashAlgorithm.algorithm.data = nullptr; src.messageImprint.hashAlgorithm.parameters.data = nullptr; - SECOID_SetAlgorithmID(nullptr, &amp;src.messageImprint.hashAlgorithm, SEC_OID_SHA256, nullptr); + SECOID_SetAlgorithmID(nullptr, &amp;src.messageImprint.hashAlgorithm, hashAlgTag, nullptr); + src.messageImprint.hashedMessage = ts_digest; src.reqPolicy.type = siBuffer; @@ -7340,11 +7402,13 @@ // Write ESSCertIDv2.hashAlgorithm. aCertID.hashAlgorithm.algorithm.data = nullptr; aCertID.hashAlgorithm.parameters.data = nullptr; - SECOID_SetAlgorithmID(nullptr, &amp;aCertID.hashAlgorithm, SEC_OID_SHA256, nullptr); + SECOID_SetAlgorithmID(nullptr, &amp;aCertID.hashAlgorithm, hashAlgTag, nullptr); + // Write ESSCertIDv2.certHash. SECItem aCertHashItem; - unsigned char aCertHash[SHA256_LENGTH]; - HashContextScope aCertHashContext(HASH_Create(HASH_AlgSHA256)); + unsigned char aCertHash[SHA256_LENGTH*2]; + HashContextScope aCertHashContext(HASH_Create(hashType)); + if (!aCertHashContext.get()) { SAL_WARN("vcl.pdfwriter", "HASH_Create() failed"); @@ -7354,7 +7418,8 @@ HASH_Update(aCertHashContext.get(), reinterpret_cast&lt;const unsigned char *&gt;(rContext.m_pDerEncoded), rContext.m_nDerEncoded); aCertHashItem.type = siBuffer; aCertHashItem.data = aCertHash; - HASH_End(aCertHashContext.get(), aCertHashItem.data, &amp;aCertHashItem.len, SHA256_LENGTH); + HASH_End(aCertHashContext.get(), aCertHashItem.data, &amp;aCertHashItem.len, hashLen); + aCertID.certHash = aCertHashItem; // Write ESSCertIDv2.issuerSerial. IssuerSerial aSerial;</span></span></code> </pre> <br></div></div><br>  The patch for the file ~ / libreoffice-5.3.7.2 / xmlsecurity / source / pdfio / pdfdocument.cxx is located <br><br><div class="spoiler">  <b class="spoiler_title">here:</b> <div class="spoiler_text"><pre> <code class="diff hljs"><span class="hljs-comment"><span class="hljs-comment">--- pdfdocument_ORIG.cxx 2017-10-25 17:25:39.000000000 +0300 +++ pdfdocument.cxx 2018-10-31 19:49:34.174485641 +0300 @@ -2400,6 +2400,19 @@ case SEC_OID_PKCS1_SHA512_WITH_RSA_ENCRYPTION: eOidTag = SEC_OID_SHA512; break; + case SEC_OID_GOST3410_SIGN_256: + case SEC_OID_GOST3411_2012_256: + eOidTag = SEC_OID_GOST3411_2012_256; + break; + case SEC_OID_GOST3410_SIGN_512: + case SEC_OID_GOST3411_2012_512: + eOidTag = SEC_OID_GOST3411_2012_512; + break; + case SEC_OID_GOST3410_SIGNATURE: + case SEC_OID_GOSTHASH: + eOidTag = SEC_OID_GOSTHASH; + break; + default: break; } @@ -2453,6 +2466,16 @@ case SEC_OID_SHA512: nMaxResultLen = msfilter::SHA512_HASH_LENGTH; break; + case SEC_OID_GOST3411_2012_256: + nMaxResultLen = msfilter::SHA256_HASH_LENGTH; + break; + case SEC_OID_GOST3411_2012_512: + nMaxResultLen = msfilter::SHA512_HASH_LENGTH; + break; + case SEC_OID_GOSTHASH: + nMaxResultLen = msfilter::SHA256_HASH_LENGTH; + break; + default: SAL_WARN("xmlsecurity.pdfio", "PDFDocument::ValidateSignature: unrecognized algorithm"); return false;</span></span></code> </pre> <br></div></div><br>  After making changes, we build the libreoffice package.  The changes affected three libraries (/ usr / lib64 / libreoffice / program): <br><br><ul><li>  <i>libvcllo.so</i> ; </li><li>  <i>libxmlsecurity.so</i> ; </li><li>  <i>libxsec-xmlsec.so</i> </li></ul><br>  These three libraries were replaced in the installed libreoffice distribution (/ usr / lib64 / libreoffice / program). <br><br>  After that, the signing and verification of the GOST-signature in the PDF-files passed without a hitch.  And here on one of the sites comes this eye: <br><blockquote>  The Federal Tax Service has an excellent <a href="https://service.nalog.ru/vyp/">service</a> for obtaining an extract from the Unified State Register of Legal Entities for any legal entity, and is absolutely free.  The statement can be obtained in the form of a PDF document signed by a qualified electronic signature.  And such an extract can be sent to a commercial bank, a state institution, and you will not be asked for it in paper form.  In general, very convenient. </blockquote>  We order, receive and check: <br><br><img src="https://habrastorage.org/webt/ye/rt/ul/yertuldamhhmiwc6wmveofj1a60.png"><br><br>  It is worth recalling that we should not forget to install in the store a chain of trusted certificates for the signatory's certificate.  But it is natural. <br><br>  Everything, now there is a possibility of using an electronic signature (one or several) in PDF-files.  This is very convenient both when coordinating documents and storing documents. <br><br>  And if anyone is used to working with the classic electronic signature in the PKCS # 7 format, both attached and disconnected, then an updated <a href="https://habr.com/post/335712/">GUINSSPY GUISSPY</a> graphic package (for Linux and Windows platform) has been prepared for them: <br><br><img src="https://habrastorage.org/webt/og/ty/wt/ogtywt9vn2mbak1firondj6qlbc.png"><br><br>  The development was carried out on Python3 and if there were no problems on the Linux platform, then on MS Windows it was necessary to sweat with encodings.  In fact, it was a separate development and this requires a separate article.  All these nuances can be seen in the source code. <br><br>  Using this utility, you can create a certificate store for libreoffice, manage certificates, sign files, etc .: <br><br><img src="https://habrastorage.org/webt/23/fn/pn/23fnpnlfc3ud9bhlxzrro9rnbpc.png"><br><br>  The utility also allows you to create a certificate request with the generation of a key pair, which can then be transferred to the <a href="https://habr.com/post/415423/">certification</a> authority, and the resulting certificate installed in the repository: <br><br><img src="https://habrastorage.org/webt/r3/gg/2b/r3gg2buhclugtx0zrzd8q9ipo4o.png"><br><br>  And if the manufacturers of domestic Linux forks modified various packages (NSS, Firefox, Thunderbiird, <a href="https://habr.com/post/417735/">GnuPG / SMIME</a> , SSH, KMail, <a href="https://habr.com/post/316736/">Kleopatra</a> , LibreOffice, <a href="https://habr.com/post/415423/">OpenSSL</a> , etc., etc.) to work with Russian cryptography, then you can It would be talking about import substitution in the field of cryptography. </div><p>Source: <a href="https://habr.com/ru/post/428429/">https://habr.com/ru/post/428429/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../428415/index.html">TP-Link Omada OC200 Cloud Controller Overview</a></li>
<li><a href="../428417/index.html">MatLab / Octave machine learning: examples of algorithms supported by formulas</a></li>
<li><a href="../428419/index.html">Drag and Swipe in RecyclerView. Part 2: Drag and Drop Controllers, Grid, and Custom Animations</a></li>
<li><a href="../428421/index.html">A flexible system for testing and collecting metrics of programs on the example of LLVM test-suite</a></li>
<li><a href="../428423/index.html">How the IBM and Red Hat deal at $ 34 billion will change the IT market: expert and analyst opinions</a></li>
<li><a href="../428431/index.html">More than concentric layers</a></li>
<li><a href="../428433/index.html">Lawyers about testing when hiring in the private sector</a></li>
<li><a href="../428435/index.html">What to read in PHP in Russian?</a></li>
<li><a href="../428437/index.html">Apple Wallet. What is it and how to integrate your card into it</a></li>
<li><a href="../428439/index.html">Without ensemble</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>