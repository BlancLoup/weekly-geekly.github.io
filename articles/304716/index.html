<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we helped a big Brazilian bank deal with the effects of the denomination</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The newest history of monetary circulation in Brazil is a series of denominations, the first of which was carried out in 1942, and the last in 1994. B...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we helped a big Brazilian bank deal with the effects of the denomination</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/619/6ce/754/6196ce754eca4847856fd77970b08150.jpg" align="left">  The newest history of monetary circulation in Brazil is a series of denominations, the first of which was carried out in 1942, and the last in 1994.  By 1994, the national currency of Brazil ‚Äî Cruzeiro ‚Äî was so weak that prices were set in stores in arbitrary units, the word ‚Äúreal‚Äù ‚Äîthe ‚Äúreal‚Äù price ‚Äî was written next to the numbers.  In 1994, they decided to get rid of the extra zeros, and the word ‚Äúreal‚Äù, to which everyone was accustomed, became the name of the new currency - the real (however, Brazil‚Äôs monetary unit until 1942 was the same name). <br><br>  Today we will tell how one of our products - <a href="https://www.abbyy.com/ru-ru/ocr-sdk/%3Futm_source%3Dhabrahabr.ru%26utm_medium%3Dpost%26utm_campaign%3D060716">ABBYY FineReader Engine</a> helped the largest private Brazilian bank to cope with the consequences of the denomination.  Can you imagine how this could be?  Welcome under cat. <a name="habracut"></a><br><br>  When the denominations of the late 80s occurred, the zeros "disappeared" not only from the banknotes - the amounts in the bank accounts of citizens were also adjusted - of course, in favor of the banks.  At that time, these were such insignificant amounts that no one demanded damages from banks.  In 2007 (that is, eighteen years later), one enterprising Brazilian citizen thought that, taking into account interest, for a half dozen years, the ‚Äúmissing‚Äù amount was not so small, and applied to the bank for payment of interest, the bank refused and the citizen filed a claim to court.  The court declared the requirements lawful and ordered the bank to pay damages. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At that moment it became clear that there would be a lot of such appeals.  Information about the account status (such a document is called the Bank Statement) at the time of denomination was required to go to court, and banks were required to provide this information to the account holders. <br><br><img src="https://habrastorage.org/files/a96/bb2/967/a96bb2967f874c098e674bf21a898d75.png"><br><br>  During the period when the denomination occurred, all information about the state of bank accounts was printed, photographed and transferred to microfiche ( <a href="https://en.wikipedia.org/wiki/Microform">microfiche</a> ). <br><br>  The films were stored in the archive, and it was clear that if thousands of people came for this data, all the other work in the bank would arise - the staff‚Äôs working time would be enough just to go to the archive, search for the necessary film and issue certificates to customers.  The bank decided that it was necessary to transfer the information from microfiche to electronic form - and here we were useful. <br><br>  It was necessary in the shortest possible time to scan all the microfiche on a special scanner (used scanners Wicks and Wilson and Kodak), extract the data - the client's name, account number and amount - and put it all into a database (Microsoft SQL Server).  The scans were to be processed by one of our products - <a href="https://www.abbyy.com/ru-ru/ocr-sdk/%3Futm_source%3Dhabrahabr.ru%26utm_medium%3Dpost%26utm_campaign%3D060716">ABBYY FineReader Engine</a> using templates made in ABBYY FormReader. <br><br>  The scheme of work in this project was more or less standard: scanning - recognition and data extraction - saving data in the database - verification: <br><br><img src="https://habrastorage.org/files/17c/e4c/b56/17ce4cb56e694a3ba0403a9dfade1e1d.png"><br><br>  Before recognition, images were processed: distortions, ‚Äúnoise‚Äù were removed. <br><br>  Since microfiches were stored for almost 20 years in the archive, their condition was average, the quality of the scans, respectively, too, but the complexity was not only that.  The fact is that the Bank Statement was printed either on dot-matrix printers or typewriters, and a special technology is used to recognize such documents and it makes sense to talk about it in more detail.  May the reader forgive us - as examples we will cite not Brazilian pictures, but images from our test database. <br><br>  There are several types of text recognition in our products.  Of course, you can recognize everything in standard mode, but on texts printed with non-standard fonts, the quality can be poor.  In this case, you can choose one of the special modes: in our case there are separate modes for both the dot matrix printer and the typewriter. <br><br>  At a minimum, different types of text differ from each other by different standards - that is, each type of text has its own character pattern.  The characters of the matrix printer are very different from the usual, so for them there are special, separate standards.  We tried to build a library of fonts from different printers.  For better recognition, we add a number of ordinary ones to the base of ‚Äúmatrix‚Äù standards - for example, the symbols from the courier font in the monospaced Courier New. <br><br><img src="https://habrastorage.org/files/70b/8d7/b06/70b8d7b068e8499cb8db4445c75afecb.png"><br><br><img src="https://habrastorage.org/files/939/9f5/d04/9399f5d04acd49138860ae364587ec21.png"><br><br>  In addition, in the code, different data types are processed differently.  Both the matrix printer and the typewriter use monospace fonts ‚Äî in such fonts, the width of each familiarity is constant, unlike many other fonts, and the characters in the adjacent lines are placed one above the other. <br><br><img src="https://habrastorage.org/files/65f/d4b/a4e/65fd4ba4e08c4214a994414bb947bb30.png"><br><br>  <a href="https://habrahabr.ru/company/abbyy/blog/225215/">As you remember</a> , one of the stages of recognition is the selection of lines.  When we select lines on texts printed with monospaced fonts, we first of all try to impose a grid on the text - so that each character is in its place. <br><br>  In addition, lines are highlighted with parameters that are different from those used when selecting lines on ordinary fonts ‚Äî for example, in a regular matrix printer, letters with diacritics (both uppercase and lowercase) in any case fall entirely into familiarity. <br><br><img src="https://habrastorage.org/files/8d0/7c4/ddd/8d07c4ddd2214c4380727996d0f5f0df.png"><br><br><img src="https://habrastorage.org/files/700/af7/d2b/700af7d2bab641d8b4a97009a28743e7.png"><br><br>  It turns out that it is not necessary to process the diacritics separately and stick to the common lines. <br><br>  Another task is to correctly determine which spaces should be considered as spacing between words, and which spaces as spacing between letters.  In monospace fonts, there is a lot of space between the i and l characters, and our algorithms can take them as spaces. <br><br><img src="https://habrastorage.org/files/256/cd3/a46/256cd3a46e1345d28f7e65f978331dd0.png"><br><br><img src="https://habrastorage.org/files/4b9/3ce/2b5/4b93ce2b5b7942e283ea4cb4c3abb5fe.png"><br><br>  Allocation of gaps in our country mainly occurs as follows: we look at the histogram, we consider all the white gaps.  It usually turns out that large gaps are the distance between words, small spaces between letters, and in the example described, the distances are average and the program can make a mistake by breaking the word into two where it does not need to be done.  But if we note the type of text ‚ÄúDot Matrix Printer‚Äù, a grid will be superimposed on the text, and it will be seen that this gap of medium size falls into the gap between adjacent cells - so we understand that this is not a space between words (a space is a whole empty cell) .  There are cases when the matrix printer prints badly, the letters overlap, and the grid cannot be built.  Or if the ribbon in the typewriter is pulled, and the lines are printed with a shift. <br><br><img src="https://habrastorage.org/files/14f/d72/7bf/14fd727bf839464b8ae149a3b80bf4d4.png"><br><br><img src="https://habrastorage.org/files/528/c80/fc8/528c80fc8f9249a7b19e916fddee2c3e.png"><br><br>  In such cases, the grid is difficult to impose and we use conventional recognition algorithms. <br><br>  The next difficulty is related to how the character itself is printed. <br><br>  Dot matrix printers are different.  This is quite a good dot-matrix printer; you can even try to recognize such text as usual. <br><br><img src="https://habrastorage.org/files/cf9/48e/c4b/cf948ec4b73f49679cea3547d9f92e11.png"><br><br>  But this text is printed on an old printer - in the letters you can see separate points and distances between them. <br><br><img src="https://habrastorage.org/files/845/0a2/038/8450a2038a3447f6af625ce02e98586b.png"><br><br><img src="https://habrastorage.org/files/5d6/1ea/80b/5d61ea80b55d44a1859395d3dd701b76.png"><br><br>  If we have specified the ‚ÄúMatrix printer‚Äù text type, the program can choose one of two modes by itself.  One is when we try to use the standards we have.  The second - the so-called ‚Äúdraft mode‚Äù - when the distance between the points inside the symbol is filled.  This helps a lot when working with symbols in which the distance between points is large - if it is not filled in, our algorithms can decide that there are not one letter, but two;  will begin to check and look for matches for two separate parts. <br><br><img src="https://habrastorage.org/files/a5b/1df/92b/a5b1df92b718442da11e6246a0dd3bc9.png"><br><br><img src="https://habrastorage.org/files/b22/86b/a3d/b2286ba3d326449fbaa56247e9dc40a0.png"><br><br>  By several parameters, the program decides whether it is necessary to try to apply the ‚Äúdraft mode‚Äù.  For a start, on several fragments, lines, we are convinced that the best hypothesis is ‚Äúdraft‚Äù, if so, we begin to fill in all the other symbols.  If the best hypothesis is not a ‚Äúdraft‚Äù, then we, in principle, can launch this mode, but only on separate symbols, when one of them is very poorly recognized. <br><br>  In addition to the poor quality of character prints, there is another difficulty - at the time when matrix printers were used, they often saved paper and printed in condense mode (narrow font, small spacing between letters). <br><br><img src="https://habrastorage.org/files/65f/550/21d/65f55021d4c24510bace8515e8bbef2c.png"><br><br>  In a typewriter, the complexity is the same - with a few exceptions.  Typed texts are characterized by very large letter defects.  The tape fades, paint, garbage, etc. adheres to the letters. <br><br><img src="https://habrastorage.org/files/047/a6e/4cd/047a6e4cd5ed415585ce2095ee0c570e.png"><br><br><img src="https://habrastorage.org/files/42e/ffc/eaf/42effceaf3cb4e5cae5a005d4eb2df03.png"><br><br>  There is also a lot of ‚Äúgarbage‚Äù between lines and between letters, which complicates recognition. <br><br><img src="https://habrastorage.org/files/6ed/58e/13c/6ed58e13c25c4d6fa6de90125e4f5f08.png"><br><br>  Another subtlety in working with such texts is superscripts and subscripts.  In printing presses, to print the index, the caret is shifted up or down by a half-line.  At the same time, the font size remains the same, but with our usual recognition it is considered that the font of the indexes should be smaller - this is provided in the ‚ÄúTypewriter‚Äù mode. <br><br><img src="https://habrastorage.org/files/85c/41e/784/85c41e78498d43399435c5326f971c83.png"><br><br>  Even in the texts typed, there may be uneven distances between the lines. <br><br><img src="https://habrastorage.org/files/188/0b1/4de/1880b14dec774c62a3ad25bac01edeec.png"><br><br>  Well, actually, all the differences. <br><br>  In conclusion, the traditional project statistics.  In just 3 months, about 2.4 million documents were processed - and the bank successfully coped with the influx of citizens. <br><br>  <i>Co-written with Jo√£o Rotta, Business Development Manager, ABBYY Brazil</i> </div><p>Source: <a href="https://habr.com/ru/post/304716/">https://habr.com/ru/post/304716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304704/index.html">The development of cloud technologies in Russia. New reality: vectors of development and major problems</a></li>
<li><a href="../304706/index.html">Prediction of the likelihood of each client‚Äôs transition to the status of a former member</a></li>
<li><a href="../304708/index.html">Web scraping updated data with Node.js and PaaS</a></li>
<li><a href="../304710/index.html">40 tutorials for creating vector illustrations</a></li>
<li><a href="../304714/index.html">Speech.framework on iOS 10</a></li>
<li><a href="../304718/index.html">Outdated CPUs or higher price? We found a compromise! 2 x E5620 / 32GB DDR3 / 6 x 240GB SSD / 1Gbps?</a></li>
<li><a href="../304720/index.html">Subtleties of selection of respondents for UX-research</a></li>
<li><a href="../304722/index.html">Development of the first game [on Unity3D]</a></li>
<li><a href="../304724/index.html">Projecting Google Material Design onto the desktop system ... (part one)</a></li>
<li><a href="../304726/index.html">Digest of grocery design, June 2016</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>