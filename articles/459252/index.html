<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 28: Hacking a Smart Home</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What risks do we take on installing a smart home system? The one that steers the light bulbs and a kettle from the application on the smartphone, insi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 28: Hacking a Smart Home</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/jb/f0/or/jbf0ork45cxrjax-puw3f0w6wtg.jpeg" align="right">  What risks do we take on installing a smart home system?  The one that steers the light bulbs and a kettle from the application on the smartphone, inside the local network and remotely.  If the smart system is tied to security and locks management (as in the case of the Amazon Key) - then it is clear what.  If not, then theoretically it would be possible to imagine the danger of a software outage of some coffee maker followed by a fire.  But it is better not to dream, but to know for sure. <br><br>  Experts from the ICS CERT team at Kaspersky Lab decided to conduct a field test on the smart home of one of the company's employees ( <a href="https://threatpost.ru/kaspersky-pokes-holes-in-fibaro-smart-home/33332/">news</a> , <a href="https://www.kaspersky.ru/blog/hacking-things/23017/">blog post</a> , technical <a href="https://securelist.ru/fibaro-smart-home/94294/">article</a> ).  The hacking was successful: the coffee maker did not suffer, but it was possible to get control over the system, albeit with a couple of (quite realistic) assumptions during the experiment.  One of the unpleasant consequences of this attack was the leakage of personal data: the coordinates of the house and, what is the saddest thing, the geolocation of the smartphone.  However, the experiment ended on a positive note: the manufacturer of the smart home system has successfully closed vulnerabilities. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/cFA4_ZwlM9I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>  <i>Artistic interpretation of the effects of hacking</i> <br><br>  In the technical article, quite a lot of space is devoted to relatively boring, but important points: what was NOT able to be hacked, and how the smart home system was analyzed for potential vulnerabilities.  Before the experiment, researchers already knew the manufacturer of the system.  It turned out to be the company <a href="https://www.fibaro.com/en/">Fibaro</a> , which produces a range of its own devices for a modern smart home, as well as providing integration with third-party devices.  Moreover, the owner gave an important hint - a permanent IP to enter the admin area.  By the way, Fibaro itself does not recommend opening access to the controller over IP - only through the cloud system.  In this experiment, this consciously left loophole played a role. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/qh/ou/rj/qhourje0njxqjfureefeilcoosy.jpeg"></div><br>  Theoretically, such a system can be attacked in three main directions: try to somehow break the control device, look for vulnerabilities in the cloud part of the service, or attack IoT devices connected to the controller.  In the latter case, you need to be in close proximity to them, so the first two options look more promising. <br><br>  The next step is to analyze the device firmware and WebAPI.  Usually, on such an analysis, everything ends, and the news comes out in the style of ‚Äúa password has been found in the device‚Äù.  But in the case of Fibaro, there were no obvious security holes.  But useful information was obtained about the implementation of part of the control logic in PHP.  Without authorization, the controller gives only the serial number of the device, and this information is useless for breaking the piece of iron.  But, as it turned out, it allows you to hack the cloud part of the service. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i6/dv/ss/i6dvssb2y9cspliysjqo19496vq.png"></div><br>  Access to the cloud, in turn, allows without authorization to get backups of the SQLite database containing all the device settings, and upload their own.  Theoretically, authorization bypass made it possible (until the vulnerability was fixed) to download backup copies of all users of the cloud system.  Analysis of the real base of the attacked device provided access to private information, including the coordinates of the house and the smartphone on which the control application is installed.  This is already a serious problem, since (with some limitations) it allows you to determine when the owner of the system is not at home. <br><br>  In addition, the database contained complete information about the connected IoT devices, as well as a password for accessing the settings, but hashed with the addition of salt.  Analysis of the firmware showed that the "salt" is not random, but firmly sewn into the device.  Theoretically, a very simple password can be cracked, but in this case it did not work.  The SQLite database also contained open passwords for connecting to other devices within the network: if these passwords coincided with the main one, the controller could also have been easily cracked. <br><br>  But again it did not work: the owner of the system was familiar with the basic recommendations for security and did not use the same password for different devices.  Therefore it was necessary to apply social engineering.  The vulnerability in the cloud system, which allows for a series of actions without authorization, knowing only the serial number of the device (which is given "free" if there is access to the admin from outside), made the following scenario possible.  A prepared backup copy of the device into which the malicious script was embedded was uploaded to the ‚Äúcloud‚Äù.  A message about the need to "update" the device through the regular capabilities of the cloud system was sent to the owner (via email and SMS). <br><br>  Since the owner of the system knew about the experiment, he immediately realized that this was not a real patch.  But in general, this is a very real scenario, when a plausible message arrives through a familiar communication channel to the user, so a backup has been installed.  The malicious code was executed with system privileges due to an oversight in the PHP code that causes the execution of the bash script: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n5/ys/qn/n5ysqnjncbnpjoez_nnnbcttb-w.png"></div><br>  Here, the parameter set by the user (in normal conditions even the system administrator does not have superuser rights on the device), falls into the argument for the command line.  The insufficient verification of the arguments allowed the arbitrary code to be executed with the ‚Äúroot‚Äù rights and finally to get full control over the device.  At the same time, the possibility of conducting a SQL injection was found, but not used: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y8/9j/r3/y89jr3_wg5c6ti0iu45w0kovi_e.png"></div><br>  The researchers did not plan to crack the coffee maker in a real house, so they changed the melody of the alarm clock as a ‚Äúhello‚Äù.  The mentioned vulnerabilities both in the cloud system and in the controller code were closed.  For obvious reasons, the specific protection bypass methods are not disclosed in the technical article - in order to avoid being used by real intruders on devices that have not yet been updated.  But in this experiment, what is usually left out of the news headlines is well shown: many ways to research the protection of a device, most of which end in nothing.  In actual experience, both the device manufacturer and its owner were able to avoid the simplest security errors, such as stitched and reused passwords.  Nevertheless, a sufficient number of problems were identified that could lead at least to leakage of private data, and in the worst case, to bypassing security systems. <br><br>  <i>Disclaimer: The opinions expressed in this digest may not always coincide with the official position of Kaspersky Lab.</i>  <i>Dear editors generally recommend to treat any opinions with healthy skepticism.</i> </div><p>Source: <a href="https://habr.com/ru/post/459252/">https://habr.com/ru/post/459252/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../459244/index.html">Product manager notes: user behavior on game pages in the app store. How much time is needed to download the game</a></li>
<li><a href="../459246/index.html">Why is website conversion going down? Examples of 60 errors in design and usability</a></li>
<li><a href="../459248/index.html">Digital events in Moscow from 09 to 14 July</a></li>
<li><a href="../45925/index.html">Glasses display: Teleglass by Scalar</a></li>
<li><a href="../459250/index.html">PostgreSQL WAL: 2. Prerecord Log</a></li>
<li><a href="../459254/index.html">Still the best ZIP bomb</a></li>
<li><a href="../459256/index.html">How we optimized our Theme Hospital for different platforms</a></li>
<li><a href="../459258/index.html">14,000 versts not a hook</a></li>
<li><a href="../45926/index.html">habra</a></li>
<li><a href="../459262/index.html">Retire at 22</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>