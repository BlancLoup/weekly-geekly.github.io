<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Image reconstruction: 1 km of optical fiber, artificial neural network and deep learning</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nowadays, optical fibers have become an integral part of the most diverse spheres of human life: from home Internet to endoscopy. The use of optical f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Image reconstruction: 1 km of optical fiber, artificial neural network and deep learning</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/4x/il/hf/4xilhf2uczrt60cqs5brbtojhkg.jpeg"><br><br>  Nowadays, optical fibers have become an integral part of the most diverse spheres of human life: from home Internet to endoscopy.  The use of optical fibers is due to a number of advantages: transmission speed, physical strength, throughput, information security, etc. <br><br>  In order to increase the bandwidth, a multimode fiber (MMF) was created when information is transmitted over several parallel channels.  Despite all its advantages, MMF has a number of shortcomings, one of which the researchers decided to eliminate in order to improve the process of transferring images.  The bottom line is this: when a sample is projected onto the proximal side of the MMF, the image we get on the distal side is speckle, because its incoming data is distributed over a variety of modes with varying degrees of propagation along the fiber length.  Scientists suggest using a combination of multimode fiber and deep learning for artificial neural networks to get accurate images, including when using endoscopy.  Let's dig in the report of the researchers and try to understand how it works and what results.  Go. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>The basis of the study</b> <br><br>  Techniques for using artificial neural networks to decrypt images transmitted via MMF have been developed for a long time.  Thus, in early works, a two-layer network was described, capable of recognizing about 10 images that passed through 10 meters of stepped fiber. <br><br>  In this study, the system is much more complicated, but, according to scientists, much more efficient.  The initial stage was the collection of a large number of speckle samples obtained by passing the image through the MMF.  They have become the knowledge base for learning DNN (artificial neural network based on <i>deep learning *</i> ). <br><br><img src="https://habrastorage.org/webt/jd/zf/n5/jdzfn5d7cgwnxkh6ecppwwyeoji.png"><br>  <i>Sample speckle image</i> <blockquote>  <b>Deep Learning *</b> is a combination of machine learning methods based on representation, rather than a specialized algorithm for a specific task. </blockquote>  The DNN architecture is very complex and has about 14 <i>hidden layers *</i> . <blockquote>  <b>Hidden layer *</b> - an artificial neural network consists of computing units (neurons), which are divided into 3 categories: input, hidden and output.  Input accept information, hidden perform various calculations, and output transmit information further. </blockquote>  For experiments on DNN, a database of 20,000 hand-written numbers was created.  Next, the database in a random order of division into groups: <br><br><ul><li>  16,000 digits - training; </li><li>  2,000 digits - check; </li><li>  2,000 numbers - test. </li></ul><br>  <b>Preparing for the experiment</b> <br><br>  The image below shows the layout of the optical system that was used to collect data. <br><img src="https://habrastorage.org/webt/sz/lq/7v/szlq7vik0q_xqfhttlcdh3-cxp4.jpeg"><br>  <i>Image number 1: installation diagram:</i> <i><br><br></i>  <i>Laser source - a source of laser radiation (beam);</i> <i><br></i>  <i>HWP - half wave plate;</i> <i><br></i>  <i>M1 is a mirror;</i> <i><br></i>  <i>SLM - spatial light modulator;</i> <i><br></i>  <i>P - linear polarizer;</i> <i><br></i>  <i>L is a lens;</i> <i><br></i>  <i>BS - beam splitter;</i> <i><br></i>  <i>OBJ - microscope lens;</i> <i><br></i>  <i>OF - optical fiber;</i> <i><br></i>  <i>CCD - CCD camera.</i> <br><br>  And now in order.  A laser beam with a wavelength of 560 nm directs light through a <i>gradient optical fiber *</i> with a core diameter of 62.5 Œºm and a <i>numerical aperture *</i> 0.275. <blockquote>  <b>Gradient MMF *</b> is a fiber with a non-uniform refractive profile when the refractive index smoothly decreases from the edge to the fiber axis. <br><br><img src="https://habrastorage.org/webt/cf/0p/dd/cf0pdd8awuumjzbvo6ie1-gb_68.png">  <i>Comparison of fiber types: step multimode, gradient multimode and singlemode (top to bottom).</i> <br></blockquote><blockquote>  <b>Numerical aperture *</b> - the sine of the maximum angle between the beam and the axis.  At the same time there is a total internal reflection in the distribution of radiation over the fiber. </blockquote>  At a specific wavelength, the fiber is capable of supporting about 4500 spatial modes.  The input samples (images) are displayed on the spatial light modulator, after which they are redirected by the 4f system to the proximal (close to the center) edge of the MMF.  At the far end of the fiber, another 4f system visualizes a speckle emanating from the distal (far from the center) edge of the fiber onto a CCD camera. <blockquote>  <b>CCD *</b> is a charge-coupled device, which implements the technology of controlled charge transfer in the volume of a semiconductor. </blockquote>  To check the phase and amplitude models, as input signals for the gradient MMF, a half-wave plate was installed before SLM, and a linear polarizer after SLM. <br><br>  As mentioned earlier, hand-written numbers were used as samples.  They were taken from the <a href="http://yann.lecun.com/exdb/mnist/">MNIST database</a> . <br><br>  Before being processed by DNN, each of the images recorded on CCD1 or CCD2 was cut to a size of 1024 √ó 1024 pixels.  Next, the resulting speckle images were reduced to 32 √ó 32 pixels and used as input for DNN. <br><br><img src="https://habrastorage.org/webt/4x/il/hf/4xilhf2uczrt60cqs5brbtojhkg.jpeg"><br>  <i>Image number 2</i> <br><br>  In images <b>2a</b> and <b>2b</b> we see samples of numbers (0 and 4).  <b>2c</b> and <b>2d</b> are the same numbers, but after amplitude modulation, when the amplitude of the transmitted signal was affected.  <b>2e</b> and <b>2f</b> are sample numbers after phase modulation, when the phase of the carrier oscillation changed in direct proportion to the signal.  We also see the speckles themselves, which were fixed on the distal edge of the fiber after passing a distance of 2 cm. <br><br>  To distinguish speckles ( <b>2g</b> and <b>2h</b> ) is quite difficult.  However, if we compare the images <b>2d</b> and <b>2h</b> (for example, consider the sample "4"), then we can isolate the difference that the DNN can determine ( <b>2i</b> ).  Thus, these distinctive features will allow the system to distinguish "0" from "4", "2" from "9", etc. <br><br>  <b>Data processing</b> <br><br>  The basis of the system for determining speckles and reconstructed input images was the <i>convolutional neural network *</i> of the ‚ÄúVisual Geometry Group (VGG)‚Äù type (3a). <blockquote>  <b>Convolutional neural network *</b> - architecture of the INS, characterized by a convolution operation, when each image fragment is multiplied by a convolution matrix element by element, after which the result is summed up and written to the similar position of the output image. <br><img src="https://habrastorage.org/webt/4l/hb/5t/4lhb5tb2o8phsn2a3eab0frirvy.jpeg"><br>  <i>An example of a convolutional neural network architecture.</i> </blockquote>  The introduction of such a system made it possible to decipher images with greater accuracy.  For the reconstruction of images, a ‚ÄúU-net‚Äù type of convolutional neural network with 14 hidden layers was used ( <b>3b</b> ). <br><br><img src="https://habrastorage.org/webt/aq/co/vw/aqcovw9timhzuulhc2gx66h37h8.jpeg"><br>  <i>Image number 3</i> <br><br>  Recall that the base of 20,000 digits was divided into three groups (16,000 - training, 2,000 - testing and 2,000 - test). <br><br>  The workout group was processed in batches of 50 pieces for the reconstruction network and 500 each for the definition network.  At the same time, the parties were changed to avoid <i>retraining *</i> . <blockquote>  <b>Re-training *</b> is a case when the system handles examples from a training sample well, but does not do well with examples from a test sample. </blockquote> In order to minimize the root-mean-square error, an optimization algorithm with a learning rate of 1 x 10 <sup>-4 was used</sup> . <br><br>  The networks passed the training stage for no longer than 50 epochs (backward cycles).  For each case, the training was repeated 10 times in order to collect statistical data on the accuracy of the training system. <br><br>  All DNNs were implemented on the basis of a single NVIDIA GeForce GTX 1080Ti graphics processor using the TensorFlow 1.5 Python library. <br><br>  <b>Research results</b> <br><br>  <b>Reconstruction</b> <br><br>  The first parameter that the scientists decided to consider in more detail was the ability of the system to reconstruct the input data. <br><br><img src="https://habrastorage.org/webt/uw/yd/zj/uwydzj5zd19fjjv-zlxm5_jgs9g.jpeg"><br><br>  The image above shows the results of the reconstruction of numbers (0 ... 9), after passing the data through a fiber with a length of 0.1 m, 10 m and 1000 m. <br><br>  As we can see, the result of the procedure is very accurate, which confirms the ability of the U-net system to isolate the extreme distinctive features of the future image. <br><br>  The degree of accuracy of the reconstruction was also checked.  This figure decreases with increasing fiber length from 96.9% (0.1 m) to 90.0% (1000 m). <br><br>  The decrease in accuracy is due to the fact that with a fiber length of 1 km, temperature irregularities (expansion of the material due to heat and / or a change in the refractive index) occur in it, which change the optical signal path.  These processes lead to the fact that the speckle pattern at the distal end becomes unstable, which makes it more difficult to reconstruct it into the necessary image. <br><br>  The researchers note that the external impact on the fiber also reduces the degree of accuracy of image reconstruction.  Therefore, with further improvement of the system, the optical fiber should be provided with thermal insulation and an isothermal environment to achieve the maximum level of reconstruction accuracy. <br><br>  The reconstruction procedure also perfectly levels artifacts on the processed image. <br><br><img src="https://habrastorage.org/webt/kz/qr/gz/kzqrgzguq8wzabfybslsxhha5ts.jpeg"><br><br>  For example, the system isolates the image ( <b>2a</b> ) from the distal speckle ( <b>2g</b> ), simultaneously removing defects projected onto the proximal fiber face ( <b>2c</b> and <b>2e</b> ).  In addition, the system tries to eliminate artifacts caused by contamination or sample defects or structural inaccuracies of the fiber itself. <br><br>  <b>Classification of zirph samples</b> <br><br>  The system can recreate the image, and the accuracy of this process is very impressive.  We now turn to the analysis of how accurately the system is able to determine where what is the image (figure), that is, to classify the data after their reconstruction. <br><br><img src="https://habrastorage.org/webt/fh/xo/gr/fhxogrzpgxvs8qm8zwebgsd2wzq.jpeg"><br><br>  From the graph and the table above it can be seen that the classification accuracy decreases with increasing length of the fiber involved in the transmission.  A similar trend was with the accuracy of reconstruction.  Regardless of whether the amplitude model or phase, accuracy decreases.  At 2 cm of fiber - 90% accuracy.  This is a good indicator, but the fiber is too short.  But with a length of 1 km, the accuracy drops to 30%.  Researchers attribute this to an increase in scattering losses, mode connectivity, and drift of the distal speckle.  All these ‚Äúinterferences‚Äù are caused by an increase in fiber length. <br><br><img src="https://habrastorage.org/webt/dz/5f/dt/dz5fdtcdxmxdl2s8cj-umyxzuj0.gif"><br>  <i>Distal speckle changes</i> <br><br>  The recording was made with a frame rate of 83 fps.  As an experiment on a fiber of 1 km, an empty image was transmitted. <br><br><img src="https://habrastorage.org/webt/6b/pv/g9/6bpvg9wyu1dvt04d9_jhotq-lwk.jpeg"><br>  <i>(a) and (b) - 2 frames taken from the record above, (c) - their comparison.</i> <br><br>  These frames were recorded with a difference of 2 seconds.  And as we see in the image (s), the difference between them is quite significant.  Such sharp changes in speckle can be associated with temperature fluctuations of the environment or air flows over the device (image No. 1), which can cause small disturbances in the fiber.  But when the fiber length increases, the force of such disturbances becomes palpable. <br><br>  It turns out that all the work of the system will be in vain because of these "interference".  However, scientists do not stop such difficulties, but rather encourage them to think. <br><br>  It was decided to conduct a study on speckle displacement and how they affect the accuracy of image classification.  For this, the VGG network was trained on the basis of 10,000 samples (half of the available ones), then testing was conducted, but with the other half of the samples.  The process was repeated, changing 2 groups of samples in places.  The results showed that there is no significant change in the accuracy of the classification, since the shift of speckles is not accidental, which means that the INS is able to study, remember and determine it in the process. <br><br>  The difference between amplitude and phase modulation was insignificant.  With a fiber length of 10 m and phase modulation, the classification was slightly better than with amplitude modulation.  This is due to a more uniform distribution of light on the modes of the optical fiber.  With amplitude modulation, the number of modes involved in the transmission is limited due to selective spatial excitation of the fibers. <br><br>  If we consider the option of fiber length of 1 km, then the amplitude modulation is already superior to phase.  When the light passes through a long optical fiber, all modes are involved in the transmission of information at once. <br><br><img src="https://habrastorage.org/webt/kq/nn/_0/kqnn_0dwyyinmt3bqb_s8kyyto0.jpeg"><br>  <i>Error matrices (confusion matrices)</i> <br><br>  In order to improve the classification accuracy, the INS was also trained with the help of already reconstructed samples.  Error matrices were also applied, which significantly improved the classification accuracy. <br><br>  For example, in the case of a fiber with a length of 1 km there is a confusion between the numbers 4 and 9, as well as between 3, 5, 6 and 8. <br><br>  To confirm, you just have to look at the results of the reconstruction. <br><br><img src="https://habrastorage.org/webt/1g/hl/i6/1ghli6tx_fwednlcyxdf_voxiww.jpeg"><br>  <i>Figures 4 and 9</i> <br><br><img src="https://habrastorage.org/webt/s3/3l/3s/s33l3sf2yz3rxlfq0z7uh4a0sya.jpeg"><br>  <i>Figures 3, 5, 6 and 8</i> <br><br><img src="https://habrastorage.org/webt/xg/f-/ky/xgf-ky6wkkodsfs55whxykqpygu.jpeg"><br><br>  The graphs above show changes in image classification accuracy over time: <br><br>  a - 10 m of fiber and distal speckles; <br>  b - 10 m of fiber and reconstructed images; <br>   - 1 km of fiber and distal speckles; <br>  d - 1 km of fiber and reconstructed images. <br><br>  <a href="https://www.osapublishing.org/optica/fulltext.cfm%3Furi%3Doptica-5-8-960%26id%3D396110">For a detailed acquaintance with the nuances of the study I strongly recommend to look at the report of scientists.</a>  A PDF version is also available on this page (‚ÄúGet PDF‚Äù button). <br><br>  <b>Epilogue</b> <br><br>  This study showed excellent results, which indicates its future development and practical implementation.  The above techniques can be applied to telecommunications (decoding in multiplexing) and even in medicine (endoscopy). <br><br>  By calculating the time costs, scientists have found that most of them are spent on the preparation of the system, more precisely on its training.  And this suggests that an already trained system can perform its functions incredibly quickly, down to milliseconds.  The only limitation will be the power of the hardware. <br><br>  Of course, there is still a lot to be studied in the field of artificial neural networks based on deep learning.  But their usefulness is visible now.  Improving existing systems, whatever their application, is just as important as creating new ones.  It is not always necessary to reinvent the wheel, if you can just improve it.  The main thing, as practice has shown, to think outside the box, to learn from our own and others' mistakes, to set ourselves sometimes impossible tasks and believe in our own strength.  If an idea can benefit humanity, it must be implemented. <br><br>  Thank you for staying with us.  Do you like our articles?  Want to see more interesting materials?  Support us by placing an order or recommending to friends, <b>30% discount for Habr users on a unique analogue of the entry-level servers that we invented for you:</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">The whole truth about VPS (KVM) E5-2650 v4 (6 Cores) 10GB DDR4 240GB SSD 1Gbps from $ 20 or how to share the server?</a>  (Options are available with RAID1 and RAID10, up to 24 cores and up to 40GB DDR4). <br><br>  <b>3 months for free</b> if you pay for new Dell R630 for half a year - <b>2 x Intel Deca-Core Xeon E5-2630 v4 / 128GB DDR4 / 4x1TB HDD or 2x240GB SSD / 1Gbps 10 TB - from $ 99.33 a month</b> , only until the end of August, order can be <a href="https://ua-hosting.company/serversnl">here</a> . <br><br>  <b>Dell R730xd 2 times cheaper?</b>  Only we have <b><a href="https://ua-hosting.company/serversnl">2 x Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 TV from $ 249</a> in the Netherlands and the USA!</b>  Read about <a href="https://habr.com/company/ua-hosting/blog/329618/">How to build an infrastructure building.</a>  <a href="https://habr.com/company/ua-hosting/blog/329618/">class c using servers Dell R730xd E5-2650 v4 worth 9000 euros for a penny?</a> </div><p>Source: <a href="https://habr.com/ru/post/420561/">https://habr.com/ru/post/420561/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420549/index.html">Freemarker templates</a></li>
<li><a href="../420551/index.html">Pentest or Red Team? Pirates against ninja</a></li>
<li><a href="../420553/index.html">Jeff Bezos and his relationship to philanthropy, philanthropy, and human projects</a></li>
<li><a href="../420555/index.html">Alan Kay: ‚ÄúComputers are instruments whose music is ideas‚Äù</a></li>
<li><a href="../420559/index.html">How IaaS comes to retail and manufacturing: who and why switched to virtual infrastructure</a></li>
<li><a href="../420563/index.html">Analysis of the report by Dmitry Stolyarov on monitoring Kubernetes</a></li>
<li><a href="../420565/index.html">Learn OpenGL. Lesson 5.9 - Deferred Rendering</a></li>
<li><a href="../420567/index.html">When testing through a public method starts to stink (example)</a></li>
<li><a href="../420571/index.html">Smart Headphones - Trends 2018: Environment Filtering, Audio Trainer, Head Gestures, and Direct Connection to Alexa</a></li>
<li><a href="../420573/index.html">Android Academy: now in Moscow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>