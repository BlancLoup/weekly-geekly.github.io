<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analyzing a proprietary application on OpenCL, written using the AMD APP SDK</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Consider the following situation: there is an application that uses an AMD GPU for its calculations. As a rule, the most demanding operations are made...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analyzing a proprietary application on OpenCL, written using the AMD APP SDK</h1><div class="post__text post__text-html js-mediator-article">  Consider the following situation: there is an application that uses an AMD GPU for its calculations.  As a rule, the most demanding operations are made on the GPU.  Therefore, if the application runs faster than its competitors, then you may want to know what algorithm is implemented in this program.  But what if the program is proprietary and is distributed under a license prohibiting reverse engineering and disassembling? <br><br>  In order not to violate the license, you can use one little trick left by the developers of the AMD <abbr title="Accelerated Parallel Processign">APP</abbr> SDK.  However, in order for this trick to work, another condition must be met (in addition to the application developers use the specified SDK): the application must use OpenCL for computing on the GPU. <br><br><a name="habracut"></a>  If you carefully read the <a href="http://developer.amd.com/sdks/AMDAPPSDK/assets/AMD_Accelerated_Parallel_Processing_OpenCL_Programming_Guide.pdf">AMD Accelerated Parallel Processing OpenCL Programming Guide (v1.3f)</a> , then in the section <i>"4.2.1 Intermediate Language and GPU Disassembly"</i> you can find one remarkable environment variable: GPU_DUMP_DEVICE_KERNEL.  It can take 3 values: <br><ul><li>  1 - save dump in AMD language <abbr title="Intermediate Language">IL</abbr> in a local directory </li><li>  2 - disassemble the <abbr title="Instruction Set Architecture">ISA</abbr> file and save the result in a local directory </li><li>  3 - do both actions </li></ul><br><h2>  Experiment </h2><br>  Set the value of the environment variable GPU_DUMP_DEVICE_KERNEL = 3.  As an experimental program, let's take an example from the AMD <abbr title="Accelerated Parallel Processign">APP</abbr> SDK - the binary search program <i>BinarySearch.exe</i> .  This example is not the most interesting, since the kernel source file for the GPU is already nearby: <i>BinarySearch_Kernels.cl</i> .  However, in real life programs do not store such valuable information in the clear, it is either encrypted or stored within the program. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, after running <i>BinarySearch.exe</i> , core dump files appear next to the program. <br><br>  Here is the original kernel written in OpenCL (file <i>BinarySearch_Kernels.cl</i> ): <br><pre><code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">kernel </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">binarySearch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( __global uint4 * outputArray, __const __global uint * sortedArray, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> findMe, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> globalLowerBound, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> globalUpperBound, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> subdivSize)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tid = get_global_id(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* lower bound and upper bound are computed from segment and total search space for this pass * The total search space is known from global lower and upper bounds for this pass. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> lowerBound = globalLowerBound + subdivSize * tid; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> upperBound = lowerBound + subdivSize - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* Then we find the elements at the two ends of the search space for this thread */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> lowerBoundElement = sortedArray[lowerBound]; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> upperBoundElement = sortedArray[upperBound]; <span class="hljs-comment"><span class="hljs-comment">/* If the element to be found does not lie between them, then nothing left to do in this thread */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( (lowerBoundElement &gt; findMe) || (upperBoundElement &lt; findMe)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">/* However, if the element does lie between the lower and upper bounds of this thread's searchspace * we need to narrow down the search further in this search space */</span></span> <span class="hljs-comment"><span class="hljs-comment">/* The search space for this thread is marked in the output as being the total search space for the next pass */</span></span> outputArray[<span class="hljs-number"><span class="hljs-number">0</span></span>].x = lowerBound; outputArray[<span class="hljs-number"><span class="hljs-number">0</span></span>].y = upperBound; outputArray[<span class="hljs-number"><span class="hljs-number">0</span></span>].w = <span class="hljs-number"><span class="hljs-number">1</span></span>; } } <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span></code> </pre> <br>  Here is the generated dump of this kernel in the AMD <abbr title="Intermediate Language">IL</abbr> language ( <i>binarySearch_Juniper.il</i> file): <br><pre> <code class="hljs markdown">mdef(16383)<span class="hljs-emphasis"><span class="hljs-emphasis">_out(1)_</span></span>in(2) mov r0, in0 mov r1, in1 div<span class="hljs-emphasis"><span class="hljs-emphasis">_zeroop(infinity) r0.x_</span></span><span class="hljs-strong"><span class="hljs-strong">__, r0.x, r1.x mov out0, r0 mend il_cs_2_0 dcl_cb cb0[15] ; Constant buffer that holds ABI data dcl_literal l0, 0x00000004, 0x00000001, 0x00000002, 0x00000003 dcl_literal l1, 0x00FFFFFF, 0xFFFFFFFF, 0xFFFFFFFE, 0xFFFFFFFD dcl_literal l2, 0x0000FFFF, 0xFFFFFFFE, 0x000000FF, 0xFFFFFFFC dcl_literal l3, 0x00000018, 0x00000010, 0x00000008, 0xFFFFFFFF dcl_literal l4, 0xFFFFFF00, 0xFFFF0000, 0xFF00FFFF, 0xFFFF00FF dcl_literal l5, 0x00000000, 0x00000004, 0x00000008, 0x0000000C dcl_literal l6, 0x00000020, 0x00000020, 0x00000020, 0x00000020 dcl_literal l7, 0x00000018, 0x0000001F, 0x00000010, 0x0000001F dcl_literal l8, 0x80000000, 0x80000000, 0x80000000, 0x80000000 call 1024;$ endmain func 1024 ; __</span></span>OpenCL<span class="hljs-emphasis"><span class="hljs-emphasis">_binarySearch_</span></span>kernel mov r1013, cb0[8].x mov r1019, l1.0000 dcl<span class="hljs-emphasis"><span class="hljs-emphasis">_max_</span></span>thread<span class="hljs-emphasis"><span class="hljs-emphasis">_per_</span></span>group 256 dcl<span class="hljs-emphasis"><span class="hljs-emphasis">_raw_</span></span>uav<span class="hljs-emphasis"><span class="hljs-emphasis">_id(11) dcl_</span></span>arena<span class="hljs-emphasis"><span class="hljs-emphasis">_uav_</span></span>id(8) mov r0.<span class="hljs-strong"><span class="hljs-strong">__z_, vThreadGrpIdFlat0.x mov r1022.xyz0, vTidInGrp0.xyz mov r1023.xyz0, vThreadGrpId0.xyz imad r1021.xyz0, r1023.xyzz, cb0[1].xyzz, r1022.xyzz iadd r1021.xyz0, r1021.xyz0, cb0[6].xyz0 iadd r1023.xyz0, r1023.xyz0, cb0[7].xyz0 mov r1023.__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_w, r0.z ishl r1023._</span></span><span class="hljs-strong"><span class="hljs-strong">__w, r1023.w, l0.z mov r1018.x__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_, l0.0000 udiv r1024.xyz_</span></span>, r1021.xyzz, cb0[10].xyzz imad r1025.xyz0, r1023.xyzz, cb0[10].xyzz, r1022.xyzz dcl<span class="hljs-emphasis"><span class="hljs-emphasis">_literal l13, 0x00000001, 0x00000001, 0x00000001, 0x00000001; f32:i32 1 dcl_</span></span>literal l11, 0x00000002, 0x00000002, 0x00000002, 0x00000002; f32:i32 2 dcl<span class="hljs-emphasis"><span class="hljs-emphasis">_literal l12, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF, 0xFFFFFFFF; f32:i32 4294967295 dcl_</span></span>cb cb1[6] ; Kernel arg setup: outputArray mov r1.x, cb1[0].x ; Kernel arg setup: sortedArray mov r1.y, cb1[1].x ; Kernel arg setup: findMe mov r1.z, cb1[2].x ; Kernel arg setup: globalLowerBound mov r1.w, cb1[3].x ; Kernel arg setup: globalUpperBound ; Kernel arg setup: subdivSize mov r2.y, cb1[5].x call 1029 ; binarySearch ret endfunc ; <span class="hljs-strong"><span class="hljs-strong">__OpenCL_binarySearch_kernel ;ARGSTART:__</span></span>OpenCL<span class="hljs-emphasis"><span class="hljs-emphasis">_binarySearch_</span></span>kernel ;version:2:0:88 ;device:juniper ;uniqueid:1024 ;memory:hwprivate:0 ;memory:hwregion:0 ;memory:hwlocal:0 ;pointer:outputArray:i32:1:1:0:uav:11:16:RW ;pointer:sortedArray:i32:1:1:16:uav:11:4:RO ;value:findMe:i32:1:1:32 ;value:globalLowerBound:i32:1:1:48 ;value:globalUpperBound:i32:1:1:64 ;value:subdivSize:i32:1:1:80 ;function:1:1029 ;uavid:11 ;privateid:1 ;ARGEND:<span class="hljs-strong"><span class="hljs-strong">__OpenCL_binarySearch_kernel func 1029 ; binarySearch ; @__</span></span>OpenCL<span class="hljs-emphasis"><span class="hljs-emphasis">_binarySearch_</span></span>kernel ; BB#0: ; %entry mov r65.x<span class="hljs-strong"><span class="hljs-strong">___, r2.y mov r65.__</span></span>z<span class="hljs-emphasis"><span class="hljs-emphasis">_, r1.z mov r65._</span></span><span class="hljs-strong"><span class="hljs-strong">__w, r1.y mov r66, r1021.xyz0 mov r66.x__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_, r66.x000 imul r66.x_</span></span><span class="hljs-strong"><span class="hljs-strong">__, r66.x, r65.x iadd r65._y__</span></span>, r66.x, r1.w mov r66.x<span class="hljs-strong"><span class="hljs-strong">___, l11 ishl r66._y__</span></span>, r65.y, r66.x iadd r66.<span class="hljs-emphasis"><span class="hljs-emphasis">_y_</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_, r65.w, r66.y mov r1010.x_</span></span><span class="hljs-strong"><span class="hljs-strong">__, r66.y uav_raw_load_id(11)_cached r1011.x__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_, r1010.x mov r66._</span></span>y<span class="hljs-strong"><span class="hljs-strong">__, r1011.x uge r66._y__</span></span>, r65.z, r66.y if<span class="hljs-emphasis"><span class="hljs-emphasis">_logicalnz r66.y iadd r65.x_</span></span><span class="hljs-strong"><span class="hljs-strong">__, r65.x, r65.y mov r66._y__</span></span>, l12 iadd r65.x<span class="hljs-strong"><span class="hljs-strong">___, r65.x, r66.y ishl r66.x__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_, r65.x, r66.x iadd r65._</span></span><span class="hljs-strong"><span class="hljs-strong">__w, r65.w, r66.x mov r1010.x__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_, r65.w uav_</span></span>raw<span class="hljs-emphasis"><span class="hljs-emphasis">_load_</span></span>id(11)<span class="hljs-emphasis"><span class="hljs-emphasis">_cached r1011.x_</span></span><span class="hljs-strong"><span class="hljs-strong">__, r1010.x mov r65.__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_w, r1011.x ult r65._</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_z_</span></span>, r65.w, r65.z if<span class="hljs-emphasis"><span class="hljs-emphasis">_logicalnz r65.z else mov r1010.x_</span></span><span class="hljs-strong"><span class="hljs-strong">__, r1.x uav_raw_load_id(11)_cached r1011, r1010 mov r66, r1011 iadd r66, r66.0yzw, r65.y000 iadd r66, r66.x0zw, r65.0x00 mov r65.x__</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_, l13 iadd r66, r66.xyz0, r65.000x mov r1011, r66 mov r1010.x_</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">__, r1.x uav_</span></span>raw<span class="hljs-emphasis"><span class="hljs-emphasis">_store_</span></span>id(11) mem0, r1010.x, r1011 endif else endif ret endfunc ; binarySearch ;ARGSTART:binarySearch ;uniqueid:1029 ;ARGEND:binarySearch end</code> </pre><br>  Here is the generated disassembled <abbr title="Instruction Set Architecture">ISA</abbr> file ( <i>binarySearch_Juniper.isa</i> file): <br><pre> <code class="hljs objectivec">ShaderType = IL_SHADER_COMPUTE TargetChip = c ; ------------- SC_SRCSHADER Dump ------------------ SC_SHADERSTATE: u32NumIntVSConst = <span class="hljs-number"><span class="hljs-number">0</span></span> SC_SHADERSTATE: u32NumIntPSConst = <span class="hljs-number"><span class="hljs-number">0</span></span> SC_SHADERSTATE: u32NumIntGSConst = <span class="hljs-number"><span class="hljs-number">0</span></span> SC_SHADERSTATE: u32NumBoolVSConst = <span class="hljs-number"><span class="hljs-number">0</span></span> SC_SHADERSTATE: u32NumBoolPSConst = <span class="hljs-number"><span class="hljs-number">0</span></span> SC_SHADERSTATE: u32NumBoolGSConst = <span class="hljs-number"><span class="hljs-number">0</span></span> SC_SHADERSTATE: u32NumFloatVSConst = <span class="hljs-number"><span class="hljs-number">0</span></span> SC_SHADERSTATE: u32NumFloatPSConst = <span class="hljs-number"><span class="hljs-number">0</span></span> SC_SHADERSTATE: u32NumFloatGSConst = <span class="hljs-number"><span class="hljs-number">0</span></span> fConstantsAvailable = <span class="hljs-number"><span class="hljs-number">1237488</span></span> iConstantsAvailable = <span class="hljs-number"><span class="hljs-number">1237456</span></span> bConstantsAvailable = <span class="hljs-number"><span class="hljs-number">1237520</span></span> u32SCOptions[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0x01A00000</span></span> SCOption_IGNORE_SAMPLE_L_BUG SCOption_FLOAT_DO_NOT_DIST SCOption_FLOAT_DO_NOT_REASSOC u32SCOptions[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00202000</span></span> SCOption_R600_ERROR_ON_DOUBLE_MEMEXP SCOption_SET_VPM_FOR_SCATTER u32SCOptions[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000041</span></span> SCOption_R800_UAV_NONARRAY_FIXUP SCOption_R800_UAV_NONUAV_SYNC_WORKAROUND_BUG216513_1 ; -------- Disassembly -------------------- <span class="hljs-number"><span class="hljs-number">00</span></span> ALU: ADDR(<span class="hljs-number"><span class="hljs-number">32</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">CNT</span></span>(<span class="hljs-number"><span class="hljs-number">12</span></span>) KCACHE0(CB0:<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-15</span></span>) KCACHE1(CB1:<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-15</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span> x: LSHR R1.x, KC1[<span class="hljs-number"><span class="hljs-number">0</span></span>].x, <span class="hljs-number"><span class="hljs-number">2</span></span> t: MULLO_INT ____, R1.x, KC0[<span class="hljs-number"><span class="hljs-number">1</span></span>].x <span class="hljs-number"><span class="hljs-number">1</span></span> y: ADD_INT ____, R0.x, PS0 <span class="hljs-number"><span class="hljs-number">2</span></span> w: ADD_INT ____, PV1.y, KC0[<span class="hljs-number"><span class="hljs-number">6</span></span>].x <span class="hljs-number"><span class="hljs-number">3</span></span> t: MULLO_INT ____, PV2.w, KC1[<span class="hljs-number"><span class="hljs-number">5</span></span>].x <span class="hljs-number"><span class="hljs-number">4</span></span> y: ADD_INT R1.y, KC1[<span class="hljs-number"><span class="hljs-number">3</span></span>].x, PS3 <span class="hljs-number"><span class="hljs-number">5</span></span> x: LSHL ____, PV4.y, <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> w: ADD_INT ____, KC1[<span class="hljs-number"><span class="hljs-number">1</span></span>].x, PV5.x <span class="hljs-number"><span class="hljs-number">7</span></span> y: LSHR R0.y, PV6.w, <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span> TEX: ADDR(<span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">CNT</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">8</span></span> VFETCH R0.x___, R0.y, fc153 MEGA(<span class="hljs-number"><span class="hljs-number">4</span></span>) FETCH_TYPE(NO_INDEX_OFFSET) <span class="hljs-number"><span class="hljs-number">02</span></span> ALU_PUSH_BEFORE: ADDR(<span class="hljs-number"><span class="hljs-number">44</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">CNT</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>) KCACHE0(CB1:<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-15</span></span>) <span class="hljs-number"><span class="hljs-number">9</span></span> z: SETGE_UINT R0.z, KC0[<span class="hljs-number"><span class="hljs-number">2</span></span>].x, R0.x <span class="hljs-number"><span class="hljs-number">10</span></span> x: PREDNE_INT ____, R0.z, <span class="hljs-number"><span class="hljs-number">0.0</span></span>f UPDATE_EXEC_MASK UPDATE_PRED <span class="hljs-number"><span class="hljs-number">03</span></span> JUMP POP_CNT(<span class="hljs-number"><span class="hljs-number">1</span></span>) ADDR(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-number"><span class="hljs-number">04</span></span> ALU: ADDR(<span class="hljs-number"><span class="hljs-number">46</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">CNT</span></span>(<span class="hljs-number"><span class="hljs-number">7</span></span>) KCACHE0(CB1:<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-15</span></span>) <span class="hljs-number"><span class="hljs-number">11</span></span> w: ADD_INT ____, KC0[<span class="hljs-number"><span class="hljs-number">5</span></span>].x, R1.y <span class="hljs-number"><span class="hljs-number">12</span></span> z: ADD_INT R1.z, <span class="hljs-number"><span class="hljs-number">-1</span></span>, PV11.w <span class="hljs-number"><span class="hljs-number">13</span></span> x: LSHL ____, PV12.z, <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> z: ADD_INT ____, KC0[<span class="hljs-number"><span class="hljs-number">1</span></span>].x, PV13.x <span class="hljs-number"><span class="hljs-number">15</span></span> y: LSHR R0.y, PV14.z, <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">05</span></span> TEX: ADDR(<span class="hljs-number"><span class="hljs-number">66</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">CNT</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">16</span></span> VFETCH R0.x___, R0.y, fc153 MEGA(<span class="hljs-number"><span class="hljs-number">4</span></span>) FETCH_TYPE(NO_INDEX_OFFSET) <span class="hljs-number"><span class="hljs-number">06</span></span> ALU_PUSH_BEFORE: ADDR(<span class="hljs-number"><span class="hljs-number">53</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">CNT</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>) KCACHE0(CB1:<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-15</span></span>) <span class="hljs-number"><span class="hljs-number">17</span></span> w: SETGT_UINT R0.w, KC0[<span class="hljs-number"><span class="hljs-number">2</span></span>].x, R0.x <span class="hljs-number"><span class="hljs-number">18</span></span> x: PREDE_INT ____, R0.w, <span class="hljs-number"><span class="hljs-number">0.0</span></span>f UPDATE_EXEC_MASK UPDATE_PRED <span class="hljs-number"><span class="hljs-number">07</span></span> JUMP POP_CNT(<span class="hljs-number"><span class="hljs-number">2</span></span>) ADDR(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-number"><span class="hljs-number">08</span></span> ALU: ADDR(<span class="hljs-number"><span class="hljs-number">55</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">CNT</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>) KCACHE0(CB1:<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-15</span></span>) <span class="hljs-number"><span class="hljs-number">19</span></span> z: LSHR R0.z, KC0[<span class="hljs-number"><span class="hljs-number">0</span></span>].x, <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">09</span></span> TEX: ADDR(<span class="hljs-number"><span class="hljs-number">68</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">CNT</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">20</span></span> VFETCH R0, R0.z, fc175 FORMAT(<span class="hljs-number"><span class="hljs-number">32</span></span>_32_32_32_FLOAT) MEGA(<span class="hljs-number"><span class="hljs-number">16</span></span>) FETCH_TYPE(NO_INDEX_OFFSET) <span class="hljs-number"><span class="hljs-number">10</span></span> ALU: ADDR(<span class="hljs-number"><span class="hljs-number">57</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">CNT</span></span>(<span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-number"><span class="hljs-number">21</span></span> x: MOV R0.x, R1.yy: MOV R0.y, R1.zw: MOV R0.w, (<span class="hljs-number"><span class="hljs-number">0x00000001</span></span>, <span class="hljs-number"><span class="hljs-number">1.401298464e-45</span></span>f).x <span class="hljs-number"><span class="hljs-number">11</span></span> MEM_RAT_CACHELESS_STORE_RAW: RAT(<span class="hljs-number"><span class="hljs-number">11</span></span>)[R1], R0, ARRAY_SIZE(<span class="hljs-number"><span class="hljs-number">4</span></span>) MARK VPM <span class="hljs-number"><span class="hljs-number">12</span></span> POP (<span class="hljs-number"><span class="hljs-number">2</span></span>) ADDR(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-number"><span class="hljs-number">13</span></span> NOP NO_BARRIER END_OF_PROGRAM ; ----------------- CS Data ------------------------ ; Input Semantic Mappings ; No input mappings GprPoolSize = <span class="hljs-number"><span class="hljs-number">0</span></span> CodeLen = <span class="hljs-number"><span class="hljs-number">560</span></span>;Bytes PGM_END_CF = <span class="hljs-number"><span class="hljs-number">0</span></span>; words(<span class="hljs-number"><span class="hljs-number">64</span></span> bit) PGM_END_ALU = <span class="hljs-number"><span class="hljs-number">0</span></span>; words(<span class="hljs-number"><span class="hljs-number">64</span></span> bit) PGM_END_FETCH = <span class="hljs-number"><span class="hljs-number">0</span></span>; words(<span class="hljs-number"><span class="hljs-number">64</span></span> bit) MaxScratchRegsNeeded = <span class="hljs-number"><span class="hljs-number">0</span></span> ;AluPacking = <span class="hljs-number"><span class="hljs-number">0.0</span></span> ;AluClauses = <span class="hljs-number"><span class="hljs-number">0</span></span> ;PowerThrottleRate = <span class="hljs-number"><span class="hljs-number">0.0</span></span> ; texResourceUsage[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; texResourceUsage[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; texResourceUsage[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; texResourceUsage[<span class="hljs-number"><span class="hljs-number">3</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; texResourceUsage[<span class="hljs-number"><span class="hljs-number">4</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; texResourceUsage[<span class="hljs-number"><span class="hljs-number">5</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; texResourceUsage[<span class="hljs-number"><span class="hljs-number">6</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; texResourceUsage[<span class="hljs-number"><span class="hljs-number">7</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; fetch4ResourceUsage[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; fetch4ResourceUsage[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; fetch4ResourceUsage[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; fetch4ResourceUsage[<span class="hljs-number"><span class="hljs-number">3</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; fetch4ResourceUsage[<span class="hljs-number"><span class="hljs-number">4</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; fetch4ResourceUsage[<span class="hljs-number"><span class="hljs-number">5</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; fetch4ResourceUsage[<span class="hljs-number"><span class="hljs-number">6</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; fetch4ResourceUsage[<span class="hljs-number"><span class="hljs-number">7</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; texSamplerUsage = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; constBufUsage = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ResourcesAffectAlphaOutput[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ResourcesAffectAlphaOutput[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ResourcesAffectAlphaOutput[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ResourcesAffectAlphaOutput[<span class="hljs-number"><span class="hljs-number">3</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ResourcesAffectAlphaOutput[<span class="hljs-number"><span class="hljs-number">4</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ResourcesAffectAlphaOutput[<span class="hljs-number"><span class="hljs-number">5</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ResourcesAffectAlphaOutput[<span class="hljs-number"><span class="hljs-number">6</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ResourcesAffectAlphaOutput[<span class="hljs-number"><span class="hljs-number">7</span></span>] = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ;SQ_PGM_RESOURCES = <span class="hljs-number"><span class="hljs-number">0x30000102</span></span> SQ_PGM_RESOURCES:NUM_GPRS = <span class="hljs-number"><span class="hljs-number">2</span></span> SQ_PGM_RESOURCES:STACK_SIZE = <span class="hljs-number"><span class="hljs-number">1</span></span> SQ_PGM_RESOURCES:PRIME_CACHE_ENABLE = <span class="hljs-number"><span class="hljs-number">1</span></span> ;SQ_PGM_RESOURCES_2 = <span class="hljs-number"><span class="hljs-number">0x000000C0</span></span> SQ_LDS_ALLOC:SIZE = <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> ; RatOpIsUsed = <span class="hljs-number"><span class="hljs-number">0x800</span></span> ; NumThreadPerGroupFlattened = <span class="hljs-number"><span class="hljs-number">256</span></span> ; SetBufferForNumGroup = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre><br>  I do not know about you, but it would be unpleasant for me if my super algorithm for the GPU could be so easily pulled out of the program and analyzed.  Especially if the whole essence of the program would be in this algorithm (smile). <br><br><h2>  Analysis of the situation </h2><br>  This behavior is typical only for the OpenCL compiler from AMD and only when running the application on an AMD GPU.  If the Nvidia OpenCL compiler is installed on the system, then, naturally, no files are generated on the disk. <br><br>  As you understand, this opportunity was left for the developers to analyze their OpenCL code.  After all, the resulting files can be pushed into the profiler and see what operations will be a bottleneck in the program.  However, if you do not know about this global variable, you can lose your intellectual property fairly quickly. <br><br>  If you look closely at the generated <i>binarySearch_Juniper.il</i> file, then the hair can stand on end from this code: the original core for OpenCL can be rewritten in AMD <abbr title="Intermediate Language">IL</abbr> language in 20 lines, but not in 100!  This suggests that the applications written on OpenCL for AMD GPUs at the moment will not be as fast as applications using AMD <abbr title="Intermediate Language">IL</abbr> technology to interact with the GPU. <br><br>  How to understand written in the file <i>binarySearch_Juniper.il</i> , described <a href="http://habrahabr.ru/blogs/hi/138954/" title="AMD APP SDK: Intermediate Language (IL)">here</a> . <br>  How you can use the <i>binarySearch_Juniper.il</i> file in your program is described <a href="http://habrahabr.ru/blogs/hi/139049/" title="AMD APP SDK: Compute Abstraction Layer (CAL)">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/139499/">https://habr.com/ru/post/139499/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../139493/index.html">Flash Number Mathematics with Twinning DisplayObject</a></li>
<li><a href="../139495/index.html">Windows 8 Camp - as it were</a></li>
<li><a href="../139496/index.html">lancelist.0fees.net - a site for finding freelance work on Twitter</a></li>
<li><a href="../139497/index.html">We color the Windows console under Khokhloma</a></li>
<li><a href="../139498/index.html">Remart: how I created my business</a></li>
<li><a href="../139500/index.html">The first Cyrillic geo domain is spb.rf. Start</a></li>
<li><a href="../139501/index.html">Obama Boot vs. Trojan printer. Who will win?</a></li>
<li><a href="../139502/index.html">Asus officially recognized the DD-WRT as an alternative firmware</a></li>
<li><a href="../139503/index.html">Copyright: And what laws, in fact, do we want?</a></li>
<li><a href="../139504/index.html">Digium Switchvox update to version 5.5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>