<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Improving colors on the web (for eplofilov)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is a translation of the publication in the Web Kit blog. 

 The past few years have seen a significant improvement in display technology. At firs...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Improving colors on the web (for eplofilov)</h1><div class="post__text post__text-html js-mediator-article">  <em>This is a translation of the <a href="https://webkit.org/blog/6682/improving-color-on-the-web/">publication</a> in the Web Kit blog.</em> <br><br>  The past few years have seen a significant improvement in display technology.  At first it was an upgrade to higher resolution screens, started with mobile devices, and then transferred to desktops and laptops.  Web developers had to understand what it means for them to have a high value in DPI, and to know how to design pages that use such high resolution.  The next revolutionary display improvement is happening right now: improved color rendering.  In this article, I would like to clarify what this means, and how you, developers, can identify such displays and provide better interaction for your users. <br><a name="habracut"></a><br>  Take a typical computer monitor ‚Äî a type that you have been using for over a decade ‚Äî the sRGB display.  The latest Apple designs, including the Retina iMac (late 2015) and iPad Pro (early 2016), can display more colors than the sRGB display.  Such displays are called wide-gamut displays (an explanation of the terms ‚ÄúsRGB‚Äù and ‚Äúcolor gamut‚Äù will be given below). <br><br>  Why is this useful?  A system with a wide color gamut often provides a more accurate reproduction of the original color.  For example, my colleague by the name of <a href="http://twitter.com/hober">Hober</a> has some catchy sneakers. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/9da/ac6/dd8/9daac6dd804a29304695080d937b188f.jpg"><br>  Bright orange hober sneakers <br><br>  Unfortunately, what you see above does not convey how impressive these sneakers are in fact!  The problem is that the color of the sneaker material cannot be represented on the sRGB display.  The camera that captured this photo (Sony a6300) has a matrix that perceives more accurate color information, and the corresponding data is available in the original file, but the display cannot show them.  Here is a variant of the photo, in which every pixel that has a color that goes beyond the border of a typical display is replaced with a light blue: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8e4/6ec/da0/8e46ecda087d58b7f8d09cd1c0a981d7.jpg"><br>  The same bright orange Hober sneakers, but here all the pixels that go beyond the boundaries of color, replaced by blue <br><br>  As you can see, the color of the material of the sneakers and a large part of the grass goes beyond the border of the sRGB display.  In fact, only less than half the pixels are accurately represented.  Being a web developer, you need to reckon with this.  Suppose you sell such sneakers through an online store.  Your customers will not know exactly what color they ordered, and may be surprised when their purchase comes to them. <br><br>  This problem is reduced when using a display with a wide color gamut.  If you have one of the devices mentioned above, or something similar, here is a photo version that will show you more colors: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bc0/ffb/727/bc0ffb727c34f1448b4da3d2f2d9057e.jpg"><br>  The same bright orange Hober sneakers, but added a color profile <br><br>  On the display with a wide color gamut you can see sneakers of a brighter orange color, green grass is also more varied in color.  If you, unfortunately, do not have such a display, then you most likely see something very close in color to the first photo.  In this case, the best I can offer is to color the image, highlighting the areas you lose in color. <br><br>  In any case, this is good news!  Wide-gamut displays are brighter and provide a more accurate representation of reality.  Obviously, there is a desire to make sure that you can provide your users with an image formation in which this technology will be useful. <br><br>  Below is the following example, this time with the generated image.  Users on the sRGB display can see a uniform red square below.  However, this is in some way a trick.  In fact, there are two shades of red in the image, one of which can only be seen on displays with a wide color gamut.  On this display, you will see the pale WebKit logo inside the red square. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/19a/2d3/279/19a2d327908db8ff269a26095c178faa.png"><br>  Red square with a pale WebKit logo <br><br>  Sometimes the difference between a normal image and an image with a wide color gamut is very subtle.  Sometimes it is expressed much more sharply. <br><br><h1>  Demo images </h1><br>  On <a href="http://webkit.org/blog-files/color-gamut/">the sample page,</a> you can compare different versions of images, as well as see where the image contains pixels that are beyond the sRGB display color border.  There is also a <a href="http://webkit.org/blog-files/color-gamut/comparison.html">more interactive version</a> , showing a number of different images. <br><br><h1>  Definitions </h1><br>  The following is a brief explanation of terms commonly used in color discussions. <br><br>  <strong>Color space.</strong>  Color space is the environment in which you can set and compare colors.  There are several types of color space, each of which uses a different set of parameters to describe colors.  For example, a gray color space has only one parameter that controls the level of brightness in the transition from black to white.  You are probably familiar with RGB-type color spaces, which use red, green, and blue as parameters, which are added together on the display to create the desired color.  Printing processes often use CMYK-type color spaces, where the ink color is composed of cyan, magenta, yellow, and black. <br><br>  <strong>Color profile.</strong>  In 1993, a group of suppliers formed the International Color Image Processing ( <a href="http://color.org/">ICC</a> ) Consortium to set a standard describing color spaces.  A color profile is data that defines the color space of a device, and can be used to transition between different color spaces.  The most common are names like <a href="https://en.wikipedia.org/wiki/SRGB">sRGB</a> (or more formally, IEC 61966-2-1).  My use of the above sRGB name now makes more sense: such a display can show colors that match the sRGB color space.  A color profile can be recorded in some file or embedded directly in the image, which allows the computer to understand what the values ‚Äã‚Äãfor color in the image actually mean. <br><br>  <strong>Color gamut.</strong>  Color gamut is a spectrum of colors that a device can process or that can specify a color space.  The color gamut for a computer display is all the colors that the display can accurately display.  The concept of rendering color gamut seems somewhat more difficult, but it is a bit like the color pickers found in the developer's software.  Imagine a palette of all possible colors, superimposed on the surface, with primary colors at several points of extremes.  When moving to the red extreme, the color becomes more red.  When moving to blue - more blue, etc.  The color gamut is an area on an imaginary surface in question, indicating how much the color of a given device can be shifted in one direction or another.  The color gamut can be understood on the basis of the chart below;  here the colored surface shows a palette of colors perceived by the human eye.  A white triangle is an area of ‚Äã‚Äãthe sRGB color space (as you can see, it is substantially smaller than the eye sees). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/372/85c/476/37285c47699d84c2af4584cad05956b5.png"><br>  Chart showing sRGB color gamut <br><br>  These charts can be a bit disorienting because they show you colors that you can clearly see, and then tell you that the color gamut does not contain those colors.  However, they provide a good way to compare the size of different color gamut.  Note also that here you see a two-dimensional representation of the surface of the color gamut, when in reality it is located in three- or four-dimensional space (all this is quite difficult - we are now trying to give a simple introduction to the topic). <br><br>  <strong>Wide color gamut.</strong>  This term informally operates in the industry to describe devices or color spaces that have a color gamut greater than that of sRGB (which almost all computer displays used in the last ten or so years possess) have.  Displays with a wider color gamut have already been available on the market for some time, but they were limited mainly by professional use.  Now they are available for ordinary consumers, which means that there are more colors available.  Sometimes a wide color gamut is called extended color rendering.  Modern Apple displays support the Display P3 color space, which is about 25% wider than sRGB. <br><br>  <strong>Depth of color.</strong>  Computers can use different levels of accuracy or depth to represent colors.  This is not the same as the color gamut describing the color palette.  Rather, it is the number of individual colors within the color gamut that can be specified.  Web developers usually know CSS <code>rgb()</code> syntax, which has 0-255 values ‚Äã‚Äãfor red, green, and blue.  This gives a depth of 8 bits per channel - a total of 16,777,216 colors.  If you add the fourth color component / degree of transparency, you can save the color in 32 bits.  If a depth of 8 bits per channel is used, then only the same number of colors can always be reproduced, regardless of the color space used - there will be just another set of colors.  If you select 16 bits per channel, the space will be deeper, and you can get more colors inside the same color gamut.  A good example is to draw a gradient between similar colors: banding can be seen when the computer and the display do not have the required depth to show a smooth range of colors between the end points. <br><br>  The example below shows how insufficient color depth causes banding, although all colors between the end points are within the color gamut (this is a somewhat artificial example to enhance the effect). <br><br>  The reduced color depth shows distinct transitions between similar colors. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c04/0ac/999/c040ac9992dbe3bb479f8e989e6ca41b.png"><br>  Gradient from light red to dark red with distinct stripes <br><br>  As the color depth increases, the transitions become much less noticeable. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/666/92d/d81/66692dd814cbf8ac0fcdc8bad40228c0.png"><br>  Gradient from light red to dark red without pronounced stripes <br><br>  After this introduction, we will take a closer look at the color on the web and the latest improvements in WebKit that help develop content with an improved understanding of color-related issues.  We will also provide information about some of the features we introduced in the W3C that will enable you to get even more value from this new display technology. <br><br><h1>  Colors on the web </h1><br>  The network often tries its best to process colors correctly.  I‚Äôm sure there are those among the readers who remember the pain of <a href="https://en.wikipedia.org/wiki/Web_colors">safe web colors</a> with pain!  As we walked away from this, we still have limitations, such as working HTML and CSS only in the sRGB color space.  As in the example with the <a href="https://twitter.com/hober/">Hober</a> sneakers above, this means that there are many colors that your CSS, images and canvases cannot reproduce.  This is a problem if you are trying to show your family spring flowers blooming in your garden, or shopping for a bright red sports car that will certainly help in resolving your mid-life crisis. <br><br>  So, when we show a photo of the sneakers above, the sRGB display compresses all colors outside of the sRGB color gamut into colors that it can show.  But a display with an extended gamut, such as Display P3, does not make such a shift to the sRGB palette.  In the figure below you can see the difference between the sRGB color space and Display P3. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8f/0ba/cb8/e8f0bacb8c2be878c401c23a2126f4cd.png"><br>  SRGB and P3 color range comparison <br><br>  The colored triangle is the sRGB space.  The white triangle shows the display space P3.  It is much larger than that of sRGB, especially in the areas of the most saturated colors - red, yellow, violet and green.  The black outline shows the capabilities of a typical human eye. <br><br>  Remember the red square with the pale WebKit logo?  The image was created in the Display P3 color space, filled with 100% red <code>rgb(255, 0, 0)</code> , and then the logo was entered with a slightly different red <code>rgb(241, 0, 0)</code> color <code>rgb(241, 0, 0)</code> .  The sRGB logo is not visible on the display, since all red values ‚Äã‚Äãabove 241 in Display P3 are above the uppermost red border in sRGB;  red 241 and red 255 are perceived as one color. <br><br>  <em>Note.</em>  <em>I saw on Twitter that a small misunderstanding arises here, so let's try an alternative explanation.</em>  <em>Basically, all completely red values ‚Äã‚Äãbetween 241/255 and 255/255 in the Display P3 color space do not differ when viewed in sRGB.</em>  <em>This does not mean that the red 241 in Display P3 is the same as the red in 255 in sRGB ‚Äî unfortunately, it is not so simple here, and I would not like to go into details in this introductory article.</em>  <em>For those who are interested: in macOS there is an application Color Sync Utility, which allows you to convert color spaces in different ways, as well as compare color coverage.</em> <br><br>  So, now you understand why you need to know deeper the situation with color and that this technology should be used to provide users with better interaction.  What has been said above is the basis - now let's talk about what it means for WebKit. <br><br><h1>  Color matched images </h1><br>  It was mentioned above that the network is ‚Äúsharpened‚Äù under the use of sRGB.  WebKit / Safari on Mac has been working in this color space for many years, providing the user with consistent colors on various displays (by the time of this writing, most of the other browser cores work in the so-called color space of the device, i.e. until they go through the display hardware). <br><br>  WebKit color coordinates all images in both iOS and macOS.  This means that for an image with a color profile, you can be sure that the color on the display is correct, regardless of whether it is a normal display or a display with a wide digital coverage.  This is useful because many digital cameras do not use sRGB in their original format, which is why simply interpreting the values ‚Äã‚Äãof red, green and blue as such is unlikely to give the correct color.  Usually the user does not want to do anything to obtain this color matching.  Almost all image processing software allows you to embed a color profile into an image;  Many programs do this by default. <br><br>  In the examples shown above, you can see this color matching action on Safari from OS X 10.11.3 and above, as well as on iOS 9.3 and above (Retina devices).  All I had to do was make sure the images contained an appropriate color profile. <br><br>  If the image does not carry a profile, then WebKit assumes that sRGB takes place.  This makes it easy to match your designations in CSS (for example, a frame or background images).  This means that the CSS value of <code>rgb(255, 0, 0)</code> will correspond to the corresponding value for full red in sRGB. <br><br>  <em>Note.</em>  <em>The assumption that an image that does not carry the corresponding tags (about a color profile) should not necessarily be attributed to sRGB requires some comment.</em>  <em>The reason why we do this is explained above: this approach allows for matching colors in the image with CSS colors on the page.</em> <br><br>  The situation is normal for display technology used in the last ten years.  But now, when there are displays that support extended color gamut, there is a desire to more fully control the way in which your content appears. <br><br><h1>  Display detection </h1><br>  It was explained above why it is preferable to submit images with a wide color gamut to the same display.  If an image with a wide gamut comes to a regular display, then WebKit, matching the colors of the images, will show it in sRGB space.  However, this conversion to sRGB can be done in several ways, and there is no guarantee that it will run the same on different browsers or platforms.  An experienced web developer has the desire to be able to convert images offline to better control what the end user will see.  In addition, embedding a color profile slightly increases the file size.  There is not always a desire to send these special data if they are not required. <br><br>  The best solution is to provide an image with a wide color gamut, when the user has such a display, and an sRGB image with a different display.  This situation is one of the directions of adaptive images and shows exactly what elemental and media queries should handle. <br><br>  WebKit now supports (new to CSS Color Level 4) media query for <a href="https://drafts.csswg.org/mediaqueries-4/">color gamut</a> .  The following shows how to use it: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">picture</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">media</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(color-gamut: p3)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">srcset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"photo-wide.jpg"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"photo-srgb.jpg"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">picture</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  This query can also be used inside the style sheet: <br><br><pre> <code class="hljs css"><span class="hljs-selector-class"><span class="hljs-selector-class">.main</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">"photo-srgb.jpg"</span></span>); } @<span class="hljs-keyword"><span class="hljs-keyword">media</span></span> (color-gamut: p3) { <span class="hljs-selector-class"><span class="hljs-selector-class">.main</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">"photo-wide.jpg"</span></span>); } }</code> </pre> <br>  Or as a script: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">window</span></span>.matchMedia("(color-gamut: p3)").matches) { // <span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> especially colorful stuff here. }</code> </pre> <br>  The color gamut request takes the values ‚Äã‚Äãof <code>3</code> and <code>rec2020</code> as values ‚Äã‚Äãthat are intentionally inaccurate terms to specify a palette of colors supported by the system, including the browser core and the display hardware.  By default, since almost all displays support sRGB, there is no need to check for such functionality.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But a typical modern display with a wide color gamut can support all or almost the entire color palette included in the </font></font><a href="https://en.wikipedia.org/wiki/DCI-P3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DCI P3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> space </font><font style="vertical-align: inherit;">and will correspond to the media query. For example, the Display P3 space mentioned above is one of the DCI P3 options. The value of rec2020 indicates that the system has a display that supports an even wider color gamut, such as that defined by the </font></font><a href="https://en.wikipedia.org/wiki/Rec._2020"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rec</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> space </font><a href="https://en.wikipedia.org/wiki/Rec._2020"><font style="vertical-align: inherit;">. 2020</font></a><font style="vertical-align: inherit;"> (at present, it is quite rare to meet on the network with hardware that, in fact, supports Rec. 2020, you should not worry about it for now).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Since media queries have a robust recovery system, you can start using color gamut immediately to give users wider color gamut better colors, allowing users who do not yet have the corresponding browsers or hardware to work. </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Future directions </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Providing and rendering images with a wide color gamut are relatively simple processes, but what if you need to combine some image with other page elements, such as background color, or enter an image into a canvas element? </font><font style="vertical-align: inherit;">These are some of the problems that standardization bodies face, and I would like to talk about what can be expected here.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wide color gamut in CSS </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It was shown above that </font></font><code>rgb(241, 0, 0)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in Display P3 is the same as </font></font><code>rgb(255, 0, 0)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in sRGB. </font><font style="vertical-align: inherit;">What needs to be done if you need a color that is set in CSS, enter it somehow in an image with a wide color gamut? </font><font style="vertical-align: inherit;">We can't set these colors in CSS. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The following describes what WebKit project participants proposed for CSS. </font><font style="vertical-align: inherit;">The idea is to add a new function, called </font></font><code>color()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which may contain a color profile, as well as parameters that define the color:</font></font><br><br><pre> <code class="hljs css"><span class="hljs-comment"><span class="hljs-comment">/* </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">NOTE:</span></span></span><span class="hljs-comment"> Proposed syntax. Not yet implemented. */</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">strong</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">color</span></span>(p3 1.0 0 0); <span class="hljs-comment"><span class="hljs-comment">/* 100% red in the P3 color space */</span></span> }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In practice, it would probably be used with the rule </font></font><code>@supports</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">strong</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">rgb</span></span>(255, 0, 0); <span class="hljs-comment"><span class="hljs-comment">/* 100% red in the sRGB color space */</span></span> } @<span class="hljs-keyword"><span class="hljs-keyword">supports</span></span> (color: color(p3 <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-selector-tag"><span class="hljs-selector-tag">strong</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">color</span></span>(p3 1.0 0 0); <span class="hljs-comment"><span class="hljs-comment">/* 100% red in the P3 color space */</span></span> } }</code> </pre> <br><br>  <em>Note.</em> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I originally made a typo, showing the syntax as </font></font><code>color(p3, 255, 0, 0)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This is one of the disadvantages of the existing function </font></font><code>rgb()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The new function </font></font><code>color()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will accept floating-point numbers as parameters, not 8-bit integers.</font></font></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The CSS will set some well-known color profile names, making it easy to find the desired color values. There is still some discussion about the permission of authors to refer to external profiles or perhaps indicate an image that has a built-in profile. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Additionally, CSS can make a decision to determine values ‚Äã‚Äãbeyond 0-255 (or 0-100%) in an existing function </font></font><code>rgb()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. For example,</font></font><code>rgb(102.34%, -0.1%, 4%)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the color will be slightly more red, a little less green and a bit more blue. The difficulty here is that understanding these values ‚Äã‚Äãcan be difficult (for example, what does a negative green color mean?). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another suggestion is to set the color space for the entire document and interpret regular CSS color values ‚Äã‚Äãin it. For external images with embedded profiles, color matching will occur accordingly. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">These discussions are under way in the W3C CSS working group for the time being. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Your opinion interests us</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the group needs to know more what web developers think. If you are interested in participating, then pay attention to e-mail messages with a topic starting with "[css-color]" in</font></font><a href="http://lists.w3.org/archives/Public/www-style/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WWW-style email list</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebKit hopes to implement these properties when we are sure that they are justifiable.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wide color gamut in HTML </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Although CSS works with most views of HTML documents, there is one important area in which this color space does not work: the canvas element. </font><font style="vertical-align: inherit;">Both 2D and WebGL canvases assume that they work in the sRGB color space. </font><font style="vertical-align: inherit;">This means that even on displays with a wide color gamut it is impossible to create a full-color canvas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a solution, it is proposed to add an optional flag to the function </font></font><code>getContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that sets the color space to which the canvas should be adjusted.</font></font> For example: <br><pre> <code class="hljs pgsql">// NOTE: Proposed syntax. <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> yet implemented. canvas.getContext("2d", { colorSpace: "p3" });</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this case, there are some points to be considered, for example, how to create canvases with increased depth of color. For example, in WebGL you can use half-float textures that give an accuracy of 16 bits per color channel. However, even if such deeper textures are used in WebGL, you will be limited to 8-bit precision by embedding this WebGL image into the document. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is necessary to give the developer a method for setting the depth of the color buffer for the canvas element. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is achieved in a more complex way by combining functions </font></font><code>getImageData/putImageData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(or the equivalent</font></font><code>readPixels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in webgl). </font><font style="vertical-align: inherit;">With today's 8 bits per channel buffer, there is no loss of accuracy when entering and outputting to the canvas. </font><font style="vertical-align: inherit;">Conversion can also occur efficiently, both in performance and in memory, since the canvas and program data are of the same type. </font><font style="vertical-align: inherit;">If the color depth is different, then it may be impossible. </font><font style="vertical-align: inherit;">For example, the WebGL half-float buffer does not have an equivalent type in JavaScript, which means either forced some data conversion when reading or writing, as well as the use of additional memory during their storage, or the need to work with the original array buffer and perform cumbersome mathematical operations with bitwise masks. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Such discussions are currently on </font></font><a href="https://github.com/whatwg/html/issues/299"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the WhatWG website.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and will be continued soon in the W3C. </font><font style="vertical-align: inherit;">And again we invite you to join.</font></font><br><br><h1>  findings </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wide-gamut displays have entered the market and are the future of computing devices. </font><font style="vertical-align: inherit;">As the number of users of these magnificent displays grows, developers will be more and more interested in mastering the stunning palette of colors offered and in providing users with an increasingly attractive interaction with the network. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebKit software provides developers with great opportunities to improve color characteristics by matching color and detecting the gamut of colors available today from Safari Technology Preview, as well as from macOS Sierra and iOS 10 betas. </font><font style="vertical-align: inherit;">We are also interested in the beginning of the implementation of more advanced color characteristics, such as setting a wide color gamut in CSS, the introduction of profiles into canvas elements and the use of increased color depth.</font></font></div><p>Source: <a href="https://habr.com/ru/post/305842/">https://habr.com/ru/post/305842/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../305832/index.html">After a year of using NodeJS to develop</a></li>
<li><a href="../305834/index.html">Reuse rows for high performance on React Native ListView</a></li>
<li><a href="../305836/index.html">Mobile programmatic "on the fingers": the revolution will be velvet</a></li>
<li><a href="../305838/index.html">Big Data from A to Z. Part 5.2: Advanced hive features</a></li>
<li><a href="../305840/index.html">Basics of game design: 20 board games. Part Four: Train Ticket, Carcassonne, Colonialists</a></li>
<li><a href="../305844/index.html">Lenovo will fix a 0day ThinkPwn vulnerability in the firmware of its computers</a></li>
<li><a href="../305846/index.html">API Yandex.Panoram: how to make your virtual walk or just bring a person from the subway</a></li>
<li><a href="../305848/index.html">A collection of songs with a guitar to the day of the system administrator (with chords!)</a></li>
<li><a href="../305850/index.html">Tales of Ransomwhere</a></li>
<li><a href="../305852/index.html">Azure DevTest Labs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>