<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with subdomains in MODx</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Here a question came from a friend: 
 Good afternoon! 

 I read an article about the friendship of ModX and LS , and decided to ask a question that I ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with subdomains in MODx</h1><div class="post__text post__text-html js-mediator-article">  Here a question came from a friend: <br><blockquote>  Good afternoon! <br><br>  I read an article about the <a href="http://habrahabr.ru/post/151540/">friendship of ModX and LS</a> , and decided to ask a question that I myself can‚Äôt decide in ModX how to implement the logic of Revo depending on the current subdomain of the main site? <br><br>  I see on pro-cent.ru that the name of the city is placed in the subdomain (http://kaliningrad.pro-cent.ru/).  Does ModX help in handling this, or is everything done with your hands and your code? </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I decided to give an answer to the audience, probably someone will come in handy too. <a name="habracut"></a><br><br>  In general, it was already written on Habr√© that to work with several domains (more precisely, switching between them), you need to use the $ modx-&gt; switchContext ($ ctx) method;  This is certainly a very useful thing, but in our case it does not save us, as in the case of switching to another context, we lose the opportunity to just access the documents of our basic context (in this case, the web), as well as with the subtlety context settings there is.  In general, $ modx-&gt; switchContext () is needed when the target context is completely independent, has its own documents, etc. <br><br>  In my case, I have a basic context and it already has all the documents I need, and contexts in cities a la krasnodar are needed only to reload some settings (each context has its own settings such as basic domain, city, code I .Metrics, etc.), in general, all that is easy to determine which shares to display, etc. <br><br>  So, I advise everyone to pay more attention to plugins.  They are not so much dedicated to those, but it is the plugins that allow you to arbitrarily wedge into the logic of MODx, while not touching the code of the engine itself. <br><br>  In general, in order to solve our problem, we do the following: <br><br>  1. Create the necessary contexts and write the necessary settings in them. <br><br>  2. Create a plugin and specify the execution of the OnHandleRequest event <br><br>  3. In the plugin we write the following (or something like that) <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//         switch($modx-&gt;context-&gt;key){ case 'web': break; default: return; } //    3-   ,     if(preg_match('/([^\.]+)\.[^\.]+\.[^\.]+$/',$_SERVER['HTTP_HOST'], $match)){ if($ctx = $modx-&gt;getObject('modContext', $match[1])){ //    if($ctx-&gt;prepare()) { //   MODx- //   ,         API $modx-&gt;getOption(); //   ,         [[++site_name]],       //   $modx-&gt;config = array_merge($modx-&gt;config, $ctx-&gt;config); } } } //      // -   ,         , //  -    //    if(!$host &amp;&amp; (!$host = $modx-&gt;config['mainHost'])) { // print "      ".$modx-&gt;context-&gt;key; return; } // print $host; $redir_host = ''; $redir_url = ''; //         switch($modx-&gt;event-&gt;name){ case 'OnPageNotFound': break; case 'OnHandleRequest': break; default: ; } //      if(!preg_match('/^'.$host.'$/i', $_SERVER['HTTP_HOST'])){ $redir_host = $host; $redir_url = $_SERVER['REQUEST_URI']; } //       ,   301-  (  ) if($redir_host || $redir_url){ $params = array(); $redir_url ? $params['url'] = $redir_url : ""; $redir_host ? $params['hostl'] = $redir_host : ""; $modx-&gt;runSnippet('redirect', $params); }</span></span></code> </pre> <br><br>  Actually everything. </div><p>Source: <a href="https://habr.com/ru/post/151751/">https://habr.com/ru/post/151751/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151744/index.html">Method of geometric parallelism and some more about MPI</a></li>
<li><a href="../151745/index.html">Mir station telemetry generator, or why it is impossible to offend programmers</a></li>
<li><a href="../151746/index.html">Change from Growl to Notification Center</a></li>
<li><a href="../151747/index.html">LG and Qualcomm jointly unveiled the LG Optimus G, the first smartphone on the Snapdragon S4 Pro</a></li>
<li><a href="../151749/index.html">Microsoft updates old versions of Skype, regardless of the desires of users</a></li>
<li><a href="../151752/index.html">Traffic police are planning to equip ... iPad'om</a></li>
<li><a href="../151753/index.html">Humble Indie Bundle 6</a></li>
<li><a href="../151754/index.html">The meaning of software life</a></li>
<li><a href="../151756/index.html">Smiley :-) turned 30 years old</a></li>
<li><a href="../151759/index.html">Blocking YouTube was tested on Omsk users of Rostelecom</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>