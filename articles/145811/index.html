<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pivot 360 or what solutions we used. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, only the lazy does not do a project in the field of online travel. This is basically logical, because the market is growing rapidly, although t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pivot 360 or what solutions we used. Part 1</h1><div class="post__text post__text-html js-mediator-article">  Today, only the lazy does not do a project in the field of online travel.  This is basically logical, because the market is growing rapidly, although there are few free niches, and the business is complex.  Many have already been able to raise serious investments in <a href="http://habrahabr.ru/post/129184/">hotel booking</a> services or selling vouchers online. <br><br>  Last December, we entered this market with the iknow.travel project, relying on combining the sale of airline tickets and a content resource, but after 3 months (in February) we decided to rewrite the project from scratch, and we didn‚Äôt even withdraw the ticket part from test at that time. <br><br>  About why this was done in terms of the development strategy of the project, we will lay out a separate post in the near future.  Now we want to describe what tasks we had to solve and what technologies were used on the way from the initial release of <a href="http://iknow.travel/">air tickets + content</a> to <a href="http://beta.iknow.travel/">the travel designer</a> (the development of the new version took 3 months). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  WHAT HAPPENED <br></h4><br><img src="https://habrastorage.org/getpro/habr/post_images/65e/48e/d0f/65e48ed0fea54fbe528f6028ec389ff4.png" alt="image"><br><br><h4>  WHAT BECAME <a name="habracut"></a><br></h4><br><img src="https://habrastorage.org/getpro/habr/post_images/eb7/9d0/d79/eb79d0d79edc25644d3303b878101c9f.png" alt="image"><br><br><h4>  WHAT THEY WERE DOING <br></h4><br>  Initially, we set a goal: to leave the site completely open to search engines, while doing so in the style of a one-page application.  One-page websites have difficulty with SEO.  Google in such cases recommends the so-called <a href="https://developers.google.com/webmasters/ajax-crawling/docs/specification">Hash Fragments</a> .  The bottom line is this: all links begin with "#!", And the robot only replaces "#!"  on "? _escaped_fragment =", makes a request and waits for static HTML in response.  And it works.  We preferred the good old method.  Most of the site is available in HTML, which allows search engines to see the pages as on a regular static site (although it was not without compromises).  True there are rumors that <a href="http://swapped.tumblr.com/post/23133779276/google-bot-now-crawls-arbitrary-javascript-sites">Googlebot already understands AJAX</a> , but somehow we are not inclined to trust them.  And with the usual browser we work on HTML5 PushState (which support is in all modern browsers except IE 9), with automatic switching to a hash URL if HTML5 PushState is not available.  <b>And how would you do?</b> <br><br><h5>  FURTHER, STACK SELECTION </h5><br>  We have decided to choose the language for the task.  For server frontend, node.js became the optimal choice.  This rather popular platform allowed us to separate the code and templates between the client and the server.  JavaScript is a good functional language.  But pure JS is exhausting lack of syntactic sugar and tedious with support, so we use CoffeeScript. <br><br><h5>  Backback </h5><br>  Our client is written on the basis of Backbone.  Backbone is a JS framework for interactive applications.  Everything is built on the basis of 4 concepts: <br><ul><li>  Model </li><li>  View </li><li>  Collection </li><li>  Router </li></ul><br>  Their interpretation in Backbone differs from the generally accepted ones.  First, the model is separated from the base.  It comes bundled with a REST CRUD API, but there are <a href="https://github.com/jeromegn/Backbone.localStorage">adapters for HTML5 LocalStorage</a> , <a href="https://github.com/janmonschke/backbone-couchdb">WebSockets</a> .  Secondly, the View is usually not even a View at all, but a controller in the usual sense.  I will make a reservation that the terminology is a purely subjective matter, and the authors of Backbone directly say: <a href="http://documentcloud.github.com/backbone/">their preparations are open to any approaches</a> .  It is very important to choose and adhere to one approach.  <b>What do you think?</b> <br>  By the way, to start with Backbone, we recommend to look at <a href="http://ricostacruz.com/backbone-patterns/">this</a> (we will be happy to translate for Habr - write, if necessary). <br><br><h5>  MongoDB </h5><br>  In parallel with the choice of the stack of technologies on which the client will be built, we faced the question of choosing a DBMS for storing data. <br><br>  Since the subject area was new for us, it was obvious that we should not expect that once designed model would be good enough so that it would not have to be changed as the project developed and developed.  In NoSQL, we expected to get faster query performance, more convenient and simple storage of complex data, flexibility.  Understanding that we will change the base scheme more than once has completely nullified the chances of relational databases being in the technology stack of our project. <br><br>  Following the analysis of several variants of the NoSQL DBMS, we opted for MongoDB, because of the good combination of its wide capabilities with high speed.  In particular, we were attracted by the ability of MongoDB to index arrays, convenient sharding and replication, and good documentation.  Also in favor of MongoDB, there is good support for this DBMS and its application in many successful projects (a complete list <a href="http://www.mongodb.org/display/DOCS/Production%2BDeployments">here</a> , among them such giants as Disney, Craiglist, Foursquare). <br><br>  Although we initially designed the data storage scheme taking into account the features of document-oriented DBMS, in order to reduce both the query execution time and the size of the database, we had to repeatedly change the database schema.  For example, we were faced with the need to support large multidimensional indexes to provide fast filtering of posts, but our attempt to optimize the data storage scheme to ensure maximum query execution speed led to an exponential increase in the size of both the indices and the data itself, with the result that we realized that we did not We will be able to maintain such a database because of its memory requirements.  As a result, we found a rather beautiful solution that provided a high speed of execution of all queries without an excessive increase in the size of the indices and data.  However, despite the fact that at the moment, we have achieved acceptable indicators on the speed of work and resource consumption, we understand that as the project grows, we will have to modify the current solution more than once. <br><br><h5>  RESULT </h5><br>  If it is interesting to see what happened in the end and how it works, then we put the updated project <a href="http://beta.iknow.travel/">here</a> for the test. <br>  To access the air tickets (if anyone wants to climb there) on the <a href="http://iknow.travel/">old site</a> use the code: i3n7wt0a8el <br><br>  If you correctly post a post somewhere, then tell me where.  Thank you in advance for feedback.  In many ways we had to move quickly (in time for the holiday season) and intuitively, because  a similar system was built for the first time.  We are happy to answer your questions. </div><p>Source: <a href="https://habr.com/ru/post/145811/">https://habr.com/ru/post/145811/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145803/index.html">Microsoft gives up? Xbox LIVE for Android</a></li>
<li><a href="../145804/index.html">Interoperability Java and ... Assembler?</a></li>
<li><a href="../145805/index.html">Nonlinear Dynamics and Time Series Analysis - Review of the Recurrence plots Method</a></li>
<li><a href="../145806/index.html">Nokia sells Vertu and is preparing to lay off 10 thousand employees</a></li>
<li><a href="../145810/index.html">In jQuery since version 1.8, you can exclude some modules</a></li>
<li><a href="../145812/index.html">QML and QtQuick Webinars: User Interface Paging</a></li>
<li><a href="../145813/index.html">Gentee programming language</a></li>
<li><a href="../145814/index.html">American dream startup LinguaLeo comes true! Runa Capital has invested $ 3,000,000 in a service for learning foreign languages!</a></li>
<li><a href="../145815/index.html">Microsoft is negotiating the purchase of Yammer for a billion dollars</a></li>
<li><a href="../145816/index.html">Manipulate pixels on canvas using Javascript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>