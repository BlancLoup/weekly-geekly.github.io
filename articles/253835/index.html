<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Not quite well-known solutions for the protection of IT business infrastructure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The classic approach of the Russian business today is the installation of a firewall, then after the first attempts of targeted attacks, an anti-intru...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Not quite well-known solutions for the protection of IT business infrastructure</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/84e/fcd/4c2/84efcd4c25754134ac0c72573a6b5f89.jpg"><br><br>  <b>The classic approach of the Russian business today</b> is the installation of a firewall, then after the first attempts of targeted attacks, an anti-intrusion system.  And go to sleep peacefully.  In practice, this gives a good level of protection only against violinists, with any more or less serious threat (for example, from competitors or an attack from detractors, or a targeted attack from a foreign industrial espionage group), something additional is needed besides classical means. <br><br>  I already wrote about the profile of a <a href="http://habrahabr.ru/company/croc/blog/236411/">typical directed attack</a> on a Russian civil enterprise.  Now I‚Äôll talk about how the defense strategy has changed in general in our country in recent years, in particular, due to the displacement of the attack vectors by 0-day and the associated implementation of static code analyzers directly in the IDE. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Plus a couple of examples for sweetness - you will find out what can happen in a network completely isolated from the Internet and on the perimeter of the bank. <a name="habracut"></a><br><br><h4>  Development </h4><br>  Over the past two years, quite a strong movement has begun on the market for large enterprise solutions.  At first there was a fairly good activity on protection from DDoS - just then the attacks fell in price.  While the average business got acquainted with IT on the issues "why we have a website and do not operate cash registers in stores," the major reorganized defense in the direction of protection against non-standard attacks.  Let me remind you that most of the targeted threats are realized through a 0-day bundle and social engineering.  Therefore, the introduction of code analyzers at the software development stage for the company has become a logical step. <br><br><h4>  Check to commit </h4><br>  One of the most effective measures was the organization of the process in such a way that no commit takes place without static code analysis, and not a single release goes to the combat servers until the dynamic analysis is completed.  Moreover, this dynamic is done in the sandboxes of virtual machines, ideally corresponding to different servers, users' machines with different profiles, and so on.  That is, the code is ‚Äúswinging‚Äù in a real environment with the whole chain of interactions. <br><br>  Most hardor, of course, the integration of analyzers with the IDE.  Wrote the function - and not one step further until you remove all the warnings of the analyzer.  At the same time, for complete happiness, the security officer sees the logs of what was happening, and every warning is duplicated to him.  As colleagues say, in the West it turned out to be a very effective tool for the code to be immediately written normally. <br><br><img src="https://habrastorage.org/files/b71/396/739/b71396739af2478a8ab0cbf031a7785b.png"><br>  <i>An example of a solution is HP Fortify Software Security center.</i> <br><br><h4>  3rd party code </h4><br>  When implementing a third-party code, the IB of a large business often insists on static code analysis.  When it comes to open source, the situation is very simple and straightforward, just running through the analyzer and ‚Äúsuppressing‚Äù from hundreds to thousands of warnings.  When the code is commercial, and the customer is not ready to provide the source code of his subsystem, a more interesting iteration occurs. <br><br>  If the source code is not provided, but they can be read at the developer‚Äôs office, representatives of the IT department and the information security department go to the place, where they together launch a static analyzer.  If, however, it cannot be so, then either they give up the code, or, less often, they assign an enhanced ‚Äúswing‚Äù in dynamics. <br><br>  In addition to automatic methods, a pentester is often invited: this is either an employee of an information security / IT department with a specialized education, or, more often, a third-party specialist from a partner company. <br><br><h4>  Old code </h4><br>  If you find problems with legacy-code, and even compiled for the subsystem as much as in 1996 (there was such a real case), it is naturally quite difficult to rewrite it.  In this case, a rule is written on the firewall describing the type of exploitation of the vulnerability (in fact, the exploit package signatures), or the cut-off of everything that is not a normal package for the final system is prescribed on one of the intermediate systems.  A kind of DPI, but to close the vulnerability, piping a level higher. <br><br><h4>  Internal rounds </h4><br>  A very large business has one more characteristic problem - the number of changes in the living infrastructure is such that even a large department cannot control all movements in the network.  Therefore, the same banks, retail and insurance use specialized tools like HP Webinspect or MaxPatrol from our compatriots Positive Technologies.  These systems allow you to check a variety of infrastructure components, including what rolls onto microcontrollers of low-voltage systems. <br><br>  Very common <a href="http://www.croc.ru/solution/integration/insecurity/network-security/%3F%26tab%3Danomaly_detection">traffic profiling</a> system.  A typical profile of calls to each node is built on a database from switches and routers, then a correlation of users and systems to which they access is built.  It turns out the interaction matrix, where you can see which service generates traffic for which user.  Minor deviations fall in the form of a notice to safety guards, serious ones are immediately blocked.  When the malware enters the network, characteristic multiple traces are visible, everything critical is ‚Äúfrozen‚Äù and the logging begins. <br><br>  In this setting is in the form of "application-user-server" in the form of a GUI directly by the security officer without the participation of the IT department.  Oddly enough, I like such systems, including admins - I had an example when the Vkontakte application started generating 90% of the traffic in the band, and the admin very easily noticed. <br><br>  An example of a network anomaly search system is StealthWatch. <br><br><h4>  With a comprehensive analysis of security is usually done three procedures: </h4><br><ul><li>  <b>The analysis at the ‚Äúblack box‚Äù level</b> without user privileges, that is, just calling outside.  These are free ports, analysis of everything that looks out of services, attempts to exploit the collected vulnerabilities and go through the DMZ.  Standard pentest, as a rule. </li><li>  <b>Audit with uchetku admin or privileged user.</b>  It is assumed that the attacker somehow "namutil" accesses (for example, by means of social engineering), and the attack develops from that moment on.  As part of the same audit, a detour is done throughout the entire network.  Settings, configuration files, system update correctness, checksums of each package and file are checked, software versions and their known vulnerabilities are evaluated (for example, that Windows on user machines are updated correctly from a certified source).  An example package is RedCheck. </li><li>  <b>The third mode is compliance with the requirements of a certain standard.</b>  This is an advanced network traversal according to a template, for example, personal data processing models by class.  Our vendors have pre-configured templates for Russia - foreign ones, as a rule, rarely go beyond PCI DSS at best. </li></ul><br>  We have examples of such audits <a href="http://www.croc.ru/insafety/">right here</a> .  But let's move on to the problems and the game "find a friend." <br><br><h4>  Typical problems </h4><br>  As a rule, most of the problems for IS of large businesses are no longer technical, but ‚Äúeveryday‚Äù, at the organization level: <br><ul><li>  <b>Outdated hardware and software.</b>  Often, big business needs certified solutions, and they are rapidly lagging behind new products.  Many simply can not afford to put a new software or a new cool piece of iron, but they put something with obviously known holes or the missing functionality, and crutches to somehow solve the problem.  It is not uncommon for a bank to make a decision that is only being certified, and, in fact, works a month or two at your own risk and risk without full compliance with the requirements of regulators.  The alternative is to have a hole the size of a horse in an information security, but at the same time try to close it with a piece of paper that everything meets the standard and requirements. </li><li>  <b>Consequence - one box closes the entire network.</b>  The problem is completely insane from the outside, but often the entire internal network of a small bank can rest on one device that is 5 years behind the flagship, but it works under a certificate.  At failure of this piece of iron everything falls to the solution of a question.  Naturally, more modern solutions are able to bypass the subsystems, parallelism, redundancy - but the reality is a little different from the ideal network architecture. </li><li>  <b>Or another option.</b>  <b>There is, in general, everything you need.</b>  But <a href="http://www.croc.ru/solution/integration/insecurity/app-protection/%3F%26tab%3Dcode_security_audit">DLP</a> and antibot cannot be activated, there are often problems with updating the antibot signature database (it is forbidden to update), problems with drivers (there was a situation - they installed certified equipment, but it didn‚Äôt fit into the RAID array - fortunately, a few days later a new certified version came out ). </li><li>  <i>"Hardcode".</i>  Different devices need a different type of traffic, and when introducing new iron solutions, a painful and long re-switching is often done.  Tests of one protective agent can go weeks for just that.  In practice, it is enough to put a modern solution that will allow you to work at the channel level.  That allows, for example, to put IPS under this channel before the firewall or after (which greatly affects the performance). </li></ul><br><br><img src="https://habrastorage.org/files/361/e75/46a/361e7546a4534c05a4f95802f92ace84.png"><br>  <i>Gigamon GigaVUE-HC2</i> <br><br><ul><li>  <b>Different iron under protection.</b>  This is not really a problem, just the tendency is that most of the vendors have come to the conclusion that all solutions for securing the perimeter fit into one UTM device.  The fact is that each solution is a PACK in the form of a ‚Äúblack box‚Äù.  Modern version - the same x86-architecture, and the ability to update the functionality without throwing iron every two years.  For example, there is a device where there is already a firewall, streaming antivirus, anti-bot-system, and so on.  At the same time, it is certified entirely and in the iron part consists of x86-machine, divided into virtual software blades at the software level.  If necessary, software is delivered there, paid for a license - and it continues to thresh in a new way. </li><li>  <b>Sophisticated zoo systems integration.</b>  Again, a consequence of the previous paragraph.  Many different badly coupled iron is the problem of transferring data from one part of the IB system to another.  For example, it has long become the norm that IPS is clearly connected with the antibotnet system.  I am sure that this is not so in all banks - because, again, either it is difficult to do integration mechanics, or there is no single piece of hardware with blades as I described above.  By the way, the latest generation also knows how to "split the brain" in order to scan itself for the appropriate configuration of the same PCI DSS.  Previously, this was done by separate external systems. </li><li>  <b><a href="http//www.croc.ru/solution/integration/insecurity/regulatory-compliance/">Infrastructure analysis</a> for compliance with standards does not take into account Russian realities.</b>  Simplifying, you will have the perfect set of "utility crawlers" to verify compliance with PCI DSS.  But only a small part of the decisions can number 152- ‚Äú <a href="http://www.croc.ru/promo/pd/">About personal data‚Äù</a> .  For example, for this (well, and not only) domestic MaxPatrol "chases" in Lukoil, Norilsk Nickel, VimpelCom, Gazprom, and so on. </li><li> <b>Sudden changes.</b>  This is generally beyond good and evil, but it happens.  A common case is that an IT specialist does something and sets a new rule at the infrastructure level, which in a month or two suddenly becomes safe (often - not by himself, but from a hint, a program for searching bugs, pentest or a real attack) and panics.  Then suits all the dressing.  For example, in one of our integrations there was a situation where we had to speed up the introduction of a heavy thresher server for a week.  When deploying, without knowing all the details of the customer's IT kitchen, we were allowed to drive a certain type of traffic right before it.  And then reported on the success.  In response, the security officers initiated an internal investigation, as a result of which we ourselves almost got a little on the cap.  So, it is right to put the system in place when an IT specialist implements something on the network, but the rule does not run until the security officer confirms it.  It would have been like this, our colleagues would have received bonuses, because the problem was not in allowing the traffic, but that it passed by the information security department. </li><li>  <b>Untrusted sources.</b>  In many corporate environments, at the butt level, there are often problems with the fact that the end user devices are a circus in half with the menagerie of viruses.  For example, one thing is when an insurance agent travels to a place, photographs a dent in a car on his camera, then comes home, photoshop for more severe damage and sends.  Another thing is when a photo comes from a corporate application (under certificate) via a secure channel and from a non-rooted device.  You can trust the size of the dent.  A more serious case is a sharp decline in trust in a VPN in one of the companies, where, as a result, due to viruses from remote employees, all accesses to the intruders got to the attackers.  Solved the problem with a virtual JAVA applet in the browser that provides a secure trusted environment for VPN access. </li></ul><br><br><h4>  Protective agents, examples </h4><br>  ‚Ä¢ NG FW class systems (Check Point, Stonesoft, HP Tipping Point); <br>  ‚Ä¢ system for detection of potentially dangerous files (sandbox) (Check Point, McAfee, FireEye); <br>  ‚Ä¢ specialized web application protection (WAF) (Imperva SecureSphere WAF, Radware AppWall, Fortinet Fortiweb); <br>  ‚Ä¢ Intelligent center (ByPass node) for connecting IB facilities (Gigamon GigaVUE-HC2). <br>  ‚Ä¢ Network traffic anomaly detection systems (StealthWatch, RSA NetWitness, Solera Networks); <br>  ‚Ä¢ Security and compliance analysis (MaxPatrol, HP Webinspect) <br>  ‚Ä¢ code security audit (HP Fortify, Digital Security ERPScan CheckCode, IBM AppScan Source); <br>  ‚Ä¢ DDoS protection system (iron - Radware DefensePRO, ARBOR PRAVAIL, Check Point DDoS Protector; service - Kaspersky DDoS Prevention, QRATOR HLL). <br><br><h4>  Examples for dessert </h4><br>  <b>Certified network</b> <br>  In one of the major government departments, it was decided to assess the security of the certified network segment intended for processing confidential information.  In particular, users of this segment are strictly prohibited access to the Internet.  Found this: <br><ul><li>  Traces of connecting USB modems. </li><li>  One of the laptops was connected simultaneously to the external network and public. </li><li>  There were quite a lot of instant messengers and games. </li></ul><br>  In general, you must have seen such isolated networks in the army, when headquarters fighters sit on dating sites.  Here the situation was somewhat more serious. <br><br>  <b>Network perimeter of a commercial bank</b> <br>  It was necessary to assess the perimeter security.  Usually such work is carried out within the framework of penetration testing, but in this case the customer was more interested to see what he can do on his own from within.  To do this, the servers and telecommunications equipment of the external demilitarized zones were scanned by the MaxPatrol system in the Audit and Compliance modes, and then the reports were analyzed.  The first thing that caught my eye was a certain number of vulnerabilities associated, as usual, with outdated software or lack of security updates (old OS versions, no patches on most servers, etc.), but this is not the worst thing: for most of these vulnerabilities There are no exploits available to hackers.  But there were also surprises.  On a pair of perimeter routers, there were no ACLs (as it turned out, they were temporarily disabled when diagnosing communication problems between departments, and they forgot to enable them), so there were many more nodes outside than the administrators thought were available.  In a large Internet face looking out combat military DBMS.  Instead of SSH, TELNET was used on a number of nodes.  On a number of combat servers, the RDP settings were not changed after configuration (RDP traffic was closed with a typical key).  There were heroes who have not changed defol passwords since the start of work in the company.  Fortunately, they did not have time to notice it from the outside, so everything was quickly shut down with almost no casualties in the IT department. <br><br>  <b>PS</b> If you have a question not for comments, my mail is PLutsik@croc.ru. </div><p>Source: <a href="https://habr.com/ru/post/253835/">https://habr.com/ru/post/253835/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253823/index.html">Mystical data center</a></li>
<li><a href="../253825/index.html">Release DBMS InterSystems Cach√© 2015.1</a></li>
<li><a href="../253827/index.html">We do our job in Xcode a little more efficiently.</a></li>
<li><a href="../253831/index.html">Press release: ‚ÄúStartup SketchBuilder is entering the international market‚Äù</a></li>
<li><a href="../253833/index.html">Exception Analyzer based on Roslyn</a></li>
<li><a href="../253839/index.html">Automation of stock trading on the MICEX on the example of the terminal from Alfa Bank</a></li>
<li><a href="../253841/index.html">20 years of building and maintaining a satellite network</a></li>
<li><a href="../253845/index.html">Overview of the practical side of Bitcoin</a></li>
<li><a href="../253847/index.html">Data center construction boom starts in Iceland</a></li>
<li><a href="../253849/index.html">Free webinar "Virtualization based on Hyper-V 3.0 and Windows Server 2012R2 Virtual Desktop Infrastructure"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>