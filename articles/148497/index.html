<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How does Lytro, or another review</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lytro is a film camera with no focusing produced by Lytro ( Ren Ng startup - a graduate of Stanford). The camera works by the method of light fields, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How does Lytro, or another review</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/cd8/8d9/b1d/cd88d9b1d42cc3d4d1ef39b44abe46b3.png"><br>  Lytro is a film camera with no focusing produced by Lytro ( <a href="http://graphics.stanford.edu/~renng/">Ren Ng</a> startup - a graduate of Stanford).  The camera works by the method of light fields, about the principle of operation of which I will try to tell (under the cut traffic!). <br><a name="habracut"></a>  Pictures, where there are photos from lytro, are clickable (but the lytro site lately, sometimes, lies - probably it will fall now). <br><br><h4>  Camera </h4>  Full specs you can find <a href="https://www.lytro.com/camera">on the site Lytro</a> , about the appearance described <a href="http://habrahabr.ru/post/147172/">in a previous review</a> .  The camera itself is made in China, connects and charges via USB: <br><img src="https://habrastorage.org/storage2/7db/0d0/5df/7db0d05dfac04682dbb03054874c3f08.jpg"><br><br>  The display is touch, of normal resolution, here it shows that the camera is charging: <br><img src="https://habrastorage.org/storage2/1df/acd/fc5/1dfacdfc58ed31f508959f147a49b5c1.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The principle of operation is simple: top zoom (you need to hold your finger on the elastic band), on top of the same shutter button.  The zoom is similar to 24-105mm. <br><br><h5>  Macro </h5>  If you bring the camera close to the object, it will not focus (yes, and after the shooting also does not focus): <br><img src="https://habrastorage.org/storage2/b16/27c/d0b/b1627cd0bca443230f1bb53efa819a9e.jpg"><br><br>  To overcome this, you can enable the "creative mode".  It is activated by clicking on the white square: <br><img src="https://habrastorage.org/storage2/47b/aef/4f4/47baef4f4ab2ef36d8b0a0c589f27ab2.jpg"><br><br>  In creative mode, you can focus the camera by clicking on the touchscreen.  He poked at the object, the camera thought and focused (autofocus, apparently, contrasting): <br><img src="https://habrastorage.org/storage2/75b/042/fee/75b042fee6309f47e2438af0e73ec649.jpg"><br><br>  Focusing can be pretty close: <br> <a href="https://pictures.lytro.com/antelle/pictures/293289"><img src="https://habrastorage.org/storage2/fa0/345/6a2/fa03456a291457012d8c04cee0fab2b1.jpg"></a> <br><br>  The limitation of creative mode is that after shooting the focus range will be limited. <br>  At one time, manufacturers promised to do built-in focus stacking for the macro.  Now there is no such feature in the camera, but this is easy to accomplish in Photoshop, getting the image from lfp - as you can see, the GRIP here is much more than before processing: <br> <a href="https://pictures.lytro.com/antelle/pictures/293259"><img src="https://habrastorage.org/storage2/c4e/b0c/d71/c4eb0cd719bbdbd5ea309ca9eb43dc02.jpg"></a> <br><br><h5>  Settings </h5>  There are no more settings in the camera.  The camera sets the exposure on its own; it is impossible to influence this process (I noticed that the metering in Matrix in EverydayMode is center-weighted in CreativeMode - but also not always).  Here are a couple of examples: <br><img src="https://habrastorage.org/storage2/7b2/c9c/826/7b2c9c826ee93347a25614effcc61f68.jpg"><br><br>  In the worst conditions, it would be ISO 3200, 1/15 (although it is strange: with an accelerometer, it would be possible to determine that the camera is on a tripod and increase the exposure): <br><img src="https://habrastorage.org/storage2/b34/aec/b82/b34aecb82a98a06f56a83d1feee3df81.jpg"><br><br><h4>  Soft </h4>  When you connect the camera, the software copies the photos from it, allows you to rotate them and upload them on lytro.com. <br>  Written in Qt, stores information in a SQLite database, the format of which is described <a href="http://optics.miloush.net/lytro/TheDatabase.aspx">here</a> . <br>  Most recently, software came out under win, which is good news: <br><img src="https://habrastorage.org/storage2/ccd/589/1d6/ccd5891d6a374c9b828b4b15287f9156.png"><br><br><h4>  Format </h4>  Lytro has one .lfp format, used for both raw and web-optimized files.  Consider it in more detail. <br>  So .lfp is a container, divided into sections.  Sections are of several types: <br><ul><li>  File metadata: always present, describes file sections and contains their SHA-1 hashes, json format. <div class="spoiler">  <b class="spoiler_title">Example</b> <div class="spoiler_text"><pre><code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"picture"</span></span> : { <span class="hljs-string"><span class="hljs-string">"frameArray"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"frame"</span></span> : { <span class="hljs-string"><span class="hljs-string">"metadataRef"</span></span> : <span class="hljs-string"><span class="hljs-string">"sha1-079f3465638687275008d656c408c9c91d1bc6ee"</span></span>, <span class="hljs-string"><span class="hljs-string">"privateMetadataRef"</span></span> : <span class="hljs-string"><span class="hljs-string">"sha1-44cdec4d744eae5c06dbef8f086fd7905bd8f55a"</span></span>, <span class="hljs-string"><span class="hljs-string">"imageRef"</span></span> : <span class="hljs-string"><span class="hljs-string">"sha1-2f429e42bef0dc3fa0351dd2d55404c351e3beca"</span></span> }, <span class="hljs-string"><span class="hljs-string">"parameters"</span></span> : { <span class="hljs-string"><span class="hljs-string">"vendorContent"</span></span> : { <span class="hljs-string"><span class="hljs-string">"com.lytro.tags"</span></span> : { <span class="hljs-string"><span class="hljs-string">"darkFrame"</span></span> : <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"modulationFrame"</span></span> : <span class="hljs-literal"><span class="hljs-literal">false</span></span> } } } } ], <span class="hljs-string"><span class="hljs-string">"viewArray"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"type"</span></span> : <span class="hljs-string"><span class="hljs-string">"com.lytro.stars"</span></span>, <span class="hljs-string"><span class="hljs-string">"vendorContent"</span></span> : { <span class="hljs-string"><span class="hljs-string">"starred"</span></span> : <span class="hljs-literal"><span class="hljs-literal">false</span></span> } } ], <span class="hljs-string"><span class="hljs-string">"accelerationArray"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"type"</span></span> : <span class="hljs-string"><span class="hljs-string">"com.lytro.acceleration.refocusStack"</span></span>, <span class="hljs-string"><span class="hljs-string">"generator"</span></span> : <span class="hljs-string"><span class="hljs-string">"Lytro Lightfield Engine 1.000000"</span></span>, <span class="hljs-string"><span class="hljs-string">"vendorContent"</span></span> : { <span class="hljs-string"><span class="hljs-string">"viewParameters"</span></span> : {}, <span class="hljs-string"><span class="hljs-string">"displayParameters"</span></span> : { <span class="hljs-string"><span class="hljs-string">"displayDimensions"</span></span> : { <span class="hljs-string"><span class="hljs-string">"mode"</span></span> : <span class="hljs-string"><span class="hljs-string">"fixedToValue"</span></span>, <span class="hljs-string"><span class="hljs-string">"value"</span></span> : { <span class="hljs-string"><span class="hljs-string">"width"</span></span> : <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span> : <span class="hljs-number"><span class="hljs-number">1080</span></span> } } }, <span class="hljs-string"><span class="hljs-string">"defaultLambda"</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"depthLut"</span></span> : { <span class="hljs-string"><span class="hljs-string">"width"</span></span> : <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span> : <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-string"><span class="hljs-string">"representation"</span></span> : <span class="hljs-string"><span class="hljs-string">"raw"</span></span>, <span class="hljs-string"><span class="hljs-string">"imageRef"</span></span> : <span class="hljs-string"><span class="hljs-string">"sha1-3797be865adeaf3d28b372a2dca0aa8e3ef79b6f"</span></span> }, <span class="hljs-string"><span class="hljs-string">"imageArray"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"representation"</span></span> : <span class="hljs-string"><span class="hljs-string">"jpeg"</span></span>, <span class="hljs-string"><span class="hljs-string">"width"</span></span> : <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span> : <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"lambda"</span></span> : <span class="hljs-number"><span class="hljs-number">4.8976802825927734</span></span>, <span class="hljs-string"><span class="hljs-string">"imageRef"</span></span> : <span class="hljs-string"><span class="hljs-string">"sha1-6e268b48ced0b5c38e39d477a3100f00bb9c188b"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"representation"</span></span> : <span class="hljs-string"><span class="hljs-string">"jpeg"</span></span>, <span class="hljs-string"><span class="hljs-string">"width"</span></span> : <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span> : <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"lambda"</span></span> : <span class="hljs-number"><span class="hljs-number">5.886573314666748</span></span>, <span class="hljs-string"><span class="hljs-string">"imageRef"</span></span> : <span class="hljs-string"><span class="hljs-string">"sha1-80b19c4365465e63e623d5cc1fb9d345dfab7ce0"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"representation"</span></span> : <span class="hljs-string"><span class="hljs-string">"jpeg"</span></span>, <span class="hljs-string"><span class="hljs-string">"width"</span></span> : <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span> : <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"lambda"</span></span> : <span class="hljs-number"><span class="hljs-number">6.8429036140441895</span></span>, <span class="hljs-string"><span class="hljs-string">"imageRef"</span></span> : <span class="hljs-string"><span class="hljs-string">"sha1-5f7c28a7b4aad7d06fcea230293aadb700ad27ef"</span></span> } ] } } ], <span class="hljs-string"><span class="hljs-string">"derivationArray"</span></span> : [ <span class="hljs-string"><span class="hljs-string">"sha1-f408b48df6a6c09e40e60585a655e8d81415b789"</span></span> ] }, <span class="hljs-string"><span class="hljs-string">"thumbnailArray"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"version"</span></span> : { <span class="hljs-string"><span class="hljs-string">"major"</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"minor"</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"provisionalDate"</span></span> : <span class="hljs-string"><span class="hljs-string">"2011-08-03"</span></span> } }</code> </pre> </div></div></li><li>  Metadata about the frame: is present only in the RAW-file, it is the readings from all sensors at the time of shooting in json. <div class="spoiler">  <b class="spoiler_title">Example</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"type"</span></span> : <span class="hljs-string"><span class="hljs-string">"lightField"</span></span>, <span class="hljs-string"><span class="hljs-string">"image"</span></span> : { <span class="hljs-string"><span class="hljs-string">"width"</span></span> : <span class="hljs-number"><span class="hljs-number">3280</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span> : <span class="hljs-number"><span class="hljs-number">3280</span></span>, <span class="hljs-string"><span class="hljs-string">"orientation"</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"representation"</span></span> : <span class="hljs-string"><span class="hljs-string">"rawPacked"</span></span>, <span class="hljs-string"><span class="hljs-string">"rawDetails"</span></span> : { <span class="hljs-string"><span class="hljs-string">"pixelFormat"</span></span> : { <span class="hljs-string"><span class="hljs-string">"rightShift"</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"black"</span></span> : { <span class="hljs-string"><span class="hljs-string">"r"</span></span> : <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-string"><span class="hljs-string">"gr"</span></span> : <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-string"><span class="hljs-string">"gb"</span></span> : <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-string"><span class="hljs-string">"b"</span></span> : <span class="hljs-number"><span class="hljs-number">168</span></span> }, <span class="hljs-string"><span class="hljs-string">"white"</span></span> : { <span class="hljs-string"><span class="hljs-string">"r"</span></span> : <span class="hljs-number"><span class="hljs-number">4095</span></span>, <span class="hljs-string"><span class="hljs-string">"gr"</span></span> : <span class="hljs-number"><span class="hljs-number">4095</span></span>, <span class="hljs-string"><span class="hljs-string">"gb"</span></span> : <span class="hljs-number"><span class="hljs-number">4095</span></span>, <span class="hljs-string"><span class="hljs-string">"b"</span></span> : <span class="hljs-number"><span class="hljs-number">4095</span></span> } }, <span class="hljs-string"><span class="hljs-string">"pixelPacking"</span></span> : { <span class="hljs-string"><span class="hljs-string">"endianness"</span></span> : <span class="hljs-string"><span class="hljs-string">"big"</span></span>, <span class="hljs-string"><span class="hljs-string">"bitsPerPixel"</span></span> : <span class="hljs-number"><span class="hljs-number">12</span></span> }, <span class="hljs-string"><span class="hljs-string">"mosaic"</span></span> : { <span class="hljs-string"><span class="hljs-string">"tile"</span></span> : <span class="hljs-string"><span class="hljs-string">"r,gr:gb,b"</span></span>, <span class="hljs-string"><span class="hljs-string">"upperLeftPixel"</span></span> : <span class="hljs-string"><span class="hljs-string">"b"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"color"</span></span> : { <span class="hljs-string"><span class="hljs-string">"ccmRgbToSrgbArray"</span></span> : [ <span class="hljs-number"><span class="hljs-number">3.1115827560424805</span></span>, <span class="hljs-number"><span class="hljs-number">-1.9393929243087769</span></span>, <span class="hljs-number"><span class="hljs-number">-0.172189861536026</span></span>, <span class="hljs-number"><span class="hljs-number">-0.3629055917263031</span></span>, <span class="hljs-number"><span class="hljs-number">1.6408803462982178</span></span>, <span class="hljs-number"><span class="hljs-number">-0.27797481417655945</span></span>, <span class="hljs-number"><span class="hljs-number">0.078967012465000153</span></span>, <span class="hljs-number"><span class="hljs-number">-1.1558042764663696</span></span>, <span class="hljs-number"><span class="hljs-number">2.0768373012542725</span></span> ], <span class="hljs-string"><span class="hljs-string">"gamma"</span></span> : <span class="hljs-number"><span class="hljs-number">0.41666001081466675</span></span>, <span class="hljs-string"><span class="hljs-string">"applied"</span></span> : {}, <span class="hljs-string"><span class="hljs-string">"whiteBalanceGain"</span></span> : { <span class="hljs-string"><span class="hljs-string">"r"</span></span> : <span class="hljs-number"><span class="hljs-number">1.07421875</span></span>, <span class="hljs-string"><span class="hljs-string">"gr"</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"gb"</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"b"</span></span> : <span class="hljs-number"><span class="hljs-number">1.26953125</span></span> } }, <span class="hljs-string"><span class="hljs-string">"modulationExposureBias"</span></span> : <span class="hljs-number"><span class="hljs-number">-1.1193209886550903</span></span>, <span class="hljs-string"><span class="hljs-string">"limitExposureBias"</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-string"><span class="hljs-string">"devices"</span></span> : { <span class="hljs-string"><span class="hljs-string">"clock"</span></span> : { <span class="hljs-string"><span class="hljs-string">"zuluTime"</span></span> : <span class="hljs-string"><span class="hljs-string">"2012-07-25T14:05:20.000Z"</span></span> }, <span class="hljs-string"><span class="hljs-string">"sensor"</span></span> : { <span class="hljs-string"><span class="hljs-string">"bitsPerPixel"</span></span> : <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-string"><span class="hljs-string">"mosaic"</span></span> : { <span class="hljs-string"><span class="hljs-string">"tile"</span></span> : <span class="hljs-string"><span class="hljs-string">"r,gr:gb,b"</span></span>, <span class="hljs-string"><span class="hljs-string">"upperLeftPixel"</span></span> : <span class="hljs-string"><span class="hljs-string">"b"</span></span> }, <span class="hljs-string"><span class="hljs-string">"iso"</span></span> : <span class="hljs-number"><span class="hljs-number">205</span></span>, <span class="hljs-string"><span class="hljs-string">"analogGain"</span></span> : { <span class="hljs-string"><span class="hljs-string">"r"</span></span> : <span class="hljs-number"><span class="hljs-number">5.5625</span></span>, <span class="hljs-string"><span class="hljs-string">"gr"</span></span> : <span class="hljs-number"><span class="hljs-number">4.0625</span></span>, <span class="hljs-string"><span class="hljs-string">"gb"</span></span> : <span class="hljs-number"><span class="hljs-number">4.0625</span></span>, <span class="hljs-string"><span class="hljs-string">"b"</span></span> : <span class="hljs-number"><span class="hljs-number">4.6875</span></span> }, <span class="hljs-string"><span class="hljs-string">"pixelPitch"</span></span> : <span class="hljs-number"><span class="hljs-number">1.3999999761581417e-006</span></span> }, <span class="hljs-string"><span class="hljs-string">"lens"</span></span> : { <span class="hljs-string"><span class="hljs-string">"infinityLambda"</span></span> : <span class="hljs-number"><span class="hljs-number">123.91555023193359</span></span>, <span class="hljs-string"><span class="hljs-string">"focalLength"</span></span> : <span class="hljs-number"><span class="hljs-number">0.011369999885559081</span></span>, <span class="hljs-string"><span class="hljs-string">"zoomStep"</span></span> : <span class="hljs-number"><span class="hljs-number">661</span></span>, <span class="hljs-string"><span class="hljs-string">"focusStep"</span></span> : <span class="hljs-number"><span class="hljs-number">1271</span></span>, <span class="hljs-string"><span class="hljs-string">"fNumber"</span></span> : <span class="hljs-number"><span class="hljs-number">2.0399999618530273</span></span>, <span class="hljs-string"><span class="hljs-string">"temperature"</span></span> : <span class="hljs-number"><span class="hljs-number">38.670684814453125</span></span>, <span class="hljs-string"><span class="hljs-string">"temperatureAdc"</span></span> : <span class="hljs-number"><span class="hljs-number">2501</span></span>, <span class="hljs-string"><span class="hljs-string">"zoomStepperOffset"</span></span> : <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">"focusStepperOffset"</span></span> : <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-string"><span class="hljs-string">"exitPupilOffset"</span></span> : { <span class="hljs-string"><span class="hljs-string">"z"</span></span> : <span class="hljs-number"><span class="hljs-number">0.039666198730468748</span></span> } }, <span class="hljs-string"><span class="hljs-string">"ndfilter"</span></span> : { <span class="hljs-string"><span class="hljs-string">"exposureBias"</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-string"><span class="hljs-string">"shutter"</span></span> : { <span class="hljs-string"><span class="hljs-string">"mechanism"</span></span> : <span class="hljs-string"><span class="hljs-string">"sensorOpenApertureClose"</span></span>, <span class="hljs-string"><span class="hljs-string">"frameExposureDuration"</span></span> : <span class="hljs-number"><span class="hljs-number">0.015281426720321178</span></span>, <span class="hljs-string"><span class="hljs-string">"pixelExposureDuration"</span></span> : <span class="hljs-number"><span class="hljs-number">0.015281426720321178</span></span> }, <span class="hljs-string"><span class="hljs-string">"soc"</span></span> : { <span class="hljs-string"><span class="hljs-string">"temperature"</span></span> : <span class="hljs-number"><span class="hljs-number">47.337005615234375</span></span>, <span class="hljs-string"><span class="hljs-string">"temperatureAdc"</span></span> : <span class="hljs-number"><span class="hljs-number">2632</span></span> }, <span class="hljs-string"><span class="hljs-string">"accelerometer"</span></span> : { <span class="hljs-string"><span class="hljs-string">"sampleArray"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"x"</span></span> : <span class="hljs-number"><span class="hljs-number">-0.066666670143604279</span></span>, <span class="hljs-string"><span class="hljs-string">"y"</span></span> : <span class="hljs-number"><span class="hljs-number">1.0392156839370728</span></span>, <span class="hljs-string"><span class="hljs-string">"z"</span></span> : <span class="hljs-number"><span class="hljs-number">0.08235294371843338</span></span>, <span class="hljs-string"><span class="hljs-string">"time"</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> } ] }, <span class="hljs-string"><span class="hljs-string">"mla"</span></span> : { <span class="hljs-string"><span class="hljs-string">"tiling"</span></span> : <span class="hljs-string"><span class="hljs-string">"hexUniformRowMajor"</span></span>, <span class="hljs-string"><span class="hljs-string">"lensPitch"</span></span> : <span class="hljs-number"><span class="hljs-number">1.3898614883422851e-005</span></span>, <span class="hljs-string"><span class="hljs-string">"rotation"</span></span> : <span class="hljs-number"><span class="hljs-number">0.0020797469187527895</span></span>, <span class="hljs-string"><span class="hljs-string">"defectArray"</span></span> : [], <span class="hljs-string"><span class="hljs-string">"scaleFactor"</span></span> : { <span class="hljs-string"><span class="hljs-string">"x"</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"y"</span></span> : <span class="hljs-number"><span class="hljs-number">1.0005592107772827</span></span> }, <span class="hljs-string"><span class="hljs-string">"sensorOffset"</span></span> : { <span class="hljs-string"><span class="hljs-string">"x"</span></span> : <span class="hljs-number"><span class="hljs-number">-1.0190916061401367e-005</span></span>, <span class="hljs-string"><span class="hljs-string">"y"</span></span> : <span class="hljs-number"><span class="hljs-number">-2.3611826896667481e-006</span></span>, <span class="hljs-string"><span class="hljs-string">"z"</span></span> : <span class="hljs-number"><span class="hljs-number">2.5000000000000001e-005</span></span> } } }, <span class="hljs-string"><span class="hljs-string">"modes"</span></span> : { <span class="hljs-string"><span class="hljs-string">"creative"</span></span> : <span class="hljs-string"><span class="hljs-string">"tap"</span></span>, <span class="hljs-string"><span class="hljs-string">"regionOfInterestArray"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"type"</span></span> : <span class="hljs-string"><span class="hljs-string">"exposure"</span></span>, <span class="hljs-string"><span class="hljs-string">"x"</span></span> : <span class="hljs-number"><span class="hljs-number">0.7625085711479187</span></span>, <span class="hljs-string"><span class="hljs-string">"y"</span></span> : <span class="hljs-number"><span class="hljs-number">0.21875333786010742</span></span> }, { <span class="hljs-string"><span class="hljs-string">"type"</span></span> : <span class="hljs-string"><span class="hljs-string">"creative"</span></span>, <span class="hljs-string"><span class="hljs-string">"x"</span></span> : <span class="hljs-number"><span class="hljs-number">0.7625085711479187</span></span>, <span class="hljs-string"><span class="hljs-string">"y"</span></span> : <span class="hljs-number"><span class="hljs-number">0.21875333786010742</span></span> } ] }, <span class="hljs-string"><span class="hljs-string">"camera"</span></span> : { <span class="hljs-string"><span class="hljs-string">"make"</span></span> : <span class="hljs-string"><span class="hljs-string">"Lytro, Inc."</span></span>, <span class="hljs-string"><span class="hljs-string">"model"</span></span> : <span class="hljs-string"><span class="hljs-string">"F01"</span></span>, <span class="hljs-string"><span class="hljs-string">"firmware"</span></span> : <span class="hljs-string"><span class="hljs-string">"v1.0a60, vv1.0.0, Thu Feb 23 15:02:57 PST 2012, e10fcca0668db3dbf94ae347248db3da070d21e9, mods=0, ofw=0"</span></span> } }</code> </pre> </div></div></li><li>  Private metadata: serial of the camera and matrix in json. <div class="spoiler">  <b class="spoiler_title">Example</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"devices"</span></span> : { <span class="hljs-string"><span class="hljs-string">"sensor"</span></span> : { <span class="hljs-string"><span class="hljs-string">"sensorSerial"</span></span> : <span class="hljs-string"><span class="hljs-string">"0x5086D178DEADBEEF"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"camera"</span></span> : { <span class="hljs-string"><span class="hljs-string">"serialNumber"</span></span> : <span class="hljs-string"><span class="hljs-string">"A20B00B1E3"</span></span> } }</code> </pre> </div></div></li><li>  Raw sensor data: is present only in the RAW file, it is the RAW data from the matrix.  It opens like this: <br><img src="https://habrastorage.org/storage2/4ec/9e1/41d/4ec9e141d70ffd62a32a92059b9dbcc6.png"></li><li>  Depth lookup table: present only in a web-optimized file.  Depth map.  Answers the question: if I poked here, which of the pictures I need to show? <br><img src="https://habrastorage.org/storage2/cf6/30d/30b/cf630d30b15e5e7b10c479270df90b67.png"></li><li>  Prerendered Œª =% lambda%: is present only in a web-optimized file.  This image is shown to the user when he is "focused" on a particular area by a click.  In the file from 1 to 12 (maybe more happens, I have not met) such sections. </li></ul><br>  The size of the RAW file is 16MB, web-optimized 1MB.  The latter is distinguished by the fact that it stores a set of pictures with a map that corresponds to the coordinates of the click and the number of the picture.  A full byte description of the format can be found <a href="http://optics.miloush.net/lytro/TheFileFormat.aspx">here</a> . <br><br><h4>  RAW </h4><br>  The RAW file itself is the data from the matrix.  We see the Bayer filter matrix, in front of which are located microlysis: <br> <a href="https://pictures.lytro.com/antelle/pictures/293285"><img src="https://habrastorage.org/storage2/f1c/e74/ae5/f1ce74ae532a6b46a48ac31c84e7a0c4.png"></a> <br><br><h4>  Treatment </h4>  The most interesting is processing.  The process is fully described in the works of Ren Ng, I depicted it schematically: <br><img src="https://habrastorage.org/storage2/d15/b15/2ea/d15b152ea97a2560d6f961e61c348901.png"><br><br>  First comes the demosai of the RAW file using traditional methods.  After that, the light field is brought to such a state that the ‚Äúcells‚Äù (micro lysis) fall into an integer number of pixels. To do this, you need to rotate the image slightly and scale it (this is the most difficult step that requires painstaking adjustment: ). <br>  Then the light field is integrated with certain parameters and the output is a set of pictures with different focal lengths.  I note that the software itself chooses where to focus and how many images you need to get: as long as there is no possibility to adjust this. <br>  The resulting file is packaged and uploaded to the Internet.  When a user clicks on one of the sections of the file (‚Äúfocusing‚Äù), the application looks at the map, what kind of image it is and shows it.  This is a depth map, but it is very rough, for practical purposes with such a resolution, you will most likely find it too small. <br><br><h4>  Post processing </h4>  Well, when you can fix something in Photoshop.  It is possible here, but with a reservation. <br>  Because  The lytro format is described, it is easy to write a script that will be able to export all parts of the lfp file.  Workflow is: <br><ol><li>  Parse lfp; </li><li>  Editing pictures.  Yes, Ivana Govnova will have to clean up not once, but exactly as many as the pictures in the container; </li><li>  We collect lfp back.  Here we must take into account that it is necessary to count all sha1-hashes, including updating them in the TableOfContents-section, and then recalculate the hash from itself; </li><li>  Launch the Lytro application, which, when you click on this file, realizes that it has changed and updates its preview. </li></ol><br>  Voila, Lytro + Instagram Filter: <a href="https://pictures.lytro.com/antelle/pictures/293267"><img src="https://habrastorage.org/storage2/c9e/508/67f/c9e50867f525425d0385690a330d9ad0.png"></a> <br><br><h4>  About light fields and plenoptic photo </h4>  In a classical camera, light coming from different points of the lens into one point of the matrix is ‚Äã‚Äãintegrated and stored as the brightness value of a pixel at that point.  In the plenoptic chamber, there is an array of microlenses in front of the matrix: <br><img src="https://habrastorage.org/storage2/fb7/e8b/15b/fb7e8b15ba1eb820907b035d924ed0b0.png"><br><br>  Each microlens distributes the light rays that come into it in different parts of the matrix: <br><img src="https://habrastorage.org/storage2/ab0/b4b/180/ab0b4b180418420ea243946448d383ef.png"><br><br>  The f / 2 aperture is not random.  It allows the most economical use of the matrix.  If you take less, there will be unused pixels on the matrix, if there are more, the projected images will intersect, which is unacceptable: <br><img src="https://habrastorage.org/storage2/707/2e0/93f/7072e093f471e1bc8be05eb26d15bf9d.png"><br><br>  The light field in space is described by a function in five-dimensional space: <br><img src="https://habrastorage.org/storage2/a7a/d52/2b2/a7ad522b2b35319baa567be127b0c610.png"><br><img src="https://habrastorage.org/storage2/2a9/968/cca/2a9968cca335a8db6e50e9dc40ee12b1.png"><br><br>  As you can see, the light field describes the energy brightness (radiance) for each point in space and for each direction of the beam from that point. <br>  This function can be set in several ways: <br>  On surface: <br><img src="https://habrastorage.org/storage2/89c/83c/f56/89c83cf5618ef0646ac01cac6c4ffe81.png"><img src="https://habrastorage.org/storage2/42d/ccc/ad9/42dcccad930b4675a1571afcb9355f43.png"><br><br>  On the sphere: <br><img src="https://habrastorage.org/storage2/219/bdd/a09/219bdda09b4c73809b7a1cd741c23fad.png"><br><br>  Between two planes: <br><img src="https://habrastorage.org/storage2/ace/eae/3a1/aceeae3a1440d9358b9be5caa971208f.png"><br><br>  Just the last way to describe the light field is used in lytro: two planes are the plane of the back wall of the lens and the plane of the matrix. <br>  The light field can be obtained using an array of cameras: <br><img src="https://habrastorage.org/storage2/69f/2e0/4b7/69f2e04b7b800b655b621879a8c5a3e3.jpg"><br><br>  The plenoptic camera can be represented as a special case of an array of cameras: the role of the camera is performed by a microlens. <br>  To obtain a photograph, it is necessary to integrate data from cameras (or in the case of lytro, data from microlens sections): <br><img src="https://habrastorage.org/storage2/0f4/39e/e8f/0f439ee8fb59125f4afaea3e587a5f4e.jpg"><br><br>  Depending on the method of selecting points within the window, there are two conversions: <br><br>  The observer offset is the choice of a specific point inside the microlens: <br><img src="https://habrastorage.org/storage2/dd6/71a/781/dd671a78179aea266ee0ed9994cda51e.jpg"><br><img src="https://habrastorage.org/storage2/630/f7f/ee1/630f7fee131ee9f186e40f5f7e21a7ae.png"><br><br>  Digital refocusing - the choice of the method of summable points from the sections of each microlens.  Since there are few pixels under the microlens, in the case of lytro the possibilities of refocusing are very limited: <br><img src="https://habrastorage.org/storage2/f4c/f90/06a/f4cf9006a591a02376a393c95953a3b1.jpg"><br><img src="https://habrastorage.org/storage2/26a/9bb/1d8/26a9bb1d8acc0f8012abbfc91707fa0a.png"><br><br><h5>  Theorem </h5><blockquote>  Having a plenoptic camera with an aperture of f / N, in which each microlength corresponds to PxP pixels, you can get an image equivalent in sharpness obtained with a classical camera with an aperture of f / (N * P).  For Lytro, it's about f / 14. </blockquote>  Another interpretation of the same theorem: <br><blockquote>  The plenoptic camera described in the theorem makes it possible to obtain images with a f / N depth of field focused in any place within the depth of field of a classic camera with an aperture of f / (N * P). </blockquote><br><br><h5>  Handling difficulties </h5>  When processing there are several obstacles that complicate the writing of the visualizer of the light field: <br><ol><li>  Microlenses are uneven.  It is necessary to calibrate the algorithm; </li><li>  It is necessary to exclude the influence of vignetting.  But remembering that under the microlens of only about 50 pixels, it becomes clear that this operation can produce a large error; </li><li>  Defective pixels.  Like any other camera, they are here too.  They need to be determined statistically so that they do not spoil the depth map; </li><li>  Performance.  Calculations must be performed in the frequency domain using 4D Fourier transform. </li></ol><br><br><h4>  Bokeh </h4>  Blur in the camera like this (these are pictures from one shot, pulled out of lfp): <br> <a href="https://pictures.lytro.com/antelle/pictures/293272"><img src="https://habrastorage.org/storage2/d37/b0e/b10/d37b0eb10494e9c9e61d456d7b4b0ce7.jpg"></a> <br><br>  For comparison, I made the same frame on lytro (left) and on the SLR f / 2 (right): <br> <a href="https://pictures.lytro.com/antelle/pictures/293278"><img src="https://habrastorage.org/storage2/f5f/208/2dc/f5f2082dc1d4c866789f275b5e20457b.jpg"></a> <br><br><h4>  Artifacts </h4>  Almost all the images crawl out unnatural artifacts of various kinds.  For example, such: <br> <a href="https://pictures.lytro.com/antelle/pictures/293280"><img src="https://habrastorage.org/storage2/bc8/675/4da/bc86754dac3ec91f389515ac47399564.jpg"></a> <br><br>  Or such: <br> <a href="https://pictures.lytro.com/antelle/pictures/293275"><img src="https://habrastorage.org/storage2/e9d/b2e/1f3/e9db2e1f358935d928b4b9a2509f5f21.jpg"></a> <br><br>  Heartbreaking sight. <br><br><h4>  Tools to work with lytro </h4>  <a href="">Lytro.Net</a> : can open lfp and export their parts, there is also a console version: <br> <a href="https://pictures.lytro.com/antelle/pictures/293239"><img src="https://habrastorage.org/storage2/8c2/f09/bf2/8c2f09bf2ffc73a31360bc450175d928.png"></a> <br><br>  <a href="http://optics.miloush.net/lytro/TheViewer.aspx">Lytro compatible viewer</a> : opens files, allows focusing on click, there is a focus distance slider: <br> <a href="https://pictures.lytro.com/antelle/pictures/293285"><img src="https://habrastorage.org/storage2/fea/a12/987/feaa12987792ec9e0c34634f0bd76149.png"></a> <br><br><h4>  Reflections </h4>  I could not find any tools that could work with light fields.  All that is - work with. Lfp-format: display, export to jpeg. <br>  After reading the works of Ren Ng, the technology no longer seems so mystical and unreal as it seemed at first. <br>  The same file format with the same magic is definitely evil.  I do not understand why they did it. <br>  If you want to work with raw, I can send it to you (and I can sell the camera a little later). <br><br><h4>  Pictures </h4>  All the "live" pictures from the article are available <a href="http://pictures.lytro.com/antelle/stories/57788">on lytro.com</a> : <br> <a href="http://pictures.lytro.com/antelle/stories/57788"><img src="https://habrastorage.org/storage2/f05/6e4/a2e/f056e4a2e145b9caa7f2c80f3f1f70af.jpg"></a> <br>  The second day lytro site lies in the evening.  Just in case, I uploaded lfp <a href="http://www.filefactory.com/file/28wlqov8mtcb/n/Habra_Img_rar">to file hosting</a> , they open <a href="http://optics.miloush.net/lytro/TheViewer.aspx">it up</a> . <br><br><h4>  Links </h4><br>  About lytro: <br>  <a href="http://eclecti.cc/computervision/reverse-engineering-the-lytro-lfp-file-format">Reverse Engineering the Lytro .LFP File Format</a> - a simple, clear description of how-to-hack <br>  <a href="https://github.com/nrpatel/lfptools">lfptools</a> - utility for working with lytro files on C <br>  <a href="">Lytro.Net</a> - port lfptools on C # <br>  <a href="http://optics.miloush.net/lytro/Default.aspx">Lytro meltdown</a> - nui gui for working with lytro files on c #, SQLite structure of lytro SQLite, file format <br>  <a href="http://lightfield.stanford.edu/">The (New) Stanford Light Field Archive</a> - examples of light fields from multiple cameras can be played online <br>  <a href="http://www.theverge.com/2012/2/9/2786544/lytro-light-field-camera-teardown-bluetooth-wifi">Lytro Teardown</a> - <a href="http://www.theverge.com/2012/2/9/2786544/lytro-light-field-camera-teardown-bluetooth-wifi">Lytro</a> is disassembled here, you can see all the electronics <br><br>  Ren Ng's work on light fields: <br>  <a href="http://graphics.stanford.edu/talks/lightfields-uncc-10jun08-public.pdf">Light Field Sensing</a> - light fields in pictures;  not understand this description is difficult <br>  <a href="http://graphics.stanford.edu/papers/fourierphoto/fourierphoto-600dpi.pdf">Fourier Slice Photography</a> - a theoretical description of the technique of light fields <br>  <a href="http://graphics.stanford.edu/papers/lfcamera/lfcamera-150dpi.pdf">Light Field Photography with a Hand-held Plenoptic Camera</a> - how to apply the technique of light fields in photography <br>  <a href="http://graphics.stanford.edu/papers/lightshop/lightshop.pdf">LightShop: Interactive Light Field Manipulation and Rendering</a> - a little about how to present the information of the light field visually </div><p>Source: <a href="https://habr.com/ru/post/148497/">https://habr.com/ru/post/148497/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148491/index.html">Increase web application stack security (LAMP virtualization, step 6/6)</a></li>
<li><a href="../148492/index.html">Interaction of web services through REST</a></li>
<li><a href="../148494/index.html">Macro magic for combining ad and implementation</a></li>
<li><a href="../148495/index.html">Play box</a></li>
<li><a href="../148496/index.html">Competition for the best A / V testing</a></li>
<li><a href="../148498/index.html">From junior developer to senior</a></li>
<li><a href="../148500/index.html">Homemade budget sub for movie</a></li>
<li><a href="../148501/index.html">10 critical event ID to monitor</a></li>
<li><a href="../148502/index.html">NASA has developed a technology for 3D printing of spare parts for spacecraft.</a></li>
<li><a href="../148503/index.html">The first criminal case for failing to pay 1% to Mikhalkov</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>