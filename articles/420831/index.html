<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Apparatus for the issuance of cookies "Cooker 3000"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! I work in a company that develops equipment for monitoring oil rigs, mining farms, diesel generator sets and other boring things. But this time...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Apparatus for the issuance of cookies "Cooker 3000"</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/kh/e9/2m/khe92mi1t6q68vhqpcgle2f50cw.jpeg"><br><br>  Hello!  I work in a company that develops equipment for monitoring oil rigs, mining farms, diesel generator sets and other boring things.  But this time we automated something else.  So, meet: "Kukinator 3000" - the apparatus for issuing cookies to the best employees. <br><br>  The device is a PVC construction and some parts: <br>  The spiral c is driven (serves to supply the goods), the screen, the coin acceptor, and the brain of the whole structure - the Wiren Board 6 controller. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/td/5c/ss/td5csslpot3ey_uuzx0yvirjd90.gif" width="720"><br><br> <a href=""><img src="https://habrastorage.org/webt/cc/39/cu/cc39cuim2tu0o8nine6dmo9r0ok.jpeg" width="360" alt="Click for larger image"></a> <a href=""><img src="https://habrastorage.org/webt/zc/ll/vn/zcllvnbavuzknmcx-vkecvjlp9m.jpeg" width="360" alt="Click for larger image"></a> <br> <a href=""><img src="https://habrastorage.org/webt/mw/3p/w0/mw3pw0garxwkyjp8orka5ymrcqo.jpeg" width="360" alt="Click for larger image"></a> <a href=""><img src="https://habrastorage.org/webt/pb/tc/kx/pbtckxlynifmqbzfun4heex-4m0.jpeg" width="360" alt="Click for larger image"></a> <br><br><h2>  Screen <br></h2><br>  I use the Nextion screen module (NEXTION ENHANCED NX4832K035) as a screen for <abbr title="Wiren Board 6">WB6</abbr> . <br><img src="https://habrastorage.org/webt/hw/6j/9d/hw6j9dvuwg6wqxkr9kwp3cp9upk.jpeg" width="450"><br>  The module is equipped with an AVR processor.  It has a 3.5 '' TFT display with a resolution of 480 * 320, 32Mb of internal memory, 1024 byte EEPROM, 8192 byte RAM. <br><br>  This device stores and displays graphics, animates interface elements and handles clicks.  Only event codes are transmitted to the controller via the UART, which makes it easy to configure interfaces of varying complexity. <br><br>  To load the necessary settings and graphics into the on-screen module, the visual interface editor ‚ÄúNextion Editor‚Äù is provided.  You can download it on the official website of itead. <br><br> <a href=""><img src="https://habrastorage.org/webt/x6/u_/eb/x6u_ebycvwunndp6nshvmcqizki.png" width="450" alt="Click for larger image"></a> <br><br>  When you create a new project, you must specify the model, screen position and character encoding.  To display Cyrillic correctly, you need to select iso-8859-5. <br><br> <a href=""><img src="https://habrastorage.org/webt/nh/sw/m1/nhswm1fhm3dfn99dll_kzqsr4iq.png" width="360" alt="Click for larger image"></a> <a href=""><img src="https://habrastorage.org/webt/qt/fe/q-/qtfeq-bai9ghnfgimb4ucysox8y.png" width="360" alt="Click for larger image"></a> <br><br>  On the left is a toolbar.  Here you can find the most necessary elements to create an interface. <br><br> <a href=""><img src="https://habrastorage.org/webt/7u/ef/da/7uefdanvxiu9o4ebff_cxuedhia.png" width="150" alt="Click for larger image" align="left"></a> <br><br>  Let's click on the Button.  A conditional button will appear in the edit box.  Stretch it, edit the text and title.  To display the text you need to add a font.  Use the ‚ÄúFont Creator‚Äù tool in the tools tab.  In the "Event" field, you must write the code that will be played by events. <br><br>  For example, if in the tab ‚ÄúTouch press event‚Äù you register the print ‚Äúbutton pressed \ r‚Äù, then when you press the button, the device sends to UART: button pressed and the line break symbol. <br><br> <a href=""><img src="https://habrastorage.org/webt/zm/te/k_/zmtek_kvf6e-mb8cxxoddkt6a6m.png" width="350" alt="Click for larger image"></a> <br><br>  A description and examples of codes can be found in the screen documentation.  For debugging, you can use the Debug function.  This window allows you to test all the functions of the firmware before pouring into the screen itself. <br><br> <a href=""><img src="https://habrastorage.org/webt/aa/gj/6a/aagj6ajoz26f2oiswoxpdxr0_ce.png" width="550" alt="Click for larger image"></a> <br><br>  If everything is in order, then you can connect the display to the computer via a USB / UART adapter and upload the firmware by clicking on the ‚ÄúUpload‚Äù button. <br><br> <a href=""><img src="https://habrastorage.org/webt/oi/lf/mk/oilfmkojzwprppfkk5yza0lrpk4.png" width="150" alt="Click for larger image" align="left"></a> <br>  But how do we now make friends with the screen with WB6? <br>  You can connect the screen either through the same USB \ UART adapter to one of the USB ports on the controller, or directly to one of the expansion slots on the controller board. <br>  We are interested in pins TX, RX, 5V and GND. <br><br> <a href=""><img src="https://habrastorage.org/webt/jy/zz/tm/jyzztmnldc_my-wqwjvo4tgwavk.jpeg" width="450" alt="Click for larger image"></a> <br><br>  After connecting the screen to the controller, we will receive event data directly to the Serial port. <br><br>  In order to somehow react to these events, let's write a small script that will send all the event data to the MQTT topic.  First, create a file in the root folder of the controller and name it serial.sh <br><br><div class="spoiler">  <b class="spoiler_title">serial.sh</b> <div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash #  /dev/ttyMOD3 stty -F /dev/ttyMOD3 ospeed 9600 ispeed 9600 raw clocal -parenb -echo cs8 CR="$(echo -e '\r')" exec 4&lt;&gt; /dev/ttyMOD3 cat &lt;&amp;4 | while : do IFS="$CR" read -r line case "$line" in quit*) break ;; *) if [[ -n "$line" ]]; then echo $line #    MQTT mosquitto_pub -t /devices/screen/controls/raw/meta/type -r -m text mosquitto_pub -t /devices/screen/controls/raw/on -r -m "$line" fi ;; esac done</span></span></code> </pre> <br></div></div><br>  If you did everything correctly, then after launching the script when you click on the button - in the web interface of the controller you will see a topic with data that the screen module sends. <br><br>  On Wiren Board controllers, a system of rules is provided - <a href="https://wirenboard.com/wiki/index.php/%25D0%2594%25D0%25B2%25D0%25B8%25D0%25B6%25D0%25BE%25D0%25BA_%25D0%25BF%25D1%2580%25D0%25B0%25D0%25B2%25D0%25B8%25D0%25BB_wb-rules">wb-rules</a> .  The rules are created via the web interface and are written in a simple Javascript-like language. <br><br>  In the WB6 web interface, go to the Scripts tab and create a new script by clicking on the "New ..." button, name it "screen_button.js" or something else.  Next, we write the rule: When you change the screen / raw topic (it is in it, we send data from the screen) some actions will take place.  In this case, when you click on the screen, we will see the message ‚ÄúThe button is pressed‚Äù in the debug window of the web interface: <br><br><div class="spoiler">  <b class="spoiler_title">screen_button.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs">defineVirtualDevice(<span class="hljs-string"><span class="hljs-string">"screen"</span></span>, { <span class="hljs-comment"><span class="hljs-comment">//    title: "nextion screen", cells: { raw: { type: "text", value: "" }, } }); defineRule("screen_button", { whenChanged: "screen/raw", then: function(newValue, devName, cellName) { log(newValue); if (newValue == "button pressed") { //     ¬´button pressed¬ª log(" "); //     . } else if (newValue == "button released") { log("  "); } dev["screen"]["raw"] = ""; // . } });</span></span></code> </pre><br></div></div><br>  Fine.  With how to handle clicking on the screen, we figured out.  Now let's talk about how we manage the screen with WB6.  For example, change the text of the button.  The screen accepts commands on the UART.  A list and description of the commands can be found in the documentation for the screen. <br><br>  To determine the end of the command, the screen waits for three special characters (\ xff \ xff \ xff).  To simplify the task in the future: create a script in the bash root folder.  Let's call it text.sh: <br><br><div class="spoiler">  <b class="spoiler_title">text.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash TEXT=""; UNIT=""; while [ -n "$1" ] do case "$1" in -a) UNIT=$2;; -b) TEXT=$2;; esac shift done echo -en "$UNIT.txt=\"$TEXT\"\xff\xff\xff" &gt; /dev/ttyMOD3 exit 0</span></span></code> </pre><br></div></div><br><br>  Now, in order to change the text of the button, we just need to call the script with arguments: <br> <code>bash /mnt/data/root/text.sh -a b0 -b 'Some Text'</code> <br>  Where b0 is the name of the button on the screen, and Some Text is the desired text. <br><br>  An example of using WB6 rules engine: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> txt1 = <span class="hljs-string"><span class="hljs-string">"some text"</span></span>; runShellCommand(<span class="hljs-string"><span class="hljs-string">"bash /mnt/data/root/text.sh -a b0 -b '"</span></span> + txt1+ <span class="hljs-string"><span class="hljs-string">"'"</span></span>);</code> </pre><br><br>  Similarly, you can change the currently displayed page on the screen, the text on the various elements, variables and other parameters.  I will not paint here all the functionality of the screen module.  For our project, the information already written above is sufficient. <br><br><h2>  Coin acceptor </h2><br>  As a coin acceptor, I use the Chinese version, found in the vast Aliexpress Aliexpress for 400. <br><br>  With the connection, everything is simple.  + 12v and a pulse output that needs to be connected to the Dry Contact expansion module <a href="https://wirenboard.com/wiki/index.php/Wiren_Board_6:_%25D0%259C%25D0%25BE%25D0%25B4%25D1%2583%25D0%25BB%25D1%258C_%25D1%2580%25D0%25B0%25D1%2581%25D1%2588%25D0%25B8%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%2522%25D1%2581%25D1%2583%25D1%2585%25D0%25B8%25D0%25B5_%25D0%25BA%25D0%25BE%25D0%25BD%25D1%2582%25D0%25B0%25D0%25BA%25D1%2582%25D1%258B%2522_(WBE2-DI-DR-3)">WBE2-DI-DR-3</a> .  Further, to determine the coin, we only need to count the pulses.  To do this, create a new script in the rules engine: <br><br><div class="spoiler">  <b class="spoiler_title">money.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> timeout_ms = <span class="hljs-number"><span class="hljs-number">1</span></span> * <span class="hljs-number"><span class="hljs-number">200</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> timer_id = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> timerTime = <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.now(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> timerLast = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> countMoney = <span class="hljs-number"><span class="hljs-number">0</span></span>; defineRule(<span class="hljs-string"><span class="hljs-string">"money"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">whenChanged</span></span>: <span class="hljs-string"><span class="hljs-string">"wb-gpio/MOD1_IN2"</span></span>, <span class="hljs-attr"><span class="hljs-attr">then</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newValue, devName, cellName</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newValue) { timerLast = <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.now() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((timerLast - timerTime) &gt;= <span class="hljs-number"><span class="hljs-number">500</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// ? timerTime = Date.now(); countMoney = 1; } else { timerTime = Date.now(); //     countMoney++; } if (timer_id) { clearTimeout(timer_id); } timer_id = setTimeout(function() { //       if (countMoney == 5) { log("10 ") } else if (countMoney == 4) { log("5 ") } else if (countMoney == 3) { log("2 ") } else if (countMoney == 2) { log("1 ") } timer_id = null; }, timeout_ms); } } });</span></span></code> </pre><br></div></div><br>  Pretty simple rule.  Perhaps not the most accurate. <br><br><h2>  Bitrix24 </h2><br>  Now probably the most interesting.  Let's try to figure out how to translate the phrase ‚ÄúWell done.  Take a cookie from the shelf. ‚Äù  In our company, Bitrix24 is used as CRM.  The idea is that for each completed task (Task) in the bitrix an employee receives certain electronic points.  These same points can be used as currency for our device.  Let's figure out how to connect to Bitrix24 and monitor employee success. <br><br> <a href=""><img src="https://habrastorage.org/webt/m3/tt/yk/m3ttykeum6-qm1pjvbqxa2golh0.png" width="350" alt="Click for larger image"></a> <br><br>  We will take bitrix24-python-sdk as a basis. <br>  Install the SDK on the controller with the command <br> <code>pip install bitrix24-python-sdk</code> <br> <br>  Next, create a python script in the root folder, let's call it bitrix.py: <br><br><div class="spoiler">  <b class="spoiler_title">bitrix.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python3 import pprint from bitrix24 import bitrix24 import sys import subprocess b24_webhook_key = 'some_key' #   ,    . b24_webhook_user = 1 # ID  -    . b24_domain = 'some_domain' #  . page = 1 user_id = [16, 10, 6, 55, 8, 14, 67, 20] #  ,     ord_status = 5 # 5 -   order_list = 0 total_orders = 0 bx24 = bitrix24.Bitrix24(b24_domain, webhook_key=b24_webhook_key, webhook_user=b24_webhook_user) def get_order_list_len(_user_id): result_ = bx24.call( 'task.item.list', {'ORDER': {'DEADLINE': 'desc'}}, {'FILTER': {'RESPONSIBLE_ID': _user_id,'REAL_STATUS': ord_status}}, {'PARAMS': {'NAV_PARAMS': {'nPageSize': 50, 'iNumPage': page}}} ) if result_: return (len(result_['result'])) for user in user_id: while True: order_list = get_order_list_len(user) total_orders = total_orders + order_list page = page + 1 if(order_list &lt; 50): subprocess.call("mosquitto_pub -t /devices/%s/controls/orders_finished/on -r -m %s" % (user, total_orders), shell=True) #    MQTT. page = 1 total_orders = 0 break</span></span></code> </pre><br></div></div><br>  This script requests all completed tasks of a given list of users, counts them and sends the number to mqtt topics.  Then we just have to compare the received quantity with the previous values ‚Äã‚Äãand if the new data is more, then add points to the employee for the work done. <br><br><h2>  Bluetooth </h2><br>  I use Bluez to scan BLE devices.  The program is already installed on the controller.  In order to scan the ble device it is enough to enter several commands into the console: <br><br><pre> <code class="hljs pgsql">hciconfig hci0 up hcitool lescan <span class="hljs-comment"><span class="hljs-comment">--duplicates</span></span></code> </pre> <br>  However, this is not enough for us.  It is advisable to see the level of the signal.  To do this, install the additional utility hcidump: <br><br><pre> <code class="hljs swift">apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> install bluez-hcidump</code> </pre> <br>  And complement our team: <br><br><pre> <code class="hljs pgsql">hciconfig hci0 up hcitool lescan <span class="hljs-comment"><span class="hljs-comment">--duplicates | hcidump -a | grep -E 'bdaddr|RSSI'</span></span></code> </pre> <br>  At the output we get MAC addresses and RSSI bluetooth (ble) devices nearby. <br><br> <a href=""><img src="https://habrastorage.org/webt/eg/st/ar/egstarnarzrsym0nfutrfwhawhc.png" width="650" alt="Click for larger image"></a> <br><br>  These two lines can be beautifully wrapped in a bash script, and the output sent to the MQTT. <br>  The second <a href="https://github.com/frawau/aioblescan">way is aioblescan</a> script <br>  It requires Python 3, preferably 3.5.  The advantage of this script is that you can monitor specific MAC addresses, and not all by passing smart watches and smartphones passing by the window.  The script output is also redirected to MQTT, for the convenience of working with the rules engine. <br><br> <a href=""><img src="https://habrastorage.org/webt/co/bk/cl/cobkcltejo3kbwvhpk-rduxlgxk.png" width="400" alt="Click for larger image"></a> <br><br>  Now we know how to interact with WB6 using the on-screen module, we are able to count coins, monitor the success of employees in Bitrix, scan the ble devices and their signal level.  It remains to collect this in one pile and prescribe some logic.  I will not paint all the scripts of this project.  Everything will be available on the link in the public domain.  Perhaps one of you will find for this all the most useful and clever use. <br><br><h2>  Housing </h2><br>  The body is made of 10mm PVC foam.  Sold such plastic sheets.  Moderately mild.  You can cut with a hacksaw or with a regular stationery knife along the ruler. <br><br> <a href=""><img src="https://habrastorage.org/webt/jx/nc/7e/jxnc7ef0lwmeow3j4fhlyz4--gs.jpeg" width="400" alt="Click for larger image"></a> <br><br>  As a fastener was used a children's set of metal parts "Designer" and short screws.  In this set there was almost everything needed to assemble the case. <br><br> <a href=""><img src="https://habrastorage.org/webt/h0/5m/jl/h05mjlqrtr82bk4krmbjkeyetzq.jpeg" width="400" alt="Click for larger image"></a> <br><br><h2>  Drive unit </h2><br>  The spiral and the drive were purchased in the online store B \ U app.  parts for vending machines.  Powered by 24v power supply.  Commuted through the relay module expansion <a href="https://wirenboard.com/wiki/index.php/Wiren_Board_6:_%25D0%259C%25D0%25BE%25D0%25B4%25D1%2583%25D0%25BB%25D1%258C_%25D1%2580%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25B9%25D0%25BD%25D1%258B%25D1%2585_%25D0%25B2%25D1%258B%25D1%2585%25D0%25BE%25D0%25B4%25D0%25BE%25D0%25B2_(WBE2-DO-R6C-1)">WBE2-DO-R6C-1</a> . <br><br> <a href=""><img src="https://habrastorage.org/webt/es/fa/ar/esfaaryqjf8rslpblwesr3fcrgm.png" width="200" alt="Click for larger image"></a> <a href=""><img src="https://habrastorage.org/webt/be/oa/kt/beoaktz2glv7ksdvod0n4ehkn5e.png" width="200" alt="Click for larger image"></a> <a href=""><img src="https://habrastorage.org/webt/v7/bn/0p/v7bn0pxipe6w-bi328ugegtuh3e.png" width="200" alt="Click for larger image"></a> <br><br><h2>  Functional </h2><br>  Functionally similar to a regular vending machine.  Gives cookies for money and not only. <br><img src="https://habrastorage.org/webt/oy/kw/vh/oykwvhvrnx0sscx1kktd6fhcej8.gif"><br><br>  When you start the device, the screen shows a splash screen with a logo, then jumps to the main screen, where we are invited to either buy cookies or play a game. <br><br>  The game for the user is free, but you can set a small price for motivation.  The rules are simple.  The player is offered to solve three simple puzzles.  If he gives three correct answers, he gets a prize in the form of cookies.  Perhaps this is all you need to know about this item.  Let's go back to the main menu and click "Buy Cookies". <br><br>  Further, the system will offer to choose a payment method.  When you select the ‚ÄúFor Money‚Äù payment method, a window appears on the screen with the price and the paid amount, which increases when you make money in the coin acceptor. <br><br>  As soon as the amount is sufficient to complete the purchase, the device will automatically close this window and issue the goods. <br><br>  But, as I mentioned earlier, another currency is provided for - these are points obtained for the success of employees in the Bitrix24 system.  If the employee closes the task assigned to him - points are awarded to him.  Also, points may accrue to the boss for particularly good results. <br><br><img src="https://habrastorage.org/webt/cm/ng/ox/cmngoxpzdzbmt3hxh9xc9l9whac.png" width="360" alt="Click for larger image"><img src="https://habrastorage.org/webt/p6/bw/yr/p6bwyraqciiu2v0tu371qypzfxq.png" width="360" alt="Click for larger image"><br><img src="https://habrastorage.org/webt/kk/df/7d/kkdf7dnz548knhk5p17_21zj6nu.png" width="360" alt="Click for larger image"><img src="https://habrastorage.org/webt/wg/9w/cl/wg9wcltq4yk9ogjh-jik8kt0ogc.png" width="360" alt="Click for larger image"><br><br>  To pay points, the employee must select the item "Buy for points", then the device will try to determine who is standing in front of him.  To do this, he scans the Bluetooth device around him and if he sees the MAC address of the device belonging to the employee and listed in the database, as well as the signal level is powerful enough to assume that he is standing nearby, then the data on the account status of the employee, his name and offer to pay for cookies by points. <br><br>  If the system failed to identify a single familiar device, it will issue a warning and prompt you to choose your name from the list and then enter your PIN code. <br><br>  In the case of correct input, the same window will open with data on the state of the user's account and the value of the product.  Upon confirmation of the purchase, the required amount of points is deducted from the user's account and the device issues the goods. <br><br>  That's all.  This project was created solely for educational purposes, and to show that the use of the Wiren Board controller is limited only by imagination.  All files and scripts can be found by <a href="https://github.com/Yanni66/coockinator">reference</a> . </div><p>Source: <a href="https://habr.com/ru/post/420831/">https://habr.com/ru/post/420831/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420819/index.html">Top 10 Python tools for machine learning and data-science</a></li>
<li><a href="../420821/index.html">Rule 10: 1 in programming and writing</a></li>
<li><a href="../420825/index.html">Today will be the first match between OpenAI and Dota 2 professionals (people won). Understanding how the bot works</a></li>
<li><a href="../420827/index.html">Create a simple maven project using Java EE + WildFly10 + JPA (Hibernate) + Postgresql + EJB + IntelliJ IDEA</a></li>
<li><a href="../420829/index.html">Job System. Review on the other hand</a></li>
<li><a href="../420833/index.html">The main mistakes monetization of the application [and how to fix them]</a></li>
<li><a href="../420835/index.html">"Kalashnikov" showed the concept of a combat robot and electric motorcycle for the civilian market</a></li>
<li><a href="../420837/index.html">Testing software RAIDs for NVMe devices using the SNIA technique</a></li>
<li><a href="../420841/index.html">Pre-hospital hotfix or ‚ÄúHey, Swagger! Where are my mistakes? ‚Äù</a></li>
<li><a href="../420843/index.html">September 7, Ekaterinburg - mitap for .NET developers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>