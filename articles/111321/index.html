<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We program in C / C ++ in Visual Studio under Arduino</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This post will help beginners save a few hours (days) for setting up the Visual Studio environment for developing for Arduino in C / C ++. 




 Pream...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We program in C / C ++ in Visual Studio under Arduino</h1><div class="post__text post__text-html js-mediator-article">  This post will help beginners save a few hours (days) for setting up the Visual Studio environment for developing for Arduino in C / C ++. <br><br><img src="https://habrastorage.org/storage/habraeffect/76/48/7648582f55618ab9c3d007bad1ff9190.png" alt="image"><br><br><a name="habracut"></a><br><h4>  Preamble </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A couple of months ago I saw a teacher with a kind of scarf connected to a computer.  On a scarf seven-segment indicators and several LEDs were visible.  The teacher was versed in some kind of code; in the meantime, the veil signaled to him something vividly.  I was immediately interested in what he was doing there ... However, all I can learn from him is that the name is debugging.  By a short googling I go out on a toy called ‚ÄúArduino‚Äù.  I order myself an Arduino mega, the one with the Atmega1280 (only $ 29.99) and in two weeks running to the post office to receive the cherished toy. <br><br><h4>  Plot </h4><br><br>  Because  I am an avid Windows developer accustomed to the VS environment, then I decided to immediately distract myself from the Arduino IDE native environment. <br><br>  So, we will need: <br><ul><li>  Actually, the environment itself; </li><li>  Visual Assist X - optional, to facilitate development.  Replaces itself with built-in IntelliSense built-in VS.  A bunch of additional options.  Pay; </li><li>  WinAVR latest version.  This is a C / C ++ program compiler for the AVR ‚Äúplatform‚Äù; </li><li>  avr-libc.  Minimal implementation of the standard C library for AVR.  Contains such useful functions as, for example, _delay_ms or _delay_us (delay in milli- and microseconds); </li><li>  Avrdude.  Desirable fresh version, universal programmer for AVR; </li><li>  FTDI Virtual Com Port Drivers.  Without going into details, we will call it ‚Äúdrivers for Arduino‚Äù; </li><li>  AvrStudio - optional.  It has a built-in simulator of the microcontroller that allows you to debug the program step by step; </li><li>  Arduino schematic.  You will need this pdf-file in order to find out which ports of the Arduino outputs are connected to which ICs. </li></ul><br><br>  All googled at once. <br><br>  So let's get started.  Install WinAVR, avr-libc, download Avrdude.  Connect the Arduino to the computer and install the driver.  Create a ‚Äúmakefile project‚Äù in Visual Studio.  Fill in the fields as shown below. <br><br><img src="https://habrastorage.org/storage/habraeffect/ea/27/ea2728f783d95d90f29c78e0830992cb.png" alt="image"><br><br>  In the place where WinAVR was installed in the sample subdirectory, there is a Makefile that can be used to build the project.  We copy to ourselves, in the folder created by the makefile project, and change some lines: <br><br> <code>MCU = atmega1280 <br> F_CPU = 16000000 <br> FORMAT = ihex <br> TARGET = ATMEGA-1280-DEV-BOARD <br> SRC = $(TARGET).C</code> <br> <br><ul><li>  The first line indicates the type of microcontroller.  For Arduino, mega is atmega1280; </li><li>  The second line sets the frequency at which our MK will work; </li><li>  The third line is the output file format.  It is better to leave intel hex; </li><li>  The fourth is the name of your project; </li><li>  The fifth is a list of project source files. </li></ul><br> <code>PROGRAMMER_FLAGS = -p m1280 -c arduino -b 57600 -P COM3 -U flash:w:$(TARGET).hex</code> <br> <br>  This string will be passed as parameters for Avrdude. <br><ul><li>  The -p option specifies the type of device to be sewn; </li><li>  -c indicates the type of programmer.  Arduino uses the information exchange protocol borrowed from the STK500 programmer, so here you can safely enter stk500.  However, in the new version of avrdude they added Arduino as a programmer, so with confidence we enter arduino here with confidence; </li><li>  The next option indicates at what speed the data transfer will occur.  Here you should always put 57600; </li><li>  The -P option specifies the port to which the programmer is connected; </li><li>  The last option indicates which operation should be performed.  For us, this is loading the program's microcontroller into flash memory. </li></ul><br><br>  Change the all section to something like this: <br> <code>all: build program</code> <br>  Add to the list of tasks ¬´program¬ª.  With a successful compilation, this will automatically load the firmware into the MC. <br><br>  Basically, everything is ready.  We try to write a minimal program (blinker LED L).  We look at the file arduino-mega-schematic.pdf and see that port 13 of the Arduino is nothing like PB7.  We write about the following program: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#include &lt;avr/io.h&gt; <br> #include &lt;util/delay.h&gt; <br> <br> <font color="#0000ff">int</font> main() <br> { <br> DDRB = 0xFF; <br> <font color="#0000ff">while</font> ( <font color="#0000ff">true</font> ) <br> { <br> PORTB |= (1 &lt;&lt; 7); <br> _delay_ms(500); <br> PORTB &amp;= ~(1 &lt;&lt; 7); <br> _delay_ms(500); <br> } <br> <font color="#0000ff">return</font> 0; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The minimum interface for working with I / O ports: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#include <font color="#A31515">"utils.h"</font> <br> <br> <font color="#0000ff">class</font> Port <br> { <br> <font color="#0000ff">public</font> : <br> Port(PORT&amp; p) : _p(p) {}; <br> Port&amp; <font color="#0000ff">operator</font> ! (); <br> Port&amp; <font color="#0000ff">operator</font> += (uint8 b); <br> Port&amp; <font color="#0000ff">operator</font> -= (uint8 b); <br> Port&amp; <font color="#0000ff">operator</font> = (Port&amp; p); <br> <font color="#0000ff">void</font> SetLow(); <br> <font color="#0000ff">void</font> SetHigh(); <br> PORT&amp; GetValue(); <br> <font color="#0000ff">bool</font> ClearBit(uint8 b); <br> <font color="#0000ff">bool</font> SetBit(uint8 b); <br> <font color="#0000ff">void</font> Pulse(uint8 t); <br> <font color="#0000ff">void</font> PulseBit(uint8 b, uint8 t); <br> <font color="#0000ff">private</font> : <br> PORT&amp; _p; <br> };</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Save the makefile, build the project, admire the result. <br><img src="https://habrastorage.org/storage/habraeffect/f7/a0/f7a0be744d9cd57a7b8361b1c6f7991a.jpg" alt="image"><br><br>  P.S.  By the 10th, a set of various sensors and sensors will arrive.  By February, I will assemble an ultrasonic rangefinder and a photographic recorder. <br></div><p>Source: <a href="https://habr.com/ru/post/111321/">https://habr.com/ru/post/111321/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111313/index.html">Simple firewall using puppet</a></li>
<li><a href="../111314/index.html">5 things you might not know about jQuery</a></li>
<li><a href="../111315/index.html">Flash + IntelliJ IDEA</a></li>
<li><a href="../111318/index.html">Zephyr solar drone set three new records</a></li>
<li><a href="../111319/index.html">Non-standard Referer in opera-mini</a></li>
<li><a href="../111322/index.html">Mouse from Microsoft. Arc touch</a></li>
<li><a href="../111323/index.html">NEC officially unveils LT-W Cloud Communicator</a></li>
<li><a href="../111324/index.html">Using, configuring and testing distcc and ccache</a></li>
<li><a href="../111325/index.html">Angry Birds - now for Windows</a></li>
<li><a href="../111327/index.html">Electronic documentation in schools (ACS RNO)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>