<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rainbow CSV plugin as an alternative to Excel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! This article is about the Rainbow CSV plugin, which I wrote for 5 text editors: 


 VS Code , Vim , Sublime Text 3 , Atom , Gedit 


 I thin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rainbow CSV plugin as an alternative to Excel</h1><div class="post__text post__text-html js-mediator-article"><p>  Hi, Habr!  This article is about the Rainbow CSV plugin, which I wrote for 5 text editors: </p><br><p>  <a href="https://marketplace.visualstudio.com/items%3FitemName%3Dmechatroner.rainbow-csv">VS Code</a> , <a href="https://github.com/mechatroner/rainbow_csv">Vim</a> , <a href="https://packagecontrol.io/packages/rainbow_csv">Sublime Text 3</a> , <a href="https://atom.io/packages/rainbow-csv">Atom</a> , <a href="https://github.com/mechatroner/gtk_gedit_rainbow_csv">Gedit</a> </p><br><p>  I think that many readers of this article periodically encounter CSV (comma-separated), TSV (tab-separated) and similar files.  If you try to open them in a text editor (and how else to find out what's inside?), Then a completely nondescript picture will open up as on the left side of the image.  Looking at it is difficult to say even how many columns in the table.  On the right side of the picture is the same file with the included RainbowCSV, readability significantly improved due to syntax highlighting. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c66/3f3/956/c663f3956de322003c5b926fd21693a6.png" alt="image"></p><a name="habracut"></a><br><p>  The syntax for such a highlight, oddly enough, is set with just one (albeit long) line-regular expression: </p><br><pre><code class="hljs mel">((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|$))|(?:[^,]*(?:,|$)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|$))|(?:[^,]*(?:,|$)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|$))|(?:[^,]*(?:,|$)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|$))|(?:[^,]*(?:,|$)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|$))|(?:[^,]*(?:,|$)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|$))|(?:[^,]*(?:,|$)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|$))|(?:[^,]*(?:,|$)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|$))|(?:[^,]*(?:,|$)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|$))|(?:[^,]*(?:,|$)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|$))|(?:[^,]*(?:,|$)))?</code> </pre> <br><p>  The whole highlighting rule can be found, for example, <a href="">here</a> (version for VS Code), but, apart from the regular expression itself, there is absolutely nothing to look at. </p><br><p>  For comparison, the syntax files for general purpose languages ‚Äã‚Äãsuch as Python, JS, C ++, etc.  usually take a few hundred lines of a very esoteric code. </p><br><p>  In order not to load the article with details, guess what the main parts consist of and how this regular expression works is offered to the readers. </p><br><p>  Hint: Here's a simple expression <code>([^,]*,)?([^,]*,)?</code>  - will highlight the CSV file in 2 different alternating colors, but it will not work correctly on commas inside the fields, shielded with quotes. </p><br><p>  By the way, hereinafter the version of Rainbow CSV for Visual Studio Code is described, since  This version of the plugin is currently the most technically advanced and popular (more than 500K downloads). </p><br><p>  So, besides the fact that Rainbow CSV highlights columns, it can also: </p><br><ul><li>  Tell which column the cursor is currently pointing at: column number + title from the first line header.  If there is no header line at the beginning of the file (the data goes immediately), then the user can specify his ‚ÄúVirtual‚Äù header. </li><li>  Automatically check the file for a different number of records per line or incorrect use of escape characters - "CSV Lint". </li><li>  Run a SQL-like query using the RBQL interpreter embedded in the plugin, which allows you to apply a very wide class of text transformations to the input table. <br>  RBQL supports almost all SQL statements (SELECT, UPDATE, WHERE, ORDER BY, TOP / LIMIT, JOIN, GROUP BY) as well as all standard functions and operators from JavaScript and Python. <br>  RBQL is a separate technology, but it fits very well with the concept of Rainbow CSV, and therefore this integration has many advantages. </li></ul><br><p>  One of the most important features of Rainbow CSV plug-ins is the automatic detection of CSV files by their content.  This functionality is essential because  Often, CSV (or TSV) files have a file extension other than .csv (.tsv).  You can also find files with the .csv extension in which a semicolon is actually used as a separator <code>;</code>  .  The algorithm for determining the table file by content is very simple - it is enough to check that the number of cells in each line during the split for this separator is constant&gt; 1. </p><br><h3 id="sravnenie-rainbow-csv-s-graficheskim-vyravnivaniem">  Comparing Rainbow CSV with Graphic Alignment </h3><br><p>  In general, the traditional way to view CSV data is to import them into a graphics editor, such as Excel. <br>  Compared to this method, Rainbow CSV has both advantages and disadvantages: </p><br><h4 id="preimuschestva">  Benefits: </h4><br><ul><li>  What you see is what you get - you can be sure that what you see on the screen is the real contents of the file. </li><li>  Familiar environment favorite text editor </li><li>  Zero-cost abstraction: Syntax highlighting is very ‚Äúcheap‚Äù from a computational point of view compared to graphical alignment. </li><li>  Higher information density: More data fits on one screen - graphic alignment ‚Äúeats up‚Äù a lot of space due to leveling gaps. </li><li>  The ability to visually link one column (highlighted in the same color) from different windows </li></ul><br><h4 id="nedostatki">  Disadvantages: </h4><br><ul><li>  The standard implementation uses 10 different colors, so when the number of columns is greater than 10, the colors begin to repeat and the color coding efficiency of the columns decreases. </li><li>  There is no support for moving lines in cells that are escaped with double quotes.  <a href="https://github.com/mechatroner/vscode_rainbow_csv/issues/4">Here</a> you can read the details of this problem.  However, I believe that CSV with a line break inside cells is an extremely impractical format. </li></ul><br><h3 id="sravnenie-s-tekstovym-vyravnivaniem">  Text alignment comparison </h3><br><p>  Another way to improve the readability of CSV files is alignment with spaces, but this method modifies the contents of the file, and therefore its applicability is very limited. </p><br><p>  Also, in my opinion, the readability of the file after the syntactic Rainbow backlight is better than that of the file, which has been aligned with spaces. </p><br><h2 id="nemnogo-o-proekte">  Little about the project </h2><br><p>  The first version of Rainbow CSV was written 5 years ago for Vim based on the <a href="">rainbow_parentheses</a> plugin. As you can see, from this project I borrowed not only a part of the code, but half of the name =) <br>  Versions for VSCode, Atom, and Sublime Text 3 appeared a year ago. </p><br><p>  Many critical features and improvements have been proposed by plugin users. </p><br><h2 id="sravnenie-processa-razrabotki-plagina-dlya-raznyh-redaktorov">  Comparison of plugin development process for different editors </h2><br><p>  In conclusion, I can make a small comparison of the API of popular text editors. <br>  The API for plug-ins for VSCode, Atom and Sublime Text 3 are quite similar to each other, the main difference is that the extensions for VS Code and Atom are written in JavaScript, and for Sublime Text 3 in Python. </p><br><p>  All 3 editors use the same regular expression engine for syntactic highlighting, so the transfer of Rainbow CSV between these editors required only minimal adaptation of regulars. </p><br><p>  In general, I can say that the most pleasant and convenient plugin development process is provided by VS Code.  On the other hand, for some reason, it lacked some functionality necessary for the full-fledged work of the Rainbow CSV, but the VS Code team happily accepted and improved my PR, which added the method I needed. </p><br><p>  Writing plugins for Vim is very different from these 3 newer editors.  Vim uses its own VimScript language, as well as various commands to manipulate the contents of open files.  The syntax model that Vim uses for highlighting is also quite different from what VSCode, Atom, and Sublime provide. </p><br><h3 id="ssylki">  References: </h3><br><ul><li>  <a href="https://marketplace.visualstudio.com/items%3FitemName%3Dmechatroner.rainbow-csv">Rainbow CSV in VS Code</a> </li><li>  <a href="https://github.com/mechatroner/rainbow_csv">Rainbow CSV in Vim</a> </li><li>  <a href="https://packagecontrol.io/packages/rainbow_csv">Rainbow CSV in Sublime Text 3</a> </li><li>  <a href="https://atom.io/packages/rainbow-csv">Rainbow CSV in Atom</a> </li><li>  <a href="https://github.com/mechatroner/gtk_gedit_rainbow_csv">Rainbow CSV in Gedit</a> </li><li>  <a href="https://rbql.org/">rbql.org</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/429548/">https://habr.com/ru/post/429548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../429536/index.html">PHP Digest number 143 (November 1 - 12, 2018)</a></li>
<li><a href="../429540/index.html">We restore the detailed geometry of objects for more accurate assortment validation.</a></li>
<li><a href="../429542/index.html">Private messages from 81,000 Facebook accounts put up for sale</a></li>
<li><a href="../429544/index.html">Big conference NIXMultiConf (Kharkov)</a></li>
<li><a href="../429546/index.html">"The courses were not only for the sake of knowledge, many had career ambitions and professional development tasks"</a></li>
<li><a href="../429550/index.html">The story of the 33 extensions for VS Code, their development and management</a></li>
<li><a href="../429552/index.html">The JavaScript Guide, Part 1: First Program, Language Features, Standards</a></li>
<li><a href="../429554/index.html">Tesla costs</a></li>
<li><a href="../429556/index.html">JavaScript Guide, Part 2: Code Style and Program Structure</a></li>
<li><a href="../429560/index.html">SamsPcbGuide: Release of the first version of the book</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>