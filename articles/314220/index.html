<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>goader - console benchmark with a bias for writing and reading files</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="goader is a console benchmark with a simple configuration and support for various backends for testing. The name comes from go and loader, and also ha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>goader - console benchmark with a bias for writing and reading files</h1><div class="post__text post__text-html js-mediator-article"><p>  <em>goader</em> is a console benchmark with a simple configuration and support for various backends for testing.  The name comes from go and loader, and also has its meaning in English, "customized spear, stick" </p><br><p>  At the moment, you can test (argument <em>-requests-engine</em> ): </p><br><ul><li>  http (GET requests or GET + PUT) </li><li>  disk </li><li>  s3 (With authorization by ACCESS / SECRET keys, endpoint is required, but it gives the opportunity to check private s3, signature ver4 is currently not supported, but I plan) </li><li>  null and sleep to test the benchmark itself </li></ul><br><p>  The bias is made to write and read files, not pages. </p><br><h3 id="primer-ispolzovaniya">  Usage example </h3><br><pre><code class="hljs matlab">goader -rps=<span class="hljs-number"><span class="hljs-number">300</span></span> -wps=<span class="hljs-number"><span class="hljs-number">150</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">min</span></span>-body-<span class="hljs-built_in"><span class="hljs-built_in">size</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>-body-<span class="hljs-built_in"><span class="hljs-built_in">size</span></span>=<span class="hljs-number"><span class="hljs-number">128</span></span>k --<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>-requests=<span class="hljs-number"><span class="hljs-number">1000</span></span> -requests-engine=disk -url=tmp/NN/RRRRR</code> </pre> <br><img src="https://habrastorage.org/files/702/be5/4f1/702be54f18ff4bbca17c01895ba993b4.png" alt="image"><br><p><br>  The points appear in real time in accordance with each request; in due time, this allowed me to visually identify problems, in the case that the numbers would give little.  In case of errors in their place will be E </p><br><p>  There are many utilities for load testing, but I personally have a number of complaints about them, which inspired me to write my own ... </p><a name="habracut"></a><br><h2 id="problema-nomer-1-chto-my-testiruem">  Problem number 1, what are we testing? </h2><br><p>  The emphasis is on ‚Äúthe number of parallel threads‚Äù, the search for the maximum load, the maximum number of threads.  Or a fixed number of threads.  This is of course great, but personally in my case, in real life, when replacing any component of the system, it was quite rare that this question arose how much it would pull.  When replacing components, there are often two more questions and they are different: </p><br><p>  a) Response at a known load.  Like for example 50 PUT / s, 300 GET / s.  Check the response time on the old and new system.  From the replacement of components, the number of users will not grow, the goal is usually to improve the responsiveness of the system. </p><br><pre> <code class="hljs mel">goader -rps=<span class="hljs-number"><span class="hljs-number">300</span></span> -wps=<span class="hljs-number"><span class="hljs-number">50</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">min</span></span>-body-<span class="hljs-keyword"><span class="hljs-keyword">size</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>-body-<span class="hljs-keyword"><span class="hljs-keyword">size</span></span>=<span class="hljs-number"><span class="hljs-number">128</span></span>k -requests-engine=upload -url=http:<span class="hljs-comment"><span class="hljs-comment">//localhost/files/user_NNNNN/file_RRRR</span></span></code> </pre> <br><p>  b) We still want to give more than it was, we want to know the maximum of the system.  Again, what is it?  Number of clients that the server can handle?  Number of parallel customers who receive the N-th percentage of errors?  Very often there are no errors, but just get a huge response time. </p><br><p>  Therefore, for myself, the maximum of the system I defined as ‚Äúthe number of parallel clients, at which the response time does not exceed the specified value." </p><br><pre> <code class="hljs matlab">goader -rpw <span class="hljs-number"><span class="hljs-number">2</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>-latency <span class="hljs-number"><span class="hljs-number">5</span></span>ms -requests-engine=disk -url=tmp/RRRRRRR -body-<span class="hljs-built_in"><span class="hljs-built_in">size</span></span>=<span class="hljs-number"><span class="hljs-number">4</span></span>k -<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>-requests=<span class="hljs-number"><span class="hljs-number">30000</span></span></code> </pre> <br><p>  The load is aligned with WRITEs (PUT / WriteFile), the number of READs is set relative to WRITEs, that is, reads-per-write, readings per write - in Example 2, it can be a fractional number. </p><br><p>  The number of threads will adapt to the delays and the output will be the number of simultaneous customers that we can withstand this load.  Optionally, the maximum can be limited-increased by the argument -max-channels, by default 32. </p><br><p>  The traditional ‚Äúnumber of simultaneous clients‚Äù also exists, -wt = 5 -rt = 10 (5 write threads, 10 per read). </p><br><p>  These are 2 modes which were not enough for me.  But there was a problem number 2 for benchmarks I tested. </p><br><h2 id="slozhnost-konfiguracii">  Configuration complexity </h2><br><p>  An additional requirement for myself was the lack of UI and configuration files.  This is of course very cool when the million settings and possibilities are endless, but this requires another powerful machine, UI, half a day to write the configuration and then drag these files along.  Of course, sometimes this is still a plus, it was important for me to be able to connect to any of the servers and be able to run a system test manually from memory.  Or send a short message to the employees in a short message with the team, and then they will do everything themselves.  In the extreme case, peep into the goader --help and again all will finish it themselves. </p><br><p>  So far, it has been possible to do without configuration files, and I hope to keep it that way. </p><br><p>  For example, often the list of paths is provided by a separate file.  Alternative: <code>-url=http://127.0.0.1/user/NNNN/images/RRRRRRR.jpg</code> <br>  NNNN - will be replaced by random numbers <br>  RRRRRRR - will be replaced by random letters <br>  XXXXX - will be replaced by successively increasing numbers </p><br><h2 id="naglyadnost">  Visibility </h2><br><p>  Numbers in numbers, and sometimes with eyes you can see anomalies that are difficult to see in numbers, not knowing what to look for.  Each request is displayed in the console with a dot (green - read, blue - record), error E, change of the number of threads with the arrow up or down. <br>  This feature allowed us to find problems in the system, as we were able to visually see how the performance slipped at a certain moment. </p><br><p>  In addition, the end result also tends to be concise and informative.  It is possible to replace it with json, <code>-output=json/human</code> <br>  Sometimes points get in the way, you can turn them off. <code>-show-progress=false</code> </p><br><p>  With a large number of requests, or with remote execution, it is difficult to see progress with your eyes, for this there is an experimental function of creating an html file with visual display ( <code>-timeline-file=timeline.html</code> ) when the request came out and how long it took.  There are plans to improve, to change the display of the lifetime of a query to a vertical one and then it will be much more obvious how many queries existed.  But for now this is not a priority. </p><br><h4 id="podderzhka-prostyh-http-zaprosov">  Support simple http requests </h4><br><p>  By simple I mean only GET requests to pages, without PUTs using all the above.  This was not a priority, but you can use it. </p><br><p>  Requests per second: </p><br><pre> <code class="hljs swift">goader -rps=<span class="hljs-number"><span class="hljs-number">300</span></span> --<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>-requests=<span class="hljs-number"><span class="hljs-number">1000</span></span> -url=http:<span class="hljs-comment"><span class="hljs-comment">//localhost/user/NN/product/RRRR</span></span></code> </pre> <br><p>  Number of simultaneous clients: </p><br><pre> <code class="hljs swift">goader -rt=<span class="hljs-number"><span class="hljs-number">32</span></span> --<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>-requests=<span class="hljs-number"><span class="hljs-number">1000</span></span> -url=http:<span class="hljs-comment"><span class="hljs-comment">//localhost/user/NN/product/RRRR</span></span></code> </pre> <br><p>  Search for the maximum number of simultaneous clients with a specified maximum delay: </p><br><pre> <code class="hljs swift">goader -wt=<span class="hljs-number"><span class="hljs-number">0</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>-latency=300ms --<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>-requests=<span class="hljs-number"><span class="hljs-number">1000</span></span> -url=http:<span class="hljs-comment"><span class="hljs-comment">//localhost/user/NN/product/RRRR</span></span></code> </pre> <br><p>  It is better to do more requests in this mode, for more accurate results. </p><br><p>  By the way, it was my first experience with go, I wanted to test in practice rave reviews, I can not say that I do not support them.  Yes, there are drawbacks, but in general, quick compilation, quick error checking, a single ecosystem, a simple type system - all this makes it possible, as it is fashionable to say, to concentrate on the code, and not on the features of the ecosystem. </p><br><p>  And the fact that, without any extra magic, the output of the binaries for all systems is charm. </p><br><p>  I only upload linux / 386 linux / amd64 windows / amd64 darwin / 386 darwin / amd64 to githabs, but if someone needs to expand this list, then no problem.  Within the framework supported by the golang itself.  Comments about the code itself are also welcome. </p><br><p>  You can download it from <a href="https://github.com/tigrawap/goader/releases">Github</a> or build it yourself, MIT license.  For ease of use it is better to put in $ PATH. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/314220/">https://habr.com/ru/post/314220/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../314208/index.html">Announce Dart Sass</a></li>
<li><a href="../314210/index.html">Development Indie RPG: analysis of two years of development</a></li>
<li><a href="../314212/index.html">Monitoring Docker Hosts, Containers, and Container Services</a></li>
<li><a href="../314216/index.html">How we adjusted the process from storage to software licensing: SupplyLab project</a></li>
<li><a href="../314218/index.html">Optimal Spline Approximation</a></li>
<li><a href="../314222/index.html">Artificial intelligence in the search. How Yandex learned to use neural networks in order to search by meaning, not by words</a></li>
<li><a href="../314224/index.html">Video recordings of the best reports of the .NET conference DotNext 2016 Piter</a></li>
<li><a href="../314226/index.html">We continue to check Microsoft projects: PowerShell analysis</a></li>
<li><a href="../314228/index.html">Google learned how to filter fake installations on Android</a></li>
<li><a href="../314230/index.html">Corporate Laboratories - Program Update</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>