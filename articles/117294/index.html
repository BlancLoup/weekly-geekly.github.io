<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automate Windows Phone 7 Emulator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, 
 In this article we will look at how to automate the Windows Phone 7 emulator and how it will benefit us in real life. 

  Ôøº 
 Ôøº 
 This articl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automate Windows Phone 7 Emulator</h1><div class="post__text post__text-html js-mediator-article">  Hello, <br>  In this article we will look at how to automate the Windows Phone 7 emulator and how it will benefit us in real life. <br><br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/8a/e1/8ae1b381f55efc6349fa7f31d22b4c46.png"></a>  Ôøº <br><a name="habracut"></a>  Ôøº <br>  This article is the second in a series of unrelated articles on the advanced features of Windows Phone 7. <br>  The previous article in this series was called " <a href="http://justinangel.net/WindowsPhone7UnlockedRoms">Windows Phone 7 - Unlocked ROMs</a> ". <br><br><h4>  Why automate Windows Phone 7 emulator? </h4><br>  Currently, the Windows Phone 7 emulator can run developer packages (XAPs) only from Visual Studio 2010. <br>  That is, if we have XAP we cannot force the emulator to load it without Visual Studio. <br>  As we saw in the previous article, the emulator can be run and even installed on machines that do not have Visual Studio.  Read more about it <a href="http://ckpc.com/headline/how-to-run-unlocked-windows-phone-7-build-6176-emulator-without-vs2010">here</a> . <br>  Imagine that at this point in order to load XAPs into the emulator, we must use Visual Studio. <br>  Ôøº <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/94/e9/94e97886225f1b387205bc84881a559e.jpg"></a> <br>  The problem is this: <b>how do we load XAPs into the emulator or devices from WP7, without using Visual Studio?</b> <br>  And yet, how will our Build server run the night tests?  Or how our customers will see our applications? <br>  Ôøº <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/1e/39/1e3904aad8f885ef5dde795ffd4a3e52.jpg"></a> <br>  Clients and Build servers do not have Visual Studio 2010 installed. <br>  So how can we deploy XAPs in an emulator running on these machines? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Stop talking, go to the automation of the WP7 emulator! </h4><br>  Let's create a new solution consisting of a console application and an application for Windows Phone 7. <br><br>  Ôøº <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/42/e6/42e6b1028dcaecb1bfeba7d9ac9b6726.jpg"></a> <br><br>  We will use the console application as an automation tool that can work on any computer with.  NET Framework. <br>  The application for WindowsPhone is the application, the deployment of which we will automate. <br><br><h4>  CoreCon 10 WP7 API </h4><br>  WP7 Automation Secret Sauce is the <b>CoreCon API</b> . <br>  CoreCon libraries have been in a deep hibernation since 2007, when they last received a major update. <br>  But for WP7, the CoreCon API has been updated and is now used in Visual Studio 2010 when deploying applications on WP7 devices and emulators. <br>  Let's add a link to <b>Microsoft.SmartDevice.Connectivity.dll</b> from the CoreCon API. <br>  On the 64-bit system, the DLL can be found at: <i>C: \ Program Files (x86) \ Common Files \ Microsoft Shared \ Phone Tools \ CoreCon \ 10.0 \ Bin \ Microsoft.Smartdevice.Connectivity.dll</i> <br><br>  Ôøº <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/8a/77/8a7736d8d41d1bf3af330faee7a80d46.jpg"></a> <br><br>  Now that we have a link to the CoreCon DLL, we can begin to automate WP7. <br>  This is what we should end up with: <br>  Ôøº <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/4d/1e/4d1ebee96ac822240d623eea56687f9b.jpg"></a> <br><br>  We must perform the following sequence of actions: <ol><li>  Get an instance of WP7 CoreCon SDK </li><li>  Get link to emulator / device </li><li>  Connect to emulator / device </li><li>  Delete previous version </li><li>  Install XAP </li><li>  Launch the application </li></ol><h5>  Getting an instance of WP7 CoreCon SDK </h5><br>  We'll start by getting an instance of the WP7 CoreCon SDK to work with it: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">// Get CoreCon WP7 SDK</font> DatastoreManager dsmgrObj = <font color="#0000ff">new</font> DatastoreManager(1033); Platform WP7SDK = dsmgrObj.GetPlatforms().Single(p =&gt; p.Name == <font color="#A31515">"New Windows Mobile 7 SDK"</font> );</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> // Get CoreCon WP7 SDK DatastoreManager dsmgrObj = <font color="#0000ff">new</font> DatastoreManager(1033); Platform WP7SDK = dsmgrObj.GetPlatforms().Single(p =&gt; p.Name == <font color="#A31515">"New Windows Mobile 7 SDK"</font> ); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">// Get CoreCon WP7 SDK</font> DatastoreManager dsmgrObj = <font color="#0000ff">new</font> DatastoreManager(1033); Platform WP7SDK = dsmgrObj.GetPlatforms().Single(p =&gt; p.Name == <font color="#A31515">"New Windows Mobile 7 SDK"</font> ); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">// Get CoreCon WP7 SDK</font> DatastoreManager dsmgrObj = <font color="#0000ff">new</font> DatastoreManager(1033); Platform WP7SDK = dsmgrObj.GetPlatforms().Single(p =&gt; p.Name == <font color="#A31515">"New Windows Mobile 7 SDK"</font> ); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">// Get CoreCon WP7 SDK</font> DatastoreManager dsmgrObj = <font color="#0000ff">new</font> DatastoreManager(1033); Platform WP7SDK = dsmgrObj.GetPlatforms().Single(p =&gt; p.Name == <font color="#A31515">"New Windows Mobile 7 SDK"</font> );</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><h5>  Getting a link to an emulator / device </h5><br>  Then we need to get a link either to a physical device with WP7, or to an emulator with WP7. <br>  This example will use the emulator, but if you install the fragment " <i>useEmulator = false</i> ", then the same example will try to connect to the physical device with WP7. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#008000">// Get Emulator / Device</font> </li><li>  <font color="#0000ff">bool</font> useEmulator = <font color="#0000ff">true</font> ; </li><li>  Device WP7Device = <font color="#0000ff">null</font> ; </li><li>  <font color="#0000ff">if</font> (useEmulator) </li><li>  WP7Device = WP7SDK.GetDevices (). Single (d =&gt; d.Name == <font color="#A31515">"Windows Phone 7 Emulator"</font> ); </li><li>  <font color="#0000ff">else</font> </li><li>  WP7Device = WP7SDK.GetDevices (). Single (d =&gt; d.Name == <font color="#A31515">"Windows Phone 7 Device"</font> ); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><h5>  Connect to emulator / device </h5><br>  Now we run the emulator / device with WP7. <br>  Please note that we will run the standard WP7 Emulator Image, in a <a href="http://justinangel.net/WindowsPhone7UnlockedRoms">previous article</a> I explained how to use Unlocked ROM as the default ROM. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#008000">// Connect to WP7 Emulator / Device</font> </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Connecting to Windows Phone 7 Emulator / Device ..."</font> ); </li><li>  WP7Device.Connect (); </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Windows Phone 7 Emulator / Device Connected ..."</font> ); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><h5>  Uninstall previous version </h5><br>  Next, we need to check that our application is already installed, and if so, we will remove it. <br>  Since the <b>UpdateApplication</b> method in the current CoreCon API does not work, this is the easiest way to update installed applications. <br><br>  In order to <b>install</b> or <b>remove</b> our application, we need its Application Product Identifier (GUID). <br>  We can get the application GUID from the <i>Properties / WMAppManifest.xml file</i> . <br><br>  Ôøº <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/27/9d/279d656b5f7cb79c176380d4b9660554.png"></a> <br><br>  The following code checks if the application is installed, and if so, removes it. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#2B91AF">Guid</font> appID = <font color="#0000ff">new</font> <font color="#2B91AF">Guid</font> ( <font color="#A31515">"{5e75bba1-fbf6-463c-94ac-fa4a78f8fd12}"</font> ); </li><li>  RemoteApplication app; </li><li>  <font color="#0000ff">if</font> (WP7Device.IsApplicationInstalled (appID)) </li><li>  { </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Uninstalling sample XAP to Windows Phone 7 Emulator / Device ..."</font> ); </li><li></li><li>  app = WP7Device.GetApplication (appID); </li><li>  app.Uninstall (); </li><li></li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Sample XAP Uninstalled from Windows Phone 7 Emulator / Device ..."</font> ); </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><h5>  XAP installation </h5><br>  Now we will install our XAP. <br>  In order to do this, we need information about the following: <br><ol><li>  The location of our XAP. </li><li>  GUID of the application. </li><li>  Location of the application icon. </li></ol><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#008000">// Install XAP</font> </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Installing sample XAP to Windows Phone 7 Emulator / Device ..."</font> ); </li><li></li><li>  app = WP7Device.InstallApplication ( </li><li>  appID, </li><li>  appID, </li><li>  <font color="#A31515">"NormalApp"</font> , </li><li>  <font color="#A31515">@ "D: \ visual studio 2010 \ Projects \ ConsoleApplication1 \ WindowsPhoneApplication1 \ ApplicationIcon.png"</font> , </li><li>  <font color="#A31515">@ "D: \ visual studio 2010 \ Projects \ ConsoleApplication1 \ WindowsPhoneApplication1 \ Bin \ Debug \ WindowsPhoneApplication1.xap"</font> ); </li><li></li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Sample XAP installed to Windows Phone 7 Emulator ..."</font> ); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><h5>  Application launch </h5><br>  And the last step: the launch of our application. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#008000">// Launch Application</font> </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Launching sample app on Windows Phone 7 Emulator ..."</font> ); </li><li>  app.Launch (); </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Launched sample app on Windows Phone 7 Emulator ..."</font> ); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  We are done.  And indeed, when we run our example, the application works as it should: <br>  Ôøº <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/4d/1e/4d1ebee96ac822240d623eea56687f9b.jpg"></a> <br><br><h4>  So, why is the WP7 emulator automation useful? </h4><br>  There are so many good use cases: automatic unit tests, loading nightly builds into an emulator, and even the ability for customers to use a WP7 emulator. <br>  In fact, there are many reasons and situations where the automation of the WP7 emulator can be useful, and you yourself can figure out how to use it in your projects. <br><br>  For example, in <a href="http://vertigo.com/mobile.aspx">Vertigo</a> , we use automation to run the WP7 emulator on multi-touch, laptops that our customers have. <br>  Thus, clients get access to our current builds without having to install Visual Studio 2010. <br><br><h4>  Access to isolated storage </h4><br>  One way of using it is especially interesting to me: automatic running of all unit tests in a project for nightly builds. <br>  Ôøº <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/3b/a4/3ba4a121d37527ae06e897e182e564ec.jpg"></a> <br><br>  To automate the WP7 emulator, we can limit ourselves to the actions that we performed before, but how do we get the results?  Or get instructions? <br><br>  The easiest method I could think of was to contact via cold storage - to read and write files in isolated storage. <br>  Ôøº <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/5f/ea/5fea30aadf1d7540f6b5d43fb9c6ee79.jpg"></a> <br><br>  We will start by writing the file to our WP7 Application IsoStore. <br>  Remember that this code is executed on a WP7 emulator / device. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> MainPage () </li><li>  { </li><li>  Initializecomponent (); </li><li></li><li>  SupportedOrientations = SupportedPageOrientation.Portrait |  SupportedPageOrientation.Landscape; </li><li></li><li>  <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> isoStore = IsolatedStorageFile.GetUserStoreForApplication ()) </li><li>  <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> sw = <font color="#0000ff">new</font> StreamWriter (isoStore.OpenFile ( <font color="#A31515">"Foo.txt"</font> , <font color="#2B91AF">FileMode</font> .OpenOrCreate, FileAccess.Write))) </li><li>  { </li><li>  sw.Write ( <font color="#A31515">"Hello WP7! (Written from WP7 IsoStore, read by Console Harness!)"</font> ); </li><li>  } </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  In principle, we have already added the foo.txt file to our IsoStore and added some text to it. <br><br>  Next, we would use the RemoteIsolatedStorage class and get access to the IsoStore emulator, but it is not yet included in CoreCon10. <br><br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/1c/85/1c8571fb6533d9e9839dc6882c1e86c0.jpg"></a>  Ôøº <br><br>  We would use RemoteApplication.GetIsolatedStorage (), but it is also not yet implemented. <br><br>  Instead, we will use the FileDeployer class. <br>  There is some kind of reflective magic associated with getting a copy of the FileDeployer class that can be used in our application. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  Thread.Sleep (10,000); </li><li>  <font color="#008000">//app.GetIsolatedStore ();</font>  <font color="#008000">&lt;- Throws NotImplementedException</font> </li><li>  <font color="#0000ff">object</font> ConManServer = WP7Device.GetType (). GetField ( <font color="#A31515">"mConmanServer"</font> , BindingFlags.NonPublic | BindingFlags.Instance) .GetValue (WP7Device); </li><li>  FileDeployer f = (FileDeployer) <font color="#0000ff">typeof</font> (FileDeployer) .GetConstructors (BindingFlags. Instance | BindingFlags. NonPublic) [0] .Invoke ( <font color="#0000ff">new</font> <font color="#0000ff">object</font> [] {ConManServer}); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Next, we copy the foo.txt file from the application‚Äôs isolated storage to our local binary folder and put it into the console: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  f.ReceiveFile ( <font color="#A31515">@ "\ Applications \ Data \" + appID + @ "</font> \ data \ isolatedstore \ Foo.txt <font color="#A31515">", @ "</font> \ Foo.txt <font color="#A31515">");</font>  Console.WriteLine ("\ t <font color="#A31515">" + File.ReadAllText (@ "</font> foo.txt")); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  When you run this example, we will be able to see in the console the text obtained from IsoStore. <br>  Ôøº <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/a6/a4/a6a4b4ea001261a45dbb9083ef0d53f4.jpg"></a> <br><br>  And we are done.  We have established a two-way channel between the emulator / WP7 device and the managed .net code. <br><br><h4>  Code </h4><br>  Here is the code that we wrote in this project: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#008000">// Get CoreCon WP7 SDK</font> </li><li>  DatastoreManager dsmgrObj = <font color="#0000ff">new</font> DatastoreManager (1033); </li><li></li><li>  Platform WP7SDK = dsmgrObj.GetPlatforms (). Single (p =&gt; p.Name == <font color="#A31515">"New Windows Mobile 7 SDK"</font> ); </li><li></li><li>  <font color="#008000">// Get Emulator / Device</font> </li><li>  <font color="#0000ff">bool</font> useEmulator = <font color="#0000ff">true</font> ; </li><li>  Device WP7Device = <font color="#0000ff">null</font> ; </li><li>  <font color="#0000ff">if</font> (useEmulator) </li><li>  WP7Device = WP7SDK.GetDevices (). Single (d =&gt; d.Name == <font color="#A31515">"Windows Phone 7 Emulator"</font> ); </li><li>  <font color="#0000ff">else</font> </li><li>  WP7Device = WP7SDK.GetDevices (). Single (d =&gt; d.Name == <font color="#A31515">"Windows Phone 7 Device"</font> ); </li><li></li><li>  <font color="#008000">// Connect to WP7 Emulator / Device</font> </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Connecting to Windows Phone 7 Emulator / Device ..."</font> ); </li><li>  WP7Device.Connect (); </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Windows Phone 7 Emulator / Device Connected ..."</font> ); </li><li></li><li></li><li>  <font color="#2B91AF">Guid</font> appID = <font color="#0000ff">new</font> <font color="#2B91AF">Guid</font> ( <font color="#A31515">"{5e75bba1-fbf6-463c-94ac-fa4a78f8fd12}"</font> ); </li><li>  RemoteApplication app; </li><li>  <font color="#0000ff">if</font> (WP7Device.IsApplicationInstalled (appID)) </li><li>  { </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Uninstalling sample XAP to Windows Phone 7 Emulator / Device ..."</font> ); </li><li></li><li>  app = WP7Device.GetApplication (appID); </li><li>  app.Uninstall (); </li><li></li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Sample XAP Uninstalled from Windows Phone 7 Emulator / Device ..."</font> ); </li><li>  } </li><li></li><li>  <font color="#008000">// Install XAP</font> </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Installing sample XAP to Windows Phone 7 Emulator / Device ..."</font> ); </li><li></li><li>  app = WP7Device.InstallApplication ( </li><li>  appID, </li><li>  appID, </li><li>  <font color="#A31515">"NormalApp"</font> , </li><li>  <font color="#A31515">@ "D: \ visual studio 2010 \ Projects \ ConsoleApplication1 \ WindowsPhoneApplication1 \ ApplicationIcon.png"</font> , </li><li>  <font color="#A31515">@ "D: \ visual studio 2010 \ Projects \ ConsoleApplication1 \ WindowsPhoneApplication1 \ Bin \ Debug \ WindowsPhoneApplication1.xap"</font> ); </li><li></li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Sample XAP installed to Windows Phone 7 Emulator ..."</font> ); </li><li></li><li>  <font color="#008000">// Launch Application</font> </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Launching sample app on Windows Phone 7 Emulator ..."</font> ); </li><li>  app.Launch (); </li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Launched sample app on Windows Phone 7 Emulator ..."</font> ); </li><li></li><li>  <font color="#2B91AF">Console</font> .WriteLine ( <font color="#A31515">"Reading Foo.txt Isolated Storage file:"</font> ); </li><li></li><li>  Thread.Sleep (10,000); </li><li>  <font color="#008000">//app.GetIsolatedStore ();</font>  <font color="#008000">&lt;- Throws NotImplementedException</font> </li><li>  <font color="#0000ff">object</font> ConManServer = WP7Device.GetType (). GetField ( <font color="#A31515">"mConmanServer"</font> , BindingFlags.NonPublic | BindingFlags.Instance) .GetValue (WP7Device); </li><li>  FileDeployer f = (FileDeployer) <font color="#0000ff">typeof</font> (FileDeployer) .GetConstructors (BindingFlags. Instance | BindingFlags. NonPublic) [0] .Invoke ( <font color="#0000ff">new</font> <font color="#0000ff">object</font> [] {ConManServer}); </li><li>  f.ReceiveFile ( <font color="#A31515">@ "\ Applications \ Data \" + appID + @ "</font> \ data \ isolatedstore \ Foo.txt <font color="#A31515">", @ "</font> \ Foo.txt <font color="#A31515">");</font>  Console.WriteLine ("\ t <font color="#A31515">" + File.ReadAllText (@ "</font> foo.txt")); </li><li></li><li>  <font color="#2B91AF">Console</font> .ReadLine (); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><h4>  the end </h4><br>  In this post, we talked about why the automation of the deployment process on the emulator / WP7 device is needed and how to achieve this. <br>  I hope that now you know how to automate the deployment of XAP in WP7. <br>  In the next article in this series we will talk about configuring continuous integration for WP7. </div><p>Source: <a href="https://habr.com/ru/post/117294/">https://habr.com/ru/post/117294/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../117283/index.html">Try Gnome 3 on Ubuntu 11.04 Natty Narwhal</a></li>
<li><a href="../117284/index.html">Online tests to determine the level of knowledge of Desktop Linux</a></li>
<li><a href="../117285/index.html">Do you already use C ++ 0x features in C ++ projects?</a></li>
<li><a href="../117287/index.html">Challenger for the theory of everything - E8 geometry</a></li>
<li><a href="../117289/index.html">Live broadcast course on linear programming</a></li>
<li><a href="../117297/index.html">Facebook can create a social network for China</a></li>
<li><a href="../117298/index.html">Star Troop: the story of one project</a></li>
<li><a href="../117300/index.html">Sony and GeoHot settled the conflict</a></li>
<li><a href="../117301/index.html">Opera 11.10 - spring release</a></li>
<li><a href="../117302/index.html">Home and personal robots available in Russia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>