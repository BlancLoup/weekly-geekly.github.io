<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple sweet apps with Kivy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After the unsuccessful attempt of the first version of the article, when the material was zaminusovali due to the monstrous design of the example prog...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple sweet apps with Kivy</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/b79/a3c/c29/b79a3cc297aa48dab11048324eacd374.jpg" align="left"><br><p>  After the unsuccessful attempt of the first version of the article, when the material was zaminusovali due to the monstrous design of the example program shown in the article (the article had to be deleted), I took into account all the disadvantages and cite a later version of the test application. </p><br><p>  It may be news for you, but developing mobile applications with functionality that is available to Java developers for Android using the Kivy framework is not just easy, but very easy!  I follow this rule when creating my own projects with Python + Kivy - development should be as simple and fast as possible.  Like a snap of your fingers. </p><br><p>  The information provided to newbies is not calculated, I will not explain on the fingers of what, from where and where.  I think those who read this article have sufficient knowledge to understand the material.  In addition, Kivy, as I have just written, is a very simple framework and all the documentation with examples of use is in the source! </p><a name="habracut"></a><br><p>  In the <a href="https://habrahabr.ru/post/300960/">last article</a> , several screens of the Clean Master application in the implementation on Kivy were reviewed.  Today I will show you one of the draft drafts of the application I work on in my spare time. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d7f/bef/134/d7fbef134e1c4c17b2bb3fceba531b44.png"></div><br><p>  They say that Kivy is suitable only for kneaded crafts and a serious application to do with it will not work.  I hasten to please you (or disappoint) - so say those who do not know how to cook this fruit (Kivy). </p><br><p>  And we are able and we will need: coffee-cigarettes, a terrarium with a third Python, or a bird, or a fruit ‚Äî Kivy and a bit of brains.  The presence of the latter is welcome!  Go to github and download the <a href="https://github.com/HeaTTheatR/CreatorKivyProject">Wizard to create a new project for the Kivy + Python3 framework</a> (yes, I completely refused to use Python2, which I advise you).  Unpack, go to the folder with the master and run: </p><br><pre><code class="python hljs">python3 main.py name_project path_to_project -repo repo_project_on_github</code> </pre> <br><p>  if the project has a repository on github. </p><br><p>  Or </p><br><pre> <code class="python hljs">python3 main.py name_project path_to_project</code> </pre> <br><p>  if the repository is not github not available. </p><br><p>  In this case, after creating, open the project file main.py and edit the function of sending the report bug manually. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9dc/9a4/2e8/9dc9a42e8e354886900c8f708ec4d110.png"></div><br><p>  So, as a result, we get a default Kivy project with the following directory structure: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8fb/c0e/806/8fbc0e806f294a82a86005dcb2859475.png"></div><br><p>  Separately, consider the Libs directory: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/09d/934/a4a/09d934a4ae3d4ce29901003642eaa528.png"></div><br><p>  The rest of the project directories do not need comments.  The created project will have two screens - the main and settings screen: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f77/8da/262/f778da2622f54fbc8edb2b147287a0b2.png"></div><br><p>  All we need is to use our main screen, that is, replace the startscreen.py file in the Libs / uix directory, create a new startcreen.kv screen layout file in the Libs / uix / kv folder, edit the base class program.py, well, and add new imports and related classes, if any. </p><br><p>  Let's start with the custom buttons that are used in our main screen: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5df/44e/2d1/5df44e2d12ce46949edb7e13773446bd.png"></div><br><p>  Yes, in Kivy itself there are not many standard elements for building interface design that are in Java, but Kivy allows you to design and animate absolutely any widget that you need yourself.  It all depends on the boundaries of your imagination. </p><br><p>  Create a custombutton.py file in the Libs / uix directory and define the class of our button in it: </p><br><div class="spoiler">  <b class="spoiler_title">custombutton.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.boxlayout <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BoxLayout <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.button <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.lang <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Builder <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.properties <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StringProperty, ObjectProperty, ListProperty <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> . imagebutton <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ImageButton root = os.path.split(__file__)[<span class="hljs-number"><span class="hljs-number">0</span></span>] Builder.load_file(<span class="hljs-string"><span class="hljs-string">'{}/kv/custombutton.kv'</span></span>.format( root <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> root != <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> os.getcwd()) ) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomButton</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BoxLayout, Button)</span></span></span><span class="hljs-class">:</span></span> icon = StringProperty(<span class="hljs-string"><span class="hljs-string">''</span></span>) icon_map = StringProperty(<span class="hljs-string"><span class="hljs-string">''</span></span>) icon_people = StringProperty(<span class="hljs-string"><span class="hljs-string">''</span></span>) text = StringProperty(<span class="hljs-string"><span class="hljs-string">''</span></span>) button_color = ListProperty([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">.2</span></span>]) text_color = ListProperty([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">.1</span></span>]) events_callback = ObjectProperty(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>)</code> </pre> </div></div><br><p>  The layout of the button in the directory Libs / uix / kv is the file custombutton.kv: </p><br><div class="spoiler">  <b class="spoiler_title">custombutton.kv</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#:kivy 1.9.1 &lt;CustomButton&gt;: id: root.text padding: 5 size_hint_y: None height: 60 on_release: root.events_callback(root.text) canvas: #   Color: rgba: root.button_color Rectangle: pos: self.x + 2.5, self.y - 3 size: self.size #   Color: rgba: [1, 1, 1, 1] Rectangle: pos: self.pos size: self.size Image: source: root.icon size_hint: .2, 1 Label: markup: True text: root.text text_size: self.width - 70, None color: root.text_color BoxLayout: orientation: 'vertical' size_hint: .1, 1 spacing: 6 ImageButton: source: root.icon_people on_release: root.events_callback({'people': root.text}) ImageButton: source: root.icon_map on_release: root.events_callback({'map': root.text})</span></span></code> </pre> </div></div><br><p>  Custom button for the location screen: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3a9/74e/ac4/3a974eac4f2e477cade782453b689f17.png"></div><br><div class="spoiler">  <b class="spoiler_title">custommenu.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.boxlayout <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BoxLayout <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.lang <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Builder <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.properties <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ListProperty, StringProperty, ObjectProperty root = os.path.split(__file__)[<span class="hljs-number"><span class="hljs-number">0</span></span>] Builder.load_file(<span class="hljs-string"><span class="hljs-string">'{}/kv/custommenu.kv'</span></span>.format( root <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> root != <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> os.getcwd()) ) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomMenuItem</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BoxLayout)</span></span></span><span class="hljs-class">:</span></span> background_item = ListProperty([<span class="hljs-number"><span class="hljs-number">.1</span></span>, <span class="hljs-number"><span class="hljs-number">.1</span></span>, <span class="hljs-number"><span class="hljs-number">.1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) text_color = ListProperty([<span class="hljs-number"><span class="hljs-number">.1</span></span>, <span class="hljs-number"><span class="hljs-number">.1</span></span>, <span class="hljs-number"><span class="hljs-number">.1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) icon_item = StringProperty(<span class="hljs-string"><span class="hljs-string">''</span></span>) text_item = StringProperty(<span class="hljs-string"><span class="hljs-string">''</span></span>) id_item = StringProperty(<span class="hljs-string"><span class="hljs-string">''</span></span>) events_callback = ObjectProperty(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>)</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">custommenu.kv</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#:kivy 1.9.1 #:import ImageButton Libs.uix.imagebutton.ImageButton &lt;CustomMenuItem&gt;: orientation: 'vertical' canvas: Color: rgba: root.background_item Rectangle: pos: self.pos size: self.size ImageButton: source: root.icon_item on_release: root.events_callback(root.id_item.split('.')[0]) Label: text: root.text_item color: root.text_color font_size: '19sp'</span></span></code> </pre> </div></div><br><p>  We will also use the ImageButton class ‚Äî the image button ‚Äî for banners.  Since the class is related to UI, I put the imagebutton.py file in the Libs / uix directory: </p><br><div class="spoiler">  <b class="spoiler_title">imagebutton.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.image <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.behaviors <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ButtonBehavior <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageButton</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ButtonBehavior, Image)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre> </div></div><br><p>  Next, we need a class to change the advertising banners on the main screen of the program.  For this test application example, posters with advertising banners are placed in the local project folder.  Create a show_banners.py file in the Libs / programclass application class directory: </p><br><div class="spoiler">  <b class="spoiler_title">show_banners.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.boxlayout <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BoxLayout <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Libs.uix.imagebutton <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ImageButton <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ShowBanners</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">'''       .'''</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.banner_list = os.listdir( <span class="hljs-string"><span class="hljs-string">'{}/Data/Images/banners'</span></span>.format(self.directory) ) <span class="hljs-comment"><span class="hljs-comment">#    . self.directions = ('up', 'down', 'left', 'right') def show_banners(self, interval): if self.screen.ids.screen_manager.current == '': name_banner = self.choice(self.banner_list) box_banner = BoxLayout() new_banner = ImageButton( id=name_banner.split('.')[0], source='Data/Images/banners/{}'.format(name_banner), on_release=self.press_banner ) box_banner.add_widget(new_banner) name_screen = name_banner banner = self.Screen(name=name_screen) banner.add_widget(box_banner) self.screen.ids.banner_manager.add_widget(banner) effect = self.choice(self.effects_transition) direction = self.choice(self.directions) if effect != self.SwapTransition: self.screen.ids.banner_manager.transition = effect( direction=direction ) else: self.screen.ids.banner_manager.transition = effect() self.screen.ids.banner_manager.current = name_screen self.screen.ids.banner_manager.screens.pop() def press_banner(self, instance_banner): if isinstance(instance_banner, str): print(instance_banner) else: print(instance_banner.id)</span></span></code> </pre> </div></div><br><p>  This class simply changes the banner screens by setting them in the banner_manager screen manager: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/296/099/283/29609928395641a69445f5db638267b9.png"></div><br><p>  Do not forget to add the import of the created class to the class library programclass in the initialization file: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a12/592/289/a12592289aa44f3eb85c207cc6052eb9.png"></div><br><p>  We import a set of shaders for billboard animations in the base program.py file: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fec/344/b57/fec344b5720f4bf28c3b1a1faad690f9.png"></div><br><p>  The implementation of the main screen of the application: </p><br><div class="spoiler">  <b class="spoiler_title">startscreen.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.boxlayout <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BoxLayout <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.lang <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Builder <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.properties <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ObjectProperty, ListProperty, StringProperty <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Libs.uix.custombutton <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CustomButton root = os.path.split(__file__)[<span class="hljs-number"><span class="hljs-number">0</span></span>] root = root <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> root != <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> os.getcwd() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StartScreen</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BoxLayout)</span></span></span><span class="hljs-class">:</span></span> events_callback = ObjectProperty(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) <span class="hljs-string"><span class="hljs-string">'''   .'''</span></span> core = ObjectProperty(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) <span class="hljs-string"><span class="hljs-string">'''module 'Libs.programdata' '''</span></span> color_action_bar = ListProperty( [<span class="hljs-number"><span class="hljs-number">0.4</span></span>, <span class="hljs-number"><span class="hljs-number">0.11764705882352941</span></span>, <span class="hljs-number"><span class="hljs-number">0.2901960784313726</span></span>, <span class="hljs-number"><span class="hljs-number">0.5607843137254902</span></span>] ) <span class="hljs-string"><span class="hljs-string">''' ActionBar.'''</span></span> color_body_program = ListProperty( [<span class="hljs-number"><span class="hljs-number">0.15294117647058825</span></span>, <span class="hljs-number"><span class="hljs-number">0.0392156862745098</span></span>, <span class="hljs-number"><span class="hljs-number">0.11764705882352941</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] ) <span class="hljs-string"><span class="hljs-string">'''   .'''</span></span> color_tabbed_panel = ListProperty( [<span class="hljs-number"><span class="hljs-number">0.15294117647058825</span></span>, <span class="hljs-number"><span class="hljs-number">0.0392156862745098</span></span>, <span class="hljs-number"><span class="hljs-number">0.11764705882352941</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] ) <span class="hljs-string"><span class="hljs-string">'''  tabbed panel.'''</span></span> title_previous = StringProperty(<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-string"><span class="hljs-string">''' ActionBar.'''</span></span> tabbed_text = StringProperty(<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-string"><span class="hljs-string">'''   tabbed panel.'''</span></span> Builder.load_file(<span class="hljs-string"><span class="hljs-string">'{}/kv/startscreen.kv'</span></span>.format(root)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, **kvargs)</span></span></span><span class="hljs-function">:</span></span> super(StartScreen, self).__init__(**kvargs) self.ids.custom_tabbed.bind(on_ref_press=self.events_callback) <span class="hljs-comment"><span class="hljs-comment"># C . for name_shop in self.core.dict_shops.keys(): self.ids.shops_list.add_widget( CustomButton( text=self.core.dict_shops[name_shop], icon='Data/Images/shops/{}.png'.format(name_shop), icon_people='Data/Images/people.png', icon_map='Data/Images/mapmarker.png', events_callback=self.events_callback, ) )</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">startscreen.kv</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#: kivy 1.9.1 #: import StiffScrollEffect Libs.uix.garden.stiffscroll.StiffScrollEffect &lt;StartScreen&gt; orientation: 'vertical' canvas: Color: rgb: root.color_body_program Rectangle: pos: self.pos size: self.size ActionBar: id: action_bar canvas: Color: rgb: root.color_action_bar Rectangle: pos: self.pos size: self.size ActionView: id: action_view ActionPrevious: id: action_previous app_icon: 'Data/Images/logo.png' title: root.title_previous with_previous: False on_release: root.events_callback('navigation_drawer') ActionButton: icon: 'Data/Images/trash_empty.png' ActionButton: icon: 'Data/Images/search.png' Label: id: custom_tabbed text: root.tabbed_text bold: True markup: True size_hint: 1, .35 text_size: self.width - 40, None canvas.before: Color: rgb: root.color_tabbed_panel Rectangle: pos: self.pos size: self.size ScreenManager: id: screen_manager size_hint: 1, 8 Screen: ScreenManager: id: banner_manager size_hint: 1, .38 pos_hint: {'top': 1} ScrollView: effect_cls: StiffScrollEffect size_hint_y: None height: root.height // 1.8 pos_hint: {'top': .62} GridLayout: id: shops_list cols: 1 spacing: 5 padding: 5 size_hint_y: None height: self.minimum_height</span></span></code> </pre> </div></div><br><p>  As you can see, I do not use TabbedPanel, because I consider its standard implementation in Android not to be very beautiful.  It has been replaced by Label + ref: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d66/156/6b9/d661566b92a94455a0cd11d95646a9a9.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bfa/82e/eca/bfa82eeca8b74bb8833be15dec86af3b.png"></div><br><p>  Base Program Class: </p><br><div class="spoiler">  <b class="spoiler_title">program.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> choice <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.screenmanager <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Screen, SlideTransition, SwapTransition <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.core.window <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Window <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ConfigParser <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Clock <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.utils <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> get_hex_from_color, get_color_from_hex <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.properties <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ObjectProperty, NumericProperty <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Libs.uix.kdialog <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KDialog, BDialog, Dialog <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Libs.uix.startscreen <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StartScreen <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Libs.uix.custommenu <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CustomMenuItem <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Libs.uix.navigationmenu <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> NavigationMenu <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Libs.uix.garden.navigationdrawer <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> NavigationDrawer <span class="hljs-comment"><span class="hljs-comment">#  . from Libs import programclass as prog_class from Libs import programdata as core from Libs.manifest import Manifest #    . Dialog.background_image_buttons = core.image_buttons Dialog.background_image_shadows = core.image_shadows Dialog.background = core.decorator class Program(App, prog_class.ShowPlugin, prog_class.ShowBanners, prog_class.SearchShop, prog_class.ShowLicense, prog_class.ShowLocations): ''' .''' start_screen = ObjectProperty(None) ''':attr:`start_screen` is a :class:`~Libs.uix.startscreen.StartScreen`''' screen = ObjectProperty(None) ''':attr:`screen` is a :class:`~Libs.uix.startscreen.StartScreen`''' window_text_size = NumericProperty(15) def __init__(self, **kvargs): super(Program, self).__init__(**kvargs) Window.bind(on_keyboard=self.events_program) #     programclass. self.Screen = Screen self.Clock = Clock self.CustomMenuItem = CustomMenuItem self.KDialog = KDialog self.BDialog = BDialog self.Manifest = Manifest self.SwapTransition = SwapTransition self.choice = choice self.get_color_from_hex = get_color_from_hex self.get_hex_from_color = get_hex_from_color self.core = core self.name_program = core.string_lang_title self.navigation_drawer = NavigationDrawer(side_panel_width=230) self.current_open_tab = core.string_lang_tabbed_menu_shops self.shop = False #   self.open_dialog = False #    self.effects_transition = (SlideTransition, SwapTransition) #  . self.shops = core.dict_shops.keys() #  . self.locations = [ location.split('.')[0].lower() for location in os.listdir( '{}/Data/Images/locations'.format(core.prog_path))] def build_config(self, config): config.adddefaultsection('General') config.setdefault('General', 'language', '') config.setdefault('General', 'theme', 'default') def build(self): self.title = self.name_program #    self.icon = 'Data/Images/logo.png' #    self.use_kivy_settings = False self.config = ConfigParser() self.config.read('{}/program.ini'.format(core.prog_path)) self.set_var_from_file_settings() #   . self.start_screen = StartScreen( color_action_bar=core.color_action_bar, color_body_program=core.color_body_program, color_tabbed_panel=core.color_tabbed_panel, tabbed_text=core.string_lang_tabbed_menu.format( TEXT_SHOPS=core.string_lang_tabbed_menu_shops, TEXT_LOCATIONS=core.string_lang_tabbed_menu_locations, COLOR_TEXT_SHOPS=get_hex_from_color(core.color_action_bar), COLOR_TEXT_LOCATIONS=core.theme_text_color), title_previous=self.name_program[1:], events_callback=self.events_program, core=core ) self.screen = self.start_screen navigation_panel = NavigationMenu( events_callback=self.events_program, items=core.dict_navigation_items ) Clock.schedule_interval(self.show_banners, 4) self.navigation_drawer.add_widget(navigation_panel) self.navigation_drawer.anim_type = 'slide_above_anim' self.navigation_drawer.add_widget(self.start_screen) return self.navigation_drawer def set_var_from_file_settings(self): '''      program.ini.''' self.language = core.select_locale[ self.config.get('General', 'language') ] def set_current_item_tabbed_panel(self, color_current_tab, color_tab): self.screen.ids.custom_tabbed.text = \ core.string_lang_tabbed_menu.format( TEXT_SHOPS=core.string_lang_tabbed_menu_shops, TEXT_LOCATIONS=core.string_lang_tabbed_menu_locations, COLOR_TEXT_SHOPS=color_tab, COLOR_TEXT_LOCATIONS=color_current_tab ) def events_program(self, *args): '''  .''' if self.navigation_drawer.state == 'open': self.navigation_drawer.anim_to_state('closed') if len(args) == 2: #   event = args[1] else: #    try: _args = args[0] event = _args if isinstance(_args, str) else _args.id except AttributeError: #    event = args[1] if core.PY2: if isinstance(event, unicode): event = event.encode('utf-8') if event == core.string_lang_settings: pass elif event == core.string_lang_exit_key: self.exit_program() elif event == core.string_lang_license: self.show_license() elif event == core.string_lang_plugin: self.show_plugins() elif event in self.locations: print(event) elif event == 'search_shop': self.search_shop() elif event == 'navigation_drawer': self.navigation_drawer.toggle_state() elif event == core.string_lang_tabbed_menu_locations: self.show_locations() elif event == core.string_lang_tabbed_menu_shops: self.back_screen(event) elif event == 'obi_banner': self.press_banner(event) elif event in (1001, 27): self.back_screen(event) elif event in self.shops: print(event) return True def back_screen(self, event): ''' .''' #  BackKey   . if self.screen.ids.screen_manager.current == '': if event in (1001, 27): self.exit_program() return if len(self.screen.ids.screen_manager.screens) != 1: self.screen.ids.screen_manager.screens.pop() self.screen.ids.screen_manager.current = \ self.screen.ids.screen_manager.screen_names[-1] #    . #self.screen.ids.action_previous.title = self.screen.ids.screen_manager.current #     item_tabbed_panel. self.set_current_item_tabbed_panel( core.theme_text_color, get_hex_from_color(core.color_action_bar) ) def exit_program(self, *args): def dismiss(*args): self.open_dialog = False def answer_callback(answer): if answer == core.string_lang_yes: sys.exit(0) dismiss() if not self.open_dialog: KDialog(answer_callback=answer_callback, on_dismiss=dismiss, separator_color=core.separator_color, title_color=get_color_from_hex(core.theme_text_black_color), title=self.name_program).show( text=core.string_lang_exit.format(core.theme_text_black_color), text_button_ok=core.string_lang_yes, text_button_no=core.string_lang_no, param='query', auto_dismiss=True ) self.open_dialog = True def on_pause(self): '''   ''    .      ''' return True def on_resume(self): print('on_resume') def on_stop(self): print('on_stop')</span></span></code> </pre> </div></div><br><p>  Leaving the localization file Data / Language / russian.txt, packaging of graphic resources, the color scheme of the application in the Data / Themes / default / default.ini file, data creation in programdata.py, menu Navigation Drawer, all this simple trivia, we run a test example: </p><br><pre> <code class="python hljs">python3 main.py</code> </pre> <br><p>  ... and get this picture: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d73/c0d/74e/d73c0d74ebe94114929a804646a4f7c6.gif"></div><br><p>  Due to the poor quality of gif-ki, the animation of the screens is poorly viewed, but it is not so important.  Those who will test the example <a href="https://github.com/HeaTTheatR/Easy">from the</a> project <a href="https://github.com/HeaTTheatR/Easy">sources</a> on the devices will immediately highlight the shortcomings: I have not yet implemented an algorithm according to which the size of advertising banners will be adjusted to all screen resolutions without distorting the proportions;  also, due to the inability to test the application, although the emulator could not find the optimal font size in the program, there is no animation of the buttons, the library for working with the kdialog dialog boxes is lame because it is still under development. </p><br><p>  But in spite of all this, I think this article will be useful for those who also, like me, love and use such a wonderful framework as Kivy! </p><br></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/306300/">https://habr.com/ru/post/306300/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../306290/index.html">Bitcoin business in Panama (interview)</a></li>
<li><a href="../306292/index.html">We write HabraKvest on ASP.NET Core and Angular2</a></li>
<li><a href="../306294/index.html">Trolleybus from a loaf or alias analysis in LLVM</a></li>
<li><a href="../306296/index.html">The digest of interesting materials for Mobile Developer # 163 (July 18-24)</a></li>
<li><a href="../306298/index.html">Telegram writes in the syslog messages inserted from the clipboard, including in secret chats</a></li>
<li><a href="../306304/index.html">Reflective Metaprogramming on Go: loop for each by means of the reflect package</a></li>
<li><a href="../306306/index.html">The digest of fresh materials from the world of the frontend for the last two weeks ‚Ññ220 (July 11 - 24, 2016)</a></li>
<li><a href="../306308/index.html">Cambium ePMP 2000. Solving the problem of interference at base stations</a></li>
<li><a href="../306310/index.html">Object-Global Mapping or "ORM for globals." Direct Access with the Cach√© Globals Proxy Framework</a></li>
<li><a href="../306312/index.html">After logging on a VK user, you can get control of his page.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>