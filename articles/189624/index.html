<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>First impressions: Windows Server 2012 R2 Hyper-V in all its glory</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The preliminary releases of Hyper-V 2012 R2 and System Center Virtual Machine Manager 2012 R2 are a worthy continuation of previous versions. 

 Hyper...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>First impressions: Windows Server 2012 R2 Hyper-V in all its glory</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/3cc/89b/3e5/3cc89b3e5db35894022b1bddf6c0dce0.png" alt="image"><br><h5>  The preliminary releases of Hyper-V 2012 R2 and System Center Virtual Machine Manager 2012 R2 are a worthy continuation of previous versions. </h5><br><br>  Hyper-V 3.0 was probably one of the most brilliant features of Windows Server 2012. But a lot of new features, plus the refinement of existing ones, promise to make Windows Server 2012 R2 an even more suitable candidate for the virtualization of many tasks that many organizations need.  In addition, Windows Server 2012 R2 introduces new features aimed at integrating with cloud services and building hybrid clouds. <br><a name="habracut"></a><br>  For large environments, Microsoft's System Center Virtual Machine Manager (SCVMM) will be an excellent tool for managing this infrastructure, since managing multiple virtual machines through Hyper-V Manager is an inconvenient and unscalable approach.  However, it is worth mentioning that SCVMM 2012 R2 currently does not support all the features of Hyper-V Manager in Windows Server 2012 R2, for example, exporting a running VM.  Let's see if the situation will change with the release of the final version of SCVMM 2012 R2. <br><br>  At least in terms of terminology, everything has become a bit more transparent.  In the world of Hyper-V, the term "snapshot" meant a snapshot of the system at a specific point in time, which could later be used if necessary to roll back the changes made.  SCVMM used the term ‚Äúcheckpoint‚Äù for the same functionality.  Although this process is still called a ‚Äúsnapshot‚Äù for Hyper-V Manager in Windows Server 2012, it is called a ‚Äúcheckpoint‚Äù in Hyper-V Manager R2. The only remaining exception is the PowerShell Export-VMSnapshot cmdlet.  You will also find Checkpoint-VM cmdlet taking a snapshot of the specified VM. <br>  In short, checkpoint is the same as the snapshot in previous releases. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Some chips fall into the ‚Äúnew‚Äù category for Hyper-V 2012 R2.  We will look at each one separately, focusing on how each can help make things easier or faster. <br><br>  <b>Second generation virtual machines</b> <br>  The underlying virtualization technology is software emulation of underlying physical hardware.  For the most part, this physical equipment is old and rusty.  Microsoft sees this as a problem, especially when it comes to supporting UEFI or secure boot technology.  Concern about security is an excellent motivational factor, therefore, having goals to reduce the attack surface, Microsoft took the chance to create a new set of emulated equipment with a minimum number of components.  In this release, new machines of the second generation only support loading 64-bit versions of Windows 8, Windows 8.1 Preview, Windows Server 2012, and Windows Server 2012 R2 Preview as guest OSs. <br><br><img src="https://www.infoworld.com/sites/infoworld.com/files/media/image/hyperv-r2-gen2.jpg" alt="image"><br>  <i>Second-generation virtual machines provide faster installation and booting of the OS, but only Windows 8 and Windows Server 2012 are supported.</i> <br><br>  Second-generation virtual machines can boot from SCSI virtual disks, from SCSI DVDs, or even over a network.  These new virtual devices give a significant increase in the OS boot time, and you can change the size of the VHDX disk attached to the SCSI controller, even if the VM is running.  Previously, boot volumes could not be resized on the go. <br><br>  <b>Automatic licensing</b> <br>  In previous versions of Hyper-V, every time you created a new virtual machine, you needed to license it independently of the host machine.  With Windows Server 2012 Datacenter R2, this is no longer a problem.  Each new virtual machine running Windows Server 2012 R2 will be automatically activated.  This type of license is called Automatic Virtual Machine Activation (AVMA) for Datacenter Server.  Guest VMs must be running Windows Server 2012 R2 Datacenter, Standard or Essentials in order to use the AVMA key.  As a result, a faster process of setting up a virtual machine and no need to connect to the Internet or KMS server for activation. <br><br>  <b>PowerShell 4.0</b> <br>  The latest version of PowerShell includes a significant number of new km-models supporting Hyper-V.  In addition, the default script execution policy is set to ‚ÄúRemoteSigned‚Äù.  Previous versions had the ‚ÄúRestricted‚Äù policy installed, which did not allow execution of scripts until manual change of this setting.  This change, albeit small, will save some time and nerves for new administrators.  Here are the new issues related to Hyper-V: <br><br>  <u>Measure-VM.</u>  This cmdlet collects statistics on VM resources for your further research.  It is important to note that statistics collection is not enabled by default.  To enable it, on all machines, use the following command in the console with administrative rights: <br><br>  <i>Get-vm |</i>  <i>Enable-VMResourceMetering</i> <br><br>  This will give you the statistics you need, including AggregatedAverageNormalizedIOPS to assess the overall performance of the disk subsystem. <br><br>  <u>Copy-VMFile.</u>  This new cmdlet allows the administrator to copy files inside the VM without using a network connection.  You need to enable the Guest Services option in the Integration Services tab in the VM properties.  However, this option can also be enabled by means of PowerShell itself: <br><br>  <i>Enable-VMIntegrationService</i> <br><br>  <b>Export VM on the go</b> <br>  With Hyper-V R2, you can export the running virtual machine or export the snapshot of this VM. <br>  This is done via Hyper-V Manager or using Export-VM and Export-VMSnapshot cmdlets.  Requires a hypervisor based on Windows Server 2012 R2, since this feature is not supported by previous versions. <br><br>  <b>Shared virtual disks</b> <br>  Clustering usually required special physical equipment.  The very same clustering is used to ensure high availability of the resource.  Hyper-V in Windows Server 2012 R2 includes support for shared virtual disks (VHDX), which blink to be located either on the SMB 3.0 Scale-Out file server, or on the Cluster Shared Volume (CSV), in order to ensure the fault tolerance of the storage system itself . <br>  This chip removes the need for expensive SAN equipment, so now you can build a wax-accessible solution using virtual machines and a convenient way to store data.  It is worth mentioning that you cannot use Storage QoS for shared virtual disks. <br><br><img src="https://www.infoworld.com/sites/infoworld.com/files/media/image/hyperv-r2-powershell.jpg" alt="image"><br>  <i>The new Measure-VM cmdlet in PowerShell 4.0 collects various types of statistics related to your virtual machine.</i> <br><br>  <b>Resize a virtual disk on the go</b> <br>  VHDX drives attached to the SCSI controller can be increased or decreased in size, even if the VM is running.  To do this, you can use the Virtual Hard Disk Wizard, which is included in the Hyper-V Manager or Resize-VirtualDisk cmdlet for PowerShell.  Resizing a disk on the go works for second-generation virtual machines by default.  In order for this to work for the first generation VMs, you need to add a new SCSI controller for this VM.  The fact is that by default, the first-generation virtual machines use an IDE controller. <br><br>  <b>Storage QoS</b> <br>  Hyper-V R2 adds the ability to configure the minimum and maximum IOPS allowed for a specific VM.  The minimum value does not work completely in this preview release, but it seems to me as a way to provide the minimum IO level for the VM.  The importance of this chip becomes apparent when several VMs are running to you for input-output operations on a single host.  I note that Storage QoS works only with virtual disks attached to a SCSI controller. <br><br>  <b>Improvements in Remote Desktop</b> <br>  Previous versions of Hyper-V required a configured and functioning network in order to connect to the VM from any other machine, except from the Hyper-V server itself.  This is no longer a necessity for Hyper-V R2, which supports RDP connection to any virtual machine through the ‚ÄúVM bus‚Äù.  This means that you can connect to the virtual machine before you have assigned an IP address for it.  In addition, the new Enhanced Session Mode supports access to audio devices, the keyboard clipboard, disks, smart cards, supported plug-and-play devices, and USB devices on a remote system.  This functionality is still limited and works only for Windows 8.1 Preview and Windows Server 2012 R2 Preview as guest systems. <br><br>  <b>SCVMM 2012 R2</b> <br>  It is very easy to feel confused if you have never worked with Microsoft's System Center before.  Many settings have appeared, some of which must be made before or in combination with the others.  You will have to learn new cloud terminology and understand concepts such as ‚Äúfabric‚Äù and ‚Äútenants‚Äù.  If you are serious about trying SCVMM 2012 R2, you will need a very powerful lab to set up, according to <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D39284">Microsoft instructions</a> .  In particular, Microsoft recommends six physical servers, each of which has 24 processor cores and 128GB of RAM.  You will also need at least two physical switches to separate the network traffic. <br><br>  One of the key features that Microsoft has promised in all R2 releases is tight integration with the cloud.  You can already see this aspiration in many areas, including the network, service templates, and even Windows PowerShell.  We will talk about this from the point of view of administrators and IT managers. <br><br>  <u>Network</u> <br>  Large corporations and service providers faced severe limitations in Windows Server 2012 Hyper-V related to the work of several tenants on the same host.  This restriction required a single physical network interface for each unique gateway.  This approach significantly reduced the possibilities for launching a large number of VMs on a single host.  In Windows Server 2012 R2 Hyper-V, this restriction is removed because support for multi-user virtual gateways has appeared. <br><br>  SCVMM 2012 R2 is now able to manage the entire data center network by enabling additional sites using site-to-site VPN.  This feature becomes especially useful if you think about potential problems like IP address conflicts and multiple domains.  Plus integration with IPAM (IP Address Manager) adds additional convenience in terms of working with multiple pools of IP addresses. <br><br><img src="https://www.infoworld.com/sites/infoworld.com/files/media/image/scvmm-r2-gen2.jpg" alt="image"><br>  <i>System Center Virtual Machine Manager 2012 R2 recognizes new second-generation virtual machines, but does not allow them to migrate to a host running Windows Server 2012</i> <br><br>  Network virtualization was originally introduced with the release of Windows Server 2012. Logical networks are the foundation behind which other approaches to network virtualization lie.  When you first run SCVMM, you must configure a logical network to which all other virtual networks can connect.  By default, SCVMM will create a new logical network in which all devices are connected and visible.  SCVMM 2012 R2 also supports the creation of independent networks based on VLAN, as well as networks based on Private VLAN (PVLAN). <br><br>  On top of all this is the new NVGRE (Network Virtualization using Generic Routing Encapsulation) gateway for site-to-site communications.  NVGRE is a relatively new standard (currently in draft status), specifically designed for cloud environments.  The basic principle is to encapsulate Layer 2 packets for transmission on top of a Layer 3 network.  At level 2, signals and interaction with the physical layer (MAC address) pass.  NVGRE makes it possible for two devices to communicate on different Layer 3 networks (IP address) as if they are on the same Layer 2 subnet. <br><br>  <u>Service Templates</u> <br>  SCVMM used the concept of service templates for a relatively long time, but in SCVMM 2012 R2 there really is a benefit from them.  When you need to constantly create the same type of service, be it a network gateway or a resource for storing data, you will want to use service templates.  Microsoft at TechEd 2013 in New Orleans showed an intention to make System Center components as service templates in the future.  Representatives of the company also demonstrated new scripting capabilities to automate the creation of guest clusters with VMM service templates.  On the network side, you can use service templates to automate the deployment of edge gateways and the full range of network services. <br><br>  <b>Linux support</b> <br>  Microsoft has traditionally provided purely symbolic support for running various Linux distributions inside Hyper-V, but this situation has begun to change.  <a href="http://www.infoworld.com/d/cloud-computing/review-windows-azure-shoots-the-moon-209491">Windows Azure</a> has become a pioneer in providing access to various Linux-based applications, and now System Center is following its steps.  SCVMM 2012 R2 supports the creation and deployment of virtual machines based on CentOS, Red Hat, Suse, and Ubuntu.  Moreover, these virtual machines can be monitored by System Center Operations Manager.  Some of the distributions, such as Red Hat Enterprise Linux 5.9 and Ubuntu Server 12.04 LTS, have Microsoft's Linux Integration Services for Hyper-V preinstalled. <br><br>  <b>What is not working yet</b> <br>  SCVMM 2012 R2 does not support the management of Storage Spaces for Scale-Out File Servers based on Windows Server 2012, leaving you alone with Server Manager or PowerShell.  Migration Physical to Virtual (P2V) was removed from SCVMM 2012 R2, so you will have to look for another way to convert existing physical machines into virtual ones if you need to.  You cannot manage new Windows Server 2012 R2 features - storage tiering and write-back cache directly through VMM.  But you can still do this through PowerShell, and in theory, you can use scripts to automate through VMM if you need to. <br><br><img src="https://www.infoworld.com/sites/infoworld.com/files/media/image/scvmm-r2-detection.jpg" alt="image"><br>  <i>When you add a new host, System Center Virtual Machine Manager 2012 R2 will check for hardware support for chips such as Multipath I / O and warn you if they are not included.</i> <br><br>  You cannot migrate live from a Windows Server 2012 R2 host to a host with any earlier version of Hyper-V.  The reverse direction is supported, that is, migration from Windows Server 2012 to Windows Server 2012 R2. <br>  For live migration to work, both host systems must have the same logical network.  This means that you must use the same approach for naming virtual networks on these hosts.  This is another great reason to use SCVMM to manage everything and everyone ‚Äî including your networks. <br><br>  SCVMM 2012 R2 does not support the creation of VMs using differencing disks.  To create these machines will need to use Hyper-V Manager or PowerShell. <br><br>  The list of chips in Windows Server 2012 Hyper-V R2 fills a lot of empty spaces in the original release.  While this is just a preview, so bugs are inevitable.  However, I can testify that this is an amazingly stable release, based on several weeks of intense testing.  In the past, one could always expect a couple of ‚Äúblue screens‚Äù in preliminary releases, but for now this is not the case.  New chips seem to work as stated on par with refined ones.  Many companies often wait for the first major update of the main OS, before they begin serious testing.  Windows Server 2012 R2 and Hyper-V R2 fall under the term ‚Äúmajor update‚Äù pretty well. <br><br>  SCVMM 2012 R2 received a few incremental updates, but nothing mind-blowing.  However, for large environments and for companies planning to use the new Hyper-V networking features, it seems more than useful. <br><br><h6>  <i>Paul Ferrill has been writing about computers and networks for more than 25 years.</i>  <i>He has articles published on InfoWorld, Network World, PC Magazine, as well as a number of other publications.</i>  <i>He is the author of two books and is currently working on a third one.</i>  <i>You can contact him (writing a letter in English) at paul@ferrill.net.</i> </h6></div><p>Source: <a href="https://habr.com/ru/post/189624/">https://habr.com/ru/post/189624/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../189610/index.html">The phrase "perezalil on habrastorage" loses its meaning</a></li>
<li><a href="../189612/index.html">Like spawns like: what affects the rating on the Internet</a></li>
<li><a href="../189614/index.html">mySQLgame 2.0</a></li>
<li><a href="../189616/index.html">Another way to control the fan in Linux (for example, Acer S3-391)</a></li>
<li><a href="../189618/index.html">Representation of numbers by the sum of two squares and elliptic curves</a></li>
<li><a href="../189626/index.html">Expert evaluation methods</a></li>
<li><a href="../189628/index.html">Nokia HERE LivingCities</a></li>
<li><a href="../189630/index.html">Development methodology on 1C-Bitrix - the experience of a fool</a></li>
<li><a href="../189634/index.html">LSI Nytro MegaRAID NMR8100-4i in action</a></li>
<li><a href="../189644/index.html">The presumption of guilt on the Internet. When you need to prove that you are not a camel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>