<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>From version database migration to database change management</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Thanks to people who do not hesitate to share their thoughts and experiences, even negative ones, on many important issues of organizing work with dat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>From version database migration to database change management</h1><div class="post__text post__text-html js-mediator-article">  Thanks to people who do not hesitate to share their thoughts and experiences, even negative ones, on many important issues of organizing work with database systems.  I came across the article ‚Äú <a href="http://habrahabr.ru/post/124627/">Version migration of the database structure: why it is better not to do this,</a> ‚Äù I thought about commenting on it, but, having considered the publication date, I decided to write my own.  It is obvious that the author had his own idea of ‚Äã‚Äãthe meaning and meaning of the words he pronounced in the title.  And an inaccurate representation led to the fact that a completely different task was being solved.  On Habr√©, quite a long time ago, articles appeared on the organization of version-based migration of databases.  They are easily detected by keyword searches.  Here in this article: <a href="http://habrahabr.ru/post/121265/">VERSION MIGRATION OF DATABASE STRUCTURE: BASIC APPROACHES</a> provides an excellent introduction to the terminology, tasks and basic techniques for solving them. <br>  I would like to tell by example about those unexpected problems that, without an invitation, suddenly arose before our group on one of my old works, and about what we lacked then, for a quick and effective resolution of the situation - in general, also a negative experience - Suddenly, someone will come in handy now or in the future.  Despite the fact that in our company we are more broadly approaching the solution of such problems, combining them under the term ‚ÄúManaging changes in the database‚Äù, I will try to stay in the field of terminology from the article above. <br><img src="https://habrastorage.org/getpro/habr/post_images/da4/c32/0f2/da4c320f2e0d2fda8a570f9c7b6aae27.jpg"><br><h5>  EXPERIENCE OF THE PAST YEARS - ABOUT UNSOLVED PROBLEMS </h5><br>  In 1997, the development team, where I had just entered, was given the task within 3 months to create a software package that implements an automated technology that was supposed to form the basis of the business activity of the entire company.  The matter is long-standing and, with your permission, I will not delve into the details and details of technology and business processes.  It is important that it was necessary to process and interconnect the daily received data supplied in significant volumes from two independent external sources, accumulate them in the repository, with minimal delays, give answers to arbitrary requests from our customers - managers within the company, fulfill the forecast of many indicators based on retrospective analysis of the accumulated volumes of information.  This task was accomplished, a typical internal corporate system was created, which has been working from that time to the present day, successfully changing and refining it throughout this period. <br><a name="habracut"></a><br>  The first signs of a problem appeared when the management of the IT department ordered the transfer of a copy of this system to a data center of one of the customers.  At the same time, the term, as usual, was ‚Äúyesterday‚Äù.  Since the source of information was the same as ours, the data streams from the same supplier did not have to significantly change the technology, ETL remained almost the same, the list of requests was narrowed, the set of reports was slightly modified and limited.  Nevertheless, the technical base on which all this was supposed to work was already different: instead of Oracle, there was a DBMS MS SQL Server.  But, the base structure itself has not changed, even the data types did not require complex conversion. <br><br>  Now our support has become two close in design and functionality, but different in the implementation of the system versions.  Soon the fairy tale affects, after a while we received in support of about 30 more identical systems for work in branches throughout the country.  Deploy of new versions was carried out by copying a new version from the center.  From the point of view of version migration, this was one standard version, even the configuration parameters of all servers should have been the same, the self-activity of local administrators was not simply discouraged, but prohibited, and violations of this ban should be monitored daily.  It was also necessary to have control over the state and contents of directories - the basis for further ‚Äúinformation‚Äù from the branch databases to the central one - and the contents should be guaranteed the same for all local databases. <br><br>  Well, the last stage, as many have already guessed, was the emergence of another 4-5 separate options for the operation of the company's branches abroad.  Moreover, each country has its own supplier of source data, some data elements are missing, some of the necessary information is ‚Äúscattered‚Äù in the supplied sets, some indicators are calculated according to other rules.  This means that each variant is fundamentally different in the ETL part, and this applies not only to the applications and procedures, but also to the so-called data structures.  Stage Database (a working database for performing ETL transformations without interference from the main one). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Thus, having developed a system for purely domestic use, after a short time, without any plans planned for the future, we found ourselves acting in the role of owners of a large zoo of exotic versions.  And I guess not only us. <br><br>  No matter how general and brief this story is, some characteristic features related to database migration can be extracted from it. <br><br><ol><li>  Simultaneous support of a large number of different versions of the application - an objective reality, independent of the desires of developers or users </li><li>  Migration is required not only when transferring the database to another server or DBMS platform, but also when synchronizing the database with the existing version (version, generation) of the application software </li><li>  The difference in versions is connected not only with differences in processing logic and database structures, but also in various DBMS platforms, as well as in special settings for the existing hardware. </li><li>  It requires not only the management of the migration process, but also the control of the immutability of the schemes, data and settings, audit (reporting) on ‚Äã‚Äãthe composition of the elements that have been changed, by whom and by what values </li><li>  Changes in database structure during migration often entail additional processing / conversion of stored shared data. </li></ol><br>  Probably, it was easier for us, since the tasks "piled on" gradually.  Yes, and the team was stable, with clearly distributed functions of each employee, both in vertical activities and private tasks.  However, every time changes were made to the application software, it was still planned or spontaneous, we had to transfer all to the new version of the application.  And the version of the working database should correspond to this updated version, you need to perform versioned migration of schemes, data, settings. <br><br>  In varying degrees, suitable solutions exist and are quite common.  It is important to come to the most convenient and less time-consuming method.  I am talking about negative experiences, because now I would have chosen a different technology, and very much regret its absence at that time. <br><br>  It would seem, what is easier to have common scripts to modify all servers and automatically execute them on each server! <br><br>  The first problem was that in different places the versions of the application programs to which it was necessary to switch were different!  A single modification script could not exist, it was necessary to spend a lot of time studying the current state, writing and testing scripts for each server separately.  Testing is a separate issue, because first you had to create a test bench. <br><br>  Supporting the change log that was made on a separate server during the life of the old version of the application did not bring relief, because if there were several such changes, the synchronization scripts must be executed strictly in the "correct" sequence, and, in some cases, repeated execution of one script is absolutely unacceptable - the result will be irreversible. <br><br>  Now multiply the time spent on the number of different servers! <br><br>  The reverse problem: the local admin decided to ‚Äúimprove‚Äù the database on his own or, for example, due to the lack of disk space, ‚Äúdemolished‚Äù a large index and ‚Äúforgot‚Äù to restore it after transferring the database files to another medium.  We could detect such changes in the settings and structure fairly easily, but we need to have this particular version of the database in the initial state in order to compare.  And if changes in the scheme could be detected and corrected quickly enough, changes in the server configuration parameters or in the actual data were detected with great effort and for a much longer period.  And then carry out all the technology to create correction scripts and their implementation.  And at the same time to investigate who and at what point made these changes. <br><br>  If there were available tools that automatically supported the approach to the database structure as to the source code, like all the usual source control systems in various programming languages, the following tasks would be much easier: <br><br><ul><li>  Updating a database from a specific version to any other one in one step, both later and returning to the previous one; </li><li>  Easy receipt of migration scripts in automatic mode, with the possibility of "manual" corrections in a pinch; </li><li>  Creating from scratch a new instance of the database corresponding to the existing version of the application; </li><li>  Simple creation of test / developer database instances based on current working databases for developing on them that best fit these workers. </li><li>  Control and audit of undesirable changes in database instances, if necessary, automatic return to the reference state in a short time. </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/609/32a/903/60932a903f93eb5702bc5b1d74f61faa.jpg" alt="image"><br>  This is what was missing in the story being described.  This approach is not very effective to use without using any instrumental solutions, but then we did not have enough time or resources to develop our own full-fledged utility.  Meshala and policy management IT-department.  Nevertheless, today there are ready-made products that implement this approach, each with its own set of features and functions.  I plan to talk about one of the possible solutions in the next post. <br><br>  There are many different ways and solutions to store and manage changes in the database.  It is important to find the most appropriate approach and apply a tool that will help you increase the degree of automation of database versioning migration, improve the quality and reliability of your work, save resources and time of your employees.  In this article, I tried with a life example to tell where the problems of managing changes in the database come from, what difficulties this entails, and what conclusion I came to on the basis of this, by and large, negative experience. </div><p>Source: <a href="https://habr.com/ru/post/204504/">https://habr.com/ru/post/204504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../204488/index.html">Extract 3D models in O2C format from dat file</a></li>
<li><a href="../204490/index.html">Domain servers.com sold at auction for $ 300,000</a></li>
<li><a href="../204494/index.html">GameDev as a hobby</a></li>
<li><a href="../204496/index.html">TeamCity as a Debian repository</a></li>
<li><a href="../204500/index.html">An example of solving a credit scoring problem using a python + pandas + scikit-learn bundle</a></li>
<li><a href="../204506/index.html">kidomi: building DOM objects on the fly</a></li>
<li><a href="../204508/index.html">Optimal DDoS protection with netstat and iptables</a></li>
<li><a href="../204510/index.html">How we did the API for the social network (REST API for WEB)</a></li>
<li><a href="../204512/index.html">Introduction to Windows 8.1 Upgrade</a></li>
<li><a href="../204514/index.html">We program under Pebble. Lesson two: Pebble giving answers, dice and sex cubes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>