<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Entertaining math in Hearthstone</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I am a fan of the popular computer card game Hearthstone, developed by Blizzard Entertainment. Once I asked myself a question: ‚ÄúIs it possible, based ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Entertaining math in Hearthstone</h1><div class="post__text post__text-html js-mediator-article">  I am a fan of the popular computer card game Hearthstone, developed by Blizzard Entertainment.  Once I asked myself a question: ‚ÄúIs it possible, based only on the rules describing the dynamics of a player‚Äôs transition between levels when a player loses / wins, to get statistics on the distribution of players by the level they reached?‚Äù <br><br><img src="https://habrastorage.org/files/411/420/91b/41142091be894fbba4ad1c603ecc8b49.jpg" alt="image"><br><br>  Despite the fact that the network has a huge number of sites and wiki dedicated to Hearthstone, superficial search did not give any results.  It was a pity for the deep search, so I solved the problem ‚Äúon the knee‚Äù.  I suppose this decision can be a topic for classes in a school math circle. <br><a name="habracut"></a><br><h2>  Task Description </h2><br>  In the Hearthstone ranking tournament there are 25 levels and a special Legend level.  Levels consist of sublevels - the so-called.  "Stars", and at different levels the number of sublevels is different: <br><ul><li>  Levels 25 through 21 consist of 2 sublevels; </li><li>  Levels 20 through 16 consist of 3 sublevels; </li><li>  Levels 15 through 11 consist of 4 sublevels; </li><li>  Levels 10 through 1 consist of 5 sublevels; </li><li>  There are no sublevels on Legend. </li></ul><br>  Thus, the level ruler in the rating (hereinafter referred to as the ruler) consists of 96 sublevels (including the ‚ÄúLegend‚Äù): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/287/fa3/0c3/287fa30c39fa429d8543045ec9361d46.png"><br>  <i>Picture 1</i> <br><br>  The new player starts in the ranking from the 25th level.  For winning a game, a player gets a ‚Äústar‚Äù (sometimes two), i.e.  Increases its sublevel by 1 (or 2, respectively). <br><br>  There are 4 ranges on the ruler, in which the rules for changing the player‚Äôs level when winning / losing a game are different: <br><br>  Table 1 <br><table><tbody><tr><th>  Code name </th><th>  Level range </th><th>  Rules for changing the sublevel when winning / losing </th></tr><tr><td>  "Springboard" </td><td>  25-21 </td><td>  Defeat: sublevel does not change <br>  Victory: +1 <br>  3 (and more) victories in a row: +2 </td></tr><tr><td>  "Race with acceleration" </td><td>  20-6 </td><td>  Damage: -1 <br>  Victory: +1 <br>  3 (and more) victories in a row: +2 </td></tr><tr><td>  "Normal race" </td><td>  5-1 </td><td>  Damage: -1 <br>  Victory: +1 </td></tr><tr><td>  "Legend" </td><td>  Legend </td><td>  Defeat: sublevel does not change <br>  Victory: the sublayer does not change </td></tr></tbody></table><br>  Obviously, ‚ÄúSpringboard‚Äù serves to involve new players, since there is only a reward on the ‚Äúspringboard‚Äù, but there is no punishment for defeat.  In addition, it is clear that the population of the "springboard" exponentially quickly "dies out", since the rules inevitably push the player from the "springboard" into the range of "Race with acceleration".  The probability of remaining on the ‚Äúspringboard‚Äù after 18 games is ~ 29%, and after 27 games - less than 1.5%. <br><br>  "Race with acceleration" helps players with high skill and good decks to quickly get to the "Normal Race", where the real "ruble" begins.  And finally, the Legend is a pin for top players. <br><br>  I wanted to find 2 dependencies: <br><ol><li>  Calculate the probability of a player getting a certain level after a certain number of games played; </li><li>  Calculate the distribution of all players by level depending on time. </li></ol><br><h2>  Choosing a solution method and tool </h2><br>  The first thought was to write a JS program that simulates a multitude of players whose levels change as a result of the interaction according to the above rules.  After a brief reflection on the size of the required JS code, I decided that spreadsheets are excellent for this task. <br><br>  The solution is as follows: <br><br>  Let some rectangular range with the size of 96 * 1 (for example, the Source! $ C $ 3: $ C $ 98 range in the attached files) represent the distribution of the number of players in the line.  Then, using the rules from table 1, it is easy to obtain a distribution describing the state after each player has played one game.  The rules in Table 1 are located in the Source! $ D3: $ D $ 98 range.  If you ‚Äúpush‚Äù these rules to the required number of columns, the resulting table will represent the change in the distribution of players in levels with ‚Äútime‚Äù.  Time in this case is in quotes because here it is measured in ‚Äúgames played‚Äù. <br><br>  I started with Open Office Calc, which is good for everyone, but the 3-D graphics out of the box look poor in it (maybe I just don‚Äôt know how to prepare them).  As a result, the solution is implemented in MS Excel and lies <a href="https://www.dropbox.com/sh/4gu4hmaw52ydq72/AACsGRE6RyhypkwJnctEIGnqa%3Fdl%3D0">here</a> .  The option for Open Office Calc in the same place is quite functional, except for the absence of 3-D graphs and the lack of interactivity in 2-D graphs. <br><br><h2>  The probability of a player getting a certain level </h2><br><img src="https://habrastorage.org/files/d75/5f0/1f8/d755f01f8e3c4a148e60e6185ff003e7.png"><br>  <i>Figure 2</i> <br><br>  The given charts describe the probability of getting this or that level for a player who started from level 25 and played 50, 130, 300, 450 or 570 games respectively.  In Excel, the graph is interactive - you can play around with the numbers to the left of the diagram on the Interface tab, and the graphs (Figure 2) will change. <br><br>  In the 3-D evolution of the probability of obtaining a certain level looks very nice: <br><br><img src="https://habrastorage.org/files/ab2/1b7/887/ab21b7887dbd4b7ba9e086e96f6055b2.png"><br>  <i>Figure 3</i> <br><br>  Here is a slice with the same minimum and maximum "temporary" boundaries (50 and 570 games), as in Figure 2. <br>  The same graph from another angle: <br><br><img src="https://habrastorage.org/files/59a/6ff/110/59a6ff1104604a74bcf734d9349f609b.png"><br>  <i>Figure 4</i> <br><br>  The appearance of the ‚Äúedge‚Äù on the graphs at the point corresponding to the level 5 and 2 of the ‚Äústar‚Äù looks somewhat unexpected (72nd sublevel in order).  This point is the last, which is affected by the possibility of ‚Äúaccelerating‚Äù after 3+ victories in a row. <br><br>  If you look at the rules for 71 - 72 sublevels, then they look like this: <br>  71 = 1/8 * C69 + C70 * 3/8 + 0.5 * C72 <br>  72 = 1/8 * C70 + C71 * 1/2 + 0.5 * C73 <br>  Here CNN is the number of players at the NN sublevel in the previous step: <br>  - the first member provides ‚Äúaccelerated transfer‚Äù from the ‚Äúcurrent -2‚Äù level; <br>  - the second member provides the usual transition when winning at the ‚Äúcurrent -1‚Äù level; <br>  - the third member provides a transition from the upper level with the defeat. <br><br>  The difference in 1/8 in the coefficient for the second term is due to the fact that, starting from the 5th level (it is the 71st ordinal sublevel), regardless of the number of victories in a row, the sublevel increases only by 1, i.e.  even if the victory on the 71st sublevel was for the 3rd player, he will go only to the 72nd sublevel. <br><br>  This small, at first glance, additive leads to the fact that the ‚Äúflow of players‚Äù to the 72nd sublevel is slightly above average, respectively, the flow of players from the 72nd sublevel to its neighborhood, i.e.  the effect of increasing the flow of players to the 72nd sublevel is self-reinforcing, which leads to the appearance of this remarkable edge. <br><br><h2>  Calculate the distribution of all players by level </h2><br>  Obviously, players differ in the number of games they play in the same time.  More enthusiastic players play more, casual less. <br><br>  To calculate the model distribution of players by levels, it is necessary to know the distribution function of players by the number of games played by them. <br><br>  We introduce the notation: <br><ul><li>  P (L, i)) - the probability of a player getting a certain level (L) after a specified number of games (i) (graphs are shown in Figures 2-4) </li><li>  N - the maximum number of games played by the most enthusiastic player.  Note that N plays the role of time here.  Of course, this is not the usual time.  However, between the usual time t and N there is the following relationship: <img src="https://habrastorage.org/files/903/c3d/608/903c3d6088254ee6bf3bb1479dc3a885.png">  therefore, N as a ‚Äútime‚Äù is quite suitable. </li><li>  Z (i, N) is the probability that a player has played i games by the time ‚Äútime‚Äù N or the distribution of players by the number of games played in ‚Äútime‚Äù N. </li><li>  D (L, N) - the desired probability of finding a player at level L, at the time of "time" N or the distribution of players in levels at the time of "time" N. </li></ul><br>  Then <img src="https://habrastorage.org/files/e71/d52/57c/e71d5257c09e46849ffa2e0bb6a26b40.png"><br><br>  At once I will say that I have no data on the function Z (i, N).  But you can speculate on this topic. <br><br>  The only thing that occurred to me was: ‚Äú20% of people drink 80% of beer‚Äù.  Perhaps "20% of Hearthstone players play 80% of the games"?  That is, the hypothesis is that the distribution of players by the number of games played is a discrete Pareto distribution, or, more precisely, a Zipf distribution (see <a href="https://en.wikipedia.org/wiki/Zipf%2527s_law">en.wikipedia.org/wiki/Zipf%27s_law</a> ). <br><br>  We introduce the notation: <br><ol><li>  Auxiliary function <br><img src="https://habrastorage.org/files/14c/0d7/f38/14c0d7f38bdf4890ba1f069fb555c51b.png"></li><li>  Normalization factor (for the moment of "time" N) <br><img src="https://habrastorage.org/files/36f/c7c/bff/36fc7cbff3c842b1a8ab24a661858b20.png"></li></ol><br>  Then the Zipf distribution with power exponent s: <br><img src="https://habrastorage.org/files/d09/a18/bda/d09a18bda63a4d588c5e9e879f2811b5.png"><br>  Let's look at the graphs of the desired function D (L, N) under the assumption that the distribution of players by the number of games played is a Zipf distribution with exponent 1. <br><br>  Here and in the following graph, D (L, N) is displayed at times of ‚Äútime‚Äù N from 50 to 700. <br><br><img src="https://habrastorage.org/files/295/6ab/acd/2956abacd32a4a5a9a1c0041bcdbec4d.png"><br>  <i>Figure 5</i> <br><br><img src="https://habrastorage.org/files/281/29a/c58/28129ac5872448ddb0eec9240a64a885.png"><br>  <i>Figure 6</i> <br><br>  It looks rather ugly, although it is understandable why - a significant part of the players, in accordance with the Zipf distribution, remained on the ‚Äúspringboard‚Äù.  Well, to speculate - so in full.  We construct a modified Zipf-Mandelbrot distribution (see <a href="https://en.wikipedia.org/wiki/Zipf%25E2%2580%2593Mandelbrot_law">en.wikipedia.org/wiki/Zipf%E2%80%93Mandelbrot_law</a> ). <br><br>  1. Replace the auxiliary function <br><br><img src="https://habrastorage.org/files/07c/9f6/bde/07c9f6bdefd041a78d9ee7066eddd47c.png"><br><br>  The idea of ‚Äã‚Äãintroducing the Startshift integer parameter is as follows: the beginning of the ‚Äúaction‚Äù of the standard behavior of the Zipf distribution is shifted by the Startshift steps. <br><br>  Indeed, it seems implausible that a player who has undergone all the difficulties of learning and who has just entered the rating games, is more likely to stop playing after one or two rating games.  It can be assumed that the beginning of the ‚Äúaction‚Äù of the Zipf distribution roughly coincides with the onset of difficulties in advancing in the rating, i.e.  with the moment when the probability of leaving the "springboard" exceeds ¬Ω (this means that startshift = 18).  In addition, the definition of the auxiliary function implies that the total number of players who ‚Äúaccidentally entered Hearthstone‚Äù (i.e. played ‚â§ Startshift games) coincides with the number of players at the maximum distribution.  All this, of course, pure speculation, but why not see what happens? <br><br>  The Mandelbrot parameter q is entered without any justification, just in case. <br><br>  2. The normalization factor (for the moment of "time" N) <br><br><img src="https://habrastorage.org/files/1f5/2c5/47b/1f52c547bbae45ac864be0e9ad60c5be.png"><br><br>  Then a modified distribution with a power exponent s, the Mandelbrot parameter q and the Startshift "start shift" parameter: <br><br><img src="https://habrastorage.org/files/ef4/6c7/d18/ef46c7d1856a4a42aec90c4f96f6bc40.png"><br><br>  Let's see what happens with the parameters shown at the bottom of the chart: <br><br><img src="https://habrastorage.org/files/878/df7/bea/878df7bea2da4681924af7a03c5e28fc.png"><br>  <i>Figure 7</i> <br><br>  For manual experiments, the graph in Excel is made interactive - you can play around with the distribution parameters and the displayed ‚Äútimes‚Äù to the left of the diagram on the Interface tab, and the graphs (Figure 7 and Figure 8) will change. <br><br><img src="https://habrastorage.org/files/482/d0a/bd6/482d0abd69534eee935f3b0e6f23cfd2.png"><br>  <i>Figure 8</i> <br><br>  And finally, the last spurt for today.  Let's try to choose distribution parameters using ‚Äúreal‚Äù data (http://www.reddit.com/r/hearthstone/comments/23ed7l/how_good_are_you_at_constructed_ladder/).  These are the results of some kind of simulation, the details of which are unknown to me, it is unclear, in particular, at what point in the ‚Äútime‚Äù N the measurement was taken, etc.  This is the only thing I found.  But I did not really try to look.  Hopefully, readers of the article will prompt a source of more relevant data. <br><br>  Iterative processing of data by the solver add-in and manual adjustment gave the following values ‚Äã‚Äãof the distribution parameters: s = 1.19;  q = 0,287;  Startshift = 110.  Startshift is expectedly large, since there is no information about population levels 25-21 in the initial simulation data, i.e.  "Springboard", obviously, was not simulated. <br><br>  Final pictures: <br><br><img src="https://habrastorage.org/files/abd/ca8/88a/abdca888a1e74aa5b50c3ed35a6bf4c5.png"><br>  <i>Figure 9</i> <br><br><img src="https://habrastorage.org/files/af8/ee5/d70/af8ee5d70886415b93414173c4166527.png"><br>  <i>Figure 10</i> <br><br><h2>  Conclusion </h2><br>  In conclusion, I repeat that the task that I began to solve out of pure curiosity seemed to me a good topic for studying in a school math group.  I consider it important for future engineers and scientists to be able to use all available tools at hand for solving sudden problems, such as paper and pencil, spreadsheets, and the WOLFRAM MATHEMATICA package.  I hope this example of applying a spreadsheet will be useful to someone. <br><br>  If desired, the teacher can build bridges from this task to a variety of topics. <br><br>  Offhand: <br><ol><li>  Theorver - Pareto distribution - Zeta function - John Derbyshire.  Prime Obsession: Bernhard Riemann and the Greatest Unsolved Problem in Mathematics </li><li>  Numerical methods for solving partial differential derivatives.  (by the way - a task for advanced students: show that P (L, i) in the ‚ÄúNormal Race‚Äù range approximates some particular solution of the equation <img src="https://habrastorage.org/files/13e/58f/2b1/13e58f2b1d9e433185182659281f3435.png">  in the appropriate scale, and in the ‚ÄúRace with Acceleration‚Äù range - the equations <img src="https://habrastorage.org/files/ff5/943/575/ff5943575ec54cf8bc1186468f7c7f4a.png"></li><li>  Selection of the type of residual function optimal for the problem. </li></ol><br>  You can also come up with some extensions to this task.  For example, such: <br><br>  1) When the season ends, players who have reached certain levels in the last season get some odds.  For example, at the end of a season at level 4, a player gets 21 "stars", i.e.  starts in the new season not from level 25, but from level 17. ** - it‚Äôs the 21st ordinal level (see Figure 1).  I am sure that the corresponding figures describing the dependence of the size of the odds on the achieved level can be easily found on the network. <br><br>  Questions: <br><ol><li>  How will P (L, i) and D (L, N) change when taking into account the odds at the start of the season? </li><li>  Does a series of functions D (L, N, season number) match anything with a season number tending to ‚àû?  If so, what restrictions does this impose on Z (i, N)? </li><li>  Is Z (i, N) enough for a correct answer to the 2nd question? </li></ol><br>  2) Come up with some clear theory to calculate the function Z (i, N). </div><p>Source: <a href="https://habr.com/ru/post/252713/">https://habr.com/ru/post/252713/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../252699/index.html">Protection against cheating in online games</a></li>
<li><a href="../252703/index.html">Recognition of the RF Passport on a mobile phone. (UPD: 03/28/2015 + posted the program on the App Store)</a></li>
<li><a href="../252705/index.html">NoScript is now for Android</a></li>
<li><a href="../252707/index.html">Weekly build Vivaldi 1.0.124.2</a></li>
<li><a href="../252711/index.html">Microsoft incorrectly fixed the vulnerability that the Stuxnet worm used</a></li>
<li><a href="../252715/index.html">Zoo communication protocols for GPS trackers (part 1)</a></li>
<li><a href="../252717/index.html">HP Hyper-Converged Virtualization Platforms</a></li>
<li><a href="../252719/index.html">High performance and hosting infrastructure: 1cloud project experience</a></li>
<li><a href="../252721/index.html">The practice of semantic markup</a></li>
<li><a href="../252725/index.html">Censor links by Skype</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>