<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Compliance with standards and policies in vulnerability scanners and SIEM</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The term compliance in English means compliance to one of the high-level standards (such as SOX, PCI DSS, Basel II, GLBA). It is necessary to check fo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Compliance with standards and policies in vulnerability scanners and SIEM</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/pt/blog/171083/"><img src="https://habrastorage.org/storage2/ec1/2eb/9b4/ec12eb9b4f0ed57f256acb4305050174.jpg" align="left"></a>  The term compliance in English means compliance to one of the high-level standards (such as SOX, PCI DSS, Basel II, GLBA).  It is necessary to check for compliance with these documents in order to determine how well your organization complies with the requirements described by these standards (the allowed length of passwords, the presence of internal regulations and policies, the time taken to eliminate vulnerabilities, etc.). <br><br>  In addition to international standards, there are their domestic counterparts, corporate policies and NIST requirements. It is also necessary to conduct an assessment of compliance with these documents.  Standards contain sets of requirements: meeting all the requirements of the standard actually means compliance with it.  An example of a separate requirement: ‚ÄúThere must be a disciplinary process for employees who have made a breach of protection‚Äù (ISO / IEC 2005 A.8.2.3). <a name="habracut"></a><br><br>  Conducting a compliance check is necessary not only for reporting: the more requirements are met, the higher the level of security and the lower the risks of financial loss in case of threats.  Obviously, it is necessary to ensure compliance with the standards continuously and continuously - otherwise, during the next audit, you will have to spend a lot of energy and nerves to make hasty changes in configurations and infrastructure in accordance with the requirements. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  How to conduct a compliance check </h4><br>  In the course of ISO 27001 auditors, I had the opportunity to meet the employees of the information security department of one organization who, when checking compliance, used the standard 27001, but assessed compliance and calculated risks in an Excel table.  The spectacle is not for the faint of heart, I confess to you. <br><br>  Of course, you can check the compliance with similar images by writing out the requirements of the standard on a sheet of paper or in Excel.  You can use special software in which employees responsible for certain aspects of security will answer typical questions: ‚ÄúYes, no, I don't know.‚Äù  But how reliable will the information received be?  Are you sure that the domain administrator really set the minimum password length to 7 characters?  Are you really sure that this administrator did not make a fake screenshot, and then did not return the group policy settings to the state that he (!) Considers necessary?  Some of the requirements can only be verified with the help of a survey of employees, but the fulfillment of the remaining requirements can be checked with automated means. <br><br><h4>  Types of requirements </h4><br>  Requirements are divided into technical and non-technical.  The technical requirements include the information that can be checked using automation tools (by running the command in the console, using the configuration file parser, using the registry parameter). <br><br>  Let me give you a simple example of a technical requirement mentioned in most standards: PCI DSS 8.5.10 ‚ÄúRequirements 5.1.  ‚ÄúDeployed anti-virus software (particularly personal computers and servers)‚Äù. <br><br>  Non-technical requirements, respectively, check using automation will not work.  An example of such a requirement is the above-mentioned ISO / IEC 2005 A.8.2.3. <br><br>  No standard can be fully described using technical requirements alone.  In the absence of automation, we can all consider them non-technical.  It becomes possible to automatically check the requirement - it becomes technical.  The more such requirements we can analyze (check their fulfillment in the system), the more quickly we can reduce the risks by eliminating the inconsistencies. <br><br>  It is necessary to immediately clarify that the compliance verification process is generally divided into compliance (without the standard prefix; this means compliance with high-level standards by default), regulatory compliance (requirements of supervisory authorities, for example, STO BR IBBS) and policy compliance (compliance with policies, whether corporate policy or NIST).  All of these terms in this article will be understood as ‚Äúchecking for compliance with standards (policies)‚Äù. <br><br><h4>  From standards to policies </h4><br>  What to do if you do not need any standards, but you want to monitor compliance with information security policies? <br><br>  The concept of "compliance check" is applicable not only for high-level standards (ISO, NIST guidelines, SOX, Basel II) and NIST guidelines, but also for internal company policies.  Many corporate policy requirements are made up of standards.  This means that it is possible to distinguish technical requirements from the standards described in your corporate IS policy, integrate them into a policy and track it already. <br><br>  Another question is how to automate the process of receiving and processing requirements to assess compliance with the standard?  The answer is simple: with such automation tools as vulnerability scanners, systems of the CMS class (compliance management system), SIEM or, in extreme cases, self-written scripts. <br><br><h4>  How it works? </h4><br>  For CMS and vulnerability scanners in the task for scanning compliance with a specific standard, the IP addresses of the organization's information systems are determined.  Then the system is scanned to determine compliance with the requirements of the selected standard (as a rule, the scanner obtains all the available data), after which an assessment is made as to whether all the technical requirements of this standard are fulfilled on the selected assets. <br><br><img src="https://habrastorage.org/storage2/43c/9ab/884/43c9ab884b80d8b7ad60e442d21e38f2.png"><br><br>  As a rule, the system has a list of available standard templates with a predefined set of requirements that can be selected for conformity assessment.  If something is missing, you can purchase a license for the missing standards from the scanner manufacturer or develop your own. <br><br><h4>  Develop your own standard </h4><br>  In vulnerability scanners with the function of checking compliance with standards, it is possible to create your own standard from scratch or based on an existing one.  In the creation process, you can override the values ‚Äã‚Äãthat are checked within the requirements or add your own. <br><br>  Adding your own requirements is possible thanks to flexible verification mechanisms.  In each system, the requirements consist of one or more checks.  As a rule, these checks are implemented using several scenarios with different methods and transports (WMI, RPC, etc.).  With McAfee VM, for example, some of the scripts stored in the database look like Figure  below. <br><br><img src="https://habrastorage.org/storage2/244/05b/451/24405b45120ee205f74ad93e899acad0.png"><br><br>  However, we do not need to dig into the database and generally know what script it is checking.  Software vendors typically provide a graphical interface for handling requirements.  In our new standard or policy, we can include almost any technical requirements and redefine the values ‚Äã‚Äãof their parameters. <br><br><img src="https://habrastorage.org/storage2/9c3/7fc/912/9c37fc9120b198c99458d07407961da5.png"><br><br>  If there is no such interface, then at least documentation should be available for creating your own standard (for example, in XML format).  A little effort - and a unique standard that reflects the requirements for information security in a particular organization, is ready. <br><br><h4>  SIEM </h4><br>  Now let's talk about SIEM.  Some concepts related to such systems, we discussed earlier in our blog: <br><br>  1) What is SIEM <a href="http://blog.ptsecurity.ru/2012/10/siem.html">http://blog.ptsecurity.ru/2012/10/siem.html</a> <br>  2) What is the integration of SIEM and the vulnerability scanner <a href="http://blog.ptsecurity.ru/2012/10/siem_1.html">http://blog.ptsecurity.ru/2012/10/siem_1.html</a> <br>  3) What are signature correlation methods <a href="http://blog.ptsecurity.ru/2012/10/siem_17.html">http://blog.ptsecurity.ru/2012/10/siem_17.html</a> <br>  4) How to manage IS incidents <a href="http://blog.ptsecurity.ru/2012/11/blog-post.html">http://blog.ptsecurity.ru/2012/11/blog-post.html</a> <br><br>  Now let's ask ourselves why, in principle, compliance checking is needed in SIEM.  What does this process mean in SIEM?  And why not use only vulnerability scanners and compliance management systems for such verification? <br><br>  First, the standards have requirements for logging part of the events associated with accounts, access to objects, changing group policies, etc. Monitoring these requirements is also necessary, since it is possible to check whether these types of events are received in our SIEM . <br><br>  Secondly, unlike various scanners, SIEM systems continuously receive information that can be used to dynamically assess conformity in real time.  How quickly will you learn about disabling anti-virus protection on your server or changing the domain policy?  In such situations, the launch of a scanner, as a rule, loads the network and information systems, since the process of checking compliance with a standard (for example, PCI DSS) often entails scanning for vulnerabilities (and this is a huge load that can ‚Äúdrop‚Äù your production system). <br><br>  SIEM in this case acts as a passive source of data on compliance with a particular standard, received in real time: the problem of journal management is eliminated.  At the same time, we have the opportunity, on the basis of incoming data on various events, to determine what exactly leads to a mismatch.  Further, compliance with a specific requirement of the selected standard is checked, and if a discrepancy is found, a notification is sent to the administrator of the information system. <br><br>  In addition, if <a href="http://blog.ptsecurity.ru/2012/11/blog-post.html">incident management is</a> carried out in the system, then the responsible officer will also be given the task of eliminating the inconsistencies. <br><br>  Sounds nice, doesn't it?  Now back to our SIEM-systems and see how they, in fact, assess the compliance with a particular standard. <br><br>  High-level standards involve the collection and storage of information about certain events (listed in the table). <br><br><img src="https://habrastorage.org/storage2/17f/a86/cc5/17fa86cc53a5817459e58c8d9b3130ae.png"><br><br>  Taking into account individual standards, the following picture is obtained. <br><br><img src="https://habrastorage.org/storage2/5f4/f0d/703/5f4f0d70303bd45e7ad2ae36b8aae1b3.png"><br><br>  I repeat once again: the emphasis here is on the collection and storage.  We will not see anything similar to ‚Äúanalysis‚Äù, ‚Äúaudit of the data obtained‚Äù (not to be confused with ‚Äúaudit of the entrance to the system‚Äù, this is ordinary data from the logs). <br><br>  If you expect that the result of the control of compliance with the standard using the SIEM will be a message ‚ÄúSet minimum password length‚Äù with indication of the corresponding or non-relevant requirement, you are unfortunately mistaken. <br><br>  After running a test for compliance with any high-level standard from the list of available in the SIEM system, the report will only receive a list of events and systems broken down by requirements or (at best) a report on events within this requirement (for example, Data flows). <br><br><img src="https://habrastorage.org/storage2/0e3/284/65e/0e328465e898096b000305619204e5b6.png"><br><br><img src="https://habrastorage.org/storage2/89f/d39/82c/89fd3982cc666b8ce68c9c54f74de5ed.png"><br><br>  From this we can conclude that SIEM-systems are not intended for conformity assessment, but are needed as a technical tool to comply with certain requirements of standards for collecting and storing events and have only the functionality of track @ report. <br><br>  Of course, there are exceptions, but they are few.  Some vendors are trying to partially extract useful information from incoming events that affects compliance with standards.  In this case, the requirements are correlated with the SIEM correlation rules.  In this case, one requirement corresponds to several rules.  This is explained by the fact that a specific fact (for example, changing the minimum password length in a domain policy) may include many events from different data sources, and the content of the event itself may be different. <br><br>  In addition, in the event log of each data source, a specific event can be described by various service words, with different event_id. <br><br><img src="https://habrastorage.org/storage2/4fb/e81/f16/4fbe81f16479a30887681302852c11f4.png"><br><br>  However, performing a compliance check in this way requires too many resources, so the SIEM developers reject this idea. <br><br>  Why are there difficulties in implementing a full-fledged analysis for compliance?  Briefly consider the main reasons. <br><br>  <i>The first reason</i> .  SIEM lacks the concept of an object.  Here you can recall the correlation method ‚ÄúMBR model based reasoning‚Äù, described in a <a href="http://blog.ptsecurity.ru/2012/10/siem_17.html">previous article</a> .  Using this method, for example, it would be possible to describe the state of an object, leading to a mismatch. <br><br><img src="https://habrastorage.org/storage2/fa2/945/e98/fa2945e985ca2ba222de035f6b898c7f.png"><br>  The SIEM model stores events, categories and classes of events, statistics.  However, there are no facilities or assets (although this concept does not exist for the SIEM). <br><br>  <i>The second reason</i> .  In the SIEM-systems of most manufacturers, events are not normalized (they are not reduced to one standardized form), therefore, a large number of logical correlation rules need to be compiled.  This, in turn, leads to the irrationality of the drafting of full-fledged standard compliance. <br><br>  Why it happens?  All manufacturers strive to meet the NIST 800-92 requirement (‚ÄúOriginal event is preserved and have not changed data during normalization‚Äù) and, in order to ensure that the original events remain unchanged, they are stored in the RAW format. <br><br>  What to do?  Alternatively, use the CEE standard ( <a href="http://cee.mitre.org/">http://cee.mitre.org</a> ).  This will standardize events without conflict with NIST 800-92. <br><img src="https://habrastorage.org/storage2/9fb/995/cd5/9fb995cd5664ba54076aca20e4ac3176.png"><br>  In SIEM, it will not be possible to describe all the technical requirements of the standards for one simple reason: the requirements values ‚Äã‚Äãare not transmitted in events from sources.  Accordingly, SIEM without additional functionality of the scanner in the SIEM-agent will not receive these values.  However, the trend now is the use of non-agent technology.  In spite of everything, using SIEM, you can track most of the state of requirements in real time.  SIEM developers need only take a step to correct errors. <br><br>  I hope that in this article I managed to dispel the myth of compliance testing in SIEM systems, as well as give an idea of ‚Äã‚Äãthe concepts of standard compliance, policy compliance, regulatory compliance. <br><br>  See you in new publications!  We are waiting for your questions and comments in the comments. <br><br>  <i>Author: Olesya Shelestova, Research Center Positive Research.</i> </div><p>Source: <a href="https://habr.com/ru/post/171083/">https://habr.com/ru/post/171083/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../171071/index.html">Sergey Brin: smartphones are asocial</a></li>
<li><a href="../171073/index.html">Mass client migration between hosting providers: struggling with entropy on an industrial scale</a></li>
<li><a href="../171077/index.html">Dennis Tito plans to send people to Mars in 2018</a></li>
<li><a href="../171079/index.html">About correct memory usage in Linux NUMA systems</a></li>
<li><a href="../171081/index.html">The method of image formation in the projection of Gauss-Kruger</a></li>
<li><a href="../171087/index.html">Getting started with Push Notifications in PhoneGap</a></li>
<li><a href="../171089/index.html">Users in applications: what are the realities?</a></li>
<li><a href="../171091/index.html">IDC counted the smartphone market in Russia</a></li>
<li><a href="../171093/index.html">[Disproved] We do not give away parcels without a middle name, or about new rules for Russian post</a></li>
<li><a href="../171095/index.html">Mathematical model of the malefactor and protection of physical objects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>