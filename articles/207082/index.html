<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Spanner NewSQL storage from Google</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Spanner is a geographically distributed, highly scalable multi-version database with support for distributed transactions. The repository was develope...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Spanner NewSQL storage from Google</h1><div class="post__text post__text-html js-mediator-article">  <strong>Spanner</strong> is a <em>geographically distributed, highly scalable multi-version database with support for distributed transactions.</em>  The repository was developed by Google engineers for the corporation‚Äôs internal services.  Research paper [8], which describes the basic principles and architecture of Spanner, was presented at the scientific conference of the <em>10th USENIX Symposium on Operating Systems Design and Implementation</em> in 2012. <br><br>  Spanner is an evolutionary development of NoSQL predecessor - <a href="http://0xcode.in/bigtable">Google Bigtable</a> .  C Spanner itself belongs to the family of New SQL solutions.  The research paper [8] states that the Spanner design allows the system to <em>scale to millions of compute nodes across hundreds of data centers and work with trillions of data lines</em> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0bb/a58/739/0bba5873977242469ce8706f05d0af79.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  Spanner uses <a href="https://habr.com/post/206986/"><strong>Colossus</strong></a> (GFS of the new generation) as a storage layer (storage) and the <em>Paxos</em> collision resolution algorithm.  In turn, on the basis of ( <em>on top</em> ) Spanner, a distributed <em>Google F1</em> database is built. <br><br>  Spanner is <em>used</em> in the social network Google+, in the mail service GMail.  Spanner built on the basis of the Google F1 Database used at the time of publication [8] in the Google Ad Service. <br><br><h2>  Basic principles </h2><br>  The data in Spanner is stored in <em>semi-relational tables with a schema</em> .  All data have a version - timestamp ( <em>timestamp</em> ) to confirm the recording of this data (commit).  Spanner has a SQL-like query language, the ability to configure the number of replicas and the Garbage Collector policy responsible for deleting records with ‚Äúold‚Äù timestamps. <br><br>  In addition to the ‚Äúusual‚Äù possibilities for the NoSQL world, Spanner has a number of properties that are difficult to implement in distributed systems.  Such as: <br><ul><li>  <em>distributed transaction</em> support; <br></li><li>  <em>global consistency of read operations</em> between geographically distributed DCs, thus  the data that returns read operations from different DCs are always consistent and consistent. <br></li></ul><br>  In addition, Spanner has capabilities that are more typical for DBMSs, such as: <br><ul><li>  non-blocking reading of data "from the past" (in past); <br></li><li>  no locks for read-only transactions; <br></li><li>  atomic change in the schema of the data tables; <br></li><li>  synchronous replication; <br></li><li>  automatic processing of failures of both compute nodes and DC; <br></li><li>  automatic data migration both between compute nodes and between DCs. <br></li></ul><br><h2>  Architecture </h2><br>  Each deployed instance ( <em>deployment</em> ) Spanner is named <em>Universe</em> and contains: <br><ul><li>  <em>Universe master</em> - a master process that coordinates the work of multiple zones (in the Spanner- <em>Zone</em> terminology); <br></li><li>  <em>The Zone</em> is a geographically distributed (in general) Spanner zone.  Zone is a unit of both logical isolation and physical. <br></li></ul><br>  Each of the Zone, in turn, contains: <br><ul><li>  <em>ZoneMaster</em> - zone master process (singleton); <br></li><li>  Many - from hundreds to several thousand - <em>Spanservers</em> ; <br></li><li>  <em>Location proxy</em> - reveal to customers the location of the Spanservers responsible for the necessary data; <br></li><li>  <em>Placement driver</em> is a process (as well as Zonemaster, Singleton) that controls the movement of data between different Zone. <br></li></ul><br><img alt="Spanner arhitecture" src="https://habrastorage.org/getpro/habr/post_images/827/f84/e1b/827f84e1b7fb544939c976e6d183cc19.png"><br><br>  The research paper [8] describes in detail the functions and the internal device <em>only</em> Spanserver. <br><br>  Each Spanserver contains from 100 to 1000 data structures called <em>tablet</em> . <br><br> <code>(key: string, timestamp: int64) -&gt; string <br></code> <br><br>  Unlike Bigtable, Spanner adds the timestamp for adding this data to the structure of the stored data, which is an important introduction to support multi-versioning of the data. <br><br>  Spanner's <em>data model</em> is a semi-relational table with support for data schemas (schematized), SQL-like query language and distributed transactions. <br><br>  The implementation of the latest (transactions) has become possible thanks to one of the most innovative innovations for this kind of software systems - the <em>TrueTime API</em> . <br><br><h3>  Truetime </h3><br>  A common task for systems providing the global time (in particular the atomic clock) is to provide the most accurate time.  TrueTime API also provides clients with <em>global time + some uncertainty</em> - TTinterval. <br><br>  This is necessary because for distributed systems it is very difficult to guarantee the instantaneous response of the nodes, which is important for ensuring consistency of data in the distributed storage. <br><br>  At the approach, when instead of the exact time, some time interval of performing two competitive transactions is reduced (simplified) to the comparison TTinterval of these transactions.  If TTinterval transactions do not overlap, then you can definitely know which of the transactions should be performed before.  If TTinterval intersects, then you can only say with a certain degree of probability.  ( <a href="https://habr.com/post/160301/">Read more</a> about the TrueTime hardware.) <br><br>  In the Spanner itself, the <em>consistency of data</em> during transactions is provided by <em>the two-phase transaction commit protocol</em> (2-Phase Commit Protocol) implemented using the Paxos algorithm. <br><br><h2>  Restrictions and CAP </h2><br>  At the time of publication of the research paper [8], Spanner did not support <em>secondary indexes</em> and <em>automatic resharding</em> for load balancing.  In addition, the authors of [8] note that Spanner is not able to efficiently execute <em>complex SQL queries</em> . <br><br>  Spanner is also not a "refutation" of the CAP-theorem.  Spanner is not an AP system, despite its NoSQL nature;  as well as not a CA system, despite <del>  support </del>  commitment to supporting the principles of ACID.  Spanner "sacrifices" <em>availability</em> ( <em>availability</em> ) to maintain <em>data integrity</em> ( <em>consistency</em> ) and therefore is a CP-system. <br><br><h2>  Results </h2><br>  Spanner took the best ideas of two worlds - <em>relational DBMS and NoSQL</em> - and is the <em>NewSQL generation DBMS</em> . <br><br>  Support for distributed transactions between data centers on petabyte data volumes, with this ability to scale, is certainly an extremely impressive feature for any structured and semi-structured data storage system.  This possibility was largely a consequence of the symbiosis of two approaches: an approach to data storage ‚Äî the data is immutable and contains a commit time stamp ‚Äî and the innovative concept for obtaining global time ‚Äî TrueTime. <br><br><h2>  List of sources* </h2><br>  [8] James C. Corbett, Jeffrey Dean, Michael Epstein, Andrew Fikes, Christopher Frost, JJ Furman, et al.  <a href="http://static.googleusercontent.com/external_content/untrusted_dlcp/research.google.com/en/us/archive/spanner-osdi2012.pdf">Spanner: Google's Globally-Distributed Database.</a>  Proceedings of OSDI, 2012. <br>  * <a href="https://habr.com/post/206972/">A complete list of sources</a> used to prepare the cycle. <br><br><br>  Dmitry Petukhov <br>  MCP, <s>PhD Student</s> , IT Zombies, <br>  caffeinated man instead of red blood cells. </div><p>Source: <a href="https://habr.com/ru/post/207082/">https://habr.com/ru/post/207082/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../207070/index.html">Smartphone Just5 Spacer: 5 inches and 4 cores for 4,950 rubles. Plus two covers included</a></li>
<li><a href="../207072/index.html">CSS3 Big Book</a></li>
<li><a href="../207074/index.html">A micromotor is created which is three orders of magnitude stronger than a human muscle.</a></li>
<li><a href="../207078/index.html">Adopted standard on integrated SIM cards</a></li>
<li><a href="../207080/index.html">Panel sending outgoing faxes using Asterisk and Node.js</a></li>
<li><a href="../207084/index.html">Socialization TV</a></li>
<li><a href="../207086/index.html">How-to: Transparent NTLM authorization on the corporate portal</a></li>
<li><a href="../207088/index.html">Windows runtime. CLR type system and interaction</a></li>
<li><a href="../207094/index.html">The 3D printer should stand next to the ‚ÄúWhite Swan‚Äù, or about the national characteristics of trademarks.</a></li>
<li><a href="../207096/index.html">Quick selection of random values ‚Äã‚Äãfrom large MySQL tables by condition</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>