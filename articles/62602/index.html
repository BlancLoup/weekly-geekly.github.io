<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The absolute mystery of inheritance in Java</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Why is this riddle absolute? For two reasons: 
 ‚Ä¢ It relates to the core of the Java language, not some little-known nuance of the API. 
 ‚Ä¢ She melted...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The absolute mystery of inheritance in Java</h1><div class="post__text post__text-html js-mediator-article"> Why is this riddle absolute?  For two reasons: <br>  ‚Ä¢ It relates to the core of the Java language, not some little-known nuance of the API. <br>  ‚Ä¢ She melted my brain when I stumbled upon it. <br>  If you want to test yourself before further reading, take <a href="http://www.classmarker.com/embedded_quizzes/%3Fquiz%3D5ced4e42711fa927925c23e87b51be94">this test</a> . <br><a name="habracut"></a><br>  To begin, prepare the environment.  We will have 3 classes in 2 packages.  Classes <code>C1</code> and <code>C2</code> will be in the <code>p1</code> package: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">package p1; <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C1 { <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 1;} <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C2 extends C1 { <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 2;} <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Class <code>C3</code> will be in a separate <code>p2</code> package: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">package p2; <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C3 extends p1.C2 { <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 3;} <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  We also need the test class <code>p1.Main</code> with this <code>main</code> method: <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> main(String[] args) { <br> C1 c = <font color="#0000ff">new</font> p2.C3(); <br> System. <font color="#0000ff">out</font> .println(cm()); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Note that we call the class <code>1</code> method on an instance of the class <code>C3</code> .  As you might guess, this example will display "3". <br><br>  Now let's change the visibility of <code>m()</code> in all three classes to default visibility: <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> C1 { <br> <font color="#008000">/*default*/</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 1;} <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C2 extends C1 { <br> <font color="#008000">/*default*/</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 2;} <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C3 extends p1.C2 { <br> <font color="#008000">/*default*/</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 3;} <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Now the output will be "2"! <br>  Why is this happening?  The <code>Main</code> class, which makes the call, does not see the <code>m()</code> method of the <code>C3</code> class, since it is in a separate package.  As for <code>Main</code> , the chain of inheritance ends in <code>C2</code> .  But since <code>C2</code> is in the same package, its <code>m()</code> method overrides the corresponding <code>C1</code> method.  Not very intuitive, but so it works. <br><br>  Now let's try something else: change the <code>C3.m()</code> modifier back to <code>public</code> .  What happens now? <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> C1 { <br> <font color="#008000">/*default*/</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 1;} <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C2 extends C1 { <br> <font color="#008000">/*default*/</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 2;} <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C3 extends p1.C2 { <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 3;} <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Now <code>Main</code> sees the <code>C3.m()</code> method.  But oddly enough, the result is still "2"! <br>  It seems that <code>C3.m()</code> does not redefine <code>C2.m()</code> .  You can think of it this way: the overriding method must have access to the method that it overrides (via <code>super.m()</code> ).  However, in this case, <code>C3.m()</code> does not have access to its base method, since it is in a different package.  Therefore, <code>C3</code> is considered part of a completely different chain of inheritance, not one that contains <code>C1</code> and <code>C2</code> .  If we called <code>C3.m()</code> directly from <code>Main</code> , we would get the expected result "3". 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now let's take a look at one more example.  <code>protected</code> - an interesting visibility modifier.  It behaves as a default modifier for members of the same package and as <code>public</code> for subclasses.  What happens if we change all visibility to <code>protected</code> ? <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> C1 { <br> <font color="#0000ff">protected</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 1;} <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C2 extends C1 { <br> <font color="#0000ff">protected</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 2;} <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C3 extends p1.C2 { <br> <font color="#0000ff">protected</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 3;} <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  I reasoned like this: since <code>Main</code> not a subclass of any of our classes, then <code>protected</code> , in this case, should behave the same as the default modifier and the result should be "2."  However, it is not.  The important point is that <code>C3.m()</code> has access to <code>super.m()</code> and, therefore, the actual output will be "3". <br>  Personally, when I first encountered this situation, I was very confused and could not figure it out until I had studied all the examples.  So far, we can conclude that a subclass is part of the chain of inheritance, if and only if you can refer to <code>super.m()</code> from it. <br><br>  This assumption is also wrong.  Consider the following example: <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> C1 { <br> <font color="#008000">/*default*/</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 1;} <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C2 extends C1 { <br> <font color="#008000">/*default*/</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 2;} <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C3 extends p1.C2 { <br> <font color="#008000">/*default*/</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 3;} <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> C4 extends p2.C3 { <br> <font color="#008000">/*default*/</font> <font color="#0000ff">int</font> m() { <font color="#0000ff">return</font> 4;} <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Note that <code>C4</code> is in the <code>p1</code> package.  Now change the code of the <code>Main</code> class as follows: <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> main(String[] args) { <br> C1 c = <font color="#0000ff">new</font> C4(); <br> System. <font color="#0000ff">out</font> .println(cm()); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Then he will print "4".  However, <code>super.m()</code> not accessible from <code>C4</code> : if you add the annotation <code>@Override</code> to <code>C4.m()</code> , the code will not be compiled.  At the same time, if we change the <code>main</code> method to <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> main(String[] args) { <br> p2.C3 c = <font color="#0000ff">new</font> C4(); <br> System. <font color="#0000ff">out</font> .println(cm()); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  then the result will again be "3".  This means that <code>C4.m()</code> overrides <code>C2.m()</code> and <code>C1.m()</code> , but not <code>C3.m()</code> .  This also makes the situation even more confusing, and the correct assumption is as follows: <em>the subclass method overrides the base class method, if and only if the method in the base class is accessible from the subclass</em> .  Here, the ‚Äúbase class‚Äù refers to any ancestor, not necessarily the direct parent. <br><br>  The moral of the story is this: although this behavior is described in the specification, it is not intuitive.  In addition, there can be not one chain of inheritance, but many, and by changing the visibility modifier from ‚Äúdefault‚Äù to <code>protected</code> , you can break the code in a completely different place without even knowing it, because several chains inheritance will merge into one. <br><br>  UPD: use the <a href="https://habrahabr.ru/users/override/" class="user_link">Override</a> annotation, then the code will not compile in this situation. <br><br></div><p>Source: <a href="https://habr.com/ru/post/62602/">https://habr.com/ru/post/62602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../62595/index.html">Grammar Gravity</a></li>
<li><a href="../62596/index.html">PHP vs MySQL. Who is faster?</a></li>
<li><a href="../62597/index.html">Meet with Yota</a></li>
<li><a href="../62598/index.html">Will the function of ordering a taxi on icq and other IM be in demand? (a city of about 130 thousand inhabitants.)</a></li>
<li><a href="../62600/index.html">VKontakte can no longer delete your account?</a></li>
<li><a href="../62603/index.html">How to trick a little Last.fm</a></li>
<li><a href="../62606/index.html">Wikipedia Videos</a></li>
<li><a href="../62608/index.html">Natural Wii Bowling</a></li>
<li><a href="../62609/index.html">Yandex Wishes</a></li>
<li><a href="../62610/index.html">For show off you have to pay</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>