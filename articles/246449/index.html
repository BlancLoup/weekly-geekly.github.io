<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerabilities of public terminals: how to hack a bike rental and a polyclinic</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This year, Moscow was swept up by a real bicycle fever. The number of bicycle rental stations was increased from 79 to 150, and 90,000 people used the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerabilities of public terminals: how to hack a bike rental and a polyclinic</h1><div class="post__text post__text-html js-mediator-article">  This year, Moscow was swept up by a real bicycle fever.  The number of bicycle rental stations was increased from 79 to 150, and 90,000 people used the rental services.  While two-wheeled friends are relaxing during the winter holidays, we‚Äôll tell you about the vulnerabilities of the terminals for paying for the rental of bicycles, which jeopardized the security of personal data and electronic wallets of users, and also made us think about the new paradigm of attacks on corporate networks. <br><br> <a href="http://habrahabr.ru/company/pt/blog/246449/"><img src="https://habrastorage.org/getpro/habr/post_images/a9d/8c4/745/a9d8c47455f9c9cd7c1573fc3e8867c9.jpg" alt="image"></a> <br><br>  Payment and information terminals today operate on the streets, in shopping centers, at airports, in clinics, in the subway.  Most of these devices are based on Windows, in the so-called kiosk mode, which allows you to run one main full-screen application on your computer, specified by the administrator.  The functionality of the terminal is significantly expanded if you exit the kiosk mode into the operating system. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The application sometimes ‚Äúcrashes‚Äù on its own due to errors in the program and memory leaks, but there are also ways to minimize it.  The most ancient way is to perform a long press on the terminal screen until the context menu appears, which emulates a right mouse click.  Further penetration scenario depends on the browser.  For example, you can get into the control panel from the context menu of Google Chrome using the "Save As" command and the help section icon. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/78d/b88/03f/78db8803f0b0d29ef5f4018a708d40c9.png" alt="image"><br><br>  In some cases, an effective attack vector was a simple palpation of the screen in the lower left corner, allowing you to get to the taskbar and the Start menu, or simultaneously pressing several areas of the screen to minimize the main application. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/acc/e17/1f4/acce171f4cbaa61759995f1c4b9f460f.png" alt="image"><br><br>  To date, some of these loopholes are closed.  But not all!  Let's look at the situation from the perspective of a programmer.  What can he lose sight of? <br><br>  The developer will definitely test the interactive parts of his full-screen application and validate the user-entered data so that the user does not have the opportunity to click on something and "fall through" inside the operating system.  But applications have become more complex, they use different technologies, including third-party code or widgets from other companies. <br><br><h4>  Attack on the bike rental </h4><br>  The application in the terminal of the bicycle parking is beautifully designed, the input of characters has been tested ... But there was one bad "but" in it.  In addition to the user registration form, the interface contains a reference section with a map.  It has a lot of useful information: where is this terminal and other bicycle parkings, how to get to the nearest cafes, cinemas and other "points of interest".  The map is based on the standard Google widget.  There was a mistake. <br><br>  If you take a closer look, you can see the "Report a Problem", "Privacy" and "Terms of Use" links in the bottom right of the widget.  Click on any of them - and the standard Internet Explorer window appears. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/245/861/d6c/245861d6ce53729abe12c1bc77259444.jpg" alt="image"><br><br>  The browser window could be opened in a different way: by clicking the "Details" button when choosing the location of certain objects. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b1/a34/49c/2b1a3449c68bd066222c75d4168d6973.jpg" alt="image"><br><br>  Half done. <br><br>  The help section in Internet Explorer allows access to all elements and system programs of the OS.  A bit of street magic, and we find ourselves in the "Center for special features" control panel, from where we start the on-screen keyboard. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/ca9/19a/04a/ca919a04aa3c0ab356e3d0baaf9167a4.jpg" alt="image"></a> <br><br>  You can directly get to the keyboard: go to the "Explorer" by sequentially selecting the properties of the Internet Explorer browser ‚Äî the General tab, the Options, View Objects buttons ‚Äî and clicking the Osk.exe application in the C: \ Windows \ System32 folder. <br><br>  Armed with a virtual keyboard, type cmd.exe and run the command line, where with the help of the WHOAMI command we check the status in the system.  We had administrative rights, so you can wear crimson pants and manage. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/908/6dd/7c1/9086dd7c1a3a626af2aa9fa38619ced9.jpg" alt="image"></a> <br><br><h4>  Operating scenarios </h4><br>  A full internet connection in the terminal was available, despite the strict recommendations on limiting access to the external network for such devices.  The intruder could go to the same exploit-db, download malicious applications to the hard disk of the device and run them, and also extract the administrator password using known password-cracking programs (mimikatz, WCE, Fgdump, pwdump).  It is worth adding that different bicycle parks are likely to have the same administrator passwords. <br><br>  What else could a cyber cracker do?  Replace files in the system directory, elevate privileges, dump user data.  The overt flaws in the configuration left the intruder with space for quite dizzying maneuvers.  Designing a botnet based on captured terminals, a mining pool, a cozy banner network with its own ad ... In addition to the usual interception of the entered personal data using a keylogger, an attacker could send the parking application to himself over the network, make changes to it (for example, add a field with the requirement to specify three-digit code CVV / CVV2) and set back.  Users are unlikely to, s immediately suspect something, only a bike ride would have cost them dearly ... <br><br><h4>  Insidious window print </h4><br>  In addition to the friendly cartography, many terminals print checks, tickets, and this can also be used to penetrate the system.  For example, in one of the organizations, when a ticket is issued for an electronic queue, a Windows interface with a print window appears for a moment.  Under certain conditions, it will not be difficult to click on the choice of printer, and then exit to the control panel. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/77c/007/844/77c007844ff7f16a6c37d365e41a4d46.png" alt="image"></a> <br><br>  A similar window may appear if the embedded printer has run out of paper, the ink has dried in the cartridge, or the terminal itself solves the Fermat theorem and therefore works very slowly. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c49/3a2/721/c493a272190747786e71ebb266f5c180.png" alt="image"><br><br><h4>  And if you dig deeper </h4><br>  Over the past year, the author of this article and his colleagues have faced the unsafe work of e-government infomats, info kiosks at one of Russian airports, aircraft entertainment <a href="https://vimeo.com/53502739">systems</a> , remote SCADA terminals, and also <a href="http://www.youtube.com/watch%3Fv%3DN_YqsGo6xFQ">launched</a> Angry Birds on an ATM.  Recently, Russian clinics are actively being equipped with terminals where anyone can make an appointment with a doctor.  Without due attention to the security of the terminals, we run the risk of witnessing massive leaks of information that already constitutes medical confidentiality. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4d1/056/5ce/4d10565cea84f30a43454c81d466da0c.png" alt="image"><br><br>  And it still flowers!  A distinctive feature of public terminals is that they are often connected to the same internal network and are trusted by the central server.  At the same time, the terminal administrator may have access to the internal resources of the parent company with important confidential data.  Do the hacker need to break through firewalls and attack prevention systems if you can find an information kiosk on a quiet street, which has vulnerabilities the size of a hippo and direct access to the main office server? <br><br>  Imagine a modern high-tech airline, information kiosks of which are located at various airports.  Having obtained full access to the terminal and hacked the server responsible for such devices (no patch, vulnerability in the data exchange protocol), the attacker will check if the server has a second interface connected to the airline's internal network and there are ways to get into it.  There are several ways to conduct corporate secrets ‚Äî VPN access, terminal server and internal network administrator passwords, web mail application vulnerabilities for sending statistics or error reports. <br><br><h4>  What to do </h4><br>  The main trouble of public terminals with touch screens is to minimize the main application and the intruder hits the Windows interface.  Developers need to block pop-up menus with a long press on the screen (as when pressing the right mouse button) and exclude the call to the print window, from where you can get into the Windows control panel.  We also recommend using embedded OS assemblies, which are devoid of a number of security flaws in standard versions - in particular, do not use the desktop (but still, they don‚Äôt protect against opening the same IE). <br><br>  The mandatory minimum of events includes checking all links of the full-screen application and third-party widgets.  If, when navigating to a web address, a new browser window opens, you should disable this feature by editing the widget code and removing the links.  The main terminal application should always be on top of all Windows windows: various utilities can help with this (for example, Window On Top). <br><br>  From other wishes: unique passwords on different terminals, ordinary user privileges for the standard mode of the device and a limited list of addresses when accessing the external network. <br><br>  PS Incorrect configuration settings were professionally and promptly eliminated by developers, and the payment terminals of the Moscow city bike rental, according <a href="http://bg.ru/933/">to</a> representatives of the Moscow mayor's office, continue their work in the winter. <br><br>  PPS Thanks to Denis Makrushin for his help in conducting the study. <br><br>  <b>Author:</b> Stanislav Merzlyakov </div><p>Source: <a href="https://habr.com/ru/post/246449/">https://habr.com/ru/post/246449/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../246439/index.html">Printing machines. The power and support of typography</a></li>
<li><a href="../246441/index.html">Breeze.js + Entity Framework + Angular.js = easy work with database entities directly from the browser</a></li>
<li><a href="../246443/index.html">Attempt to make logical editing form behavior in asp mvc</a></li>
<li><a href="../246445/index.html">Qt + MVP + QThread. Build your bike</a></li>
<li><a href="../246447/index.html">A little about how not to protect accounts in Active Directory</a></li>
<li><a href="../246451/index.html">Sensomotor coordination (SMK). Professional research / pilot training</a></li>
<li><a href="../246455/index.html">R reference manual</a></li>
<li><a href="../246459/index.html">Interval repetition of foreign words: Anki, LinguaLeo, Memrise</a></li>
<li><a href="../246461/index.html">I am a certified PHP specialist</a></li>
<li><a href="../246463/index.html">We write the most effective test case</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>