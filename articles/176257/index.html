<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Nonlinear dimension compression using a limited Boltzmann machine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hey. In this post we will continue to experiment with the limited Boltzmann machine . In the previous post on regularization in the BSR, we saw how to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Nonlinear dimension compression using a limited Boltzmann machine</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/577/a1e/ac7/577a1eac75fba4ca59496fa49ab597d6.jpg" align="right">  Hey.  In this post we will continue to experiment with the <a href="http://habrahabr.ru/post/159909/">limited Boltzmann machine</a> .  In the previous post on <a href="http://habrahabr.ru/post/175819/">regularization in the BSR,</a> we saw how to get more local features that have a greater generalizing ability.  But we did not appreciate their robustness compared to simpler and faster algorithms.  For this experiment, we turn to the linear <a href="https://en.wikipedia.org/wiki/Principal_component_analysis">method of principal components</a> (you can familiarize yourself with this method and look at the implementation on c # in my <a href="http://habrahabr.ru/post/146236/">first post</a> ).  Those wishing to familiarize themselves with the original source on the theory of compression of dimension using the RBM recommend looking through the articles of Jeffrey Hinton <a href="http://www.cs.toronto.edu/~hinton/science.pdf">here</a> and <a href="http://www.cs.utoronto.ca/~hinton/absps/nonlinnca.pdf">here</a> .  We will continue testing on a set of printed large letters: train the BSR, build the main components, generate compressed data representations, and restore the original images from them, and then evaluate the difference between the original and recovered images. <br><br><a name="habracut"></a><br><br><h4>  Linear main components </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It is understood that you are familiar with the main component method, if not, then <a href="http://habrahabr.ru/post/146236/">you are here</a> .  For this experiment, I use a variety of images of 29 by 29 pixels, which show large letters of the English alphabet of four different fonts and three styles, as well as the same images with noises, a total of 4,056 images.  The test set consists of the same set of letters, but with a lot of noise - 3432 pieces.  So let's get started, in R the code looks quite simple: <code>m.pca &lt;- eigen(cov(m))</code> .  The importance of the main components can be estimated by their main values, first normalizing them by the sum of these values.  The result will be the following graphics.  The first one shows what percentage of <a href="http://en.wikipedia.org/wiki/Explained_variance">variation describes each main component</a> , the second one shows the sum of the explained variation at each step. <br><br><img src="http://habrastorage.org/storage2/7ac/981/fdd/7ac981fdd4ce6e41049306907493aef8.png"><br><br>  In the BSR, we will use 100 hidden states, so for honesty, we will select the first 100 main components, which explain 89.36% of variability, this level is shown as a line in the graphs above. <br><br>  Each major component can be interpreted as a 29 by 29 pixel image that detects some features of the data set.  You can draw an analogy with the weights of hidden neurons of the limited Boltzmann machine, and visualize as we did in <a href="http://habrahabr.ru/post/159909/">previous</a> <a href="http://habrahabr.ru/post/175819/">posts</a> .  Let me remind you that in the second image the black color corresponds to the zero value, the increase in the red component - the increase in the value in the positive direction, the blue, respectively - in the negative. <br><br><img src="http://habrastorage.org/storage2/d97/f28/abd/d97f28abde46ebf00880cd76ef0cf7b3.png"><img src="http://habrastorage.org/storage2/383/28b/4b0/38328b4b06b03174c8e1f21ede3ed5d0.png"><br><br>  The order of the main components from left to right, top to bottom.  The features turned out pretty big, each of them has approximately the average size of the letter from the training set.  At the expense of speech interpretation does not go at all, well, except for the first few components. <br><br><h4>  Restricted Boltzmann machine </h4><br><br>  For this experiment, I used the settings described in the <a href="http://habrahabr.ru/post/175819/">previous post</a> for L1 regularization, the only thing that was changed is the training set (as described above) and the number of iterations was 5000, it took about 14 hours (I feel it's time to rewrite the GPU).  At this point, the cross-qualification error was still falling, so the training could continue.  The result was the following weight. <br><br><img src="http://habrastorage.org/storage2/e58/a13/b8d/e58a13b8d8ba21c15698e0dc476e5436.png"><img src="http://habrastorage.org/storage2/d66/a16/0c1/d66a160c1d431983baab5e49fc3b2db2.png"><br><br>  As you can see, the features are very local, mostly these are primitives of the type of small spots and boundary lines, by combining some of them you can study the topological features of the images from the training set.  Due to their locality, very small receptor fields of neurons can be built, i.e.  reset to 95% of the weights of each neuron, which will significantly increase the speed of the data projection algorithm, which is really important. <br><br><h4>  Regenerating ability </h4><br><br>  Let's take a look at some examples of images reconstructed using two models.  In the first column, the original images, in the second, recovered using PCA, in the third, using RBM. <br><br><img src="http://habrastorage.org/storage2/f1f/3a7/f67/f1f3a7f67b627f6c7cef4c5db8529f33.png"><img src="http://habrastorage.org/storage2/05c/3ae/5a9/05c3ae5a9342e805605176fe3d7d7c5e.png"><br><br>  When I saw that the background in the PCA-reconstructions is too gray, I tried, by analogy with the <a href="http://en.wikipedia.org/wiki/Eigenface">eigenface</a> , to do a normalization by the mean value, but in the end, the reconstructed images did not differ much from the above.  The enlarged example shows that the image is blurred along the borders, although in the case of PCA it is slightly larger. <br><br>  As an estimate of the distance between the images, we will use the <a href="http://en.wikipedia.org/wiki/Taxicab_geometry">L1-metric</a> : <br><br><img src="http://upload.wikimedia.org/math/6/5/d/65d32482205679dcb32f7289a0494025.png" alt="image"><br><br>  The result was the following, I recall that the test set did not participate either in the construction of the BSR model or in the calculation of the main components: <br><br><table><tbody><tr><th></th><th>  PCA </th><th>  RBM </th></tr><tr><th>  Train set </th><td>  29.134736802449488 </td><td>  21.79797897303671 </td></tr><tr><th>  Test set </th><td>  49.231927648058118 </td><td>  29.970740205433025 </td></tr></tbody></table><br><br>  As you can see, the result in both cases is on the RBM side. <br><br><h4>  Conclusion </h4><br>  The RBM has several ways to improve quality.  First, I stopped learning at 5,000 iterations, although we could continue learning, say, until the cross-qualification error starts to grow.  Secondly, you can continue to play with the parameters of training.  Thirdly, the features are quite local, which can increase the speed of the algorithm.  Fourth, it is easy to see that many features in the BSR are almost identical, which gives us the ability to cluster the features and merge the clusters so as not to calculate their value several times, or train the BSR with fewer hidden neurons. </div><p>Source: <a href="https://habr.com/ru/post/176257/">https://habr.com/ru/post/176257/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../176245/index.html">COMAN: a very steady humanoid robot</a></li>
<li><a href="../176247/index.html">The world's smallest "laboratory" for DNA analysis</a></li>
<li><a href="../176249/index.html">Abstractness and open systems interaction model</a></li>
<li><a href="../176251/index.html">How we did Yandex.Disk: server side, WebDAV and Erlang</a></li>
<li><a href="../176253/index.html">Is everything in Bitcoin as good as its proponents say?</a></li>
<li><a href="../176259/index.html">Now smart search and in asana</a></li>
<li><a href="../176263/index.html">Bitcoin rate has plummeted for the past few hours.</a></li>
<li><a href="../176267/index.html">Heritage Health Prize data mining contest ends</a></li>
<li><a href="../176269/index.html">The Pirate Bay [again] want to block</a></li>
<li><a href="../176271/index.html">MSNW thermonuclear rocket</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>