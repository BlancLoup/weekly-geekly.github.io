<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Boring about the work of decoding ngfw</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you want to completely spoil the first date - talk to the girl about decoding. Yes, and in the case of the subsequent - is also not worth it. 

 Ou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Boring about the work of decoding ngfw</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/33c/762/970/33c7629703cf4ac6b2f6760a417ce359.png"></div><br>  <b>If you want to completely spoil the first date - talk to the girl about decoding.</b>  Yes, and in the case of the subsequent - is also not worth it. <br><br>  Our meeting with you is <a href="https://habrahabr.ru/company/cbs/blog/318326/">not the first</a> , so this text will again deal with decoding. <br>  Yes, I will talk again about SSL.  I can gladden myself and you with the fact that this is the second and last material on this topic.  Maybe. <a name="habracut"></a><br><br>  Last time, we figured out why you might need to decrypt the long-suffering SSL. <br>  In this material we will analyze exactly how decryption works with certificate substitution. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>What do we need for this?</b> <br><br>  First, let's remember how SSL works.  I will briefly describe the main points. <br><br>  After establishing a TCP session between the client and the server, SSL Handshake occurs.  Within it, both parties exchange messages Client Hello and Server Hello. <br><br><img src="https://habrastorage.org/files/5c7/1eb/cc7/5c71ebcc74dc4b6eb7194d28786dbf7f.png"><br>  <i>SSL connection establishment dump from vk.com</i> <br><br>  Client Hello describes the supported encryption parameters, Server Hello contains the parameters selected from the options offered by the client.  Client Hello and Server Hello can be used as an indicator for establishing an SSL session.  When these messages appear, the device (vFTD in our case) scans the configured decryption policies for a decision on whether to further decrypt the session or not. <br><br>  If the configured policies dictate the decryption of traffic, the device becomes man-in-the-middle (MITM) and decrypts the transmitted data.  With the successful launch of MITM, we have two established SSL sessions. <br><br>  The first is between the client and the descrambler (vFTD).  The second is between the descrambler and the server.  Encrypted data comes from the client to vFTD. <br>  Deciphered.  They are checked by various policies (access, IPS, file, AMP, etc.).  If the decrypted data from the client is checked, it is encrypted again and sent to the server.  If they do not pass any test, the data is either simply blocked (not sent to the server), or the session is reset.  Server responses are handled similarly. <br><br>  For a device to become a MITM in an SSL session, it takes a little.  At the SSL handshake stage, in addition to authentication and other actions, a shared session key is formed.  It is with its help that the transmitted data will be encrypted.  For this, a symmetric algorithm will be used. <br><br>  There are two of the most common ways to form a common session key over open communication channels on the Internet: RSA and ECDH (Diffie-Hellman).  The process of generating session keys is shown in the diagrams below (taken from the material ‚Äú <a href="https://habrahabr.ru/company/billing/blog/261301/">Analysis of SSL / TLS traffic in Wireshark</a> ‚Äù): <br><br><img src="https://habrastorage.org/files/6a5/7a4/a7c/6a57a4a7c6ba4ec1b6dcee529fcbb55f.png"><br>  <i>Formation of a session key when using RSA</i> <br><br>  In the case of RSA, the client generates a pre-master secret.  Encrypts it with the public key from the server certificate and sends it.  You can decrypt the pre-secret only with the private key, which is known only to the server. <br><br>  Now both sides have a preliminary secret.  They form the main secret and further the common session key. <br><br><img src="https://habrastorage.org/files/2c1/4ce/6f2/2c14ce6f2f284bdf9fd97b674761c09e.png"><br>  <i>Session key generation using ECDH</i> <br><br>  In the case of ECDH, the SSL certificate key pair is not used for encryption at all.  The client and the server form Diffie-Hellman random key pairs - open and closed.  Each party transmits its public key to the other party in an unencrypted form. <br><br>  Further, using the Diffie-Hellman algorithm, the client and server compute a shared pre-secret from their own secret key and someone else‚Äôs public secret.  After that, each party generates a shared master secret and session key. <br><br>  When using ECDH, you must preserve the integrity of the Diffie-Hellman transmitted public keys.  The server signs its own Diffie-Hellman public key using its private certificate key.  The client can verify the authenticity of the received Diffie-Hellman public key using the public key of the server certificate. <br><br>  <b>Thus, in order to organize a MITM for an SSL session,</b> in most cases it will be sufficient to replace the server certificate with your own.  If the substitution is successful, it will be possible to get a shared session key with the client and be able to decrypt the data. <br><br>  In the case of RSA, the MITM device will be able to decrypt the pre-secret using the certificate‚Äôs own private key.  If ECDH is used, the device will be able to sign its Diffie-Hellman public key in such a way that the signature is considered valid on the client‚Äôs side. <br><br>  In order to replace the server certificate with your own (for which we will know the private key), we need our own certificate to ensure correct server authentication on the client side.  Simply put - it is necessary that the client browser does not issue any warnings or locks when replacing the certificate.  For this, in most cases it is necessary that: <br><br><ol><li>  The subject field of the certificate contained the Common Name parameter with a value equal to that entered in the address bar of the browser; </li><li>  The certificate was signed by a trusted certificate authority. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Wildcard certificates</b> <div class="spoiler_text">  This is a certificate that is ordered to the domain.  In such a certificate, the Common Name parameter is written in the subject field with an ‚Äúasterisk‚Äù, for example, * .mysite.ru.  Thus, a single certificate can be used on all domain services: ra.mysite.ru, owa.mysite.ru, etc.  It may be cheaper than ordering a separate certificate for each service. <br><br>  The downside is that if the wildcard certificate is compromised in any way, all services will suffer at once.  After all, all servers will have the same private key. <br></div></div><br>  Of course, in order for a certificate to be considered valid on the client‚Äôs side, other conditions must be met: it should not be revoked, expired, etc.  But all these conditions are taken into account at the stage of signing the certificate by its own certification authority. <br><br><div class="spoiler">  <b class="spoiler_title">SHA-1</b> <div class="spoiler_text">  Now browsers are gradually forced to abandon the use of SHA1RSA as a digital signature algorithm.  For example, chrome will display a red crossed out https in the address bar: <br><br><img src="https://habrastorage.org/files/065/0be/d11/0650bed117564c46ae7b38800ef031fe.png"><br>  <i>Chrome swears at SHA-1</i> <br><br><img src="https://habrastorage.org/files/355/c0a/adf/355c0aadfce54791b48b1fcb89aa6de5.png"><br>  <i>Details</i> <br><br>  To avoid such warnings, the certification authority must use strict HASH generation algorithms for signing certificates ‚Äî the SHA-2 family. <br></div></div><br>  When using Certificate pinning, a service certificate must be signed by a strictly defined certificate authority.  If this is not the case, access to the resource is blocked even if the certificate is signed by a trusted authority. <br><br>  Accordingly, for resources with certificate pinning, decryption with certificate spoofing will not work. <br><br>  Thus, in order to organize MITM in an SSL session, the device must generate a new certificate with the same fields as the certificate of the remote server.  At the same time, we will have a known private key.  A new certificate must be signed using a trusted certificate authority. <br><br>  <b>In practice, this is implemented as follows:</b> <br><br>  A company must have its own certification center, the root certificate of which is placed into trusted companies on all devices.  This is a necessary condition. <br><br>  The certificate authority requests a new certificate using the ‚ÄúSubordinate certificate authority, hereafter SubCA) pattern.  The peculiarity of this certificate is that using its private key, you can sign other certificates (the CA flag is set in the ‚Äúcertificate main limitations‚Äù extension). <br><br>  Since SubCA is signed by a trusted root certificate, client machines will trust both themselves and any certificate signed with it.  SubCA and its corresponding private key is installed on the device, which is supposed to be the MITM in an SSL session.  Thanks to this, every time a client attempts to establish an SSL session with an HTTPS server, our device will be able to: <br><br><ol><li>  Intercept the server certificate; </li><li>  Create a private key; </li><li>  Generate a new certificate with the same fields as the replaced one; </li><li>  Sign the generated certificate using SubCA. </li></ol><br>  If everything is configured correctly, the user browser will not issue any warnings when opening https pages.  The user will be able to determine whether the certificate has been changed, only if it gets into the settings. <br><br><img src="https://habrastorage.org/files/4ca/4c2/ebf/4ca4c2ebfb344c66926748ddbc092c92.png"><br>  <i>Certificate Chain in Mozilla</i> <br><br>  If you look at the fields of the final certificate, you will see that the subject field contains the correct Common Name value. <br><br><img src="https://habrastorage.org/files/83a/b67/99a/83ab6799a3d64da5ba0d339b42099813.png"><br>  <i>Common Name field</i> <br><br>  If we compare the real and spoofed certificates, we see that they actually differ in the values ‚Äã‚Äãof public keys and digital signatures (in this case, I neglect the serial number, etc.). <br><br><div class="spoiler">  <b class="spoiler_title">Certificate Replaced</b> <div class="spoiler_text"><pre><code class="python hljs">Certificate: Data: Version: <span class="hljs-number"><span class="hljs-number">3</span></span> (<span class="hljs-number"><span class="hljs-number">0x2</span></span>) Serial Number: <span class="hljs-number"><span class="hljs-number">1482311739306634470</span></span> (<span class="hljs-number"><span class="hljs-number">0x14923aac5bc36ce6</span></span>) Signature Algorithm: sha256WithRSAEncryption Issuer: C=RU, ST=Moscow, O=CBS, OU=Computers, CN=proxy.cbs.com.ru/emailAddress=uskov@cbs.ru Validity Not Before: Sep <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span> <span class="hljs-number"><span class="hljs-number">2015</span></span> GMT Not After : Sep <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span>:<span class="hljs-number"><span class="hljs-number">55</span></span> <span class="hljs-number"><span class="hljs-number">2018</span></span> GMT Subject: OU=Domain Control Validated, CN=*.vk.com Subject Public Key Info: Public Key Algorithm: rsaEncryption Public-Key: (<span class="hljs-number"><span class="hljs-number">2048</span></span> bit) Modulus: <span class="hljs-number"><span class="hljs-number">00</span></span>:a1:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">76</span></span>:bf:<span class="hljs-number"><span class="hljs-number">21</span></span>:ce:<span class="hljs-number"><span class="hljs-number">9</span></span>b:e7:e2:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span>:f0:<span class="hljs-number"><span class="hljs-number">74</span></span>:<span class="hljs-number"><span class="hljs-number">02</span></span>: <span class="hljs-number"><span class="hljs-number">84</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>f:<span class="hljs-number"><span class="hljs-number">2</span></span>e:<span class="hljs-number"><span class="hljs-number">51</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>b:e8:<span class="hljs-number"><span class="hljs-number">4</span></span>a:<span class="hljs-number"><span class="hljs-number">11</span></span>:e2:<span class="hljs-number"><span class="hljs-number">34</span></span>:d8:<span class="hljs-number"><span class="hljs-number">3</span></span>a:d9:<span class="hljs-number"><span class="hljs-number">39</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>b:ea:<span class="hljs-number"><span class="hljs-number">87</span></span>:<span class="hljs-number"><span class="hljs-number">50</span></span>:<span class="hljs-number"><span class="hljs-number">33</span></span>:dc:<span class="hljs-number"><span class="hljs-number">64</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>b:<span class="hljs-number"><span class="hljs-number">2</span></span>e:f2:<span class="hljs-number"><span class="hljs-number">0</span></span>d:<span class="hljs-number"><span class="hljs-number">33</span></span>:<span class="hljs-number"><span class="hljs-number">36</span></span>:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>c: <span class="hljs-number"><span class="hljs-number">0</span></span>a:<span class="hljs-number"><span class="hljs-number">97</span></span>:a7:ce:<span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>d:d7:<span class="hljs-number"><span class="hljs-number">8</span></span>f:<span class="hljs-number"><span class="hljs-number">76</span></span>:<span class="hljs-number"><span class="hljs-number">85</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span>:<span class="hljs-number"><span class="hljs-number">42</span></span>:f9:<span class="hljs-number"><span class="hljs-number">63</span></span>:b6: d1:<span class="hljs-number"><span class="hljs-number">91</span></span>:ea:<span class="hljs-number"><span class="hljs-number">18</span></span>:de:<span class="hljs-number"><span class="hljs-number">98</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>c:e1:c5:<span class="hljs-number"><span class="hljs-number">5</span></span>b:<span class="hljs-number"><span class="hljs-number">59</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>a:d0:e5:e2: b7:ce:e0:<span class="hljs-number"><span class="hljs-number">75</span></span>:<span class="hljs-number"><span class="hljs-number">74</span></span>:<span class="hljs-number"><span class="hljs-number">93</span></span>:d9:<span class="hljs-number"><span class="hljs-number">35</span></span>:b4:<span class="hljs-number"><span class="hljs-number">8</span></span>b:<span class="hljs-number"><span class="hljs-number">85</span></span>:<span class="hljs-number"><span class="hljs-number">70</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>c:<span class="hljs-number"><span class="hljs-number">8</span></span>e:c9: e0:<span class="hljs-number"><span class="hljs-number">53</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>c:<span class="hljs-number"><span class="hljs-number">2</span></span>f:<span class="hljs-number"><span class="hljs-number">9</span></span>f:<span class="hljs-number"><span class="hljs-number">4</span></span>b:e1:<span class="hljs-number"><span class="hljs-number">48</span></span>:f0:<span class="hljs-number"><span class="hljs-number">3</span></span>f:a5:<span class="hljs-number"><span class="hljs-number">70</span></span>:f7:<span class="hljs-number"><span class="hljs-number">4</span></span>e:<span class="hljs-number"><span class="hljs-number">99</span></span>: f1:<span class="hljs-number"><span class="hljs-number">74</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>b:<span class="hljs-number"><span class="hljs-number">2</span></span>a:<span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>a:<span class="hljs-number"><span class="hljs-number">9</span></span>d:<span class="hljs-number"><span class="hljs-number">9</span></span>f:<span class="hljs-number"><span class="hljs-number">20</span></span>:f4:e5:fa:<span class="hljs-number"><span class="hljs-number">94</span></span>:<span class="hljs-number"><span class="hljs-number">89</span></span>:<span class="hljs-number"><span class="hljs-number">43</span></span>: <span class="hljs-number"><span class="hljs-number">61</span></span>:<span class="hljs-number"><span class="hljs-number">82</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>b:c1:<span class="hljs-number"><span class="hljs-number">98</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>a:e3:<span class="hljs-number"><span class="hljs-number">7</span></span>c:<span class="hljs-number"><span class="hljs-number">4</span></span>e:cf:<span class="hljs-number"><span class="hljs-number">8</span></span>b:<span class="hljs-number"><span class="hljs-number">6</span></span>c:ad:<span class="hljs-number"><span class="hljs-number">6</span></span>b:ce: <span class="hljs-number"><span class="hljs-number">1</span></span>b:<span class="hljs-number"><span class="hljs-number">0</span></span>f:<span class="hljs-number"><span class="hljs-number">4</span></span>d:e3:db:d4:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>c:e8:<span class="hljs-number"><span class="hljs-number">77</span></span>:aa:<span class="hljs-number"><span class="hljs-number">71</span></span>:ea:<span class="hljs-number"><span class="hljs-number">62</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>f: <span class="hljs-number"><span class="hljs-number">17</span></span>:c9:<span class="hljs-number"><span class="hljs-number">3</span></span>b:a3:e2:<span class="hljs-number"><span class="hljs-number">29</span></span>:ce:<span class="hljs-number"><span class="hljs-number">62</span></span>:e2:<span class="hljs-number"><span class="hljs-number">31</span></span>:<span class="hljs-number"><span class="hljs-number">71</span></span>:a8:<span class="hljs-number"><span class="hljs-number">83</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>a:<span class="hljs-number"><span class="hljs-number">41</span></span>: d9:<span class="hljs-number"><span class="hljs-number">6</span></span>b:a7:b8:<span class="hljs-number"><span class="hljs-number">75</span></span>:d0:<span class="hljs-number"><span class="hljs-number">07</span></span>:fc:<span class="hljs-number"><span class="hljs-number">10</span></span>:f1:<span class="hljs-number"><span class="hljs-number">6</span></span>e:<span class="hljs-number"><span class="hljs-number">69</span></span>:<span class="hljs-number"><span class="hljs-number">84</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>b:b1: <span class="hljs-number"><span class="hljs-number">11</span></span>:f8:ae:<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">94</span></span>:<span class="hljs-number"><span class="hljs-number">44</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>d:b0:<span class="hljs-number"><span class="hljs-number">7</span></span>b:<span class="hljs-number"><span class="hljs-number">0</span></span>f:d2:bd:b3:<span class="hljs-number"><span class="hljs-number">1</span></span>d:<span class="hljs-number"><span class="hljs-number">1</span></span>c: <span class="hljs-number"><span class="hljs-number">7</span></span>c:ae:f8:cf:<span class="hljs-number"><span class="hljs-number">37</span></span>:e2:aa:<span class="hljs-number"><span class="hljs-number">4</span></span>a:d2:de:<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">60</span></span>:<span class="hljs-number"><span class="hljs-number">50</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>:f9: c6:<span class="hljs-number"><span class="hljs-number">65</span></span>:f0:<span class="hljs-number"><span class="hljs-number">9</span></span>c:<span class="hljs-number"><span class="hljs-number">63</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>f:<span class="hljs-number"><span class="hljs-number">53</span></span>:eb:db:<span class="hljs-number"><span class="hljs-number">59</span></span>:a4:<span class="hljs-number"><span class="hljs-number">93</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span>:b2:<span class="hljs-number"><span class="hljs-number">6</span></span>f: aa:b3:fb:<span class="hljs-number"><span class="hljs-number">50</span></span>:ae:<span class="hljs-number"><span class="hljs-number">6</span></span>e:e4:b9:<span class="hljs-number"><span class="hljs-number">3</span></span>f:fa:<span class="hljs-number"><span class="hljs-number">69</span></span>:b3:<span class="hljs-number"><span class="hljs-number">43</span></span>:<span class="hljs-number"><span class="hljs-number">32</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>f: <span class="hljs-number"><span class="hljs-number">7</span></span>a:<span class="hljs-number"><span class="hljs-number">4</span></span>b:<span class="hljs-number"><span class="hljs-number">57</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>d:<span class="hljs-number"><span class="hljs-number">7</span></span>e:c8:<span class="hljs-number"><span class="hljs-number">41</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:f8:<span class="hljs-number"><span class="hljs-number">68</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>a:<span class="hljs-number"><span class="hljs-number">43</span></span>:<span class="hljs-number"><span class="hljs-number">53</span></span>:<span class="hljs-number"><span class="hljs-number">83</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>c:c3 Exponent: <span class="hljs-number"><span class="hljs-number">65537</span></span> (<span class="hljs-number"><span class="hljs-number">0x10001</span></span>) X509v3 extensions: X509v3 Basic Constraints: critical CA:FALSE X509v3 Extended Key Usage: TLS Web Server Authentication, TLS Web Client Authentication X509v3 Key Usage: critical Digital Signature, Key Encipherment X509v3 Subject Alternative Name: DNS:*.vk.com, DNS:vk.com X509v3 Subject Key Identifier: <span class="hljs-number"><span class="hljs-number">18</span></span>:<span class="hljs-number"><span class="hljs-number">91</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>E:<span class="hljs-number"><span class="hljs-number">8</span></span>A:<span class="hljs-number"><span class="hljs-number">5</span></span>A:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>D:AB:<span class="hljs-number"><span class="hljs-number">86</span></span>:<span class="hljs-number"><span class="hljs-number">73</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>D:C0:<span class="hljs-number"><span class="hljs-number">06</span></span>:<span class="hljs-number"><span class="hljs-number">57</span></span>:C2:<span class="hljs-number"><span class="hljs-number">6</span></span>C:<span class="hljs-number"><span class="hljs-number">62</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>E:<span class="hljs-number"><span class="hljs-number">5</span></span>C:<span class="hljs-number"><span class="hljs-number">64</span></span> Signature Algorithm: sha256WithRSAEncryption <span class="hljs-number"><span class="hljs-number">8</span></span>d:bc:a8:ce:af:<span class="hljs-number"><span class="hljs-number">5</span></span>d:<span class="hljs-number"><span class="hljs-number">39</span></span>:fc:<span class="hljs-number"><span class="hljs-number">6</span></span>a:ac:<span class="hljs-number"><span class="hljs-number">48</span></span>:<span class="hljs-number"><span class="hljs-number">39</span></span>:<span class="hljs-number"><span class="hljs-number">9</span></span>a:<span class="hljs-number"><span class="hljs-number">7</span></span>e:<span class="hljs-number"><span class="hljs-number">32</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>:<span class="hljs-number"><span class="hljs-number">68</span></span>: de:<span class="hljs-number"><span class="hljs-number">95</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>c:<span class="hljs-number"><span class="hljs-number">4</span></span>b:<span class="hljs-number"><span class="hljs-number">24</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>a:<span class="hljs-number"><span class="hljs-number">51</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>d:d2:<span class="hljs-number"><span class="hljs-number">90</span></span>:e4:<span class="hljs-number"><span class="hljs-number">22</span></span>:c1:<span class="hljs-number"><span class="hljs-number">55</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>e:<span class="hljs-number"><span class="hljs-number">65</span></span>:ea:<span class="hljs-number"><span class="hljs-number">4</span></span>f: <span class="hljs-number"><span class="hljs-number">59</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>c:<span class="hljs-number"><span class="hljs-number">76</span></span>:b0:<span class="hljs-number"><span class="hljs-number">48</span></span>:<span class="hljs-number"><span class="hljs-number">53</span></span>:d8:<span class="hljs-number"><span class="hljs-number">6</span></span>e:c6:e3:<span class="hljs-number"><span class="hljs-number">2</span></span>a:cb:<span class="hljs-number"><span class="hljs-number">26</span></span>:e6:<span class="hljs-number"><span class="hljs-number">40</span></span>:e3:<span class="hljs-number"><span class="hljs-number">9</span></span>a:<span class="hljs-number"><span class="hljs-number">36</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>c:<span class="hljs-number"><span class="hljs-number">6</span></span>b:<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">52</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>c:b5:<span class="hljs-number"><span class="hljs-number">83</span></span>:c6:<span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>e:cb:f8:<span class="hljs-number"><span class="hljs-number">6</span></span>d:a9:ae:d7:<span class="hljs-number"><span class="hljs-number">71</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>b: <span class="hljs-number"><span class="hljs-number">92</span></span>:<span class="hljs-number"><span class="hljs-number">69</span></span>:<span class="hljs-number"><span class="hljs-number">99</span></span>:c0:<span class="hljs-number"><span class="hljs-number">1</span></span>e:de:<span class="hljs-number"><span class="hljs-number">2</span></span>f:<span class="hljs-number"><span class="hljs-number">02</span></span>:<span class="hljs-number"><span class="hljs-number">82</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span>:d6:<span class="hljs-number"><span class="hljs-number">1</span></span>d:<span class="hljs-number"><span class="hljs-number">52</span></span>:<span class="hljs-number"><span class="hljs-number">35</span></span>:<span class="hljs-number"><span class="hljs-number">65</span></span>:f7:ca:a7: <span class="hljs-number"><span class="hljs-number">9</span></span>c:fe:e6:<span class="hljs-number"><span class="hljs-number">1</span></span>f:<span class="hljs-number"><span class="hljs-number">3</span></span>b:a4:<span class="hljs-number"><span class="hljs-number">36</span></span>:c2:<span class="hljs-number"><span class="hljs-number">4</span></span>a:<span class="hljs-number"><span class="hljs-number">4</span></span>e:e2:f2:<span class="hljs-number"><span class="hljs-number">7</span></span>d:<span class="hljs-number"><span class="hljs-number">66</span></span>:e1:c4:ea:e9: ca:d0:a9:<span class="hljs-number"><span class="hljs-number">76</span></span>:fc:<span class="hljs-number"><span class="hljs-number">84</span></span>:f1:<span class="hljs-number"><span class="hljs-number">55</span></span>:e7:d8:<span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">45</span></span>:<span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">9</span></span>a:<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>d:<span class="hljs-number"><span class="hljs-number">23</span></span>:c9: e1:<span class="hljs-number"><span class="hljs-number">0</span></span>a:b0:<span class="hljs-number"><span class="hljs-number">9</span></span>e:cb:<span class="hljs-number"><span class="hljs-number">3</span></span>b:c0:<span class="hljs-number"><span class="hljs-number">86</span></span>:d3:e4:<span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>e:c5:<span class="hljs-number"><span class="hljs-number">8</span></span>a:<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">96</span></span>:ac: <span class="hljs-number"><span class="hljs-number">6</span></span>d:d8:<span class="hljs-number"><span class="hljs-number">79</span></span>:ea:b9:<span class="hljs-number"><span class="hljs-number">83</span></span>:b9:a7:fe:<span class="hljs-number"><span class="hljs-number">79</span></span>:<span class="hljs-number"><span class="hljs-number">67</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>d:<span class="hljs-number"><span class="hljs-number">7</span></span>d:<span class="hljs-number"><span class="hljs-number">1</span></span>f:<span class="hljs-number"><span class="hljs-number">22</span></span>:eb:<span class="hljs-number"><span class="hljs-number">20</span></span>: b9:<span class="hljs-number"><span class="hljs-number">6</span></span>c:<span class="hljs-number"><span class="hljs-number">06</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span>:cb:fb:<span class="hljs-number"><span class="hljs-number">17</span></span>:a7:b3:fc:<span class="hljs-number"><span class="hljs-number">5</span></span>a:<span class="hljs-number"><span class="hljs-number">2</span></span>c:a2:<span class="hljs-number"><span class="hljs-number">4</span></span>f:<span class="hljs-number"><span class="hljs-number">86</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>a:<span class="hljs-number"><span class="hljs-number">80</span></span>:<span class="hljs-number"><span class="hljs-number">53</span></span>: ea:f2:<span class="hljs-number"><span class="hljs-number">71</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>a:<span class="hljs-number"><span class="hljs-number">36</span></span>:<span class="hljs-number"><span class="hljs-number">80</span></span>:a3:fb:<span class="hljs-number"><span class="hljs-number">2</span></span>e:<span class="hljs-number"><span class="hljs-number">42</span></span>:<span class="hljs-number"><span class="hljs-number">76</span></span>:c6:f8:<span class="hljs-number"><span class="hljs-number">68</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>c:<span class="hljs-number"><span class="hljs-number">78</span></span>:f0:<span class="hljs-number"><span class="hljs-number">5</span></span>c: <span class="hljs-number"><span class="hljs-number">5</span></span>d:cd:c4:<span class="hljs-number"><span class="hljs-number">0</span></span>a:<span class="hljs-number"><span class="hljs-number">05</span></span>:<span class="hljs-number"><span class="hljs-number">29</span></span>:a3:c5:a7:<span class="hljs-number"><span class="hljs-number">87</span></span>:c4:<span class="hljs-number"><span class="hljs-number">87</span></span>:af:<span class="hljs-number"><span class="hljs-number">5</span></span>c:<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span>:a1:<span class="hljs-number"><span class="hljs-number">8</span></span>e: <span class="hljs-number"><span class="hljs-number">94</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>f:<span class="hljs-number"><span class="hljs-number">72</span></span>:<span class="hljs-number"><span class="hljs-number">89</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span>:c4:<span class="hljs-number"><span class="hljs-number">76</span></span>:cb:<span class="hljs-number"><span class="hljs-number">0</span></span>b:<span class="hljs-number"><span class="hljs-number">87</span></span>:f9:<span class="hljs-number"><span class="hljs-number">29</span></span>:a1:<span class="hljs-number"><span class="hljs-number">18</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>e:<span class="hljs-number"><span class="hljs-number">55</span></span>:<span class="hljs-number"><span class="hljs-number">97</span></span>:e2: <span class="hljs-number"><span class="hljs-number">1</span></span>f:<span class="hljs-number"><span class="hljs-number">86</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>e:<span class="hljs-number"><span class="hljs-number">97</span></span>:ca:<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">40</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>e:d4:<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">25</span></span>:eb:<span class="hljs-number"><span class="hljs-number">1</span></span>c:<span class="hljs-number"><span class="hljs-number">5</span></span>a:<span class="hljs-number"><span class="hljs-number">2</span></span>e:b9:<span class="hljs-number"><span class="hljs-number">3</span></span>d:e6: bb:<span class="hljs-number"><span class="hljs-number">5</span></span>e:<span class="hljs-number"><span class="hljs-number">4</span></span>d:<span class="hljs-number"><span class="hljs-number">18</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">But the real certificate</b> <div class="spoiler_text"><pre> <code class="python hljs">Certificate: Data: Version: <span class="hljs-number"><span class="hljs-number">3</span></span> (<span class="hljs-number"><span class="hljs-number">0x2</span></span>) Serial Number: <span class="hljs-number"><span class="hljs-number">7817290772096849405</span></span> (<span class="hljs-number"><span class="hljs-number">0x6c7c988a18c595fd</span></span>) Signature Algorithm: sha256WithRSAEncryption Issuer: C=US, ST=Arizona, L=Scottsdale, O=GoDaddy.com, Inc., OU=http://certs.godaddy.com/repository/, CN=Go Daddy Secure Certificate Authority - G2 Validity Not Before: Sep <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span> <span class="hljs-number"><span class="hljs-number">2015</span></span> GMT Not After : Sep <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span>:<span class="hljs-number"><span class="hljs-number">55</span></span> <span class="hljs-number"><span class="hljs-number">2018</span></span> GMT Subject: OU=Domain Control Validated, CN=*.vk.com Subject Public Key Info: Public Key Algorithm: rsaEncryption Public-Key: (<span class="hljs-number"><span class="hljs-number">2048</span></span> bit) Modulus: <span class="hljs-number"><span class="hljs-number">00</span></span>:db:c0:ab:<span class="hljs-number"><span class="hljs-number">97</span></span>:<span class="hljs-number"><span class="hljs-number">82</span></span>:f1:<span class="hljs-number"><span class="hljs-number">70</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>f:d9:<span class="hljs-number"><span class="hljs-number">9</span></span>d:<span class="hljs-number"><span class="hljs-number">79</span></span>:<span class="hljs-number"><span class="hljs-number">85</span></span>:a8: <span class="hljs-number"><span class="hljs-number">7</span></span>c:<span class="hljs-number"><span class="hljs-number">11</span></span>:d2:<span class="hljs-number"><span class="hljs-number">17</span></span>:c5:<span class="hljs-number"><span class="hljs-number">9</span></span>a:<span class="hljs-number"><span class="hljs-number">61</span></span>:b1:<span class="hljs-number"><span class="hljs-number">72</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>:d7:<span class="hljs-number"><span class="hljs-number">5</span></span>e:<span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>f:<span class="hljs-number"><span class="hljs-number">3</span></span>d: <span class="hljs-number"><span class="hljs-number">3</span></span>b:c2:cd:dd:f4:d8:<span class="hljs-number"><span class="hljs-number">62</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>a:<span class="hljs-number"><span class="hljs-number">7</span></span>b:<span class="hljs-number"><span class="hljs-number">23</span></span>:b7:cb:<span class="hljs-number"><span class="hljs-number">08</span></span>:<span class="hljs-number"><span class="hljs-number">70</span></span>:db: bf:e8:<span class="hljs-number"><span class="hljs-number">85</span></span>:f7:<span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">92</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>c:bc:e4:f8:cd:<span class="hljs-number"><span class="hljs-number">81</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>: <span class="hljs-number"><span class="hljs-number">82</span></span>:<span class="hljs-number"><span class="hljs-number">43</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>d:<span class="hljs-number"><span class="hljs-number">37</span></span>:b9:f1:<span class="hljs-number"><span class="hljs-number">6</span></span>a:<span class="hljs-number"><span class="hljs-number">14</span></span>:ac:<span class="hljs-number"><span class="hljs-number">68</span></span>:fa:a4:ef:fd:<span class="hljs-number"><span class="hljs-number">5</span></span>b: <span class="hljs-number"><span class="hljs-number">99</span></span>:ad:f1:df:<span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>a:e2:<span class="hljs-number"><span class="hljs-number">8</span></span>a:<span class="hljs-number"><span class="hljs-number">7</span></span>e:<span class="hljs-number"><span class="hljs-number">80</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>a:<span class="hljs-number"><span class="hljs-number">27</span></span>:b3:<span class="hljs-number"><span class="hljs-number">60</span></span>: <span class="hljs-number"><span class="hljs-number">71</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>d:dd:<span class="hljs-number"><span class="hljs-number">37</span></span>:d2:df:<span class="hljs-number"><span class="hljs-number">2</span></span>d:<span class="hljs-number"><span class="hljs-number">22</span></span>:fe:f3:cb:cf:<span class="hljs-number"><span class="hljs-number">68</span></span>:<span class="hljs-number"><span class="hljs-number">62</span></span>: <span class="hljs-number"><span class="hljs-number">65</span></span>:d4:ff:<span class="hljs-number"><span class="hljs-number">88</span></span>:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>a:<span class="hljs-number"><span class="hljs-number">78</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>d:bf:<span class="hljs-number"><span class="hljs-number">8</span></span>f:<span class="hljs-number"><span class="hljs-number">8</span></span>f:<span class="hljs-number"><span class="hljs-number">0</span></span>d:<span class="hljs-number"><span class="hljs-number">06</span></span>:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>a: b0:<span class="hljs-number"><span class="hljs-number">84</span></span>:f0:a4:ea:<span class="hljs-number"><span class="hljs-number">9</span></span>e:<span class="hljs-number"><span class="hljs-number">69</span></span>:<span class="hljs-number"><span class="hljs-number">59</span></span>:<span class="hljs-number"><span class="hljs-number">97</span></span>:e5:<span class="hljs-number"><span class="hljs-number">03</span></span>:a9:<span class="hljs-number"><span class="hljs-number">36</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>e:<span class="hljs-number"><span class="hljs-number">93</span></span>: e6:<span class="hljs-number"><span class="hljs-number">2</span></span>e:<span class="hljs-number"><span class="hljs-number">4</span></span>e:d6:<span class="hljs-number"><span class="hljs-number">2</span></span>a:bd:ea:bc:<span class="hljs-number"><span class="hljs-number">64</span></span>:b8:<span class="hljs-number"><span class="hljs-number">9</span></span>c:<span class="hljs-number"><span class="hljs-number">7</span></span>d:a3:<span class="hljs-number"><span class="hljs-number">5</span></span>e:c4: ce:<span class="hljs-number"><span class="hljs-number">1</span></span>c:<span class="hljs-number"><span class="hljs-number">74</span></span>:<span class="hljs-number"><span class="hljs-number">82</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>d:<span class="hljs-number"><span class="hljs-number">95</span></span>:bc:<span class="hljs-number"><span class="hljs-number">00</span></span>:a0:<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>e:d1:<span class="hljs-number"><span class="hljs-number">3</span></span>f:<span class="hljs-number"><span class="hljs-number">2</span></span>a:<span class="hljs-number"><span class="hljs-number">18</span></span>: <span class="hljs-number"><span class="hljs-number">7</span></span>c:<span class="hljs-number"><span class="hljs-number">49</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>c:af:<span class="hljs-number"><span class="hljs-number">6</span></span>a:<span class="hljs-number"><span class="hljs-number">41</span></span>:<span class="hljs-number"><span class="hljs-number">61</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>b:<span class="hljs-number"><span class="hljs-number">99</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>d:af:<span class="hljs-number"><span class="hljs-number">95</span></span>:f4:<span class="hljs-number"><span class="hljs-number">77</span></span>:c6: e0:<span class="hljs-number"><span class="hljs-number">4</span></span>e:<span class="hljs-number"><span class="hljs-number">60</span></span>:aa:<span class="hljs-number"><span class="hljs-number">96</span></span>:<span class="hljs-number"><span class="hljs-number">63</span></span>:ee:<span class="hljs-number"><span class="hljs-number">68</span></span>:<span class="hljs-number"><span class="hljs-number">96</span></span>:<span class="hljs-number"><span class="hljs-number">63</span></span>:<span class="hljs-number"><span class="hljs-number">33</span></span>:fc:<span class="hljs-number"><span class="hljs-number">81</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span>:e5: <span class="hljs-number"><span class="hljs-number">2</span></span>c:<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>f:<span class="hljs-number"><span class="hljs-number">1</span></span>d:<span class="hljs-number"><span class="hljs-number">39</span></span>:f8:<span class="hljs-number"><span class="hljs-number">00</span></span>:ac:<span class="hljs-number"><span class="hljs-number">05</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span>:f2:<span class="hljs-number"><span class="hljs-number">80</span></span>:dd:<span class="hljs-number"><span class="hljs-number">96</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>d:<span class="hljs-number"><span class="hljs-number">42</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>b:d5:c9:f7:<span class="hljs-number"><span class="hljs-number">26</span></span>:<span class="hljs-number"><span class="hljs-number">08</span></span>:<span class="hljs-number"><span class="hljs-number">67</span></span>:<span class="hljs-number"><span class="hljs-number">68</span></span>:f8:<span class="hljs-number"><span class="hljs-number">15</span></span>:e4:<span class="hljs-number"><span class="hljs-number">25</span></span>:<span class="hljs-number"><span class="hljs-number">43</span></span>: cd:e1:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>c:<span class="hljs-number"><span class="hljs-number">5</span></span>c:ab:<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>:d8:<span class="hljs-number"><span class="hljs-number">30</span></span>:f1:<span class="hljs-number"><span class="hljs-number">89</span></span>:b7:<span class="hljs-number"><span class="hljs-number">83</span></span>:<span class="hljs-number"><span class="hljs-number">92</span></span>: fd:<span class="hljs-number"><span class="hljs-number">15</span></span>:ad:b6:<span class="hljs-number"><span class="hljs-number">5</span></span>b:e4:<span class="hljs-number"><span class="hljs-number">5</span></span>c:b2:fa:<span class="hljs-number"><span class="hljs-number">7</span></span>d:d1:b2:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">43</span></span>:<span class="hljs-number"><span class="hljs-number">39</span></span>: d9:a3 Exponent: <span class="hljs-number"><span class="hljs-number">65537</span></span> (<span class="hljs-number"><span class="hljs-number">0x10001</span></span>) X509v3 extensions: X509v3 Basic Constraints: critical CA:FALSE X509v3 Extended Key Usage: TLS Web Server Authentication, TLS Web Client Authentication X509v3 Key Usage: critical Digital Signature, Key Encipherment X509v3 CRL Distribution Points: Full Name: URI:http://crl.godaddy.com/gdig2s1<span class="hljs-number"><span class="hljs-number">-118.</span></span>crl X509v3 Certificate Policies: Policy: <span class="hljs-number"><span class="hljs-number">2.16</span></span><span class="hljs-number"><span class="hljs-number">.840</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.114413</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.23</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> CPS: http://certificates.godaddy.com/repository/ Authority Information Access: OCSP - URI:http://ocsp.godaddy.com/ CA Issuers - URI:http://certificates.godaddy.com/repository/gdig2.crt X509v3 Authority Key Identifier: keyid:<span class="hljs-number"><span class="hljs-number">40</span></span>:C2:BD:<span class="hljs-number"><span class="hljs-number">27</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>E:CC:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">83</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span>:A2:<span class="hljs-number"><span class="hljs-number">33</span></span>:D7:FB:<span class="hljs-number"><span class="hljs-number">6</span></span>C:B3:F0:B4:<span class="hljs-number"><span class="hljs-number">2</span></span>C:<span class="hljs-number"><span class="hljs-number">80</span></span>:CE X509v3 Subject Alternative Name: DNS:*.vk.com, DNS:vk.com X509v3 Subject Key Identifier: <span class="hljs-number"><span class="hljs-number">18</span></span>:<span class="hljs-number"><span class="hljs-number">91</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>E:<span class="hljs-number"><span class="hljs-number">8</span></span>A:<span class="hljs-number"><span class="hljs-number">5</span></span>A:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>D:AB:<span class="hljs-number"><span class="hljs-number">86</span></span>:<span class="hljs-number"><span class="hljs-number">73</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>D:C0:<span class="hljs-number"><span class="hljs-number">06</span></span>:<span class="hljs-number"><span class="hljs-number">57</span></span>:C2:<span class="hljs-number"><span class="hljs-number">6</span></span>C:<span class="hljs-number"><span class="hljs-number">62</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>E:<span class="hljs-number"><span class="hljs-number">5</span></span>C:<span class="hljs-number"><span class="hljs-number">64</span></span> Signature Algorithm: sha256WithRSAEncryption <span class="hljs-number"><span class="hljs-number">80</span></span>:<span class="hljs-number"><span class="hljs-number">61</span></span>:fc:da:a9:f2:ea:f3:<span class="hljs-number"><span class="hljs-number">4</span></span>a:<span class="hljs-number"><span class="hljs-number">70</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>e:<span class="hljs-number"><span class="hljs-number">8</span></span>a:<span class="hljs-number"><span class="hljs-number">39</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>e:eb:<span class="hljs-number"><span class="hljs-number">9</span></span>b:<span class="hljs-number"><span class="hljs-number">77</span></span>:c2: c9:<span class="hljs-number"><span class="hljs-number">5</span></span>d:da:<span class="hljs-number"><span class="hljs-number">30</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>a:<span class="hljs-number"><span class="hljs-number">31</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>f:<span class="hljs-number"><span class="hljs-number">19</span></span>:f8:<span class="hljs-number"><span class="hljs-number">2</span></span>f:b5:<span class="hljs-number"><span class="hljs-number">1</span></span>b:<span class="hljs-number"><span class="hljs-number">4</span></span>a:<span class="hljs-number"><span class="hljs-number">87</span></span>:<span class="hljs-number"><span class="hljs-number">74</span></span>:fb:<span class="hljs-number"><span class="hljs-number">99</span></span>: <span class="hljs-number"><span class="hljs-number">59</span></span>:<span class="hljs-number"><span class="hljs-number">78</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>f:<span class="hljs-number"><span class="hljs-number">45</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>b:<span class="hljs-number"><span class="hljs-number">9</span></span>d:<span class="hljs-number"><span class="hljs-number">9</span></span>d:<span class="hljs-number"><span class="hljs-number">76</span></span>:<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>f:<span class="hljs-number"><span class="hljs-number">48</span></span>:<span class="hljs-number"><span class="hljs-number">90</span></span>:<span class="hljs-number"><span class="hljs-number">08</span></span>:a5:f8:c8:<span class="hljs-number"><span class="hljs-number">2</span></span>e:<span class="hljs-number"><span class="hljs-number">9</span></span>f: <span class="hljs-number"><span class="hljs-number">55</span></span>:ea:<span class="hljs-number"><span class="hljs-number">54</span></span>:<span class="hljs-number"><span class="hljs-number">33</span></span>:c1:a1:a3:<span class="hljs-number"><span class="hljs-number">7</span></span>e:<span class="hljs-number"><span class="hljs-number">7</span></span>f:<span class="hljs-number"><span class="hljs-number">8</span></span>c:<span class="hljs-number"><span class="hljs-number">32</span></span>:c5:a8:<span class="hljs-number"><span class="hljs-number">0</span></span>f:<span class="hljs-number"><span class="hljs-number">9</span></span>b:<span class="hljs-number"><span class="hljs-number">04</span></span>:c7:d1: <span class="hljs-number"><span class="hljs-number">55</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>e:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">87</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>e:<span class="hljs-number"><span class="hljs-number">88</span></span>:<span class="hljs-number"><span class="hljs-number">82</span></span>:<span class="hljs-number"><span class="hljs-number">32</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>a:cb:<span class="hljs-number"><span class="hljs-number">0</span></span>c:<span class="hljs-number"><span class="hljs-number">66</span></span>:f0:<span class="hljs-number"><span class="hljs-number">50</span></span>:<span class="hljs-number"><span class="hljs-number">85</span></span>:b2: e4:<span class="hljs-number"><span class="hljs-number">43</span></span>:<span class="hljs-number"><span class="hljs-number">67</span></span>:<span class="hljs-number"><span class="hljs-number">38</span></span>:<span class="hljs-number"><span class="hljs-number">88</span></span>:<span class="hljs-number"><span class="hljs-number">50</span></span>:<span class="hljs-number"><span class="hljs-number">84</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span>:<span class="hljs-number"><span class="hljs-number">41</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>b:bc:<span class="hljs-number"><span class="hljs-number">3</span></span>e:b0:<span class="hljs-number"><span class="hljs-number">47</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>f:<span class="hljs-number"><span class="hljs-number">71</span></span>:<span class="hljs-number"><span class="hljs-number">46</span></span>:e4: <span class="hljs-number"><span class="hljs-number">9</span></span>a:cf:f1:a4:<span class="hljs-number"><span class="hljs-number">39</span></span>:a9:<span class="hljs-number"><span class="hljs-number">4</span></span>b:ca:<span class="hljs-number"><span class="hljs-number">63</span></span>:<span class="hljs-number"><span class="hljs-number">44</span></span>:c3:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>d:<span class="hljs-number"><span class="hljs-number">7</span></span>b:ca:de:<span class="hljs-number"><span class="hljs-number">6</span></span>c:<span class="hljs-number"><span class="hljs-number">91</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>b:<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>:b3:<span class="hljs-number"><span class="hljs-number">4</span></span>c:<span class="hljs-number"><span class="hljs-number">56</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>d:<span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>b:dc:c5:d1:e5:a3:<span class="hljs-number"><span class="hljs-number">9</span></span>f:d2: <span class="hljs-number"><span class="hljs-number">4</span></span>d:be:d2:ff:<span class="hljs-number"><span class="hljs-number">62</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>a:<span class="hljs-number"><span class="hljs-number">75</span></span>:f7:<span class="hljs-number"><span class="hljs-number">4</span></span>f:<span class="hljs-number"><span class="hljs-number">29</span></span>:a4:<span class="hljs-number"><span class="hljs-number">7</span></span>d:<span class="hljs-number"><span class="hljs-number">35</span></span>:cf:<span class="hljs-number"><span class="hljs-number">33</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>:<span class="hljs-number"><span class="hljs-number">83</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>a: <span class="hljs-number"><span class="hljs-number">50</span></span>:f6:<span class="hljs-number"><span class="hljs-number">25</span></span>:ce:a7:<span class="hljs-number"><span class="hljs-number">59</span></span>:ac:<span class="hljs-number"><span class="hljs-number">05</span></span>:fe:<span class="hljs-number"><span class="hljs-number">74</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>b:c7:<span class="hljs-number"><span class="hljs-number">89</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>:f5:a8:<span class="hljs-number"><span class="hljs-number">2</span></span>e:<span class="hljs-number"><span class="hljs-number">4</span></span>e: d4:<span class="hljs-number"><span class="hljs-number">34</span></span>:a1:e1:<span class="hljs-number"><span class="hljs-number">68</span></span>:<span class="hljs-number"><span class="hljs-number">7</span></span>b:<span class="hljs-number"><span class="hljs-number">66</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>b:<span class="hljs-number"><span class="hljs-number">53</span></span>:a8:<span class="hljs-number"><span class="hljs-number">41</span></span>:ba:a7:<span class="hljs-number"><span class="hljs-number">50</span></span>:<span class="hljs-number"><span class="hljs-number">72</span></span>:<span class="hljs-number"><span class="hljs-number">49</span></span>:<span class="hljs-number"><span class="hljs-number">94</span></span>:e6: <span class="hljs-number"><span class="hljs-number">4</span></span>a:ad:<span class="hljs-number"><span class="hljs-number">2</span></span>d:<span class="hljs-number"><span class="hljs-number">26</span></span>:<span class="hljs-number"><span class="hljs-number">95</span></span>:a3:<span class="hljs-number"><span class="hljs-number">5</span></span>d:ce:e3:<span class="hljs-number"><span class="hljs-number">8</span></span>b:d9:<span class="hljs-number"><span class="hljs-number">6</span></span>c:d2:<span class="hljs-number"><span class="hljs-number">1</span></span>e:<span class="hljs-number"><span class="hljs-number">31</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>b:<span class="hljs-number"><span class="hljs-number">28</span></span>:ab: e2:<span class="hljs-number"><span class="hljs-number">33</span></span>:c5:<span class="hljs-number"><span class="hljs-number">5</span></span>e:<span class="hljs-number"><span class="hljs-number">3</span></span>f:<span class="hljs-number"><span class="hljs-number">82</span></span>:dd:e1:e8:<span class="hljs-number"><span class="hljs-number">36</span></span>:a2:b5:<span class="hljs-number"><span class="hljs-number">08</span></span>:d8:b3:<span class="hljs-number"><span class="hljs-number">2</span></span>e:<span class="hljs-number"><span class="hljs-number">23</span></span>:b4: <span class="hljs-number"><span class="hljs-number">9</span></span>b:b4:e6:<span class="hljs-number"><span class="hljs-number">4</span></span>a:ab:<span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>d:<span class="hljs-number"><span class="hljs-number">6</span></span>b:aa:<span class="hljs-number"><span class="hljs-number">5</span></span>f:fd:<span class="hljs-number"><span class="hljs-number">56</span></span>:<span class="hljs-number"><span class="hljs-number">31</span></span>:dc:<span class="hljs-number"><span class="hljs-number">86</span></span>:<span class="hljs-number"><span class="hljs-number">32</span></span>:<span class="hljs-number"><span class="hljs-number">85</span></span>:<span class="hljs-number"><span class="hljs-number">04</span></span>: <span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>a:b9:<span class="hljs-number"><span class="hljs-number">64</span></span></code> </pre> </div></div><br>  <b>The last thing I wanted to point out is that</b> vFTD uses the same key pair to generate any certificate that has been replaced.  What is actually logical: why waste resources already loaded with encryption / decryption of the device to generate new key pairs.  If you open the page ya.ru and view the received certificate, we see that the public key will be the same as that of the replaced certificate for vk.com. <br><br><img src="https://habrastorage.org/files/006/fb4/cdb/006fb4cdbcdc443ab7d9cbf1afee8dec.png"><br>  <i>Replaced and real certificate</i> <br><br>  <b>This concludes the description of the SSL decryption mechanism on the NGFW.</b>  Greetings to everyone awake, we finally did it!  It was painful, but now you know a little more about SSL.  Whether it was worth it or not is at your discretion. <br><br>  <b>PS:</b> And yes, I convey greetings from my colleagues (and join): Happy New Year, everyone!  May the new year have less bugs, crutches and dances with a tambourine! <br><br><img src="https://habrastorage.org/files/b07/0e3/c88/b070e3c885614555b1b7dfa0c8d9bfd0.png"><br><br>  <b>PPS:</b> For those who are interested in how this kitchen is tuned to FirePOWER - velkam in the tackle. <br><br><div class="spoiler">  <b class="spoiler_title">Setting SSL decryption on FMC v6.1.0.1</b> <div class="spoiler_text">  First we prepare SubCA.  We generate a pair of keys (open and closed).  We sign the certificate on the corporate certification authority using the Subordinate certificate authority template.  To do this, you can use the openssl utility.  It is available from the FMC command line.  Example commands for generating CSR: <br><br><pre> <code class="python hljs">openssl rand -out ./private/.rand <span class="hljs-number"><span class="hljs-number">1024</span></span> openssl genrsa -out ./private/cakey.pem -aes256 -rand ./private/.rand <span class="hljs-number"><span class="hljs-number">2048</span></span> openssl req -new -key ./private/cakey.pem -out subcareq.pem -config openssl.cnf -sha256</code> </pre> <br><br>  After we receive the signed certificate, we install it on the FMC.  Go to the tab Objects -&gt; Object Management -&gt; PKI -&gt; Internal CAs and click on Import CA: <br><br><img src="https://habrastorage.org/files/802/e35/5fd/802e355fd60e4362b7f744fe749fa484.png"><br><br>  You will be prompted to upload the certificate and its private key.  We got them earlier with the help of openssl and corporate CA.  Set the name for the new CA and enter the password of the private key (if necessary): <br><br><img src="https://habrastorage.org/files/30d/0a1/3c8/30d0a13c86474d83863bbd75ab0804af.png"><br><br>  Everything is ready to create a policy of decryption.  Go to Policies -&gt; SSL: <br><br><img src="https://habrastorage.org/files/185/1c5/800/1851c5800c204c7e9740cc756152e330.png"><br><br>  Click "New Policy", set the name of the policy, the default action and, write your Opus Magnum in the description: <br><br><img src="https://habrastorage.org/files/84d/cd1/865/84dcd18658824f238ee4ea58c05adb8e.png"><br><br>  Decryption policies in familiar tablets.  Their fields describe the pattern of traffic to be decrypted: <br><br><img src="https://habrastorage.org/files/e96/08e/db6/e9608edb61b84f4eae4a10d5f44aeea5.png"><br><br>  Click Add Rule and describe the traffic pattern.  In the simplest case, you can make a rule without specifying any parameters.  In this case, any SSL traffic will be decrypted.  As the action, select "Decrypt - Resign".  In the field after the word ‚Äúwith‚Äù we select the certificate loaded in the previous steps.  This is the very SubCA with which we will sign a spoof certificate. <br><br><img src="https://habrastorage.org/files/f6e/cf1/3bf/f6ecf13bf8154d0fa5fe8e55d96e8925.png"><br><br>  As you can see in the screenshot, FMC provides the broadest possibilities for describing the traffic pattern for decryption.  You can select traffic by users, application type, URL category, server certificate settings (DN, Cert Status, Cipher Suite, Version), etc. <br><br>  For example, a screenshot of the Cert Status tab: <br><br><img src="https://habrastorage.org/files/6e6/2cc/110/6e62cc1108c944a0be8312356ac7041a.png"><br><br>  After setting all the necessary rules, click Save.  The decoding policy is ready.  But in order for it to start working, it must be tied to the access policy.  Go to Policies -&gt; Access Control: <br><br><img src="https://habrastorage.org/files/afd/1cf/f76/afd1cff762554fbe9f94333826c0ec36.png"><br><br>  Select the access policy we are interested in and click on the pencil.  In the expanded tab, we need to select the decryption policy created in the previous step: <br><br><img src="https://habrastorage.org/files/459/331/e9c/459331e9cf814432aa0218128f0e3e56.png"><br><img src="https://habrastorage.org/files/87e/30f/66d/87e30f66d43249be81de7209d80aba7a.png"><br><br>  Click Save.  Do not forget to perform deploy changes to a managed device (vFTD in my case): <br><br><img src="https://habrastorage.org/files/d83/d50/045/d83d50045f094c639f7d5a0a4fe421c2.png"><br><img src="https://habrastorage.org/files/c7e/76f/7b3/c7e76f7b32ff410ba9462d694aa9d6cf.png"><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/318592/">https://habr.com/ru/post/318592/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318582/index.html">From backup to backup: the history of IT companies that have lost data</a></li>
<li><a href="../318584/index.html">The simplest audio output using the Audiere library</a></li>
<li><a href="../318586/index.html">Keyc Intouch: Collect Insurance Requests With Native Advertising</a></li>
<li><a href="../318588/index.html">Carrier aggregation in LTE or what to look for when buying the next smartphone</a></li>
<li><a href="../318590/index.html">Helpful Huhi: saving analog cameras</a></li>
<li><a href="../318594/index.html">Simplifying is difficult - to complicate is easy. GUI program for creating deb-packages</a></li>
<li><a href="../318596/index.html">Open Data Council: News from the Fields</a></li>
<li><a href="../318598/index.html">Serious design serious sites. Part 1. Analytics</a></li>
<li><a href="../318600/index.html">8 JavaScript libraries for data visualization in the form of interactive maps</a></li>
<li><a href="../318602/index.html">Translation system (localization) text in the Unreal engine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>