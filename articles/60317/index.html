<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Java serialization</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Serialization is the process of maintaining the state of an object in a sequence of bytes; deserialization is the process of restoring an object from ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Java serialization</h1><div class="post__text post__text-html js-mediator-article">  <i>Serialization</i> is the process of maintaining the state of an object in a sequence of bytes;  <i>deserialization</i> is the process of restoring an object from these bytes.  The Java Serialization API provides a standard mechanism for creating serializable objects.  In this article, you will see how to serialize an object, and why serialization is sometimes necessary.  You will learn about the serialization algorithm used in Java and see an example that illustrates the serialized format of the object.  In the end, you should have a clear idea of ‚Äã‚Äãhow the serialization algorithm works, as well as how parts of the object are represented in serialized form. <br><a name="habracut"></a><br><h2>  Why serialization is needed? </h2><br><br>  In today's world, a typical industrial application will have many components and will be distributed across various systems and networks.  In Java, everything is represented as objects;  If two Java components need to communicate with each other, then they need a mechanism for exchanging data.  There are several ways to implement this mechanism.  The first way is to develop your own protocol and transfer the object.  This means that the recipient must know the protocol used by the sender to recreate the object, which complicates the development of third-party components.  Consequently, there must be a universal and efficient protocol for transferring objects between components.  Serialization is created for this, and Java components use this protocol to transfer objects. <br><br>  Figure 1 demonstrates a high-level view of client-server communication, where an object is passed from client to server through serialization. <br> <a href="http://smages.com/55/1f/551f2d6dc896b509d1cfd4e0a6f6f7a7.gif.htm" title="Smages - free image hosting"><img src="http://smages.com/t/55/1f/551f2d6dc896b509d1cfd4e0a6f6f7a7.jpg"></a> <br>  <b>Picture 1.</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  How to serialize an object? </h2><br><br>  First you need to make sure that the class of the object being serialized implements the <code>java.io.Serializable</code> interface as shown in Listing 1. <br><br>  <b>Listing 1.</b> <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">import java.io.Serializable; <br> <br> <font color="#0000ff">class</font> TestSerial implements Serializable { <br> <font color="#0000ff">public</font> <font color="#0000ff">byte</font> version = 100; <br> <font color="#0000ff">public</font> <font color="#0000ff">byte</font> count = 0; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  In Listing 1, only one thing is different from creating a normal class; this is the implementation of the <code>java.io.Serializable</code> interface.  The <code>Serializable</code> interface is a marker interface;  there is no method declared in it.  But it tells the serializing mechanism that the class can be serialized. <br><br>  Now we have everything we need to serialize the object, the next step is the actual serialization of the object.  It is made by calling the <code>writeObject()</code> method of the <code>java.io.ObjectOutputStream</code> class, as shown in Listing 2. <br><br>  <b>Listing 2.</b> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> main( <font color="#2B91AF">String</font> args[]) throws IOException { <br> FileOutputStream fos = <font color="#0000ff">new</font> FileOutputStream( <font color="#A31515">"temp.out"</font> ); <br> ObjectOutputStream oos = <font color="#0000ff">new</font> ObjectOutputStream(fos); <br> TestSerial ts = <font color="#0000ff">new</font> TestSerial(); <br> oos.writeObject(ts); <br> oos.flush(); <br> oos.close(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Listing 2 shows saving the state of a <code>TestSerial</code> instance to a file called <code>temp.out</code> <br><br>  To recreate an object from a file, you need to apply the code from Listing 3. <br><br>  <b>Listing 3.</b> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> main( <font color="#2B91AF">String</font> args[]) throws IOException { <br> FileInputStream fis = <font color="#0000ff">new</font> FileInputStream( <font color="#A31515">"temp.out"</font> ); <br> ObjectInputStream oin = <font color="#0000ff">new</font> ObjectInputStream(fis); <br> TestSerial ts = (TestSerial) oin.readObject(); <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"version="</font> +ts.version); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The object is restored by calling the <code>oin.readObject()</code> method.  The method reads a set of bytes from the file and creates an exact copy of the graph of the original object.  <code>oin.readObject()</code> can read any serialized object, so you must <code>oin.readObject()</code> resulting object to a specific type. <br>  The executed code will output <code>version=100</code> to standard output. <br><br><h2>  The format of the serialized object </h2><br>  What should a serialized object look like?  Recall the simple code from the previous section that serializes an object of the <code>TestSerial</code> class and writes to <code>temp.out</code> .  Listing 4 shows the contents of the <code>temp.out</code> file, in hexadecimal. <br><br>  <b>Listing 4.</b> <br><blockquote> <code>AC ED 00 05 73 72 00 0A 53 65 72 69 61 6C 54 65 <br> 73 74 A0 0C 34 00 FE B1 DD F9 02 00 02 42 00 05 <br> 63 6F 75 6E 74 42 00 07 76 65 72 73 69 6F 6E 78 <br> 70 00 64 <br></code> </blockquote><br>  If you look at <code>TestSerial</code> again, you will see that it has only 2 byte members.  As shown in Listing 5. <br><br>  <b>Listing 5.</b> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">byte</font> version = 100; <br> <font color="#0000ff">public</font> <font color="#0000ff">byte</font> count = 0;</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The size of a byte variable is one byte, and therefore the full size of the object (without a header) is two bytes.  But the size of the serialized object is 51 bytes.  Surprised?  Where did these extra bytes come from and what do they mean?  They are added by a serialization algorithm and are needed to recreate the object.  The following paragraph will describe this algorithm in detail. <br><br><h2>  Java serialization algorithm </h2><br>  At this point, you should already have enough knowledge to serialize the object.  But how does this mechanism work?  The serialization algorithm does the following things: <br><br><ul><li>  recording class metadata associated with the object </li><li>  recursive writing of the superclass description until <code>java.lang.object</code> is reached </li><li>  after the end of the metadata recording, the recording of the actual data associated with the instance begins, only this time the recording starts from the topmost superclass </li><li>  recursive data entry associated with an instance starting from the lowest superclass </li></ul><br><br>  Listing 6 shows an example covering all possible serialization cases. <br><br>  <b>Listing 6.</b> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> parent implements <font color="#2B91AF">Serializable</font> { <br> <font color="#0000ff">int</font> parentVersion = 10; <br> } <br> <br> <font color="#0000ff">class</font> contain implements <font color="#2B91AF">Serializable</font> { <br> <font color="#0000ff">int</font> containVersion = 11; <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> SerialTest extends parent implements <font color="#2B91AF">Serializable</font> { <br> <font color="#0000ff">int</font> version = 66; <br> contain con = <font color="#0000ff">new</font> contain(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> getVersion() { <br> <font color="#0000ff">return</font> version; <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> main( <font color="#2B91AF">String</font> args[]) throws IOException { <br> FileOutputStream fos = <font color="#0000ff">new</font> FileOutputStream( <font color="#A31515">"temp.out"</font> ); <br> ObjectOutputStream oos = <font color="#0000ff">new</font> ObjectOutputStream(fos); <br> SerialTest st = <font color="#0000ff">new</font> SerialTest(); <br> oos.writeObject(st); <br> oos.flush(); <br> oos.close(); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  In the example, an object of the <code>SerialTest</code> class is <code>SerialTest</code> , which is inherited from <code>parent</code> and contains the container object of the <code>contain</code> class.  Listing 7 shows the serialized object. <br><br>  <b>Listing 7.</b> <br><blockquote> <code>AC ED 00 05 73 72 00 0A 53 65 72 69 61 6C 54 65 <br> 73 74 05 52 81 5A AC 66 02 F6 02 00 02 49 00 07 <br> 76 65 72 73 69 6F 6E 4C 00 03 63 6F 6E 74 00 09 <br> 4C 63 6F 6E 74 61 69 6E 3B 78 72 00 06 70 61 72 <br> 65 6E 74 0E DB D2 BD 85 EE 63 7A 02 00 01 49 00 <br> 0D 70 61 72 65 6E 74 56 65 72 73 69 6F 6E 78 70 <br> 00 00 00 0A 00 00 00 42 73 72 00 07 63 6F 6E 74 <br> 61 69 6E FC BB E6 0E FB CB 60 C7 02 00 01 49 00 <br> 0E 63 6F 6E 74 61 69 6E 56 65 72 73 69 6F 6E 78 <br> 70 00 00 00 0B <br></code> </blockquote><br>  Figure 2 shows the serialization algorithm script. <br> <a href="http://smages.com/" title="Smages - free image hosting"><img src="http://smages.com/i/44/e2/44e284d9957c17ef47dea0acf0b29c29.gif"></a> <br>  <b>Figure 2.</b> <br><br>  Let's take a look at what each byte in a serialized object represents.  At the beginning there is information about the serialization protocol: <br><ul><li>  <code>AC ED: STREAM_MAGIC</code> .  Says that the serialization protocol is used. </li><li>  <code>00 05: STREAM_VERSION</code> .  Serialization version. </li><li>  <code>0x73: TC_OBJECT</code> .  The designation of the new object. </li></ul><br>  In the first step, the serialization algorithm records the description of the class associated with the object.  In the example, an object of the <code>SerialTest</code> class was serialized, hence the algorithm began to record the description of the <code>SerailTest</code> class. <br><ul><li>  <code>0x72: TC_CLASSDESC</code> .  Designation of a new class. </li><li>  <code>00 0A</code> : The length of the class name. </li><li>  <code>53 65 72 69 61 6c 54 65 73 74: SerialTest</code> , class name. </li><li>  <code>05 52 81 5A AC 66 02 F6: SerialVersionUID</code> , class identifier. </li><li>  <code>0x02</code> : Various flags.  This particular flag indicates that the object supports serialization. </li><li>  <code>00 02</code> : The number of fields in the class. </li></ul><br>  Now the algorithm writes the field <code>int version = 66;</code>  . <br><ul><li>  <code>0x49</code> : Field type code.  49 is ‚ÄúI‚Äù, which is assigned to Int. </li><li>  <code>00 07</code> : The length of the field name. </li><li>  <code>76 65 72 73 69 6F 6E: version</code> , field name. </li></ul><br>  Then the algorithm writes the next field, <code>contain con = new contain();</code>  .  This object will therefore be written in the canonical JVM designation of this field. <br><ul><li>  <code>0x74: TC_STRING</code> .  Indicates a new line. </li><li>  <code>00 09</code> : The length of the string. </li><li> <code>4C 63 6F 6E 74 61 69 6E 3B: Lcontain;</code>  , Canonical JVM notation. </li><li>  <code>0x78: TC_ENDBLOCKDATA</code> , End of optional data block for an object. </li></ul><br>  The next step of the algorithm is to write the description of the <code>parent</code> class, which is the immediate superclass for <code>SerialTest</code> . <br><ul><li>  <code>0x72: TC_CLASSDESC</code> .  Designation of a new class. </li><li>  <code>00 06</code> : The length of the class name. </li><li>  <code>70 61 72 65 6E 74: parent</code> , class name </li><li>  <code>0E DB D2 BD 85 EE 63 7A: SerialVersionUID</code> , class identifier. </li><li>  <code>0x02</code> : Various flags.  This flag indicates that the class supports serialization. </li><li>  <code>00 01</code> : The number of fields in the class. </li></ul><br>  Now the algorithm writes the description of the <code>parent</code> class fields, the class has one field, <code>int parentVersion = 100;</code>  . <br><ul><li>  <code>0x49</code> : Field type code.  49 stands for "I", which is assigned to Int. </li><li>  <code>00 0D</code> : The length of the field name. </li><li>  <code>70 61 72 65 6E 74 56 65 72 73 69 6F 6E</code> : parentVersion, field name. </li><li>  <code>0x78: TC_ENDBLOCKDATA</code> , end of optional data block for object. </li><li>  <code>0x70: TC_NULL</code> , means that there are no more superclasses, because we have reached the top of the class hierarchy. </li></ul><br>  Prior to this, the serialization algorithm recorded a description of the classes associated with the object and all its superclasses.  Now the actual data associated with the object will be recorded.  Members of the <code>parent</code> class are written first: <br><ul><li>  <code>00 00 00 0A: 10</code> , The value of <code>parentVersion</code> . </li></ul><br>  Next move to <code>SerialTest</code> <br><ul><li>  <code>00 00 00 42: 66</code> , <code>version</code> value. </li></ul><br>  The next few bytes are very interesting.  The algorithm needs to write information to the object <code>contain</code> class. <br><br>  <b>Listing 8.</b> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">contain con = <font color="#0000ff">new</font> contain();</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The serialization algorithm has not yet recorded the <code>contain</code> class description.  The time has come to do it. <br><ul><li>  <code>0x73: TC_OBJECT</code> , indicates a new object. </li><li>  <code>0x72: TC_CLASSDESC</code> , denotes a new class. </li><li>  <code>00 07</code> : The length of the class name. </li><li>  <code>63 6F 6E 74 61 69 6E: contain</code> , class name. </li><li>  <code>FC BB E6 0E FB CB 60 C7: SerialVersionUID</code> , identifier of this class. </li><li>  <code>0x02</code> : Various flags.  This flag indicates that the class supports serialization. </li><li>  <code>00 01</code> : The number of fields in the class. </li></ul><br>  The algorithm should write the description of the only field of the class <code>conatin, int containVersion = 11;</code>  . <br><ul><li>  <code>0x49</code> : Field type code.  49 stands for "I", which is assigned to Int. </li><li>  <code>00 0E</code> : The length of the field name. </li><li>  <code>63 6F 6E 74 61 69 6E 56 65 72 73 69 6F 6E: containVersion</code> , field name. </li><li>  <code>0x78: TC_ENDBLOCKDATA</code> , end of optional data block for object. </li></ul><br>  Next, the algorithm checks whether <code>contain</code> parent class.  If it does, then the algorithm starts recording this class;  but in our case there is no superclass for <code>contain</code> , and the algorithm writes <code>TC_NULL</code> . <br><ul><li> <code>0x70: TC_NULL</code> </li> </ul><br>  At the end, the algorithm records the actual data associated with the object of the class <code>conatin</code> . <br><ul><li>  <code>00 00 00 0B: 11</code> , the value of <code>containVersion</code> . </li></ul><br><h2>  Conclusion </h2><br>  In this article, you saw how to serialize an object, and learn how the serialization algorithm works.  I hope this article has helped you better understand what happens when you serialize an object. <br><br><h3>  about the author </h3><br>  <a href="">Sathiskumar Palaniappan</a> has more than 4 years of experience in IT industry, and has been working with Java technology for more than 3 years.  He currently runs a system software engineer at the Java Technology Center, IBM Labs.  He also has experience in the telecommunications industry. <br><br><h3>  Links </h3><br>  <a href="http://java.sun.com/j2se/1.4/pdf/serial-spec.pdf">Java object serialization specification</a> .  (Spec is a PDF.) <br>  <a href="http://www.javaworld.com/javaworld/jw-07-2000/jw-0714-flatten.html">"Flatten your objects: Discover the secrets of the Java Serialization API"</a> (Todd M. Greanier, JavaWorld, July 2000). <br>  <a href="http://oreilly.com/catalog/javarmi/chapter/ch10.html">Chapter 10</a> of Java RMI (William Grosso, O'Reilly, October 2001). </div><p>Source: <a href="https://habr.com/ru/post/60317/">https://habr.com/ru/post/60317/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../60308/index.html">Internet history</a></li>
<li><a href="../60311/index.html">Launch Virtual PC 2007 on Windows 7</a></li>
<li><a href="../60312/index.html">Does Google promote AdWords by mail?</a></li>
<li><a href="../60313/index.html">Frequently Asked Questions - 1</a></li>
<li><a href="../60314/index.html">Life cycle of science news</a></li>
<li><a href="../60318/index.html">Firefinder - Quick access to what you want to see.</a></li>
<li><a href="../60319/index.html">Substitution time.windows.com local ntp-server</a></li>
<li><a href="../60324/index.html">What is your specialization in IT?</a></li>
<li><a href="../60325/index.html">Manage VirtualBox using the console</a></li>
<li><a href="../60327/index.html">Installing official Nvidia drivers on Lenovo Thinkpad T61P</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>