<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Office as a platform: how the project Notegram for OneNote is developing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Here is a continuation of the success story of the Notegram project from the first person ‚Äî Dmitry Konev, a project developer who created an interesti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Office as a platform: how the project Notegram for OneNote is developing</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <i><a href="http://notegram.me/">Here is a</a> continuation <a href="https://habrahabr.ru/company/microsoft/blog/270213/">of the success story</a> of the <a href="http://notegram.me/">Notegram</a> project from the first person ‚Äî Dmitry Konev, a project developer who created an interesting project that extends the capabilities of the Office OneNote application.</i>  <i>In the continuation of its history, Dmitry talks about the development of the project and the use of new techniques when developing for Office 365. All articles in the column ‚ÄúOffice as Platform‚Äù you can always find at the link <a href="http://habrahabr.ru/search/%3Fq%3D%255B%2523officeplatform%255D%26target_type%3Dposts">#officeplatform</a> - Vladimir Yunev.</i> </blockquote>  I recently released a second update for my project, Notegram.  Notegram is a web application for Microsoft OneNote that allows you to quickly share templates, without any additions. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/717/c4b/6b8/717c4b6b851f4e5a8c2c6fd0a27b462d.png"></div><br>  The most important detail in this update is the new calendar template, which now allows you to select the year and month.  I also improved the design a bit, and at the time of writing this article I added two more new templates: <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/files/0bc/4f2/fc0/0bc4f2fc0fb5467c85667f96cdb48065.png"></div><br>  In addition, I also made a lot of internal changes, about which I want to tell in this article. <br><br><h3>  Templates </h3><br>  Notegram was born on the hackathon, the first version was written in the hours of the night not yet discovered by science, and at that time I didn‚Äôt understand Node.js at all, so before creating any new functions, I had to make changes to my code. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The original version of Notegram was written based on an <a href="https://github.com/OneNoteDev/OneNoteAPISampleNodejs">open example of using OneNote API</a> , without using any templates, and together with Express I used the Jade engine, which seemed to me rather inconvenient.  I wanted my templates to be in HTML, so the Mozilla Nunjucks engine was chosen. <br><br>  To go, you first had to add the <a href="https://github.com/pkolt/express-nunjucks">express-nunjucks</a> npm package with the engine to the list of dependencies in the <i>package.json</i> file and execute the npm install command. <br><br>  The following code has been added to my app's <i>app.js</i> file: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> nunjucks = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express-nunjucks'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  app.set('views', path.join(__dirname, 'views')); //    'views' app.set('view engine', 'html'); //    Express nunjucks.setup({ autoescape: true, watch: true }, app); // Nunjucks</span></span></code> </pre> <br>  Also, the <i>following</i> code was added to the <i>routes / index.js</i> file: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> router = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>).Router(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> templates = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../lib/notegram-templates'</span></span>); router.get(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> authUrl = liveConnect.getAuthUrl(); res.render(<span class="hljs-string"><span class="hljs-string">'templates'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">templates</span></span>: templates}); });</code> </pre><br>  Then a template was created using the previous code snippet, based on an array in the <i>lib / notegram-templates</i> <i>.js</i> file, creating HTML for each element: <br><br><pre> <code class="html hljs xml">{% extends "base.html" %} {% for item in templates %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"img/{{item.id}}.png"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>{{item.name}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>{{item.description}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"controls"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{item.id}}"</span></span></span><span class="hljs-tag">&gt;</span></span>Save<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %}</code> </pre><br>  This template is very similar to plain HTML from the <a href="http://habrahabr.ru/company/microsoft/blog/270213/">previous article</a> , but thanks to Nunjucks, new elements are created automatically. <br><br><h3>  „ÄåUnlimited Calendar Works„Äç </h3><br><div style="text-align:center;"><img width="650" src="https://habrastorage.org/files/814/7ce/523/8147ce523bf34aefa6520ede57b87f9f.png"></div><br>  The biggest innovation in this update is the new calendar template: if before I had to manually update this template, now the template not only always shows the current month, but also has the ability to select any other year. <br><br>  The template code is based on the Date object in JavaScript, through which I could get information about the month I needed.  There are some oddities - for example, months are counted from zero, which seemed to me very strange, but one feature of this object turned out to be quite useful: if you create, for example, an object with a negative month: <br><br>  <i>new date (2016, -1);</i> <br><br>  You can get information for the previous month: <br><br>  <i>Tue Dec 01 2015 00:00:00 GMT-0800 (PST)</i> <br><br>  I started working on the interactive template before making changes to the Notegram.  The trial version was written on my tablet in JSfiddle - since Notegram is based on Node.js, I could just use this code with almost no changes. <br><br>  You can see one of the working versions here: <a href="https://jsfiddle.net/ksrdtL8e/">https://jsfiddle.net/ksrdtL8e/</a> <br><br>  The first day of the week was an interesting question: most of my users live in the US, and prefer to start the week from Sunday, so I added an option for that. <br><br><h3>  Design </h3><br><div style="text-align:center;"><img width="650" src="https://habrastorage.org/files/c9c/e92/675/c9ce9267527548f7a4c16829789ecfd2.png"></div><br>  The main thing in this update was the internal Notegram code, but it was not done without updates for the appearance. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/710/c6a/881/710c6a881ecd4faeae86f6edbccbcf8f.gif"></div><br>  Notegram has already used a 'flat' design, but I still made small changes.  The basis was taken from the news app from Windows 10 - I enlarged the pictures in each card of the template, and slightly changed the colors.  Also, I added a panel with a brief description of my project for new users. <br><br>  Using the service <a href="https://realfavicongenerator.net/">https://realfavicongenerator.net/</a> , I added beautiful icons for all platforms.  Particularly pleased with the Chrome browser on Android, where Notegram behaves like a full-fledged application: <br><br><div style="text-align:center;"><img width="650" src="https://habrastorage.org/files/79c/da3/6a7/79cda36a70864efa83eb0c9db3ec1c3f.png"></div><br><h3>  Learn more about creating pages with OneNote API. </h3><br>  Also, I would like to tell you more about the OneNote API. <br><br>  To create pages, the OneNote API uses a limited portion of HTML, a list of which can be found <a href="http://dev.onenote.com/docs">here</a> . <br><br>  The only &lt;meta&gt; tag supported by the OneNote API is the date the note was created.  You can either specify the full date in ISO 8601 format: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"created"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2016-01-25T06:30:00-08:00"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br>  Or just specify the time zone: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"created"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"-08:00"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  Basically, I use tables for my templates - they behave the same as in HTML. <br><br>  The &lt;img&gt; tag behaves in much the same way as in HTML, but the OneNote API has one interesting function ‚Äî by specifying the data-render-src attribute instead of src, you can save a page screenshot in OneNote: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-render-src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.onenote.com"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"500"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br>  Also, for any element you can specify different marks using the data-tag attribute: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-tag</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"to-do"</span></span></span><span class="hljs-tag">&gt;</span></span>Explore OneNote API<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  A complete list of marks can be found <a href="https://msdn.microsoft.com/library/office/mt159148.aspx">here</a> . <br><br>  Unfortunately, at the moment there is no support for handwriting and mathematical formulas in the API - but I hope that these functions will be added soon. <br><br><h3>  Conclusion </h3><br><div style="text-align:center;"><img width="650" src="https://habrastorage.org/files/393/023/cda/393023cda9ea43bc9d0b7a07234a810e.jpg"></div><br>  I am very pleased that many people liked my project, and I‚Äôm going to continue to develop further - if you have any suggestions, leave them in the comments, or email me on <a href="https://twitter.com/Notegramm">Twitter</a> . <br><br>  Notegram is available right now at <a href="http://notegram.me/">http://notegram.me</a> <br><br><h3>  To authors </h3><br>  Friends, if you are interested in supporting the column with your own material, please write to me at <a href="">vyunev@microsoft.com</a> to discuss all the details.  We are looking for authors who can be interesting to tell about the development under Office and other topics. <br><img align="right" width="200" src="https://habrastorage.org/files/7fb/e8b/83b/7fbe8b83bfb44b27873f0ddb63c35ec5.png"><br><h3>  about the author </h3><br>  <b>Dmitry Konev</b> <br>  Student studying at De Anza College in California <br><br>  I am from Moscow.  Not so long ago, he moved to Silicon Valley, to comprehend the world of developers and technologies.  I was a user of Microsoft services for a long time, but only recently I found myself in the role of a developer.  Recently, I'm interested in web development, before that I mainly worked with C ++. </div><p>Source: <a href="https://habr.com/ru/post/275981/">https://habr.com/ru/post/275981/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275963/index.html">Python and beautiful legs: how I would introduce my son to mathematics and programming</a></li>
<li><a href="../275965/index.html">Instagram Like Bot</a></li>
<li><a href="../275967/index.html">How does the world's largest stock exchange from Chicago: infrastructure and technology</a></li>
<li><a href="../275969/index.html">Some freebies in Microsoft Azure or create free SQL Database in the cloud</a></li>
<li><a href="../275979/index.html">Alteration of RC-cars in a smart machine using Arduino</a></li>
<li><a href="../275983/index.html">Checking the source code of the C # /. NET component kit from Sony</a></li>
<li><a href="../275985/index.html">Who are the Microsoft partner students?</a></li>
<li><a href="../275987/index.html">Site CrashSafari.com sends iPhones to reboot</a></li>
<li><a href="../275989/index.html">Automate word processing using the Microsoft Word API</a></li>
<li><a href="../275993/index.html">Where do bad programmers come from and what is their problem</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>