<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A small study of self-defense products Dr.Web</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing my previous topic about the remuver from the LC, as I promised, I will tell you about the removal utility from Dr.Web. Last time, Kaspersky...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A small study of self-defense products Dr.Web</h1><div class="post__text post__text-html js-mediator-article">  Continuing my previous <a href="http://habrahabr.ru/blogs/virus/102478/">topic</a> about the remuver from the LC, as I promised, I will tell you about the removal utility from Dr.Web.  Last time, Kaspersky Lab reacted rather quickly and complicated the captcha, now it‚Äôs blinking, and there‚Äôs no desire to write a recognition algorithm.  However, before posting a version with a new captcha (build 157), they updated the old one, where they added the removal of the newest products of the 2011 line (build 155) ... <br><br>  I was going to write about Dr.Web remoover back in September, but since  a rather serious vulnerability was discovered in the self-defense module not only of the removal utility itself, but also of the entire line of anti-viruses, and the programmers from Dr.Web had to give time to fix it. <br><a name="habracut"></a><br>  So, I ask you to love and favor Dr.Web Anti-Virus Remover: <br><br><img src="https://habrastorage.org/storage/habraeffect/37/16/371697ef3d5fe65f1781810fbc16e3ab.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We immediately see what the guys did with the soul!  The logo on the floor of the window, the statusbar even ... Lopota!  They always pinned up how they manage to combine glamorous pictures with Win98-style interface elements in their products :) To carry out the removal of the product, they again require entering a captcha, no confirmation is displayed, only a message about successful deletion.  Let's see if everything is so beautiful inside and try to go in several ways ... <br><br><h4>  <strong>1.</strong> Recognition captcha </h4><br>  The captcha of the utility from Dr.Web is, of course, much more resistant than that of the remuver from Kaspersky Lab, largely due to geometric distortions of the characters, but even this was not without weaknesses. <br>  First, a captcha consists of 6 numbers, and they, surprisingly, do not repeat!  What sense in this "feature" I can not understand at all ... This approach reduces the number of possible options by almost 7 times!  This makes it possible to use something like an exclusion method in recognition and significantly increases the probability of success. <br>  Secondly, each digit on the captcha is surrounded by a gray halo, while the noise is pure black.  Thanks to this, it is possible to precisely cut out individual characters and eliminate noise. <br>  Thirdly, the positions of the figures practically do not change, only the size and style of the font (with or without serifs), as well as the degree of distortion, change. <br>  Because of the strong distortions of characters, only 20% recognition accuracy was achieved for the entire captcha, which is acceptable in principle (for web captchas, for example), but in this case, flicking on the screen, updating the picture is not lucky, this is nonsense.  Further complicating the recognition algorithm was laziness, so I decided to try to enter from the other side. <br><br><h4>  <strong>2.</strong> Patch exe file </h4><br>  You can simply cut the validation of the code and recompile the utility.  But in this case, the EDS becomes invalid.  Remuver works, deletes everything except the self-defense module (apparently the absence of a valid digital signature affects).  However, the antivirus completely loses its working capacity, who needs this self-defense, if everything has already been removed is not entirely clear. <br><br><img src="https://habrastorage.org/storage/habraeffect/4e/0f/4e0f8846931f38a3b12a370463a8cd53.png"><br><br>  When trying to remove a more recent version of Dr.Web Security Space (6.0.2.07290), SpIDer Guard remained alive. <br><br><img src="https://habrastorage.org/storage/habraeffect/dd/88/dd88576bf2fd23c7648b02e35c8d2fdc.png"><br><br><h4>  <strong>3.</strong> Reading the correct code from memory remuver </h4><br>  Why recognize captcha if the value is open in the memory, and even at a fixed address?  You can simply read it and insert it into the input field.  With this approach, the EDS is saved, which means the remuver is guaranteed to work as expected and will take down the antivirus completely.  A program for reading a piece of memory is written in 20 minutes. "Thanks to" the lack of proactive protection or HIPS products from Dr.Web, nothing prevents the reading of the memory of the trusted utility. <br><br><img src="https://habrastorage.org/storage/habraeffect/85/b6/85b6b24bd8f7b1f1f62ff4b36ea5be81.png"><br><br>  In general, the exe-file of the utility itself contains in its open form many interesting things, for example, the paths to the vital files and registry keys of Dr.Web products.  In the same remuver from Kaspersky Lab, everything is not so simple and such data is not stored in the clear. <br><br><img src="https://habrastorage.org/storage/habraeffect/96/01/96017ecc04975703e5f031f43459dc4d.png"><br><br>  Later, it suddenly turned out that the praised module of self-defense of Dr.Web products itself suffers from a similar problem!  The value of captcha in the same way, without hesitation, is stored in memory.  It is hard to believe that programmers who fiddled with such powerful (seemingly) self-defense could have made such a childish mistake, but this is so ... <br><br><img src="https://habrastorage.org/storage/habraeffect/38/99/389913f2de792dfa03ffc44a20d7a4ec.png"><br><br>  To unload the self-defense module, SpIDerAgent_Set.exe is called with the -uninstall parameter: ##########, where ########## is a number that depends in some way on the system time.  If you receive an incorrect code, the unloading self-unloading will not start.  Again, due to the absence of all unnecessary (from the Dr.Web point of view) behavioral blockers, it does not cost anything to unwind the system date by a certain value and run SpIDerAgent_Set.exe with a code known in advance;) <br><br><img src="https://habrastorage.org/storage/habraeffect/12/73/1273e44bf37d74a66e21832df1504e0d.png"><br><br>  Since we are talking not only about the remuver, but about the Dr.Web products themselves, it would be wrong to ignore another vector of attack on self-defense. <br><br><h4>  <strong>4.</strong> Recognizing captcha voice </h4><br>  When dubbing the value of the captcha, the Microsoft Speech API is used, there is no noise, so recognition is not a problem at all, <a href="http://habrahabr.ru/blogs/infosecurity/101208/">it was</a> already like that in Habr√©.  It seems that this function was screwed up in general "for show".  It would be better to move the code to the holes ... <br><br><h4>  PS </h4><br>  Experiments were carried out with the September versions of Dr.Web Anti-Virus Remover v.1.00.5.08230 and Dr.Web Security Space 6.0.2.07290.  After I reported the vulnerability, they <a href="http://people.drweb.com/people/yudin/remover/">released an</a> updated version of Dr.Web Anti-Virus Remover v.1.00.6.09200, in which the gaps were covered.  At the expense of fixes in the line of antiviruses themselves keep proud silence, but in 3 months they should have come up with something. <br><br>  <a href="http://depositfiles.com/files/5ayn7arzq">The program</a> that demonstrates the vulnerability in the remuver and antivirus self-defense module.  Except on WinXP, I didn‚Äôt test it; besides, the self-defense module of the antivirus product line should already be updated, but it should work on earlier versions. <br><br><h4>  Pps </h4><br>  Just in September, <a href="http://anti-malware.ru/antivirus_self_protection_test_2010">a</a> comparative test of antivirus self-defense was <a href="http://anti-malware.ru/antivirus_self_protection_test_2010">published</a> on anti-malware.ru, which is remarkable, our heroes were the winners with the results of 100% and 99% - Kaspersky Lab (Kaspersky Internet Security 2011) and Doctor Web (DrWeb Security Space 6.0) respectively. <br><br><img src="https://habrastorage.org/storage/habraeffect/ff/e8/ffe8e0c485dfd3529c6a8212712d4327.png"><br><br>  And recently, the malware Trojan-PSW.Win32.VKont.alb (according to the classification of the LC), which generally mows down almost all popular antiviruses, including those with platinum test awards anti-malware.ru (Dr.Web today) the day has already been fixed) ... <br><br>  All this proves once again that there is no ideal protection, just as there are no ideal tests for this protection itself, and remember that the best antivirus is the head! </div><p>Source: <a href="https://habr.com/ru/post/110508/">https://habr.com/ru/post/110508/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../110502/index.html">Anti-Copiracy Domains</a></li>
<li><a href="../110503/index.html">Geocontext and marketing</a></li>
<li><a href="../110504/index.html">Drupal 7 release date announced</a></li>
<li><a href="../110506/index.html">Scrolling last.fm and mol5 HTML5 player</a></li>
<li><a href="../110507/index.html">The first cloud statistics</a></li>
<li><a href="../110509/index.html">Suggest.io. Understand from the first letter!</a></li>
<li><a href="../110510/index.html">Roscosmos approved the satellite communication system "Cosmonet" (1 Mbit / s)</a></li>
<li><a href="../110511/index.html">Google and Facebook Sunrise</a></li>
<li><a href="../110512/index.html">Did you manage to register yourself IPv4?</a></li>
<li><a href="../110513/index.html">AirPlay - now in Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>