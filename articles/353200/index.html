<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Episode 0. Hack vs Mac. Xcode build time</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Next episode Cost hack 

 This article begins a cycle of several about using Hackintosh in daily work, and especially with IDE Xcode 9, and will be of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Episode 0. Hack vs Mac. Xcode build time</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/p9/kz/ph/p9kzph785qrv3nrw985adnje5vc.png" alt="image"><br>  <b>Next episode</b> <a href="https://habr.com/post/421073/">Cost hack</a> <br><br>  This article begins a cycle of several about using Hackintosh in daily work, and especially with IDE Xcode 9, and will be of more interest to developers under objc / swift languages.  On the other hand, my first hack was compiled when I was not familiar with these languages ‚Äã‚Äãand may be useful even to those who are not a developer, but for one reason or another want to try Mac OS.  At that time, I had a fairly powerful working Sony laptop and a great desire to start programming under iOS.  But I was not ready to spend a certain amount of money on a Mac without knowing whether it would be useful to me in the long run or not. <br><br>  Therefore, it was decided to build Hackintosh, which eventually allowed me to enter the world of application development for Apple devices.  In the first article I want to pay attention to the build time of projects in the Xcode environment.  The developers know perfectly well how much the speed has decreased and the time for building projects has increased with the release of version 9 of this IDE, especially in the swift language or a mix of objc / swift.  You can speed up the compilation time, firstly, by setting various flags and scripts, and secondly, by refactoring the codebase itself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But in this episode, attention will be paid to the third component of development tools, namely ‚Äúhardware‚Äù. <br><a name="habracut"></a><br>  Since there is not much information on the time of project assembly or it is quite narrow and affects only one language / project and there is no objectivity, I had an idea to collect statistics for different computers and conduct some analysis.  I am sure that this information will be useful to you the next time when a project manager or techlid will ask you: ‚ÄúWhy do you need such a powerful computer, everything works so well!‚Äù.  Or if you are a freelance developer and one day you will think about whether this Mac is worth the money spent and how much time you will end up in permanent builds during the day. <br><br>  Most have an understanding that Apple‚Äôs more expensive computers provide for a more comfortable and most importantly, quick fulfillment of the tasks set by the employer.  But there is no understanding of what order in question.  I have found developers who, in the interests of the entire ios-community, conducted a series of tests on their machines and provided results for you. <br><br>  In the tests, the performance of a hackintosh with the new i7-8700K generation of the Coffee Lake generation and iMac Pro with the flagship 18th Skylake Xeon W-2191B generation nuclear processor was studied.  I was always interested to compare the compilation time for hacks and native Apple machines.  Given the high cost of iMac Pro, I think many will be interested to find out whether it is recommended to buy and whether it really will bring a significant increase in the speed of project development. <br><br>  At the end of the introductory part, I would like to thank Ash Furrow for the <a href="https://github.com/ashfurrow/xcode-hardware-performance">repository</a> (his project also participates in the test) with the already collected test data, which also inspired me to write this article. <br><br>  <b>Abbreviations used:</b> <br><br>  <i><b>Hack / hack</b></i> - hakintosh / hackintosh <br>  <b><i>SBS</i></b> ( <b><i>Standard Build System</i></b> ) - ‚Äúclean‚Äù build on a standard build system <br>  <b><i>SBS ret</i></b> - rebuild on SBS <br>  <b><i>NBS</i></b> ( <b><i>New Build System</i></b> ) - ‚Äúclean‚Äù build on a new build system <br>  <b><i>NBS ret</i></b> - rebuild on NBS <br><br>  We proceed directly to the testing. <br><br><h2>  Testing </h2><br>  The following devices participated in the testing: <br><br><ul><li>  iMac Pro ( <b>18 core</b> ) Xeon W-2191B 2.3 / 4.3GHz / 64Gb </li><li>  Hackintosh i7-8700K ( <b>6 core</b> ) 3.7 / 4.7GHz ( <b>HFS +</b> ) / 32Gb </li><li>  iMac 4K mid 2017 i7-7700K ( <b>4 core</b> ) 4.2 / 4.5GHz / 16Gb </li><li>  Macbook Pro 2017 i7-7820HQ ( <b>4 cor</b> e) 2.9 / 3.9GHz ( <b>HFS +</b> ) / 16Gb </li></ul><br>  It was decided to use only open source projects so that after the article each developer had the opportunity to add his own results and compare it with top-end hardware (so far only on Xcode 9.2).  Most of these projects are currently being actively developed and, in order to have the opportunity to produce ‚Äúpure‚Äù tests in the future with the release of new hardware and compare the results, I pulled projects under my account.  Then I updated the frameworks / libraries on them, checked the ability to just download and (almost) start testing without undue actions.  <a href="https://goo.gl/forms/c1MV8fbAYj4DLGHS2">Instructions for testing.</a> <br><br><h2>  Used projects </h2><br>  A total of <b>6</b> projects were used ( <b>5</b> of them are available in stock): <br><br>  1. <a href="https://github.com/artsy/eidolon">Eidolon</a> - iOS / swift 3 / cocoapods <br><br>  2. <a href="https://github.com/mozilla-mobile/firefox-ios">Firefox</a> - iOS / swift 3 / carthage - <a href="https://itunes.apple.com/ru/app/%25D0%25B2%25D0%25B5%25D0%25B1-%25D0%25B1%25D1%2580%25D0%25B0%25D1%2583%25D0%25B7%25D0%25B5%25D1%2580-firefox/id989804926%3Fmt%3D8"><img src="https://habrastorage.org/webt/oj/em/tb/ojemtbxu5enk8izloysvzaii2dq.png" alt="image"></a> <br><br>  3. <a href="https://github.com/kickstarter/ios-oss">Kickstarter</a> - iOS / swift 3 / carthage - <a href="https://itunes.apple.com/ru/app/kickstarter/id596961532%3Fmt%3D8"><img src="https://habrastorage.org/webt/eb/f2/q4/ebf2q4qr_c_k7j2e7ppslmlbqbe.png" alt="image"></a> <br><br>  4. <a href="https://github.com/wikimedia/wikipedia-ios">Wikipedia</a> - iOS / objc &amp; swift / carthage - <a href="https://itunes.apple.com/ru/app/wikipedia/id324715238%3Fmt%3D8"><img src="https://habrastorage.org/webt/b0/ws/wg/b0wswgqbipricjfvma4iluj-dzc.png" alt="image"></a> <br><br>  5. <a href="https://github.com/overtake/TelegramSwift">Telegram</a> - Mac OS / swift 4 - <a href="https://itunes.apple.com/ru/app/telegram/id747648890%3Fmt%3D12"><img src="https://habrastorage.org/webt/yx/qt/q6/yxqtq6cpdnwjpnjy4uca0uk1ues.png" alt="image"></a> <br><br>  6. <a href="https://github.com/wireapp/wire-ios">Wire</a> - iOS / objc / cocoapods &amp; carthage - <a href="https://itunes.apple.com/us/app/wire-secure-messenger/id930944768%3Fmt%3D8"><img src="https://habrastorage.org/webt/fe/5l/x7/fe5lx7lo-vrcbxbp9pof7apaejm.png" alt="image"></a> <br><br><h2>  Test Procedure </h2><br>  1. Measurements were taken in Xcode 9 with a ‚Äúclean‚Äù build for SBS and NBS <br><br>  2. And after adding one line of code: <br>  <b>print ("Hello, Ash Furrow")</b> in application (: didFinishLaunchingWithOptions :) AppDelegate for <b>swift</b> <br>  <b>NSLog (@ "Hello, Ash Furrow");</b>  - for <b>objc</b> <br><br>  No additional flags were set, the project settings to speed up the build time were not made. <br><br>  In addition to determining the project build time, the speed of the disk in the <a href="https://itunes.apple.com/ru/app/aja-system-test-lite/id1092006274%3Fmt%3D12"><b>AJA System Test Lite</b></a> and the number of ‚Äúparrots‚Äù in <a href=""><b>Geekbench 4 were</b></a> measured. <br><br>  It's no secret that the greatest impact on compile time has: <br><br><ul><li>  The processor, or rather its frequency, cache, and to a lesser extent, the number of cores </li><li>  SSD read / write speed </li><li>  RAM (frequency and volume) </li></ul><blockquote>  For comfortable product development using Xcode 9, Slack, HipChat, Telegram, SourceTree, Chrome, Zeplin, etc., a minimum of 16 GB is recommended (more is better) </blockquote><h2>  Workstations Productivity </h2><br><img src="https://habrastorage.org/webt/q_/nk/r6/q_nkr6udal4e4cx4jusmhusl6ei.png" alt="image"><blockquote>  The new iMac Pro SSD is of course the fastest </blockquote><img src="https://habrastorage.org/webt/o2/ih/uq/o2ihuqbpcpmrrqbyvvokdan_wb4.png" alt="image"><blockquote>  The ‚Äúparrots‚Äù by and large do not have a clear correlation with the speed and time of project assembly.  Further it will be seen why.  But collect the numbers and check it was still required. </blockquote><h2>  Test results </h2><br><img src="https://habrastorage.org/webt/7h/8d/5m/7h8d5mnnql_7lxmh7x_5tlk5yw4.png" alt="image"><blockquote>  The first test and immediately unusual result.  The ‚Äúclean‚Äù build time on a hack is faster and equal to the build time on an iMac Pro on SBS and NBS, respectively. </blockquote>  At first, the doubt crept in, how can it be that the 6th nuclear processor overtook / was equal to the 18th nuclear ?!  Control measurements were made, but everything remained unchanged (1-2 seconds difference at the level of error). <br><br><img src="https://habrastorage.org/webt/3o/-f/hh/3o-fhhagfaxvsqmjj0w9rb3s4bg.png" alt="image"><blockquote>  The second test, everything seemed to fall into place.  But the difference of 2/4 seconds is not so significant for such a powerful iron. </blockquote><img src="https://habrastorage.org/webt/hr/jy/u7/hrjyu7vu33rl4czalhlkty9dhqy.png" alt="image"><blockquote>  The third test, the situation is already "better."  5/10 seconds difference on SBS / NBS in favor of iMac Pro. </blockquote><img src="https://habrastorage.org/webt/ok/kr/t5/okkrt5zxe_u-thfaja5indhua0y.png" alt="image"><blockquote>  Wikipedia also threw a surprise.  Well, it's completely strange, iMac 4K of mid-2017 is faster than iMac Pro of the end of 2017 on NBS for 8 seconds. <br>  And hack faster by as much as 12 seconds! </blockquote>  Apparently you need a control measurement on another iMac Pro.  If there is another such, it will be great. <br>  <b>UPD</b> : found proof later <br><br><img src="https://habrastorage.org/webt/hc/pr/go/hcprgopoliyizjbjknbeifjpbsy.png" alt="image"><blockquote>  Telegram under Mac OS.  Assembly time, of course, space.  This is due to the fact that the project uses the generated API file (at the time of compilation of which other tasks are not performed) and the code base of the project itself is quite large.  And it becomes not so interesting, hakintosh again faster.  By the way, the project is not going to NBS, it takes a lot of unnecessary actions.  Therefore, this option is discarded here. </blockquote><img src="https://habrastorage.org/webt/3z/iy/jh/3ziyjhrqqpqjyxxrqbdvtx4irf0.png" alt="image"><blockquote>  Well, the last test for Wire.  Going like Telegram only on SBS.  iMac in front. </blockquote>  As can be seen from the comments to the tests, the greatest interest (at least for me) was the comparison of the hack and the top model of the Apple computer.  But in the first test, even the iMac 4K 2017 is not so far behind the iMac Pro - the difference is only 8/10 seconds, and in the 4th it overtook (which I repeat is very strange). <br><br>  According to the results of the experiments, it can be concluded that the hackintosh performance is quite comparable with the native Mac of one of the top assemblies worth ~ 10k $ and, accordingly, the hack can be successfully used in product development.  It is likely that the old HFS + file system could have played a significant role in such results.  According to my personal feelings after a month of work on the MBP 17 with APFS and then reinstalling High Sierra on HFS + assembly speed, and the work of the laptop as a whole has become faster.  This is confirmed by the developers of kexts (drivers) under hackintosh in various forums. <br><br><h2>  findings </h2><br><ul><li>  The build time of projects depends on the speed of the disk (and the recording speed has a higher priority). </li><li>  The frequency of the processor has a higher priority over the number of cores. </li><li>  Using the NO flag in the defaults write command com.apple.dt.Xcode BuildSystemScheduleInherentlyParallelCommandsSerially -bool NO, depending on the project and your mac, reduces the build time by 9-15% (at least in Xcode version 9.3). </li><li>  NBS in swift projects gives a maximum increase of 67%. </li><li>  NBS in the objc project (Wikipedia) shows a significant increase in performance (150%) - as if the new build system was written specifically for objc. </li><li>  On Fusion Drive, NBS is slower or approximately equal to the standard ‚Äî in all likelihood some special way is used to get profit from fast SSDs. </li><li>  On NBS, in projects with a swift and a mix of objc / swift, the backlight almost immediately falls (well, you know that). </li><li>  And on the Macs with Fusion Drive when using NBS, the backlight does not fall </li></ul><br>  At the end of the article, the question is whether the time, money and effort spent on searching, purchasing a component, and their subsequent assembly and configuration are worth it. <br><br>  I will reveal this question in the next episode. <br><br><blockquote>  PS: Thanks to the guys from Badoo and Telegram, for taking the time and opportunity to test on iMac Pro.  Thank you, Yuri, Eugene and Cyril, for being able to pass the "light" version of the tests on their home computers. </blockquote>  <b>UPD</b> : <br>  <s>Currently, tests can only be performed on Xcode 9.2.</s> <br>  <s>After the release of Xcode 9.3, errors occur when building some projects. In the near future, errors will be corrected, and</s> the test results and project repositories <s>will be</s> updated. <br>  <b>UPD 04/21/2018:</b> <br>  Repositories updated, you can compare your hardware. <br>  As soon as someone passes on mac mini, mac pro or, for example, macbook pro 2014, I‚Äôll add their results to the charts.  More interesting processors i7 / i5. <br><br>  <b>Next episode</b> <a href="https://habr.com/post/421073/">Cost hack</a> <br><br>  <sub>Design - Lyudmila Kotovich</sub> </div><p>Source: <a href="https://habr.com/ru/post/353200/">https://habr.com/ru/post/353200/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353190/index.html">Video recordings of speeches on gamedev in the Lecture Hall of the Tower</a></li>
<li><a href="../353192/index.html">How I learned from tester to .NET developer</a></li>
<li><a href="../353194/index.html">For what programmer Continuous Integration and where to start</a></li>
<li><a href="../353196/index.html">Divan Vice President: how I work as a product director on a complete remote</a></li>
<li><a href="../353198/index.html">SelectelTechDay: how it was</a></li>
<li><a href="../353202/index.html">Marvin Minsky "The Emotion Machine": Chapter 1 "How we control ourselves"</a></li>
<li><a href="../353204/index.html">About streams and tables in Kafka and Stream Processing, part 1</a></li>
<li><a href="../353206/index.html">93-byte Snake Game</a></li>
<li><a href="../353208/index.html">Another boxed CMS or a worthy alternative?</a></li>
<li><a href="../353210/index.html">How do users teach Yandex to warn about phone spam</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>