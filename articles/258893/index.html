<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple cryptography: frequency and differential cryptanalysis in the task NeoQUEST-2015</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On the eve of the NeoQUEST-2015 in-person tour, we continue to sort out the tasks of the online stage. The article deals with the task "Abracadabra", ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple cryptography: frequency and differential cryptanalysis in the task NeoQUEST-2015</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/files/290/706/727/2907067271bb4ace99220d93cdcf36bd.JPG">  On the eve of <a href="http://neoquest.ru/timeline.php%3Fyear%3D2015">the</a> NeoQUEST-2015 in-person <a href="http://neoquest.ru/timeline.php%3Fyear%3D2015">tour,</a> we continue to sort out the tasks of the online stage.  The article deals with the task "Abracadabra", consisting of two parts.  Both parts are for cryptanalysis: the first is for frequency, the second is for differential. <br><br>  Participants were given two files.  The first file had the format .docx, on its first page was the very ‚Äúabracadabra‚Äù - the text, consisting entirely of incomprehensible squiggles and symbols, and on the second page - not quite clear list.  Looking at it, one thing was for sure: a certain encryption algorithm is described here. <br><br>  The second file was in .txt format, it contained 2 columns, titled as plaintext and cyphertext.  With all this it was necessary to do something ... <br><a name="habracut"></a><br>  Incomprehensible text: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      R—õC ‚Ä∞C ‚Äú–ã ‚Ä° –ä‚Äû  ‚Äù '–ã–ä‚Äû –ã ‚Äπ‚Äû Oc' –å ‚Äπ–Ü ‚Ä∞ —ñ  ¬± '–ã ‚Äû  ‚Äù–å—ï –è ‚Ä† ‚Ä¶ ‚Äû –ã √ë–ä–É–åo —ï –è ‚Ä† ‚Ä¶  ‚Äû–ã ‚Ä° –äc–åo  ¬±  ¬ª'–ã ‚Ä∞  ‚Ä†.   ¬±  ‚Ä† –ã–ä ‚Äû–ã‚Äπ  ‚Äû—ï–É —î–è‚Äπ  ‚Ä∞    ‚Ä†  ¬± –âc—ó–ä –Ç–ã ‚Äûp–è‚Äπ –ä ‚Äû¬ª —ò o ‚Äû–ä‚Äπ –è ‚Äπ ‚Ä°  ¬±  ‚Ä† ‚Äû  ‚Ä† –â  ‚Äπ  ‚Ä∞ o–Ö–Ö‚Äπ –è ‚Äπ‚Äû  ‚Ä¢ —ï ‚Ä† –â‚Äö ‚Äû¬ª —ò —î–è–ã–Ö ‚Ä† —ò–â o ' ‚Ä† –è ‚Ä† –Ç–ä ‚Äπ–è—ï ‚Ä° –äop ‚Ä† –è ‚Ä† _‚Äû   ‚Ä†.  —ï–Ö–Ö ‚Äπ–è‚Äπ  ‚Äû ‚Ä¢ o ‚Ä† –â‚Äö‚Äû  ¬ª—ò —î–è–ã–Ö ‚Ä† —ò–â —î–ã–Ç ‚Ä† ‚Ä¶ ¬ª  ¬±  ‚Ä†  ‚Äπ–ä  ¬± ‚Äπ –è–ã–É–ä "–ã –ä" –ã ‚Äπ–ã–ä  ‚Äû—ï‚Äπ –å ‚Äπ–Ü ‚Ä∞ —ñ  ¬± '–ã ‚Äû  ‚Äù–åo –è ‚Ä† ‚Ä¶ ‚Äû –ã ‚Ä° –äc–å—ï o –è ‚Ä† ‚Ä¶  ‚Äû–ã ‚Ä° –ä–É–å—ï  ¬± ¬ª '–ã ‚Ä∞  ‚Ä† “ë–â–ãp .  R—ôS–ãS S–ãR“ëS ‚Ä∞ "P" C &lt;R—îS–èS–ãR–ÖS ‚Ä† R—òS–âR "S–åS–ãS—ìR—ñS–ä R“ëR" S–äS C ‚Ä° ‚Ä∞ S–ãS ... With C ‚Ä† C "P" With S–âc S–ÇS ‚Ä∞ ‚Ä∞ ‚Ä† R–ÜS S–ãS—ìS–ã ¬∞ C ... P ‚Ä° ¬± S–ãS S,S–åR—ï R“ëS–âS–ãpS–ãR ¬± R ¬± DP ‚ÄúS.  R–ÉC ‚Ä† C–èC ‚Ä† C –ä C –ä C P ¬ªP¬∂o ‚Ä° –â–É‚Äπ –ä ‚Ä° c  ‚Ä∞ –â–É  ‚Ä¢  ‚Äπ–â–ã—ì–ã –è ‚Ä† —ñ‚Äû  ‚Ä∞  ‚Ä†.  RS ‚Äú ‚Ä† —î–ã–Ç ‚Ä† ‚Ä¶ ‚Äù  ¬±  ‚Ä†  ‚Äπ–ä  ¬± ‚Äπ –è–ã–ä ‚Äû–ã  ‚Äö,   p–ã–ä–ã–è–ã—ò –ã ‚Ä∞  ‚Äû ‚Ä†  ¬± '–ã ‚Äû  ‚Ä† –É –è ‚Ä† ‚Ä¶  ‚Äû–ã ‚Ä° –ä‚Äö  ‚Ä° –ã‚Ä¶  ‚Ä∞  ‚Ä† –â ‚Ä† “ë ¬ª–è ‚Ä† ‚Ä¶ ‚Äû –ã ‚Ä° –ä ‚Äö–ã—î–è‚Äπ  ‚Ä∞  ‚Äπ–âa‚Äú  ‚Äú–ã—ì–ã  ¬± ‚Äù '–ã  ‚Ä†.  RR“ëC–èC ‚Ä† C–äR * C–äC ‚ÄπP ¬± C‚Äû o–å ‚Ä† C ‚Äû—ï‚Äπ, ¬∂–ä–ã C' ‚Ä† C–èC ‚Ä† C –ä C –ä C –è C C –ä C –ä C o C –ä C ‚Ä† RIC ‚ÄπC C –â C –Ç C  C  C  C ‚Ä† o C –ä C ‚Ä† RIC ‚Ä† R—ñS "C ‚Ä∞ ‚Ä† C, R—îS–ãS–äS–ãS–åR—ñ R¬∂S–äS–ã S–âR—óR“ëS–ãS &lt;S–ãS–äS" S–ãRoS &lt;C "R—ïS &lt;pS–ãS–äS–ãS–èS–ãS &lt;P ¬± S–ÇS–âR—óR¬∂S ‚Ä† C &lt;S–ä S–èS ‚Ä† C ... C" S–ãS ‚Ä° S–äo, C "C &lt;... C ‚Ä† P ¬± P * C ‚Ä° oC–ä C–ãC–ä p–â—ó¬∂ ‚Äπ—ò –è ‚Ä† —ñ‚Äû  ‚Ä∞  ‚Ä†.  —õ ‚Ä° —î–ã–â‚Äö‚Ä¶ —ñ—ò  ‚Ä∞ —ï–Ö–Ö ¬∂ ‚Ä†  ‚Ä° –äo ‚Ä¶  ‚Ä†  ‚Ä∞  ‚Ä†  ‚Äû—ï–É, –â—ï –Ü‚Äπ o ‚Ä∞   ‚Äû ‚Ä† —î–è–ã–â–ã–å.  ¬¶ p–â—ó¬∂ –Ç‚Ññ–ä–ã—ò ¬∂ ‚Ä†  ‚Ä° –äo ‚Ä¶  ‚Ä†  ‚Ä∞  ‚Ä†  ‚Äû—ïc —ö ¬∂ ‚Ä†  ‚Ä° –ä–ã–ä‚Äû  ¬ª—ò ‚Ä† ‚Äû  ‚Ä† –âo‚Ä¶. <br><br>  List: <br><br><ol><li>  Substitution (15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10) </li><li>  Permutation P (i) = 9 * i + 4 (mod 32) </li><li>  3 cycles: 2 cycles with [XOR with key + Substitution + Permutation], the last [XOR with key + Substitution + XOR with key] </li><li>  Input: S-box ‚Ññ1 (10; 1), second: S-box ‚Ññ3 (8; 6). </li></ol><br><br>  Considering the list from the Word file, it was necessary to restore the key in pairs of open and closed texts in the second .txt file. <br><br><h6>  <b>"Abracadabra" ‚Ññ1</b> </h6><br>  The analysis of the first part of the assignment, with incomprehensible text, should have been started from the definition of the encoding, many online decoders (in particular, <a href="http://www.artlebedev.ru/tools/decoder/">this one</a> ) successfully coped with this. <br><br><img src="https://habrastorage.org/files/f79/ff4/01e/f79ff401e9d249f195d8ed215476e943.jpg"><br><br>  After using the decoder, a more meaningful text was obtained, with punctuation marks, suggesting the idea of ‚Äã‚Äãencryption by replacing a character with a character.  However, the simplest option ‚Äî Caesar‚Äôs cipher ‚Äî did not help here.  Further directions of thought were reduced to frequency cryptanalysis.  Here, as is the case with the definition of encoding, there are <a href="http://abak.pozitiv-r.ru/text/97-freq-letter">services</a> that allow frequency analysis of the text. <br><br>  Result of frequency analysis of the entered text <br>  Text analysis performed <br>  Number of characters in the text 910 <br>  Number of spaces 114 <br>  Number of digits 0 <br>  Number of points and commas 16 <br>  Number of english letters 53 <br>  Russian letters 715 <br><br>  Character-based statistics and frequency analysis <br>  The symbol occurs 114 times.  Frequency 12.53% <br>  The symbol u occurs 86 times.  Frequency 9.45% <br>  The symbol q occurs 80 times.  Frequency 8.79% <br>  The symbol f occurs 63 times.  Frequency 6.92% <br>  The symbol b is found 52 times.  Frequency 5.71% <br>  The symbol s is found 50 times.  Frequency 5.49% <br>  The symbol I occurs 43 times.  Frequency 4.73% <br>  The symbol n is found 38 times.  Frequency 4.18% <br>  The symbol  occurs 31 times.  Frequency 3.41% <br>  The symbol o occurs 30 times.  Frequency 3.30% <br>  The symbol o occurs 28 times.  Frequency 3.08% <br>  The symbol h occurs 27 times.  Frequency 2.97% <br>  Symbol b occurs 22 times.  Frequency 2.42% <br>  The symbol x occurs 21 times.  Frequency 2.31% <br>  The symbol l occurs 19 times.  Frequency 2.09% <br>  The symbol k occurs 16 times.  Frequency 1.76% <br>  The symbol m occurs 16 times.  Frequency 1.76% <br>  The symbol e occurs 14 times.  Frequency 1.54% <br>  The symbol n occurs 14 times.  Frequency 1.54% <br>  The symbol r occurs 13 times.  Frequency 1.43% <br>  The symbol e occurs 12 times.  Frequency 1.32% <br>  The symbol with occurs 11 times.  Frequency 1.21% <br>  The symbol p occurs 11 times.  Frequency 1.21% <br>  The symbol c occurs 11 times.  Frequency 1.21% <br>  The symbol t occurs 11 times.  Frequency 1.21% <br>  The symbol p occurs 11 times.  Frequency 1.21% <br>  Symbol.  occurs 9 times.  Frequency 0.99% <br>  The symbol is found 9 times.  Frequency 0.99% <br>  The symbol d occurs 9 times.  Frequency 0.99% <br>  The symbol is found 7 times.  Frequency 0.77% <br>  The symbol occurs 7 times.  Frequency 0.77% <br>  The symbol e occurs 6 times.  Frequency 0.66% <br>  The symbol is found 6 times.  Frequency 0.66% <br>  The symbol n occurs 5 times.  Frequency 0.55% <br>  The symbol and occurs 4 times.  Frequency 0.44% <br>  The symbol d occurs 1 time.  Frequency 0.11% <br>  Symbol a occurs 1 time.  Frequency 0.11% <br>  The symbol d occurs 1 time.  Frequency 0.11% <br>  The symbol s occurs 1 time.  Frequency 0.11% <br><br>  From the results of the analysis it is clear that the text is not two English letters (note the mysterious DS, which can be DES, DOS, DNS, and so on), but as many as 53!  It was possible to work and write a program that sorts out letters that look the same in both Russian and English (for example, obvious o, e, p), but you could google and find a <a href="http://tobetop.ru/openscripts/engsymb.php">program</a> that will highlight English letters: <br><br><img src="https://habrastorage.org/files/dd6/1ea/cef/dd61eacef1db45ec9840df947bd73e22.jpg"><br><br>  Attentive participants may have noticed repeated words that are most likely different forms of the same word: <br><br>  <b>schonnyyyfEyottstfyuyu</b> <b><br></b>  <b>SchonnyyayfEotstsflm</b> <b><br></b>  <b>schonnyyayfEotstfueg</b> <br><br>  It is logical to assume that the most concise form of a word from these three is the nominative case, a word of 16 letters in which the letters 3 and 4 are the same.  There are not so many words of 16 letters, if you believe the dictionary: 759. And such that the third and fourth letters coincide, all the more.  It was possible to implement a program that selects words that match the mask to the encrypted one, but it was possible to simply check words from 16 letters with doubled 3 and 4 positions.  Even if checked manually, the choice is small: <br><br>  shamelessness <br>  ballot <br>  gellenophobia <br>  collaborationism <br>  collaborator <br>  collectors <br>  cellophane <br>  commercialization <br>  pessimism <br>  reasonableness <br>  differentiate <br><br>  But the letters in positions 2 and 10 must also match!  According to this parameter, only the word ‚Äúdifferentiate‚Äù is suitable, and if you try to implement such a replacement of symbols, the text will become more readable, though not completely, from which it becomes clear that the search word is not ‚Äúdifferentiate‚Äù, but ‚Äúdifferential‚Äù.  Having connected with the second part of the assignment, DS turns into DES, simplifying the task a little more, and the final text looks like this: <br><br>  ‚ÄúThe idea of ‚Äã‚Äãdifferential cryptanalysis is based on probabilistic relationships between input differences and output differences.  Two relationships are of particular interest in the analysis: the differential profile and the characteristics of the round.  The differential profile shows the probability relationship between the input differences and the differences of the output of the block.  Similar profiles can be created for each of the eight blocks in the DES.  The characteristic of the round is similar to the differential profile, but it is calculated for the whole round.  It shows the probability with which one input difference would create a difference of a certain output.  Note that the characteristic is the same for each round, because any relation that includes differences does not depend on the keys of the round.  Use differential cryptanalysis to pass the second part of the task, or go ahead.  And the key to this part of the task is frequency analysis. <br><br>  So we got the key to the first part of the task, but if you enter "frequency analysis" in the input field, a message pops up saying that the key is incorrect.  What to do?  It's simple: you had to take an MD5-hash from this phrase.  Profit!  By the way, writeup for this assignment has already been published by one of our participants <a href="http://yantayga.livejournal.com/99988.html">here</a> , having passed it a little differently, but, nevertheless, having achieved success! <br><br><h6>  <b>"Abracadabra" ‚Ññ2</b> </h6><br>  As it was already written in the decrypted text, the second part of the task could be completed in two ways: <br><ul><li>  implement differential cryptanalysis; </li><li>  Screw the key using a pair of open-closed text. </li></ul><br><br>  Most of the participants chose the second method of transmission (and they can be understood, because it is still more laborious to implement cryptanalysis), so we will analyze this method in more detail. <br><br><h6>  <i><b>Differential Cryptanalysis</b></i> </h6><br>  It is based on the uneven distribution of bit-wise differences modulo 2 pairs of open and corresponding encrypted texts.  To attack using the differential method requires the availability of selected open and corresponding encrypted texts, this condition was met. <br>  Participants who are inexperienced in cryptanalysis would have to work hard enough to complete the task in this way, namely: <br><br><ol><li>  Understand what an encryption cycle differential is. </li><li>  Examine the concept of differential characteristic. </li><li>  Understand how substitution and permutation work. </li></ol><br>  The differential of the i-th encryption cycle is a pair of vectors a and b, such that a pair of open texts (x <sub>1</sub> and x <sub>2</sub> ) with a difference a can go after the i-th cycle into a pair of output texts (y <sub>1</sub> and y <sub>2</sub> ) with a difference b.  The differential characteristic is a sequence of single-cycle differentials, while the output text difference for the previous cycle coincides with the input text difference of the subsequent cycle. <br><br>  The block cipher has a block length and a key of 32 bits each (you can guess this by looking at condition 2 in the list).  Encryption, as already indicated in the list of the .docx document, is performed on 3 cycles, each of which contains a key XOR, replacement of 4-bit words (substitution), and two cycles contain a permutation (Permutation).  When performing a permutation, the bit from position i moves to position 9 * i + 4 (mod 32). <br><br>  By the way, the rearrangement caused considerable difficulties for the participants due to their nontriviality: at the input, the numbering of bits ranged from 1 to 32, and at the output - from 0 to 31 (example: Permutation (0x12345678) = 0xB3E29180).  However, after the publication of tips on Twitter, the participants began to actively pass the task! <br><br>  General algorithm for passing the task by the method of differential cryptanalysis: <br><ol><li>  Using a pair of open texts, we look at the difference for this pair at the output of 2 cycles </li><li>  Using a pair of output ciphertexts after 3 cycles, we perform their inverse transformations, calculating the inverse substitution and making XOR with the key. </li><li>  Calculate the difference for the converted ciphertexts. </li><li>  We compare the differences for the converted ciphertexts and for a pair of open texts. </li><li>  We are looking for matching bits, if any, increment the count of the number of matches. </li><li>  After going through all the pieces of the key (2 to 4 bits, total - 8 bits), we look for which (or for which) the greatest number of matches.  This will be the desired part of the key. </li><li>  We repeat, selecting other active blocks and build a new characteristic, to determine the already different part of the key.  We do, until either all 32 bits are opened, or until most of the key is opened ‚Äî the rest can be turned on. </li></ol><br><br><h6>  <i><b>Brutfors</b></i> </h6><br>  Let's proceed to the passage of the job by the method of brute force!  It was possible to implement a program that performs brute force in parallel on all processor cores.  In addition, of course, it was necessary to be careful when implementing the substitution and permutation. <br><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">ConsoleApplication2</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> progress = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> prev_progress = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> DateTime prev_date; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> complete = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reverse_bits</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> r = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; i++) { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> mask = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; i); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> mask_neg = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; (<span class="hljs-number"><span class="hljs-number">7</span></span> - i)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((b &amp; mask) == mask) { r |= mask_neg; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reverse_bits</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] array</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] r = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[array.Length]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; array.Length; i++) { r[i] = array[i].reverse_bits(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { DateTime start_date = DateTime.Now; progress = <span class="hljs-number"><span class="hljs-number">0</span></span>; prev_progress = <span class="hljs-number"><span class="hljs-number">0</span></span>; prev_date = DateTime.Now; Thread monitor = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(a =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (progress != <span class="hljs-number"><span class="hljs-number">0xFFFFFFFF</span></span> &amp;&amp; complete == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { Thread.Sleep(<span class="hljs-number"><span class="hljs-number">5000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> long_percent = ((progress * <span class="hljs-number"><span class="hljs-number">100</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span>) / <span class="hljs-number"><span class="hljs-number">0xFFFFFFFF</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> sec = (<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)(DateTime.Now - prev_date).TotalSeconds; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> speed = (<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)((progress - prev_progress) / sec); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"{0}.{1}% ... speed={2} left={3}"</span></span>, long_percent / <span class="hljs-number"><span class="hljs-number">1000</span></span>, long_percent % <span class="hljs-number"><span class="hljs-number">1000</span></span>, speed, <span class="hljs-number"><span class="hljs-number">0x100000000</span></span> - progress); prev_date = DateTime.Now; prev_progress = progress; } }); monitor.Start(<span class="hljs-number"><span class="hljs-number">0</span></span>); Parallel.For(<span class="hljs-number"><span class="hljs-number">0x00000000</span></span>, <span class="hljs-number"><span class="hljs-number">0xFFFFFFFF</span></span>, i =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] text = BitConverter.GetBytes((UInt32)<span class="hljs-number"><span class="hljs-number">0x5ABF054B</span></span>); Array.Reverse(text); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] key = BitConverter.GetBytes((UInt32)i); Array.Reverse(key); Crypt(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> text, key); Array.Reverse(text); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (BitConverter.ToUInt32(text, <span class="hljs-number"><span class="hljs-number">0</span></span>) == (UInt32)<span class="hljs-number"><span class="hljs-number">0x4CD3CA17</span></span>) { complete = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"KEY {0}"</span></span>, i.ToString(<span class="hljs-string"><span class="hljs-string">"X"</span></span>)); File.WriteAllText(i.ToString(<span class="hljs-string"><span class="hljs-string">"X"</span></span>) + <span class="hljs-string"><span class="hljs-string">".txt"</span></span>, i.ToString()); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Complete! time = "</span></span> + (DateTime.Now - start_date).ToString()); Console.ReadKey(); } Interlocked.Increment(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> progress); } ); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Complete! time = "</span></span> + (DateTime.Now - start_date).ToString()); Console.ReadKey(); } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] substitution_table = { <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Crypt</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] text, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] key</span></span></span><span class="hljs-function">)</span></span> { Xor(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> text, key); Substitution(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> text); Permutation(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> text); Xor(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> text, key); Substitution(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> text); Permutation(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> text); Xor(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> text, key); Substitution(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> text); Xor(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> text, key); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Substitution</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] text</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; i += <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> h = (text[i / <span class="hljs-number"><span class="hljs-number">2</span></span>] &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xF</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> l = (text[i / <span class="hljs-number"><span class="hljs-number">2</span></span>] &gt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xF</span></span>; h = substitution_table[h]; l = substitution_table[l]; text[i / <span class="hljs-number"><span class="hljs-number">2</span></span>] = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)((h &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) | l); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Permutation</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] text</span></span></span><span class="hljs-function">)</span></span> { BitArray bits = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BitArray(text.reverse_bits()); text = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[text.Length]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">32</span></span>; i++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> idx = ((i + <span class="hljs-number"><span class="hljs-number">1</span></span>) * <span class="hljs-number"><span class="hljs-number">9</span></span> + <span class="hljs-number"><span class="hljs-number">4</span></span>) % <span class="hljs-number"><span class="hljs-number">32</span></span>; text[idx / <span class="hljs-number"><span class="hljs-number">8</span></span>] |= (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)((bits[i] ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>) &lt;&lt; (idx % <span class="hljs-number"><span class="hljs-number">8</span></span>)); idx = idx; } text = text.reverse_bits(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Xor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] text, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] key</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; text.Length; i++) { text[i] ^= key[i]; } } } }</code> </pre> <br><br>  It is curious that for some pairs of open and corresponding encrypted texts the program could find more than one key (in particular, for the very first pair).  From the found value, as in the first part of the task, it was necessary to find the MD5 hash. </div><p>Source: <a href="https://habr.com/ru/post/258893/">https://habr.com/ru/post/258893/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258881/index.html">iSCSI 2.0 with FAS2xxx or the scaling path of a small data center</a></li>
<li><a href="../258883/index.html">MotoPress Review: Reinventing the Standard WordPress Text Editor</a></li>
<li><a href="../258885/index.html">Why a designer and developer should work together</a></li>
<li><a href="../258889/index.html">How we taught self-help cash desks</a></li>
<li><a href="../258891/index.html">Mastering Composer: Tips and Tricks for Using</a></li>
<li><a href="../258895/index.html">Video with DevConf 2014 :: PHP Cob @ cniki against kinofobov</a></li>
<li><a href="../258897/index.html">Automaton like a jet engine: real physics of unreal flight</a></li>
<li><a href="../258901/index.html">Universal soldier: how we developed and implemented an adaptive portal menu for all Mail.Ru projects</a></li>
<li><a href="../258903/index.html">Authorization for API using tokens</a></li>
<li><a href="../258905/index.html">HP Helion OpenStack Deployment on HP BladeSystem Blades</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>