<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create an environment for PyQt5 in Linux MInt (Ubuntu)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Qt has been updated to the fifth version a long time ago and with it PyQt, but finding information on them in the Russian-language segment is not an e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create an environment for PyQt5 in Linux MInt (Ubuntu)</h1><div class="post__text post__text-html js-mediator-article"><img src="http://habrastorage.org/getpro/habr/comment_images/61e/de0/326/61ede032691ef46e25cab19587aa682b.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/a22/122/644/a221226446afedd055b333e560e6474f.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/fed/8fb/6d0/fed8fb6d091b7ea35ff82ae956cf2f3e.png" alt="image"><br>  Qt has been updated to the fifth version a long time ago and with it PyQt, but finding information on them in the Russian-language segment is not an easy task.  Under the cat a detailed tutorial for those who are just starting to get acquainted with a bunch of Qt + python3. <br><br>  Objective: build and configure the environment, go from installing PyQt5 and creating a form in Qt Designer to running a portable binary under Windows (yes, that's right, developing for Mint, compiling for linux and windows). <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Installation paths </h2><br>  Based on the fact that we are completely new, I will try to use the paths in the system, which are used by default, or which we will create based on the following allocation logic: <br><ul><li>  All necessary files and folders are stored in the dev directory in the user's home directory, i.e.  <i>~ / dev /</i> </li><li>  We will use virtual environments for python and store them in the envs directory, i.e.  <i>~ / dev / envs /</i> </li><li>  Our projects will be stored in the src directory, i.e.  <i>~ / dev / src /</i> </li></ul><br>  If you already have your own file allocation hierarchy, you will have to adjust the paths in the commands below. <br><br><h2>  Setting up the environment </h2><br>  Create a directory structure.  Open the console and run: <br><pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ mkdir -p dev/envs dev/src <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> dev/envs</code> </pre> <br>  We put the package that we need to build in the future: <br><pre> <code class="bash hljs">sudo apt-get install python3-dev</code> </pre><br>  Put pip and virtualenv: <br><pre> <code class="bash hljs">wget https://bootstrap.pypa.io/get-pip.py sudo python3 get-pip.py rm get-pip.py sudo pip install virtualenv</code> </pre><br>  Create a virtual environment, activate it and update the packages: <br><pre> <code class="bash hljs">virtualenv --prompt=<span class="hljs-string"><span class="hljs-string">"[pyqt5] "</span></span> pyqt5 <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> pyqt5/bin/activate pip install -U pip setuptools</code> </pre><br>  We put Qt5.  When choosing the installation path, I left the ‚Äúdefault‚Äù <i>~ / Qt</i> .  If you choose another, you need to change the path in the commands below: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#  x64- # http://www.qt.io/download-open-source/#section-2 wget http://download.qt-project.org/official_releases/online_installers/qt-opensource-linux-x64-online.run chmod u+x qt-opensource-linux-x64-online.run ./qt-opensource-linux-x64-online.run rm qt-opensource-linux-x64-online.run #  x86- # http://www.qt.io/download-open-source/#section-2 # wget http://download.qt-project.org/official_releases/online_installers/qt-opensource-linux-x86-online.run # chmod u+x qt-opensource-linux-x86-online.run # ./qt-opensource-linux-x86-online.run # rm qt-opensource-linux-x86-online.run</span></span></code> </pre><br>  We put SIP - the module necessary for work of PyQt: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># http://www.riverbankcomputing.com/software/sip/download wget http://sourceforge.net/projects/pyqt/files/sip/sip-4.16.5/sip-4.16.5.tar.gz tar xvzf sip-4.16.5.tar.gz cd sip-4.16.5/ python configure.py -d ~/dev/envs/pyqt5/lib/python3.4/site-packages/ make sudo make install sudo make clean cd .. rm -rf sip*</span></span></code> </pre><br>  Put the PyQt: <br><pre> <code class="bash hljs">wget http://sourceforge.net/projects/pyqt/files/PyQt5/PyQt-5.4/PyQt-gpl-5.4.tar.gz tar xvzf PyQt-gpl-5.4.tar.gz <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> PyQt-gpl-5.4/ <span class="hljs-comment"><span class="hljs-comment">#      x64-,      . #     x86,   ~/Qt/5.4/gcc_64/bin/qmake   . #  ,    ,   python configure.py --destdir ~/dev/envs/pyqt5/lib/python3.4/site-packages/ --qmake ~/Qt/5.4/gcc_64/bin/qmake make sudo make install sudo make clean cd .. rm -rf PyQt*</span></span></code> </pre><br>  That's all.  The environment is set and ready to go.  To check, run the command: <br><pre> <code class="bash hljs">python -c <span class="hljs-string"><span class="hljs-string">"from PyQt5.QtCore import QT_VERSION_STR;from PyQt5.Qt import PYQT_VERSION_STR;from sip import SIP_VERSION_STR;print('Qt version: ',QT_VERSION_STR);print('SIP version: ',SIP_VERSION_STR);print('PyQt version: ',PYQT_VERSION_STR)"</span></span></code> </pre><br>  The answer should look like this: <br><pre> <code class="bash hljs">Qt version: 5.4.0 SIP version: 4.16.5 PyQt version: 5.4</code> </pre><br>  To check that everything is really installed in the virtual environment, open a new terminal window and repeat the verification command: <br><br>  In response, an ImportError error should appear.  A new terminal window can then be closed. <br><br><h2>  Create application </h2><br>  Go to the directory with our source code and create a project directory: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ../src/ mkdir pyqt_test <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> pyqt_test/</code> </pre><br>  Next we need Qt Designer.  If you didn‚Äôt change the Qt installation, you can start it with the command: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#         x64-. #  x86  gcc_64     . ~/Qt/5.4/gcc_64/bin/designer</span></span></code> </pre><br>  This is what Qt Designer runs on my system: <br><img src="https://habrastorage.org/files/78f/5a9/2b9/78f5a92b953743439f7cb6f79216dd15.png"><br>  In this guide, I will not elaborate on the description of the interface of the designer, we will go through the simplest way to the minimum ready form.  If you need more detailed information - Google It! <br><br>  In the dialog box, select "Widget" (the last item in the list of "templates / forms") and click the "Create" button.  The widget editing form will open: <br><img src="https://habrastorage.org/files/724/e2e/1ea/724e2e1ea23f4cc1bb66cbe50a50667a.png"><br><br>  Drag a button from the menu on the left to the form and save the resulting form with the name test.ui to the <i>~ / dev / src / pyqt_test / directory</i> : <br><img src="https://habrastorage.org/files/9cf/f5a/1fd/9cff5a1fdd7042ee8f3643e9bcfc3e65.png"><br>  <b>Tips &amp; Tricks:</b> By pressing [Crtl + R] you can run your form and ‚Äútouch‚Äù it in real time. <br><br>  We convert the interface file from the XML form into a clear python form: <br><pre> <code class="bash hljs">pyuic5 test.ui &gt; test_ui.py</code> </pre><br>  I do not want to edit anything in the file created by the PyQt converter, so we will describe our slots in a separate file.  Create a test_slots.py file and open it in your favorite editor.  The file fill should look something like this: <br><pre> <code class="python hljs"><span class="hljs-string"><span class="hljs-string">"""    . """</span></span> <span class="hljs-comment"><span class="hljs-comment">#    from datetime import datetime #        from test_ui import Ui_Form #   ,     class MainWindowSlots(Ui_Form): #    def set_time(self): #       '::' str_time = datetime.now().strftime('%H:%M:%S') #       self.pushButton.setText(str_time) return None</span></span></code> </pre><br>  Then, create another file called main.py, in which we describe the main logic: <br><pre> <code class="python hljs"><span class="hljs-string"><span class="hljs-string">"""   .   ,     . """</span></span> <span class="hljs-comment"><span class="hljs-comment">#        import sys #     from PyQt5.QtWidgets import QApplication, QWidget #       from test_slots import MainWindowSlots #    ,      class MainWindow(MainWindowSlots): #         def __init__(self, form): #       Ui_Form self.setupUi(form) #       self.connect_slots() #     def connect_slots(self): self.pushButton.clicked.connect(self.set_time) return None if __name__ == '__main__': #    app = QApplication(sys.argv) #   ,      UI window = QWidget() #    UI ui = MainWindow(window) #   window.show() #      "" sys.exit(app.exec_())</span></span></code> </pre><br>  This completes our application.  Run from console <br><pre> <code class="bash hljs">python main.py</code> </pre><br>  we should see a form with a button in the middle, clicking on which changes the name of the button to the system date. <br><img src="https://habrastorage.org/files/816/ca6/d5d/816ca6d5da324e8a82cfd6c72f5db4b4.png"><br><a name="build"></a><br><h2>  Packing in an executable for Linux </h2><br>  The packer will require some magic when installing. <br>  Download the package without installing it and unpack it: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ../../envs/pyqt/ pip install -d . cx_freeze tar xvfz cx_Freeze-4.3.4.tar.gz</code> </pre><br>  Open your favorite editor file cx_Freeze-4.3.4 / setup.py.  I am using SublimeText: <br><pre> <code class="bash hljs">subl cx_Freeze-4.3.4/setup.py</code> </pre><br>  We edit line number 84 so that it looks like in the picture: <br><img src="https://habrastorage.org/files/b06/557/93e/b0655793e7f649c684e3b6ddba34c152.png"><br>  <b>Tips &amp; Tricks:</b> Did you know that if you run SublimeText from a virtual environment, then the default interpreter will be from a virtual environment? <br><br>  Save the changes, close the editor, install the package, go back to the source folder, start the packaging: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> cx_Freeze-4.3.4 python setup.py install rm ../cx_Freeze-4.3.4.tar.gz <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ../../../src/pyqt_test cxfreeze main.py --target-dir=nix_build</code> </pre><br>  After that, a dist directory will appear in the source directory, in which among the many files you can see the file without the main extension - this is our binary, ready to run and carry.  Frankly, the size of the distributor is a bit upsetting: on my machine it is 70.1 MB, but you should not forget that there are packed there: python, PyQt, Qt and some system-wide libraries.  The cxfreeze build script is configured quite flexibly, but I will leave the selection of optimal parameters to the reader‚Äôs conscience.  I can only say that happiness lies in the compression, optimization and manual limitation of dependencies. <br><br><h2>  Pack in an executable file for Windows </h2><br>  Unfortunately, there will be no miracle.  I don‚Äôt know how to build exe directly from a Linux system.  Therefore, you have to dance with wine. <br>  We close the terminal opened at the very beginning: <br><pre> <code class="bash hljs">deactivate <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre><br>  Open a new, put the latest version of wine: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> dev sudo add-apt-repository ppa:ubuntu-wine/ppa sudo apt-get update sudo apt-get install wine1.7</code> </pre><br>  After that, download windows-versions of the packages already familiar to us and launch the installation from under wine: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># https://www.python.org/downloads/windows/ wget https://www.python.org/ftp/python/3.4.2/python-3.4.2.msi wine msiexec /i python-3.4.2.msi rm python-3.4.2.msi # http://www.riverbankcomputing.com/software/pyqt/download5 wget http://sourceforge.net/projects/pyqt/files/PyQt5/PyQt-5.4/PyQt5-5.4-gpl-Py3.4-Qt5.4.0-x32.exe wine PyQt5-5.4-gpl-Py3.4-Qt5.4.0-x32.exe rm PyQt5-5.4-gpl-Py3.4-Qt5.4.0-x32.exe # http://sourceforge.net/projects/cx-freeze/files/ wget http://downloads.sourceforge.net/project/cx-freeze/4.3.3/cx_Freeze-4.3.3.win32-py3.4.msi wine msiexec /i cx_Freeze-4.3.3.win32-py3.4.msi rm cx_Freeze-4.3.3.win32-py3.4.msi</span></span></code> </pre><br>  And then a little magic.  Follow the link: <br><pre> <code class="html hljs xml">http://www.lfd.uci.edu/~gohlke/pythonlibs/#cx_freeze</code> </pre><br>  Download the current version of cx_Freeze for our interpreter and put it on top of the official one: <br><pre> <code class="bash hljs">wine cx_Freeze-4.3.4.win32-py3.4.exe rm cx_Freeze-4.3.4.win32-py3.4.exe</code> </pre><br>  After that, it remains to check the performance.  Go to the directory with the source, open the wine terminal, execute the familiar build command: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> src/pyqt_test wine cmd cxfreeze main.py --target-dir=win_build</code> </pre><br>  It turned out that I did not have a windows machine at my disposal, so I was able to test the result only under wine.  Exit the wine terminal (exit command), close the terminal.  We go to distribute our program to everyone. <br><br>  PS: All sources <a href="https://github.com/zaharsk/pyqt_test">on github</a> </div><p>Source: <a href="https://habr.com/ru/post/248189/">https://habr.com/ru/post/248189/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248177/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ143 (January 12 - 18, 2015)</a></li>
<li><a href="../248179/index.html">A brief course of computer graphics: we write a simplified OpenGL do it yourself, article 3 of 6</a></li>
<li><a href="../248181/index.html">Home Raspberry shooting gallery</a></li>
<li><a href="../248185/index.html">Car Tutorial Guide (Unity3d) part 2 of 3</a></li>
<li><a href="../248187/index.html">What's new in CSS 4th level selectors?</a></li>
<li><a href="../248193/index.html">Deploying CUCM with VMware Workstation 10.0.3 and GNS3</a></li>
<li><a href="../248197/index.html">WPF: Binding without trivial converters</a></li>
<li><a href="../248199/index.html">7 secrets of successful trading on Amazon</a></li>
<li><a href="../248201/index.html">Cisco information security in 2014: a brief summary</a></li>
<li><a href="../248203/index.html">Test Automation with Ruby and WATIR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>