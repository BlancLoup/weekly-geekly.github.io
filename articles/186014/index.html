<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Background replacement in Gimpa - working solution</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the comments to the Clipping Magic post ... I lamented the impossibility of qualitatively separating the object from the background in Gimp. Since ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Background replacement in Gimpa - working solution</h1><div class="post__text post__text-html js-mediator-article">  In the comments to the <a href="http://habrahabr.ru/post/179851/">Clipping Magic</a> post <a href="http://habrahabr.ru/post/179851/">...</a> I lamented the impossibility of qualitatively separating the object from the background in Gimp.  Since May, I have been looking for a working method of replacing the background, so as not to suffer with Photoshop in Ubuntu, which has long been my only axis on the desktop.  After reading hundreds of lessons (including lessons on manually creating such masks in Photoshop, since the masks in the gimp are almost the same), I could not find a way that was as fast and as good as Refine Edges in CS5- 6  And yesterday, in the plug-in catalog on the Gimp official website, a plugin was posted that finally did the job. <br>  So, meet: <br><a name="habracut"></a><br><h4>  <a href="http://registry.gimp.org/node/28296">Color to Mask Pro</a> Plugin </h4><br>  Immediately I warn you that the plug-in can replace only a relatively uniform background.  With the motley background, nothing will work out, although you can try to prepare the motley background with the help of <a href="http://digilinux.ru/2009/01/27/ustranenie-defektov-kozhi-i-obshhiy-ozhivlyazh-kartinok-pri-pomoshhi-veyvletov/">wavelet analysis</a> , and then set this plugin on it.  But, unlike Refine Edges, the plugin does not require preliminary preparation of selection - you only need to take a pipette beforehand with the main background color and the color of the shadows (one of them should be set with the foreground color, the second with the back color). <br>  On the <a href="http://registry.gimp.org/node/28296">page of the plugin,</a> in principle, describes in detail how to use it. <br>  Therefore, the purpose of this note is to simply introduce you to a simple solution that has appeared, and give an example of using it on a much more complex image. <br><br>  At the beginning of May, I was lucky to participate (as a student) in a studio shooting in difficult ‚Äúfield‚Äù conditions - on a small patch of a flight of steps from the St. Petersburg Ice Palace, we launched a mini-studio to shoot participants of the German Treaties exhibition.  Since the ultimate goal of the shooting is to print a glossy booklet - all photos had to undergo a post-processing in the same style, one of the tasks of which was just to replace the crumpled blue fabric background with a decent looking gradient of the same tone.  And here I began to lag far behind the professional who organized the shooting: although photoshop runs in Linux, it works with annoying bugs, and on my not very new computer it is also terribly slow.  However, until yesterday, I could not find an adequate replacement. <br><br>  Since I needed a solution that would allow us to quickly process the photo from this shoot, I tried all the methods on the most difficult photo from the entire series: a photo of a girl in a blue dress, almost merging in color with the background, with backlit slightly disheveled red curls (all Pictures are clickable, you can download a full-size original from a Yandex disk): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="http://yadi.sk/d/asy6Ey836cc5A"><img src="https://habrastorage.org/storage2/c3d/b5b/8b9/c3db5b8b977d90bbffd312704f014c85.jpg"></a> <br><br>  At first, I prepared a little picture, using resynthesizer, covering the areas that are out of the general tone (see the <a href="http://yadi.sk/d/rrgg138D6cc8O">file on the Yandex disk</a> ). <br><br>  Then I duplicated the layer so that later, using a mask to hide the unsightly backdrop, I would leave the floor covering almost as in the original. <br><br>  From the copy of the layer, I took the approximate main background color with the pipette (to get a good separation of hair from the background, it is better to take the main color closer to the hair) - # 0149a6 and the approximate color of shadows from one of the dark areas - # 001333. <br><br>  Now the first step of the filter operation is the automatic creation of the preliminary mask.  In the Russian version of the gimp, the filter is located in the ‚ÄúLayer - Mask‚Äù menu. <br><br><img src="https://habrastorage.org/storage2/bcb/a40/d9d/bcba40d9d311bfe5f774d86ede973f0b.png"><br><br>  The filter needs to indicate that we are in the first step, and show which color is the main background color in the image ‚Äî the foreground or background color we chose.  The colors of the shadows, as can be seen from the window, will be considered transitional between the selected colors of the foreground and background. <br><br>  With the default settings, I got this mask: <br><br> <a href="http://yadi.sk/d/cAmNqPvp6ccSs"><img src="https://habrastorage.org/storage2/352/058/d56/352058d56e8bdb71772b2f3868d419b7.jpg"></a> <br><br>  If the result does not suit you at all, you can remove the layer (to facilitate editing in the first step, this is not a mask, but a separate layer, where you can change the transparency and calmly draw the desired mask with black and white brushes) and try again with different settings.  Or if the result is almost good, as in my case, you can paint the mask manually.  As you can see in the picture, the blue dress got into the background area, but this is absolutely unimportant - the main thing is that the light-white transitions on the borders of the dress and the background were carefully drawn on the mask, and the hair was well separated from the background.  And the middle of the dress (and other areas undeservedly assigned to the background areas) can be easily painted over with a white brush. <br>  So, literally after a few seconds of editing, we get the final version of the layer, which will then become our mask: <br><br> <a href="http://yadi.sk/d/BlyRzOfa6ccZG"><img src="https://habrastorage.org/storage2/37f/e8c/8b8/37fe8c8b8d1abcb95ca4e111fc367a4a.jpg"></a> <br><br>  Now we run the plugin a second time - in the plugin window, we indicate, respectively, that we are in the second step.  At this step, you can also change the settings of the plug-in, including making a ‚Äúrotation of the palette‚Äù to replace the translucent pixels of the layer with a different color (if you plan to replace the background with a very different color). <br><br>  Here is the result of the second step with the default settings: <br> <a href="http://yadi.sk/d/_hzOHoju6ccf8"><img src="https://habrastorage.org/storage2/062/a41/cb5/062a41cb5be4c938f50713186eb1c129.png"></a> <br><br>  We put an empty layer under it, fill it with a radial gradient, place the original image on top of all layers and leave only the bottom with a carpet covering from it using a gradient mask.  We also slightly retouch the main characters on the layer with no background, and here‚Äôs the final result: <br><br> <a href="http://yadi.sk/d/HjGIE0yG6ccnM"><img src="https://habrastorage.org/storage2/c40/bfc/5ac/c40bfc5ac3c9f602609ddbdaef31d587.jpg"></a> <br><br>  Since, when working with this filter, it is not necessary to spend time on the preliminary selection of the main objects - it allows you to significantly speed up the work of changing the background. <br><br>  A ‚Äúuniform‚Äù business result, if someone is interested, looks <a href="">like this</a> . </div><p>Source: <a href="https://habr.com/ru/post/186014/">https://habr.com/ru/post/186014/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../185998/index.html">Heroku and Russia</a></li>
<li><a href="../186000/index.html">BitMessage Protocol Description</a></li>
<li><a href="../186002/index.html">ABC: Always Be Coding (do not stop programming)</a></li>
<li><a href="../186004/index.html">About the peculiarities of lecture video filming</a></li>
<li><a href="../186010/index.html">Big report from InfoCom - mega-interesting exhibition of screens</a></li>
<li><a href="../186018/index.html">Big survey on mobile operating systems</a></li>
<li><a href="../186020/index.html">Mobile web development: some features and tips</a></li>
<li><a href="../186026/index.html">Service monitoring the status of services in the cloud and alert administrators</a></li>
<li><a href="../186034/index.html">Parallels Plesk Panel 11.5: what has appeared in the new version</a></li>
<li><a href="../186036/index.html">Testing the proposed value using the principles of a lean start-up and client development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>