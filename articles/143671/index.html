<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DRuby aka DRb - the foundation of distributed systems on Ruby. The principle of operation and bypassing pitfalls</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A book recently published The dRuby book - distributed and parallel computing with Ruby (translation of a Japanese book written by the author of the l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DRuby aka DRb - the foundation of distributed systems on Ruby. The principle of operation and bypassing pitfalls</h1><div class="post__text post__text-html js-mediator-article"> A book recently published The dRuby book - distributed and parallel computing with Ruby (translation of a Japanese book written by the author of the library itself).  In this article I will try to give an overview of the chapters of the book related to the DRb library.  If you want to get acquainted with the topic in more detail, the book can be <a href="http://pragprog.com/book/sidruby/the-druby-book">bought</a> or <a href="http://www.twirpx.com/file/822036/">downloaded</a> .  At once I will say that I will not speak in this post about stream synchronization, nor about the Rinda library. <br><br>  Suppose you are writing a system that works with more than one process.  For example, you have a web server that runs tasks for a long time in the background.  Or you just need to ensure that data is sent from one process to another and coordinated.  For such situations and need a library DRb.  It is written entirely in Ruby and is included in the standard library, so you can start working with it instantly.  To connect it you just need to write <code>require 'drb'</code> <br><br>  The virtues of the DRb library for the most part stem from the dynamism of the Ruby language itself. <br>  First of all, when spending minimal effort at the preparatory stage, then you work with objects without thinking about where they are located: in one process or in another.  The library completely masks all the technical details from you. <br>  Secondly, you are not obliged to strictly prescribe the interface.  Any Ruby object can expose its interface to the outside - so you can either take advantage of the functionality of one of the standard classes like <code>Hash</code> or <code>Queue</code> , or you can create your own class with any interface.  In addition, nothing prevents you from changing the interface directly during the execution, and even using <code>method_missing</code> to process any requests.  And, of course, updating the server interface doesn‚Äôt affect the client at all unless the client calls methods that change the signature or behavior.  Thus, the server and the client are as independent as possible. <br>  And finally, the client is not even obliged to know the classes of objects that the server returns to him, he can use them without it.  Thus, the server is free to hide as many details as he pleases. <br>  But, of course, there are pitfalls, and there are plenty of them.  Fortunately, dRuby is easy to understand, but the understanding of its structure allows most of the problems to be avoided.  The documentation for this library, unfortunately, does not clarify a lot of things, so the article will be interesting for both beginners and people who have already worked with the library. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  To check that everything works, let's open two irb terminals.  I admit that I do not know how great the differences are in ruby ‚Äã‚Äã1.8, so let's agree that we are discussing version 1.9 (especially since 1.8 - it will soon cease to be supported, hurray!) <br><br>  Conventionally, these two terminals are server and client.  The server must provide a front object that will receive requests.  This object can be any object: even an object of the built-in type, even a module with a specially created interface.  In turn, the client connects to the server and interacts with this object. <br>  Let's, for example, start the server in the first terminal and set up an ordinary array. <br><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'drb'</span></span> front = [] DRb.start_service(<span class="hljs-string"><span class="hljs-string">'druby://localhost:1234'</span></span>, front) front &lt;&lt; <span class="hljs-string"><span class="hljs-string">'first'</span></span> <span class="hljs-comment"><span class="hljs-comment">#       ,    -    DRb.thread.join</span></span></code> </pre><br>  Now connect the client.  We recognize the first element of the array and write one more element into the array. <br><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'drb'</span></span> DRb.start_service remote_obj = DRbObject.new_with_uri(<span class="hljs-string"><span class="hljs-string">'druby://localhost:1234'</span></span>) p remote_obj p remote_obj[<span class="hljs-number"><span class="hljs-number">0</span></span>] remote_obj &lt;&lt; <span class="hljs-string"><span class="hljs-string">'second'</span></span></code> </pre><br><br>  Now you can call <code>front[1]</code> from the first terminal and see that the string <code>'second'</code> is located there.  And you can connect another client, and from it also operate on the same front-end object. <br><br>  As you have already noticed, the server is started by the <code>DRb.start_service</code> command (watch the register!).  The method takes as an argument a string with the address of the form <code>'druby://hostname:port'</code> and the frontal object.  The front object is the object that will receive requests. <br>  When the server starts in a separate script, you must write <code>DRb.thread.join</code> at the end of the script.  The fact is that the DRb-server is started by a separate thread, and Ruby terminates the program as soon as the main thread has finished.  Therefore, if the main thread does not wait for the DRb-server's stream to be closed, then both streams will end early and the server will immediately become unavailable.  Be prepared for the fact that the execution of the <code>DRb.Thread.join</code> method blocks the current thread until the server is turned off. <br><br>  In order to connect to the server, you must call the <code>DRbObject.new_with_uri</code> method and pass as an argument the address where the server is started.  This method will return the proxy object <code>remote_obj</code> .  Requests (method calls) to the proxy object are automatically transferred to the object on the remote server, the method called is executed there, and then the result is returned to the client that called the method.  (However, not all methods are called on the server. For example, judging by the behavior, the <code>#class</code> method runs locally) <br>  The meaning of the <code>DRb.start_service</code> at the client will be discussed a little later. <br><br>  Let's still figure out how to execute the method of a remote object.  To do this, calling the proxy object method serializes (marshals) the method name and argument list, transmits the string using the TCP protocol to the server, which deserializes the call arguments, executes the method on the front object, serializes the result and sends it back to the client.  Everything looks simple.  In fact, you work with a remote object in the same way as with a normal object, and many of the actions for remote execution of the proxy method and the server hide from you. <br><br>  But not everything is so simple.  Remote method call - pleasure expensive.  Imagine that a method on the server "jerks" a variety of argument methods.  This would have turned into the fact that the server and the client, instead of performing calculations, would have addressed the lion's share of time to each other using a relatively slow protocol (and it‚Äôs good if the two processes are located on the same machine).  To prevent this, the arguments and the result between processes are passed by value, not by reference (the object marshaling stores only the internal state of the object, and does not know its <code>object_id</code> ‚Äî <code>object_id</code> , the object will be serialized first, and then deserialized will be only a copy of the original object, but not the same object, so the transfer is automatically made on a copy).  In Ruby, usually everything is passed by reference, and in dRuby, usually by value.  Thus, if you execute <code>front[0].upcase!</code>  on the server, the value of <code>front[0]</code> will change, and if you run <code>remote_obj[0].upcase!</code>  , then you will get the first element in upper case, but the value on the server will not change, since <code>remote_obj.[](0)</code> is a copy of the first element.  This call can be considered similar to the <code>front[0].dup.upcase!</code> <br>  However, you can always define the behavior of dRuby so as to pass arguments and the result by reference, but more on that later. <br><br>  Now it's time to talk about the first problem.  Not all objects can be marshaled.  For example, Proc- and IO-objects, as well as threads (Thread-objects) can not be marshalized and transferred by copy.  dRuby in this case comes as follows: if the marshalization has not worked, then the object is passed by reference. <br>  So, how is the object passed by reference?  Recall Sy.  Pointers are used for this purpose.  In Ruby, the role of the pointer is <code>object_id</code> .  To pass an object by reference, an object of class <code>DRbObject</code> . <br>  <code>DRbObject</code> is, in fact, a proxy object for passing by reference.  An instance of this <code>DRbObject.new(my_obj)</code> class <code>DRbObject.new(my_obj)</code> contains the <code>object_id</code> object <code>my_obj</code> and the URI of the server from which the object came.  This allows you to intercept the method call and transfer it to the very object on the remote machine (or other terminal) to which the method was intended. <br><br>  Let's make our server a method <br><br><pre> <code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">front</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">[]</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ind)</span></span></span></span> DRbObject.new(<span class="hljs-keyword"><span class="hljs-keyword">super</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  And from the client we will start the code. <br><br><pre> <code class="ruby hljs">remote_obj.[<span class="hljs-number"><span class="hljs-number">0</span></span>].upcase!</code> </pre><br><br>  The new method <code>#[]</code> did not return a copy of the first element, but a link, so after performing the <code>upcase!</code> method <code>upcase!</code>  the frontal object has changed, it is easy to check by executing, for example, the commands <code>puts remote_obj</code> or <code>puts front</code> from the client and server, respectively. <br><br>  But every time writing <code>DRbObject.new</code> - laziness.  Fortunately, there is another way to pass an object by reference, and not by value.  To do this, it is enough to make the object unmarsable.  This is easy to do, just add the <code>DRbUndumped</code> module to the object. <br><pre> <code class="ruby hljs">my_obj.extend DRbUndumped <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> DRbUndumped; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  Now the object <code>my_obj</code> and all objects of class <code>Foo</code> will be automatically passed by reference (and <code>Marshal.dump(my_obj)</code> will produce <code>TypeError 'can\'t dump'</code> ). <br><br>  I will give an example that I met in practice.  The server sets up a front hash in which the values ‚Äã‚Äãare tickets (from the inside, a ticket is a state machine).  Then <code>remote_obj[ticket_id]</code> issues a copy of the ticket.  But this does not allow us to change the state of the ticket on the server, only locally.  Let's DRbUndumped into the <code>Ticket</code> class.  Now we receive from a hash not a copy of the ticket, but a link to it - and any actions with it happen now not on the client, but directly on the server. <br><br>  And now it's time to remember the promise and tell you why you need to <code>DRb.start_service</code> the client <code>DRb.start_service</code> .  Imagine that you have an array of frontal objects on your server, as in the first example. <br>  Now let the client call the <code>remote_obj.map{|x| x.upcase}</code> <code>remote_obj.map{|x| x.upcase}</code> <br>  In fact, on the front object, the map method is invoked with a block argument.  And he, as we remember, does not work out to marshal.  So this block argument is passed by reference.  The <code>map</code> method on the server will access it with the <code>yield</code> instruction, which means the client is a server!  But since the client has to be a server from time to time, it means that he also has to start the DRb server using the <code>start_service</code> method.  It is not necessary to specify the URI of this server.  How it works from the inside I do not know, but it works.  And as you have already noticed, the differences between the client and the server are smaller than it might seem. <br><br>  There is a risk to stumble upon a new nuisance.  Suppose a method returned a link (not a copy) to an object generated directly in the method.  If the server did not save this object separately anywhere (for example, did not put it in a special hash), then the server has no link to it.  The client on the remote machine has, but the server does not!  Therefore, late or early, the <s>troll will come to you for the mail</s> for this object will come GC - garbage collector.  This means that after a while the link of the <code>DRbObject</code> type at the client will ‚Äúfade out‚Äù and will point to nowhere.  Attempting to access the methods of this object will cause an error. <br>  Therefore, we must take care that the server stores references to the returned objects, at least until they are used by the server.  There are several solutions for this: <br>  1) save all returned objects passed by reference to the array ‚Äî then the garbage collector will not collect them, because the reference is used; <br>  2) to transfer to the client the link in the block.  For example: <br>  Instead of this code: <br><pre> <code class="ruby hljs">Ticket.send <span class="hljs-symbol"><span class="hljs-symbol">:include</span></span>, DRbUndumped <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">front</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_ticket</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ticket</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">remote_obj</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_ticket</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">closed?</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">#   foo       . ,   start   .</span></span></span></span></code> </pre><br><br>  It should be written like this: <br><pre> <code class="ruby hljs">Ticket.send <span class="hljs-symbol"><span class="hljs-symbol">:include</span></span>, DRbUndumped <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">front</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_ticket</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">object_to_reference</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ticket</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">yield</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">object_to_reference</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">remote_obj</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_ticket</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">|</span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">|</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">closed?</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  A valid local variable on the server cannot be collected by the garbage collector.  This means that the link inside the block will be guaranteed to work. <br>  3) The book describes another way - you need to hook into the process of creating a link at the stage of receiving an <code>object_id</code> object and try at this point to delay the garbage collection process anyway.  You can automatically add an item to the hash and store the object forever (as you can guess, the memory will end sooner or later), you can store a link to the object and clear it manually, you can clear this hash every few minutes. <br>  The latter method can be implemented by executing <br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'drb/timeridconv'</span></span> DRb.install_id_conv(DRb::TimerIdConv.new)</code> </pre><br>  before starting the server.  For more information, see Chapter 11 of the book - Handling Garbage Collection.  It seems to me interesting and maybe after reading it you will have new ways to use the manipulation of the garbage collection process.  But still, I think that in practice it is better to use the second method - and provide links to the block.  More reliable and clearer. <br><br>  It remains to illuminate, probably the last moment.  Suppose that you pass an object to <code>Foo</code> as a link.  The client does not know about any class <code>Foo</code> and yet this does not prevent him from working with the object.  In essence, the client operates with an object of the <code>DRbObject</code> class.  Everything is as usual. <br>  Now imagine that you are not transmitting a link, but a copy.  Serialization on the server retains the state of the object and the name of its class.  The client received the string and tries to deserialize it.  Of course, this does not work for him, because the client cannot create an object of a nonexistent class <code>Foo</code> .  Then deserialization will return an object of type <code>DRb::DRbUnknown</code> , which will store a buffer with a marshalized object.  This object can be passed on (for example, to the task queue).  You can also find out the name of the class, load the appropriate library with the class, and call the <code>reload</code> method ‚Äî then another attempt will be made to deserialize.  it <br><br>  No, it‚Äôs still not the last moment.  I promised not to write about synchronization, but still I will say a few words. <br>  For distributed programming, synchronization of actions and the atomicity of operations are critical concepts.  The server starts in a separate thread.  And for each request to the server, a separate thread is automatically created in which this request is processed.  So it is simply necessary to prohibit different threads from accessing the same information at the same time.  So, programming distributed and parallel systems use: <br>  1) <code>lock = Mutex.new; lock.synchronize{ do_smth }</code> <code>lock = Mutex.new; lock.synchronize{ do_smth }</code> <br>  2) <code>MonitorMixin</code> standard library <code>MonitorMixin</code> <br>  3) classes of the standard library <code>Queue</code> , <code>SizedQueue</code> <br><br>  Good luck in using DRb!  I hope I prevented someone from spending many hours trying to understand why the object does not change, even though you use the destructive method, how to get the method to work on the client, the receiving block, and why the resulting link worked-worked ‚Äî and suddenly ceased. <br>  However, in the book you will find much more, especially about the library of Rinda and its fellows. </div><p>Source: <a href="https://habr.com/ru/post/143671/">https://habr.com/ru/post/143671/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143664/index.html">Which smartphone is the best in the world?</a></li>
<li><a href="../143665/index.html">Play with fonts?</a></li>
<li><a href="../143667/index.html">Clustering of duplicates in Yandex. Pictures</a></li>
<li><a href="../143668/index.html">Neural networks for dummies. Kohonen network</a></li>
<li><a href="../143670/index.html">Our first impressions about IP-telephony in 4G Yota LTE network</a></li>
<li><a href="../143672/index.html">Easy firmware update Raspberry Pi from Hexxeh</a></li>
<li><a href="../143673/index.html">Pending User Notifications on Node.js & Redis</a></li>
<li><a href="../143674/index.html">Character modeling and graphic design for a mobile game</a></li>
<li><a href="../143675/index.html">The digest of interesting news and materials from the world of ayti for the last week No. 5 (May 5 - 11, 2012)</a></li>
<li><a href="../143676/index.html">15 years ago the computer Deep Blue beat a man in chess</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>