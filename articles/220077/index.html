<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Text recognition methods</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Just yesterday, the 61st student scientific conference was held at the Southern Federal University in the city of Taganrog, where I presented a report...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Text recognition methods</h1><div class="post__text post__text-html js-mediator-article">  Just yesterday, the 61st student scientific conference was held at the Southern Federal University in the city of Taganrog, where I presented a report on methods for recognizing text on graphic images.  And I would like to share this with even more listeners and readers.  Who is interested in reading about the bikes of a novice student in this area, please under the cat. <br>  Pictures and code snippets are present. <br><a name="habracut"></a><br><h5>  Some theory </h5><br>  The topic of text recognition falls under the pattern recognition section.  And for a start, briefly about the recognition of images. <br>  Pattern recognition or pattern recognition theory is a branch of computer science and related disciplines that develops the basics and methods for classifying and identifying objects, phenomena, processes, signals, situations, etc. of objects that are characterized by a finite set of certain properties and attributes.  This definition gives us <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B8%25D1%258F_%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D0%25BE%25D0%25B7%25D0%25BD%25D0%25B0%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B7%25D0%25BE%25D0%25B2">Wikipedia</a> . <br><br>  She also claims that there are two main areas <br><ul><li>  Learning to recognize the abilities of living beings, explaining and modeling them; </li><li>  The development of the theory and methods of constructing devices designed to solve individual problems for applied purposes. </li></ul><br>  My work in the course work was carried out in the direction of the second paragraph. <br><br>  So, my topic is the recognition of text on graphic images and now we don‚Äôt have to talk about the importance of this subsection.  Everyone has long known that there are millions of old books that are stored in <s>high-security</s> vaults that only specialized personnel have access to.  The use of these books is prohibited because of their dilapidation and decrepitude, since it is possible that they can crumble right in the hands of the reader, but the knowledge they hold is undoubtedly a great treasure for humanity and therefore digitizing these books is so important.  This is exactly what the data processing specialists are doing. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's get even closer to the topic of text recognition.  It should be noted that under the recognition of the text usually understand the three main methods. <ul><li>  Comparison with pre-prepared template; </li><li>  Recognition using criteria, recognizable object; </li><li>  Recognition using self-learning algorithms, including using neural networks. </li></ul><br>  It should also be said that text recognition almost always goes along with detecting text on an image, but since I did not set this goal, the detection phase was omitted and replaced with a light preprocessing. <br><br>  Now about the work itself.  An application has been written that can recognize text when using images of high or medium quality, with little or no noise.  The application is able to recognize letters of the English alphabet, upper and lower case.  The image is submitted for recognition directly from the application itself. <br><br><h5>  Filtering and processing </h5><br>  Since the detection stage was omitted and the preprocessing stage was inserted, the image for the most part looks like this. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1be/aac/54a/1beaac54a3b3b8151dab78d4f05ff663.png"></div><br>  This image is processed by two filters.  Median and monochrome.  The application used a modified version of the median filter with an increase in the value of the red component. <br><div class="spoiler">  <b class="spoiler_title">Median filter</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Median</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Bitmap image</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrR = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrG = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arrB = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> outImage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bitmap(image); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; image.Width - <span class="hljs-number"><span class="hljs-number">1</span></span>; i++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">1</span></span>; j &lt; image.Height - <span class="hljs-number"><span class="hljs-number">1</span></span>; j++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; i1 &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; i1++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; j1 &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; j1++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> p = image.GetPixel(i + i1 - <span class="hljs-number"><span class="hljs-number">1</span></span>, j + j1 - <span class="hljs-number"><span class="hljs-number">1</span></span>); arrR[i1 * <span class="hljs-number"><span class="hljs-number">3</span></span> + j1] = ((pR + pG + pB) / <span class="hljs-number"><span class="hljs-number">3</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>; arrG[i1 * <span class="hljs-number"><span class="hljs-number">3</span></span> + j1] = ((pR + pG + pB) / <span class="hljs-number"><span class="hljs-number">3</span></span>) &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>; arrB[i1 * <span class="hljs-number"><span class="hljs-number">3</span></span> + j1] = ((pR + pG + pB) / <span class="hljs-number"><span class="hljs-number">3</span></span>) &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>; } Array.Sort(arrR); Array.Sort(arrG); Array.Sort(arrB); outImage.SetPixel(i, j, Color.FromArgb(arrR[<span class="hljs-number"><span class="hljs-number">3</span></span>], arrG[<span class="hljs-number"><span class="hljs-number">4</span></span>], arrB[<span class="hljs-number"><span class="hljs-number">5</span></span>])); } image = outImage; }</code> </pre> </div></div><br>  This filter is used to minimize noise and blur the sharp edges of the letters (serifs, etc.).  After that, the image is processed by monochrome.  That is, a clear binarization occurs, while the boundaries of the letters are clearly fixed. <br><div class="spoiler">  <b class="spoiler_title">Monochrome</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Monochrome</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Bitmap image, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> level</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; image.Height; j++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; image.Width; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> color = image.GetPixel(i, j); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sr = (color.R + color.G + color.B) / <span class="hljs-number"><span class="hljs-number">3</span></span>; image.SetPixel(i, j, (sr &lt; level ? Color.Black : Color.White)); } } }</code> </pre></div></div><br><h5>  Segmentation </h5><br>  After preprocessing, the image is segmented during recognition.  Again, since the detection stage is omitted, the following heuristics are adopted for the segmentation process.  It is assumed that the sentences of the text are arranged horizontally and do not create intersections with each other.  Then the segmentation task is easy. <br>  Sets the average distance between two letters in a word.  After that, the image is divided into lines by searching for full white stripes.  Further, these bands are divided into words by searching for white stripes of a certain width.  After all this, the highlighted words are transmitted to the final stage, and they are divided into letters.  Thus, at the output of the segmentation module, we have all the text represented by the images of the letters of this text. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e9/696/dd4/1e9696dd4e083dedc8054c4c203feec9.png"></div><br>  Immediately before recognition, the image is normalized and reduced to the size of templates prepared in advance. <br><br>  Next comes the recognition process itself.  For the user, there are two choices, using metrics and using a neural network. <br><br><h5>  Recognition </h5><br><h6>  Consider the first case - recognition using metrics. </h6><br>  A metric is a conditional function value that determines the position of an object in space.  Thus, if two objects are located close to each other, that is, they are similar (for example, two letters A written in a different font), then the metrics for such objects will coincide or be very similar.  Hamming metric was chosen for recognition in this mode. <br><br>  Hamming metric - a metric that shows how strongly objects are not similar to each other. <br><br>  This metric is often used to encode information and transfer data.  For example, after a transmission session, there is the following bit sequence (1001001) at the output, we also know that another bit sequence (1000101) should arrive.  We calculate the metric by comparing the parts of a sequence with the corresponding places from another sequence.  Thus, the Hamming metric in our case is equal to 2. Since the objects differ in two positions.  2- is the degree of dissimilarity, the more, the worse in our case. <br>  Therefore, in order to determine which letter is depicted, it is necessary to find its metric with all ready-made templates.  And the template whose metric will be closest to 0 will be the answer. <br><br>  But as practice has shown, counting only one metric does not give a positive result, as many letters are similar to each other.  for example, "j", "i", which leads to erroneous recognition. <br><br>  Then it was decided to come up with new metrics, allowing to distinguish between a certain set of letters in a separate class.  In particular, metrics were implemented (Reflections of horizontal and vertical, the prevalence of the weight of horizontal and vertical). <br><br>  The experiment revealed that such letters as ‚ÄúH‚Äù, ‚ÄúI‚Äù, ‚Äúi‚Äù, ‚ÄúO‚Äù, ‚Äúo‚Äù, ‚ÄúX‚Äù, ‚Äúx‚Äù, ‚Äúl‚Äù possess supersymmetry (they completely coincide with their reflections and significant pixels are distributed evenly throughout the image) therefore, they were moved to a separate class, which reduces the enumeration of all metrics by about 6 times.  Similar actions were taken in relation to other letters.  On average, brute force reduction is about 3 times. <br>  There is also a unique letter such as "J", which is one in its class, and therefore uniquely identified.  Further, for each class, the Hamming metric is calculated, which at this stage gives better performance than with direct use. <br>  When creating templates, the font consolas was used, therefore, if the recognizable text is written in this font, the recognition has an accuracy of about 99 percent.  When you change the font, accuracy drops to 70 percent. <br><br><h6>  The second method of recognition - using a neural network. </h6><br>  What is a neural network and in the biological sense, and in the mathematical, I will not tell, because this material is full on the Internet and I do not want to repeat it.  It can only be said that in the mathematical sense, the neural network is only a model of biological definition. <br><br>  There are also many varieties of these models.  In my work, I used the Kohonen single layer network. <br>  The principle of operation of the neural network is such that, after teaching a new image to the input layer of neurons, the network responds with the impulse of a particular neuron.  Since all neurons are named by the letters, therefore, the reacted neuron carries the recognition response.  Delving into the terminology of networks, we can say that a neuron, in addition to the output, also has many inputs.  These inputs describe the pixel value of the image.  That is, if there is a 16x16 image, the network should have 256 inputs. <br><br>  Each input is perceived with a certain coefficient and as a result, at the end of recognition a certain charge is accumulated on each neuron, the more the neuron will charge and emit a pulse. <br><br>  But in order for input coefficients to be properly configured, you must first train the network.  This is done by a separate training module.  This module takes the next image from the training set and feeds the network.  The network analyzes all positions of black pixels and flattens the coefficients minimizing the coincidence error using the gradient method, after which the image is mapped to a specific neuron. <br><div class="spoiler">  <b class="spoiler_title">Training</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Teach</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Bitmap img, Neuron correctNeuron</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vector = GetVector(img); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; vector.Length; i++) { vector[i] *= <span class="hljs-number"><span class="hljs-number">10</span></span>; correctNeuron.Weigths[i] = correctNeuron.Weigths[i] + <span class="hljs-number"><span class="hljs-number">0.5</span></span> * (vector[i] - correctNeuron.Weigths[i]); } }</code> </pre></div></div><br>  At the end of the training, each neuron is similar to the artist's canvas, where in places where the black pixels are most often found are the darkest paint (the charge value is greater), and where there is less often a very light tone. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1cb/c1a/54e/1cbc1a54e248fdeee78e88443a7eb205.png"></div><br>  All coefficients are aligned and ready to perceive images. <br>  The recognition accuracy with this method reaches 80 percent.  It should be noted that the accuracy of recognition depends on the training sample, both on the quantity and on the quality. <br><br>  Very helpful in writing the application: <br>  <a href="http://habrahabr.ru/post/143668/">Kohonen nets for dummies</a> <br>  <a href="http://habrahabr.ru/company/yandex/blog/208034/">A course of lectures from Yandex</a> <br><br>  <b>PS</b> I would like to hear constructive criticism about the style of writing, manner of presentation and completeness of coverage. </div><p>Source: <a href="https://habr.com/ru/post/220077/">https://habr.com/ru/post/220077/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220067/index.html">Nike leaves the market of wearable technology?</a></li>
<li><a href="../220069/index.html">Micro tools: centralized logging and viewer of icon sets Fontello</a></li>
<li><a href="../220071/index.html">Will mini drones be recharged from power lines?</a></li>
<li><a href="../220073/index.html">Zabbix + Iostat: monitoring the disk subsystem</a></li>
<li><a href="../220075/index.html">Challenge from Richard Feynman</a></li>
<li><a href="../220079/index.html">XSLT conversion of an internal table to ABAP with a generic reference type field</a></li>
<li><a href="../220081/index.html">Convenient development in Notepad ++</a></li>
<li><a href="../220083/index.html">Shit and sword</a></li>
<li><a href="../220087/index.html">Fly! (ASUS Fonepad Note 6)</a></li>
<li><a href="../220091/index.html">How my application received 455 thousand users in the first week</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>