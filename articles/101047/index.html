<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A study of simple crackme (part 2)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, Habralyudi! 
 This topic is a continuation of a series of articles on the study of kryakmis ( Part 1 ). In this article we will look at the mal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A study of simple crackme (part 2)</h1><div class="post__text post__text-html js-mediator-article">  Hello, Habralyudi! <br>  This topic is a continuation of a series of articles on the study of kryakmis ( <a href="http://habrahabr.ru/blogs/asm/99549/">Part 1</a> ).  In this article we will look at the mall out of town in a more complicated way than in the previous article.  The main difficulty will be in the encryption algorithm.  However, anyway, it will seem too simple to many. <br><a name="habracut"></a><br><h6>  Required material </h6><br>  So let's get started. <br>  From the tools I will only use the debugger.  <a href="http://www.crackmes.de/users/cromaxx/keygenme_4/download">Here</a> itself kryakmis. <br><br><h6>  Trial run </h6><br>  So, traditionally run it without a debugger, enter the fake data, and look at the result: <br><img src="https://habrastorage.org/storage/habraeffect/fd/81/fd81a702f94094deda323285d0737496.png" alt="image"><br>  This time there was no mesadbox.  It means that we will set a breakpoint on all calls to the GetDlgItemTextA function, since it is the one responsible for ‚Äúextracting‚Äù data from text fields in this case. <br><br><h6>  Tracing </h6><br>  We set breakpoints, run the program, enter the name and serial number and click Verify.  We see that bryak worked.  We take a step forward, thereby allowing the function to be executed.  The function was executed and the data (name) was pushed onto the stack at address 022F9C4.  We trace the program before the second function call.  The function was executed and the data (our serial) was pushed onto the stack at 022F8B4 address (I found this data from the arguments that go to the GetDlgItemTextA function). <br>  Further, here in this piece of code: <br><img src="https://habrastorage.org/storage/habraeffect/9f/2f/9f2fc2ca55c49b97d2009994da521098.png" alt="image"><br>  There is a procedure of modifying the name already familiar to us, in which each of its (name) symbol is replaced with the next one in the ASCII table. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  Main difficulty </h6><br>  Further the most interesting: <br><br> <code>004015FF |&gt; 8D45 F8 LEA EAX,DWORD PTR SS:[EBP-8] <br> 00401602 |. 0385 14FFFFFF ADD EAX,DWORD PTR SS:[EBP-EC] <br> 00401608 |. 83E8 70 SUB EAX,70 <br> 0040160B |. 0FBE10 MOVSX EDX,BYTE PTR DS:[EAX] <br> 0040160E |. 8B85 10FFFFFF MOV EAX,DWORD PTR SS:[EBP-F0] <br> 00401614 |. 31D0 XOR EAX,EDX <br> 00401616 |. 0FBE4D EC MOVSX ECX,BYTE PTR SS:[EBP-14] // . <br> 0040161A |. D3E0 SHL EAX,CL <br> 0040161C |. 8B8D 14FFFFFF MOV ECX,DWORD PTR SS:[EBP-EC] <br> 00401622 |. D3F8 SAR EAX,CL <br> 00401624 |. 8985 0CFFFFFF MOV DWORD PTR SS:[EBP-F4],EAX <br> 0040162A |. 8D85 10FFFFFF LEA EAX,DWORD PTR SS:[EBP-F0] <br> 00401630 |. FF00 INC DWORD PTR DS:[EAX] <br> 00401632 |. 8B85 0CFFFFFF MOV EAX,DWORD PTR SS:[EBP-F4] <br> 00401638 |. 3385 10FFFFFF XOR EAX,DWORD PTR SS:[EBP-F0] <br> 0040163E |. 894424 08 MOV DWORD PTR SS:[ESP+8],EAX <br> 00401642 |. 8B85 0CFFFFFF MOV EAX,DWORD PTR SS:[EBP-F4] <br> 00401648 |. 894424 04 MOV DWORD PTR SS:[ESP+4],EAX <br> 0040164C |. 8B85 10FFFFFF MOV EAX,DWORD PTR SS:[EBP-F0] <br> 00401652 |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 00401655 |. E8 36FCFFFF CALL craomaxx.00401290 <br> 0040165A |. 8985 08FFFFFF MOV DWORD PTR SS:[EBP-F8],EAX <br> 00401660 |. 8B85 0CFFFFFF MOV EAX,DWORD PTR SS:[EBP-F4] <br> 00401666 |. 3385 10FFFFFF XOR EAX,DWORD PTR SS:[EBP-F0] <br> 0040166C |. 894424 08 MOV DWORD PTR SS:[ESP+8],EAX <br> 00401670 |. 8B85 0CFFFFFF MOV EAX,DWORD PTR SS:[EBP-F4] <br> 00401676 |. 894424 04 MOV DWORD PTR SS:[ESP+4],EAX <br> 0040167A |. 8B85 10FFFFFF MOV EAX,DWORD PTR SS:[EBP-F0] <br> 00401680 |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 00401683 |. E8 2EFCFFFF CALL craomaxx.004012B6 <br> 00401688 |. 8985 04FFFFFF MOV DWORD PTR SS:[EBP-FC],EAX <br> 0040168E |. 8B85 04FFFFFF MOV EAX,DWORD PTR SS:[EBP-FC] <br> 00401694 |. 894424 04 MOV DWORD PTR SS:[ESP+4],EAX <br> 00401698 |. 8B85 08FFFFFF MOV EAX,DWORD PTR SS:[EBP-F8] <br> 0040169E |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 004016A1 |. E8 34FCFFFF CALL craomaxx.004012DA <br> 004016A6 |. 8985 00FFFFFF MOV DWORD PTR SS:[EBP-100],EAX <br> 004016AC |. 8B85 00FFFFFF MOV EAX,DWORD PTR SS:[EBP-100] <br> 004016B2 |. 2385 08FFFFFF AND EAX,DWORD PTR SS:[EBP-F8] <br> 004016B8 |. 3385 04FFFFFF XOR EAX,DWORD PTR SS:[EBP-FC] <br> 004016BE |. 8985 FCFEFFFF MOV DWORD PTR SS:[EBP-104],EAX <br> 004016C4 |. 8B85 00FFFFFF MOV EAX,DWORD PTR SS:[EBP-100] <br> 004016CA |. 894424 08 MOV DWORD PTR SS:[ESP+8],EAX <br> 004016CE |. 8B85 04FFFFFF MOV EAX,DWORD PTR SS:[EBP-FC] <br> 004016D4 |. 894424 04 MOV DWORD PTR SS:[ESP+4],EAX <br> 004016D8 |. 8B85 08FFFFFF MOV EAX,DWORD PTR SS:[EBP-F8] <br> 004016DE |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 004016E1 |. E8 D0FBFFFF CALL craomaxx.004012B6 <br> 004016E6 |. 8985 F8FEFFFF MOV DWORD PTR SS:[EBP-108],EAX <br> 004016EC |. 8B85 F8FEFFFF MOV EAX,DWORD PTR SS:[EBP-108] <br> 004016F2 |. 894424 0C MOV DWORD PTR SS:[ESP+C],EAX <br> 004016F6 |. 8B85 FCFEFFFF MOV EAX,DWORD PTR SS:[EBP-104] <br> 004016FC |. 894424 08 MOV DWORD PTR SS:[ESP+8],EAX <br> 00401700 |. 8B85 04FFFFFF MOV EAX,DWORD PTR SS:[EBP-FC] <br> 00401706 |. 894424 04 MOV DWORD PTR SS:[ESP+4],EAX <br> 0040170A |. 8B85 08FFFFFF MOV EAX,DWORD PTR SS:[EBP-F8] <br> 00401710 |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 00401713 |. E8 DCFBFFFF CALL craomaxx.004012F4 <br> 00401718 |. 8985 F4FEFFFF MOV DWORD PTR SS:[EBP-10C],EAX <br> 0040171E |. 8B85 10FFFFFF MOV EAX,DWORD PTR SS:[EBP-F0] <br> 00401724 |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 00401727 |. E8 F8FBFFFF CALL craomaxx.00401324 <br> 0040172C |. 8985 10FFFFFF MOV DWORD PTR SS:[EBP-F0],EAX <br> 00401732 |. 8B85 0CFFFFFF MOV EAX,DWORD PTR SS:[EBP-F4] <br> 00401738 |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 0040173B |. E8 E4FBFFFF CALL craomaxx.00401324 <br> 00401740 |. 8985 0CFFFFFF MOV DWORD PTR SS:[EBP-F4],EAX <br> 00401746 |. 8B85 08FFFFFF MOV EAX,DWORD PTR SS:[EBP-F8] <br> 0040174C |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 0040174F |. E8 D0FBFFFF CALL craomaxx.00401324 <br> 00401754 |. 8985 08FFFFFF MOV DWORD PTR SS:[EBP-F8],EAX <br> 0040175A |. 8B85 04FFFFFF MOV EAX,DWORD PTR SS:[EBP-FC] <br> 00401760 |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 00401763 |. E8 BCFBFFFF CALL craomaxx.00401324 <br> 00401768 |. 8985 04FFFFFF MOV DWORD PTR SS:[EBP-FC],EAX <br> 0040176E |. 8B85 00FFFFFF MOV EAX,DWORD PTR SS:[EBP-100] <br> 00401774 |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 00401777 |. E8 A8FBFFFF CALL craomaxx.00401324 <br> 0040177C |. 8985 00FFFFFF MOV DWORD PTR SS:[EBP-100],EAX <br> 00401782 |. 8B85 F4FEFFFF MOV EAX,DWORD PTR SS:[EBP-10C] <br> 00401788 |. 890424 MOV DWORD PTR SS:[ESP],EAX <br> 0040178B |. E8 94FBFFFF CALL craomaxx.00401324 <br> 00401790 |. 8985 F4FEFFFF MOV DWORD PTR SS:[EBP-10C],EAX ; | <br> 00401796 |. 8B85 F4FEFFFF MOV EAX,DWORD PTR SS:[EBP-10C] ; | <br> 0040179C |. 894424 1C MOV DWORD PTR SS:[ESP+1C],EAX ; | <br> 004017A0 |. 8B85 00FFFFFF MOV EAX,DWORD PTR SS:[EBP-100] ; | <br> 004017A6 |. 894424 18 MOV DWORD PTR SS:[ESP+18],EAX ; | <br> 004017AA |. 8B85 04FFFFFF MOV EAX,DWORD PTR SS:[EBP-FC] ; | <br> 004017B0 |. 894424 14 MOV DWORD PTR SS:[ESP+14],EAX ; | <br> 004017B4 |. 8B85 08FFFFFF MOV EAX,DWORD PTR SS:[EBP-F8] ; | <br> 004017BA |. 894424 10 MOV DWORD PTR SS:[ESP+10],EAX ; | <br> 004017BE |. 8B85 0CFFFFFF MOV EAX,DWORD PTR SS:[EBP-F4] ; | <br> 004017C4 |. 894424 0C MOV DWORD PTR SS:[ESP+C],EAX ; | <br> 004017C8 |. 8B85 10FFFFFF MOV EAX,DWORD PTR SS:[EBP-F0] ; | <br> 004017CE |. 894424 08 MOV DWORD PTR SS:[ESP+8],EAX ; | <br> 004017D2 |. C74424 04 7840&gt;MOV DWORD PTR SS:[ESP+4],craomaxx.004040&gt;; |ASCII "C%dr%do%dm%da%dx%dX" <br> 004017DA |. 8D85 18FFFFFF LEA EAX,DWORD PTR SS:[EBP-E8] ; | <br> 004017E0 |. 890424 MOV DWORD PTR SS:[ESP],EAX ; | <br> 004017E3 |. E8 C8070000 CALL &lt;JMP.&amp;msvcrt.sprintf&gt; ; \sprintf <br> 004017E8 |. C785 14FFFFFF &gt;MOV DWORD PTR SS:[EBP-EC],0 <br> 004017F2 |&gt; 8D85 18FFFFFF /LEA EAX,DWORD PTR SS:[EBP-E8] ; | <br> 004017F8 |. 890424 |MOV DWORD PTR SS:[ESP],EAX ; | <br> 004017FB |. E8 D0070000 |CALL &lt;JMP.&amp;msvcrt.strlen&gt; ; \strlen <br> 00401800 |. 3985 14FFFFFF |CMP DWORD PTR SS:[EBP-EC],EAX <br> 00401806 |. 73 2A |JNB SHORT craomaxx.00401832 <br> 00401808 |. 8D45 F8 |LEA EAX,DWORD PTR SS:[EBP-8] <br> 0040180B |. 0385 14FFFFFF |ADD EAX,DWORD PTR SS:[EBP-EC] <br> 00401811 |. 2D E0000000 |SUB EAX,0E0 <br> 00401816 |. FE00 |INC BYTE PTR DS:[EAX] <br> 00401818 |. 8D45 F8 |LEA EAX,DWORD PTR SS:[EBP-8] <br> 0040181B |. 0385 14FFFFFF |ADD EAX,DWORD PTR SS:[EBP-EC] <br> 00401821 |. 2D E0000000 |SUB EAX,0E0 <br> 00401826 |. FE00 |INC BYTE PTR DS:[EAX] <br> 00401828 |. 8D85 14FFFFFF |LEA EAX,DWORD PTR SS:[EBP-EC] <br> 0040182E |. FF00 |INC DWORD PTR DS:[EAX] <br> 00401830 |.^EB C0 \JMP SHORT craomaxx.004017F2 <br> 00401832 |&gt; 8B45 08 MOV EAX,DWORD PTR SS:[EBP+8] <br> 00401835 |. 894424 08 MOV DWORD PTR SS:[ESP+8],EAX</code> <br> <br>  Here is the creation of eight sequences consisting of numbers.  Further, six of them, using the function sprintf with the argument C% dr% do% dm% da% dx% dX, form such a string (n - sequence) - <br>  C <b>P1</b> r <b>P2</b> o <b>P3</b> m <b>P4 A P5</b> x <b>P6</b> X. <br>  Then there is a procedure that replaces each character of this huge string with the symbol following the following in the ASCII table (sorry, but I don‚Äôt know how to explain this in another way).  For example, there was a symbol A became C, there was 1 became 3, and so on.  And in the end it turns out ready, valid serial. <br>  The difficulty is that these lines are formed almost randomly.  That is, here we see not the traditional name modification, but rather a modification of the addresses contained in the registers and the stack.  Addresses change depending on the length of the name, so the names with the same length would have the same serial number if I hadn‚Äôt understood the principle of formation of which I can‚Äôt understand (it is commented).  The code above is not commented by me, since it mainly contains mathematical operations that are not difficult to understand. <br><br><h6>  Examples </h6><br>  Name example - Myname <br>  Example serial number: E99696;: 2t5284; 342q87;: 6458o696924: c3995: 68326z432575;: 22Z <br><br>  Example name2 - name <br>  Serial2 example - E73872238t9: 5274: q; 5257262o; 2752558c3: 72987622z3: 575886 :: Z <br>  Examples may not work for you, just because of the random value. <br><br>  Here is such an example of unsolvable keygenmy. <br><br>  PS The next article will be more interesting.  I will tell about manual unpacking, and about more complex encryption algorithms. </div><p>Source: <a href="https://habr.com/ru/post/101047/">https://habr.com/ru/post/101047/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../101040/index.html">The art of programming under Unix (and not only). Part One, "the rule of modularity"</a></li>
<li><a href="../101041/index.html">How to be a sysadmin and live up to 100 years</a></li>
<li><a href="../101043/index.html">Hivext Technologies - Winning the software development competition for young professionals Dev Generation 2010</a></li>
<li><a href="../101044/index.html">Dedicated by REG.RU</a></li>
<li><a href="../101046/index.html">Review of the Chinese tablet on Android</a></li>
<li><a href="../101048/index.html">A little about the Russian business Scartel</a></li>
<li><a href="../101052/index.html">A little more about astrophoto</a></li>
<li><a href="../101053/index.html">US military is attacking from the Internet</a></li>
<li><a href="../101054/index.html">Have a question? Ask Facebook</a></li>
<li><a href="../101055/index.html">Affiliate program as a sales channel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>