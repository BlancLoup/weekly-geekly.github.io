<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>zenity + wget = wget GUI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The topic is dedicated to those who do not like to download heavy files from the file sharing browser, as well as for those who want to better underst...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>zenity + wget = wget GUI</h1><div class="post__text post__text-html js-mediator-article">  The topic is dedicated to those who do not like to download heavy files from the file sharing browser, as well as for those who want to better understand the work of zenity. <br><br>  In Linux, there are a lot of different rockers, from console to heavy java applications, and my script is not another new rocker, it's just a nice eye-candy wrapper for standard Wget.  Although potentially he can do everything Wget can do, but I have implemented only its most basic functions.  The purpose of this script is to start the download via wget (untie it from the browser) and show the progress of its execution. <br><a name="habracut"></a><br>  There is a great <a href="">Zenity</a> utility in the GTK + <a href="">environment</a> which I will use to display the dialog boxes.  The link shows in detail all aspects of use, so I will not do a review, but I‚Äôll show you how I applied it. <br><br>  So, in my script I implemented minimal functionality to download comfortably: a list of links, proxy selection, http, ftp protocols, fixing the name of the uploaded file (very useful for videos from YouTube and the like), working from the command line (for work with the Firefox plugin <a href="https://addons.mozilla.org/ru/firefox/addon/220">FlashGot</a> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  <font color="#666666">#! / bin / bash</font> <br>  <font color="#666666">#Usage: ./guiwget</font> <br>  <font color="#666666"># with FlashGot arguments are: [URL] [REFERER] [POST]</font> <br>  <font color="#666666">#Dependens: wget&gt; = 1.11.1, zenity</font> <br></blockquote><br>  Yes Yes!  There is a difference in the versions of wget.  In version 1.11.1, wget began to support the option - content-disposition which is necessary when downloading from exchangers, for example, ifolder or youtube.  Also shown are options for FlashGot to be able to download flv-videos, and transfer downloads to wget. <br><blockquote>  <font color="#666666">#Get URL</font> <br>  <font color="#7a0874">[</font> <font color="#ff0000">"$ 1"</font> <font color="#7a0874">]</font> <font color="#000000">&amp;&amp;</font> <font color="#007800">url</font> = $ <font color="#000000">1</font> <font color="#000000">||</font>  <font color="#007800">url</font> = <font color="#ff0000">" <font color="#007800">$ (zenity --text-info --editable --title =" Enter URL list "--width = 500 --height = 300)</font> "</font> ; <br>  <font color="#7a0874">[</font> <font color="#ff0000">" <font color="#007800">$ url</font> "</font> <font color="#7a0874">]</font> <font color="#000000">||</font>  <font color="#7a0874">exit</font> <font color="#000000">0</font> ; <br></blockquote><br><br>  If the link was transmitted via FlashGot, then the parameters will be processed, and if it was launched directly, a window will appear asking for a list of URLs.  The script will exit if the download list is empty. <br><blockquote>  <font color="#666666">#Proxy</font> <br>  <font color="#007800">proxy1</font> = <font color="#ff0000">"Angola"</font> ;  <font color="#007800">proxy1addr</font> = <font color="#ff0000">"41.210.252.11:80"</font> ; <br>  <font color="#007800">proxy2</font> = <font color="#ff0000">Bangladesh</font> ;  <font color="#007800">proxy2addr</font> = <font color="#ff0000">"202.168.236.178:8080"</font> ; <br>  <font color="#007800">p</font> = <font color="#ff0000">" <font color="#007800">$ (zenity --list --title =" Select proxy "--print-column = 2 --column =" "--column =" "" $ proxy1 "" $ proxy1addr "" $ proxy2 "" $ proxy2addr ")</font> "</font> ; <br>  <font color="#7a0874">[</font> <font color="#ff0000">" <font color="#007800">$ p</font> "</font> = <font color="#ff0000">""</font> <font color="#7a0874">]</font> <font color="#000000">||</font>  <font color="#007800">proxy</font> = <font color="#ff0000">"export http_proxy = http: // <font color="#007800">$ p</font> "</font> ; <br></blockquote><br>  Working with a proxy, nothing unusual, for example, two proxies are shown.  In theory, you need to implement the work of importing a prepared proxy list, but I do not need it.  If you want to download directly, click the "Cancel" button in the window. <br><blockquote>  <font color="#666666">#Folder selection for file downloading</font> <br>  <font color="#007800">downdir</font> = <font color="#ff0000">" <font color="#007800">$ (zenity --file-selection --directory --title =" Select the directory to save ")</font> " "</font> ; <br>  <font color="#7a0874">[</font> <font color="#ff0000">" <font color="#007800">$ downdir</font> "</font> <font color="#7a0874">]</font> <font color="#000000">||</font>  <font color="#7a0874">exit</font> <font color="#000000">0</font> ; <br></blockquote><br>  Select a folder to download.  You can hard-write the path in the script, but I love the variety :) <br><br>  Setting parameters is over, the most basic work begins: <br><blockquote>  <font color="#000000">for</font> urs <font color="#000000">in</font> <font color="#007800">$ url</font> <br>  <font color="#000000">do</font> <br>  <font color="#666666">#Log file</font> <br>  <font color="#007800">output</font> = <font color="#ff0000">"/ tmp / <font color="#780078">` date +% N` -log</font> "</font> ; <br>  <font color="#666666">#Wget start</font> <br>  <font color="#007800"><font color="#c20cb9">id</font></font> = $ <font color="#7a0874">(</font> <font color="#007800">$ proxy</font> ; <font color="#c20cb9">wget</font> <font color="#660033">-b</font> <font color="#660033">-o</font> <font color="#ff0000">" <font color="#007800">$ output</font> "</font> <font color="#660033">-P</font> <font color="#ff0000">" <font color="#007800">$ downdir</font> "</font> <font color="#660033">--referer</font> = <font color="#ff0000">"$ 2"</font> <font color="#660033">--post-data</font> = <font color="#ff0000">"$ 3"</font> <font color="#ff0000">" <font color="#007800">$ urs</font> "</font> <font color="#000000">|</font> <font color="#c20cb9">egrep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0- 9] + "</font> <font color="#7a0874">)</font> ; <br>  <font color="#7a0874">[</font> <font color="#ff0000">" <font color="#007800">$ id</font> "</font> <font color="#7a0874">]</font> <font color="#000000">||</font>  <font color="#7a0874">exit</font> <font color="#000000">0</font> ; <br></blockquote><br>  We start wget with the received parameters, send it to the background, write the download progress in the log, which will be processed, remember the process id. <br><blockquote>  <font color="#666666">#Name file and size</font> <br>  <font color="#007800">h</font> = <font color="#ff0000">""</font> ; <br>  <font color="#000000">while</font> <font color="#7a0874">[</font> <font color="#ff0000">" <font color="#007800">$ h</font> "</font> == <font color="#ff0000">""</font> <font color="#7a0874">]</font> ;  <font color="#000000">do</font> <br>  <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#660033">-x</font> <font color="#000000">/</font> proc <font color="#000000">/</font> <font color="#007800">$ id</font> <font color="#7a0874">]</font> <br>  <font color="#000000">then</font> <br>  <font color="#007800">h</font> = $ <font color="#7a0874">(</font> <font color="#c20cb9">egrep</font> <font color="#660033">-o</font> <font color="#ff0000">"[^ \ /] + '. $"</font> <font color="#007800">$ output</font> <font color="#7a0874">)</font> ; <br>  <font color="#7a0874">[</font> <font color="#ff0000">" <font color="#007800">$ h</font> "</font> = <font color="#ff0000">""</font> <font color="#7a0874">]</font> <font color="#000000">&amp;&amp;</font> <font color="#007800">h</font> = $ <font color="#7a0874">(</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">'/RETR/s/.*RETR \ ([[:: print:]] * \) ... done. $ / \ 1 / p'</font> <font color="#007800">$ output</font> <font color="#7a0874">)</font> ; <br>  <font color="#007800">realname</font> = <font color="#ff0000">" <font color="#007800">$ {h% \ '.}</font> "</font> ; <br>  <font color="#007800">downfile</font> = <font color="#ff0000">" <font color="#007800">$ {realname %% \? *}</font> "</font> ; <br>  <font color="#7a0874">[</font> <font color="#ff0000">" <font color="#007800">$ realname</font> "</font> <font color="#000000">!</font>  = <font color="#ff0000">" <font color="#007800">$ downfile</font> "</font> <font color="#7a0874">]</font> <font color="#000000">&amp;&amp;</font> <font color="#7a0874">[</font> <font color="#660033">-f</font> <font color="#ff0000">" <font color="#007800">$ downdir</font> / <font color="#007800">$ downfile</font> "</font> <font color="#7a0874">]</font> <font color="#000000">&amp;&amp;</font> <font color="#007800">downfile</font> = <font color="#000000">`</font> <font color="#c20cb9">date</font> + <font color="#000000">%</font> <font color="#007800">N`</font> <font color="#ff0000">"_"</font> <font color="#007800">$ downfile</font> ; <br>  <font color="#000000">else</font> <br>  zenity <font color="#660033">--text-info</font> <font color="#660033">--title</font> = <font color="#ff0000">"Error"</font> <font color="#660033">--filename</font> = <font color="#007800">$ output</font> <font color="#660033">--width</font> = <font color="#000000">700</font> <font color="#660033">--height</font> = <font color="#000000">400</font> ; <br>  <font color="#007800">h</font> = <font color="#ff0000">"FAIL"</font> ; <br>  <font color="#c20cb9">rm</font> <font color="#007800">$ output</font> ; <br>  <font color="#000000">fi</font> <br>  <font color="#000000">done</font> ; <br>  <font color="#7a0874">[</font> <font color="#ff0000">" <font color="#007800">$ h</font> "</font> == <font color="#ff0000">"FAIL"</font> <font color="#7a0874">]</font> <font color="#000000">&amp;&amp;</font> <font color="#7a0874">continue</font> ; <br>  <font color="#007800"><font color="#c20cb9">size</font></font> = $ <font color="#7a0874">(</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"Length:"</font> <font color="#007800">$ output</font> <font color="#000000">|</font> <font color="#c20cb9">tail</font> <font color="#660033">-1</font> <font color="#000000">|</font> <font color="#c20cb9">egrep</font> <font color="#660033">-o</font> <font color="#ff0000">"\ (. + \)"</font> <font color="#000000">|</font> <font color="#c20cb9">cut</font> <font color="#660033">-d</font> <font color="#ff0000">"("</font> <font color="#660033">-f2</font> <font color="#000000">|</font> <font color="#c20cb9">cut</font> <font color="#660033">-d</font> <font color="#ff0000">")"</font> -f1 <font color="#7a0874">)</font> ; <br></blockquote><br>  We define the file name, size and generally make sure that the server gives us the file, if something goes wrong, a window with a log is shown, where wget usually writes exactly what is wrong.  The variable downfile is needed in order to correctly display the file name, as well as to turn the file name file? Var = 1 &amp; var = 2 into file. <br>  One nuance - the work goes with the log in Russian and Russian words are intercepted, if you have it wrong, correct the words ‚Äúready‚Äù and ‚ÄúLength‚Äù in your script. <br><blockquote>  <font color="#666666">#Grafical progressbar</font> <br>  <font color="#7a0874">(</font> <font color="#c20cb9">tail</font> <font color="#660033">-f</font> <font color="#660033">--pid</font> = <font color="#007800">$ id</font> <font color="#007800">$ output</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-u</font> <font color="#660033">-n</font> <font color="#ff0000">'s /.* \. [] * \ ([[:: print:]] * \)% [] * \ ([[:: :]] * \) \ ([[::]] * \) $ / # '</font> <font color="#ff0000">" <font color="#007800">$ downfile</font> "</font> <font color="#ff0000">': '</font> <font color="#007800">$ size</font> <font color="#ff0000">' \ 1% [\ 2B \ / s] (\ 3) \ n \ 1 / p '</font> <font color="#7a0874">)</font> <font color="#000000">|</font>  zenity <font color="#660033">--title</font> = <font color="#ff0000">"Loading file <font color="#007800">$ p</font> "</font> <font color="#660033">--progress</font> <font color="#660033">--percentage</font> = <font color="#000000">0</font> <font color="#660033">--auto-close</font> <br>  <font color="#7a0874">[</font> <font color="#007800">$?</font>  <font color="#660033">-eq</font> 0 <font color="#7a0874">]</font> <font color="#000000">&amp;&amp;</font> notify-send <font color="#ff0000">"Download completed"</font> <font color="#ff0000">"File: <font color="#007800">$ downfile</font> "</font> <font color="#000000">||</font>  <font color="#7a0874">(</font> <font color="#7a0874">[</font> <font color="#660033">-x</font> <font color="#000000">/</font> proc <font color="#000000">/</font> <font color="#007800">$ id</font> <font color="#7a0874">]</font> <font color="#000000">&amp;&amp;</font> <font color="#c20cb9">kill</font> <font color="#007800">$ id</font> <font color="#000000">||</font> zenity <font color="#660033">--text-info</font> <font color="#660033">--title</font> = <font color="#ff0000">"Error"</font> <font color="#660033">--filename</font> = <font color="#007800">$ output</font> <font color="#660033">--width</font> = <font color="#000000">700</font> <font color="#660033">--height</font> = <font color="#000000">400</font> <font color="#7a0874">)</font> ; <br>  <font color="#c20cb9">mv</font> <font color="#ff0000">" <font color="#007800">$ downdir</font> / <font color="#007800">$ realname</font> "</font> <font color="#ff0000">" <font color="#007800">$ downdir</font> / <font color="#007800">$ downfile</font> "</font> ; <br>  <font color="#666666">#Clean</font> <br>  <font color="#c20cb9">rm</font> <font color="#007800">$ output</font> ; <br>  <font color="#000000">done</font> </blockquote><br>  And here is my know-how, telling how it works. <br>  tail -f --pid is ideal for monitoring the log, and it also monitors the pid of the process, so that when the process with the specified pid is completed, tail also stops the operation of the pipeline.  The stream tail sends to the stream (unlike awk) sed file of the wget log file, which processes it, extracts the necessary information and formats it properly, and then the text comes to zenity. <br>  I will a little explain, in zenity --progress it is necessary to give the text in the form: <br><blockquote>  # text to display <br>  0 <br>  # text to display <br>  ten <br>  ... <br></blockquote><br>  where the second line is the number of percent.  This conversion from the wget log is done by tail + sed.  Then there is error handling or a pop-up message. If the download was completed successfully, the file should also be renamed, if necessary. <br><br>  Well, that's it, save the file where it suits you, set the execution bit, add the launch button to the panel and use or send tasks via Firefox + FlashGot. <br><br>  And the final touch, in order to defeat Rapidshare and other file sharing services that do not like link interceptors, add the following lines to the .wgetrc file: <br><blockquote>  header = Accept-Language: ru, en-us; q = 0.7, en; q = 0.3 <br>  header = Accept: text / html, application / xhtml + xml, application / xml; q = 0.9, * / *; q = 0.8 <br>  header = Accept-Encoding: gzip, deflate <br>  header = Accept-Charset: UTF-8, * <br>  header = Keep-Alive: 300 <br>  header = Connection: keep-alive <br>  user_agent = Mozilla / 5.0 (X11; U; Linux i686; en; rv: 1.9.1.2) Gecko / 20090804 Shiretoko / 3.5.2 <br>  content_disposition = on <br></blockquote><br>  User agent correct in accordance with your browser. <br><br>  The script can be taken here: <a href="">nebulosa2007.narod.ru/guiwget.tar.gz</a> </div><p>Source: <a href="https://habr.com/ru/post/68668/">https://habr.com/ru/post/68668/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../68663/index.html">BY Perl Too</a></li>
<li><a href="../68664/index.html">Aluminum coating of fine grinding and finishing NeoWood</a></li>
<li><a href="../68665/index.html">Results of the first year</a></li>
<li><a href="../68666/index.html">Youtube will show Hollywood movies online</a></li>
<li><a href="../68667/index.html">Matrix Phone 02</a></li>
<li><a href="../68670/index.html">Atom based on Intel Atom</a></li>
<li><a href="../68676/index.html">Ruby And Rails barcamp - Kiev, September 26</a></li>
<li><a href="../68677/index.html">Google received a patent for its homepage.</a></li>
<li><a href="../68678/index.html">Picnic Plus Cooladio Solar Cooler Backpack</a></li>
<li><a href="../68680/index.html">Supercomputers go to SSD?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>