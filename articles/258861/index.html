<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introducing XACML - the standard for Attribute-Based Access Control</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous article, we talked about what Attribute-Based Access Control is and what are its advantages compared to the most common Role-Based Acc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introducing XACML - the standard for Attribute-Based Access Control</h1><div class="post__text post__text-html js-mediator-article">  In the <a href="http://habrahabr.ru/company/custis/blog/248649/">previous</a> article, we talked about what Attribute-Based Access Control is and what are its advantages compared to the most common Role-Based Access Control today.  It's time to review ABAC in more detail, through an existing standard called <a href="https://www.oasis-open.org/committees/tc_home.php%3Fwg_abbrev%3Dxacml">XACML</a> . <br><br>  The standard is experiencing the third and, most likely, not the last edition, its history dates back to 2003.  He oversees and supports the standard organization of <a href="https://www.oasis-open.org/">OASIS</a> .  This standard describes the necessary system components, their purpose, the way they interact and use.  In fact, it covers everything you need, to the smallest detail. <br><br>  This article will look at how to express business rules in the form of security policies, the main components of a security system, its integration and other aspects that are not affected by the standard, but are equally important and interesting.  I invite all readers to get acquainted with these issues in more detail.  Any comments, comments, questions and criticisms are also welcome. <br><a name="habracut"></a><br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Security policies</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Rule</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Policy</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Policy set</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">The main components of the system</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Policy Administration Point</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Policy information point</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Policy decision point</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Policy Enforcement Point</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Example</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">What's left overs</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Outside the standard</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Attribute can be any</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Interface and Authorization Check</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Data filtering</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Admin panel concept</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Editing policies</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Editing a policy set</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Policy search</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Actions available in the specified context</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Testing policy execution</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Application Integration</a> <br>  <a href="https://habr.com/ru/company/custis/blog/258861/">Afterword</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We will begin our review of the standard with an overview of changes in business rules and continue with an overview of the tools and ways to handle these business rules. <br><br><a name="securePolicy"></a><h1>  Security policies </h1><br>  Any business rule that is responsible for the possibility of performing an action or access to an object answers the question ‚ÄúIs there access?‚Äù And gives one of two answer options: ‚ÄúYes‚Äù or ‚ÄúNo‚Äù.  And the condition of such a business rule is reduced to a set of logical expressions, the calculation of which gives one of two possible answers.  Therefore, security policies are a logical expression that operates on attributes and constant values. <br><br>  Let's start with a closer look at the security policies themselves and how the standard describes them. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b5d/de3/501/b5dde35015a244b185f94c7d6294e8d2.PNG"></div><br>  Although this scheme from the standard may look a bit intimidating at first glance, everything is quite simple in it.  The picture shows the hierarchy of basic XACML objects used to express business rules.  The elementary particle of hierarchy is the rule ( <i>rule</i> ).  Rules are combined into policies ( <i>policy</i> ), which, in turn, are combined into sets of policies ( <i>policy set</i> ). <br><br><a name="rule"></a><h2>  Rule </h2><br>  As described in the standard, a <i>rule</i> cannot live by itself, it must necessarily be included in the <i>policy</i> .  This means that the mechanism for calculating access rights operates with <i>rules</i> only in the composition of <i>policies</i> and nothing else.  Nevertheless, the <i>rule</i> is the most saturated element in terms of business sense. <br><br>  The <i>rule</i> itself consists of several parts: <br><ul><li>  target ( <i>target</i> ); </li><li>  effect </li><li>  condition; </li><li>  obligation ( <i>obligation</i> ); </li><li>  recommendations ( <i>advice</i> ). </li></ul><br><br>  <i>The goal</i> is the same for both <i>rules</i> , <i>policies</i> and <i>policy groups</i> .  Therefore, the description here is true for them.  <i>A goal</i> is a logical expression that should consist only of attributes and constants.  The <i>goal is</i> usually made that part of the business rule that meets this requirement.  The main point of dividing a business rule into parts is to quickly sift out inappropriate <i>rules</i> , <i>policies,</i> or <i>groups of policies</i> .  For what it is needed - will be discussed in more detail in the description of the <a href="https://habr.com/ru/company/custis/blog/258861/">PDP</a> . <br><br>  The rest of the business rule (if there is one) containing a more complex, dynamically calculated logical expression must be placed in another part of the <i>rule</i> - the condition ( <i>condition</i> ).  Those elements that can be specified in the <i>condition</i> , their format and everything connected with them are also described in detail in the standard, but their analysis is beyond the scope of this article. <br><br>  Business rules can be either permissive or prohibitive.  To indicate this, there is another part in the rule - the effect.  It can be either ‚Äú <i>permit</i> ‚Äù or ‚Äúdeny‚Äù ( <i>deny</i> ).  The most important thing to know is that the <i>effect of the</i> <i>rule</i> works only in the case of a positive calculation ( <i>evaluate</i> ) of this <i>rule</i> .  That is, the <i>effect</i> is applied only in the case when the result of the calculation of the logical condition in the <i>target</i> and in the <i>condition</i> is ‚Äútrue‚Äù ( <i>true</i> ).  In the case when the result of evaluating a logical expression of a <i>goal</i> or <i>condition</i> is <i>false</i> , the result of the <i>rule</i> evaluation will be ‚Äúnot applicable‚Äù ( <i>not applicable</i> ).  If in the process of calculating the logical condition of the <i>goal</i> or <i>condition</i> an error occurred, the result of the <i>rule</i> evaluation will be ‚Äú <i>indeterminate</i> ‚Äù.  Thus, the result of the <i>rule</i> calculation can be one of four values: ‚Äú <i>allow</i> ‚Äù, ‚Äú <i>prohibit</i> ‚Äù, ‚Äú <i>not applicable</i> ‚Äù, ‚Äú <i>not defined</i> ‚Äù. <br><br>  Consider the example of the formation of a fairly simple <i>rule</i> . <br><br><img src="https://habrastorage.org/files/d2c/da0/d0e/d2cda0d0e6be413bb8f7c4ff0ca94fb3.PNG"><br><br>  The first logical condition is a comparison of an attribute with a constant, and it is better to place it in the <i>target of the</i> <i>rule</i> (although it is possible to put it in a <i>condition</i> ).  The second logical condition is a comparison of two attributes.  It can only be placed in the <i>condition of the</i> <i>rule</i> .  Since the business rule is permissive, the effect will be defined as ‚Äú <i>allow</i> ‚Äù.  As a result, we get this <i>rule</i> : <br><br><img src="https://habrastorage.org/files/3df/feb/5cd/3dffeb5cd80f4b02a2277d18c109bea0.PNG"><br><br><a name="obligation"></a>  In addition to the function of deciding whether to grant access rights to the security system, additional functional requirements may be imposed.  An example of such a function might be a security audit.  To solve this kind of problems in the standard there are <i>obligations</i> and <i>recommendations</i> .  By and large, the difference between them lies only in the fact that the <i>obligations</i> must necessarily be fulfilled, and the <i>recommendations</i> can be ignored.  Both <i>obligations</i> and <i>recommendations</i> describe the <i>effect of the</i> <i>rule</i> to which they apply, the action to be performed, and the expressions for obtaining the parameters of this action based on the current context. <br><br>  Consider the example of a simple commitment.  If there is a requirement for the security system to send an email to the owner of the object when someone interacts with it, then for this you can make a <i>commitment</i> that will look like this: <br><br><img src="https://habrastorage.org/files/b5f/764/49f/b5f76449f886414faa01e34109c2df22.PNG"><br><br>  As a <i>recommendation</i> , for example, a description of the action of logging some information for debugging purposes can be specified. <br><br><a name="policy"></a><h2>  Policy </h2><br>  <i>A policy is</i> used to merge a set of <i>rules</i> .  Typically, a set of such <i>rules</i> is one business rule.  Thus, several tasks are solved at once.  First, small portions of the logical conditions expressed in the <i>rules</i> can be easily reused without duplicating these conditions.  Secondly, such a division into parts facilitates the understanding of the entire business rule and simplifies its maintenance. <br><br>  <i>The policy</i> consists of: <br><ul><li>  targets ( <i>target</i> ); </li><li>  rules; </li><li>  <i>rule</i> combination <i>algorithm</i> ; </li><li>  obligations ( <i>obligation</i> ); </li><li>  recommendations ( <i>advice</i> ). </li></ul><br>  As mentioned earlier, the <i>goal is</i> needed to quickly screen out inappropriate <i>policies</i> .  For what it is needed - will be discussed further in the <a href="https://habr.com/ru/company/custis/blog/258861/">PDP</a> review. <br><br>  The <i>rule</i> set simply lists all the <i>rules</i> included in this <i>policy</i> .  The result of the <i>policy</i> calculation is one particular value, as is the case with the <i>rules</i> .  This means that from the results of the evaluation of all the <i>rules</i> included in the <i>policy</i> it is necessary to obtain only one of the four available values.  To obtain such a value from the results of the calculation of all <i>rules</i> , the <i>policy</i> combination algorithm applied for the <i>policy</i> is applied.  The standard defines several different algorithms that may be useful in different situations.  For example, "prohibited if not allowed" ( <i>deny-unless-permit</i> ).  This algorithm will return the value " <i>allow</i> " only if the result of the calculation of at least one <i>rule</i> is " <i>allow</i> ".  If the result of the evaluation of all the <i>rules</i> was a set of other values ‚Äã‚Äã(‚Äú <i>prohibit</i> ‚Äù, ‚Äú <i>not applicable</i> ‚Äù, ‚Äú <i>not defined</i> ‚Äù), this combination algorithm will return ‚Äú <i>prohibit</i> ‚Äù. <br><br>  The standard also lists much more complex combination algorithms that introduce additional notions of the results of <i>rule</i> evaluation.  Such an example would be the result that sounds like ‚Äúnot determined, but could be resolved‚Äù ( <i>indeterminate {D}</i> ), which refers to those <i>rules</i> during the evaluation of which an error occurred, and their effect in the case of a successful evaluation would be ‚Äú <i>prohibit</i> ‚Äù . <br><br>  Consider an example of a <i>policy</i> based on a simple business rule. <br><br><img src="https://habrastorage.org/files/711/19c/9f5/71119c9f5b3c447a92740057c3cdb5fd.PNG"><br><br>  This business rule can be broken into pieces and form from it two simple <i>rules</i> that can be combined into a <i>policy</i> . <br><br><img src="https://habrastorage.org/files/827/363/3e3/8273633e376d48a4b10085a2d6bf53f8.PNG"><br><br>  <i>Obligations</i> and <i>recommendations are</i> discussed a little higher in the description of the <i>rule</i> . <br><br><a name="policySet"></a><h2>  Policy set </h2><br>  <i>A set of policies is</i> needed to merge a group of <i>policies</i> for the purpose of their faster filtering based on a general purpose specified in the <i>policy group</i> <i>goal</i> .  It can also be applied when there are extremely complex business rules for additional division into components.  <i>A set of policies</i> in their constituent parts is very similar to ordinary <i>politics</i> .  The only difference is that in the case of a <i>set of</i> <i>policies</i> , <i>policies</i> , not <i>rules</i> , are combined, and that the standard offers a slightly different set of combination algorithms for <i>policies</i> than for <i>rules</i> . <br><br>  <i>A set of policies</i> consists of: <br><ul><li>  targets ( <i>target</i> ); </li><li>  politician ( <i>policies</i> ); </li><li>  the <i>policy</i> combination algorithm ( <i>policy-combine algorithm</i> ); </li><li>  obligations ( <i>obligation</i> ); </li><li>  recommendations ( <i>advice</i> ). </li></ul><br>  The only thing that should be noted is that the standard describes both the same and different combination algorithms for <i>policies</i> and <i>groups of policies</i> . <br><br>  Let's look at an example of a <i>set of policies</i> using a set of business rules. <br><br><img src="https://habrastorage.org/files/828/399/b67/828399b67e7f42c6b52753beba0134f9.PNG"><br><br>  Three similar <i>policies</i> will be formed from these three business rules. <br><br><ol><li>  Document creation policy. <br><br><img src="https://habrastorage.org/files/d8e/7c8/b24/d8e7c8b24952476bb1ac6805b6893662.PNG"></li><li>  Document change policy. <br><br><img src="https://habrastorage.org/files/5e0/ddf/bbb/5e0ddfbbb5a941f7b469b16a81a3d5ef.PNG"></li><li>  Document deletion policy <br><br><img src="https://habrastorage.org/files/d75/058/739/d75058739d954e7a8c4967e1a2a04821.PNG"></li></ol><br><br>  All of these <i>rules</i> have something in common: they describe the availability of actions on the same type of object and, moreover, at a certain time.  Therefore, we can combine them with complete confidence in a <i>set of policies</i> . <br><br><img src="https://habrastorage.org/files/eb1/997/835/eb1997835a124245b3959e96b15e6971.png"><br><br>  <i>Obligations</i> and <i>recommendations are</i> <a href="https://habr.com/ru/company/custis/blog/258861/">discussed a</a> little higher in the description of the <i>rule</i> . <br><br>  So, we figured out how the standard proposes to turn business rules into elements that are understandable to the security system.  Now consider what components the security system itself consists of and how it handles these business rules. <br><br><a name="systemComponent"></a><h1>  The main components of the system </h1><br><div style="text-align:center;"><img src="https://habrastorage.org/files/487/082/dff/487082dff0484cf1a4c451726a1ee5f5.PNG"></div><br>  The <i>policy</i> calculation mechanism is the central component of the system and is referred to as the Policy Decision Point ( <i>PDP</i> ) in the standard. <br>  In order to calculate security policies, they need to be created somewhere.  Another component of the system is responsible for this ‚Äî the <i>policy</i> administration mechanism, called the Policy Administration Point ( <i>PAP</i> ) in the standard.  Another source of data needed by the <i>PDP</i> for computing is the source of attribute values, called the Policy Information Point ( <i>PIP</i> ).  Last but not least, the component is the mechanism responsible for calling the <i>PDP</i> and correctly processing its response, which is called the Policy Enforcement Point ( <i>PEP</i> ). <br><br><a name="PAP"></a><h2>  Policy Administration Point </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b2e/335/554/b2e33555478c4a08abc828516cccfdf6.PNG"></div><br><br>  This is the component in which the security policies are managed.  As a rule, it is a kind of interface that allows the system administrator to turn business rules into <i>policies</i> and make them accessible to the <i>PDP</i> .  In order to be able to manage <i>policies</i> with <i>PAP</i> , he needs to know the following things: <br><ul><li>  <i>policy</i> structure to be able to control the correctness of input; </li><li>  a list of functions that can be specified in logical conditions; </li><li>  a list of attributes that can be specified as function arguments in logical conditions. </li></ul><br>  About the structure of <i>policies</i> already mentioned above, and a more detailed description of them is given in the standard.  As for the functions, some of their list is already described in the standard, as described and the logic of their behavior.  In addition, the standard implies the ability to add your own arbitrary functions.  Therefore, if necessary, to form a final list of functions available for use, you may have to receive part of this list from somewhere. <br><br>  Regarding the attributes in the standard also says a lot.  The issue of typing and naming attributes is mainly addressed.  Attributes themselves, as a rule, represent something specific for a business, therefore for each system this list will be its own.  This means that the system must somehow be able to provide the necessary information.  It is also good to provide information on what values ‚Äã‚Äãmay be available to certain attributes in order to be able to check <i>the</i> constants specified in the <i>rules</i> .  It is worth remembering that attribute names may require localization.  This means that in addition to the name of the attribute and its type, you must also provide a display name that can be localized.  This will allow you to display <i>policies</i> in different languages ‚Äã‚Äãwithout modifying the <i>policies</i> themselves. <br><br>  From a security point of view, <i>PAP</i> does not play a key role.  But from a security management point of view, this is one of its most important places.  Now we have touched only the purpose of this component.  We will look at its potential for managing the security system <a href="https://habr.com/ru/company/custis/blog/258861/">later</a> . <br><br><a name="PIP"></a><h2>  Policy information point </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/files/34e/5c0/465/34e5c0465db94a69927cbe8f6018a32b.PNG"></div><br>  As mentioned above, two things are needed for a <i>PDP</i> to work: the source of security policies and the source of attribute values.  We have just talked about the first, and now let's talk about the second.  The principle of operation of the <i>PIP</i> , at first glance, is quite simple.  At the input it receives the name of the attribute, and at the output it gives all the values ‚Äã‚Äãthat it can find for it in the current execution context.  The whole complexity of <i>PIP</i> lies in its internal structure, in how and where it is able to search for attribute values. <br><br>  If the access control system is built into the application itself, and the <i>PIP is</i> able to search for attribute values ‚Äã‚Äãamong the current objects of the application, then it can, for example, translate the attribute name to the path to the object property and extract the value of this property.  If the access control system is located as a separate service and accepts external calls, the <i>PIP</i> may be able to extract attribute values ‚Äã‚Äãfrom this call.  Or, the <i>PIP</i> can be able to retrieve current environment settings such as time, date, ip-addresses, etc. Also, <i>PIP</i> can be able to ‚Äúwalk‚Äù to any storage and look for attribute values ‚Äã‚Äãthere.  In general, everything here is limited only by the imagination of the developers of the access control system. <br><br><a name="PDP"></a><h2>  Policy decision point </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/files/abc/750/a47/abc750a47895406eb7d37cff5439f0a0.PNG"></div><br>  For access control systems, this is probably the central component.  This is where <i>policies</i> are calculated based on the current call context.  It is very important to understand that the <i>PDP</i> operates on attributes only.  An attribute from the point of view of a <i>PDP</i> is a common key by which it is necessary to find a value and substitute it in a calculated expression.  He does not know anything and should not know about the fact that there are actions, users, environment, objects.  Understanding this will allow you to use the full power of the access control system correctly and with maximum efficiency. <br><br>  Most likely, the question may immediately arise: how does the <i>PDP</i> understand what security policy it needs to calculate in the context of the current action if it does not make any distinction?  The answer is quite simple: no way.  He simply calculates all available <i>policies</i> and on the basis of this forms his decision.  This may seem like a crazy idea, at least in terms of performance, but if you look at this in more detail, everything falls into place. <br><br>  First of all, it‚Äôs terrible to compute thousands of <i>rules</i> every time you check access rights.  Thinking in categories of thousands is caused by the fact that in large systems the number of roles is usually calculated by such orders.  But <i>politicians</i> are not roles.  Dozens of well-designed <i>policies</i> can replace thousands of roles.  So you need to think here in other ways.  In addition, as already mentioned when considering the structure of <i>policies</i> , the <i>goal</i> envisaged in their structure is intended for quick filtering of <i>policies</i> that are not suitable for the current context.  In fact, only policy units will be calculated.  In general, various optimization methods can be applied here, which also depends on the vastness of imagination and resources. <br><br>  In order to understand which <i>policies are</i> applicable at the moment, the <i>PDP</i> must calculate the goal of each of them, substituting the current values ‚Äã‚Äãof the specified attributes there.  <i>PDP</i> uses <i>PIP</i> to find them.  Since the search logic in <i>PIP</i> can be different, the whole <i>PIP</i> collection can be used at the same time, where each <i>PIP</i> will look for the values ‚Äã‚Äãof the specified attribute, guided by its own logic.  <i>The PDP</i> simultaneously polls all its <i>PIPs</i> to find the desired attribute, and from the responses it forms an array of received values.  In the standard, everything is focused on the fact that for each attribute an array of values ‚Äã‚Äãof a previously unknown size can return.  In the case when several <i>policies</i> or <i>groups of policies</i> are calculated in the current context, the result of their calculations is also combined with the combination algorithm predefined for <i>PDP</i> . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Along with other elements, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rules</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policies,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">groups of policies</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> may have </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obligations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recommendations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . They consist of expressions that calculate the values ‚Äã‚Äãof some attributes that will be passed to the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as part of the response. And their calculation can affect the result of the calculation of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rule</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> itself </font><font style="vertical-align: inherit;">, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group of policies</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Only those </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obligations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recommendations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> are </font><font style="vertical-align: inherit;">calculated </font><font style="vertical-align: inherit;">, the purpose of which coincides with the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">effect</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> obtained from the calculation of their </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rules</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policies.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policy groups</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . If the calculation of the attribute value of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commitment</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recommendation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ended with an undefined result, the result of the calculation of the corresponding </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rule</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policy,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group of policies</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will also become </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">undefined</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The result of all calculations should be a response that contains a decision on access, which can take one of the four values ‚Äã‚Äãalready described above: ‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allow</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù, ‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deny</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù, ‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not applicable</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù, ‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not determined</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù. In addition, the response may contain a list of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obligations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recommendations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">It should be noted that the standard describes all the conditions under which the final list of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obligations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recommendations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> should be formed </font><font style="vertical-align: inherit;">.</font></font><br><br><a name="PEP"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Policy Enforcement Point </font></font></h2><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c38/343/10a/c3834310adc14f878f52528f694e9f92.PNG"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is both the starting point and the ending point for all access control actions. The duties of the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as a starting point include preparing the request and calling the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In essence, the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is responsible for transferring the current execution context to the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The current context may include attributes related to the entity performing the action (name, title, department, branch), to the action (name of the action), to the action object (type, number, owner), to the environment (day of the week, date, ip-address). All of these attributes are aggregated and transmitted to the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a final point, the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is responsible for receiving the response from the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDP.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, its interpretation and correct execution. Since the decision to grant access can take one of four values, the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> must be able to turn them into two (‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allow</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù or ‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deny</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù). Depending on the algorithm for interpreting values, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is divided into two types. Enable ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permit based</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> operates on the principle "everything that is not explicitly forbidden." This means that only in case of a negative decision will access be denied. In the other three cases, access will be allowed. Forbidding ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deny based</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acts according to the principle ‚ÄúEverything that is not explicitly permitted‚Äù is prohibited. This means that only in case of a positive decision will access be allowed. In the other three cases, access will be denied. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition to the decision to grant access, the response from the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> may contain a list of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obligations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recommendations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> must comply with. As mentioned above, the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obligations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and obligations that their application is necessary. And this leaves an imprint on the execution of the decision received from the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . If the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> does not understand how to fulfill the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obligation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then, depending on the type of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, it will either cancel the ban, or cancel the permission. If the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP is </font></font></i> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resolving</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">the decision to ‚Äú </font><i><font style="vertical-align: inherit;">deny</font></i><font style="vertical-align: inherit;"> ‚Äù </font><font style="vertical-align: inherit;">has come </font><font style="vertical-align: inherit;">from the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and </font><font style="vertical-align: inherit;">it is impossible </font><font style="vertical-align: inherit;">to fulfill the </font><i><font style="vertical-align: inherit;">obligation</font></i><font style="vertical-align: inherit;"> , then the </font><i><font style="vertical-align: inherit;">PEP will</font></i><font style="vertical-align: inherit;"> allow execution. It works the way it would have worked if it received an ‚Äú </font><i><font style="vertical-align: inherit;">undefined</font></i><font style="vertical-align: inherit;"> ‚Äù </font><font style="vertical-align: inherit;">solution </font><font style="vertical-align: inherit;">. Conversely, if the </font><i><font style="vertical-align: inherit;">PEP is </font></i><i><font style="vertical-align: inherit;">prohibiting</font></i><font style="vertical-align: inherit;"> , the value of the decision coming from the </font><i><font style="vertical-align: inherit;">PDP</font></i><font style="vertical-align: inherit;"> is ‚Äú </font><i><font style="vertical-align: inherit;">allow</font></i><font style="vertical-align: inherit;"> ‚Äù, and the </font><i><font style="vertical-align: inherit;">obligation</font></i><font style="vertical-align: inherit;"> cannot be </font><font style="vertical-align: inherit;">fulfilled </font><font style="vertical-align: inherit;">, the </font><i><font style="vertical-align: inherit;">PEP will</font></i><font style="vertical-align: inherit;"> prohibit the execution. It works as if the decision from the </font><i><font style="vertical-align: inherit;">PDP</font></i><font style="vertical-align: inherit;"> was ‚Äú </font><i><font style="vertical-align: inherit;">undefined</font></i><font style="vertical-align: inherit;"> ‚Äù.</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i> <i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommendations</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , in turn, may not be implemented, and this will not affect the decision to grant access.</font></font><br><br><a name="example"></a><h1>  Example </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Consider an example of an access control system in the case of an application consisting of a client, an application server and the main components of an access control system. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c37/4f3/486/c374f34867b144549891fd973a83ee58.PNG"></div><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each application has its own unique business model. </font><font style="vertical-align: inherit;">This model is filled with objects, their attributes, etc. These attributes are the source of data for the attribute model of the access control system.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Based on this model, policies and groups are created in PAP that use these attributes. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Policies and groups of policies created in PAP are stored in a repository that the PDP will access. </font></font></li><li>   ()   - ,              .          ,      -,     . </li><li>       PEP  ,         (, ,   . .)     PDP. </li><li> PDP           . </li><li>  PDP      PIP       ,      . </li><li>  PIP,   ,    ,     ,    PEP.   PIP      - ,       ( ,      ). </li><li>   PIP       PDP. </li><li>    , PDP     ,           .  , PDP               . </li><li>     PEP  . </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The PEP analyzes the response received, fulfills obligations and recommendations and, in the event of a positive decision, passes the call to the business logic. </font></font></li></ol><br><a name="behindTheScenes"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What's left overs </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As the standard covers every detail, in this article small details were omitted. </font><font style="vertical-align: inherit;">In the standard, much attention is paid to the description of those expressions that can be specified as a condition of the rule. </font><font style="vertical-align: inherit;">What features should be? </font><font style="vertical-align: inherit;">What types of data can be? </font><font style="vertical-align: inherit;">How should these functions be calculated? </font><font style="vertical-align: inherit;">What are the categories of attributes? </font><font style="vertical-align: inherit;">What are some combination algorithms? </font><font style="vertical-align: inherit;">All this - the details that should not affect the understanding of the overall picture. </font><font style="vertical-align: inherit;">Yes, and a detailed analysis of them already has little concern with ABAC itself, rather with technical details of the implementation.</font></font><br><br><a name="behindStandart"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Outside the standard </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The standard describes a lot, down to the smallest details, but some moments still remain unlit. </font><font style="vertical-align: inherit;">Then I would like to touch on these interesting moments and talk about them in more detail.</font></font><br><br><a name="attribute"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Attribute can be any </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I would like to note once again that the attribute can be anything. All divisions of attributes into different categories are made for more comfortable perception by people. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A PDP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> does not distinguish a subject attribute from an object attribute or an action attribute. The name of the attribute, its category, owner, and so on. For a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDP, it</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is just a key by which to find values ‚Äã‚Äãfor an unknown variable in a certain logical expression. So the possibility of using any attributes in the system is, in fact, limited only by the imagination of developers and, probably, technical resources. The main thing is that any </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PIP can</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> return values ‚Äã‚Äãfor such attributes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, business rules can often be found in which restrictions are imposed on both the current values ‚Äã‚Äãof attributes of an entity and new ones at the same time. In other words, when trying to make changes to an entity, it is necessary to check the values ‚Äã‚Äãof the attributes being modified before and after the intended change. Such a check can be embedded in the application logic where we know what entity and what attributes we want to change, what new values ‚Äã‚Äãthey will change. It will only </font><font style="vertical-align: inherit;">be necessary </font><font style="vertical-align: inherit;">to create a special </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PIP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which will be able to extract the old or new attribute value, based, for example, on the prefix in the attribute name (old or new). If the old entity values ‚Äã‚Äãare missing in the current context, such a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PIP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">may be able to retrieve them from the repository based on the values ‚Äã‚Äãof key attributes. </font><font style="vertical-align: inherit;">Fortunately, all the necessary meta-information in the system should be.</font></font><br><br><a name="interface"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Interface and Authorization Check </font></font></h2><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/422/3e6/1e1/4223e61e118f4655ab3a9547c9eecfd8.PNG"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For the convenience of the user, it is much better not to give him the opportunity to perform any action on the interface than after the fact to notify him of the impossibility of such implementation. </font><font style="vertical-align: inherit;">If the user cannot perform any action, then it would be nice to deactivate the "forbidden" controls on the interface or hide them altogether. </font><font style="vertical-align: inherit;">To do this, you can also use the access control system. </font><font style="vertical-align: inherit;">It will be necessary to transfer the current context to it and, based on the solution obtained, to understand what to do with the controls.</font></font><br><br><a name="filtration"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Data filtering </font></font></h2><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/119/061/005/119061005a16446e9d92f234248dd9d6.PNG"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The standard describes well the possibility of limiting the execution of an action, using rules of any complexity for this. But nothing is said about solving problems in which it is necessary to restrict access to viewing part of the data, that is, in fact, to filter this data. The solution to this problem falls on the shoulders of security system developers. If you look at an example of such business rules, you can see that they are the same logical expression as the business rules for accessing objects. Well, since this is a logical expression, it can be used as a predicate for querying data. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first thing that comes to mind: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> learning how to </font><font style="vertical-align: inherit;">form a predicate from business rules for passing it, for example, to an ORM that can use it to get the right list of data. Difference from ordinary</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policies</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be that the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policies</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that describe the possibility of an action, are calculated in the presence of the values ‚Äã‚Äãof all necessary attributes. While the values ‚Äã‚Äãof all attributes for </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policies</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that describe data filtering will be known only during the filtering itself and the predicate applied to each specific object. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, to make a predicate out of all business rules is excessive and, in principle, not necessary, since some attributes are still known before the formation of the predicate. So, it is possible, as in the standard case, to filter part of the business rules, leaving only the necessary ones. However, even one selected policy can be quite large. And given that the result of the </font><i><font style="vertical-align: inherit;">policy</font></i><font style="vertical-align: inherit;"> calculation</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It can take not two, but four values, the fact that </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can be both </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resolving</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forbidding</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the fact that there are different combination algorithms, you need to understand: from all this a giant predicate can form. Such a predicate will consist of a set of expressions combined by conditional </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AND</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OR</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can also try to solve this problem in several stages. At the first stage, you can substitute the values ‚Äã‚Äãof all known attributes into the resulting predicate and calculate what happened. This can significantly reduce the predicate, since the values ‚Äã‚Äãof all attributes must be known, except for the attributes of the object itself. At the second stage, you can try to simplify the remaining predicate using minimization of Boolean functions, for example, using the Quine ‚Äì Mac Klaski method. After that, the predicate will be as compact as possible. And then everything will depend, for example, on the ability of the ORM to form a request and the ability of the database to process this request. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, for example, a business rule: </font></font><br><br><img src="https://habrastorage.org/files/31a/47f/ee9/31a47fee97924f5980003837035fbc1e.PNG"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Forms a predicate: </font></font><br><br><img src="https://habrastorage.org/files/4c5/d40/55c/4c5d4055cd1346ae8bf03b8f9bcdbcaf.PNG"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This predicate, after the substitution of values ‚Äã‚Äãfrom the context, takes the form:</font></font><br><br><img src="https://habrastorage.org/files/cbc/9d2/c74/cbc9d2c74e6a460994532af781cbfb50.PNG"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> After simplification of which there will be only: </font></font><br><br><img src="https://habrastorage.org/files/278/044/531/2780445316dc4043b944feee7f78b241.PNG"><br><br><a name="admin"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Admin panel concept </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> As noted above, for the access control system, the admin panel is the most important component. </font></font> And this is not surprising.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition to the task of creating and editing </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policies,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> it can solve a number of other equally important problems. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's start by editing the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">If you look at the standard and examples of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">policies</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , it becomes clear that even fairly simple business rules written in XACML are difficult to understand and modify, especially without preparation. </font><font style="vertical-align: inherit;">Even with some training, to change any more or less complex business rule in this form is rather problematic.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An example of a very simple rule in &amp; nbsp; XACML format</font></font></b> <div class="spoiler_text"><pre><script type="text/javascript">function gtElInit() {var lib = new google.translate.TranslateService();lib.translatePage('ru', 'en', function () {});}</script><script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=gtElInit&amp;client=wt"></script><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Policy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:oasis:names:tc:xacml:3.0:core:schema:wd-17 http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PolicyId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:oasis:names:tc:xacml:3.0:example:SimplePolicy1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">RuleCombiningAlgId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"identifier:rule-combining-algorithm:deny-overrides"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Medi Corp access control policy<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Target</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Rule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">RuleId</span></span></span><span class="hljs-tag">= </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:oasis:names:tc:xacml:3.0:example:SimpleRule1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Effect</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Permit"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> Any subject with an e-mail name in the med.example.com domain can perform any action on any resource. <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AnyOf</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AllOf</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Match</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MatchId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:oasis:names:tc:xacml:1.0:function:rfc822Name-match"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AttributeValue</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DataType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema#string"</span></span></span><span class="hljs-tag">&gt;</span></span>med.example.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AttributeValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AttributeDesignator</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MustBePresent</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Category</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AttributeId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:oasis:names:tc:xacml:1.0:subject:subject-id"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DataType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:oasis:names:tc:xacml:1.0:data-type:rfc822Name"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Match</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AllOf</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AnyOf</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Rule</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Policy</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  The admin panel can make life easier for the user in terms of editing <i>policies</i> , if he lets him set business rules in a simpler form, which he himself later turns into XACML.  Also, the admin panel can solve a number of other equally important tasks. <br><br><a name="adminPolicyEdit"></a><h2>  Editing policies </h2><br>  A convenient and thoughtful <i>policy</i> editing interface plays an important role in the access control system.  The closer to the human language the <i>rules</i> are set, the better they will be managed and supported.  The interface should be as simple as possible, understandable and at the same time functional.  This can mean the maximum possible abandonment of <i>AND</i> and <i>OR</i> constructs, as well as expressions in brackets, explicit indication of the type of attributes, etc. Everything that can be calculated or determined based on meta-information about attributes or <i>policy</i> structure can and should be removed from the interface , leaving only the necessary minimum for entering business rules, which should be as close as possible to the human language.  For ease of entry, you can use technologies like IntelliSense, convenient drop-down lists, various hints.  The main goal is to create an intuitive and user-friendly interface. <br><br>  The conceptual illustration below shows the editing <i>of</i> the Order Creation policy.  At the top of the window, the <i>goal</i> is indicated - to which this <i>policy</i> will be applied.  The following is the algorithm for combining the rules - ‚Äú <i>prohibited if not allowed</i> ‚Äù.  Below are three <i>rules</i> , consisting of the <i>conditions</i> that will be checked, and the <i>effect</i> that will be the result of each <i>rule</i> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/956/d70/26b/956d7026bff14eafaa0346d69244d690.png"></div><br><br><a name="adminPolicySetEdit"></a><h2>  Editing a policy set </h2><br>  As mentioned above, <i>sets of policies</i> are needed for more convenient management and filtering.  In this window, there is nothing particularly remarkable, but you should not forget about its existence. <br><br>  The conceptual illustration below, in the left part of the window, shows a list of already created <i>policies</i> and <i>sets of policies</i> .  <i>Policy sets</i> can be nested.  In the right part of the window, the editing itself takes place  For a <i>set of policies,</i> you can also set a <i>goal</i> - what the whole set will be applied to.  Below is a list of what is included in the set.  Below you can see an example of specifying the <i>obligation</i> - actions to send an e-mail message to the administrator in the event of a positive decision on granting access rights to the object.  As you can see from the layout, existing attributes can be used for <i>commitments</i> , be it a user name or an object type.  This provides ample opportunity to use <i>commitments</i> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/305/555/147/30555514709e409cb7cafe9e9caae511.png"></div><br><br><a name="adminSearch"></a><h2>  Policy search </h2><br>  One of the problems that may arise may be the need to search for the <i>policies</i> or attributes involved in them.  You can create a universal search box that will search in several categories at once, such as <i>goal</i> , <i>rules</i> and <i>policies</i> .  Accordingly, without additional instructions, the search will occur in all categories and provide the result in the form shown in the conceptual figure below.  In the displayed results, the searched words will be highlighted and that part of the <i>rule</i> ( <i>goal</i> ) in which the searched text is displayed. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/283/4cc/921/2834cc921a2745159c6f6feef6b6a595.png"></div><br><br><a name="adminActionSearch"></a><h2>  Actions available in the specified context </h2><br>  One of the important tasks of the access control system is to search for actions available to the user.  Such functionality can be claimed by security officers or administrators.  Since the verification of access rights occurs dynamically and it is not known in advance exactly which <i>policies are</i> calculated positively, displaying such information may seem difficult.  But this is not such a serious problem as it seems at first glance.  After all, we already have the values ‚Äã‚Äãof user attributes, and we can, at a minimum, select those <i>policies</i> that correspond to these values.  In addition, for a clearer understanding or more accurate search, you can set the values ‚Äã‚Äãof any other attributes of interest: specify the necessary context or part of the context and see what is available for such attribute values.  Moreover, it is possible to display those <i>policies</i> that have come up partially.  For them, you can show the remaining conditions necessary for their implementation. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/cf5/5e1/f18/cf55e1f18d144d1c87ddd063242f4491.png"></div><br><br><a name="adminDebugging"></a><h2>  Testing policy execution </h2><br>  Another important problem may be misunderstanding why this or that <i>policy is</i> calculated in this way, and not otherwise, despite the fact that, in the opinion of the administrator, everything had to be executed differently.  The situation when the <i>policy is</i> set, all attributes are specified correctly, but there is still no access, it can be very unpleasant.  Given that <i>politicians</i> or <i>groups of policies</i> can consist of many logical conditions, manual analysis of this problem can be tedious and fraught with errors.  Since <i>policies</i> consist of many conditions that are calculated gradually, the process of this calculation can be visualized.  The administrator can specify the desired context, select <i>policies</i> and step through the calculation process using a user-friendly interface. <br><br> <a href=""><img src="https://habrastorage.org/files/2d9/916/81b/2d991681b8f04b0bb236eb6de52e442f.png"></a> <br><br><a name="integration"></a><h1>  Application Integration </h1><br>  Integration can be performed with both existing and new applications. <br><br>  Integration with new applications should be fairly straightforward.  Since the developers will initially know about the attribute model, think in its terms, they will be able to immediately develop as needed.  In order for everything to work well, you need to implement two basic things.  First, it is necessary that the system has all the necessary meta-information about the attributes.  This meta information may include the name, type, available values, localization. <br>  Secondly, it is necessary that the <i>PEPs</i> are properly embedded in the application.  Typically, a <i>PEP is</i> embedded in the application logic, somewhere before calling a business logic.  If it is good to fill the system with meta-information and correctly place the PEP, then if the business rules change and, accordingly, the <i>politician,</i> no involvement of programmers will be required.  Even for previously unknown and unplanned business rules. <br><br>  Integration with existing applications may occur in different ways.  Most applications now use a role-based, one-dimensional access model and switching to an attribute, multi-dimensional model can be difficult.  Going directly from the role model to the attribute model can be very difficult, expensive, or even impossible for a number of reasons.  If such a transition is still possible, then the principle of action will be the same as for integration from scratch.  We'll have to fill the attribute model with meta-information and embed <i>PEP</i> in all the necessary places. <br><br>  If such a transition is not possible, you can try to act in several stages.  At the first stage, it is necessary to build an attribute model over the role model.  The point is that the add-in transforms the role model into an attribute model, allowing you to set business rules in an attribute style and turn it back into a role model.  Yes, at first it may seem strange.  But this approach can bring a number of advantages of the attribute model and remove a number of minuses of the role model.  And at the second stage, it will be possible to slowly, in some places, abandon the extra layer in the form of a role model and fully switch to the attribute model. <br>  A detailed analysis of both cases is quite extensive and is beyond the scope of the current article. <br><br><a name="afterword"></a><h1>  Afterword </h1><br>  I hope that an introduction to the problematics and familiarity with the XACML standard will help readers to take a closer look at ABAC and better understand how it works, and the points touched upon outside the standard will take into account various aspects of this area that can provide support in the transition to ABAC. </div><p>Source: <a href="https://habr.com/ru/post/258861/">https://habr.com/ru/post/258861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258847/index.html">Brief Making of Pinup Character</a></li>
<li><a href="../258849/index.html">Case development of the mobile application "My Beeline" under the Apple Watch: how the spears broke</a></li>
<li><a href="../258851/index.html">Writing an image file plugin for OpenSceneGraph</a></li>
<li><a href="../258853/index.html">Fake Minecraft apps on Google Play downloaded hundreds of thousands of times</a></li>
<li><a href="../258859/index.html">How to develop a multiplayer 3D game without artists, designers and modelers in six months</a></li>
<li><a href="../258863/index.html">Video from the user: ReactOS is installed and works on a "modern" computer</a></li>
<li><a href="../258865/index.html">.NET conference .NEXT 2015 Piter: Short tour of reports - part 2</a></li>
<li><a href="../258867/index.html">Heat shrinkable materials simplify cable management</a></li>
<li><a href="../258869/index.html">UX-strategy in practice: a report by Yuri Vetrov on UXPeople</a></li>
<li><a href="../258871/index.html">How to create an email-letter that sees only Apple Watch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>