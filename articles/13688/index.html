<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pangalink - payment method for stores</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Banking link (pangalink) is a method of exchanging purchase and sale data between a customer, a bank and a shop, which is prevalent primarily in Eston...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pangalink - payment method for stores</h1><div class="post__text post__text-html js-mediator-article">  Banking link (pangalink) is a method of exchanging purchase and sale data between a customer, a bank and a shop, which is prevalent primarily in Estonia.  This method is provided by banks as a paid service to stores, and in addition to the possibility of payment, it is possible to authorize users (which is used, for example, at educational <a href="http://sais.ee/">sais.ee</a> ).  Why is this necessary?  Because for the client it is very convenient, judge for yourself - the whole process of paying the bill: <ol><li>  The client selects the necessary goods and as a result receives an account and a link to the bank. </li><li>  Inside the link, all payment and invoice data are protected, and confirmed with a crypto-resistant signature (signature).  The client pays a full informative account at the bank. </li><li>  The bank redirects the client back to the site again with all the payment information along with the signature. </li></ol><br>  This is partly why there are already <a href="https://www.arved.ee/">arved.ee</a> in Estonia and practically every store has bank icons. <a href="http://w.hansa.ee/est/arikliendile_teenusedkaupmehele_makselahendusedinternetis_tehnilinekirjeldus.html"><img src="https://habrastorage.org/getpro/geektimes/post_images/031/d28/284/031d28284aaf1610b79ddc19a57499ba.gif" width="88" height="31"></a> <a href="http://seb.ee/index/010227020201"><img src="https://habrastorage.org/getpro/geektimes/post_images/879/0f4/f50/8790f4f50ec01a1df6b7f0532de5519d.gif" width="88" height="31"></a> <a href="http://www.sampopank.ee/et/14730.html"><img src="https://habrastorage.org/getpro/geektimes/post_images/c1a/b19/6c0/c1ab196c0d96beb211e85e68cbc46a43.gif" width="88" height="31"></a> <a href="http://www.nordea.ee/Teenused%252Bettev%26"><img src="https://habrastorage.org/getpro/geektimes/post_images/402/04e/47d/40204e47d4be104117072a0d896b99d2.gif" width="88" height="31"></a> <a href="http://www.krediidipank.ee/ari/arveldus/pangalink/index.html"><img src="https://habrastorage.org/getpro/geektimes/post_images/485/b12/d51/485b12d51c68cc795311cb9676677a47.jpg" width="88" height="31"></a>  In general, the work required: <ul><li>  unique id, issued in the bank after the conclusion of the contract </li><li>  certificates - bank's public key and own public and private keys </li><li>  proper data exchange program </li></ul><h3>  Cryptography <br></h3> Since everything happens in the SSL mode, it is necessary to have a bank public key to generate a message to the bank and vice versa, to have a private key to unlock the message that the bank generated by the public key of the store.  Thus, the store's private key looks like this (the data in the <a href="http://www.php.net/manual/en/function.base64-encode.php">base64</a> encoding is more simple) <code>-----BEGIN RSA PRIVATE KEY----- <br> MIICWwIBAAKBgQC6GI5uaA7hEkgeP98VHL6TSxJwwPI+Mh+rFx KQPCgarT3/nZCS <br> Gz1r223+gfH/adV4IDvlbYT18VQ4vSspX+QRAidFeZvsfv99Fe wnwNoTL3LwYp/K <br> r9eW5YCpCEe8Crziks0vf92PNoHgNAL0iVo0Zma1ScDBSPBlQJ oZ1UiwoQIDAP// <br> -----END RSA PRIVATE KEY-----</code> <code>-----BEGIN RSA PRIVATE KEY----- <br> MIICWwIBAAKBgQC6GI5uaA7hEkgeP98VHL6TSxJwwPI+Mh+rFx KQPCgarT3/nZCS <br> Gz1r223+gfH/adV4IDvlbYT18VQ4vSspX+QRAidFeZvsfv99Fe wnwNoTL3LwYp/K <br> r9eW5YCpCEe8Crziks0vf92PNoHgNAL0iVo0Zma1ScDBSPBlQJ oZ1UiwoQIDAP// <br> -----END RSA PRIVATE KEY-----</code>  <code>-----BEGIN RSA PRIVATE KEY----- <br> MIICWwIBAAKBgQC6GI5uaA7hEkgeP98VHL6TSxJwwPI+Mh+rFx KQPCgarT3/nZCS <br> Gz1r223+gfH/adV4IDvlbYT18VQ4vSspX+QRAidFeZvsfv99Fe wnwNoTL3LwYp/K <br> r9eW5YCpCEe8Crziks0vf92PNoHgNAL0iVo0Zma1ScDBSPBlQJ oZ1UiwoQIDAP// <br> -----END RSA PRIVATE KEY-----</code> And instead of PRIVATE, respectively, the public key has other data and a PUBLIC header.  Naturally, the private key is private and if it suddenly lights up, anyone with sufficient skill can sign a fictitious payment for the goods.  Keys can be <a href="http://www.kaubandus.fantaasia.com/votmed.html">generated</a> using <a href="http://www.slproweb.com/products/Win32OpenSSL.html">OpenSSL</a> . <h3>  For work on php <br></h3>  I write to php, store the keys in a .pem file and use the POST method to transfer everything to the bank with a form.  Namely .. We create a form with the POST method, as an action we set the URL of the bank where the data is received.  For hanza, this is <a href="https://www.hanza.net/cgi-bin/hanza/pangalink.jsp">www.hanza.net/cgi-bin/hanza/pangalink.jsp</a> .  Now we prescribe hidden-fields with names like VK_RETURN (link to return to after payment).  Each bank has its own variables and its own order.  The whole business is signed by the same VK_MAC variable, which is generated by the openssl_pkey_get_private and openssl_sign functions. After the product is paid, you must confirm the payment on your website.  To do this, we tear out the REQUEST variable and send us the bank and confirm the signature using openssl_pkey_get_public and openssl_verify from the same VK_MAC.  Well, if the signature of the bank is correct and VK_SERVICE = 1101, then everything is in order. <a href="http://blog.zone.ee/2006/12/12/pangalink/">Here's</a> an example of <a href="http://blog.zone.ee/2006/12/12/pangalink/">zone.ee</a> - <a href="https://data.zone.ee/phpsn/banklink/pay.php">pay.php</a> with a payment form, <a href="https://data.zone.ee/phpsn/banklink/notify.php">notify.php</a> with confirmation and <a href="https://data.zone.ee/phpsn/banklink/config.php">config.php</a> with settings.  This can be done <a href="http://www.php.ee/foorum/index.php%3Fpost%3D11187%26j%3D2">in c ++</a> , but naturally with big nerves. </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/13688/">https://habr.com/ru/post/13688/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136875/index.html">Report on the 3rd Kiev Habravstreche</a></li>
<li><a href="../136876/index.html">GTD - Big Plus</a></li>
<li><a href="../136877/index.html">The little redis book</a></li>
<li><a href="../136878/index.html">Game cycles or ElectroCardioGama</a></li>
<li><a href="../136879/index.html">Some file sharing services suspend</a></li>
<li><a href="../136880/index.html">Justin's robot has become even more agile.</a></li>
<li><a href="../136883/index.html">Size of java objects. We use the knowledge gained</a></li>
<li><a href="../136885/index.html">Advertising in the mobile version of LJ</a></li>
<li><a href="../136886/index.html">Three approaches to the methodology of building a complex client application</a></li>
<li><a href="../136887/index.html">Universal Startup Class</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>