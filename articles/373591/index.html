<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Computer mouse as an accurate sensor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Task: quickly make a linear displacement sensor from a computer mouse. 

 In conventional mice, a highly sensitive optical sensor is hidden. It has it...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Computer mouse as an accurate sensor</h1><div class="post__text post__text-html js-mediator-article">  Task: quickly make a linear displacement sensor from a computer mouse. <br><br>  In conventional mice, a highly sensitive optical sensor is hidden.  It has its own little ‚Äúcamera‚Äù and a processing processor that tracks the movement of the smallest points on the surface.  In top mice resolution is <b>only 3 microns!</b> <br><br><img src="https://habrastorage.org/web/406/fa6/cc4/406fa6cc457d4a6ea490ced2d936976b.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What armpit stones we encountered, plus the technical part, we will tell you further! <br><a name="habracut"></a><br>  The following customer gave the TK: do it as soon as possible, with any mouse (possibly wireless), output to the 7th segment indicator, reset the button, the computer does not fit, you need a resolution of 0.01 mm, maximum distance 1000 mm. <br><br>  To begin with, how it all was done: <br><br>  Plan: <br><br><pre>  Reading xy coordinates from mouse:
        There are several ways to implement data reading:
              a) Directly from the optical sensor chip
                 + You can do with a simple controller
                 - You can forget about universality completely
              b) Connect the mouse via USB to simple controllers (for example, to Arduino)
                 + Simplicity and cheapness
                 - Need to solder
                 - At hand was only arduino, and you can connect mice compatible with 
                   PS / 2, and they are usually very inaccurate.  It could have been on stm32, but debug boards 
                   much more expensive, most did not have time to solder.  (but if interested, then 
                   a few years ago there was such a similar project exactly on stm32f4discovery)
               c) Take some simple one paid computer.  At hand was just Raspberri pi.
                   + Suitable for any USB mice.
                   + Good performance
                   - Expensive, but may need excess power later </pre><br>  As a result, Malina pi 3 lay under the surgeon's knife. Four 64-bit A-53 cores at 1GHz, 512 MB of RAM and many other tsiferok for this task. <br><br><img src="https://habrastorage.org/web/ecb/c3e/d79/ecbc3ed799484b4fad7dc03ce8dfab95.jpg"><br><br>  <b>Task:</b> Indication should be on the issued 7-segment indicators.  It turns out we need 6 digits per coordinate, for a total of 12 indicators.  Each indicator has 7 legs per digit + leg per LED point (dp), we do not consider the common wire.  Total after simple calculations we get that <b>we have to manage 96 conductors plus we need a button.</b>  96 resistors did not really want to spend. <br><br><blockquote>  Listen up <br>  After all, if the LED is lit - it means - does it need one resistor? </blockquote><br>  To control such an array of legs at once is not possible.  There is an exit!  And even a few! <br><br>  1) Use additional microcircuits of the type max7219, or shift registers, multiplexers, etc. <br><br>  + It is possible to increase the number of indicators almost infinitely <br>  - Max7219 was with an operating voltage of 5 V <br>  - There was nothing suitable at hand. <br><br>  2) You can make a dynamic display.  At the same time, light only one LED.  If the indicators switch very quickly, the human eye will not notice the bases. <br>  + You only need 8 wires and resistors for one indicator and 12 for switching indicators.  Plus do not forget the button.  <b>Total: only 21 legs against 96. We take it!</b> <br>  - Since we are trying to control the whole indicator through a single pin, the maximum current is limited to 50 mA.  Always take stock, and take 35 mA for all 8 LEDs (which is not very fast).  To this we add a fast switching of indicators.  As a result, each of us shines 12 times less than it should be.  You can modify 12 transistors, but I left it for later, because  brightness ultimately enough. <br><br><img src="https://habrastorage.org/web/527/450/018/52745001844448c6b09fea034aec0b56.jpg"><br><br>  Now the software starts: <br><br>  On piberri pi need to put linux.  I set the minimum distribution <br>  <a href="https://www.raspberrypi.org/downloads/raspbian/">RASPBIAN JESSIE LITE</a> . <br><br>  Further, through the putty program I connected to Malinki IP, and then everything through the command line. <br>  To make it easier to work with GPIO (input and output ports) there is a wonderful library <a href="http://wiringpi.com/download-and-install/">WiringPi</a> . <br><br>  How to install it and manage ports, you can find a lot of information on the network, so I will not stop at this in detail. <br><br>  Next you need to create a daddy of our project: <br><br><pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /home/pi sudo mkdir mouse <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /home/pi/mouse</code> </pre> <br>  Next, open the editor and <a href="https://github.com/SergeiSOficial/LMouse">paste the code from the gita.</a>  IMPORTANT!  I wrote the code very quickly! <br><br><pre> <code class="bash hljs">sudo nano</code> </pre> <br>  To exit the editor, press Alt + x and save the file with the name blinker.c.  Further it is necessary to compile with wiring pi: <br><br><pre> <code class="bash hljs">gcc -o mouse mouse.c -l wiringPi</code> </pre><br>  Everything!  Now connect the mouse, insert the wires and run! <br><br><div class="spoiler">  <b class="spoiler_title">Wire connection</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/baa/19f/9e3/baa19f9e322d439f8b85670c26c6338c.jpg"><br>  // pin number declarations.  We're using the Broadcom chip pin numbers. <br><br>  const int p21pin = 2; <br>  const int p22pin = 3; <br>  const int p23pin = 4; <br>  const int p24pin = 17; <br>  const int p25pin = 27; <br>  const int p26pin = 22; <br>  const int p11pin = 10; <br>  const int p12pin = 9; <br>  const int p13pin = 11; <br>  const int p14pin = 5; <br>  const int p15pin = 6; <br>  const int p16pin = 13; <br>  const int papin = 8; <br>  const int pbpin = 23; <br>  const int pcpin = 12; <br>  const int pdpin = 20; <br>  const int pepin = 21; <br>  const int pfpin = 24; <br>  const int pgpin = 18; <br>  const int pdppin = 16; <br><br>  const int butpin = 26; <br></div></div><br><pre> <code class="bash hljs">sudo ./mouse</code> </pre> <br>  Autostart at boot: <br><br><pre> <code class="bash hljs">sudo nano /etc/rc.local   <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> 0    <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /home/pi/mouse sudo ./mouse &amp;</code> </pre> <br>  Working with this program is very simple.  by pressing the mouse button or just the buttons on the board is reset.  With a long press of a button, we switch to the DPI adjustment mode.  This is an important parameter that is set by the mouse and shows how many samples we will get when moving one inch.  Accordingly, digging on the board and on the mouse adds and decreases DPI.  Long press, our value is recorded in the file and securely stored until the next system boot.  For the purity of the experiment in the program, the display, information from the mouse and the button are processed in parallel processes. <br><br>  <b>Further the most interesting!</b>  <b>Testing and results!</b> <br>  What are the nuances of working with a mouse: <br><br>  1. The X and Y axes on my mouse were not parallel to the side faces, it was necessary to use ‚ÄúPythagorean pants‚Äù to calculate the real distance. <br><br>  2. <b>Resolution is not equal to the error!</b> <br><br>  In simple language - the resolution really shows the minimum movement that the mouse sees, (the readings in the computer must be discrete with the minimum resolution).  But that the mouse does not miss anything, is not guaranteed.  You can reduce this value using good surfaces (so that the optical sensor can track movements), use low speeds.  But there will always be gaps!  For the user, this means continuous zero care and unpredictable measurement error. <br><br>  3. USB HID on which the mouse works does not guarantee the delivery of information to the computer!  That is, it is not known whether the computer missed any information from the mouse or not.  The probability of missing information is small, but still there. <br><br>  4. Sensitivity (resolution) settings are sometimes not stored in the mouse, but in the mouse program. <br><br>  5. <b>Here I am very angry!</b>  The fact is that I took the mouse the coolest from the range of Logitech, this is the most advanced was on that day model logitech performance mx.  But what was my surprise when the mouse gave different errors when moving back and forth.  <b>WHAT IS IT LIKE?</b>  I will explain to the user.  If you constantly move the mouse back and forth, then the cursor is noticeably so everything is reduced and reduced.  It is on any platforms.  You have to periodically raise the mouse and put it on a new place.  After I noticed this, my life turned into a nightmare!  #Logitech <a href="https://geektimes.ru/users/logitech/" class="user_link">logitech</a> explain the significant difference in measurement errors back and forth! <br><br>  Video demonstrations of work: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/zVuP0h4cddM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  The result: the disadvantages outweighed all the advantages of the mouse as a measuring device.  Therefore, the project is closed and spread for my dear readers on GeekTimes. </div><p>Source: <a href="https://habr.com/ru/post/373591/">https://habr.com/ru/post/373591/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../373581/index.html">Apple ARKit Augmented Reality: Features and Examples</a></li>
<li><a href="../373583/index.html">In the independent test, Chrome and Opera were the most energy efficient.</a></li>
<li><a href="../373585/index.html">And about 3.3 thousand new ways to read Habrahabr and Hiktimes</a></li>
<li><a href="../373587/index.html">"Yellow carrot bend": 8 unusual musical instruments</a></li>
<li><a href="../373589/index.html">"Get to the Top": how to make music charts</a></li>
<li><a href="../373593/index.html">Managed folder access in Windows 10 protects against cryptographers</a></li>
<li><a href="../373597/index.html">SpaceX takes the industrial maturity exam</a></li>
<li><a href="../373599/index.html">EvaPolar personal compact air conditioning</a></li>
<li><a href="../373601/index.html">We build seamless DECT IP telephony on Gigaset equipment</a></li>
<li><a href="../373603/index.html">"The law of Spring" want to transfer to 2023, but the FSB is against</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>