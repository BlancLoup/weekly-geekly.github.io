<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Monitoring home router</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Do you know the "no Internet" situation? 

 Usually an attempt at correction involves: 
 - bypassing family members (well, yes, I‚Äôm shaking the new se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Monitoring home router</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/537/da3/0fe/537da30fe345b4326574d835c5e8ed79.png"><br><br>  Do you know the "no Internet" situation? <br><br>  Usually an attempt at correction involves: <br>  - bypassing family members (well, yes, I‚Äôm shaking the new season of Dr. House. And who might be disturbed by this?) <br>  - reboot the router (well, I‚Äôm stuck, I‚Äôm stuck - for days, you shake all sorts of rubbish ..) <br>  - Do not download updates (good news - new Acrobat Reader ...) <br>  - if we have fleas (our botnet today was given a great homework) <br>  - call provider (our channel works like a clock from the company's inception) <br>  - uh  maybe another router? <br>  ... <br><a name="habracut"></a><br>  Everything will turn out if your router supports the <a href="http://ru.wikipedia.org/wiki/SNMP">SNMP</a> protocol - a special protocol for telemetry of network devices and applications.  We understand the instructions to the router or web interface, do you have support for SNMP.  In some cases, it appears when installing unofficial firmware.  We are looking for it in the web interface, turn it on.  We remember the name of the community name - this is the password by which the SNMP readings of your router are available on the network (the default is usually public). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/geektimes/post_images/c4c/300/610/c4c3006100b7ccc251db6e5bafb8dda6.png"><br>  <em>Fig.</em>  <em>1. Everything is simple.</em>  <em>Either there is SNMP support, or there is none.</em> <br><br>  In order not to lose a lot of time for nothing, let's do an express check.  Download the <a href="http://www.net-snmp.com/">NET-SNMP</a> library.  From the bin directory, execute the command: <br><blockquote><code><font color="black">snmpstatus -c public -v 1 192.168.1.1</font></code> </blockquote> <br>  public - password for accessing SNMP (community name) <br>  192.168.1.1 - router ip address <br><br>  If the router responded with a summary of information about itself (OS, uptime, ...), go ahead. <br>  Open Source Monitoring Solutions: <br><ul><li>  <a href="http://oss.oetiker.ch/mrtg/">oss.oetiker.ch/mrtg</a> </li><li>  <a href="http://cacti.net/">cacti.net</a> </li><li>  <a href="http://www.zabbix.com/">www.zabbix.com</a> </li><li>  <a href="http://www.nagios.org/">www.nagios.org</a> </li></ul><br>  I will disassemble the use of MRTG.  Not the best usability, but the easiest installation.  We do not yet need to monitor thousands of devices.  MRTG is a set of scripts that will generate html pages and png images with statistics on the parameters that you monitor. <br><br>  Install MRTG.  The site has a detailed installation guide for UNIX and Windows.  Perl is required for Windows.  The most common free PERL distribution for Windows is <a href="http://www.activestate.com/activeperl/">ActivePerl</a> .  I did not see a separate manual for the Mac, but since MRTG is nothing more than a PERL program, it should work too. <br><br>  A short way to start monitoring traffic on the router's network interfaces is to create the MRTG configuration file with the cfgmaker command.  For example, my ASUS WL-500g premium router has 8 network interfaces, and this allows you to see traffic from the provider, from the WiFi device (phone and laptop), from the workstation through Ethernet <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/316/4e6/c42/3164e6c42a777caa34d93348e4659526.png"><br>  <em>Fig.</em>  <em>2. From the comparison of graphs on different interfaces, you can see where the traffic comes from.</em> <br><br>  Slightly more difficult to monitor the load and memory usage.  You need to have a MIB device specification.  If SNMP is officially supported, then it is most likely available on the manufacturer‚Äôs website.  If this is an unofficial firmware, then perhaps the community has already had some groundwork that has made the firmware.  For example, the specification for ASUS WL-500g is <a href="http://www.dd-wrt.com/wiki/index.php/SNMP">here</a> .  In my case, the OID for the average 5 minutes load on the CPU .1.3.6.1.4.1.2021.10.1.5.2 used by the RAM .1.3.6.1.4.1.2021.4.6.0.  When describing the CPU readings and memory usage in the MRTG config, you need to specify using the gauge option that these are current readings, not an integral value, as for traffic, when SNMP transmits the number of bytes passed through the interface since the device was turned on (well, or reset the counter, if you work long) <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/ab9/178/244/ab9178244ee8a5fa7aeb0e1dfdd297a7.png"><br>  <em>Fig.</em>  <em>3. Usually the CPU load is at zero.</em>  <em>It grows when several processes are pumped at high speed.</em>  <em>Used memory is changing slightly.</em> <br><br>  Of course, you don't need to run mrtg every 5 minutes manually, but you need to create a cron task (Unix) example: <br><blockquote> <code><font color="black">*/5 * * * * root LANG=C LC_ALL=C /usr/bin/mrtg /etc/mrtg/mrtg.cfg --lock-file /var/lock/mrtg/mrtg_l --confcache-file /var/lib/mrtg/mrtg.ok</font></code> </blockquote> <br>  If you put mrtg from the package, the task will be added by itself. <br>  or Sheduled Tasks (Windows) Example: <br><blockquote> <code><font color="black">Run: wperl mrtg --logging=eventlog mrtg.cfg <br> Start in: c:\httpd\htdocs\mrtg\bin</font></code> </blockquote> <br>  Perhaps, the capabilities of your router are much wider, and you can get much more information - MAC addresses of clients, traffic to MAC addresses, and so on.  May Google help you! <br><br>  <b>PS</b> This note, of course, is not focused on network infrastructure specialists.  I just accidentally discovered the SNMP bukavy and I am sure that I am not alone in this.  Perhaps this will help someone when choosing a new router. <br><br>  In the comments I discovered the <a href="http://ru.wikipedia.org/wiki/DD-WRT">DD-WRT</a> super <a href="http://ru.wikipedia.org/wiki/DD-WRT">firmware</a> .  Now I think ... <br></div><p>Source: <a href="https://habr.com/ru/post/79856/">https://habr.com/ru/post/79856/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../79845/index.html">The computer of your dreams. Part 1: The Philosophy of a Rational Approach</a></li>
<li><a href="../79846/index.html">How would postmortem pill cannon</a></li>
<li><a href="../79850/index.html">About headphones, iTunes libraries and what's playing at my place</a></li>
<li><a href="../79853/index.html">Notes on NLP (Part 4)</a></li>
<li><a href="../79854/index.html">Translation Of The Day Of The Triffids (Part One)</a></li>
<li><a href="../79857/index.html">LG XG1 Chic External Drive</a></li>
<li><a href="../79859/index.html">KazNet Congratulation</a></li>
<li><a href="../79860/index.html">Google Search Integration into Drupal website</a></li>
<li><a href="../79861/index.html">Firefox for Maemo operating system (Nokia N900 and N810) reached Release Candidate status</a></li>
<li><a href="../79864/index.html">Another neblon Habr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>