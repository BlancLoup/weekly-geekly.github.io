<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HTML5 No Screenshots</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I use Gmail almost every day, but I recently noticed that if you take a screenshot of the screen ( www.take-a-screenshot.org ), you can simply copy th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HTML5 No Screenshots</h1><div class="post__text post__text-html js-mediator-article">  I use Gmail almost every day, but I recently noticed that if you take a screenshot of the screen ( <s><a href="http://www.take-a-screenshot.org/">www.take-a-screenshot.org</a></s> ), you can simply copy this screenshot directly into the text of a Gmail letter by pressing Ctrl + V.  It works everywhere, but of course except IE.  Interested in asking how this happens google the next post on <a href="http://stackoverflow.com/questions/6393280/paste-image-into-rich-text-like-gmail">Stackoverflow</a> .  Under the strong impression of the HTML5 capabilities, clipboardData decided to make a simple portal, where without any Desktop applications any user <a href="http://yourscr.com/">can upload a screenshot by</a> simply copying it. <br><a name="habracut"></a><br><br><h4>  Browser Support </h4><br>  Firstly, it should be noted that in order to copy something from the buffer (for example, a screenshot), the browser must have support for the <a href="http://dev.w3.org/2006/webapi/clipops">Clipboard API</a> .  As can be seen on <a href="http://caniuse.com/clipboard">caniuse,</a> only the most recent browsers work with this API.  IE, unfortunately, smokes on the sidelines despite partial support. <br><br><h4>  Uploading javascript screenshots </h4><br>  To load an image from the buffer (screenshot), you first need to define a paste event handler: <br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.addEventListener(<span class="hljs-string"><span class="hljs-string">"paste"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ ... });</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The handler will always be called when an ‚ÄúInsert‚Äù event occurs in the working area of ‚Äã‚Äãthe browser window, for example, by pressing Ctrl + V. Next, you need to determine the code that actually receives the image file from the buffer.  This code is identical for Chrome and Opera browsers, but different for FireFox, since the latter, for some security reasons, has methods that are not available for the clipboardData object. <br><br><h5>  Chrome, Opera </h5><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// e.clipboardData.items -         for (var i = 0; i &lt; e.clipboardData.items.length; i++) { //    if (e.clipboardData.items[i].kind == "file" &amp;&amp; e.clipboardData.items[i].type == "image/png") { //    Blob ( ) var imageFile = e.clipboardData.items[i].getAsFile(); var fileReader = new FileReader(); fileReader.onloadend = function(e) { //    this.result  Base64  loadImg(this.result); }; //  Blob  DataURL (Base64   ) fileReader.readAsDataURL(imageFile); e.preventDefault(); break; } }</span></span></code> </pre><br><br><h5>  Firefox </h5><br>  In FireFox, we are unable to read the file via clipboardData.  When pasting, the browser itself creates an &lt;img&gt; tag with src as a DataURL.  Therefore it is necessary to make a ‚Äúcrutch‚Äù: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   js,   Mozilla,   ,  (contenteditable) div  //    . if ($.browser.mozilla) { $(document.body).prepend('&lt;div id="temp" contenteditable="true" style="height:1px;width:1px;color:#FFFFFF;"&gt;&lt;/div&gt;'); $('#temp').focus(); } //   "" document.body.addEventListener("paste", function(e) { if ($.browser.mozilla) { //  Mozilla,      div // (   ,  FireFox  img   ) $('#temp').focus(); //   img (   2, 3, ..., N ) $('#temp img').remove(); //  FireFox   img  callback-     img -    setTimeout(function() { //   FireFox   img  temp div,     DataURL    loadImg($('#temp img').attr('src')); }, 1); return true; } });</span></span></code> </pre><br><br><h4>  Where to upload a picture? </h4><br>  You can upload a picture directly to the server, transferring it via POST DataURL or, for example, on canvas as done on <a href="http://yourscr.com/">Your screen</a> : <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> canvas = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'canvas'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ctx = canvas.getContext(<span class="hljs-string"><span class="hljs-string">'2d'</span></span>); ... function loadImg(dataURL) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> imageObj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image(); imageObj.onload = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> width = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.width, height = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.height; canvas.width = width; canvas.height = height; ctx.drawImage(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, width, height); }; imageObj.src = dataURL; }</code> </pre><br><br>  Canvas is convenient because before uploading a screenshot to the server you can edit it: underline, draw, circle, cut, etc. <br><br><h4>  What happens on the server? </h4><br>  The server must have a POST controller, which would accept the body in Base64 (DataURL) format and decode it into a binary image file, for example png.  The controller can be written in any language, for example Java using SpringMVC: <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/upload"</span></span>, method = RequestMethod.POST) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@ResponseBody</span></span> <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">save</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@RequestBody String b64)</span></span></span><span class="hljs-function"> </span></span>{ File file = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; FileOutputStream out = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  Output  out = new FileOutputStream("/opt/files/somename.png"); //  Base64       out.write(Base64.decodeBase64(StringUtils.replace(b64, "data:image/png;base64,", ""))); //   IOUtils.closeQuietly(out); } catch (FileNotFoundException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); } return file.getName(); }</span></span></code> </pre><br><br>  For attention, I note that this StringUtils.replace (b64, "data: image / png; base64,", "") construct is needed to normalize the DataURL transmitted from Javascript.  The fact is that when you create a DataURL, you first put its type and format and then comes Base64 view, for example data: image / png; base64, iVBORw0KGgoAAAANSUhEUgAABVYAAAMAC ... <br><br>  Additionally, you can still check the file size, and if it exceeds a certain maximum, compress in jpg. <br><br><h4>  Use cases </h4><br>  <a href="http://yourscr.com/">Your screen service</a> we at Cackle use every day as a quick and easy way to capture the screens of our clients.  Unfortunately, there are very few such solutions on the network and those that are inconvenient or work only through Desktop: <br><ul><li>  <a href="http://prntscr.com/">prntscr.com</a> - you can copy the screenshot only in Chrome and without editing </li><li>  <a href="http://snag.gy/">snag.gy</a> is better, but screenshots load very slowly and only once (first) </li><li>  No longer found ... </li></ul><br><br>  Soon we plan to transfer all this functionality to our <a href="http://cackle.me/">Online consultant Cackle</a> .  Thus, customers will have the opportunity to take a screenshot and transfer the image directly through a consultant to the operator.  This is in some sense the best replacement for Co-Browser, as it allows you to show the entire screen (and not just the browser), reduce development costs and minimize errors. <br><br>  In conclusion, I will say that the project <a href="http://yourscr.com/">Your screen is</a> completely new and will develop further, therefore I am waiting for your criticism and suggestions on the functionality. </div><p>Source: <a href="https://habr.com/ru/post/201190/">https://habr.com/ru/post/201190/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../201170/index.html">Transformation of ideas in the development process of the project Meople</a></li>
<li><a href="../201172/index.html">Why Microsoft Internet Explorer 11 is the worst thing that could happen to us.</a></li>
<li><a href="../201174/index.html">Google stops supporting browser IE 9</a></li>
<li><a href="../201178/index.html">RabbitMQ tutorial 5 - Topics</a></li>
<li><a href="../201180/index.html">Generation Z or Digital Native: What era is coming on Earth?</a></li>
<li><a href="../201196/index.html">Have fun together: Single sign-up to the Windows app stores and Windows Phone</a></li>
<li><a href="../201200/index.html">New free courses of virtual academy of Microsoft Virtual Academy</a></li>
<li><a href="../201202/index.html">Migrating to a new version of API</a></li>
<li><a href="../201204/index.html">Hadoop Part 2: Collecting Data with Flume</a></li>
<li><a href="../201206/index.html">How Passport.js works</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>