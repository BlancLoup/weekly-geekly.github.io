<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We connect Arduino to the electric power meter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No, this article is not about another way to deceive this ill-fated device. Here we will talk about how to use your Arduino and LabView environment to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We connect Arduino to the electric power meter</h1><div class="post__text post__text-html js-mediator-article">  No, this article is not about another way to deceive this ill-fated device.  Here we will talk about how to use your Arduino and LabView environment to turn your electricity meter into a power consumption monitoring tool or even an ammeter! <br><br><img src="https://habrastorage.org/files/690/27b/f7e/69027bf7e87d4fe49838fe48b540113f.jpg"><br><a name="habracut"></a><br>  The very first electricity meter was induction.  The principle of its operation is ridiculously simple - in fact, it is an electric motor, the rotor of which is an aluminum disk rotating the dial.  The more current consumed, the faster the disk turns.  The device is purely analog. <br><br><img src="https://habrastorage.org/files/8a6/d4f/56d/8a6d4f56dcce4682b999a26644a66579.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Today, however, induction meters are losing ground, giving way to their cheaper electronic counterparts.  And just one such will become experimental: <br><br><img src="https://habrastorage.org/files/402/647/256/40264725618540c099b85bd88d917558.jpg"><br><br>  The principle of operation has not changed much - in this case, the disk is replaced by electronics, which generates pulses in accordance with the amount of electricity consumed.  As a rule, in most devices, these pulses are indicated by an LED indicator.  Accordingly, the faster this light flashes - the more precious kW is burned. <br>  In addition, on the front panel of any device there is a gear ratio of the counter <i>A</i> - the number of pulses per 1 kW * h.  As can be seen from the photo, the experimental A = 12800.  From this information we can draw the following conclusions: <br><br>  - With each pulse, the meter records consumption equal to 1/12800 parts from 1 kW * h.  If you turn on the load to the meter and just start counting the pulses, then it is easy to get the amount of electricity consumed by it (kWh), dividing the number of pulses by the gear ratio. <br><br>  - Since the indicator changes the speed of its blinking, it is possible to derive the relationship between the power (kW) and the time of a single pulse of the counter, which will provide data on the power / current. <br>  We will not load the article calculations, but if you need something <div class="spoiler">  <b class="spoiler_title">here they are</b> <div class="spoiler_text">  Truly, the gear ratio of the counter is a great thing, since knowing it can express both power and current: <br>  Compose the proportion of our gear ratio (A = 12800 imp / kW * h) and the unknown gear ratio, which will be under load X and during one single impulse (blinking light bulb): <br><br><img src="https://habrastorage.org/files/cf2/d2c/c63/cf2d2cc631b2459b9a3d8765aaae6e94.jpg"><br><br>  Here X is the unknown power, and t is the time of one pulse.  We express the unknown power from here and here it is: <br><br><img src="https://habrastorage.org/files/466/a98/4a3/466a984a3c154759b7a56aaf02bdd84c.jpg"><br><br>  The current is calculated using the following proportion of ratios and currents of known and unknown under X load .: <br><br><img src="https://habrastorage.org/files/43d/750/a1e/43d750a1ec0c486d810a2aa7c690154b.jpg"><br>  Which in general leads to an identical formula, but for current (current is measured in amperes and indices mean the load at which the current will be): <br><br><img src="https://habrastorage.org/files/685/2f7/318/6852f731832f4b6c85d2e13d5f88ceff.jpg"><br><br>  Here you can see the underwater stone - you need to know the current at an ideal load of 1 kW.  If good accuracy is necessary, it is better to measure it yourself, and if not, then approximately it can be calculated by the formula (voltage and power are known), but it will be more crude because the power factor is not taken into account. <br><br></div></div><br>  Thus, everything rests on the measurement of the time of a single pulse (the indicator blinks).  In my research, I relied on <a href="http://cxem.net/arduino/arduino25.php">this great project</a> .  <a href="http://www.open-electronics.org/real-time-energy-monitor-with-arduino-and-labview/">An Italian</a> made an interface for monitoring power in the Labview environment and came up with a scheme for measuring pulses.  But there was a huge flaw in his project - he was only suitable for meters with a gear ratio of 1000 imp / kWh. <br><br><img src="https://habrastorage.org/files/037/a79/d42/037a79d427d84b078b874aa7809c3e3e.jpg"><br><br>  The top chart is the average power in 5 minutes, the bottom one in real time.  The interface is quite flexible and easily modified to fit your needs.  If you have not dealt with the LabView environment yet, I recommend to get acquainted. <br><br>  To make it work, it was enough to add a single block to the program's algorithm, in accordance with the formula above. <br><div class="spoiler">  <b class="spoiler_title">It looks like this</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/ca1/56e/7b6/ca156e7b61964ff6a854d9e2f3dc70bd.jpg"><br>  It would seem simple, but before that we still have to think! </div></div><br><br>  So, if you decide to implement power monitoring, then there are two options: <br><br>  1. Your meter is closed and sealed at the most do not play about.  This means that pulses can only be read using a photoresistor that reacts to a blinking light bulb.  It must be attached with blue electrical tape opposite the LED indicator on the front panel of the meter. <br>  The scheme will look like this: <br><div class="spoiler">  <b class="spoiler_title">Scheme for contactless removal of pulses</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/d6c/1ad/f5b/d6c1adf5b8644ccda91ddfc82a999c42.jpg"></div></div><br>  The program simply compares the resistance value on the photoresistor and potentiometer.  And the latter allows you to set the sensitivity of such a sensor in order to avoid false triggering and tune to the brightness of the indicator. <br><br>  2. You have access to the pulse output of the counter.  Many models have a pulse output that duplicates the flashes of the sweetheart.  This was done in order to be able to connect the device to the automated accounting system.  It is a transistor that opens when the indicator is on and closes when it goes out.  Connecting directly to it is not difficult - for this you need only one pull-up resistor.  <b>However, before you do this, make sure that this is a pulse output, and not anything else!</b>  <b>(there is always a scheme in the passport)</b> <br><div class="spoiler">  <b class="spoiler_title">Diagram for connecting to the telemetry output</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/71e/713/cd1/71e713cd15dd4d4683105eddd48313fd.jpg"></div></div><br>  In my case, access is full, so I didn‚Äôt bother much.  Install LabView and measure forward!  All graphics represent power (W) in real time. <br>  The first to distribute was a long-suffering kettle.  The cap says that it has a power of 2.2 kW, but judging by the schedule, regularly consumes only 1700 watts.  Note that consumption is more or less constant in time.  This means that the heating element (most likely nichrome) very little changes its resistance during the whole boiling process. <br><br><img src="https://habrastorage.org/files/263/1fe/f74/2631fef74ff3476eaadcb8df3a5058bb.jpg"><br><br>  The glue gun is quite another matter - the declared power is 20 W. It behaves in accordance with the laws of physics - when heated, the resistance of the heater increases, and the current decreases accordingly.  Checked with a multimeter - everything is as it is. <br><br><img src="https://habrastorage.org/files/14e/ab9/477/14eab94776a24e0296ea198e255a084f.jpg"><br><br>  Old radio "Spring".  Here the graph went up at the beginning due to the fact that I started the measurement during the impulse, respectively, this affected the data.  The slides on the chart show how I turned the volume knob.  The louder - the more the radio eats. <br><br><img src="https://habrastorage.org/files/a5b/092/cc8/a5b092cc83754bb2a1e0b9b7587f0ed1.jpg"><br><br>  Punch with a declared power of 700 watts.  He pressed the button until it stops, waited a little bit and released, but not smoothly.  The graph clearly shows the inrush current when the engine is started.  That is why the light blinks when a good neighbor begins to peck his favorite wall. <br><br><img src="https://habrastorage.org/files/c83/2ee/f59/c832eef59f9f41e29fd7d20fb265cd6e.jpg"><br><br>  And now the fun part.  I conducted a small experiment with my old laptop, the result of which is shown in the picture: <br><br><img src="https://habrastorage.org/files/a6c/654/82c/a6c65482cea94ae6b30ab4281dbc48e0.jpg"><br><br>  The orange dot marks the time when I launched several ‚Äúheavy‚Äù programs at once.  As you can see, the graphics of the CPU and increased consumption have something in common with each other.  Recently there was <a href="http://habrahabr.ru/post/234359/">one interesting article</a> that gives some thoughts.  I'm not sure that using power monitoring, you can drain encryption keys, but the fact is obvious. <br>  (Tremble paranoid!) <br><br>  In general, from the usual counter and cheap Arduino, you can make a fairly simple and interesting solution for a homemade "smart home".  In addition, in fact, monitoring of electricity consumption is quite a good opportunity to organize a monitoring system of the included devices, which, based on the change in consumption and its nature, will guess what was included.  Without any additional sensors. <br><br>  Sketch sources for Arduino and LabView file can be downloaded <a href="http://www.open-electronics.org/real-time-energy-monitor-with-arduino-and-labview/">on the author‚Äôs page</a> .  After installation, <s>modify the file to</s> add a block in accordance with the description above. </div><p>Source: <a href="https://habr.com/ru/post/234679/">https://habr.com/ru/post/234679/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234659/index.html">EU has banned some e-commerce tricks</a></li>
<li><a href="../234661/index.html">BitTorrent Sync 1.4 Released</a></li>
<li><a href="../234663/index.html">How I shamefully deactivated the botnet</a></li>
<li><a href="../234673/index.html">tSqlt - unit testing in Sql Server</a></li>
<li><a href="../234677/index.html">How to accept credit card payments - Badoo experience</a></li>
<li><a href="../234681/index.html">Cisco Systems has released mobile network exams</a></li>
<li><a href="../234683/index.html">Hyperlapse: shooting accelerated video with image stabilization on a smartphone</a></li>
<li><a href="../234685/index.html">SSH access to Infobox Jelastic 2 cloud hosting</a></li>
<li><a href="../234687/index.html">Modern production management methodologies</a></li>
<li><a href="../234689/index.html">University of Florida removed paper books from the library</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>