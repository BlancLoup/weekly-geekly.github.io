<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We make a simple sonar modem</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello dear! 
 In this article, by popular demand, we will explain how to make the simplest sonar modem: some digital signal processing, some programmi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We make a simple sonar modem</h1><div class="post__text post__text-html js-mediator-article"><h3>  Hello dear! </h3><br>  In this article, by popular demand, we will explain how to make the simplest sonar modem: some digital signal processing, some programming, some homemade printed circuit boards, and a drop of practical hydrology. <br><br>  All interested - welcome under the cat, in the reverberant world of underwater communication! <br><br>  But the relevant picture, to attract attention: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/_8/0u/jz/_80ujzh-1afojo46fevq6egccvg.jpeg"><br><a name="habracut"></a><br><blockquote>  ‚ÄúUltimately, the purpose of our existence is to waste energy ... And, if possible, you know, so that it is interesting to yourself and useful to others.‚Äù <br>  (C) ABS, "Noon, XXII Century" </blockquote><h3>  To save your time - a summary </h3><br><ul><li>  Hydroacoustic modems do not sell on Aliexpress yet. </li><li>  There is a simple and undemanding to computing resources method of detecting the tone, the frequency of which is 4 times less than the sampling frequency;  Arduino is enough for implementation </li><li>  <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/tree/master/SRC">Sample code</a> for PC is on GitHub </li><li>  Receiving and transmitting antennas are made from piezo-diggers of 10 p each </li><li>  We buy (or do it ourselves) the amplifier's headband on the TDA2030 on Ali for 50 rubles </li><li>  We make LUT th preamplifier, with a total cost of ~ 100 rubles </li><li>  Connect and go to the pond </li><li>  Rejoice </li></ul><br><h3>  Motivational Prelude </h3><br>  Now you can buy almost anything on Aliexpress or eBay.  Especially a lot of different for self-manufacturing of something electronic based on Arduino.  You can make (if you just buy uninteresting) a millenn-stop meteorological station with an Internet connection, an automatic cat feeder, a home brewery controller, but you still cannot buy a sonar modem, a designer for its manufacture, or at least a module for adruino.  Well and good!  And do not - now we will tell how to do it, and also tell you how it works. <br><br>  We all thought for a long time what could be offered to lovers for self-production.  Something very simple, which can be collected by a schoolchild from a <s>stick and rope of</s> what everyone has at hand, but at the same time necessarily representing at least the minimum practical or educational value. <br><br>  Something promising a long and fascinating improvement, something that can be transferred even to arduino <s>, be it amiss</s> . <br><br>  If we approach the question materialistically, we would like to offer a detailed tutorial for the manufacture of some simple device that would be more or less able to transmit data in a shallow water reservoir (a shallow hydroacoustic channel is the most complex), would mean the maximum production of a printed circuit board using LUT, with a total cost not exceeding two or three hundred rubles on the minimum. <br><br><h3>  What will we do today? </h3><br><ul><li>  recall how to make a suitable sonar antenna and make a couple; </li><li>  We will connect one of the antennas to the PC via an amplifier on the TDA for ~ 50 rubles and get a transmitter; </li><li>  for the second we will do with the help of LUT a preamplifier for ~ 100 rubles; </li><li>  write <s>(I already wrote and put everything on Git) a</s> simple C # modem and try everything on the nearest reservoir; </li></ul><br><h3>  What do we need for this? </h3><br><ul><li>  two piezoelectric elements.  For example, <a href="https://www.aliexpress.com/item/5PCS-LOT-15cm-cable-length-diameter-35mm-Piezo-Ceramic-Element/32887402292.html%3Fspm%3D2114.search0104.3.51.2fa41c2eDCvl13%26ws_ab_test%3Dsearchweb0_0,searchweb201602_1_10065_10068_10890_319_10546_317_10548_10696_453_10084_454_10083_10618_10307_537_536_10059_10884_10887_321_322_10915_10103_10910,searchweb201603_52,ppcSwitch_0%26algo_expid%3Dfc0df690-2647-4172-8edc-978e564b3ec7-7%26algo_pvid%3Dfc0df690-2647-4172-8edc-978e564b3ec7%26transAbTest%3Dae803_5">from a clock or postcard</a> ; </li><li>  RG-174 / U cable (or equivalent) ~ 5 meters; </li><li>  oil free sealant; </li><li>  water resistant varnish; </li><li>  foil textolite, a total of about 100x200 mm; </li><li>  an amplifier on the TDA2030 (for example, <a href="https://www.aliexpress.com/item/1pcs-TDA2030A-Module-Single-Power-Supply-Audio-Amplifier-Board-Module/32847983961.html%3Ftt%3Dsns_none%26aff_platform%3Ddefault%26cpt%3D1557766052396%26sk%3DXXxRqxY%26aff_trace_key%3D24a5a2a3375a462ebee4006e2341e3bb-1557766052396-09983-XXxRqxY%26terminal_id%3D6eb28f235e794d9897c6710be47d8866">one</a> for 50 rubles); </li><li>  <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/BOM.xlsx">accessories</a> for the preamp </li></ul><br><h3>  How does it work? </h3><br>  The whole idea of ‚Äã‚Äãthe simplest modem is built on, again, the simplest (coincidence?) Detector of a certain tone, about which, to my shame, I have not heard.  He told me about him quite by chance <a href="https://habr.com/ru/users/andrey_9999a/" class="user_link">andrey_9999a</a> .  He, by the way, made a preamp charge. <br><br>  In this regard, I recalled a quote from the book by Leonard Susskind ‚ÄúThe Battle of a Black Hole‚Äù: <br><blockquote>  ‚ÄúAs a wine connoisseur, I am more or less sure that even with my eyes closed I can distinguish red from white.  Even more reliably I distinguish wine from beer.  But then the taste will fail me. " <br></blockquote>  I can say to myself that, as a real electronics engineer, I am more or less sure that I can definitely solder two thick wires.  Even more reliably, I distinguish a hot soldering iron from a cold one even with eyes closed, but then further the skill will let me down.  Therefore, all that concerns the development and manufacture of boards is the work of my comrades and colleagues <a href="https://habr.com/ru/users/andrey_9999a/" class="user_link">andrey_9999a</a> and <a href="https://habr.com/ru/users/stdmitriev/" class="user_link">StDmitriev</a> . <br><br>  So back to the detector.  It is a simplified special case of calculating the Fourier integral: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><msubsup><mi>t</mi><mn>0</mn><mi>T</mi></msubsup><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><mi>a</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mi>d</mi><mi>t</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.594ex" height="3.021ex" viewBox="0 -883.9 10589.2 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-69" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-6E" x="595" y="0"></use><g transform="translate(1196,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-54" x="511" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMAIN-30" x="511" y="-435"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-66" x="2155" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMAIN-28" x="2706" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-78" x="3095" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMAIN-29" x="3668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-73" x="4057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-69" x="4527" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-6E" x="4872" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMAIN-28" x="5473" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-6F" x="6112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-6D" x="6598" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-65" x="7476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-67" x="7943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-61" x="8423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-74" x="8953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMAIN-29" x="9314" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-64" x="9704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-74" x="10227" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><msubsup><mi>t</mi><mn>0</mn><mi>T</mi></msubsup><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><mi>a</mi><mi>t</mi><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ int_0 ^ Tf (x) sin (\ omega t) dt </script></p><br>  In the case of a digital signal, to calculate the amplitude of an arbitrary harmonic, you need to perform a discrete Fourier transform, for Arduina it is rather heavy, but the trick is that if you take <i>Fc</i> as the carrier frequency such that it will be exactly 4 times lower than the sampling frequency <i>Fs</i> , the amplitude of this harmonic can be calculated demonically simpler. <br><br>  In this case, <i>dt = 2œÄ * (Fs / 4) / Fs = œÄ / 2</i> , and for the carrier period there are only 4 samples: <br><br><img src="https://habrastorage.org/webt/__/zm/oe/__zmoe1u0jzgjderykrsaogn0k8.png"><br><br>  If everything is shifted by <i>œÄ / 4,</i> then the samples will take only two values: ‚àö2 / 2 and -‚àö2 / 2, for simplicity, we leave only the signs - <b>‚Äú+‚Äù and ‚Äú-‚Äù</b> . <br><br>  The essence of the method is that we represent the sinus phase as a sequence of signs <b>‚Äú+‚Äù ‚Äú+‚Äù ‚Äú-‚Äù ‚Äú-‚Äù</b> , and the cosine phase as <b>‚Äú+‚Äù ‚Äú-‚Äù ‚Äú-‚Äù ‚Äú+‚Äù</b> . <br><br>  Let the input signal lie in the <i>sn</i> buffer, we have two annular averaging buffers for the sine and cosine phases - <i>bs</i> and <i>bc of</i> size <i>N.</i>  They have common head and tail pointers - <i>bH</i> and <i>bT</i> .  At the initial moment of time, <i>bH = N-1, bT = 0</i> .  Averaging cycle counter <i>C = 0</i> . <br><br>  We take 4 samples from the input buffer and fold them according to the sequences of characters. <br><br><div class="spoiler">  <b class="spoiler_title">Code example</b> <div class="spoiler_text"><code>a = sn(i) <br> bs(bH) = a <br> bc(bH) = a <br> s1 = s1 + a - bs(bT) <br> s2 = s2 + a - bc(bT) <br> bH = (bH + 1) % N <br> bT = (bT + 1) % N <br> <br> a = sn(i+1) <br> bs(bH) = a <br> bc(bH) = -a <br> s1 = s1 + a - bs(bT) <br> s2 = s2 - a - bc(bT) <br> bH = (bH + 1) % N <br> bT = (bT + 1) % N <br> <br> a = sn(i+2) <br> bs(bH) = -a <br> bc(bH) = -a <br> s1 = s1 - a - bs(bT) <br> s2 = s2 - a - bc(bT) <br> bH = (bH + 1) % N <br> bT = (bT + 1) % N <br> <br> a = sn(i+3) <br> bs(bH) = -a <br> bc(bH) = a <br> s1 = s1 - a - bs(bT) <br> s2 = s2 + a - bc(bT) <br> bH = (bH + 1) % N <br> bT = (bT + 1) % N</code> <br> </div></div><br>  After each processed four samples, we check the averaging cycle counter, and if it has passed <i>N</i> , then we calculate the amplitude <i>cA of the</i> carrier: <br><br><pre> <code class="plaintext hljs">if ++cycle &gt;= N cA = sqrt(s1 * s1 + s2 * s2) cycle = 0 end</code> </pre> <br>  This is how it looks on an ideal signal: <br><br><img src="https://habrastorage.org/webt/aj/w5/q5/ajw5q5dls4ruoi_gjzdswjay0ko.png"><br><br>  The signal itself is shown in blue, the carrier amplitude is shown in red (everything is reduced to a range of -1..1).  In this case, <i>N = 2</i> because  There is no noise and everything works fine. <br><br>  Now add some white noise and see how our detector reacts to this: <br><br><img src="https://habrastorage.org/webt/ah/ee/0j/ahee0jsjvmnm_cm89jvyroxmrlg.png"><br><br>  I added white noise so that the signal-to-noise ratio was 0 dB.  In the figure above, blue shows a noisy signal, green shows the source signal, and red shows the amplitude value.  In this case, the detector with <i>N = 2</i> has not detected anything, and the minimum N at which it works properly is 32. Ie  the size of the processing window in the samples was <i>32 * 4 = 128</i> samples. <br><br>  That is, now we can analyze the input signal and estimate a parameter that quantifies the presence of frequency, four times less than the sampling rate.  If we set a certain threshold value for this parameter, then everything can be binarized, and to put it simply, we can answer the question: is there a given tone in the input signal or not? <br><br>  This is very good, but we need to pass bits, and the bits can take two values. <br><br>  Implement a system with two signal states with the help of one - so-so idea, so we <i>will not</i> encode one of the states of silence (pause).  It would have made the detection more difficult: it would have been necessary to somehow single out the beginning of the premise, think up how to arrange its end, etc. <br><br>  Instead, "1" and "0" we will encode pulses of different lengths, between the bits there is a so-called.  the guard interval - because we still need to deal with multipath propagation and reverberation.  In simple terms, the guard interval is the place (time) where all the reflections of the previous bit, all sounds and echoes fade out. <br><br>  Looking ahead, we note that with such a signal structure, the algorithm of the receiver operation is greatly simplified: waiting for the tone to appear, detecting the beginning, waiting for the tone to disappear, and detecting the time again - if the received time is more similar in length to ‚Äú1‚Äù, we probably took a bit with a value of "1", if it looks more like a "0" - then apparently we took a bit, with a value of "0". <br><br>  In general, we can say that this is some kind of Morse code. <br><br><h3>  Software part of the modem </h3><br>  For the impatient, <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem">an example is on GitHub</a> .  Written in haste in C # (because for the PC I write on it and I just feel more comfortable and faster). <br><br>  To play and capture the sound from the microphone input is used a wonderful library <a href="https://github.com/naudio/NAudio">NAudio</a> . <br><br>  All modem logic is in the class <a href="">SUAModem</a> (Simple Underwater Acoustic Modem). <br><br>  The following parameters are passed to the constructor: <br><br>  double sRateHz is the sampling rate in Hertz; <br>  int wSize - the size of the processing window in the samples; <br>  int oneMultiplier - how many "windows" the bit with the value "1" lasts <br>  int zeroMultiplier - how many "windows" the bit with the value "0" lasts <br>  double eThreshold - a threshold, let's say about it later <br><br>  To generate a signal from an array of bytes, there is a ModulateData (byte [] data) method, which returns an array of 16-bit signed samples. <br><br><div class="spoiler">  <b class="spoiler_title">public short [] ModulateData (byte [] data)</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ModulateData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] data</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> alpha = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> phase = <span class="hljs-number"><span class="hljs-number">0</span></span>; List&lt;<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>&gt; samples = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>&gt;(); BitArray bits = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BitArray(data); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; bits.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sLim = (bits[i]) ? oneDurationSmp : zeroDurationSmp; alpha = <span class="hljs-number"><span class="hljs-number">0</span></span>; phase = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sIdx = <span class="hljs-number"><span class="hljs-number">0</span></span>; sIdx &lt;= sLim; sIdx++) { alpha = Math.Sin(phase); phase += delta; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (phase &gt;= alimit) phase -= alimit; samples.Add(Convert.ToInt16(alpha * <span class="hljs-keyword"><span class="hljs-keyword">short</span></span>.MaxValue)); } samples.AddRange(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span>[defenseIntervalSmp]); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> samples.ToArray(); }</code> </pre><br></div></div><br>  In the main loop, the samples list is filled in by the transmitted bits.  Depending on the current transmitted bit, the length of the sLim signal generated in the samples is set.  A guard interval is added after each bit. <br><br><div class="spoiler">  <b class="spoiler_title">Of course...</b> <div class="spoiler_text">  Many may notice that when generating a signal one could do without the sine function, but this example allows, by changing the value of the delta accordingly, to change the frequency of the generated tone. <br><br>  To generate a tone with a frequency <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>F</mi><mi>n</mi></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.713ex" height="2.349ex" viewBox="0 -772.3 1168.1 1011.3" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.555ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-6E" x="910" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-2"> F_n </script>  at a given sampling rate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>F</mi><mi>s</mi></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.498ex" height="2.349ex" viewBox="0 -772.3 1075.5 1011.3" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.555ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-73" x="910" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mi>s</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-3"> F_s </script>  corresponding value <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.643ex" height="2.074ex" viewBox="0 -772.3 2429.5 892.8" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-64" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-65" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-6C" x="1240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-74" x="1538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-61" x="1900" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> \ delta </script>  it is calculated simply: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mo>=</mo><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>p</mi><mi>i</mi><msub><mi>F</mi><mi>n</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><msub><mi>F</mi><mi>s</mi></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.83ex" height="2.762ex" viewBox="0 -831.5 8107.2 1189" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.83ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-64" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-65" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-6C" x="1240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-74" x="1538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-61" x="1900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMAIN-3D" x="2707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMAIN-32" x="3763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-70" x="4514" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-69" x="5017" y="0"></use><g transform="translate(5363,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-6E" x="910" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMAIN-2F" x="6531" y="0"></use><g transform="translate(7031,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/451800/&amp;xid=17259,15700002,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhht4uTyUnvsXRPC0q-Vsxyc3LodTg#MJMATHI-73" x="910" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>d</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mo>=</mo><mn>2</mn><mtext>&nbsp;</mtext><mi>p</mi><mi>i</mi><msub><mi>F</mi><mi>n</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><msub><mi>F</mi><mi>s</mi></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ delta = 2 \ pi F_n / F_s </script></p><br></div></div><br>  To generate and emit a signal, there is the TransmitData (byte [] data) method, which internally calls ModulateData: <br><br><div class="spoiler">  <b class="spoiler_title">public double TransmitData (byte [] data)</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TransmitData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] data</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> samples = ModulateData(data); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> txTime = ((<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)samples.Length) / SampleRateHz; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rawBytes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[samples.Length * <span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; samples.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bts = BitConverter.GetBytes(samples[i]); rawBytes[i * <span class="hljs-number"><span class="hljs-number">2</span></span>] = bts[<span class="hljs-number"><span class="hljs-number">0</span></span>]; rawBytes[i * <span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>] = bts[<span class="hljs-number"><span class="hljs-number">1</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ms = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MemoryStream(rawBytes)) { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RawSourceWaveStream(ms, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WaveFormat(Convert.ToInt32(SampleRateHz), <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>))) { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> wo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WaveOutEvent()) { wo.Init(rs); wo.Play(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (wo.PlaybackState == PlaybackState.Playing) { Thread.SpinWait(<span class="hljs-number"><span class="hljs-number">1</span></span>); } } rs.Close(); } ms.Close(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> txTime; }</code> </pre><br></div></div><br>  The SUAModem class reports the acceptance of the next byte using the DataReceivedEventHandler event. <br><br>  Input samples are acquired using the ProcessInputSignal (short [] data) method, where they are written to the ring ring buffer.  The analysis takes place in a separate thread, in the Receiver method. <br><br>  And the receiver itself lives in the Receive method: <br><br><div class="spoiler">  <b class="spoiler_title">private void Receive ()</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Receive</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> a</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (rCnt &gt;= <span class="hljs-number"><span class="hljs-number">4</span></span>) { a = ring[rRPos]; rRPos = (rRPos + <span class="hljs-number"><span class="hljs-number">1</span></span>) % rSize; rCnt--; dRing1[rHead] = a; dRing2[rHead] = a; s1 += a - dRing1[rTail]; s2 += a - dRing2[rTail]; rHead = (rHead + <span class="hljs-number"><span class="hljs-number">1</span></span>) % windowSize; rTail = (rTail + <span class="hljs-number"><span class="hljs-number">1</span></span>) % windowSize; a = ring[rRPos]; rRPos = (rRPos + <span class="hljs-number"><span class="hljs-number">1</span></span>) % rSize; rCnt--; dRing1[rHead] = a; dRing2[rHead] = -a; s1 += a - dRing1[rTail]; s2 += -a - dRing2[rTail]; rHead = (rHead + <span class="hljs-number"><span class="hljs-number">1</span></span>) % windowSize; rTail = (rTail + <span class="hljs-number"><span class="hljs-number">1</span></span>) % windowSize; a = ring[rRPos]; rRPos = (rRPos + <span class="hljs-number"><span class="hljs-number">1</span></span>) % rSize; rCnt--; dRing1[rHead] = -a; dRing2[rHead] = -a; s1 += -a - dRing1[rTail]; s2 += -a - dRing2[rTail]; rHead = (rHead + <span class="hljs-number"><span class="hljs-number">1</span></span>) % windowSize; rTail = (rTail + <span class="hljs-number"><span class="hljs-number">1</span></span>) % windowSize; a = ring[rRPos]; rRPos = (rRPos + <span class="hljs-number"><span class="hljs-number">1</span></span>) % rSize; rCnt--; dRing1[rHead] = -a; dRing2[rHead] = a; s1 += -a - dRing1[rTail]; s2 += a - dRing2[rTail]; rHead = (rHead + <span class="hljs-number"><span class="hljs-number">1</span></span>) % windowSize; rTail = (rTail + <span class="hljs-number"><span class="hljs-number">1</span></span>) % windowSize; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (++cycle &gt;= windowSize) { cycle = <span class="hljs-number"><span class="hljs-number">0</span></span>; currentEnergy = Math.Sqrt(s1 * s1 + s2 * s2) / windowSize; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> de = currentEnergy - prevEnergy; <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> analysis </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (skip &gt; 0) skip -= windowSize * 4; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (isRise) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (de &gt; -Threshold) { riseSmp += windowSize * 4; } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { // analyse symbol isRise = false; double oneDiff = Math.Abs(oneDurationSmp - riseSmp); double zeroDiff = Math.Abs(zeroDurationSmp - riseSmp); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (oneDiff &gt; zeroDiff) { // Mostly likely "0" AddBit(false); } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { // Mostly likely "1" AddBit(true); } samplesSinceLastBit = 0; skip = defenseIntervalSmp / 2; } } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (de &gt; Threshold) { isRise = true; riseSmp = windowSize * 4; } } } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> prevEnergy = currentEnergy; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (bPos &gt; 0) { samplesSinceLastBit += 4 * windowSize; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (samplesSinceLastBit &gt;= defenseIntervalSmp * 2 + zeroDurationSmp + oneDurationSmp) { DiscardBits(); } } } } }</span></span></code> </pre><br></div></div><br>  From the code it is clear that the analysis is carried out on 4 samples, if you wish, you can save the state and carry out the processing and on one sample, which will be useful when transferring to some weak MC. <br>  As data is received, the value of the amplitude s is calculated at the frequency sRateHz / 4.  The difference between the previous and current amplitude value is calculated and then compared with a predetermined threshold selected experimentally.  The example allows in real time to change this threshold. <br><br>  A sharp increase in the amplitude indicates the beginning of a ‚Äúbit‚Äù, a sharp (somewhat less sharp - due to reverberation) decline - about the end of a ‚Äúbit‚Äù. <br><br>  After receiving the next bit, we work out the guard interval - we skip the specified number of samples - there are all sorts of echoes in them, they will only interfere with us. <br><br><h3>  The iron part of the modem </h3><br>  So, with the structure of the signal, everything is clear, how to take it is also clear.  Things are easy - learn how to radiate a signal into the water and take it out of the water. <br><br>  If you do not have hydroacoustic antennas, then it's time to make them in <a href="https://habr.com/ru/post/431302/">our previous tutorial</a> . <br><br>  I have them left from that time, so I skip this step. <br><br>  That antenna, which is designed for transmission, we connect to <a href="https://www.aliexpress.com/item/1pcs-TDA2030A-Module-Single-Power-Supply-Audio-Amplifier-Board-Module/32847983961.html%3Ftt%3Dsns_none%26aff_platform%3Ddefault%26cpt%3D1557765605290%26sk%3DXXxRqxY%26aff_trace_key%3D5b7cbf3c89fc4d6fbe6aa2e870630181-1557765605290-02601-XXxRqxY%26terminal_id%3D6eb28f235e794d9897c6710be47d8866">the amplifier board with aliexpress</a> .  For several tens of meters (maybe even for a hundred) this is quite enough for us.  There are no tricks here - the output of the sound card of the laptop goes to the input of the amplifier, which is powered by a lead battery of 12 volts 4 Ah.  Our hydroacoustic transmitting antenna from the piezo sounder is connected to the output.  In my case, it looks like this: <br><br><img src="https://habrastorage.org/webt/za/17/0e/za170ex4xgid-pacrxgcevfkmm8.jpeg"><br><br><img src="https://habrastorage.org/webt/_8/0u/jz/_80ujzh-1afojo46fevq6egccvg.jpeg"><br><br>  In the photo above, on the screen there is a small spoiler of the next article.  Next time on the same pieces of iron, we will again try to transmit the ‚Äúvideo‚Äù sound through the water, but in a completely different way than <a href="https://habr.com/ru/post/408871/">last time</a> . <br><br>  With the receiving antenna is somewhat more complicated.  Although piezo squeezers are very sensitive, this is not enough.  We will have to collect a preamp board with a filter for the 5-35 kHz band. <br>  Gain we take 1000. <br><br>  The circuit, the PCB design, and the list of preamp components are on our GitHub: the <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/piezo_preamp_1000_5-35kHz_schematic.pdf">circuit</a> , the tracks are the <a href="">top layer</a> and the <a href="">bottom layer</a> , <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/BOM.xlsx">BOM</a> . <br><br>  LUT <a href="https://habr.com/ru/search/%3Fq%3D%25D0%259B%25D0%25A3%25D0%25A2">technology has</a> been discussed 100 times a hundred times, but let us also make our contribution. <br><br><div class="spoiler">  <b class="spoiler_title">Photos of the process</b> <div class="spoiler_text">  So, we take the appropriate magazine, we have only this one at hand: <br><br><img src="https://habrastorage.org/webt/wu/72/zy/wu72zyy3twxj-iovwsbu1oplf0o.jpeg"><br><br>  We take from there a couple of pages and print layers on them using a laser printer. <br><br><img src="https://habrastorage.org/webt/aq/c8/of/aqc8of9rwkf_jv4df7o6gb4zqt0.jpeg"><br><br>  Combine with needles and glue along one side, as shown in the photo: <br><br><img src="https://habrastorage.org/webt/gr/g5/-l/grg5-lzyj3bpl574on7uycmo7xk.jpeg"><br><br>  Before using the iron we moisten the toner with isopropyl alcohol: <br><br><img src="https://habrastorage.org/webt/7k/sp/ru/7ksprumtearv6eixwlfndk9fnoo.jpeg"><br><br>  Iron through folded A4 sheet: <br><br><img src="https://habrastorage.org/webt/ut/e5/xu/ute5xu86kbik8c542za18_omuna.jpeg"><br><br>  Soak it with warm water under the tap: <br><br><img src="https://habrastorage.org/webt/rg/lg/98/rglg989tlqi-zotwzq5gwkadbo4.jpeg"><br><br>  And laundered leftover paper.  After that we get a billet ready for pickling: <br><br><img src="https://habrastorage.org/webt/dk/lv/jc/dklvjcuntfws7eg27fr4soukldo.jpeg"><br><br>  Cut off the excess with the help of scissors for metal or to whom the more convenient. <br><br>  We poison in ferric chloride.  Especially for the article, we bred fresh, it turned out to be so strong that from the future board there are bubbles: <br><br><img src="https://habrastorage.org/webt/wc/nq/ri/wcnqrifmzqht9luucn3lt0xf1uc.jpeg"><br><br>  As a result, after etching and washing the toner we get the following semi-finished product: <br><br><img src="https://habrastorage.org/webt/vk/de/k7/vkdek7hiqs1p3van-coacl4gkk4.jpeg"><br><br><img src="https://habrastorage.org/webt/ks/x-/hd/ksx-hd6m6qdijzicf1rwgnhwoy4.jpeg"><br><br>  After the components are soldered and washed, the board looks like this. <br><br><img src="https://habrastorage.org/webt/wn/x4/fd/wnx4fd56r1newq2ew6cjr1hmlaa.jpeg"><br></div></div><br>  And this is what the receiving part of the assembly looks like.  Power is supplied from the same lead battery 12 volts: <br><br><img src="https://habrastorage.org/webt/mc/03/dj/mc03djslty9veqpq1aqsllzbckq.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">Small filter disclaimer</b> <div class="spoiler_text">  If the reader wants to change the band, we suggest recalculating the 8th order filter assembled on the TL084C cheap 4-channel opamp (DA2 in the <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/piezo_preamp_1000_5-35kHz_schematic.pdf">diagram</a> ), resistors R10-R13, R15-R23 and capacitors C5-C8, C11, C12, C14 and C15. <br><br>  Just in case, here are the frequency response of the current implementation of the filter: <br><br><img src="https://habrastorage.org/webt/bi/pd/dy/bipddyy5zubboog4qimejpdxvjw.png"><br><br>  And here's another <a href="">project</a> for this filter, created in the <a href="http://qucs.sourceforge.net/">Qucs</a> application. <br></div></div><br><h3>  Experiments and tests </h3><br>  To connect to a laptop, we use the usual Jack 3.5 mm, the very tip is a signal, the middle one is not connected, the ground is <s>dust to dust</s> in the ground.  All amplifications and any microphone effects need to be turned off, and the volume will have to be played to reach the optimal level.  The cheat should happen when the antenna connected to the preamplifier is touched with a finger and lightly stroked. <br><br>  If you simply put one piezo on another without an amplifier and a preamp and connect them to the audio input and output, then everything works perfectly.  Below is the signal segment and you can even determine where the values ‚Äã‚Äãof bits are: <br><br><img src="https://habrastorage.org/webt/ft/ny/jm/ftnyjmiapa0uoyeuyhjo2ztaeji.png"><br><br>  The signal itself is shown in blue, the difference between the current and previous amplitude values ‚Äã‚Äã(front) is shown in red, the difference between the previous and current values ‚Äã‚Äã(decrease) is in green.  You can easily ‚Äúdemodulate‚Äù this part of the premise: 1 0 0 0 1 1 0. In our case, the zero is twice as long as one, and the length of the guard interval is equal to the duration of zero. <br><br>  Further, also without an amplifier and a preamplifier, we lower our antennas into a metal tank, measuring 3x1.5x1.5.  We have this in the laboratory, and we made a rule for ourselves that we are not engaged in any communication if it is somehow unable to work in this tank.  The fact is that in such a closed volume of energy there is no particular place to go - the sound is wonderfully and repeatedly reflected from the metal walls and porridge is obtained at the point of reception.  And given the fact that we usually check ready devices with energy, designed for thousands of meters, you can imagine what is happening there. <br><br>  For example, our two <a href="https://github.com/ucnl/Docs/blob/master/RU/Modems/RedLINE/RedLINE_Specification_ru.pdf">RedLINE</a> modems <a href="https://github.com/ucnl/Docs/blob/master/RU/Modems/RedLINE/RedLINE_Specification_ru.pdf">work</a> stably in this tank only at a distance of no more than two meters, and two <a href="https://habr.com/ru/post/428367/">uWAVEs</a> work stably at about 1 meter.  While the first in open water works up to 8000 meters, and the second - <a href="https://www.youtube.com/watch%3Fv%3DZ1bVerVecY0">up to a kilometer</a> . <br>  Of course, all commercial products do not use such primitive modulation schemes, which are discussed in the article and are much more complicated, but now it is important for us to understand the basics and do something with our hands. <br><br>  In general, we lower the antennas into the tank for a distance of about 50 centimeters and get something much less beautiful than with the direct contact of the antennas: <br><br><img src="https://habrastorage.org/webt/zy/my/o9/zymyo9ptbahm3xh60dsv-5hz1mg.png"><br><br>  Although a much longer guard interval is used here, it is still evident that the echo goes almost to the next bit, the fronts and especially the recessions are very blurred.  But you can still determine the content of the message: 1 0 0 0 1 1 0 <br><br>  In both cases, I transmitted the message "123" and these seven bits belong to the unit symbol. <br>  It looked like this, then the interface was slightly redone <br><br><img src="https://habrastorage.org/webt/om/ym/sw/omymswxytjqy_l6uvzbijcr1pac.png"><br><br>  From the screen above, it is clear that with those settings, the transmission of the message ‚ÄúHello, <a href="https://habr.com/ru/users/habr/" class="user_link">habr</a> !!!  :-) ‚Äùconsisting of 19 bytes takes 9.132 seconds, that is, the transmission rate was 16.6 bit / s.  By the way, in order for the modem to work in our tank, we had to increase the guard interval so that the transmission rate dropped to ~ 3 bps. <br><br>  We checked the homemade in the swimming pool, where it has steadily earned on 10 meters. <br><br><img src="https://habrastorage.org/webt/bq/jh/_n/bqjh_nwss-l-zjzi5hj5m7xru44.jpeg"><br><br>  We also indulged in homemade products on the pond.  I used an active hydrophone very similar in construction to the one proposed in the article, only instead of a piezopischalki there was used a sensor from parking sensors, the battery there was mounted in a coil onto which the cable was wound: <br><br><img src="https://habrastorage.org/webt/be/hk/jm/behkjmbi2kz0_sxallhxjwyoqvc.jpeg"><br><br><img src="https://habrastorage.org/webt/yu/ke/-w/yuke-wfwsgcozt5pg77d8g4cic8.png"><br><br>  The receiver and transmitter antennas descended directly from the shore, the depth there dramatically decreases from 0.5 to 2 meters.  In the experience shown in the photo above, oddly enough, the worst conditions, the distance there was only about 5 meters - this was the initial setting in general.  Of the 20 transmitted messages of 3 bytes, in six of them one byte was beaten. <br><br>  Then, when we connected the receiver to the second laptop and transferred to the other side of the pond (distance of about 30 meters), the transmission went much better - there were only a couple of errors in 40 messages ranging in size from 3 to 13 bytes. <br><br><img src="https://habrastorage.org/webt/wp/bz/6i/wpbz6i4wngzg4fdgfza2bxkr2h0.png"><br><br>  The next photo on the map shows the places where the antennas were located. <br><br><img src="https://habrastorage.org/webt/-i/_u/lk/-i_ulk8o3bsyu4ni7um5tyky73c.png"><br><br><h3>  Conclusion and further research </h3><br>  As promised, for a few rubles, we collected a working device.  Although its practical value is doubtful, the process of manufacturing and setting up on the pond itself will be very useful for beginners.  On the described carrier detection method, it is quite possible to come up with various simple navigation systems for amateur use, and what is especially nice, the computational complexity allows one to implement the method on a simple microcontroller. <br><br>  In order not to be unfounded regarding the construction of navigation systems on simple signals, take a look at the <a href="https://www.semanticscholar.org/paper/UNDERWATER-ACOUSTIC-POSITIONING-SYSTEMS-BASED-ON-Alcocer-Oliveira/134a4e769a6a64c6f5bc0f0efda9ed2a93893bdb">interesting work</a> in which they built a full-fledged long-base navigation system.  In this system, the position of the pinger is determined, which periodically transmits its depth.  The depth value is coded by the distance between two simple pulses at a certain frequency.  So yes, yes, the pots are not the gods burned, the road will be mastered by walking, patience and work, learn, learn, learn - that‚Äôs all. <br><br>  Perhaps, given time, we will do a DIY project for positioning an autonomous pinger, emitting simple signals.  Something similar, but not DIY, we have already done on the basis of our <a href="https://github.com/ucnl/Docs/blob/master/RU/Modems/uWAVE/uWAVE_Specification_ru.pdf">uWAVE</a> modems, which even tried to <a href="https://www.youtube.com/watch%3Fv%3DUHfTv7TtABU%26t%3D11s">shoot a video</a> .  It will be very interesting to hear your opinions on this matter - it is very important to have confirmation that you are not doing something in vain. <br><br>  However, returning to the main topic, we note that it would be possible to improve in the proposed scheme: <br><br><ul><li>  make threshold calculation adaptive </li><li>  analyze the width of the signals automatically </li><li>  try using different lengths for different bit combinations </li><li>  screw <s>noiseproof</s> coding </li><li>  transfer all this to arduino </li><li>  the volume and threshold have to be long and tedious to pick up, so it would be good to add to the preamplifier AGC </li></ul><br>  At this meeting I will declare closed, and if you are interested in the topic, here is a list of our previous articles: <br><br>  <a href="https://habr.com/ru/post/370083/">Underwater GPS from scratch for the year</a> <br>  <a href="https://habr.com/ru/post/449072/">Underwater GPS on an underwater robot: experience with</a> <br>  <a href="https://habr.com/ru/post/428367/">We made the world's smallest sonar modem</a> <br>  <a href="https://geektimes.ru/post/293681/">On the effect of cyanobacteria on the speech functions of the president</a> <br>  <a href="https://habr.com/ru/post/431302/">We make a simple sonar antenna out of the garbage.</a> <br>  <a href="https://habr.com/post/408871/">Session video transmission sound through the water with exposure</a> <br>  <a href="https://habr.com/ru/post/421977/">Underwater "GPS" on two transceivers</a> <br>  <a href="https://habr.com/ru/post/405845/">Navigation under water: peleinguy not pelenguy - you are doomed to success</a> <br>  <a href="https://habr.com/ru/post/403891/">Underwater GPS: continued</a> <br><br><h3>  PS </h3><br>  As always, we‚Äôre happy to hear comments and suggestions, valid criticism and approving shouts) <br><br><h3>  Pps </h3><br>  Don't remove the pieces of iron far away - next time, with their help, we will again transmit the ‚Äúvideo‚Äù through the water. </div><p>Source: <a href="https://habr.com/ru/post/451800/">https://habr.com/ru/post/451800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451794/index.html">Pixel padding in a texture scan</a></li>
<li><a href="../451796/index.html">Writing a secure browser extension</a></li>
<li><a href="../451798/index.html">Migrating data with mongoDB and Spring Boot</a></li>
<li><a href="../4518/index.html">Network insults cost the American $ 11 million</a></li>
<li><a href="../45180/index.html">Habra chat</a></li>
<li><a href="../451802/index.html">.Net Community Raiffeisenbank invites you to meet UPD Broadcast</a></li>
<li><a href="../451806/index.html">iOS Digest 5 (April 27 - May 16)</a></li>
<li><a href="../45181/index.html">Free alternative</a></li>
<li><a href="../451812/index.html">Now, good developers are measured by views and subscribers - and this is bad</a></li>
<li><a href="../451814/index.html">RBKmoney Payments under the hood - the infrastructure of the payment platform</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>