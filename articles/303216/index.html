<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis of the tasks of the qualifying round of the RCC 2016</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The next qualifying round of the Russian Code Cup 2016 International Programmers Championship has come to an end . And according to the established tr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analysis of the tasks of the qualifying round of the RCC 2016</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a9e/253/23a/a9e25323a9094c80bf65049e95792d9e.jpg"><br><br>  The next qualifying round of the <a href="http://www.russiancodecup.ru/ru/championship/">Russian Code Cup 2016</a> International Programmers Championship has <a href="http://www.russiancodecup.ru/ru/championship/">come to an end</a> .  And according to the established tradition, we invite you to familiarize yourself with the solutions of the tasks that were offered to the contestants in the last round.  This time there were six tasks, although two hours were still allocated for their solution.  <a href="http://www.russiancodecup.ru/ru/championship/result/53/">604 people fought</a> for entering the next round.  The RCC is held for the first time, including for English-speaking participants.  The result did not keep waiting - a serious competition will be made up for Russian-speaking programmers.  50 people reached the final and 19 of them are not Russian-speaking participants.  Among the finalists are representatives of Russia, Ukraine, Belarus, Lithuania, Slovakia, Armenia, Poland, Switzerland, Finland, Japan, China, South Korea. <br><br><ol><li>  <a href="https://habrahabr.ru/company/mailru/blog/303216/">Test</a> </li><li>  <a href="https://habrahabr.ru/company/mailru/blog/303216/">Centipede</a> </li><li>  <a href="https://habrahabr.ru/company/mailru/blog/303216/">Binary tree</a> </li><li>  <a href="https://habrahabr.ru/company/mailru/blog/303216/">Test tubes and reagents</a> </li><li>  <a href="https://habrahabr.ru/company/mailru/blog/303216/">Money exchange</a> </li><li>  <a href="https://habrahabr.ru/company/mailru/blog/303216/">Task F</a> </li></ol><a name="habracut"></a><br><a name="1"></a><h1>  Task A. Examination </h1><br>  <b>Condition</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Time limit of</b> 2 seconds <br>  256 MB <b>memory limit</b> <br><br>  Soon Kolya will have to write an important test, so he decided to prepare thoroughly.  He found out that the control will have <i>n</i> variants, the <i>i-</i> th of which consists of <i>m <sub>i</sub></i> tasks, numbered from 1 to <i>m <sub>i</sub></i> .  For each task of each option, Kohl estimated the time <i>t <sub>ij</sub></i> minutes, which the solution will take from him. <br><br>  During the control, he plans to solve the tasks strictly in the order in which they are arranged in the variant.  It is necessary to hand over the work no later than the end of the control, which lasts <i>t</i> minutes.  Of course, Kohl could have written off the control, but he believes that this is not very correct.  Therefore, ready to write off no more than one job.  He will spend <i>t <sub>0</sub></i> minutes writing off any task. <br><br>  Now, knowing all this information, he wants for each option to find out how many tasks he will have time to decide if he gets this option. <br><br>  <b>Input Format</b> <br><br>  The first line contains three integers <i>n</i> , <i>t</i> and <i>t <sub>0</sub></i> (1 ‚â§ <i>n</i> ‚â§ 100, 1 ‚â§ <i>t</i> ‚â§ 10 000, 1 ‚â§ <i>t <sub>0</sub></i> ‚â§ 100) - the number of options, the duration of the control and the time that Kolya will spend on cheating the task. <br><br>  The following <i>n</i> lines contain a description of the options.  The first number <i>m <sub>i</sub></i> (1 ‚â§ <i>m <sub>i</sub></i> ‚â§ 100) is the number of tasks in option <i>i</i> .  The next <i>m <sub>i</sub></i> numbers <i>t <sub>ij</sub></i> (1 ‚â§ <i>t <sub>ij</sub></i> ‚â§ 100) is the time that Kohl spends on solving the <i>j-</i> th task in the <i>i-</i> th variant. <br><br>  <b>Output format</b> <br><br>  For each option, print a single integer on the new line - the number of tasks that Kohl will have time to decide if he gets this option. <br><br>  <b>Examples</b> <br><br>  Input data <br>  4 45 5 <br>  5 10 10 10 10 10 <br>  4 30 10 10 10 <br>  3 40 40 5 <br>  1,100 <br><br>  Output <br>  five <br>  four <br>  2 <br>  one <br><br>  <b>Decision</b> <br><br>  Let's sort through the prefix of tasks that Kohl will decide.  Find the time he spends if he solves all the tasks himself, and the maximum time he spends on one task in this case.  It is clear that if he will write off, then it is necessary to write off the longest task of those he does.  Then the time that Kohl spends is <i>S</i> - max (0, <i>M</i> - <i>t <sub>0</sub></i> ).  Now we find the largest prefix for which this time does not exceed <i>t</i> . <br><br><a name="2"></a><h1>  Problem B. Centipede </h1><br>  <b>Condition</b> <br><br>  <b>Time limit of</b> 2 seconds <br>  256 MB <b>memory limit</b> <br><br>  In childhood, the boy Fili had a millipede at home.  In total, the centipede had <i>n</i> legs, some of which were right and some were left.  Every day, the centipede used only some of its legs, but at least one left and at least one right. <br><br>  Every day Phil wrote two numbers in his notebook - how many left and how many right legs the centipede used on that day. <br><br>  Phil wants to see from his notes how many left and how many right legs his centipede had.  Unfortunately, Phil is not perfect and could make mistakes in several records.  Filya considers the entry <i>l <sub>i</sub></i> , <i>r <sub>i</sub></i> correct if the centipede had at least <i>l <sub>i</sub></i> left and at least <i>r <sub>i</sub></i> right legs. <br><br>  Help him understand how many centipedes could have left and right legs, so that as many records as possible were correct. <br><br>  <b>Input Format</b> <br><br>  The input contains several test cases.  The first line contains the number of tests <i>t</i> (1 ‚â§ <i>t</i> ‚â§ 10 000). <br>  Each of the tests is described as follows: the first line of the test description contains the number <i>n</i> (2 ‚â§ <i>n</i> ‚â§ 10 <sup>9</sup> ) - the total number of centipede legs, and the second line the number <i>m</i> (1 ‚â§ <i>m</i> ‚â§ 10 <sup>5</sup> ) - the number of records. <br><br>  The following <i>m</i> lines contain two numbers each <i>l <sub>i</sub></i> and <i>r <sub>i</sub></i> (1 ‚â§ <i>l <sub>i</sub></i> , <i>r <sub>i</sub></i> ‚â§ <i>n</i> ) - the number of left and right legs used by the centipede on the <i>i-</i> th day according to Fili's records, respectively. <br><br>  The total number of records for all tests does not exceed 10 <sup>5</sup> . <br><br>  <b>Output format</b> <br><br>  For each test in a separate line print the answer to it - the number of left and right legs at the centipede, so that the maximum possible number of records is correct. <br><br>  <b>Examples</b> <br><br>  Input data <br>  3 <br>  four <br>  3 <br>  12 <br>  13 <br>  14 <br>  2 <br>  2 <br>  2 2 <br>  12 <br>  five <br>  four <br>  14 <br>  2 3 <br>  3 2 <br>  4 1 <br><br>  Output <br>  13 <br>  eleven <br>  14 <br><br>  <b>Decision</b> <br><br>  To solve this problem, you can sort all the records by the number of left legs.  Next we will sort out the number of left legs in ascending order.  If the left legs are <i>l <sub>i</sub></i> , then the first <i>i</i> records may potentially be correct, and all subsequent records are exactly wrong (except for the number of legs equal to <i><sub>i i</sub></i> ). <br><br>  Now you need to know how many entries from the first <i>i</i> will be correct.  The record with number <i>j ‚â§ i is</i> true if <i>r <sub>j</sub> ‚â§ n - l <sub>i</sub></i> .  Finding all such <i>r <sub>j</sub></i> is a standard problem and is solved, for example, by a tree of segments. <br><br>  It was also necessary to note that the sum of the numbers in the response must be equal to <i>n</i> , and correctly handle the case where all the entries may be incorrect. <br><br><a name="3"></a><h1>  Problem C. Binary tree </h1><br>  <b>Condition</b> <br><br>  <b>Time limit</b> 4 seconds <br>  256 MB <b>memory limit</b> <br><br>  Student Vasya needs to grow a complete binary tree, all the leaves of which have the same distance from the root, for the bioinformatics test. <br><br>  Recall that a hanging tree is a connected non-oriented graph without cycles, in which one of the vertices is a root.  The parent of a peak is its neighbor, closest to the root, the root has no parent.  The remaining neighbors of the summit are called her sons.  A peak that has no sons is called a leaf.  A complete binary tree is a hanging tree, each vertex of which is not a leaf, has exactly two sons. <br><br>  Unfortunately, during the semester, Vasya spent too much time on programming olympiads and did not really follow the growth of his tree.  A few days before the test, Vasya realized that his tree had grown, but perhaps it was wrong and he did not even have a root.  Vasya can choose any of its vertices by the root of the tree and try to obtain from it the required complete binary tree by adding vertices.  In one day, Vasya can add a new peak to the tree, making it the son of one of the existing ones. <br><br>  Vasya wants to know if he can even complete the task, what peak for this he needs to choose by the root and what is the minimum number of days that will be spent on the task.  If there are several vertices that can be selected by the root to get a complete binary tree, all the leaves of which have the same distance to the root, for the minimum number of days, then it needs a vertex with a minimum number. <br><br>  When deriving the number of days he needs, Vasya wants to see only the remainder of dividing this number by the number 10 <sup>9</sup> + 7. Please note that Vasya needs to minimize the number of days for which he can complete the formation of the tree, and not the remainder of its division At 10 <sup>9</sup> + 7, the balance must be taken immediately before the withdrawal. <br><br>  <b>Input Format</b> <br><br>  The input contains several test cases.  The first line contains the number of tests <i>t</i> . <br><br>  Each of the following <i>t</i> tests is described as follows: in the first line of the test description, a single integer <i>n is given</i> (2 ‚â§ <i>n</i> ‚â§ 2 ‚Ä¢ 10 <sup>5</sup> ) - the number of vertices in the tree.  The next <i>n</i> - 1 lines of the test description give pairs of numbers <i>u <sub>i</sub></i> , <i>v <sub>i</sub></i> (1 ‚â§ <i>u <sub>i</sub></i> , <i>v <sub>i</sub></i> ‚â§ <i>n</i> ) - the numbers of the vertices connected by the <i>i</i> -th edge.  It is guaranteed that the edges form a tree. <br><br>  It is guaranteed that the sum of the numbers n in all tests does not exceed 2 ‚Ä¢ 10 <sup>5</sup> . <br><br>  <b>Output format</b> <br><br>  Print the answer for each test on a separate line. <br><br>  If no vertex can be selected by the root and after that for a certain number of days you get a complete binary tree, all the leaves of which have the same distance to the root, output -1. <br><br>  Otherwise, print two integers - the number of the vertex to be selected by the root, and the remainder of dividing the number of days Vasya needs by 10 <sup>9</sup> + 7. If there are several vertices that allow you to complete the task in the shortest time, output the vertex with the minimum number. <br><br>  <b>Examples</b> <br><br>  Input data <br>  3 <br>  3 <br>  13 <br>  3 2 <br>  four <br>  4 2 <br>  3 2 <br>  3 1 <br>  five <br>  12 <br>  13 <br>  14 <br>  15 <br><br>  Output <br>  thirty <br>  2 3 <br>  -one <br><br>  <b>Decision</b> <br><br>  To minimize the number of days Vasya has to spend, you need to minimize the height of the final binary tree - if the leaf depth in the final tree is <i>h</i> , then Vasya will spend 2 <sup><i>h</i></sup> - 1 - <i>n</i> days to suspend the required number of vertices. <br><br>  Note that if there is a vertex of degree greater than 3 in the tree, then the task will not be performed, - in a full binary tree all vertices have no more than three neighbors.  Note that the root in the answer has exactly two sons. <br><br>  Thus, in order to solve the problem, you need to sort out the root - the vertex of the degree is not greater than 2 - and choose a root with such a vertex that the maximum distance from it to all others is minimal.  This will be the height of the final tree. <br><br><a name="4"></a><h1>  Task D. Test tubes and reagents </h1><br>  <b>Condition</b> <br><br>  <b>Time limit of</b> 2 seconds <br>  256 MB <b>memory limit</b> <br><br>  Today, a chemistry teacher gave Pete a very important task - to pour the reagents into test tubes.  He was given <i>n</i> tubes and <i>m</i> reagents.  For each tube, <i>min <sub>i</sub></i> and <i>max <sub>i</sub></i> are known - the minimum and maximum total amount of liquid in milliliters, which can be in it, respectively, as well as the reagent number <i>c <sub>i</sub></i> and the number <i>p <sub>i</sub></i> .  For each reagent, the number <i>v <sub>i</sub></i> is also known - how many milliliters it has in Petit.  The teacher asks Petya to pour all the reagents so that in the <i>i-</i> th tube at least <i>p <sub>i</sub></i> percent of all the liquid in it is occupied by the reagent <i>c <sub>i</sub></i> , and also that the limits on <i>min <sub>i</sub></i> and <i>max <sub>i</sub></i> are satisfied in each test tube.  All reagents must be completely bottled.  We assume that no chemical reactions and changes in the volume of reagents occurs. <br><br>  Help Petya to complete the teacher's assignment, or tell me that, no matter how hard he tries, he will fail to do it. <br><br>  For example, in the first test set from the example, the following answer will do: <br><br><ul><li>  In the first tube pour 3 milliliters of the first reagent and 2 milliliters of the second. </li><li>  In the second tube, pour 4 milliliters of the third reagent and 1 milliliter of the second. </li><li>  Pour 3 milliliters of the fourth reagent and 1 milliliter of the second into the last tube. </li></ul><br>  In this case, all restrictions on <i>min <sub>i</sub></i> and <i>max <sub>i</sub></i> are fulfilled, as well as restrictions on the percentages of reagents in the test tubes: in the first tube 3/5 = 60% of the first reagent, in the second tube 4/5 = 80% of the third reagent, and in the last tube 3/4 = 75% ‚â• 70% of the fourth reagent.  Also, all reagents are completely poured, so all the requirements given by the teacher are met and the answer is correct. <br><br>  <b>Input Format</b> <br><br>  The input contains several test cases.  The first line contains the number of tests <i>t</i> (1 ‚â§ <i>t</i> ‚â§ 100). <br><br>  Each of the following <i>t</i> tests is described as follows: the first line of the test description contains two numbers <i>n</i> , <i>m</i> (1 ‚â§ <i>n</i> , <i>m</i> ‚â§ 10 <sup>5</sup> ) - the number of tubes and reagents, respectively. <br><br>  The <i>i-</i> th of the following <i>n</i> lines contains four integers <i>min <sub>i</sub></i> , <i>max <sub>i</sub></i> , <i>c <sub>i</sub></i> , <i>p <sub>i</sub></i> (1 ‚â§ <i>min <sub>i</sub></i> ‚â§ <i>max <sub>i</sub></i> ‚â§ 10 <sup>5</sup> , 1 ‚â§ <i>c <sub>i</sub></i> ‚â§ <i>m</i> , 1 ‚â§ <i>p <sub>i</sub></i> ‚â§ 100) - the minimum and maximum total amount of milliliters of liquid that can be poured into the <i>i-</i> th tube, the number of the reagent and its minimum percentage in the tube, respectively. <br><br>  The last line of the test description contains <i>m</i> integers <i>v <sub>i</sub></i> (1 ‚â§ <i>v <sub>i</sub></i> ‚â§ 10 <sup>5</sup> ) - the number of milliliters of the i-th reagent in Petit. <br><br>  It is guaranteed that the sum <i>n</i> and the sum <i>m</i> in all tests does not exceed 10 <sup>5</sup> . <br><br>  <b>Output format</b> <br><br>  For each test output the answer to it. <br><br>  If the answer exists, in the first line output YES, and in the <i>i-</i> th of the next <i>n</i> lines print first the number <i>k</i> - the number of different reagents in the <i>i</i> -th test tube, and then <i>k</i> positive numbers <i>id</i> , <i>v</i> - the number of the reagent and its amount in the test tube .  If there are multiple answers, you are allowed to print any. <br><br>  If the answer to the test does not exist, in a single line print NO. <br><br>  The answer will be considered correct if all the conditions mentioned in the task are fulfilled, and the relative or absolute error does not exceed 10 <sup>‚Äì6</sup> . <br><br>  <b>Examples</b> <br><br>  Input data <br>  2 <br>  3 4 <br>  5 8 1 60 <br>  4 6 3 80 <br>  3 4 4 70 <br>  3 4 4 3 <br>  3 4 <br>  6 8 1 60 <br>  4 6 3 80 <br>  3 4 4 70 <br>  3 4 4 3 <br><br>  Output <br>  YES <br>  2 1 3.0000000000 2 2.0000000000 <br>  2 2 1.0000000000 3 4.0000000000 <br>  2 2 1.0000000000 4 3.0000000000 <br>  NO <br><br>  <b>Decision</b> <br><br>  We present a constructive algorithm in several stages: <br><br><ul><li> If sum (min <sub><i>i</i></sub> )&gt; sum (v <sub><i>i</i></sub> ) is the answer NO. </li><li>  If sum (max <sub><i>i</i></sub> ) &lt;sum (v <sub><i>i</i></sub> ) is the answer NO. </li><li>  Pour into each tube min <sub><i>i</i></sub> ‚Ä¢ <i>p</i> <sub><i>i</i></sub> / 100 milliliters of reagent <i>c</i> <sub><i>i</i></sub> . </li><li>  After that, for each reagent <i>i,</i> sort the tubes for which <i>c <sub>j</sub></i> = <i>i</i> , by increasing <i>p <sub>j</sub></i> and we will in turn pour the remaining reagent number <i>i</i> into them. </li><li>  In each tube we pour more (max <sub><i>j</i></sub> - min <i><sub>j</sub></i> ) <i>p <sub>j</sub></i> / 100 milliliters of the <i>i</i> -th reagent or less if it ends. </li><li>  All remaining from the reagents will be poured into the tubes in any way: in the <i>i-</i> th tube, in total, you can pour any amount of liquid that does not exceed the summary <sub><i>i</i></sub> ‚Ä¢ 100 / <i>p <sub>i</sub></i> (summary <sub><i>i</i></sub> - the total amount of liquid in it at the current moment). </li><li>  If the spill fails and the liquid remains, the answer is NO. </li><li>  The only remaining problem is that in some test tubes there may still be less than min <sub><i>i</i></sub> milliliters of fluid. </li><li>  To fix this in test tube <i>i,</i> first by transferring from all the other test tubes <i>j</i> reagents other than <i>c <sub>j</sub></i> to the <i>i</i> -th test tube, so that at least the <sub><i>j j of the</i></sub> liquid remain in the <i>j</i> -th test tube. </li><li>  If this is not enough, by transferring from the remaining tubes of <i>j</i> liquid number <i>c <sub>j</sub></i> (now it does not spoil the condition on the percentage). </li></ul><br>  After these actions, the resulting separation of reagents into test tubes will always satisfy all the conditions of the problem. <br>  Finally, we note that in this problem there could be certain problems with accuracy.  Tests of the jury were built in this sense quite humanely, but after the tour, Peter Mitrichev (whom we congratulate on winning the qualifying round) showed a test in which significant losses of accuracy occur.  We will try to further avoid subtleties with accuracy in problems with real numbers. <br><br><a name="5"></a><h1>  Problem E. Money exchange </h1><br>  <b>Condition</b> <br><br>  <b>Time limit</b> 4 seconds <br>  256 MB <b>memory limit</b> <br><br>  During his long life, Borya collected a collection of <i>n</i> coins.  He laid out all these coins in a row.  At the same time, the <i>i-</i> th in a row has a coin value of <i>a <sub>i</sub></i> . <br><br>  Boris is going on another trip, but he has very little time left to pack.  Therefore, he wants to take a piece of coins lying in a row and hopes that they will be enough for him. <br><br>  Boris wants to answer several requests.  In each request, Borya wants to know what the minimum amount he cannot pay without surrender if he takes all the coins from <i>l <sub>i</sub></i> to <i>r <sub>i</sub></i> -th.  More formally - he wants to find such a minimal positive integer <i>z</i> , that it is impossible to choose a subset of coins with numbers from <i>l <sub>i</sub></i> to <i>r <sub>i</sub></i> , the total denomination of which is equal to <i>z</i> . <br><br>  <b>Input Format</b> <br><br>  The first line contains two integers <i>n</i> and <i>m</i> (1 ‚â§ <i>n</i> , <i>m</i> ‚â§ 150 000) - the number of coins from Bori and the number of queries.  The next line contains <i>n</i> numbers <i>a <sub>i</sub></i> (1 ‚â§ <i>a <sub>i</sub></i> ‚â§ 10 <sup>9</sup> ) - the value of the <i>i-</i> th coin. <br><br>  The following <i>m</i> lines contain two numbers each, <i>l <sub>i</sub></i> and <i>r <sub>i</sub></i> (1 ‚â§ <i>l <sub>i</sub></i> ‚â§ <i>r <sub>i</sub></i> ‚â§ <i>n</i> ), a description of the queries. <br><br>  <b>Output format</b> <br><br>  For each of the <i>m</i> queries, print the minimum amount that cannot be paid without surrender, using coins from <i>l <sub>i</sub></i> to <i>r <sub>i to the i</sub></i> . <br><br>  <b>Examples</b> <br><br>  Input data <br>  5 5 <br>  2 1 5 3 1 <br>  15 <br>  13 <br>  eleven <br>  2 4 <br>  2 5 <br><br>  Output <br>  13 <br>  four <br>  one <br>  2 <br>  eleven <br><br>  <b>Decision</b> <br><br>  Consider how to find the minimum amount of money that can not be given using a given set of coins.  We will find the answer iteratively.  At the very beginning we can only present a sum that is zero, and we did not use any coins. <br><br>  Suppose that at the next step we considered all coins whose value does not exceed <i>X</i> , and we can pay any amount up to <i>Y</i> inclusive.  Let the total value of coins, each of which is worth more than <i>X</i> , but not more than <i>Y</i> + 1, is equal to sum.  Then if sum = 0, then we cannot present <i>Y</i> + 1 using this set.  Otherwise, we turn to the state that all coins whose value is not more than <i>Y</i> + 1 are considered, and we can represent any amount up to <i>Y</i> + sum inclusive. <br><br>  Note that the value of the maximum coin, which we considered, is growing at least as fast as the Fibonacci numbers.  This means that the process will end in <i>O (log Answer)</i> iterations. <br><br>  To solve the original problem, it is necessary to learn how to find the sum of numbers smaller than X on the segment.  If you do this for O (log n), then you can solve the problem in total for <i>O (m log n log Answer)</i> . <br><br>  This task is standard.  Consider a method that requires a linear amount of memory.  To do this, sort all the numbers in the source array and will respond to all requests in parallel.  At the next iteration for each request, we know the current maximum amount of money that can be received.  Sort all requests by it.  Next, we will add to the Fenwick tree the numbers of the original array in ascending order and at the right time update the boundary for the next query. <br><br><a name="6"></a><h1>  Task F </h1><br>  <b>Condition</b> <br><br>  <b>Time limit of</b> 5 seconds <br>  256 MB <b>memory limit</b> <br><br>  Dwarf Pasha writes a qualifying round for the Gnome Math Cup.  As task F, the following is proposed. <br><br>  Given <i>n</i> positive integers <i>a <sub>1</sub></i> , <i>a <sub>2</sub></i> , ..., <i>a <sub>n</sub></i> and positive integer <i>d</i> , it is required to find any set of nonzero integers <i>x <sub>1</sub></i> , <i>x <sub>2</sub></i> , ..., <i>x <sub>n</sub></i> such that <i>a <sub>1</sub> x <sub>1</sub></i> + <i>a <sub>2</sub> x <sub>2</sub></i> + ... + <i>a <sub>n</sub> x <sub>n</sub></i> = <i>d</i> .  Since the gnomes have poor multiplication and addition, all <i>d</i> , <i>a <sub>i</sub></i> numbers do not exceed 10 <sup>6</sup> , and <i>x <sub>i</sub></i> numbers should be from ‚Äì10 <sup>6</sup> to 10 <sup>6</sup> , but not equal to 0. <br><br>  Help Pasha to find at least one set <i>x <sub>i</sub></i> that satisfies the condition of the problem, or tell him that the organizers have done bad tests and there is no answer. <br><br><h1>  Input Format </h1><br><br>  The first line of input contains <i>t</i> - the number of tests.  Each test is given in two lines.  The first line contains two numbers <i>n</i> and <i>d</i> (1 ‚â§ <i>n</i> ‚â§ 10 <sup>5</sup> , 1 ‚â§ <i>d</i> ‚â§ 10 <sup>6</sup> ).  The second line contains <i>n</i> numbers <i>a <sub>i</sub></i> (1 ‚â§ <i>a <sub>i</sub></i> ‚â§ 10 <sup>6</sup> ).  The sum <i>n</i> for all tests does not exceed 10 <sup>5</sup> . <br><br>  <b>Output format</b> <br><br>  Print the answer to each test.  If the required set <i>x <sub>i</sub></i> exists, then output YES in the first line and output any suitable set in the second line.  Otherwise, in the only line of the answer to the test output NO. <br><br>  <b>Examples</b> <br><br>  Input data <br>  2 <br>  2 1 <br>  2 3 <br>  3 3 <br>  2 3 1000 <br><br>  Output <br>  YES <br>  2 -1 <br>  YES <br>  503 -1 -1 <br><br>  <b>Decision</b> <br><br>  The answer NO only happens in one case when <i>d is</i> not divisible by the greatest divisor of all numbers <i>a <sub>i</sub></i> .  In any other case, the answer always exists.  To begin with, we will learn to get at least some answer without any restriction on the values, having previously divided all <i>a <sub>i</sub></i> and <i>d</i> into gcd ( <i>a <sub>1</sub></i> , ..., <i>a <sub>n</sub></i> ).  If <i>n</i> = 1, then <i>x <sub>1</sub></i> = <i>d / a <sub>1</sub></i> .  In other cases, for each prefix [1, <i>p</i> ] we will select <i>x <sub>i, p</sub></i> such that <i>a <sub>1</sub> x <sub>1, p</sub></i> + ... + <i>a <sub>p</sub> x <sub>p, p</sub></i> = gcd ( <i>a <sub>1</sub></i> , ..., <i>a <sub>p</sub></i> ).  This is done by the inductive method.  <i>x <sub>1, 1</sub></i> = 1. Suppose we have already found <i>x <sub>i, p</sub></i> and want to find <i>x <sub>i, p</sub></i> + 1. Using the advanced Euclidean algorithm, we find <i>s</i> and <i>t</i> : <i>s</i> ‚Ä¢ gcd ( <i>a <sub>1</sub></i> , ..., <i>a <sub>p</sub></i> ) + <i>t</i> ‚Ä¢ <i>a <sub>p + 1</sub></i> = gcd (gcd ( <i>a <sub>1</sub></i> , ..., <i>a <sub>p</sub></i> ), <i>a <sub>p + 1</sub></i> ) = gcd ( <i>a <sub>1</sub></i> , ..., <i>a <sub>p + 1</sub></i> ).  Then for <i>i ‚â§ p</i> <i>x <sub>i, p + 1</sub></i> = <i>s</i> <i>x <sub>i, p</sub></i> and <i>x <sub>p + 1, p + 1</sub></i> = <i>t</i> .  Having obtained <i>x <sub>i, n</sub></i> , we calculate <i>x <sub>i</sub></i> = <i>d</i> / gcd ( <i>a <sub>1</sub></i> , ..., <i>a <sub>n</sub></i> ) <i>x <sub>i, n</sub></i> = <i>dx <sub>i, n</sub></i> .  This solution works for <i>O (n <sup>2</sup> )</i> , which is not suitable for restrictions.  To shorten the time of work, we will choose among <i>a <sub>i a</sub></i> subset that has the greatest common divisor of the same set as the whole set, and one that cannot be reduced.  To do this, we will iterate from <i>a <sub>1</sub></i> to <i>a <sub>n</sub></i> and take a number in a subset if it reduces the number of different prime dividers.  Thus, the selected subset contains no more than 7 elements, since the maximum number of prime divisors for a number less than or equal to 10 <sup>6</sup> is 7. For numbers from the subset, we run the described algorithm, and for numbers that are not included in the set, we simply set <i>x <sub>i</sub></i> = 0. <br><br>  Now the algorithm works for <i>O (n)</i> , but the conditions are not met that <i>x <sub>i</sub></i> modulo do not exceed 10 <sup>6</sup> and among them should not be zeros.  To do this, we describe the normalization procedure.  First we fulfill the first condition for <i>x <sub>i</sub></i> .  First of all, let's make all <i>x <sub>i</sub></i> for <i>i</i> &gt; 1 non-negative and less than <i>a <sub>1</sub></i> .  This is done by a simple equivalent change operation: we subtract from <i>x <sub>1</sub> ka <sub>i</sub></i> and add to <i>x <sub>i</sub> ka <sub>1</sub></i> , where <i>k</i> = <i>(x <sub>i</sub></i> mod <i>a <sub>1</sub></i> - <i>x <sub>i</sub></i> ) / <i>a <sub>1</sub></i> .  Note that the results of the operation fit into the 64-bit data type, since <i>x <sub>1</sub></i> modulo cannot exceed |  <i>d - a <sub>2</sub> x <sub>2</sub></i> - ... - <i>a <sub>n</sub> x <sub>n</sub></i> |  &lt;10 <sup>6</sup> ‚Ä¢ 10 <sup>6</sup> ‚Ä¢ 10 <sup>5</sup> .  Now let's go through all <i>x <sub>i</sub></i> , starting from the second, to the last and with each, we will sequentially perform the operation: subtract <i>a <sub>1</sub></i> from <i>x <sub>i</sub></i> and add <i>a <sub>i</sub></i> to <i>x <sub>1</sub></i> .  Note that there is <i>i</i> such that after applying the operation to <i>x <sub>1</sub></i> , ..., <i>x <sub>i</sub></i> it turned out 0 ‚â• <i>x <sub>1</sub></i> ‚â• ‚Äì10 <sup>6</sup> .  Suppose there is no such <i>i</i> , then all <i>x <sub>i</sub></i> become negative, which could not happen, since <i>a <sub>1</sub> x <sub>1</sub></i> + ... <i>a <sub>n</sub> x <sub>n</sub></i> gives <i>d</i> , that is, a positive number.  After we learned to receive |  <i>x <sub>i</sub></i> |  ‚â§ 10 <sup>6</sup> , it remains to make them nonzero.  We divide all zeros into pairs, perhaps except for one.  In each pair of <i>i</i> and <i>j we</i> assign <i>x <sub>i</sub></i> = <i>a <sub>j</sub></i> and <i>x <sub>j</sub></i> = <i>‚Äìa <sub>i</sub></i> .  We may have a single index <i>p</i> , for which <i>x <sub>p</sub></i> = 0. We will consider several cases: <br><br><ul><li>  If there is <i>x <sub>j</sub></i> that is not equal in magnitude to <i>a <sub>p</sub></i> , then we apply the operation: subtract sign <i>(x <sub>j</sub> ) a <sub>p</sub></i> from <i>x <sub>j</sub></i> and add sign <i>(x <sub>j</sub> ) a <sub>j</sub></i> to <i>x <sub>p</sub></i> . </li><li>  If there is no such <i>x <sub>j</sub></i> , but <i>a <sub>p</sub></i> ‚â§ 5 ‚Ä¢ 10 <sup>5</sup> , then you can apply the operation to any <i>x <sub>j</sub></i> : add sign <i>(x <sub>j</sub> ) a <sub>p</sub></i> to <i>x <sub>j</sub></i> and subtract sign <i>(x <sub>j</sub> ) a <sub>p</sub></i> from <i>x <sub>p</sub></i> . </li><li>  Otherwise, there should be <i>a <sub>q</sub></i> , such that <i>a <sub>q</sub> ‚â† a <sub>p</sub></i> .  If this does not exist, then all <i>a <sub>i</sub> = a <sub>1</sub></i> , and therefore, due to the normalization to the greatest common divisor <i>a <sub>i</sub></i> = <i>a <sub>1</sub></i> = 1, the second case should have been fulfilled.  We perform the operation: subtract sign <i>(x <sub>j</sub> ) a <sub>p</sub></i> from <i>x <sub>q</sub></i> and add sign <i>(x <sub>j</sub> ) a <sub>q</sub></i> to <i>x <sub>p</sub></i> .  After this, <i>x <sub>q</sub></i> is zero.  But now, if <i>n</i> &gt; 2, the first case <i>holds</i> for <i>q</i> , and if <i>n</i> = 2, then the second case <i>holds</i> for <i>q</i> , since <i>d</i> = <i>a <sub>q</sub> a <sub>p</sub></i> ‚â§ 10 <sup>6</sup> . </li></ul><br>  It should be noted that the normalization operation must be performed for each prefix in the algorithm described in the first paragraph in order for the numbers to fit into the 64-bit data type.  For further details you can refer to the jury's decision code laid out along with the tests. <br><br>  *** <br>  The Russian Code Cup Championship is one of the Mail.Ru Group initiatives aimed at the development of the Russian IT industry and integrated with the <a href="https://it.mail.ru/">IT.Mail.Ru</a> resource.  The IT.Mail.Ru platform is designed for those who are keen on IT and are seeking to develop professionally in this area.  The project combines the championships of the Russian AI Cup, the Russian Code Cup and the Russian Developers Cup, educational projects Technopark in MSTU.  Bauman, Technosphere at Moscow State University.  MV Lomonosov and Tehnotrek MIPT.  In addition, using IT.Mail.Ru, you can use tests to test your knowledge of popular programming languages, learn important news from the IT world, visit or watch broadcasts from specialized events and lectures on IT topics. </div><p>Source: <a href="https://habr.com/ru/post/303216/">https://habr.com/ru/post/303216/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../303206/index.html">Microsoft machine learning hackathon results in May</a></li>
<li><a href="../303208/index.html">The book "Android for developers"</a></li>
<li><a href="../303210/index.html">9 secrets of online payments. Part 8: Returns - and How to Avoid Them</a></li>
<li><a href="../303212/index.html">Full list of Microsoft SQL Server trace flags</a></li>
<li><a href="../303214/index.html">9 secrets of online payments. Part 9: Setting up a payment service for the type of business</a></li>
<li><a href="../303218/index.html">How developers live and work in the Czech Republic: an interview with Alexander Sibiryakov from Scrapinghub</a></li>
<li><a href="../303222/index.html">Man is not needed: 30+ materials on algorithmic trading and the development of financial software</a></li>
<li><a href="../303226/index.html">What threatens your site after installing an online consultant and how we deal with it</a></li>
<li><a href="../303230/index.html">Promotion "Summer KVM" - Virtual server on Linux</a></li>
<li><a href="../303232/index.html">WWDC 16: first impressions from the scene</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>