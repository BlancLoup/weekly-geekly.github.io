<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Linux / Mumblehard botnet unmounted using ESET</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A year after the publication of our technical analysis of the botnet based on the Linux / Mumblehard malware, we are pleased to announce its successfu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Linux / Mumblehard botnet unmounted using ESET</h1><div class="post__text post__text-html js-mediator-article">  A year after the <a href="http://download.esetnod32.ru/company/virlab/analytics/2015-05-13-linux-mumblehard-analysis.pdf">publication of</a> our technical analysis of the botnet based on the Linux / Mumblehard malware, we are pleased to announce its successful dismantling.  ESET, together with the <a href="https://www.cybercrime.gov.ua/">Ukrainian cyberpolice</a> and <a href="https://www.cys-centrum.com/">CyS Centrum LLC</a> , were able to dismantle the Mumblehard botnet, stopping its spamming activity since February 29, 2016. <br><br><img src="https://habrastorage.org/files/ad7/61a/958/ad761a9581b1451ab6a08857a00ca4b0.jpeg"><br><br>  ESET has applied a well-known mechanism called sinkhole for all known Mumblehard components.  We shared the data obtained as a result of this operation with the <a href="https://www.cert-bund.de/">CERT-Bund</a> organization.  This organization notified the CERT centers of other countries in the event of the presence of Mumblehard bots there. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  A month after the publication of a study on Mumblehard last year, our researchers noticed the reaction of the intruders who were behind this botnet.  In our report, we mentioned the process of registering domain names, which were the addresses of alternative C &amp; C servers Mumblehard.  This process was used to calculate the size of the botnet and track the spread of malware.  The authors of Mumblehard responded to these actions by removing unnecessary domain addresses and IP addresses from the list of managing C &amp; C servers.  However, they left only the one that was under their direct control. <br><br><img src="https://habrastorage.org/files/4f4/2cf/677/4f42cf677e59402e9d7e615d49264753.png"><br>  Fig.  1. Differences between the Mumblehard backdoor Perl code before and after the publication of a technical study of ESET. <br><br>  The first time we saw an updated version on May 24, 2015.  Her sample appeared on the VirusTotal service the very next day. <br><br>  The bots that existed at that time were not updated at the same time.  Our sinkhole mechanism allowed us to fix the update of the first part of the bots, on their total number of 500 machines, on the 25th of May.  The rest received an update a month later, on June 26th. <br><br><img src="https://habrastorage.org/files/0e6/451/2da/0e64512da0d5414fbed694ac884eccf2.png"><br>  Fig.  2. Statistics of the activity of bots Mumblehard after publication. <br><br>  The attackers switched to using the same C &amp; C server address for the Mumblehard backdoor without providing a backup option.  Getting control over it, followed by its closure, was a sufficient condition for the violation of the botnet.  For this, an initiative was taken from our side, after which we contacted the law enforcement agencies. <br><br>  With the help of the Ukrainian branch of cyber police and CyS Centrum LLC, we were able to obtain information from the C &amp; C server manager in October 2015. Forensic analysis revealed that most of our initial assumptions about the size of the botnet and its goals were correct: sending spam was the main task of the botnet.  We also found several different control panels that were used to manage the botnet. <br><br>  As with the other components of Mumblehard, the control panel was written in the Perl programming language. <br><br><img src="https://habrastorage.org/files/706/829/a61/706829a61bbf454ca1c1d794895c4b9d.png"><br>  Fig.  3. The control panel of the botnet that was used to send commands to the malicious program. <br><br><img src="https://habrastorage.org/files/e3f/0c6/637/e3f0c663711047b5a3f6ad8963cb5b1f.png"><br>  Fig.  4. The control panel displays the status of the spam job. <br><br>  In our previous study, the following question remained open: what was the original vector of user compromise by the Mumblehard malware?  We knew that some users were compromised by this backdoor through an unclosed vulnerability in one of the content management platforms (CMS), such as WordPress or Joomla.  For this purpose, vulnerability in one of their plugins could also be used.  Forensic analysis of the manager of the C &amp; C server backdoor showed that the computers were not compromised through this server.  The scripts we discovered could be run only in the environment where the PHP shell was already installed.  It is possible that Mumblehard operators bought access to these computers of potential victims from another gang. <br><br><img src="https://habrastorage.org/files/cf6/a2e/27d/cf6a2e27d34541339518d045550e9f86.png"><br>  Fig.  5. A control panel for sending commands to the PHP command interpreter list. <br><br>  Another interesting feature of the work of Mumblehard is the mechanism of automatically excluding the IP addresses of bots from the Spamhaus Composite Blocking List (CBL) address list.  The attackers used a special script to track the contents of this list for the presence of the IP addresses of each of the spam bots.  If one of these IP addresses is in this list, the script sent a request to exclude them from the CBL.  Similar requests to exclude addresses from the list are protected using CAPTCHA, but the OCR mechanism (or its external counterpart) was used to bypass it. <br><br><img src="https://habrastorage.org/files/757/ba5/c96/757ba5c96c9d46aeb97839f9da9aedd0.png"><br>  Fig.  6. The status of the IP address of one of the spam bots after its removal from the CBL list. <br><br>  All operations with the C &amp; C server manager, which include interaction with a remote (infected) host, such as executing commands on the PHP interpreter, exclusion from the CBL list and similar to them, are performed using a proxy.  To maintain proxy connections, the spam daemon Mumblehard listens on TCP port 39331. This function is used to mask the source of the query query.  The botnet control panel checks the availability of all proxies among the victims of malware in 63 countries. <br><br><img src="https://habrastorage.org/files/61b/e08/dfe/61be08dfe0424834b0b6496421cbea63.png"><br>  Fig.  7. The control panel displays the status of open proxy connections in different countries. <br><br>  When Ukrainian cyber police experts closed down the Mumblehard C &amp; C server manager on February 29, 2016, it was replaced by a similar one, which was managed by our experts (sinkhole).  We collected data through this server during March 2016. Statistics showed almost 4 thousand systems running Linux, which were compromised by Mumblehard at the end of February.  Recently, the number of compromised systems has been slowly declining. <br><br>  The CERT-Bund organization recently began sending notifications to compromised organizations and users.  We hope to see a significant reduction in the number of infected systems in the following weeks. <br><br><img src="https://habrastorage.org/files/8ad/3fc/ad3/8ad3fcad35b44de89e6eda880f89501c.png"><br>  Fig.  8. Statistics of the new sinkhole server. <br><br>  If you receive a notification that one of your systems has been compromised by Linux / Mumblehard, pay attention to our section on <a href="https://github.com/eset/malware-ioc/tree/master/mumblehard">compromise indicators</a> (IoC) in the GitHub repository.  There are methods for detecting a malicious program in the system and removing it from there. <br><br>  As a preventive measure to prevent infection, you should regularly update web applications hosted on the system, including plugins.  In addition, a complex password should be used for the administrator account. <br><br>  <b>Conclusion</b> <br><br>  Cooperation with law enforcement agencies and other important organizations was crucial, which led to the elimination of the botnet.  Our experts are grateful to the cyber police of Ukraine (Cyber ‚Äã‚ÄãPolice of Ukraine), CyS Centrum LLC and CERT-Bund.  We are pleased with the results of the operation and are proud of our efforts to organize security on the Internet.  The Mumblehard-based botnet is hardly the most dangerous, the most common, or the most difficult of all, but nevertheless, its closure was another step in the right direction, which is shown by the fact that security researchers working with other serious organizations , contribute to reducing the level of cybercrime on the Internet. </div><p>Source: <a href="https://habr.com/ru/post/281372/">https://habr.com/ru/post/281372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../281356/index.html">Simple automation of the management of acts of marriage on SharePoint with examples and pictures</a></li>
<li><a href="../281358/index.html">JetBrains is looking for a technical evangelist with Java experience</a></li>
<li><a href="../281360/index.html">.Net Client for mail.ru cloud</a></li>
<li><a href="../281362/index.html">New Cisco Aironet IEEE 802.11ac Wave 2 Access Points</a></li>
<li><a href="../281370/index.html">Leaks do not violate memory safety</a></li>
<li><a href="../281374/index.html">Visual Studio 2015 Standard Library and Telemetry</a></li>
<li><a href="../281376/index.html">Why did Citrix not become the ‚Äúnew Red Hat‚Äù in the virtualization market? Part 2</a></li>
<li><a href="../281378/index.html">Is a new Yandex, Parallels or Nginx now in Russia? Easily</a></li>
<li><a href="../281380/index.html">Develop HTML5 games in Intel XDK. Part 1. Introduction to the XDK</a></li>
<li><a href="../281382/index.html">We write the replacement find (1) on golang under Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>