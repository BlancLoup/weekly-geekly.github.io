<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A bit about functors and higher order functions in Swift</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Collections 
 Developers who switched to Swift from Objective-C could not help but notice the most convenient functionality that Swift provides for wo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A bit about functors and higher order functions in Swift</h1><div class="post__text post__text-html js-mediator-article"><h3>  Collections </h3><br>  Developers who switched to Swift from Objective-C could not help but notice the most convenient functionality that Swift provides for working with collections.  Using ranges in indexes <pre><code class="hljs pgsql">let <span class="hljs-keyword"><span class="hljs-keyword">slice</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>[<span class="hljs-number"><span class="hljs-number">1.</span></span>.&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>]</code> </pre>  convenient syntax for initializing and adding an item to the collection, extensibility, and of course higher order functions <br><br><h4>  Filter </h4><br>  The most commonly used function for collections is probably filter <br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> alex = <span class="hljs-type"><span class="hljs-type">Person</span></span>(name: <span class="hljs-string"><span class="hljs-string">"Alex"</span></span>, age: <span class="hljs-number"><span class="hljs-number">23</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> jenny = <span class="hljs-type"><span class="hljs-type">Person</span></span>(name: <span class="hljs-string"><span class="hljs-string">"Jenny"</span></span>, age: <span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> jason = <span class="hljs-type"><span class="hljs-type">Person</span></span>(name: <span class="hljs-string"><span class="hljs-string">"Jason"</span></span>, age: <span class="hljs-number"><span class="hljs-number">35</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> persons = [alex, jenny, jason] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> jNamedPersons = persons.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> { $<span class="hljs-number"><span class="hljs-number">0</span></span>.name.hasPrefix(<span class="hljs-string"><span class="hljs-string">"J"</span></span>) } <span class="hljs-comment"><span class="hljs-comment">// [jenny, jason]</span></span></code> </pre> <br><br><h4>  Reduce </h4><br>  Less commonly used, but extremely expressive and convenient is the function reduce. <br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> ages = persons.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{ <span class="hljs-type"><span class="hljs-type">Float</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>.age) } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> average = ages.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, +) / <span class="hljs-type"><span class="hljs-type">Float</span></span>(persons.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>)</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You can write your own higher-order functions, and this is quite fascinating: <br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">divisible</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(by numbers: Int...)</span></span></span></span> -&gt; (<span class="hljs-type"><span class="hljs-type">Int</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { input -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> numbers.<span class="hljs-built_in"><span class="hljs-built_in">reduce</span></span>(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { divisible, number <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> divisible &amp;&amp; input % number == <span class="hljs-number"><span class="hljs-number">0</span></span> } } } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> items = [<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> result = items.<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span>(divisible(by: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)) <span class="hljs-comment"><span class="hljs-comment">// [12, 24]</span></span></code> </pre> <br><br><h4>  Map </h4><br>  The functional concepts of functors and monads came from Haskell.  They say it is impossible to simply take and understand what a monad is, and even more so it is impossible to explain it.  However, we can temporarily drop all the difficulties and explain to ourselves only what is really necessary, and those who want to dig deeper can begin by learning Haskell. <br><br>  So, for simplicity, we can assume that the functor is a container to which the map function is applicable, and a monad is a functor to which the flatMap function is applicable. <br><br>  Since collections are containers, and in Swift the map function is defined for them, they can act as functors: <br>  in order to transform a collection of one type into a collection of another type, take our persons array and get from it an array of ages like [Int] <br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> ages = array.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>{ $<span class="hljs-number"><span class="hljs-number">0</span></span>.age } <span class="hljs-comment"><span class="hljs-comment">// [23, 20, 35]</span></span></code> </pre> <br><br><h4>  Flatmap </h4><br>  And as monads: <br>  to return an array of non-optional values ‚Äã‚Äãfrom an array of oprtional types <br><pre> <code class="hljs smalltalk">let optionalStrings: [<span class="hljs-type"><span class="hljs-type">String</span></span>?] = [<span class="hljs-comment"><span class="hljs-comment">"a"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">nil</span></span>, <span class="hljs-comment"><span class="hljs-comment">"b"</span></span>, <span class="hljs-comment"><span class="hljs-comment">"c"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">nil</span></span>] let strings = optionalStrings.flatMap { <span class="hljs-string"><span class="hljs-string">$0</span></span> } // [<span class="hljs-comment"><span class="hljs-comment">"a"</span></span>, <span class="hljs-comment"><span class="hljs-comment">"b"</span></span>, <span class="hljs-comment"><span class="hljs-comment">"c"</span></span>]</code> </pre> <br>  in order to expand the original collection <br><pre> <code class="hljs bash"><span class="hljs-built_in"><span class="hljs-built_in">let</span></span> odds = [1,3,5,7,9] <span class="hljs-built_in"><span class="hljs-built_in">let</span></span> evensAndOdds = odds.flatMap { [<span class="hljs-variable"><span class="hljs-variable">$0</span></span>, <span class="hljs-variable"><span class="hljs-variable">$0</span></span> + 1] } // [1,2,3,4,5,6,7,8,9,10]</code> </pre> <br><a name="habracut"></a><br><br><h3>  Optionals </h3><br>  But map and flatMap can be applied not only to collections.  It is extremely useful to use Optional types as monads: <br><br><h4>  Map </h4><br>  If Optional has a value, then the result of the map is returned with this value, if there is no value, then nil is returned: <br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> name: <span class="hljs-type"><span class="hljs-type">String?</span></span> = <span class="hljs-string"><span class="hljs-string">"World"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> greeting = name.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { <span class="hljs-string"><span class="hljs-string">"Hello "</span></span> + $<span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-string"><span class="hljs-string">"!"</span></span> } <span class="hljs-comment"><span class="hljs-comment">// "Hello World!"</span></span></code> </pre> <br>  but <pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> name: <span class="hljs-type"><span class="hljs-type">String?</span></span> = <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> greeting = name.<span class="hljs-built_in"><span class="hljs-built_in">map</span></span> { <span class="hljs-string"><span class="hljs-string">"Hello "</span></span> + $<span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-string"><span class="hljs-string">"!"</span></span> } <span class="hljs-comment"><span class="hljs-comment">// nil</span></span></code> </pre> <br><br><h4>  Flatmap </h4><br>  FlatMap works much the same way, with the only difference that the result of the flatMap can return nil, and map cannot <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>: String? = <span class="hljs-string"><span class="hljs-string">"42"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> number = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.flatMap { Int($<span class="hljs-number"><span class="hljs-number">0</span></span>) } <span class="hljs-comment"><span class="hljs-comment">// 42</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">but with the string 'forty-two', Int cannot initialize itself</b> <div class="spoiler_text">  Int can't but swift can much <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> formatter = NumberFormatter() formatter.numberStyle = .spellOut formatter.locale = Locale(identifier: <span class="hljs-string"><span class="hljs-string">"RU"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> a = formatter.number(<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>)</code> </pre>  // 42 <br></div></div><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> string: <span class="hljs-type"><span class="hljs-type">String?</span></span> = <span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> number: <span class="hljs-type"><span class="hljs-type">Int?</span></span> = string.flatMap { <span class="hljs-type"><span class="hljs-type">Int</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>) } <span class="hljs-comment"><span class="hljs-comment">// nil</span></span></code> </pre> <br>  if we try to use the map <br><pre> <code class="hljs vbscript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> number: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>? = <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.map { <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>($<span class="hljs-number"><span class="hljs-number">0</span></span>) }</code> </pre>  see an error. <br><br><h3>  Conclusion </h3><br>  Using monads and functors when working with Optional variables can significantly reduce the amount of code and make it more intuitive. </div><p>Source: <a href="https://habr.com/ru/post/322806/">https://habr.com/ru/post/322806/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322796/index.html">How Virtual Reality Transforms Customer Experience</a></li>
<li><a href="../322798/index.html">31 facts about the early history of the US dollar</a></li>
<li><a href="../322800/index.html">Starbucks should open public access to its API.</a></li>
<li><a href="../322802/index.html">How I got into the PayPal server through a bug in downloading files and got access to remote code execution</a></li>
<li><a href="../322804/index.html">Choosing the right error handling strategy (parts 3 and 4)</a></li>
<li><a href="../322812/index.html">The real hero in the programming world: who is he?</a></li>
<li><a href="../322814/index.html">Updating the application code on a running server</a></li>
<li><a href="../322816/index.html">Automated testing of bots for Telegram</a></li>
<li><a href="../322818/index.html">Announcement of HolyJS 2017 Piter: More JavaScript, good and different</a></li>
<li><a href="../322820/index.html">Models of buying advertising in traffic arbitration</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>