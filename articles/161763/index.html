<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Custom buttons in the Yandex.Maps API 2.0</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Yandex.Maps API 2.0 has a set of standard map controls: 



 There are cases when the developer does not fit the layout of a particular control. F...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Custom buttons in the Yandex.Maps API 2.0</h1><div class="post__text post__text-html js-mediator-article">  The Yandex.Maps API 2.0 has a set of standard map controls: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/964/d5b/fe6/964d5bfe69cf0d797545dc027b4d73ff.jpg" width="400" height="300"><br><br>  There are cases when the developer does not fit the layout of a particular control.  For example, I want to add a red button to the map or it is not satisfied with the standard cork panel, which takes up a lot of space on the map. <br>  In such cases, the developer needs to replace the existing element with his own.  However, he can only change the part that is responsible for the appearance of the element and leave unchanged the logical part of the map control. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In order to create your own control layout, you need to understand parts of the API architecture.  This article provides a brief overview of the concepts that a developer should become familiar with before performing this task and explains the general principle of the interaction between the logical and visual parts of controls.  Three examples of creating layouts are also considered - from simple to complex. <br><br>  The article is intended for developers who have already had experience with the Yandex.Maps API 2.0.  For acquaintance with the basic concepts I recommend to read <a href="">the developer's guide</a> . <br><a name="habracut"></a><br><h4>  Basic concepts </h4><br><h5>  What is a layout? </h5><br>  A layout is a visual representation of a control.  In essence, a layout is an object that can generate html on the basis of the data transmitted to it. <br><br>  The layout receives an object with fields as input: <br><ul><li>  control - reference to the control; </li><li>  options - control options manager; </li><li>  data - control data manager; </li><li>  state - the state manager of the control. </li></ul><br><h5>  What is the options manager (status, data)? </h5><br>  A manager is a repository that allows you to set and retrieve values ‚Äã‚Äãby key.  The options manager also knows how to get options from parent elements if they are not found in the child. <br>  You can get and set options or data as follows: <br><br><pre><code class="hljs pgsql">smallZoomControl.<span class="hljs-keyword"><span class="hljs-keyword">options</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(<span class="hljs-string"><span class="hljs-string">'layout'</span></span>); //   layout smallZoomControl.data.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-string"><span class="hljs-string">'publicId'</span></span>, myId); //      </code> </pre> <br><h5>  What is the difference between options, data and status? </h5><br>  <u>Options</u> are recommendations for the appearance of the control.  For example, the options are given the layout class ('layout'), the minimum width of the button ('minWidth'), etc. <br><br>  An important feature of the options - the possibility of inheritance from parents.  That is, options can be set both directly and through any of the parent elements.  When specifying options via parent elements, as a rule, the prefix is ‚Äã‚Äãused.  For example, the 'layout' option for control.Button can be set via the map as 'buttonLayout' ('button' + 'layout'). <br><br>  <u>Data</u> is a set of fields that describe the content of an item.  For example, the data may be the title of a list ('title') or the contents of a button ('content').  The data is not inherited from the parent elements and is set only directly into the object. <br><br>  <u>A state</u> is a set of fields describing the current state of the control.  Status fields may change as a result of user actions. <br>  Examples of state fields: <br><ul><li>  'expanded' - a sign that the drop-down list is expanded or collapsed; </li><li>  'selected' - sign, pressed or pressed button. </li></ul><br>  The status fields are also not inherited from the parent elements and can change on their own as a result of actions on the control (for example, the state of the 'selected' button changes as a result of calling the button.select () method). <br><br><h4>  Example 1. Layout generation based on data, options, and control state </h4><br>  Most often, layouts are created using the special <a href="">templateLayoutFactory</a> factory.  The factory allows you to set a text template with which the dom-representation of the element will be formed later. <br><br>  Consider an example of creating your own layout for control.Button.  What we want to get from the created layout: <br>  1. There should be some inscription in the button; <br>  2. The button has 2 states - when it is pressed and when it is not pressed. <br><br>  The caption is the value of one of the button data fields.  The standard button implementation uses the 'content' field: <br><br><pre> <code class="javascript hljs">myButton.data.get(<span class="hljs-string"><span class="hljs-string">'content'</span></span>);</code> </pre><br>  Nothing prevents us from using another arbitrary data field, if necessary.  For example: <br><br><pre> <code class="javascript hljs">myButton.data.set(<span class="hljs-string"><span class="hljs-string">'caption'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>);</code> </pre><br>  In this case, we will manage with a standard data field. <br>  In our example, the dom representation of the button will be a div element: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'my-button'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  So, it is necessary that the field from the control data is substituted instead of the phrase "Button header".  Creating a button layout will look like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ButtonLayout = ymaps.templateLayoutFactory.createClass(<span class="hljs-string"><span class="hljs-string">"&lt;div class='my-button'&gt; $[data.content] &lt;/div&gt;"</span></span>);</code> </pre><br>  Instead of the text 'Button Title' we inserted the template '$ [data.content]'. <br><br>  The layout factory can handle data, option, or state managers.  Therefore, we refer to the 'content' field through a dot - the factory will be able to independently determine that data is the data manager, and perform the data.get ('content') operation. <br><br>  Now if we change the value of this field through the data manager, our layout will be automatically rebuilt. <br><br>  We coped with the first item.  Go to step two. <br><br>  In its normal state, the button looks like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'my-button'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  When pressed, it looks like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'my-button my-button-selected'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  That is, a special class is added to the div element that changes the appearance of the button. <br>  Modify our text template: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ButtonLayout = ymaps.templateLayoutFactory.createClass(<span class="hljs-string"><span class="hljs-string">"&lt;div class='my-button [if state.selected]my-button-selected[endif]'&gt;$[data.content]&lt;/div&gt;"</span></span>);</code> </pre><br>  So, based on the data and the state of the button, we were able to create its layout.  The button layout automatically responds to clicks and translates them into a control.  So no additional logic is required in this example. <br>  <a href="http://api.yandex.ru/maps/jsbox/button_layout">See an example</a> <br><br><h4>  Example 2. Layout that interacts with the control. </h4><br>  Let us consider a more complicated example - the creation of a control element for the map scaling factor, in other words, a 'zoom control'. <br><br>  The html template of our control looks like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'zoom-in'</span></span></span><span class="hljs-tag">&gt;</span></span>+<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'zoom-out'</span></span></span><span class="hljs-tag">&gt;</span></span>-<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  We want to get the following from the created layout: when clicking on an element with a plus or minus, you need to increase or decrease the zoom of the card by 1. <br><br>  The documentation says that the layout control.SmallZoomControl implements the <a href="">IZoomControlLayout</a> interface.  We read the description of the interface and find the description of the 'zoomchange' event: <br><br>  <b>Zoomchange</b> - the event that initiates the change of the scale factor of the map. <br><br>  An instance of the Event class.  The names of the fields available through the Event.get method: <br>  ‚Ä¢ newZoom - the new value of the zoom factor; <br>  ‚Ä¢ oldZoom - the old value of the zoom factor. <br><br>  This means the following - when the layout sends a 'zoomchange' event, the control catches it and responds accordingly (that is, changes the zoom ratio of the map). <br><br>  It is necessary that after the formation of the html layout on certain elements of the listeners were hung.  In particular, you need to listen to the 'click' event on the elements with id = 'zoom-in' and id = 'zoom-out'.  In the click handlers, we will generate a 'zoomchange' event, into the fields of which the old and new map scaling factors will be transmitted. <br><br>  Creating a layout for the zoom control will look like this: <br><br><pre> <code class="hljs lua">//     . var MyZoomLayout = ymaps.templateLayoutFactory.createClass(<span class="hljs-string"><span class="hljs-string">"&lt;div&gt;"</span></span> + <span class="hljs-string"><span class="hljs-string">"&lt;div id='zoom-in'&gt;+&lt;/div&gt;"</span></span> + <span class="hljs-string"><span class="hljs-string">"&lt;div id='zoom-out'&gt;-&lt;/div&gt;"</span></span> + <span class="hljs-string"><span class="hljs-string">"&lt;/div&gt;"</span></span>, { //   ,     //     . build: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { //    build. MyZoomLayout.superclass.build.call(this); //      . $(<span class="hljs-string"><span class="hljs-string">'#zoom-in'</span></span>).bind(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, ymaps.util.bind(this.zoomIn, this)); $(<span class="hljs-string"><span class="hljs-string">'#zoom-out'</span></span>).bind(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, ymaps.util.bind(this.zoomOut, this)); }, clear: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { //   . $(<span class="hljs-string"><span class="hljs-string">'#zoom-in'</span></span>).unbind(<span class="hljs-string"><span class="hljs-string">'click'</span></span>); $(<span class="hljs-string"><span class="hljs-string">'#zoom-out'</span></span>).unbind(<span class="hljs-string"><span class="hljs-string">'click'</span></span>); //    clear. MyZoomLayout.superclass.clear.call(this); }, zoomIn: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { var map = this.getData().control.getMap(); //  ,     //      . this.events.fire(<span class="hljs-string"><span class="hljs-string">'zoomchange'</span></span>, { oldZoom: map.getZoom(), newZoom: map.getZoom() + <span class="hljs-number"><span class="hljs-number">1</span></span> }); }, zoomOut: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { var map = this.getData().control.getMap(); this.events.fire(<span class="hljs-string"><span class="hljs-string">'zoomchange'</span></span>, { oldZoom: map.getZoom(), newZoom: map.getZoom() - <span class="hljs-number"><span class="hljs-number">1</span></span> }); } });</code> </pre><br>  <a href="http://api.yandex.ru/maps/jsbox/small_zoom_layout">See an example</a> <br><br>  Using the example of control.SmallZoomControl, we looked at how the control and its layout interact.  Summarize the knowledge gained in the scheme: <br><img src="https://habrastorage.org/getpro/habr/post_images/56d/a9d/968/56da9d96830ef51b38456b8bc39323d2.jpg" width="800" height="600"><br>  The control layout is based on the 'state', 'data' or 'options' fields and monitors their changes.  When changing field values, the layout is rebuilt. <br><br>  The layout, in turn, can change the state of the control using events that are specified in its interface.  The control listens to the specified set of events and performs (or does not perform) the corresponding actions. <br><br><h4>  Example 3. Creating a group control layout </h4><br>  A group control is different in that you can add child elements to it.  The layout of the group element, therefore, must have an html-element that will be the root for the html-layout of the child elements. <br><br>  Create a layout for the drop-down list. <br><br>  The html layout of the open list looks like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'my-listbox-header'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'my-listbox'</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Let's write out what we want to get from the finished layout: <br>  1. It is necessary that the title of the list be substituted into the layout; <br>  2. It is necessary that the child elements of the list are automatically added to the specified dom-element of the parent; <br>  3. Our list should be able to fold and unfold; <br>  4. It is necessary to somehow define the appearance of the elements of the list. <br><br>  We will substitute the list header into the layout by analogy with the example of the button layout: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> MyListBoxLayout = ymaps.templateLayoutFactory.createClass( <span class="hljs-string"><span class="hljs-string">"&lt;div id='my-listbox-header'&gt;$[data.title]&lt;/div&gt;‚Äù + ‚Äú&lt;div id='my-listbox'&gt;&lt;/div&gt;"</span></span> );</code> </pre><br>  We now turn to the second paragraph. <br><br>  The parent dom element in our drop-down list is the &lt;div id = 'my-listbox'&gt; element. <br>  The layout of a group control must implement the <a href="">IGroupControlLayout</a> interface.  The peculiarity of this interface is the presence of the getChildContainerElement method.  Through this method, the control gets the dom-element to which it needs to attach the html-layouts of the child elements. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> MyListBoxLayout = ymaps.templateLayoutFactory.createClass( <span class="hljs-string"><span class="hljs-string">"&lt;div id='my-listbox-header'&gt;$[data.title]&lt;/div&gt;‚Äù + ‚Äú&lt;div id='my-listbox' &gt;&lt;/div&gt;"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">build</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ MyListBoxLayout.superclass.build.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.childContainerElement = $(<span class="hljs-string"><span class="hljs-string">'#my-list-box'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; }, <span class="hljs-attr"><span class="hljs-attr">getChildContainerElement</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.childContainerElement; } });</code> </pre><br>  When building the layout, the necessary dom element will be found, and the group control can add the child elements to the parent. <br><br>  Since our layout contains the substitution of '$ [data.title]', it can be rearranged.  As soon as this field is changed, the layout will call a couple of clear and build methods to update its html mapping.  In this case, the dom element that serves as a container for the child elements will change (yes, it will be exactly the same as the previous one, but it will physically be another dom element). <br><br>  The control does not monitor layout changes and does not recognize that the child container has changed.  Therefore, we need to independently notify him about it. <br><br>  Every time we rebuild, we will generate an IGroupControlLayout 'childcontainerchange' interface event. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> MyListBoxLayout = ymaps.templateLayoutFactory.createClass( <span class="hljs-string"><span class="hljs-string">"&lt;div id='my-listbox-header'&gt;$[data.title]&lt;/div&gt;‚Äù + ‚Äú&lt;div id='my-listbox'&gt;&lt;/div&gt;"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">build</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ MyListBoxLayout.superclass.build.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.childContainerElement = $(<span class="hljs-string"><span class="hljs-string">'#my-list-box'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//   ,    //     . this.events.fire('childcontainerchange', { newChildContainerElement: this.childContainerElement, oldChildContainerElement: null }); }, clear: function () { //       //     . //      , //    dom-    ie. this.events.fire('childcontainerchange', { newChildContainerElement: null, oldChildContainerElement: this.childContainerElement }); this.childContainerChange = null; MyListBoxLayout.superclass.clear.call(this); }, getChildContainerElement: function () { return this.childContainerElement; } });</span></span></code> </pre><br>  Now when the layout is rebuilt, the control will be aware of the container change and transfer the child elements to the new dom element. <br><br>  We need to make sure that our list knows how to fold and unfold. <br><br>  The appearance of the control in a collapsed state: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'my-listbox-header'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  The appearance of the control in the expanded state: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'my-listbox-header'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'my-listbox'</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  It turns out that in this example (depending on the state of the control) you need to show or hide the container with its child elements. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> MyListBoxLayout = ymaps.templateLayoutFactory.createClass( <span class="hljs-string"><span class="hljs-string">"&lt;div id='my-listbox-header'&gt;$[data.title]&lt;/div&gt;‚Äù + ‚Äú&lt;div id='my-listbox' style='display: [if state.expanded]block[else] none[endif];'&gt;&lt;/div&gt;"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">build</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ MyListBoxLayout.superclass.build.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.childContainerElement = $(<span class="hljs-string"><span class="hljs-string">'#my-list-box'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//   ,    //     . this.events.fire('childcontainerchange', { newChildContainerElement: this.childContainerElement, oldChildContainerElement: null }); }, clear: function () { //       //     . //      , //    dom-    ie. this.events.fire('childcontainerchange', { newChildContainerElement: null, oldChildContainerElement: this.childContainerElement }); this.childContainerChange = null; MyListBoxLayout.superclass.clear.call(this); }, getChildContainerElement: function () { return this.childContainerElement; } });</span></span></code> </pre><br>  We set up a layout that responds to changes in the state of the control.  Now you need to set up feedback - depending on the actions of the user, send to the control the ‚Äúroll up‚Äù or ‚Äúroll up‚Äù commands.  Fortunately, control.ListBox is minimized or maximized by click on the layout by default.  So in this example, no additional actions are required for this.  If we were not satisfied with the default behavior, we could send commands to the control through the layout ourselves, as we did with the control.SmallZoomControl. <br><br>  It remains to create a layout for the elements of the drop-down list.  This is done quite simply. <br><br><pre> <code class="javascript hljs">ymaps.templateLayoutFactory.createClass(<span class="hljs-string"><span class="hljs-string">"$[data.content]&lt;br/&gt;"</span></span>);</code> </pre><br>  <a href="http://api.yandex.ru/maps/jsbox/list_box_layout">See an example</a> <br><br><h4>  Another example implementation of custom layouts </h4><br><br><img src="http://img-fotki.yandex.ru/get/5708/106815847.6/0_9cb98_e6af5ca8_L.jpg" width="500" height="279"><br><br>  To demonstrate the capabilities of the layouts, we selected the six most popular map controls in the API (Button, Drop-down List, Map Search, Simple Map Zoom Control, Traffic Control Panel, and Map Type Switch) and redesigned them using the popular css framework Twitter Bootstrap. <br><br>  <a href="http://ymapsapi.narod.ru/examples/controls/">See an example</a> <br><br>  <a href="https://github.com/dimik/ymaps/tree/master/controls">Githaba code</a> </div><p>Source: <a href="https://habr.com/ru/post/161763/">https://habr.com/ru/post/161763/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../161743/index.html">Meeting FProg 2012-12 in St. Petersburg</a></li>
<li><a href="../161747/index.html">Forwarding NVIDIA Quadro 4000 to a virtual machine using the Xen hypervisor</a></li>
<li><a href="../161755/index.html">Create a complex maze in the background of the web page (on the client)</a></li>
<li><a href="../161757/index.html">What is appropriate to pay attention to in the report "2012 Internet Trends (Update)", leafing through it in its entirety</a></li>
<li><a href="../161761/index.html">Price reduction for Windows Azure Storage</a></li>
<li><a href="../161767/index.html">Introduction to Vector Displays</a></li>
<li><a href="../161771/index.html">Peter Westerback in Skolkovo</a></li>
<li><a href="../161773/index.html">‚ÄúSimple Business‚Äù received new perpetual licenses from the FSB and FSTEC</a></li>
<li><a href="../161775/index.html">Making OpenGL ES LiveWallpaper on Linderdaum Engine for Android</a></li>
<li><a href="../161779/index.html">Curved LCDs can be used as screens in contact lenses.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>