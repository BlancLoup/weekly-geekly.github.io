<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Roaming Technology assessment</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are always many questions about how the calculation of the cost of communication services in roaming. There are few roaming specialists, and as ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Roaming Technology assessment</h1><div class="post__text post__text-html js-mediator-article">  There are always many questions about how the calculation of the cost of communication services in roaming.  There are few roaming specialists, and as a rule they are not in the mood for writing articles.  I will try to briefly describe the possible options, technologies and identify problems. <br><br><h5>  Classification and definitions. </h5><br>  From the operator‚Äôs point of view, roaming is of two types: <br><ol><li>  Entry (inbound).  In the case of entry roaming, an invoice is issued to the operator whose subscribers come to the network. </li><li>  Outbound  And in this case, the operator bills its subscribers, and receives the bill itself from the operator, in whose network the subscribers are registered. </li></ol><br><br>  Operators exchange among themselves so-called.  TAP files, which indicate what services and to what extent the subscriber used.  On the basis of these records, the operators each month conduct mutual settlements among themselves. <br>  With the subscriber more difficult, there is a whole set of technologies and methods. <br>  Basically they are divided into two: <br><ol><li>  Post paid </li><li>  Prepaid </li></ol><br>  About them in his <a href="http://habrahabr.ru/company/beeline/blog/162175/">post</a> told <a href="http://habrahabr.ru/users/ansaril3/" class="user_link">ansaril3</a> (and actually provoked the spelling), so I will not repeat.  I will say that there are all sorts of combinations, but they are already ‚Äúfrom the evil one‚Äù and it is necessary to take a closer look at the product specialist who invents complex services. <br><a name="habracut"></a><br>  What services can be provided to the subscriber in roaming: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Vote; </li><li>  Data transfer; </li><li>  Short messages; </li><li>  USSD; </li></ul><br>  (* in fact, there are more of them, but I will not bury myself in TSxx and others, maybe later) <br><br>  With postpay, everything seems to be clear: <br><ol><li>  Subscriber used the service; </li><li>  The CDR operator chose guest records and generated a TAP file; </li><li>  The home operator received a TAP file, made an estimate, paid for the partner‚Äôs services, withdrew money from the subscriber and happily put the income into his account. </li></ol><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3a/3f9/fcd/d3a3f9fcdce8b1318aabcc268ce7a32c.png"><br><br>  In reality, everything is somewhat more complicated. <br>  Modern man is a creature often flying, because he wants his roaming to work wherever possible, in all countries of the world.  And this is more than two hundred operators, each operator must send each file, on time, correctly, through secure channels.  The amount of work would have been simply awesome.  But the market is flexible, and companies called clearing-house have entered it (there are several of them, I will not name them, they are excellently searched on the net).  They are a kind of hubs for data transfer between operators.  Now the networker and the billing system do not need to send files to each operator partner (and receive), but simply need to set up work with one organization. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/88f/236/c19/88f236c196f43f68a20c50b41b8ed669.png"><br><br>  Hurray, it works!  Yes, there is a delay, but what to do, the file interface, a bunch of checks on each side, the human factor, the data may be delayed.  And here the problem begins, and it is called billshock. <br><br>  The user leaves in roaming, carelessly uses the services (or a fashionable smartphone decides to download the update without the knowledge of the owner).  He comes home and gets a bill to pay for which he needs to sell an apartment or a car.  Pechalka. <br>  The user has no money.  Of course, the operator will have nerves, but if there is no money, then where will they get it, and under the pressure of public opinion and in order to save its reputation, debt will be written off.  But nobody canceled the contract with the operators, the subscriber used the service, therefore there should be a mutual settlement, and the home operator loses money, reputation, not to mention the subscriber's adventures. <br><br>  This situation does not suit anyone.  What could be the solution? <br>  The introduction of a fully prepaid method of payment seems the most logical, but it was not there. <br>  A huge part of the profits from roaming give corporate customers.  They can not be planted prepaid.  Why?  Yes, for a number of reasons, of course some are possible, but most are impossible. <br>  Partner operators in all exotic countries for us, to put it mildly, may not be very competent, they may not have the right technologies for organizing the preppeed ‚Äúaccording to recommendations‚Äù ... And the subscriber wants to talk, and the operator reduces his risks. <br><br>  And the most interesting begins, the introduction of technologies that will not allow the subscriber to speak all his property: <br><br><h5>  NRTRDE (Near Realtime Roaming Data Exchange) </h5><br>  The technology is designed to mitigate the possible billshock.  What is the essence, TAP file is a slow piece, and may come next month, on its basis the subscriber is billed.  An NR file should arrive at least every 4 hours (in general, more often, and for normal operators, monitoring raises panic if such files cease to arrive), and a special system analyzes the cost of services, the subscriber's account, the credit limit and does not allow to leave at the peak. <br><br>  Yes, in 4 hours you can download a series of Interns, but not all seasons.  To some extent, this protects both the subscriber and the operator from evil partners who set prices for roaming data from the ceiling (yes, I believe that prices for data transfer are taken from the ceiling, I do not see a clear justification for these prices for interconnect, respectively subscriber). <br><br>  Pros: simply, GSMA made the procedure of exchanging NR files mandatory, works for all types of services, and the receiving side of the subscriber is stimulated to send NR files, because  if there was no file, but there is a huge bill, then no one will pay to such an operator, clearing-house organizes the delivery of files between operators, it is not necessary to create entities. <br><br>  Cons: file interface and all its inherent problems. <br><br>  The technology is described in the recommendation of GSMA TD.35, unfortunately I can not lay it out, but you can search the network. <br><br><h5>  CAMEL roaming </h5><br>  As the name implies, the assessment of roaming services is assigned to the CAMEL protocol.  Only here CAMELs are different, and in particular they are divided into phases from 1st to 4th.  Each phase adds something new, interesting and expensive.  Yes, equipment manufacturers license each phase separately, and if almost everyone has CAP2 (CAMEL Application Part phase 2), most, but not everyone has CAP3, almost no one has CAP4 (it is expensive, but DIAMETER is more functional, but below).  I will not give a complete comparison, the table is large with a bunch of smart abbreviations, I will not decipher them all from memory. <br><ol><li>  CAP1 is the very first implementation.  Now not used separately </li><li>  CAP2 - Allows you to conduct a voice assessment. </li><li>  CAP3 - Outgoing SMS (outgoing only) and data services are added to the voice. </li><li>  CAP4 - Full control of SMS and many more, but I will not consider here </li></ol><br><br>  As I said above, almost everyone has CAP2, and not all have CAP3, and if everything is more or less with voice, then SMS evaluation has to implement one of three options, even if there is CAP3 on the equipment in the home network. <br><ol><li>  Wrap all SMS traffic on the Prepaid platform and let it work as a proxy.  The solution is efficient, simple enough, but the minuses are clear to everyone: one more point of failure, an extra load; </li><li>  Implement a non-standard protocol between the SMSC and Prepaid, there are many of them, especially this popular phenomenon in the mono-vendor network, manufacturers love to add to their protocols, and moreover, everything.  Apparently remained in the form of atavism, because  DIAMETER stabilized a few years ago. </li><li>  Screw to SMSC DIAMETER.  The solution is good for everyone, except that upgrading old SMSCs often costs an astronomical sum.  Vendors are not fools, they know that the operator will buy sooner or later. </li></ol><br><br>  Evaluation of data in CAP3 / 4 is in its infancy, content evaluation is not supported, it is good for roaming, but if there is DIAMETER, then why produce entities. <br><br><h5>  Call-back. </h5><br>  So it is the tariff policy that an incoming call in roaming is cheaper than outgoing, and USSD with a serial number &lt;149 should always get on your home HLR, for free.  From all this, the following scheme of work was born. <br>  Subscriber A, instead of the usual dialing of subscriber B (+ 7xxxyyyzzww), dials the ussd command (* abc * 7xxxyyyzzww #), which in any case falls into the home HLR.  Next comes the descendant of the IVR and makes 2 outgoing calls, first to subscriber B, and B the robot offers to hang on the line, then A, and turn on both channels.  A sort of conference initiated by the outgoing IVR.  For A, the call is priced lower than normal outgoing, B simply receives an incoming call.  Everyone is happy with the exception of the host. <br><br><img src="http://habrastorage.org/storage2/670/120/c1f/670120c1fa78f06148b058ac4fe53411.png"><br><br>  The assessment method is absolutely standard.  There is a minus, some operators (in particular, some Arab ones) did not care about the rules of USSD delivery, and do not deliver these messages to the home network, radishes. <br><br><h5>  Diameter and OCS. </h5><br>  The DIAMETER protocol is a logical development of RADIUS, if it is interesting, then I can talk about them separately.  It was originally described by the <a href="http://tools.ietf.org/html/rfc3588">RFC 3588 Diameter Base Protocol</a> , later developed under the <a href="http://tools.ietf.org/html/rfc4006">RFC 4006 Diameter Credit Credit Control Application</a> , and the 3GPP committee developed and described its use in several recommendations, for example, <a href="http://www.3gpp.org/ftp/Specs/html-info/32299.htm">3gpp 32.299</a> . <br><br>  Excellent protocol, logically built, simply expanding, devoid of childhood diseases RADIUS.  But there is one thing, given that there are a lot of DIAMETER recommendations, 3gpp has released many versions of specifications, and each equipment manufacturer is free to add its own structures to it.  As a result, when using equipment from different vendors, there is a chance to get hardware with DIAMETER, but they will be incompatible.  Now the situation is getting better, but even a couple of years ago, integration could give unpleasant surprises.  This is especially noticeable on large networks.  This fully affects the SMS rating. <br><br><h5>  Total </h5><br>  I will try to summarize.  It is not possible to describe the entire assessment of roaming services in one article, but nonetheless: <br><ul><li>  Technically, there are all the means to correctly assess roaming; </li><li>  Operators not less subscribers should be interested in a normal assessment; </li><li>  Correct evaluation of the services of adequate operators is hindered by partner operators who, for one reason or another, have not implemented functionality for online evaluation. </li></ul><br><br>  In the next article (if I don‚Äôt split up) I will try to tell about the use of DIAMETER and RADIUS. </div><p>Source: <a href="https://habr.com/ru/post/162269/">https://habr.com/ru/post/162269/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../162255/index.html">Songo: Desktop-ny player Vkontakte</a></li>
<li><a href="../162259/index.html">Corona Malware Chips</a></li>
<li><a href="../162261/index.html">Closure Platform. Crutches for Google Closure Library</a></li>
<li><a href="../162265/index.html">I give the idea: about work management and restricting access to the Internet</a></li>
<li><a href="../162267/index.html">Once again about copyright, or freedom in everything</a></li>
<li><a href="../162271/index.html">The new Wordpress 3.5 "Alvin" saw the light</a></li>
<li><a href="../162277/index.html">Part 2. How to install Oracle Database 11g Release 2 RAC on Linux using VirtualBox - raising a cluster</a></li>
<li><a href="../162279/index.html">And your phone will begin to understand the touch in gloves</a></li>
<li><a href="../162283/index.html">A selection of tools for front-end development</a></li>
<li><a href="../162285/index.html">Arduino Esplora</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>