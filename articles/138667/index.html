<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Stack programming languages</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Functional programming is back in fashion. Depending on whether you prefer classics or hardcore, suffer from imposed industrial standards, or you are ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Stack programming languages</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/409/6cf/c09/4096cfc09f7f94e6d5d49a8c3a64cf51.png" alt="concatenative"><br>  Functional programming is back in fashion.  Depending on whether you prefer classics or hardcore, suffer from imposed industrial standards, or you are just a hipster, your favorite preference may be Scala, Haskell, F # or even good old Lisp.  Such combinations of words as a function of a higher order, the absence of side effects, and even monads, caress the ears of all ‚Äúweak young minds,‚Äù whether they are from JetBrains or a student who first saw SICP. <br><br>  But there is another programming, in the literal sense, even more functional, basically having more likely not a lambda calculus, but a composition of functions.  And I want to tell a little about him. <br><a name="habracut"></a><br><h2>  What is concatenative programming? </h2><br><br>  Concatenation is a concatenation of several lines.  A language in which the usual combination of two code fragments turns out to be their composition is called concatenative <sup>[1]</sup> .  Each of these pieces of code is a function that takes a stack as an argument and returns the stack as its result.  Therefore, more often such languages ‚Äã‚Äãare called stack-based. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Stack languages ‚Äã‚Äãare alive and exist.  Due to the speed and lightness of translators, they are used in the real world.  JVM, the most common virtual machine in the world;  CPython, another stack virtual machine [2], which is used in many high-load projects, such as Youtube and BitTorrent;  in the PostScript language, used now in high-performance top-end printers, finally, the good old Forth, which is still found for programming microcontrollers and embedded systems.  All of them are wonderful in their own way, but it is worth noting that although the general principles are similar, but by and large the discussion will deal with languages ‚Äã‚Äãof a higher level, such as F√§tor, Joy or Cat. <br><br><h2>  Functions </h2><br><br>  In concatenative languages, everything is a function, but for comparison with other languages, let's look at an example of the squaring function with a definition.  Unshakable imperative <strong>From</strong> : <br><br><pre><code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">square</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x * x; }</code> </pre> <br>  Functional <strong>Scheme</strong> : <br><br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">define</span></span> square (<span class="hljs-name"><span class="hljs-name">lambda</span></span> (<span class="hljs-name"><span class="hljs-name">x</span></span>) (<span class="hljs-name"><span class="hljs-name">*</span></span> xx)))</code> </pre><br>  Concatenative <strong>Joy</strong> : <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">DEFINE</span></span> square == dup * .</code> </pre><br><br>  Concatenative <strong>Factor</strong> : <br><pre> <code class="hljs pgsql">: square ( x <span class="hljs-comment"><span class="hljs-comment">-- y ) dup *;</span></span></code> </pre><br><br>  Concatenative <strong>Cat</strong> : <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">define</span></span> square { <span class="hljs-attribute"><span class="hljs-attribute">dup</span></span> * }</code> </pre><br><br>  Here <strong>dup</strong> creates a copy of the argument at the top of the stack, and puts this copy there too. <br>  * - this is the usual multiplication function. <pre> <code class="hljs objectivec">*:: (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) ‚Üí (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) ‚Üí (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)</code> </pre>  which ‚Äúexpects‚Äù two arguments on the stack;  in this case, the two most recent ones on the stack are a copy of the same number.  If now we want to use this function, it will be enough for us to write <em>3 square</em> , where 3 is also a function with a signature <pre> <code class="hljs objectivec"><span class="hljs-number"><span class="hljs-number">3</span></span>::() ‚Üí (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)</code> </pre>  i.e.  returning herself.  In fact, it is more correct to say that this is a type with row polymorphism and it returns the entire current stack. [5] <br><br>  In concatenative languages, they are not used (more precisely, it is not recommended, but if you really want, you can) variables and lambdas, and this fact makes it rather concise.  Instead of an applicative approach, here is a composition written in postfix (reverse Polish) notation, which corresponds to the sequence of data with which we work on the stack, which means that in some way it makes it easier to read the stack code.  Let's look at two examples.  The first is the usual Hello world, which looks somewhat unusual in this notation: <br><br><pre> <code class="hljs swift"><span class="hljs-string"><span class="hljs-string">"Hello world"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span></code> </pre> <br><br>  We put the string ‚ÄúHello World‚Äù on the stack, and then use the print function to retrieve an element from the top of the stack and display it on the screen. <br><br><pre> <code class="hljs perl"><span class="hljs-number"><span class="hljs-number">10</span></span> [ <span class="hljs-string"><span class="hljs-string">"Hello, "</span></span> <span class="hljs-string"><span class="hljs-string">"Factor"</span></span> append <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> ] <span class="hljs-keyword"><span class="hljs-keyword">times</span></span></code> </pre><br><br>  It uses operations on quotations, which will be discussed a little later, but it‚Äôs pretty obvious that 10 and a quotation are put on the stack, and times the code from the quotation is executed a specified number of times.  The code inside the quote just sequentially pushes two lines onto the stack, then connects them and displays them on the screen. <br><br>  You can try a small concatenative language directly in your browser at <a href="http://trybrief.com/">trybrief.com</a> .  As it is easy to notice, the interpreter is written in javascript and is quite simple, you can look at it at ./Engine.js.  Cat, whose interpreter was originally implemented in C #, and now in so many other languages, also has an <a href="http://www.cat-language.com/interpreter.html">online js interpreter</a> . <br><br><h2>  Quotes and combinators. </h2><br><br>  The ability to take pieces of code in quotes ([]), makes it possible to write your own control structures.  Quotes are functions that return the contents of a quoted expression.  The citation function in this case will be of the following type. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">quote</span></span> :: (T) ‚Üí (() ‚Üí T).</code> </pre> <br><br>  For example, the entry [5] in square brackets will return not the number 5 of the integer type itself, but its quotation.  It is clearer when it comes to expressions, for example [5 6 +].  Without quoting, the number 11 will be calculated and put on the stack, while quoting will put the expression 5 6 + on the stack, with which you can interact in many different ways. <br>  Combinators are functions that expect one or more quotes from the stack and apply them in a special way to the rest of the stack. <br><br>  Essentially, quotes are regular listings.  They can be combined with other quotes, perform various manipulations on the stack, and then apply them using different combinators.  For example, the combinator fold collapses a list into a value, an example that summarizes the elements of a list (Joy): <br><br><pre> <code class="hljs css"><span class="hljs-selector-attr"><span class="hljs-selector-attr">[2 5 3]</span></span> 0 <span class="hljs-selector-attr"><span class="hljs-selector-attr">[+]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">fold</span></span></code> </pre><br><br>  Quick sort with recursive binrec in Joy combinator: <br><br><pre> <code class="hljs swift"><span class="hljs-type"><span class="hljs-type">DEFINE</span></span> qsort == [small] [] [uncons [&gt;] <span class="hljs-built_in"><span class="hljs-built_in">split</span></span>] [[<span class="hljs-built_in"><span class="hljs-built_in">swap</span></span>] dip cons concat] binrec .</code> </pre> <br><br>  Nothing prevents the implementation of monads <a href="http://gitweb.factorcode.org/gitweb.cgi%3Fp%3Dfactor%3Ba%3Dblob%3Bf%3Dextra/monads/monads.factor%3Bhb%3DHEAD">as in Factor</a> and yes, Fator, for example, knows how to optimize tail recursion. <br><br><h2>  Control structures. </h2><br><br>  Thanks to citations and combinators, you can use current or create your own control structures.  Example for if (Factor): <br><br><pre> <code class="hljs objectivec">= [ <span class="hljs-number"><span class="hljs-number">23</span></span> ] [ <span class="hljs-number"><span class="hljs-number">17</span></span> ] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span></code> </pre><br><br>  To understand how this works, I recommend refreshing knowledge on the <a href="http://en.wikipedia.org/wiki/Lambda_calculus">definition of Boolean functions</a> in lambda calculus.  A slightly more complex example on Factor: <br><br><pre> <code class="hljs mel">: <span class="hljs-keyword"><span class="hljs-keyword">sign</span></span>-test ( n -- ) dup <span class="hljs-number"><span class="hljs-number">0</span></span> &lt; [ drop <span class="hljs-string"><span class="hljs-string">""</span></span> ] [ zero? [ <span class="hljs-string"><span class="hljs-string">""</span></span> ] [ <span class="hljs-string"><span class="hljs-string">""</span></span> ] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> ;</code> </pre><br><br>  The function determines the sign of the number.  If operates on two quotes, highlighted by square brackets and placed on the stack higher than the expression dup 0 &lt;.  If the number at the top of the stack when calling sign-test (ie, the function argument) is less than zero, the first quote is used, which pushes ‚Äúnegative‚Äù onto the stack (throwing out the test number that was copied).  In case the number is more, the second quotation is fulfilled, inside containing one more condition.  After that, the stack contains a string denoting the sign of a number, this string is output by the print function. <br><br><h2>  Benefits: </h2><br><br>  <strong>Speed ‚Äã‚Äãand optimizability</strong> . <br><br><pre> <code class="hljs css"> <span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:A</span></span> 1 2 + <span class="hljs-selector-tag"><span class="hljs-selector-tag">print</span></span> <span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:add2</span></span> 2 + ; <span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:B</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add2</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">print</span></span></code> </pre><br><br>  In this case, A = B due to the associativity of the composition.  The program in concatenative language is divided into pieces that are assembled after compilation.  In fact, this is a regular <strong>map-reduce</strong> , fast and allows you to compile each piece of code in parallel. <br>  <strong>Refactoring</strong> .  If you see two identical parts of the code, put them into a separate function.  Use combinators, quoting and own control structures.  Examples of Cat language optimizations: <br><br><pre> <code class="hljs swift">f <span class="hljs-built_in"><span class="hljs-built_in">map</span></span> g <span class="hljs-built_in"><span class="hljs-built_in">map</span></span> =&gt; [fg] <span class="hljs-built_in"><span class="hljs-built_in">map</span></span> [f] <span class="hljs-built_in"><span class="hljs-built_in">map</span></span> x [g] fold =&gt; x [[f' f] g] fold [f] <span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> x [g] fold =&gt; x [f [g] [pop] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>] fold [f] <span class="hljs-built_in"><span class="hljs-built_in">map</span></span> [g] <span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> x [h] fold =&gt; x [fg [h] [pop] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>] fold</code> </pre><br><br><h2>  Difficulties </h2><br><br>  All the flaws of stack languages ‚Äã‚Äãobviously originate from their features.  This is a composition instead of an application, this is pointless notation, this is the absence of variables and the difficulty of writing some expressions.  Provide a simple expression in the concatenative language <em>'abc d'</em> .  If the function c takes two arguments, then in the applicative form the expression will be written as <em>d (c (b, a))</em> , if <em>b</em> and <em>c</em> take one argument at a time, then <em>d (c (b (a)))</em> ;  if <em>d is a</em> function of two arguments, <em>b is</em> one, and <em>c is a</em> function that does not accept arguments, then the expression in the applicative form will be of the form <em>d (c, b (a))</em> .  You need to very carefully write code in a concatenated language, because you have to understand everything in it.  This is supported by strong typing in Cat, perceived support from the IDE, various methods and mechanisms that allow you to change your thinking.  But such a problem can overtake you in your favorite Haskell with its pointless notation of function compositions (in which there are just dots).  Writing in a postfix form without named variables for any complex algebraic expression is also not possible in the same way as we used to be from childhood.  This is the main problem of these languages ‚Äã‚Äã- that, like classical functional ones, they require a slightly different thinking from you.  In terms of production, and the story of Scala has not calmed down yet, the languages ‚Äã‚Äãfamiliar to everyone are required, because the whole thing rests on human resources. <br><br>  Each function in the concatenative language operates on a stack, and although it may be by itself without side effects, there are no assignments in it, variables, but it changes the stack, i.e.  global state, so the question of purity for many is not obvious.  However, for those high-level languages ‚Äã‚Äãin question, this is not entirely fair, because it is rather a matter of implementation.  And in order to be applicable in the real world, they also have variables for those rare occasions when they are needed (for example, SYMBOL: in Factor or function declarations to increase readability of the code), they can be quite pure in mathematical terms (like Joy <sup>[ 4]</sup> ) and, like many conceptual differences between approaches, paradigms and platforms, in the end be just a matter of taste.  Provided adequate selection of tools for the task.  That is why Forth is used in embedded systems, its translator is very easy to implement and it will be very small. <br><br>  I hope someone discovered something new.  Personally, I was inspired by the text ‚ÄúWhy concatenative programming is important‚Äù <sup>[5]</sup> and now for several days I can not tear myself away from this topic, and even being in a sleepy state I can say the word ‚Äúconcatenative‚Äù many times. <br><br>  1. <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D0%25BD%25D0%25BA%25D0%25B0%25D1%2582%25D0%25B5%25D0%25BD%25D0%25B0%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D1%258B%25D0%25B9_%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F">Wikipedia: Concatenative programming</a> <br><br>  2. <a href="http://doc.pypy.org/en/latest/interpreter.html">Pypy interpreter</a> <br><br>  3. <a href="http://docs.factorcode.org/content/article-cookbook-philosophy.html">http://docs.factorcode.org/content/article-cookbook-philosophy.html</a> <br><br>  4. <a href="http://archive.vector.org.uk/art10000360">Functional Programming in Joy and K</a> <br><br>  5. <a href="http://evincarofautumn.blogspot.com/2012/02/why-concatenative-programming-matters.html">Why Concatenative Programming Matters?</a> <br><br>  6. <a href="http://www.cs.cmu.edu/~neelk/rows.pdf">Objects and Aspects: Row Polymorphism</a> </div><p>Source: <a href="https://habr.com/ru/post/138667/">https://habr.com/ru/post/138667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138657/index.html">Jelastic + Luna = mini Github</a></li>
<li><a href="../138658/index.html">Performance shared_ptr and C ++ 11: why I don‚Äôt believe libraries</a></li>
<li><a href="../138660/index.html">Don't die please</a></li>
<li><a href="../138664/index.html">IP Multipathing on Solaris 10</a></li>
<li><a href="../138666/index.html">Fair DOCX generation in PHP. Part 1</a></li>
<li><a href="../138668/index.html">HTML5 canvas bilinear pixel distortion</a></li>
<li><a href="../138669/index.html">StoreBirds - New Design</a></li>
<li><a href="../138670/index.html">Wireless HD-video and sound transmission over Wi-Fi, digest - spring'12</a></li>
<li><a href="../138672/index.html">Canonical introduced Ubuntu for Android (UPD)</a></li>
<li><a href="../138673/index.html">Simple productivity methods for freelancer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>