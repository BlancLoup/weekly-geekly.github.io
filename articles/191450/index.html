<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The rise and fall of the novice phreaker</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I was going to write something for a long time on Habr, nurtured ideas of all articles on very smart topics. But instead, I will now describe one auto...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The rise and fall of the novice phreaker</h1><div class="post__text post__text-html js-mediator-article"> I was going to write something for a long time on Habr, nurtured ideas of all articles on very smart topics.  But instead, I will now describe one autobiographical episode, of which I am very proud technically, but of which I am extremely sorry for the moral. <br><br>  I will not hide names and details, because, firstly, it was a long time ago, and secondly, it completely logically ended itself and I don‚Äôt think that any of the participants in those events still treat them not as an instructive story from fighting youth.  In addition, the technical details have long been outdated and hardly anyone will come in handy (and, in fact, neither the source nor the finished products have survived, for the reasons described below). <br><a name="habracut"></a><br>  So, it was in 1997, when I was a second-year student at the St. Petersburg Shipwork (SPbSMTU).  I came to Petersburg at the age of 21 consciously from the Kaliningrad region, where I had lived all my life before that.  I already came up with a powerful IT background, because  fanatically engaged in programming from about 13 years old (so that you can imagine the scale of fanaticism - I wrote two games and a graphic editor for the <a href="http://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25B0_%25D0%259C%25D0%25A1_0511">UKSC</a> in octal machine codes, using only the <a href="">processor debugger</a> ). <br><br>  I studied in the same group with a man who was just as fanatically addicted to electronics, the absolute master of the soldering iron, Cyril.  Somehow it happened by itself that the point of joint application of our efforts was the reverse engineering of the payment system of St. Petersburg payphones.  Well, you know, parents are far away, you need to call, there is no money, but there is free time and two bad heads. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At that time, St. Petersburg was engaged in payphones (and is now engaged, but for obvious reasons, not very successfully) by <a href="http://www.spt.ru/">SPT</a> - St. Petersburg Payphones.  Quite modern by the standards of the devices were installed throughout the city.  I did not find the model number on the move, they looked like this (the picture was also found not of the highest quality): <br><br><img src="https://habrastorage.org/storage2/c82/aea/d27/c82aead2761be0b41e20d1908cf0fb4e.jpg" alt="image"><br><br>  These payphones were <a href="http://en.wikipedia.org/wiki/ISO/IEC_7816">received</a> chip cards of the <a href="http://en.wikipedia.org/wiki/ISO/IEC_7816">ISO-7816-2 standard</a> with a capacity from 25 to 1000 units (one unit - a minute of local conversation or a few seconds of intercity).  Having collected all the information on card types and protocols available at that time in FIDO and in the Internet in short supply, we set to work.  Pretty soon we collected a reader that connects to the computer‚Äôs LPT port.  A program has also been written that reads the contents of the maps.  The card is a small amount of memory, one part of which contains information about the remaining units and can be changed (only downwards), the second part contains service information: manufacturer, serial number, something else. <br><br>  Having accumulated a sufficient amount of knowledge about the exchange protocol of a payphone with a card and collecting a small collection of card dumps, we started to run the maximum program, that is, to create a card emulator that would behave like a regular card, but a range of units would be available to record any numbers .  The <a href="http://ww1.microchip.com/downloads/en/devicedoc/35007b.pdf">PIC16F84a</a> microcontroller was chosen as the brain of the emulator, its program was written in C in the Borland C 3.0 environment.  I was engaged in the software part, that is, I wrote a program for the microcontroller and utilities for the computer, Cyril was the master of the microcontroller and the monster of the soldering iron. <br><br>  The process of building and debugging the first version of the emulator was hell.  In the iron plan, the first version was very unpretentious and was a card with milled native brains, from which there was a harness sticking out, on which hung a board with a controller and strapping.  Of course, a square battery was bolted to the board with a blue one.  Moreover, due to the lack of complete information, we did a lot at random (the protocol timings had to be selected by trial and error), so also imagine the verification process of the next firmware assembly: ‚Äúwell, we changed the number 10 to 12 here, let's go for a couple of kilometers in the frost to the nearest payphone, we will wait until there are curious citizens around, plug the device into the payphone, see the message ‚ÄúError 8‚Äù for the hundredth time, quietly swear and go back. ‚Äù  Now imagine our joy when the emulator partially earned a hundred and first time and the payphone showed the long-awaited ‚Äú25 units‚Äù.  This stage took us about six months. <br><br>  After that, another half a year of improvement of the iron part followed, two intermediate versions of the emulator and countless firmware builds were made.  At that time, the final version of iron seemed to me to be the height of engineering: the magician Kirill was able to get rid of external power (I also had to radically optimize the firmware for this, because previous versions did not have time to start, power was supplied too shortly before the start of data exchange) and also DIP enclosures on SOIC.  As a result, the emulator looked exactly like a regular card, no beard of wires was sticking out of the payphone.  The case of the microcontroller was hiding in a small thickening, filled with epoxy, in the place where the payphone card reader had a recess for the fingers.  Unfortunately, there was nothing to photograph then, so the electronics masterpiece is lost for posterity. <br><br>  Each time you turn on the emulator behaved like a pristine blank card of the nominal that it placed in the firmware.  Here, for the first time, we encountered technical security measures incorporated into the program of payphones.  The measures were, I must say, very weak.  The dump card stitched into the emulator stopped working a couple of days after the start of use.  During these couple of days I managed to reset the card several times (is it worth saying that all the time, since I received the first fully working version of the emulator, I used it to call home).  I don‚Äôt know the exact details of the implementation, but it looked as though the center was analyzing traffic, entering the card number into a kind of blacklist, which was then sent to all payphones and stored locally there.  Moreover, the delay in two or three days hinted that this is done manually. <br><br>  The second measure of protection was that some code was stored in the non-rewritable part of the memory card, generated on the basis of the serial number and the original face value of the card (perhaps something else).  The algorithm for the formation of this code has remained a mystery to us.  This code did not allow us to achieve complete perfection and to generate fresh dumps on the fly in the microcontroller each time; we had to flash dumps from the actual used cards.  Then we hoped that by collecting a sufficient number of memory dumps of cards, we could calculate the hashing algorithm.  But, as I have already written, these hopes were not destined to come true. <br><br>  In search of donors, we accidentally met the ‚ÄúCollector‚Äù (the cards were of very different designs, there were constantly various series dedicated to holidays and events, so there were even people collecting used cards).  They just saw a guy at the tram stop with a pile of cards in their hands, they started talking, asked for a visit with the reader.  So we got about a hundred of fresh card dumps.  This also became the beginning of the end of the story, since the ‚ÄúCollector‚Äù turned out to be connected with the security service of the payphone company.  He introduced us to a certain citizen who was supposedly ready to buy a miracle device for a hundred dollars rather big for those crisis times for students.  We forgot about any conspiracy and, being flattered with easy money, met with the buyer, demonstrated to him the immaculate work of the emulator ... The technical part of this story ended with the phrase ‚Äúlet's go through the police‚Äù, after which a completely different, quite predictable story began, which I will tell very briefly without details. <br><br>  So, we were caught, the capture of the century was shown on St. Petersburg TV, the Internet still keeps a couple of <a href="http://www.comnews.ru/print%3Fnid%3D658">news about us</a> .  There was a trial, we received two years conditionally, which turned out to be enough to make me a purely positive IT person, which I advise everyone. </div><p>Source: <a href="https://habr.com/ru/post/191450/">https://habr.com/ru/post/191450/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../191440/index.html">Delegation</a></li>
<li><a href="../191442/index.html">Android - Live Wallpaper on OpenGL ES 2.0 with Simplified DOF Effect</a></li>
<li><a href="../191444/index.html">Acer Aspire R7 laptop video review</a></li>
<li><a href="../191446/index.html">Yandex.Disk client for Linux. Cantilevered</a></li>
<li><a href="../191448/index.html">Slightly anonymous</a></li>
<li><a href="../191452/index.html">Information and analytical system for monitoring and managing road safety</a></li>
<li><a href="../191454/index.html">Search for a substring. Knuth ‚Äì Morris-Pratt Algorithm</a></li>
<li><a href="../191456/index.html">The official position of the administration opensharing.org on the issue of blocking the resource Roskomnadzor</a></li>
<li><a href="../191458/index.html">Behind the scenes of EuroSTAR. Or a look at the organization of the conference by the program committee chairman Michael Bolton</a></li>
<li><a href="../191462/index.html">Getting administrative privileges in Microsoft SQL Server</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>