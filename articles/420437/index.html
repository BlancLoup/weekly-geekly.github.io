<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Practical familiarity with the package manager for Kubernetes - Helm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article is a logical continuation of our recent publication on the history of the package manager for Kubernetes - Helm . This time we will again ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Practical familiarity with the package manager for Kubernetes - Helm</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ff/1x/js/ff1xjsnvdlnfinirlwb-0p42tlo.png"><br><br>  The article is a logical continuation of our <a href="https://habr.com/company/flant/blog/417079/">recent publication</a> on the history of the package manager for Kubernetes - <a href="https://helm.sh/"><b>Helm</b></a> .  This time we will again address the issues of the structure and functioning of the current Helm ( <b>version 2.x</b> ), as well as the charts and repositories it manages, and then we move on to the practice of installing Helm into the Kubernetes cluster and using the charts. <a name="habracut"></a><br><br><h2>  Introduction </h2><br>  <b>Helm - a tool for managing charts.</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>The chart</b> describes the required data set for creating an application instance in the Kubernetes cluster.  It can have nested charts and be used both to describe full-fledged services consisting of many dependent resources, and to describe individual independent components.  For example, the <a href="https://github.com/helm/charts/tree/master/stable/gitlab-ce">stable / gitlab-ce</a> chart describes a comprehensive solution <a href="">using</a> independent redis and postgresql charts. <br><br>  The chart can be set an unlimited number of times in the same cluster.  Thus, the description of the application logic in different environments can and should be stored in one chart. <br><br>  The client part of Helm is responsible for the formation of the chart and the transfer, together with the user parameters, to the Tiller component located in the Kubernetes cluster.  In turn, Tiller is responsible for the life cycle of the instance of the launched chart, release.  <i>(Just in case, let me remind you that in the next major update of Helm - version 3 - Tiller will no longer be.)</i> <br><br>  And now - first things first. <br><br><h2>  Installation and Update </h2><br>  Kubernetes is required to work with Helm.  You can use a locally installed <a href="https://kubernetes.io/docs/setup/minikube/">Minikube</a> <i>(see also ‚Äú <a href="https://habr.com/company/flant/blog/333470/">Getting Started in Kubernetes using Minikube</a> ‚Äù)</i> or any other available cluster. <br><br>  Let's start with installing the client: choose the <a href="https://github.com/kubernetes/helm/releases">release</a> , download and unpack the archive for your system, transfer the executable file ... <br><br><pre><code class="bash hljs">$ curl https://storage.googleapis.com/kubernetes-helm/helm-v2.10.0-linux-amd64.tar.gz | tar -zxv $ sudo mv linux-amd64/helm /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin/helm</code> </pre> <br>  Next, install Tiller in the cluster.  By default, Tiller is installed in the <b><code>kubectl</code> context <code>kubectl</code></b> ( <code>kubectl config current-context</code> ), in the <b><code>kube-system</code> namespace</b> , but this can be changed using the appropriate options and environment variables ‚Äî they are described in the help ( <code>helm init --help</code> - help).  Perform the installation and look at the created resources in the cluster: <br><br><pre> <code class="bash hljs">$ helm init <span class="hljs-variable"><span class="hljs-variable">$HELM_HOME</span></span> has been configured at /home/habr/.helm. (Use --client-only to suppress this message, or --upgrade to upgrade Tiller to the current version.) Happy Helming! $ kubectl get all --selector=name=tiller --namespace kube-system NAME READY STATUS RESTARTS AGE po/tiller-deploy-df4fdf55d-h5mvh 0/1 Running 0 5s NAME CLUSTER-IP EXTERNAL-IP PORT(S) AGE svc/tiller-deploy 10.107.191.68 &lt;none&gt; 44134/TCP 5s NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE deploy/tiller-deploy 1 1 1 0 5s NAME DESIRED CURRENT READY AGE rs/tiller-deploy-df4fdf55d 1 1 0 5s</code> </pre><br>  Now Tiller is installed in a cluster and is ready for release management, interaction with the Kubernetes API. <br><br>  <i><b>Note</b> : When installing and upgrading (the <code>--upgrade</code> option) Tiller, you can <b>set a specific image</b> instead of using the latest stable release by default.</i>  <i>The name of an arbitrary image is determined by the <code>--tiller-image</code> option, and with the <code>--canary-image</code> option, a <code>--canary-image</code> will be used when Tiller rolls out.</i>  <i>The canary image allows you to use Tiller, the version of which code corresponds to the master branch.</i> <br><br>  The service data is stored in a cluster in special resources, <code>ConfigMaps</code> , so deleting and reinstalling Tiller does not result in the loss of data from previously installed releases. <br><br><h2>  Chart repositories </h2><br>  Charts Repository - HTTP server for storing and distributing charts.  Information about charts in the repository is stored in the <code>index.yaml</code> file.  It also indicates where each chart can be loaded from.  Most often, charts are stored with the <code>index.yaml</code> file, but nothing prevents you from placing them on another server.  Usually the file structure is reduced to a flat form: <br><br><pre> <code class="bash hljs">. ‚îú‚îÄ‚îÄ index.yaml ‚îú‚îÄ‚îÄ artifactory-7.3.0.tgz ‚îú‚îÄ‚îÄ docker-registry-1.5.2.tgz ... ‚îî‚îÄ‚îÄ wordpress-2.1.10.tgz</code> </pre><br>  By default, Helm uses the <a href="https://github.com/helm/charts">official Kubernetes charts repository</a> .  It contains carefully crafted topical charts for solving a variety of applied tasks.  This repository is called <b>stable</b> : <br><br><pre> <code class="bash hljs">$ helm repo list NAME URL stable https://kubernetes-charts.storage.googleapis.com</code> </pre><br>  If necessary, <b>creating</b> your own repository will not be any problems.  Server requirements are minimal, so, like most of the public repositories of charts, it can be placed on GitHub Pages.  More information about the tools and the necessary steps for this can be found in the <a href="">documentation</a> . <br><br>  When using the repositories of the charts, they can be added and deleted.  In order for the versions of the charts to be relevant, it is necessary to periodically update the index.  Let me give you an example for the public repository of <a href="https://github.com/bitnami/charts">bitnami</a> , most of whose charts are used in the official Helm repository: <br><br><pre> <code class="bash hljs">$ helm repo add bitnami https://charts.bitnami.com/bitnami <span class="hljs-string"><span class="hljs-string">"bitnami"</span></span> has been added to your repositories $ helm repo update Hang tight <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> we grab the latest from your chart repositories... ...Successfully got an update from the <span class="hljs-string"><span class="hljs-string">"bitnami"</span></span> chart repository ...Successfully got an update from the <span class="hljs-string"><span class="hljs-string">"stable"</span></span> chart repository Update Complete. Happy Helming! $ helm repo remove bitnami <span class="hljs-string"><span class="hljs-string">"bitnami"</span></span> has been removed from your repositories</code> </pre><br>  Next - <b>search</b> the repositories.  Calling <code>helm search</code> with no arguments shows all available charts: <br><br><pre> <code class="bash hljs">$ helm search NAME CHART VERSION APP VERSION DESCRIPTION stable/acs-engine-autoscaler 2.2.0 2.1.1 Scales worker nodes within agent pools stable/aerospike 0.1.7 v3.14.1.2 A Helm chart <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Aerospike <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Kubernetes stable/anchore-engine 0.2.1 0.2.4 Anchore container analysis and policy evaluation engine s... stable/apm-server 0.1.0 6.2.4 The server receives data from the Elastic APM agents and ... stable/ark 1.2.1 0.9.1 A Helm chart <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ark stable/artifactory 7.3.0 6.1.0 Universal Repository Manager supporting all major packagi... ... stable/weave-cloud 0.2.2 0.2.0 Weave Cloud is a add-on to Kubernetes <span class="hljs-built_in"><span class="hljs-built_in">which</span></span> provides Cont... stable/weave-scope 0.9.3 1.6.5 A Helm chart <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the Weave Scope cluster visualizer. stable/wordpress 2.1.10 4.9.8 Web publishing platform <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> building blogs and websites. stable/xray 0.4.1 2.3.0 Universal component scan <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> security and license invento... stable/zeppelin 1.0.1 0.7.2 Web-based notebook that enables data-driven, interactive ... stable/zetcd 0.1.9 0.0.3 CoreOS zetcd Helm chart <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Kubernetes</code> </pre><br>  In the optional <code>keywords</code> field in <code>Chart.yaml</code> developers specify tags that are used to simplify searching in the charts repositories: <br><br><pre> <code class="bash hljs">$ helm search web NAME CHART VERSION APP VERSION DESCRIPTION stable/cerebro 0.3.1 0.8.1 A Helm chart <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Cerebro - a web admin tool that replaces... stable/chronograf 0.4.5 1.3 Open-source web application written <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Go and React.js th... stable/jasperreports 2.0.4 7.1.0 The JasperReports server can be used as a stand-alone or ... stable/joomla 2.0.9 3.8.12 PHP content management system (CMS) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> publishing web co... stable/kubernetes-dashboard 0.7.2 1.8.3 General-purpose web UI <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Kubernetes clusters stable/odoo 2.0.7 11.0.20180815 A suite of web based open <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> business apps. stable/phabricator 2.1.9 2018.34.0 Collection of open <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> web applications that <span class="hljs-built_in"><span class="hljs-built_in">help</span></span> soft... stable/redmine 4.1.0 3.4.6 A flexible project management web application. stable/rethinkdb 0.1.4 0.1.0 The open-source database <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the realtime web stable/schema-registry-ui 0.1.0 v0.9.4 This is a web tool <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the confluentinc/schema-registry i... stable/superset 0.1.2 0.24.0 Apache Superset (incubating) is a modern, enterprise-read... stable/testlink 2.0.3 1.9.17 Web-based <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> management system that facilitates softwar... stable/tomcat 0.1.0 7 Deploy a basic tomcat application server with sidecar as ... stable/wordpress 2.1.10 4.9.8 Web publishing platform <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> building blogs and websites. ... $ helm search cms blog NAME CHART VERSION APP VERSION DESCRIPTION stable/drupal 1.1.3 8.5.6 One of the most versatile open <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> content management ... stable/joomla 2.0.9 3.8.12 PHP content management system (CMS) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> publishing web co... stable/wordpress 2.1.10 4.9.8 Web publishing platform <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> building blogs and websites</code> </pre> <br>  <i><b>Note:</b> When using the <code>helm search</code> command, you may encounter unstable operation of several filters: the presence of the result depends on the order of instructions and the number of filters.</i> <br><br>  After the search has narrowed down to several options, you can proceed to a more detailed analysis of the charts - using the <code>helm inspect</code> command.  It displays the contents of the chart files <code>Chart.yaml</code> , <code>values.yaml</code> and <code>README.md</code> .  Each section can be displayed separately with the corresponding arguments: <code>chart</code> , <code>values</code> and <code>readme</code> . <br><br>  In the official repository charts are well documented and contain examples of use, and some charts even ready configurations for <b>production</b> .  For example, a good <code>readme</code> is provided by <a href="">stable / wordpress</a> <i>(for its output in the console, see <code>helm inspect readme stable/wordpress</code> )</i> . <br><br>  Search is a good way to find available packages.  After the package is found, you can use it to install the application into the cluster. <br><br><h2>  First application </h2><br>  For example, the already mentioned <a href="https://github.com/helm/charts/blob/master/stable/wordpress">stable / wordpress</a> chart is selected. <br><br>  It uses the parameters described in the <code>values.yaml</code> file.  You can override the parameters in the YAML file, and then transfer this file during installation (the <code>-f</code> , <code>--values</code> ).  You can also override them directly on the command line (the <code>--set</code> , <code>--set-string</code> and <code>--set-file</code> ).  All options are available for use any number of times;  while redefinition in the command line takes precedence over files with parameters. <br><br>  When setting the chart, you can give the release a name with the <code>--name</code> option or use a random name generated by Helm. <br><br>  Let's set up the chart with the <a href="">configuration for production</a> , change the blog name, turn off WordPress data saving in <code>PersistentVolumeClaim</code> <i>(for more information on permanent repositories, see the <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">Kubernetes documentation</a> )</i> : <br><br><pre> <code class="bash hljs">$ curl https://raw.githubusercontent.com/helm/charts/master/stable/wordpress/values-production.yaml --output values-production.yaml $ helm install --name habr --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"wordpressBlogName=Flant's Blog!"</span></span> --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"persistence.enabled=false"</span></span> -f values-production.yaml stable/wordpress NAME: habr LAST DEPLOYED: Fri Aug 31 15:17:57 2018 NAMESPACE: default STATUS: DEPLOYED RESOURCES: ==&gt; v1/Secret NAME TYPE DATA AGE habr-mariadb Opaque 2 0s habr-wordpress Opaque 2 0s ==&gt; v1/ConfigMap NAME DATA AGE habr-mariadb-init-scripts 1 0s habr-mariadb 1 0s habr-mariadb-tests 1 0s ==&gt; v1/Service NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE habr-mariadb ClusterIP 10.111.7.232 &lt;none&gt; 3306/TCP 0s habr-wordpress ClusterIP 10.106.129.88 &lt;none&gt; 80/TCP,443/TCP 0s ==&gt; v1beta1/Deployment NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE habr-wordpress 3 3 3 0 0s ==&gt; v1beta1/StatefulSet NAME DESIRED CURRENT AGE habr-mariadb 1 1 0s ==&gt; v1beta1/Ingress NAME HOSTS ADDRESS PORTS AGE wordpress.local-habr wordpress.local 80, 443 0s ==&gt; v1/Pod(related) NAME READY STATUS RESTARTS AGE habr-wordpress-7955b95fd-hh7b9 0/1 ContainerCreating 0 0s habr-wordpress-7955b95fd-tgsxk 0/1 ContainerCreating 0 0s habr-wordpress-7955b95fd-xjz74 0/1 ContainerCreating 0 0s habr-mariadb-0 0/1 ContainerCreating 0 0s NOTES: 1. Get the WordPress URL: You should be able to access your new WordPress installation through https://wordpress.local/admin 2. Login with the following credentials to see your blog <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Username: user <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Password: $(kubectl get secret --namespace default habr-wordpress -o jsonpath=<span class="hljs-string"><span class="hljs-string">"{.data.wordpress-password}"</span></span> | base64 --decode)</code> </pre><br>  In the case of working with a full cluster, then you can follow the recommendations from the <i>NOTES</i> block above.  If you have Minikube, open the website in the browser as follows: <br><br><pre> <code class="bash hljs">$ minikube service habr-wordpress Waiting, endpoint <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> service is not ready yet... Opening kubernetes service default/habr-wordpress <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> default browser...</code> </pre> <br>  Congratulations, the application is in a cluster! <br><br><img src="https://habrastorage.org/webt/on/bg/ub/onbgubke7d2hntrso3asemt5teq.png"><br><br>  An extensive WordPress charts appear in the list of all Helm releases: <br><br><pre> <code class="bash hljs">$ helm list NAME REVISION UPDATED STATUS CHART APP VERSION NAMESPACE habr 1 Fri Aug 31 15:17:57 2018 DEPLOYED wordpress-2.1.10 4.9.8 default</code> </pre><br>  The next step is to update our release and change the image with the blog.  For example, another tag from the same Docker repository ( <code>4.9.8-ol-7</code> ) will be used: <br><br><pre> <code class="bash hljs">$ helm upgrade habr --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"image.tag=4.9.8-ol-7"</span></span> --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"wordpressBlogName=Flant's Blog!"</span></span> --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"persistence.enabled=false"</span></span> -f values-production.yaml stable/wordpress Release <span class="hljs-string"><span class="hljs-string">"habr"</span></span> has been upgraded. Happy Helming! LAST DEPLOYED: Fri Aug 31 15:21:08 2018 NAMESPACE: default STATUS: DEPLOYED RESOURCES: ==&gt; v1/Service NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE habr-mariadb ClusterIP 10.111.7.232 &lt;none&gt; 3306/TCP 3m habr-wordpress ClusterIP 10.106.129.88 &lt;none&gt; 80/TCP,443/TCP 3m ==&gt; v1beta1/Deployment NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE habr-wordpress 3 4 2 0 3m ==&gt; v1beta1/StatefulSet NAME DESIRED CURRENT AGE habr-mariadb 1 1 3m ==&gt; v1beta1/Ingress NAME HOSTS ADDRESS PORTS AGE wordpress.local-habr wordpress.local 80, 443 3m ==&gt; v1/Pod(related) NAME READY STATUS RESTARTS AGE habr-wordpress-66f4fd6b74-gqwhh 0/1 Pending 0 0s habr-wordpress-66f4fd6b74-mf6vj 0/1 Pending 0 0s habr-wordpress-7955b95fd-hh7b9 1/1 Running 2 3m habr-wordpress-7955b95fd-tgsxk 1/1 Running 2 3m habr-wordpress-7955b95fd-xjz74 0/1 Terminating 2 3m habr-mariadb-0 1/1 Running 0 3m ==&gt; v1/Secret NAME TYPE DATA AGE habr-mariadb Opaque 2 3m habr-wordpress Opaque 2 3m ==&gt; v1/ConfigMap NAME DATA AGE habr-mariadb-init-scripts 1 3m habr-mariadb 1 3m habr-mariadb-tests 1 3m NOTES: 1. Get the WordPress URL: You should be able to access your new WordPress installation through https://wordpress.local/admin 2. Login with the following credentials to see your blog <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Username: user <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Password: $(kubectl get secret --namespace default habr-wordpress -o jsonpath=<span class="hljs-string"><span class="hljs-string">"{.data.wordpress-password}"</span></span> | base64 --decode)</code> </pre><br>  Please note that <b>when updating,</b> Tiller compares the received chart with the parameters with the last saved one and executes the corresponding requests in the Kubernetes API, and the <b>current state of the release resources is not taken into account</b> .  It is important to understand this feature and not make mistakes: <br><br><ul><li>  The update is no different from the installation: the Helm-client sends Tiller a chart along with the parameters, so you need to be careful not to forget to specify the parameters and files with the parameters that were set during the installation (or the previous update) and which should not be ignored.  In the example above, this is <code>--set "wordpressBlogName=Flant's Blog!" --set "persistence.enabled=false" -f values-production.yaml</code>  <code>--set "wordpressBlogName=Flant's Blog!" --set "persistence.enabled=false" -f values-production.yaml</code> . </li><li>  Applications that roll out with Helm should only be serviced using Helm: changes made manually with <code>kubectl</code> will not be taken into account by Helm and may have irreversible consequences. </li></ul><br>  Hence the logical conclusion: the <b>process should be automated</b> , and changes should be made only through a commit in the Git repository, changes to the charts and the CI configuration file. <br><br>  The status of application release components in a cluster can always be checked as follows: <br><br><pre> <code class="bash hljs">$ helm status habr LAST DEPLOYED: Fri Aug 31 15:21:08 2018 NAMESPACE: default STATUS: DEPLOYED RESOURCES: ==&gt; v1/Secret NAME TYPE DATA AGE habr-mariadb Opaque 2 4m habr-wordpress Opaque 2 4m ==&gt; v1/ConfigMap NAME DATA AGE habr-mariadb-init-scripts 1 4m habr-mariadb 1 4m habr-mariadb-tests 1 4m ==&gt; v1/Service NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE habr-mariadb ClusterIP 10.111.7.232 &lt;none&gt; 3306/TCP 4m habr-wordpress ClusterIP 10.106.129.88 &lt;none&gt; 80/TCP,443/TCP 4m ==&gt; v1beta1/Deployment NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE habr-wordpress 3 4 2 3 4m ==&gt; v1beta1/StatefulSet NAME DESIRED CURRENT AGE habr-mariadb 1 1 4m ==&gt; v1beta1/Ingress NAME HOSTS ADDRESS PORTS AGE wordpress.local-habr wordpress.local 80, 443 4m ==&gt; v1/Pod(related) NAME READY STATUS RESTARTS AGE habr-wordpress-66f4fd6b74-gqwhh 0/1 Pending 0 1m habr-wordpress-66f4fd6b74-mf6vj 1/1 Running 0 1m habr-wordpress-7955b95fd-hh7b9 1/1 Running 3 4m habr-wordpress-7955b95fd-tgsxk 1/1 Running 3 4m habr-mariadb-0 1/1 Running 1 4m NOTES: 1. Get the WordPress URL: You should be able to access your new WordPress installation through https://wordpress.local/admin 2. Login with the following credentials to see your blog <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Username: user <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Password: $(kubectl get secret --namespace default habr-wordpress -o jsonpath=<span class="hljs-string"><span class="hljs-string">"{.data.wordpress-password}"</span></span> | base64 --decode)</code> </pre><br>  Helm allows you to <b>roll back to a specific release revision</b> .  Currently there are two revisions: <br><br><pre> <code class="bash hljs">$ helm <span class="hljs-built_in"><span class="hljs-built_in">history</span></span> habr REVISION UPDATED STATUS CHART DESCRIPTION 1 Fri Aug 31 15:17:57 2018 SUPERSEDED wordpress-2.1.10 Install complete 2 Fri Aug 31 15:21:08 2018 DEPLOYED wordpress-2.1.10 Upgrade complete</code> </pre><br>  Roll back the application to its original state: <br><br><pre> <code class="bash hljs">$ helm rollback habr 1 Rollback was a success! Happy Helming!</code> </pre><br>  Now the revision history is replenished with one entry: <br><br><pre> <code class="plaintext hljs">$ helm history habr REVISION UPDATED STATUS CHART DESCRIPTION 1 Fri Aug 31 15:17:57 2018 SUPERSEDED wordpress-2.1.10 Install complete 2 Fri Aug 31 15:21:08 2018 SUPERSEDED wordpress-2.1.10 Upgrade complete 3 Fri Aug 31 15:25:06 2018 DEPLOYED wordpress-2.1.10 Rollback to 1</code> </pre><br>  Article coming to an end and release is no longer required? <br><br><pre> <code class="bash hljs">$ helm delete habr release <span class="hljs-string"><span class="hljs-string">"habr"</span></span> deleted</code> </pre><br>  Is it really deleted? .. <br><br>  <b>The command deletes the Kubernetes resources associated with the release, but not the release itself</b> .  All information about the release remains available, including its history: <br><br><pre> <code class="bash hljs">$ helm list --all NAME REVISION UPDATED STATUS CHART APP VERSION NAMESPACE habr 3 Fri Aug 31 15:25:06 2018 DELETED wordpress-2.1.10 4.9.8 default</code> </pre><br><pre> <code class="bash hljs">$ helm <span class="hljs-built_in"><span class="hljs-built_in">history</span></span> habr REVISION UPDATED STATUS CHART DESCRIPTION 1 Fri Aug 31 15:17:57 2018 SUPERSEDED wordpress-2.1.10 Install complete 2 Fri Aug 31 15:21:08 2018 SUPERSEDED wordpress-2.1.10 Upgrade complete 3 Fri Aug 31 15:25:06 2018 DELETED wordpress-2.1.10 Deletion complete</code> </pre><br>  <i><b>Note</b> : As planned, a remote release can be rolled back to previous versions, but in recent versions this feature does not work - see <a href="https://github.com/helm/helm/issues/3722">issue # 3722 for</a> details.</i> <br><br>  To completely remove the release, use the <code>--purge</code> option: <br><br><pre> <code class="bash hljs">$ helm delete --purge habr release <span class="hljs-string"><span class="hljs-string">"habr"</span></span> deleted</code> </pre><br><h2>  Summarizing </h2><br>  This article describes the basic architecture of Helm 2, its components and their functions, as well as the basic primitives, charts, releases and repositories of charts.  We installed Helm in the Kubernetes cluster and got an understanding of the release life cycle and the main commands for working with it. <br><br>  The following material from this cycle will be devoted to the topic of <b>creating your own charts</b> - I will talk about the structure of the chart, templating and debugging tools in it. <br><br><h2>  PS </h2><br><ul><li>  ‚Äú <a href="https://habr.com/company/flant/blog/417079/">Package Manager for Kubernetes - Helm: Past, Present, Future</a> ‚Äù; </li><li>  " <a href="https://habr.com/company/flant/blog/336170/">Practice with dapp.</a>  <a href="https://habr.com/company/flant/blog/336170/">Part 2. Deploying Docker images in Kubernetes with the help of Helm</a> ‚Äù; </li><li>  ‚Äú <a href="https://habr.com/company/flant/blog/345580/">Build and heat applications in Kubernetes using dapp and GitLab CI</a> ‚Äù; </li><li>  ‚Äú <a href="https://habr.com/company/flant/blog/345116/">Best CI / CD practices with Kubernetes and GitLab</a> ‚Äù <i>(review and video of the report)</i> . </li></ul></div><p>Source: <a href="https://habr.com/ru/post/420437/">https://habr.com/ru/post/420437/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420427/index.html">How to stretch images without losing quality in Photoshop in a quick way</a></li>
<li><a href="../420429/index.html">USE, RED, PgBouncer, its settings and monitoring</a></li>
<li><a href="../420431/index.html">Mars. A practical terraforming guide for housewives</a></li>
<li><a href="../420433/index.html">‚ÄúFriday format‚Äù: musical roads - what it is and why they are not in Russia</a></li>
<li><a href="../420435/index.html">Quick start with ARM Mbed: development on modern microcontrollers for beginners</a></li>
<li><a href="../420439/index.html">Fintech Digest: Fintech investments reached $ 57 billion, transaction speed increases, and cost decreases</a></li>
<li><a href="../420443/index.html">Cybersecurity experts created a skimmer detector - SkimReaper</a></li>
<li><a href="../420447/index.html">Computer History Museum - the place where IT is logged</a></li>
<li><a href="../420449/index.html">Mask reports on the sale of the company to private investors interested in the US regulator</a></li>
<li><a href="../420451/index.html">Server in the clouds: getting ready to run</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>