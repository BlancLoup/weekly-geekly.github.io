<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Let's see DNS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Attentive reader will find on this picture IPv6 


 People are often puzzled by domains. Why is my site not working? Why this crap is broken, nothing ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Let's see DNS</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/ad4/769/2a4/ad47692a477040ffbad91a23211b5c63.jpg" alt="image"><br>  <em>Attentive reader will find on this picture IPv6</em> </p><br><p>  People are often puzzled by domains.  <em>Why is my site not working?</em>  <em>Why this crap is broken, nothing helps, I just want it to work!</em>  Usually, the questioner either does not know about the DNS, or does not understand the fundamental ideas.  For many, DNS is a terrible and incomprehensible thing.  This article is an attempt to dispel such fear.  DNS is <em>easy</em> if you understand a few basic concepts. </p><br><h4>  What is DNS? </h4><br><p>  <em>DNS</em> stands for <em>Domain Name System</em> .  This is a global distributed storage of keys and values.  Servers around the world can provide you with a key value, and if they do not know the key, they will ask for help from another server. </p><br><p> That's all.  True.  You or your browser requests the value for the <code>www.example.com</code> key, and receives <code>1.2.3.4</code> in response. <a name="habracut"></a></p><br><h4>  Basic stuff </h4><br><p>  A big plus of DNS is that it is a public service, and you can poke at the server if you want to figure it out.  Let's try.  I have a domain <code>petekeen.net</code> , which is hosted on the machine <code>web01.bugsplat.info</code> .  The commands used below can be run from the command line OS X ( <em>oh, i.e. macOS, - approx. Lane</em> ). </p><br><p>  Let's take a look at the mapping between the name and the address: </p><br><pre> <code class="hljs pgsql">$ dig web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span></code> </pre><br><p>  The <code>dig</code> command is such a Swiss army knife for DNS queries.  Cool, multi-tool.  Here is the first part of the answer: </p><br><pre> <code class="hljs pgsql">; &lt;&lt;&gt;&gt; DiG <span class="hljs-number"><span class="hljs-number">9.7</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span>-P1 &lt;&lt;&gt;&gt; web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span> ;; <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: +cmd ;; Got answer: ;; -&gt;&gt;<span class="hljs-keyword"><span class="hljs-keyword">HEADER</span></span>&lt;&lt;- opcode: QUERY, status: NOERROR, id: <span class="hljs-number"><span class="hljs-number">51539</span></span> ;; flags: qr rd ra; QUERY: <span class="hljs-number"><span class="hljs-number">1</span></span>, ANSWER: <span class="hljs-number"><span class="hljs-number">1</span></span>, AUTHORITY: <span class="hljs-number"><span class="hljs-number">0</span></span>, ADDITIONAL: <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br><p>  There is only one interesting detail: information about the request itself.  It is said that we requested a recording and received exactly one answer.  Here is: </p><br><pre> <code class="hljs pgsql">;; QUESTION SECTION: ;web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A</code> </pre><br><p>  <code>dig</code> defaults to querying <code>A</code> records.  <code>A</code> is an <em>address</em> , and this is one of the fundamental types of DNS records.  <code>A</code> contains one <code>IPv4</code> address.  There is an equivalent for <code>IPv6</code> addresses - <code>AAAA</code> .  Let's take a look at the answer: </p><br><pre> <code class="hljs css">;; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ANSWER</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SECTION</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">web01</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bugsplat</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.info</span></span>. 300 <span class="hljs-selector-tag"><span class="hljs-selector-tag">IN</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">A</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.241</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.250</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.244</span></span></code> </pre><br><p>  It says that the host is <code>web01.bugsplat.info.</code>  there is one address <code>A</code> : <code>192.241.250.244</code> .  The number <code>300</code> is <code>TTL</code> , or <em>time to live</em> (lifetime).  So many seconds, you can keep the value in the cache until re-check.  The word <code>IN</code> means <code>Internet</code> .  Historically, it is necessary to separate the types of networks.  Read more about this in the <a href="https://www.iana.org/assignments/dns-parameters/dns-parameters.xhtml">IANA's DNS Parameters</a> document. </p><br><p>  The rest of the answer describes the answer itself: </p><br><pre> <code class="hljs css">;; <span class="hljs-selector-tag"><span class="hljs-selector-tag">Query</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">time</span></span>: 20 <span class="hljs-selector-tag"><span class="hljs-selector-tag">msec</span></span> ;; <span class="hljs-selector-tag"><span class="hljs-selector-tag">SERVER</span></span>: 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-id"><span class="hljs-selector-id">#53</span></span>(192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span>) ;; <span class="hljs-selector-tag"><span class="hljs-selector-tag">WHEN</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fri</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Jul</span></span> 19 20<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:01</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:16</span></span> 2013 ;; <span class="hljs-selector-tag"><span class="hljs-selector-tag">MSG</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SIZE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcvd</span></span>: 56</code> </pre><br><p>  In particular, it says how long the server responded, what the server‚Äôs IP address was ( <code>192.168.1.1</code> ), what port the <code>dig</code> knocking at ( <code>53</code> , the default DNS port), when the request was completed and how many bytes were in the response. </p><br><p>  As you can see, with a normal DNS query, a lot of things happen.  <a href="https://habrahabr.ru/company/htmlacademy/blog/254825/">Every time</a> you open a web page, the browser makes dozens of such requests, including to download all external resources such as images and scripts.  Each resource is responsible for at least one new DNS query, and if DNS were not designed for strong caching, then a lot of traffic would be generated. </p><br><p>  But in this example it is not visible that the DNS server <code>192.168.1.1</code> contacted a bunch of other servers to answer the simple question: ‚Äúwhere does <code>web01.bugsplat.info</code> address <code>web01.bugsplat.info</code> ?‚Äù.  Let's run the trace to find out about the whole possible chain that <code>dig</code> would have had if the information had not been cached: </p><br><pre> <code class="hljs pgsql">$ dig +trace web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span> ; &lt;&lt;&gt;&gt; DiG <span class="hljs-number"><span class="hljs-number">9.7</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span>-P1 &lt;&lt;&gt;&gt; +trace web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span> ;; <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: +cmd . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS l.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS m.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS a.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS b.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS c.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS d.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS e.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS f.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS g.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS h.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS i.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS j.root-servers.net. . <span class="hljs-number"><span class="hljs-number">137375</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS k.root-servers.net. ;; Received <span class="hljs-number"><span class="hljs-number">512</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>#<span class="hljs-number"><span class="hljs-number">53</span></span>(<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">189</span></span> ms <span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">172800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS c0.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>.afilias-nst.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">172800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS a2.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>.afilias-nst.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">172800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS d0.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>.afilias-nst.org. <span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">172800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS b2.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>.afilias-nst.org. <span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">172800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS b0.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>.afilias-nst.org. <span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">172800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS a0.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>.afilias-nst.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. ;; Received <span class="hljs-number"><span class="hljs-number">443</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">192.5</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.241</span></span>#<span class="hljs-number"><span class="hljs-number">53</span></span>(<span class="hljs-number"><span class="hljs-number">192.5</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.241</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1224</span></span> ms bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">86400</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS ns<span class="hljs-number"><span class="hljs-number">-1356.</span></span>awsdns<span class="hljs-number"><span class="hljs-number">-41.</span></span>org. bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">86400</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS ns<span class="hljs-number"><span class="hljs-number">-212.</span></span>awsdns<span class="hljs-number"><span class="hljs-number">-26.</span></span>com. bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">86400</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS ns<span class="hljs-number"><span class="hljs-number">-1580.</span></span>awsdns<span class="hljs-number"><span class="hljs-number">-05.</span></span>co.uk. bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">86400</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS ns<span class="hljs-number"><span class="hljs-number">-911.</span></span>awsdns<span class="hljs-number"><span class="hljs-number">-49.</span></span>net. ;; Received <span class="hljs-number"><span class="hljs-number">180</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">199.254</span></span><span class="hljs-number"><span class="hljs-number">.48</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>#<span class="hljs-number"><span class="hljs-number">53</span></span>(<span class="hljs-number"><span class="hljs-number">199.254</span></span><span class="hljs-number"><span class="hljs-number">.48</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">239</span></span> ms web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">300</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A <span class="hljs-number"><span class="hljs-number">192.241</span></span><span class="hljs-number"><span class="hljs-number">.250</span></span><span class="hljs-number"><span class="hljs-number">.244</span></span> bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">172800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS ns<span class="hljs-number"><span class="hljs-number">-1356.</span></span>awsdns<span class="hljs-number"><span class="hljs-number">-41.</span></span>org. bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">172800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS ns<span class="hljs-number"><span class="hljs-number">-1580.</span></span>awsdns<span class="hljs-number"><span class="hljs-number">-05.</span></span>co.uk. bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">172800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS ns<span class="hljs-number"><span class="hljs-number">-212.</span></span>awsdns<span class="hljs-number"><span class="hljs-number">-26.</span></span>com. bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">172800</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> NS ns<span class="hljs-number"><span class="hljs-number">-911.</span></span>awsdns<span class="hljs-number"><span class="hljs-number">-49.</span></span>net. ;; Received <span class="hljs-number"><span class="hljs-number">196</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">205.251</span></span><span class="hljs-number"><span class="hljs-number">.195</span></span><span class="hljs-number"><span class="hljs-number">.143</span></span>#<span class="hljs-number"><span class="hljs-number">53</span></span>(<span class="hljs-number"><span class="hljs-number">205.251</span></span><span class="hljs-number"><span class="hljs-number">.195</span></span><span class="hljs-number"><span class="hljs-number">.143</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> ms</code> </pre><br><p>  Information is displayed in a hierarchical sequence.  Remember how <code>dig</code> inserted a point <code>.</code>  after the host, <code>web01.bugsplat.info</code> ?  So, the point <code>.</code>  this is an important detail, and it means the root of the hierarchy. </p><br><p>  Root DNS servers are served by various companies and nations around the world.  Initially, they were few, but the Internet was growing, and now there are 13 of them.  But each of the servers has dozens or hundreds of physical machines that hide behind a single IP. </p><br><p>  So, at the very top of the trace are the root servers, each defined using an <code>NS-</code> record.  <code>NS</code> record links the domain name (in this case, the root domain) to the DNS server.  When you register a domain name with a registrar like Namecheap or Godaddy, they create <code>NS</code> records for you. </p><br><p>  In the next block, you can see how <code>dig</code> chose a random root server, and requested from it an <code>A</code> record for <code>web01.bugsplat.info</code> .  Only the IP address of the root server is <code>192.5.5.241</code> ( <code>192.5.5.241</code> ).  So what exactly was the root server?  Let's find out! </p><br><pre> <code class="hljs pgsql">$ dig -x <span class="hljs-number"><span class="hljs-number">192.5</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.241</span></span> ; &lt;&lt;&gt;&gt; DiG <span class="hljs-number"><span class="hljs-number">9.8</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span>-P1 &lt;&lt;&gt;&gt; -x <span class="hljs-number"><span class="hljs-number">192.5</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.241</span></span> ;; <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: +cmd ;; Got answer: ;; -&gt;&gt;<span class="hljs-keyword"><span class="hljs-keyword">HEADER</span></span>&lt;&lt;- opcode: QUERY, status: NOERROR, id: <span class="hljs-number"><span class="hljs-number">2862</span></span> ;; flags: qr rd ra; QUERY: <span class="hljs-number"><span class="hljs-number">1</span></span>, ANSWER: <span class="hljs-number"><span class="hljs-number">1</span></span>, AUTHORITY: <span class="hljs-number"><span class="hljs-number">0</span></span>, ADDITIONAL: <span class="hljs-number"><span class="hljs-number">0</span></span> ;; QUESTION SECTION: ;<span class="hljs-number"><span class="hljs-number">241.5</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.192</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>-addr.arpa. <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> PTR ;; ANSWER SECTION: <span class="hljs-number"><span class="hljs-number">241.5</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span><span class="hljs-number"><span class="hljs-number">.192</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>-addr.arpa. <span class="hljs-number"><span class="hljs-number">3261</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> PTR f.root-servers.net.</code> </pre> <br><p>  The <code>-x</code> flag causes <code>dig</code> to do a reverse lookup by IP address.  DNS responds with a <code>PTR</code> record that connects the IP and the host, in this case <code>f.root-servers.net</code> . </p><br><p>  Returning to our initial query: the root server <code>F</code> returned another set of <code>NS</code> servers.  He is responsible for the top-level domain <code>info</code> .  <code>dig</code> requests one of these servers for the <code>A</code> record for <code>web01.bugsplat.info</code> , and receives another set of <code>NS</code> servers in response, and then requests the <code>A</code> record for <code>web01.bugsplat.info.</code> from <em>one of these</em> servers <code>web01.bugsplat.info.</code>  .  And finally gets an answer! </p><br><p>  Phew!  Much traffic would have been generated, but almost all of these entries were cached for a long time by each server in the chain.  Your computer also caches this data, just like your browser.  Most often, DNS queries never reach the root servers, because their IP addresses almost never change ( <em>‚ÄúProbably, it‚Äôs all about a big TTL for records in their database. If the DNS server‚Äôs IP address has never changed at all, this does not mean that its base has been forever cached ‚Äù</em> (note from <a href="https://habrahabr.ru/users/rrrav/" class="user_link">rrrav</a> ).  Top level domains <code>com</code> , <code>net</code> , <code>org</code> , etc.  also usually heavily cached. </p><br><h4>  Other types </h4><br><p>  There are several other types that are worth knowing.  The first is <code>MX</code> .  It connects the domain name with one or more mail servers.  Email is so important that it has its own type of DNS record.  Here are the <code>MX</code> values ‚Äã‚Äãfor <code>petekeen.net</code> : </p><br><pre> <code class="hljs pgsql">$ dig petekeen.net mx ; &lt;&lt;&gt;&gt; DiG <span class="hljs-number"><span class="hljs-number">9.7</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span>-P1 &lt;&lt;&gt;&gt; petekeen.net mx ;; <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: +cmd ;; Got answer: ;; -&gt;&gt;<span class="hljs-keyword"><span class="hljs-keyword">HEADER</span></span>&lt;&lt;- opcode: QUERY, status: NOERROR, id: <span class="hljs-number"><span class="hljs-number">18765</span></span> ;; flags: qr rd ra; QUERY: <span class="hljs-number"><span class="hljs-number">1</span></span>, ANSWER: <span class="hljs-number"><span class="hljs-number">2</span></span>, AUTHORITY: <span class="hljs-number"><span class="hljs-number">0</span></span>, ADDITIONAL: <span class="hljs-number"><span class="hljs-number">0</span></span> ;; QUESTION SECTION: ;petekeen.net. <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> MX ;; ANSWER SECTION: petekeen.net. <span class="hljs-number"><span class="hljs-number">86400</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> MX <span class="hljs-number"><span class="hljs-number">60</span></span> web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. ;; Query <span class="hljs-type"><span class="hljs-type">time</span></span>: <span class="hljs-number"><span class="hljs-number">272</span></span> msec ;; <span class="hljs-keyword"><span class="hljs-keyword">SERVER</span></span>: <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>#<span class="hljs-number"><span class="hljs-number">53</span></span>(<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>) ;; <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>: Fri Jul <span class="hljs-number"><span class="hljs-number">19</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">33</span></span>:<span class="hljs-number"><span class="hljs-number">43</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> ;; MSG SIZE rcvd: <span class="hljs-number"><span class="hljs-number">93</span></span></code> </pre> <br><p>  Notice that the <code>MX</code> record points to the name, not the IP address. </p><br><p>  Another type that you probably know is <code>CNAME</code> .  Transcribed as <em>Canonical Name</em> (canonical name).  He associates one name with another.  Let's look at the answer: </p><br><pre> <code class="hljs pgsql">$ dig www.petekeen.net ; &lt;&lt;&gt;&gt; DiG <span class="hljs-number"><span class="hljs-number">9.7</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span>-P1 &lt;&lt;&gt;&gt; www.petekeen.net ;; <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: +cmd ;; Got answer: ;; -&gt;&gt;<span class="hljs-keyword"><span class="hljs-keyword">HEADER</span></span>&lt;&lt;- opcode: QUERY, status: NOERROR, id: <span class="hljs-number"><span class="hljs-number">16785</span></span> ;; flags: qr rd ra; QUERY: <span class="hljs-number"><span class="hljs-number">1</span></span>, ANSWER: <span class="hljs-number"><span class="hljs-number">2</span></span>, AUTHORITY: <span class="hljs-number"><span class="hljs-number">0</span></span>, ADDITIONAL: <span class="hljs-number"><span class="hljs-number">0</span></span> ;; QUESTION SECTION: ;www.petekeen.net. <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A ;; ANSWER SECTION: www.petekeen.net. <span class="hljs-number"><span class="hljs-number">86400</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> CNAME web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">300</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A <span class="hljs-number"><span class="hljs-number">192.241</span></span><span class="hljs-number"><span class="hljs-number">.250</span></span><span class="hljs-number"><span class="hljs-number">.244</span></span> ;; Query <span class="hljs-type"><span class="hljs-type">time</span></span>: <span class="hljs-number"><span class="hljs-number">63</span></span> msec ;; <span class="hljs-keyword"><span class="hljs-keyword">SERVER</span></span>: <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>#<span class="hljs-number"><span class="hljs-number">53</span></span>(<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>) ;; <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>: Fri Jul <span class="hljs-number"><span class="hljs-number">19</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">36</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span> <span class="hljs-number"><span class="hljs-number">2013</span></span> ;; MSG SIZE rcvd: <span class="hljs-number"><span class="hljs-number">86</span></span></code> </pre> <br><p>  We immediately see that we received two answers.  The first one says that <code>www.petekeen.net</code> points to <code>web01.bugsplat.info</code> .  The second returns an <code>A</code> record for that server.  We can assume that <code>CNAME</code> is a pseudonym (or alias) for another server. </p><br><h3>  What's wrong with CNAME </h3><br><p>  <code>CNAME</code> records are very useful, but there is an important point: if there is a <code>CNAME</code> with some name, then you cannot create another record with the same name.  Neither <code>MX</code> , nor <code>A</code> , nor <code>NS</code> , nothing. </p><br><p>  The reason is that DNS replaces in such a way that all records of the place where <code>CNAME</code> points to are also valid for <code>CNAME</code> .  In our example, the entries for <code>www.petekeen.net</code> and <code>web01.bugsplat.info</code> will match. </p><br><p>  Therefore, you cannot make <code>CNAME</code> on the root domain like <code>petekeen.net</code> , because usually there are other records needed, for example, <code>MX</code> . </p><br><h3>  Requests to other servers </h3><br><p>  Let's imagine that the DNS configuration is corrupted.  It seems to you that you have fixed the problem, but do not want to wait until the cache is updated to make sure.  With <code>dig</code> you can make a request to a public DNS server instead of your default one, like this: </p><br><pre> <code class="hljs ruby">$ dig www.petekeen.net @8.<span class="hljs-number"><span class="hljs-number">8.8</span></span>.<span class="hljs-number"><span class="hljs-number">8</span></span></code> </pre> <br><p>  The <code>@</code> symbol with an IP address or host causes <code>dig</code> send a request to the specified server through the default port.  You can use <a href="https://developers.google.com/speed/public-dns/">Google‚Äôs public DNS server</a> or the <a href="http://www.tummy.com/articles/famous-dns-server/">almost public Level 3 server</a> at <code>4.2.2.2</code> . </p><br><h2>  Typical situations </h2><br><p>  Let's look at typical situations familiar to many web developers. </p><br><h5>  Redirect domain to www </h5><br><p>  Often you need to redirect the domain <code>iskettlemanstillopen.com</code> to <code>www.iskettlemanstillopen.com</code> .  Registrars like Namecheap or DNSimple call this the <em>Redirect URL</em> .  Here is an example from the Namecheap admin: </p><br><p><img src="https://habrastorage.org/files/216/cb3/e70/216cb3e7014044c58a6e0b8ec01eb4d7.png"></p><br><p>  The <code>@</code> symbol indicates the root domain <code>iskettlemanstillopen.com</code> .  Let's look at the <code>A</code> record at this domain: </p><br><pre> <code class="hljs pgsql">$ dig iskettlemanstillopen.com ;; QUESTION SECTION: ;iskettlemanstillopen.com. <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A ;; ANSWER SECTION: iskettlemanstillopen.com. <span class="hljs-number"><span class="hljs-number">500</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A <span class="hljs-number"><span class="hljs-number">192.64</span></span><span class="hljs-number"><span class="hljs-number">.119</span></span><span class="hljs-number"><span class="hljs-number">.118</span></span></code> </pre><br><p>  This IP is owned by Namecheap, and there is a small web server running that simply does a redirect at the HTTP level to <code>http://www.iskettlemanstillopen.com</code> : </p><br><pre> <code class="hljs pgsql">$ curl -I iskettlemanstillopen.com curl -I iskettlemanstillopen.com HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">302</span></span> Moved Temporarily <span class="hljs-keyword"><span class="hljs-keyword">Server</span></span>: nginx <span class="hljs-type"><span class="hljs-type">Date</span></span>: Fri, <span class="hljs-number"><span class="hljs-number">19</span></span> Jul <span class="hljs-number"><span class="hljs-number">2013</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">53</span></span>:<span class="hljs-number"><span class="hljs-number">21</span></span> GMT Content-<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>: <span class="hljs-type"><span class="hljs-type">text</span></span>/html <span class="hljs-keyword"><span class="hljs-keyword">Connection</span></span>: keep-alive Content-Length: <span class="hljs-number"><span class="hljs-number">154</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Location</span></span>: http://www.iskettlemanstillopen.com/</code> </pre><br><h3>  CNAME for Heroku or Github </h3><br><p>  Take a look at the screenshot above.  On the second line there is a <code>CNAME</code> .  In this case, <code>www.iskettlemanstillopen.com</code> points to the application running on Heroku. </p><br><pre> <code class="hljs pgsql">$ heroku domains === warm-journey<span class="hljs-number"><span class="hljs-number">-3906</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Domain</span></span> Names warm-journey<span class="hljs-number"><span class="hljs-number">-3906.</span></span>herokuapp.com www.iskettlemanstillopen.com</code> </pre><br><p>  There is a similar story with Github, but there you need to create a special file in the root of the repository, and name it <code>CNAME</code> .  See the <a href="https://help.github.com/articles/setting-up-a-custom-domain-with-pages">documentation</a> . </p><br><h3>  Wildcards </h3><br><p>  Most DNS servers support wildcards.  For example, there is a wildcard <code>CNAME</code> for <code>*.web01.bugsplat.info</code> points to <code>web01.bugsplat.info</code> .  Then any host on <code>web01</code> will point to <code>web01.bugsplat.info</code> and there is no need to create new entries: </p><br><pre> <code class="hljs pgsql">$ dig randomapp.web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span> ;; QUESTION SECTION: ;randomapp.web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A ;; ANSWER SECTION: randomapp.web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">300</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> CNAME web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. web01.bugsplat.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>. <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> A <span class="hljs-number"><span class="hljs-number">192.241</span></span><span class="hljs-number"><span class="hljs-number">.250</span></span><span class="hljs-number"><span class="hljs-number">.244</span></span></code> </pre><br><h3>  Conclusion </h3><br><p>  Hope you now have a basic understanding of DNS.  All standards are described in the documents: </p><br><ul><li>  <a href="http://www.ietf.org/rfc/rfc1034.txt">RFC 1034: Domain Names - Concepts and Facilities</a> </li><li>  <a href="http://www.ietf.org/rfc/rfc1035.txt">RFC 1035: Domain Names - Implementation and Specification</a> </li></ul><br><p>  There are a couple of interesting RFCs, including <a href="http://www.ietf.org/rfc/rfc4034.txt">4034</a> , which describes the <code>DNSSEC</code> standard and <a href="http://www.ietf.org/rfc/rfc5321.txt">5321</a> , which describes the relationship between DNS and email.  They are interesting to read for common development. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/303446/">https://habr.com/ru/post/303446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../303428/index.html">New L4 Load Balancer with native SRV record service discovery and Docker API service Discovery</a></li>
<li><a href="../303430/index.html">Energy Efficiency Options from Coolan, MacroAir, AMCA International and Cradle</a></li>
<li><a href="../303436/index.html">Data synchronization in real-time applications with Theron</a></li>
<li><a href="../303438/index.html">Microsoft has published information about the implementation of VFS in the Linux subsystem on Windows 10</a></li>
<li><a href="../303442/index.html">We write an application for analyzing tweets in real-time mode in 30 minutes</a></li>
<li><a href="../303448/index.html">Another 0day vulnerability found in Adobe Flash Player</a></li>
<li><a href="../303450/index.html">High-Density WiFi. Part 3: About technology. Part 4: About Money</a></li>
<li><a href="../303452/index.html">Report from Moscow Data Science Meetup May 27</a></li>
<li><a href="../303456/index.html">Redux Tutorial</a></li>
<li><a href="../303458/index.html">Ranking Quality Metrics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>