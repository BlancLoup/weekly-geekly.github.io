<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>STM32L-DISCOVERY + FDD</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In order to connect STM32L-DISCOVERY to FDD you need 4 wires and 2 jumpers. 


 Everything you need to know about Floppy Disk Drive 


- Floppy Disk D...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>STM32L-DISCOVERY + FDD</h1><div class="post__text post__text-html js-mediator-article">  In order to connect STM32L-DISCOVERY to FDD you need 4 wires and 2 jumpers. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b00/8b1/cde/b008b1cde208c64a1f94934c0fb3dc64.jpg"></div><br><a name="habracut"></a><h2>  Everything you need to know about Floppy Disk Drive </h2><br><ul><li>  <a href="http://www.interfacebus.com/PC_Floppy_Drive_PinOut.html">Floppy Disk Drive Pinout</a> - in great detail; </li><li>  <a href="http://quantumnet.wikidot.com/interfacing-a-floppy-drive">Interfacing A Floppy Drive</a> - here is a pseudo-code of read and write operations </li><li>  <a href="http://www.duinomite.com/duinomite-plays-the-imperial-march/">Duinomite plays the Imperial march</a> - an example of connecting the device. </li></ul><br>  PS: Time is night, this is my first note on this topic, I don‚Äôt have any special knowledge, everything is described in detail on thematic resources, but I had to spend a lot of time to figure it out.  Plans to make the player from the <a href="http://en.wikipedia.org/wiki/Ring_Tone_Transfer_Language">RTTTL</a> drive. <br><br><h2>  Where to begin? </h2><br>  If you look at the pinout of the connector, then all the inputs / outputs are even, the odd feet are ground (GND).  There must be a gap on the drive to insert the cable correctly, turn the device upside down with a gap, the upper left leg is 2. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/935/d32/857/935d32857876a2373d5a840b64ac301c.gif"></div><br>  Put the jumper on the 12-11 legs (‚ÄúDrive Sel B‚Äù with GND) the LED on the front panel of the drive will light up, then the jumper by 16-15 (‚ÄúMotor Enable B‚Äù with GND) will start the disk spinning. <br><br><h3>  TTL logic levels </h3><blockquote>  In any case of the floppy interface used 5v TTL as the electrical interface, it would comply with LVTTL switching levels. </blockquote>  At the outputs of the debug board, the logical unit is 3.3v, and the FDD interface uses 5v, which means that you need to connect FDD to the ‚Äú5v tolerant‚Äù pins.  To find them, just open the <a href="http://www.st.com/st-web-ui/static/active/en/resource/technical/document/datasheet/CD00277537.pdf">datasheet of the STM32L152RBT6</a> controller, which is installed on STM32L-DISCOVERY and see the table with the name "... pin definitions".  If in the column ‚ÄúI / O structure‚Äù stands ‚ÄúFT‚Äù (five-volt tolerant) it means that you can safely submit 5c per pin. <br><br>  From the <a href="http://www.interfacebus.com/PC_Floppy_Drive_PinOut.html">detailed manual,</a> we know the logical levels of TTL <br><blockquote>  An input voltage of 2.0 volts and a low voltage of 0.8 volts. <br>  An output high voltage of 2.4 volts. </blockquote>  This means that 3.3v is enough for us to supply a logical unit. <br><br>  Ideally, devices should have a common ground for matching logic levels, so we power the debug board directly from the drive. <br>  The drive has a standard <a href="http://www.interfacebus.com/ATX_Motherboard_FDD_Power_PinOut.html">power connector</a> . <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/504/186/02d/50418602dcd73b19b5429ef7b145beb2.jpg"></div><br>  Solder two wiring to the drive board (for 1 and 2 pin) and stick in EXT_5V and GND on STM32L-DISCOVERY. <br><br><h2>  How to manage FDD? </h2><br>  Two pins, 18 DIR "Direction" and 20 STEP "Step" are used to control the drive's stepper motor. <br>  First you need to set the direction of movement by applying LOW (0) or HIGH (1) to DIR, and then move the head by one track: <br><blockquote>  Step = LOW <br>  Delay (1mS) <br>  Step = HIGH </blockquote><h3>  We write test firmware </h3><br><div class="spoiler">  <b class="spoiler_title">Source</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"stm32l1xx.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"stm32l1xx_rcc.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DIR GPIO_Pin_1 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// 18 // PA1 #define STEP GPIO_Pin_2 // 20 // PA2 void delay_ms(uint32_t delay) { TIM6-&gt;PSC = 2096; TIM6-&gt;ARR = delay; TIM6-&gt;EGR |= TIM_EGR_UG; TIM6-&gt;CR1 |= TIM_CR1_CEN|TIM_CR1_OPM; while ( (TIM6-&gt;CR1 &amp; TIM_CR1_CEN) != 0); } void InitPeriph() { GPIO_InitTypeDef GPIOConfig; GPIOConfig.GPIO_Speed = GPIO_Speed_40MHz; GPIOConfig.GPIO_Mode = GPIO_Mode_OUT; GPIOConfig.GPIO_OType = GPIO_OType_PP; GPIOConfig.GPIO_PuPd = GPIO_PuPd_NOPULL; GPIOConfig.GPIO_Pin = DIR | STEP; RCC_AHBPeriphClockCmd(RCC_AHBPeriph_GPIOA,ENABLE); GPIO_Init(GPIOA,&amp;GPIOConfig); RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM6,ENABLE); } void move() { GPIO_ResetBits(GPIOA,STEP); delay_ms(1); GPIO_SetBits(GPIOA,STEP); } int main() { int i; InitPeriph(); for(;;) { GPIO_ResetBits(GPIOA,DIR); for(i=0;i&lt;100;i++) { move(); } delay_ms(1000); GPIO_SetBits(GPIOA,DIR); for(i=0;i&lt;100;i++) { move(); } delay_ms(2500); } }</span></span></span></span></code> </pre> </div></div><br>  We configure the GPIO ports to output a normal logical signal, enable the clocking of the output port and 6 general-purpose timers.  The tires to which they are connected can be viewed in datasheet.  Further, in an endless loop, we twist the stepping motor on 100 tracks, then back and forth. <br>  The magic number 2096 is the standard internal frequency of this controller (2.097 MHz). </div><p>Source: <a href="https://habr.com/ru/post/221023/">https://habr.com/ru/post/221023/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../221013/index.html">Joint translation of the TED Canadian astronaut</a></li>
<li><a href="../221015/index.html">IBM Watson supercomputer will test itself as a qualified sales assistant</a></li>
<li><a href="../221017/index.html">Naked on the internet or hiding under a pseudonym and lose your reputation online</a></li>
<li><a href="../221019/index.html">5 games for the development of logic and programming for children</a></li>
<li><a href="../221021/index.html">Open Terminal Client OTC-110 - redirection of the printer to the RDP session</a></li>
<li><a href="../221025/index.html">New vulnerability Internet Explorer is exploited in-the-wild</a></li>
<li><a href="../221027/index.html">Learning Derby 0.6, example # 1</a></li>
<li><a href="../221029/index.html">Useful materials for mobile developer # 50 (April 21-27)</a></li>
<li><a href="../221031/index.html">The creator of the cartoon "Fortress" will release a sequel</a></li>
<li><a href="../221033/index.html">"Rule of zero"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>