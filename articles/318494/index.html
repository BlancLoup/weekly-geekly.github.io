<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Uninitialized variables: look for errors</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A large number of scientific studies use code written in the Fortran language. And, unfortunately, ‚Äúscientific‚Äù applications are also not immune from ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Uninitialized variables: look for errors</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/411/435/4ef/4114354efd2f4ebf83f29571d0b5b333.png"></div><br>  A large number of scientific studies use code written in the Fortran language.  And, unfortunately, ‚Äúscientific‚Äù applications are also not immune from trivial errors, such as uninitialized variables.  Needless to say, what can such calculations lead to?  Sometimes the effect of such mistakes can lead to "serious breakthroughs" in science, or cause really big problems - who knows where the results can be used (but, we guess where)?  I would like to bring a number of simple and effective methods that will allow you to check the existing code in Fortran using the Intel compiler and avoid such troubles. <br><a name="habracut"></a><br>  We will deal with problems with floating point numbers.  Errors with uninitialized variables are difficult to find, especially if the code began to write on the Fortran 77 standard. The specificity is that even if we have not declared a variable, it will be declared implicitly, depending on the first letter of the name, according to the so-called rules implicit type definitions (this is also supported by the latest standards).  Letters from I to N mean the type INTEGER, and the remaining letters are of type REAL.  That is, if the variable F unexpectedly appears in our code, by which we multiply something, the compiler will not produce errors, but will simply make F a real type.  Such a wonderful example can compile and execute quite well: <br><br><pre><code class="hljs bash">program <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> z = f*10 <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> *, z, f end program <span class="hljs-built_in"><span class="hljs-built_in">test</span></span></code> </pre> <br>  As you understand, there will be anything on the screen.  I have so: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">-1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0737418E</span></span>+09 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0737418E</span></span>+08</code> </pre><br>  Interestingly, in the same standard there was the possibility of forbidding such ‚Äúgames‚Äù with declaring variables, but only within a program unit, writing <i>implicit none</i> .  True, if you forget to do this in some module, there will appear ‚Äúphantom‚Äù variables there.  It is curious that I once saw randomly added characters to the variable name in the calculations.  Apparently, someone accidentally typed something in a notebook, and some of them were added to the program code when switching between windows.  As a result, everything continued to be considered, and no one swore at the variable.  It is extremely difficult to track down such errors, especially if the code worked for many years without problems. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Therefore, I highly recommend always using <i>implicit none</i> and getting errors from the compiler about variables that were not explicitly defined (even if they are initialized and everything is fine with them): <br><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">program</span></span> test implicit none ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">program</span></span> test error <span class="hljs-string"><span class="hljs-string">#6404</span></span>: This <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> have a <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> must have an explicit <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>. [Z] error <span class="hljs-string"><span class="hljs-string">#6404</span></span>: This <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> have a <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> must have an explicit <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>. [F]</code> </pre><br>  If we understand the already written code, then changing all the sources can be very labor-intensive, so you can use the <i>/ warn: declarations</i> (Windows) compiler option or <i>-warn declarations</i> (Linux) compiler.  She will give us a warning: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">warning</span></span> #<span class="hljs-number"><span class="hljs-number">6717</span></span>: This <span class="hljs-type"><span class="hljs-type">name</span></span> has <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> been given an explicit <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>. [Z] <span class="hljs-built_in"><span class="hljs-built_in">warning</span></span> #<span class="hljs-number"><span class="hljs-number">6717</span></span>: This <span class="hljs-type"><span class="hljs-type">name</span></span> has <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> been given an explicit <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>. [F]</code> </pre><br>  When we deal with all the implicit declared variables and make sure that there are no errors with them, we can proceed to the next part of the Marlezonsky Ballet, namely, the search for uninitialized variables. <br><br>  One of the standard methods is to initialize the compiler of all variables by some value, which, when working with a variable, we can easily understand that the developer has forgotten about initialization.  This value should be very ‚Äúunusual‚Äù, and when working with it, it is desirable to stop the execution of the application, so that, so to speak, ‚Äúto take red-handed‚Äù. <br><br>  It is quite logical to use the ‚Äúsignal‚Äù value of <i>SNaN</i> - Signaling NaN (Not-a-Number).  This is a floating point number that has a special idea, and when we try to perform any operation with it, we will get an exception.  It is worth saying that a certain variable can get the value of NaN when performing certain operations, for example, dividing by zero, multiplying zero by infinity, dividing infinity by infinity, and so on.  Therefore, before proceeding to the "catching" of uninitialized variables, I would like to make sure that there are no exceptions in our code related to working with floating-point numbers. <br><br>  To do this, enable the <i>/ fpe: 0</i> and <i>/ traceback</i> (Windows), or <i>‚Äìfpe0</i> and <i>‚Äìtraceback</i> (Linux) <i>options</i> , build the application and run it.  If everything went as usual, and the application came out without generating an exception, then we are great.  But it is quite possible that already at this stage various ‚Äúunforeseen moments‚Äù will ‚Äúclimb‚Äù.  And all because <i>fpe0</i> changes the default operation with exceptions for floating point numbers.  If they are disabled by default, and we calmly divide by 0, unaware of it, now, an exception will be generated and the program will be stopped.  By the way, not only when dividing by 0 (divide-by-zero), but also when overflowing a floating-point number (floating point overflow), as well as in the case of illegal operations (floating invalid).  At the same time, the numerical results may also change somewhat, since now the denormalized numbers will be ‚Äúreset‚Äù to 0. This, in turn, can give significant acceleration when executing your application, since work with the denormalized numbers is extremely slow, but with you understand, with zeros. <br><br>  Another interesting point is the possible receipt of exceptions with the <i>fpe0</i> option as a result of certain compiler optimizations, for example, vectorization.  Let's say we loop and divide by value if it is not 0, doing an if check.  It is possible that the division will still occur, because the compiler has decided that it will be much faster than using masked operations.  In this case, we are working in speculative mode. <br><br>  So this can be controlled using the <i>/ Qfp-speculation</i> option <i>: strict</i> (Windows) or <i>-fp-speculation = strict</i> (Linux), and disable similar compiler optimizations when working with floating point numbers.  Another way is to change the entire model of work through <i>-fp-model strict</i> , which gives a big negative effect on the overall performance of the application.  About what models are available in the Intel compiler, I already mentioned <a href="https://habrahabr.ru/company/intel/blog/160747/">earlier</a> . <br><br>  By the way, you can try and simply reduce the level of optimization through the <i>/ O1</i> or <i>/ Od</i> options on Windows ( <i>-O1</i> and <i>-O0</i> on Linux). <br><br>  The <i>traceback</i> option simply allows you to get more detailed information about where the error occurred (function name, file, and line of code). <br><br>  Let's do a test on Windows by compiling without optimization (with the <i>/ Od</i> option): <br><br><pre> <code class="hljs pgsql">program test implicit <span class="hljs-keyword"><span class="hljs-keyword">none</span></span> <span class="hljs-type"><span class="hljs-type">real</span></span> a,b a=<span class="hljs-number"><span class="hljs-number">0</span></span> b = <span class="hljs-number"><span class="hljs-number">1</span></span>/a print *, <span class="hljs-string"><span class="hljs-string">'b='</span></span>, b <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> program test</code> </pre><br>  As a result, we will see the following on the screen: <br><br><pre> <code class="hljs pgsql">b= <span class="hljs-keyword"><span class="hljs-keyword">Infinity</span></span></code> </pre><br>  Now turn on the <i>/ fpe: 0</i> and <i>/ traceback option</i> and get the expected <i>exception</i> : <br><br><pre> <code class="hljs pgsql">forrtl: error (<span class="hljs-number"><span class="hljs-number">73</span></span>): floating divide <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> zero Image PC <span class="hljs-keyword"><span class="hljs-keyword">Routine</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span> Source test.exe <span class="hljs-number"><span class="hljs-number">00</span></span>F51050 _MAIN__ <span class="hljs-number"><span class="hljs-number">5</span></span> test.f90 ‚Ä¶</code> </pre><br>  We need to remove such problems from our code before the next stage, namely, force initialization with <i>SNaN</i> values ‚Äã‚Äãusing the <i>/ Qinit option: snan, arrays / traceback</i> (Windows) or <i>-init = snan, arrays -traceback</i> (Linux). <br><br>  Now every access to an uninitialized variable will result in a runtime error: <br><br><pre> <code class="hljs matlab">forrtl: error (<span class="hljs-number"><span class="hljs-number">182</span></span>): floating invalid - possible uninitialized <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>/<span class="hljs-built_in"><span class="hljs-built_in">complex</span></span> variable.</code> </pre><br>  In the simplest example: <br><br><pre> <code class="hljs pgsql">program test implicit <span class="hljs-keyword"><span class="hljs-keyword">none</span></span> <span class="hljs-type"><span class="hljs-type">real</span></span> a,b b = <span class="hljs-number"><span class="hljs-number">1</span></span>/a print *, <span class="hljs-string"><span class="hljs-string">'b='</span></span>, b <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> program test forrtl: error (<span class="hljs-number"><span class="hljs-number">182</span></span>): floating invalid - possible uninitialized <span class="hljs-type"><span class="hljs-type">real</span></span>/complex variable. Image PC <span class="hljs-keyword"><span class="hljs-keyword">Routine</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span> Source test.exe <span class="hljs-number"><span class="hljs-number">00</span></span>D01061 _MAIN__ <span class="hljs-number"><span class="hljs-number">4</span></span> test.f90 ‚Ä¶</code> </pre><br>  A few words about what this strange <i>init</i> option is.  It appeared not so long ago, namely from the compiler version 16.0 (I remind you that the latest version of the compiler for today is 17.0), and allows you to initialize the following constructs in <i>SNaN</i> : <br><br><ul><li>  Static scalars and arrays (with attribute SAVE) </li><li>  Local scalars and arrays </li><li>  Automatic (formed when calling functions) arrays </li><li>  Variables from modules </li><li>  Dynamically allocated (with the attribute ALLOCATABLE) arrays and scalars </li><li>  Pointers (variables with the POINTER attribute) </li></ul><br>  But there are a number of limitations for which <i>init</i> will not work: <br><br><ul><li>  Variables in groups EQUIVALENCE </li><li>  Variables in COMMON block </li><li>  Inherited types and their components are not supported, except ALLOCATABLE and POINTER </li><li>  Formal (dummy) arguments in functions are not initialized to <i>SNaN</i> locally.  However, the actual arguments passed to the function can be initialized in the calling function. </li><li>  Links to intrinsic function arguments and I / O expressions </li></ul><br>  By the way, the option is able not only to initialize values ‚Äã‚Äãin <i>SNaN</i> , but also to reset them.  To do this, specify <i>/ Qinit: zero</i> on Windows ( <i>-init = zero</i> on Linux), and not only the REAL / COMPLEX types, but the integer INTEGER / LOGICAL will be initialized.  By adding <i>arrays</i> , we will also initialize arrays, not just scalar values. <br><br>  For example, options: <br><br><pre> <code class="hljs erlang-repl">-init=snan,zero ! Linux and OS X systems /Qinit:snan,zero ! Windows systems</code> </pre><br>  The scalars of the types REAL or COMPLEX are <i>initialized with the</i> value <i>SNaN</i> , and the types INTEGER or LOGICAL are initialized with zeros.  The following example extends the initialization action also to arrays: <br><br><pre> <code class="hljs swift">-<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>=zero -<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>=snan ‚Äì<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>=arrays ! <span class="hljs-type"><span class="hljs-type">Linux</span></span> and <span class="hljs-type"><span class="hljs-type">OS</span></span> <span class="hljs-type"><span class="hljs-type">X</span></span> systems /<span class="hljs-type"><span class="hljs-type">Qinit</span></span>:zero /<span class="hljs-type"><span class="hljs-type">Qinit</span></span>:snan /<span class="hljs-type"><span class="hljs-type">Qinit</span></span>:arrays ! <span class="hljs-type"><span class="hljs-type">Windows</span></span> systems</code> </pre><br>  In the past, Intel tried to implement such functionality through the <i>-ftrapuv</i> option, but today it is not recommended for use and is outdated, although it also had to initialize the values, as it was intended, it did not work out. <br><br>  By the way, if you are working on the first generation Intel Xeon Phi coprocessor (Knights Corner), then the option will not be available to you, since there is no <i>SNaN</i> support. <br><br>  Well, at the end, a sample from the documentation, which we compile on Linux with all the proposed options and find the uninitialized variables in runtime: <br><br><pre> <code class="hljs sql">! ============================================================== ! ! SAMPLE SOURCE CODE - SUBJECT TO THE TERMS OF SAMPLE CODE LICENSE AGREEMENT, ! http://software.intel.com/en-us/articles/intel-sample-source-code-license-agreement/ ! ! Copyright 2015 Intel Corporation ! ! THIS FILE IS PROVIDED "AS IS" <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> WARRANTIES, EXPRESS <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> IMPLIED, <span class="hljs-keyword"><span class="hljs-keyword">INCLUDING</span></span> BUT ! <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> LIMITED <span class="hljs-keyword"><span class="hljs-keyword">TO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> IMPLIED WARRANTY <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> MERCHANTABILITY, FITNESS <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> A PARTICULAR ! PURPOSE, NON-INFRINGEMENT <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> INTELLECTUAL PROPERTY RIGHTS. ! ! =============================================================== <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> mymod <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>, parameter :: n=<span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-built_in"><span class="hljs-built_in">real</span></span> :: am <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, allocatable, <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span>(:) :: dm <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, target, <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span>(n) :: em <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, pointer, <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span>(:) :: fm <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> mymod subroutine sub(a, b, c, d, e, m) <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> mymod <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>, intent(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>) :: m <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, intent(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span>(n) :: c <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, intent(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span>(*) :: d <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, intent(inout), <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span>(*) :: e <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">automatic</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span>(m) :: f <span class="hljs-built_in"><span class="hljs-built_in">real</span></span> :: a, b print *, a,b,c(<span class="hljs-number"><span class="hljs-number">2</span></span>),c(n/<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>),c(n<span class="hljs-number"><span class="hljs-number">-1</span></span>) print *, d(<span class="hljs-number"><span class="hljs-number">1</span></span>:n:<span class="hljs-number"><span class="hljs-number">33</span></span>) ! <span class="hljs-keyword"><span class="hljs-keyword">first</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">last</span></span> elements uninitialized print *, e(<span class="hljs-number"><span class="hljs-number">1</span></span>:n:<span class="hljs-number"><span class="hljs-number">30</span></span>) ! middle two elements uninitialized print *, am, dm(n/<span class="hljs-number"><span class="hljs-number">2</span></span>), em(n/<span class="hljs-number"><span class="hljs-number">2</span></span>) print *, f(<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>) ! <span class="hljs-keyword"><span class="hljs-keyword">automatic</span></span> <span class="hljs-built_in"><span class="hljs-built_in">array</span></span> uninitialized e(<span class="hljs-number"><span class="hljs-number">1</span></span>) = f(<span class="hljs-number"><span class="hljs-number">1</span></span>) + f(<span class="hljs-number"><span class="hljs-number">2</span></span>) em(<span class="hljs-number"><span class="hljs-number">1</span></span>)= dm(<span class="hljs-number"><span class="hljs-number">1</span></span>) + dm(<span class="hljs-number"><span class="hljs-number">2</span></span>) em(<span class="hljs-number"><span class="hljs-number">2</span></span>)= fm(<span class="hljs-number"><span class="hljs-number">1</span></span>) + fm(<span class="hljs-number"><span class="hljs-number">2</span></span>) b = <span class="hljs-number"><span class="hljs-number">2.</span></span>*am e(<span class="hljs-number"><span class="hljs-number">2</span></span>) = d(<span class="hljs-number"><span class="hljs-number">1</span></span>) + d(<span class="hljs-number"><span class="hljs-number">2</span></span>) e(<span class="hljs-number"><span class="hljs-number">3</span></span>) = c(<span class="hljs-number"><span class="hljs-number">1</span></span>) + c(<span class="hljs-number"><span class="hljs-number">2</span></span>) a = <span class="hljs-number"><span class="hljs-number">2.</span></span>*b <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> program uninit <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> mymod implicit <span class="hljs-keyword"><span class="hljs-keyword">none</span></span> <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">save</span></span> :: a <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">automatic</span></span> :: b <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">save</span></span>, target, <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span>(n) :: c <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, allocatable, <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span>(:) :: d <span class="hljs-built_in"><span class="hljs-built_in">real</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span>(n) :: e <span class="hljs-keyword"><span class="hljs-keyword">allocate</span></span> (d (n)) <span class="hljs-keyword"><span class="hljs-keyword">allocate</span></span> (dm(n)) fm =&gt; c d(<span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-number"><span class="hljs-number">96</span></span>) = <span class="hljs-number"><span class="hljs-number">1.0</span></span> e(<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>) = <span class="hljs-number"><span class="hljs-number">2.0</span></span> e(<span class="hljs-number"><span class="hljs-number">80</span></span>:<span class="hljs-number"><span class="hljs-number">100</span></span>) = <span class="hljs-number"><span class="hljs-number">3.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> sub(a,b,c,d,e(:),n/<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">deallocate</span></span>(d) <span class="hljs-keyword"><span class="hljs-keyword">deallocate</span></span>(dm) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> program uninit</code> </pre><br>  First, compile with <i>‚Äìfpe0</i> and run: <br><pre> <code class="hljs cs">$ ifort -O0 -fpe0 -traceback uninitialized.f90; ./a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">-8.7806177E+13</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">1.000000</span></span> <span class="hljs-number"><span class="hljs-number">1.000000</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">2.000000</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">3.000000</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">1.1448686E+24</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span></code> </pre><br>  It can be seen that there are no exceptions related to operations over floating point numbers in our application, but there are several "strange" values.  We will search for uninitialized variables with the <i>init</i> option: <br><br><pre> <code class="hljs pgsql">$ ifort -O0 -init=snan -traceback uninitialized.f90; ./a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NaN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NaN</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">1.000000</span></span> <span class="hljs-number"><span class="hljs-number">1.000000</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">2.000000</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">3.000000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NaN</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> <span class="hljs-number"><span class="hljs-number">1.1448686E+24</span></span> <span class="hljs-number"><span class="hljs-number">0.0000000E+00</span></span> forrtl: error (<span class="hljs-number"><span class="hljs-number">182</span></span>): floating invalid - possible uninitialized <span class="hljs-type"><span class="hljs-type">real</span></span>/complex variable. Image PC <span class="hljs-keyword"><span class="hljs-keyword">Routine</span></span> <span class="hljs-type"><span class="hljs-type">Line</span></span> Source a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">0000000000477535</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">00000000004752</span></span>F7 <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">0000000000444</span></span>BF4 <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">0000000000444</span></span>A06 <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">0000000000425</span></span>DB6 <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">00000000004035</span></span>D7 <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> libpthread.so<span class="hljs-number"><span class="hljs-number">.0</span></span> <span class="hljs-number"><span class="hljs-number">00007</span></span>FC66DD26130 <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">0000000000402</span></span>C11 sub_ <span class="hljs-number"><span class="hljs-number">39</span></span> uninitialized.f90 a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">0000000000403076</span></span> MAIN__ <span class="hljs-number"><span class="hljs-number">62</span></span> uninitialized.f90 a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">00000000004025</span></span>DE <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> libc.so<span class="hljs-number"><span class="hljs-number">.6</span></span> <span class="hljs-number"><span class="hljs-number">00007</span></span>FC66D773AF5 <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> a.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-number"><span class="hljs-number">00000000004024E9</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> <span class="hljs-type"><span class="hljs-type">Unknown</span></span> Aborted (core dumped)</code> </pre><br>  Now we see that on line 39 we refer to the uninitialized variable AM ‚Äã‚Äãfrom the MYMOD module: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">b</span></span> = <span class="hljs-number"><span class="hljs-number">2</span></span>.*am</code> </pre><br>  There are other errors in this code that I propose to find by using the Intel compiler.  I really hope that this post will be useful to anyone who writes code on Fortran, and your applications will pass the necessary checks on uninitialized variables before the release to the light.  Thank you for your attention and see you soon!  Happy New Year, everyone! </div><p>Source: <a href="https://habr.com/ru/post/318494/">https://habr.com/ru/post/318494/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318480/index.html">ASP.NET Core, Angular 2, SignalR for Dummies</a></li>
<li><a href="../318482/index.html">Developing an Android widget to display a bitcoin course</a></li>
<li><a href="../318484/index.html">Fast Data Mining or C # vs Python Performance Comparison (pandas-numpy-skilearn)</a></li>
<li><a href="../318486/index.html">The operating temperature range of the Raspberry Pi. Test results</a></li>
<li><a href="../318488/index.html">How IT professionals celebrate New Year (survey infographic)</a></li>
<li><a href="../318496/index.html">Simple framework UI ERP with Vaadin</a></li>
<li><a href="../318498/index.html">Liveedu.tv - streaming service for programmers and designers</a></li>
<li><a href="../318500/index.html">A fistful of relays. Part 3 - command decoder and control machine</a></li>
<li><a href="../318502/index.html">Intuitive programming</a></li>
<li><a href="../318504/index.html">Modern approach to garbage collection</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>