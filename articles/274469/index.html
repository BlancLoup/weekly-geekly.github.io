<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>BlackEnergy Trojan is used in cyber attacks on media and industrial facilities in Ukraine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="BlackEnergy is a family of malware that has been active since 2007. In 2014, the Trojan continued its activity and returned to a new modification ( 1 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>BlackEnergy Trojan is used in cyber attacks on media and industrial facilities in Ukraine</h1><div class="post__text post__text-html js-mediator-article">  BlackEnergy is a family of malware that has been active since 2007.  In 2014, the Trojan continued its activity and returned to a new modification ( <a href="http://habrahabr.ru/company/eset/blog/239001/">1</a> , <a href="http://habrahabr.ru/company/eset/blog/240345/">2</a> ).  BlackEnergy was also active in 2015 and was used by cybercriminals to attack users.  Our analysts have recorded a new activity of this trojan, which was used against the media companies of Ukraine and the power industry enterprises.  Using the Trojan, attackers delivered a special component KillDisk, specializing in the destruction of files on the disk, to the victims' computers. <br><br><img src="https://habrastorage.org/files/597/383/900/59738390016942d69250778431895911.jpeg"><br><br>  In addition to BlackEnergy, cybergroup has used another tool to gain access to infected systems.  It is an SSH backdoor.  We continue to monitor the activities of BlackEnergy and record the new features of this trojan.  For more information or to provide one, send us an email at threatintel@eset.com. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  After its launch in the system, the dropper of the BlackEnergy Lite modification allows the operator to check the infected system for compliance with the necessary criteria.  This allows attackers to determine the actual importance of the infected system.  A more precise and detailed mechanism of system infection by BlackEnergy can be found in our <a href="">presentation</a> Virus Bulletin and F-Secure <a href="https://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf">document</a> . <br><br>  BlackEnergy stores XML configuration data inside a dynamic payload DLL. <br><br><img src="https://habrastorage.org/files/5c7/655/161/5c76551615694c708076db54d2a2f1ca.png"><br>  Fig.  Sample BlackEnergy configuration data in 2015 <br><br>  In addition to the list of addresses of C &amp; C servers, the BlackEnergy configuration data contains the value of the build_id parameter.  The value of this parameter is a unique text string used to identify the bot-infected system.  The combination of letters and numbers used by cybercriminals can sometimes reveal information about a malicious campaign and its goals.  Below is a list of such identifiers that we observed in 2015. <br><br><ul><li>  2015en </li><li>  khm10 </li><li>  khelm </li><li>  2015telsmi </li><li>  2015ts </li><li>  2015stb </li><li>  kiev_o </li><li>  brd2015 </li><li>  11131526kbp </li><li>  02260517ee </li><li>  03150618aaa </li><li>  11131526trk </li></ul><br>  We can assume that some of the identifiers have a special meaning.  For example, the identifier string <i>2015telsmi</i> may include the abbreviation SMI (Mass Media), <i>2015en</i> may mean Energy (energy), and <i>kiev_o is</i> obvious Kiev. <br><br>  In 2014, some variants of the BlackEnergy trojan contained a plugin called <i>dstr</i> , designed to perform destructive actions on an infected system.  In 2015, the attackers began to use BlackEnergy for a new plugin to perform destructive actions in the system.  It is detected by ESET antivirus products like Win32 / KillDisk.NBB, Win32 / KillDisk.NBC, and Win32 / KillDisk.NBD.  The main task of this component is to corrupt files stored on disk: it overwrites documents with arbitrary data and disables the OS. <br><br>  The first known case of detection of the KillDisk component was <a href="http://cert.gov.ua/%3Fp%3D2370">documented</a> by the CERT-UA organization in November 2015. At the same time, a number of media outlets were subjected to cyber attacks during local elections in Ukraine in 2015. The report argues that the cyber attack resulted in the destruction of a large number of videos and other documents compromised computers. <br><br>  It should be noted that the Win32 / KillDisk.NBB module used against the media is primarily focused on the destruction of documents and other file types.  The malware file contains a long list of file extensions that it is trying to overwrite and delete.  The full list contains more than 4 thousand file extensions. <br><br><img src="https://habrastorage.org/files/54f/8d2/848/54f8d28488e7485a9e84c4834c3430e8.png"><br>  Fig.  Part of the list of file extensions that KillDisk.NBB is intended to destroy. <br><br>  The KillDisk component, which was used in cyber attacks on energy companies of Ukraine, is different from the previous plug-in (2014).  Our analysis of the samples showed that the main changes in the new module were as follows. <br><br><ul><li>  The new modification can take on the command line argument, which allows you to specify the delay time for the launch of the payload with a destructive function. </li><li>  Specializes in deleting the following Windows event logs: applications, security, installation, system. </li><li>  To a lesser extent, focused on the removal of documents: the list of extensions is limited to 35 elements. </li></ul><br><img src="https://habrastorage.org/files/6d2/6d5/861/6d26d5861c6341728398cac115982424.png"><br>  Fig.  The list of file extensions that a new modification of the KillDisk component aims to destroy. <br><br>  In addition to deleting user files, KillDisk specializes in corruption of system files, which leads to system malfunction and the impossibility of its subsequent download.  One of the KillDisk options, which was found in companies specializing in the supply of electricity, contains additional possibilities for sabotaging industrial systems.  After its launch in the system, such a modification of the KillDisk component searches for and terminates two non-standard processes with the following names: komut.exe and sec_service.exe. <br><br>  We could not find any information about the name of the first process (komut.exe).  The name of the second process may be related to software called ASEM Ubiquity.  It is a software platform that is often used in industrial control systems (ICS).  Another option is that it may refer to the ELTIMA Serial to Ethernet Connector.  In case of detection of activity in the system of these processes, the malicious program not only terminates them, but also overwrites their executable files with arbitrary data. <br><br>  In addition to the BlackEnergy component listed above, we discovered another sample of malware that was used by attackers in this campaign.  In the course of our research of one of the compromised servers, an application was discovered on it that seemed, at first glance, a legitimate SSH server called <a href="https://matt.ucc.asn.au/dropbear/dropbear.html">Dropbear SSH</a> . <br><br>  To start the SSH server, the attackers created a file on VBS with the following contents. <br><br><blockquote>  Set WshShell = CreateObject (‚ÄúWScript.Shell‚Äù) <br>  WshShell.CurrentDirectory = ‚ÄúC: \ WINDOWS \ TEMP \ Dropbear \‚Äù <br>  WshShell.Run ‚Äúdropbear.exe -r rsa -d dss -a -p 6789 ‚Ä≥, 0, false </blockquote><br>  As you can see, the SSH server is configured to accept connections to port number 6789. By launching such a server on a compromised network, attackers can return to it at any time when they need it.  However, for some reason, this is not enough for them.  The server executable also contains the backdoor code. <br><br><img src="https://habrastorage.org/files/2f9/1bf/1e7/2f91bf1e7954422d8b36b89b1f30bfb5.png"><br>  Fig.  Authentication function with hard-wired password in SSH North. <br><br>  As you can see in the screenshot above, this version of Dropbear SSH will successfully authenticate the user when they enter the fixed password ‚ÄúpassDs5Bu9Te7‚Äù.  The same applies to authentication by a pair of keys - the server file contains in its body a fixed public key and allows for successful login upon presentation of the private key. <br><br><img src="https://habrastorage.org/files/a56/84f/ee3/a5684fee35e64054aed67dd236da9a98.png"><br>  Fig.  Public RSA key in SSH server executable. <br><br>  ESET antivirus products detect this SSH server with backdoor functionality as Win32 / SSHBearDoor.A. <br><br>  <b>Indicators of compromise</b> <br><br>  IP addresses of BlackEnergy C &amp; C servers: <br><br>  5.149.254.114 <br>  5.9.32.230 <br>  31.210.111.154 <br>  88.198.25.92 <br>  146.0.74.7 <br>  188.40.8.72 <br><br>  Document ID of the SHA-1 XLS document with a malicious macro: <br><br>  AA67CA4FB712374F5301D1D2BAB0AC66107A4DF1 <br><br>  BlackEnergy Lite Dropper SHA-1 ID: <br><br>  4C424D5C8CFEDF8D2164B9F833F7C631F94C5A4C <br><br>  BlackEnergy Big Dropper's SHA-1 ID: <br><br>  896FCACFF6310BBE5335677E99E4C3D370F73D96 <br><br>  BlackEnergy Drivers SHA-1 Identifiers: <br><br>  069163E1FB606C6178E23066E0AC7B7F0E18506B <br>  0B4BE96ADA3B54453BD37130087618EA90168D72 <br>  1A716BF5532C13FA0DC407D00ACDC4A457FA87CD <br>  1A86F7EF10849DA7D36CA27D0C9B1D686768E177 <br>  1CBE4E22B034EE8EA8567E3F8EB9426B30D4AFFE <br>  20901CC767055F29CA3B676550164A66F85E2A42 <br>  2C1260FD5CEAEF3B5CB11D702EDC4CDD1610C2ED <br>  2D805BCA41AA0EB1FC7EC3BD944EFD7DBA686AE1 <br>  4BC2BBD1809C8B66EECD7C28AC319B948577DE7B <br>  502BD7662A553397BBDCFA27B585D740A20C49FC <br>  672F5F332A6303080D807200A7F258C8155C54AF <br>  84248BC0AC1F2F42A41CFFFA70B21B347DDC70E9 <br>  A427B264C1BD2712D1178912753BAC051A7A2F6C <br>  A9ACA6F541555619159640D3EBC570CDCDCE0A0D <br>  B0 excav77E002C510E7AB11B996A1CD8FE8FDADA0C <br>  BD87CF5B66E36506F1D6774FD40C2C92A196E278 <br>  BE319672A87D0DD1F055AD1221B6FFD8C226A6E2 <br>  C7E919622D6D8EA2491ED392A0F8457E4483EAE9 <br>  CD07036416B3A344A34F4571CE6A1DF3CBB5783F <br>  D91E6BB091551E773B3933BE5985F91711D6AC3B <br>  E1C2B28E6A35AEADB508C60A9D09AB7B1041AFB8 <br>  E40F0D402FDCBA6DD7467C1366D040B02A44628C <br>  E5A2204F085C07250DA07D71CB4E48769328D7DC <br><br>  KillDisk component SHA-1 identifier: <br><br>  16F44FAC7E8BC94ECCD7AD9692E6665EF540EEC4 <br>  8AD6F88C5813C2B4CD7ABAB1D6C056D95D6AC569 <br>  6D6BA221DA5B1AE1E910BBEAA07BD44AFF26A7C0 <br>  F3E41EB94C4D72A98CD743BBB02D248F510AD925 <br><br>  SHA-1 Trojan ID VBS / Agent.AD: <br><br>  72D0B326410E1D0705281FDE83CB7C33C67BC8CA <br><br>  Win32 / SSHBearDoor.A Trojan SHA-1 ID: <br><br>  166D71C63D0EB609C4F77499112965DB7D9A51BB </div><p>Source: <a href="https://habr.com/ru/post/274469/">https://habr.com/ru/post/274469/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274453/index.html">Black Hat USA 2015: the full story of the hacking of the very Jeep</a></li>
<li><a href="../274455/index.html">Creating a function on Rust that accepts a String or & str</a></li>
<li><a href="../274457/index.html">Defending Revel from CSRF attacks</a></li>
<li><a href="../274461/index.html">The tale of the compressor, which can be called, but I do not remember how</a></li>
<li><a href="../274463/index.html">We write DXE-driver for taking screenshots from BIOS Setup and other UEFI-applications</a></li>
<li><a href="../274471/index.html">Multiplication tables ... kind of</a></li>
<li><a href="../274473/index.html">Draw Elliptic Curves with SQL</a></li>
<li><a href="../274475/index.html">Rip network dictionaries using Node.js, part 1: static pages; CLI; DSL -> TXT, PDF, DjVu; related tasks</a></li>
<li><a href="../274477/index.html">Localization of WPF applications and instant culture change</a></li>
<li><a href="../274479/index.html">Yii2 bad behaviors</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>