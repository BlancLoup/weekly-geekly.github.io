<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I implemented graphQL for InterSystems platforms</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About GraphQL and how to use it has already been discussed in this article . Here I will tell you about what tasks faced me, and about the results tha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I implemented graphQL for InterSystems platforms</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/getpro/habr/post_images/f8a/8f5/35c/f8a8f535c362014a6239d5d6a2b2fcdb.jpg"></p><br><p>  About <a href="http://graphql.org/">GraphQL</a> and how to use it has already been discussed in this <a href="https://habr.com/company/intersystems/blog/413717/">article</a> .  Here I will tell you about what tasks faced me, and about the results that were achieved in the implementation process of GraphQL for InterSystems platforms. </p><a name="habracut"></a><br><h2 id="o-chem-statya">  What is the article about? </h2><br><ul><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25B1%25D1%2581%25D1%2582%25D1%2580%25D0%25B0%25D0%25BA%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2581%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B0%25D0%25BA%25D1%2581%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B5_%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">AST</a> generation by GraphQL query and its validation </li><li>  Documentation generation </li><li>  <a href="https://ru.wikipedia.org/wiki/JSON">JSON</a> response generation </li></ul><br><p>  Let's look at the whole cycle from sending a request to receiving a response on a simple scheme: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/47c/331/dee/47c331dee521d5c1129dd46879586f43.jpg" alt="image"></div><br><p>  A client can send two types of requests to the server: </p><br><ul><li>  Request for receipt of the scheme. <br>  A schema is generated on the server and returned to the client, more on that later. </li><li>  Request to get / change a specific data set.  In this case, AST generation occurs, valation and response generation. </li></ul><br><h2 id="generaciya-ast">  AST generation </h2><br><p>  The first task that needed to be solved is the parsing of the received GraphQL query.  Initially, I wanted to find an external library, send a request to it and get an AST.  But he decided to abandon this idea for several reasons.  This is another black box, and no one has yet canceled a long callback. </p><br><p>  So I came to the conclusion that you need to implement your own parser, but where can you get its description from?  It turned out to be simpler here, <a href="http://facebook.github.io/graphql/October2016/">GraphQL</a> is an open source project, with Facebook it is pretty well described, and finding parsers in other languages ‚Äã‚Äãwas not difficult. </p><br><p>  Description AST can be found <a href="http://facebook.github.io/graphql/October2016/">here</a> . </p><br><p>  Let's look at an example query and tree: </p><br><pre><code class="hljs objectivec">{ Sample_Company(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>) { Name } }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">AST</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"Document"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">45</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Definitions"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"OperationDefinition"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">45</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Directives"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"VariableDefinitions"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Operation"</span></span>: <span class="hljs-string"><span class="hljs-string">"Query"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"SelectionSet"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"SelectionSet"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">45</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Selections"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"FieldSelection"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">44</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Value"</span></span>: <span class="hljs-string"><span class="hljs-string">"Sample_Company"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Alias"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Arguments"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"Argument"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">27</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">23</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Value"</span></span>: <span class="hljs-string"><span class="hljs-string">"id"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Value"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"ScalarValue"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">27</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"KindField"</span></span>: <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Value"</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span> } } ], <span class="hljs-attr"><span class="hljs-attr">"Directives"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"SelectionSet"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"SelectionSet"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">44</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Selections"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"FieldSelection"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Location"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Start"</span></span>: <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-attr"><span class="hljs-attr">"End"</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Value"</span></span>: <span class="hljs-string"><span class="hljs-string">"Name"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"Alias"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Arguments"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"Directives"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"SelectionSet"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ] } } ] } } ] }</code> </pre> </div></div><br><h2 id="validaciya">  Validation </h2><br><p>  After the resulting tree, you need to check for the existence of classes, properties, arguments and their types on the server, that is, the tree must be validated.  Recursively run through the tree and check for compliance of the above with the fact that the server.  This is what the <a href="">class</a> looks like. </p><br><h2 id="generaciya-shemy">  Schema generation </h2><br><p>  <strong>A schema</strong> is a documentation of the available classes, properties, and a description of the types of properties of these classes. </p><br><p>  In the implementation of GraphQL in other languages ‚Äã‚Äãor technologies, the scheme is generated by resolvers.  Resolver is a description of the types of data available on the server. </p><br><div class="spoiler">  <b class="spoiler_title">An example of resolvers, request and response</b> <div class="spoiler_text"><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Query</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">human</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ID</span></span></span><span class="hljs-class">!): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Human</span></span></span><span class="hljs-class"> } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Human</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">appearsIn</span></span></span><span class="hljs-class">: [</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Episode</span></span></span><span class="hljs-class">] </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">starships</span></span></span><span class="hljs-class">: [</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Starship</span></span></span><span class="hljs-class">] } enum </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Episode</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">NEWHOPE</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EMPIRE</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">JEDI</span></span></span><span class="hljs-class"> } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Starship</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> }</span></span></code> </pre> <br><pre> <code class="hljs pgsql">{ human(id: <span class="hljs-number"><span class="hljs-number">1002</span></span>) { <span class="hljs-type"><span class="hljs-type">name</span></span> appearsIn starships { <span class="hljs-type"><span class="hljs-type">name</span></span> } } }</code> </pre> <br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"human"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Han Solo"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"appearsIn"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"NEWHOPE"</span></span>, <span class="hljs-string"><span class="hljs-string">"EMPIRE"</span></span>, <span class="hljs-string"><span class="hljs-string">"JEDI"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"starships"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Millenium Falcon"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Imperial shuttle"</span></span> } ] } } }</code> </pre> </div></div><br><p>  But in order to generate a schema, you need to understand its structure, find some description, or better examples.  The first thing I did was try to find an example that would make the circuit structure clear.  Since GitHub has its own <a href="https://developer.github.com/v4/explorer/">GraphQL API</a> , it‚Äôs easy to get a scheme from there.  But here we faced another problem, there is such a large server part that the scheme takes up as much as 64 thousand lines.  I didn‚Äôt really want to understand this, I began to look for other ways to get a scheme. </p><br><p>  Since the basis of our platforms is a DBMS, then in the next step I decided to build and run GraphQL for PostgreSQL and SQLite myself.  With PostgreSQL, I received a scheme of only 22 thousand lines, and SQLite 18 thousand lines.  This is better, but it is also not enough, I began to look further. </p><br><p>  I stopped at the implementation for NodeJS, <a href="https://graphql.org/graphql-js/">assembled</a> , wrote a minimal resolver and got a scheme of only 1800 lines - this is much better! </p><br><p>  Having understood the scheme, I decided to generate it automatically without first creating resolvers on the server, since it is very easy to get meta-information about the classes and their relation to each other. </p><br><p>  To generate your scheme you need to understand a few things: </p><br><ul><li>  There is no need to generate it from scratch, you can take the scheme from NodeJS, remove all unnecessary from there and add everything I need. </li><li>  At the root of the schema there is a <strong>queryType</strong> type, its <strong>name</strong> field needs to be initialized with some value.  The remaining two types do not interest us, since at the moment they are at the implementation stage. </li><li>  All available classes and their properties must be added to the <strong>types</strong> array. <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"__schema"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"queryType"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Query"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"mutationType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"types"</span></span>:[... ], <span class="hljs-attr"><span class="hljs-attr">"directives"</span></span>:[... ] } } }</code> </pre> </li><li>  First, you need to describe the root element of the <strong>Query</strong> , and in the <strong>fields</strong> array add all the classes, their arguments and the types of these classes.  This way they will be accessible from the root element. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Consider the example of two classes, Example_City and Example_Country</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"OBJECT"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Query"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The query root of InterSystems GraphQL interface."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fields"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Example_City"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"args"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"id"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"ID of the object"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCALAR"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"defaultValue"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCALAR"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"String"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"defaultValue"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"LIST"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ofType"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"OBJECT"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Example_City"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"isDeprecated"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"deprecationReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Example_Country"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"args"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"id"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"ID of the object"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCALAR"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"defaultValue"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCALAR"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"String"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"defaultValue"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"LIST"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ofType"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"OBJECT"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Example_Country"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"isDeprecated"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"deprecationReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"inputFields"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interfaces"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"enumValues"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"possibleTypes"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }</code> </pre> </div></div><br><ul><li>  Secondly, we rise to the level above and add <strong>types</strong> to <strong>types</strong> that have already been described in the <strong>Query</strong> object with all the properties, types, and relations to other classes. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Description of the classes themselves</b> <div class="spoiler_text"><pre> <code class="hljs cs">{ <span class="hljs-string"><span class="hljs-string">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"OBJECT"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Example_City"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"fields"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"id"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"ID of the object"</span></span>, <span class="hljs-string"><span class="hljs-string">"args"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"type"</span></span>: { <span class="hljs-string"><span class="hljs-string">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCALAR"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, <span class="hljs-string"><span class="hljs-string">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-string"><span class="hljs-string">"isDeprecated"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"deprecationReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Country"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"args"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"type"</span></span>: { <span class="hljs-string"><span class="hljs-string">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"OBJECT"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Example_Country"</span></span>, <span class="hljs-string"><span class="hljs-string">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-string"><span class="hljs-string">"isDeprecated"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"deprecationReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"args"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"type"</span></span>: { <span class="hljs-string"><span class="hljs-string">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCALAR"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"String"</span></span>, <span class="hljs-string"><span class="hljs-string">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-string"><span class="hljs-string">"isDeprecated"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"deprecationReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ], <span class="hljs-string"><span class="hljs-string">"inputFields"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"interfaces"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"enumValues"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"possibleTypes"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, { <span class="hljs-string"><span class="hljs-string">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"OBJECT"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Example_Country"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"fields"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"id"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"ID of the object"</span></span>, <span class="hljs-string"><span class="hljs-string">"args"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"type"</span></span>: { <span class="hljs-string"><span class="hljs-string">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCALAR"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"ID"</span></span>, <span class="hljs-string"><span class="hljs-string">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-string"><span class="hljs-string">"isDeprecated"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"deprecationReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"City"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"args"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"type"</span></span>: { <span class="hljs-string"><span class="hljs-string">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"LIST"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"ofType"</span></span>: { <span class="hljs-string"><span class="hljs-string">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"OBJECT"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Example_City"</span></span>, <span class="hljs-string"><span class="hljs-string">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } }, <span class="hljs-string"><span class="hljs-string">"isDeprecated"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"deprecationReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"args"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"type"</span></span>: { <span class="hljs-string"><span class="hljs-string">"kind"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCALAR"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"String"</span></span>, <span class="hljs-string"><span class="hljs-string">"ofType"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-string"><span class="hljs-string">"isDeprecated"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"deprecationReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ], <span class="hljs-string"><span class="hljs-string">"inputFields"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"interfaces"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"enumValues"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"possibleTypes"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }</code> </pre> </div></div><br><ul><li>  Thirdly, all popular scalar <strong>types are</strong> already described in types, like int, string, etc., we add our scalar types to the same place. </li></ul><br><h2 id="generaciya-otveta">  Answer generation </h2><br><p>  So we got to the most difficult and interesting part.  On request, somehow you need to generate a response.  At the same time, the answer must be in json format and correspond to the structure of the request. </p><br><p>  For each new GraphQL query, a class should be generated on the server, in which the logic for obtaining the requested data will be described.  In this case, the request is not considered new if the values ‚Äã‚Äãof the arguments have changed, i.e.  if we get some data set in Moscow, and in the next query in London, the new class will not be generated, just the new values ‚Äã‚Äãwill be substituted.  Finally, in this class there will be a SQL query, after its execution the resulting data set will be saved in JSON format, the structure of which will correspond to the GraphQL query. </p><br><div class="spoiler">  <b class="spoiler_title">Sample query and generated class</b> <div class="spoiler_text"><pre> <code class="hljs objectivec">{ Sample_Company(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>) { Name } }</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> gqlcq.qsmytrXzYZmD4dvgwVIIA [ <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> ProcedureBlock ] { ClassMethod <span class="hljs-keyword"><span class="hljs-keyword">Execute</span></span>(arg1) <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> %DynamicObject { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> result = {"data":{}} <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> query1 = [] #SQLCOMPILE <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>=ODBC &amp;<span class="hljs-keyword"><span class="hljs-keyword">sql</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> C1 <span class="hljs-keyword"><span class="hljs-keyword">CURSOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> :f1 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Sample.Company <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> id= :arg1 ) &amp;<span class="hljs-keyword"><span class="hljs-keyword">sql</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">OPEN</span></span> C1) &amp;<span class="hljs-keyword"><span class="hljs-keyword">sql</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">FETCH</span></span> C1) <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> (SQLCODE = <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> query1.%Push({"Name":(f1)}) &amp;<span class="hljs-keyword"><span class="hljs-keyword">sql</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">FETCH</span></span> C1) } &amp;<span class="hljs-keyword"><span class="hljs-keyword">sql</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">CLOSE</span></span> C1) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> result.data."Sample_Company" = query1 quit result } ClassMethod IsUpToDate() <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> %<span class="hljs-type"><span class="hljs-type">Boolean</span></span> { quit:$$<span class="ruby"><span class="ruby">$comClassKeyGet(</span><span class="hljs-string"><span class="ruby"><span class="hljs-string">"Sample.Company"</span></span></span><span class="ruby">,$$</span></span>$cCLASShash)<span class="hljs-string"><span class="hljs-string">'="3B5DBWmwgoE" $$$NO quit $$$YES } }</span></span></code> </pre> </div></div><br><p>  How this process looks on the diagram: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f0f/bd3/e71/f0fbd3e711eaa68e9012d9d2604a40c6.jpg" alt="image"></div><br><p>  At the moment, the answer is generated by the following requests: </p><br><ul><li>  Basic </li><li>  Nested objects <br><ul><li>  Only <strong>many to one</strong> relationship </li></ul></li><li>  Sheet of simple types </li><li>  Sheet of objects </li></ul><br><p>  Below I give a diagram of what types of relationships still need to be implemented: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/1d2/e33/415/1d2e33415987434a4d4e46dfb1e97ffb.jpg"></p><br><h2 id="podvedem-itogi">  Let's sum up </h2><br><ul><li>  <strong>Answer</strong> - at the moment you can get a nested data set for not too complex queries. </li><li>  <strong>Auto-generated scheme</strong> - the scheme is generated by the stored classes available to the client, and not by predefined resolvers. </li><li>  <strong>A full-featured parser</strong> - the parser is fully implemented, you can get a tree on request absolutely any complexity. </li></ul><br><p>  ‚Üí <a href="https://github.com/intersystems-community/GraphQL">Link</a> to project repository <br>  ‚Üí <a href="http://37.139.6.217:57773/graphiql/index.html">Link</a> to demo server </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/358720/">https://habr.com/ru/post/358720/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358710/index.html">Q & A Explorer. April feature for Power BI Desktop</a></li>
<li><a href="../358712/index.html">7 common mistakes in English that we make when communicating with foreigners</a></li>
<li><a href="../358714/index.html">Two types of PHP extensions. Zend extension VS PHP module</a></li>
<li><a href="../358716/index.html">Documentation Support in ASP.NET Web API</a></li>
<li><a href="../358718/index.html">‚ÄúDig‚Äù into the user using in-depth interviews</a></li>
<li><a href="../358722/index.html">Welcome to .Net mitap in Raiffeisenbank UPD Broadcast</a></li>
<li><a href="../358724/index.html">Experience in building an integration platform based on ServiceMix (Camel) and RabbitMQ</a></li>
<li><a href="../358726/index.html">The devil is not so bad as it is described, or how I passed the CISSP exam</a></li>
<li><a href="../358728/index.html">‚ÄúAccording to the GDPR‚Äù: how do social networks change their privacy policies and how they work with PD</a></li>
<li><a href="../358730/index.html">IT Relocation. Review of the pros and cons of living in Bangkok a year later</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>