<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Centralized logging from network equipment consoles via ssh</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are recommended, generally accepted means of collecting logs of network equipment - SNMP, syslog, and others like them. Usually they work fine, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Centralized logging from network equipment consoles via ssh</h1><div class="post__text post__text-html js-mediator-article">  There are recommended, generally accepted means of collecting logs of network equipment - SNMP, syslog, and others like them.  Usually they work fine, but at times something more is needed. <br><a name="habracut"></a><br>  Imagine the following scenario: a kind of network piece of iron disappears from the network on level ground, and reappears in a few minutes.  ‚ÄúShow version‚Äù indicates a reboot caused by a crash, which may be due to thousands of reasons in hundreds of OS components.  The crashinfo file is missing.  Syslog server did not receive any messages from the device just before the crash.  The device is covered by a service contract - but TAC cannot reproduce the accident in itself, and the information transmitted by the client is too small to determine the exact cause of the accident.  It is not even clear whether the crash was caused by software or hardware failure.  You can replace the device, but it does not help if the cause is software.  Switch to another OS version?  And which one?  After all, it is not known what bug caused the crash and whether it is closed in the new version - and there may be new bugs.  In the process of communication, the TAC employee mentions that just before the crash, when the network had already failed, the device probably sent a message to the console with information about which subsystem had fallen and therefore.  Of course, you already have a <a href="http://habrahabr.ru/post/112033/">terminal server</a> , but it is used only for emergency access to the device, and it ignores all messages arriving from the console port of the monitored piece of hardware.  We must somehow collect these messages.  This is what we will do. <br><br>  A little note.  Everything that is proposed below is considered only as an addition to traditional monitoring tools (primarily, regular SNMP / syslog on devices) and is intended to simplify the investigation of the causes of accidents (well, at the same time, to automatically collect the reload log).  And I would like to hope that the data collected in this way will never be useful. <br><br>  We take as the basis the article " <a href="http://habrahabr.ru/post/112033/">Terminal server based on Cisco router</a> ".  There are correct first steps.  However, the issue of actually logging messages is not considered there.  Well, to connect using telnet, which, of course, is unacceptable.  You can consider this article a continuation of that. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      SSH client and part-time log collector will be a separate server on * NIX.  In my case - Centos 6th line. <br>  To begin with, we consider access to the terminal server itself.  A regular Linux client ssh does not know how to automatically enter a password when called from a script (if you prefer, it costs you in a very ugly way), but we don‚Äôt need it. <br><br>  1) We update the router, working as a terminal server, to the 15th IOS version (with support for the ‚ÄúSSHv2 Enhancements for RSA Keys‚Äù feature - for the IOS router platforms, at first glance, all the software with k9 15 lines supports this feature) <br>  2) Create an RSA key pair for SSH sessions on the server.  We ignore the ‚ÄúEnter passphrase‚Äù request and press enter. <br><pre><code class="hljs vbscript">[root@centos ~]# ssh-keygen Generating <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> rsa key pair. Enter file <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> which <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> save the key (/root/.ssh/id_rsa): Enter passphrase (<span class="hljs-literal"><span class="hljs-literal">empty</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> no passphrase): Enter same passphrase again: Your identification has been saved <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /root/.ssh/id_rsa. Your <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> key has been saved <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /root/.ssh/id_rsa.pub. The key fingerprint <span class="hljs-keyword"><span class="hljs-keyword">is</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>d:<span class="hljs-number"><span class="hljs-number">60</span></span>:fe:<span class="hljs-number"><span class="hljs-number">72</span></span>:b5:<span class="hljs-number"><span class="hljs-number">8</span></span>c:<span class="hljs-number"><span class="hljs-number">1</span></span>e:b5:<span class="hljs-number"><span class="hljs-number">5</span></span>e:d1:<span class="hljs-number"><span class="hljs-number">3</span></span>c:<span class="hljs-number"><span class="hljs-number">9</span></span>c:<span class="hljs-number"><span class="hljs-number">67</span></span>:<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">9</span></span>c:<span class="hljs-number"><span class="hljs-number">59</span></span> root@centos The key<span class="hljs-comment"><span class="hljs-comment">'s randomart image is: +--[ RSA 2048]----+ | o ..E| | o . .*o| | . . o .+=| | o * o oo| | S * + . | | + o . | | . . | | | | | +-----------------+</span></span></code> </pre> <br><br>  3) Take the public key RSA. <br><pre> <code class="hljs ruby">[root@centos ~]<span class="hljs-comment"><span class="hljs-comment"># cat /root/.ssh/id_rsa.pub ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA0w2L4YVD/V303ccFatgtJxcS+JMYlPkmyufW36fUCogGjzWLbtMZGYoAW8vgy bVgN6r7lcbrbpF6oW9beGfHIWTBfUT898sUQL9jOOki0qvUWzkbej/po6agAK3KK/Z7QCtnAkbDQDb1SzHEmTx9rmboY EZosHOchQy+dvHEoBKCOMBrGKpYgdHfImjctKS3Q02TrkTO0+BoIFc2V32R9AukWFp7+ppGy2ZdoxLv5eEjlhcHukbM yKg9Kjc72/dPNbNkvLXcWKVnkebTmTJIQQyGU2qsAy2asgPC6D02gy6tZAdqp+0umEF2gLXlq2G1p3kn+AojH8bWvYBwyL2s6Q== root</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@centos</span></span></span></span></code> </pre> <br>  4) If the router is not configured by SSHv2 server, then fix this annoying misunderstanding in the standard way. <br>  5) Copy the server's public key to the router.  Important: the line is long, so you will need to copy it in parts, in 2-3 steps, pressing enter between the pieces and make sure each time that all the characters fit. <br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">termserver</span></span>(config)#ip ssh pubkey-chain !   ,        termserver(conf-ssh-pubkey)#username consoleuser termserver(conf-ssh-pubkey-user)#key-string termserver(conf-ssh-pubkey-<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">)# ssh-rsa </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AAAAB3NzaC1yc2EAAAABIwAAAQE</span></span></span><span class="hljs-class">‚Ä¶ termserver(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conf</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ssh</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pubkey</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">)#...</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BwyL2s6Q</span></span></span><span class="hljs-class">== root@centos !    id_rsa.pub         termserver(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conf</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ssh</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pubkey</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">)#exit !      ,      termserver(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conf</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ssh</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pubkey</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class">)#exit termserver(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conf</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ssh</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pubkey</span></span></span><span class="hljs-class">)#</span></span></code> </pre> <br><br>  Check if RSA authentication works: <br><pre> <code class="hljs css"><span class="hljs-selector-attr"><span class="hljs-selector-attr">[root@centos ~]</span></span># <span class="hljs-selector-tag"><span class="hljs-selector-tag">ssh</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">consoleuser</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">10</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">10</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">10</span></span> termserver&gt;</code> </pre> <br><br>  Now you need to check whether you can connect to the console port.  First, we allow ssh on all lines (by blocking telnet at the same time, if it was open).  On my terminal server, the numbering is from 1/0 to 1/15: <br><pre> <code class="hljs lisp">termserver(<span class="hljs-name"><span class="hljs-name">config</span></span>)# line <span class="hljs-number"><span class="hljs-number">1/0</span></span> <span class="hljs-number"><span class="hljs-number">1/15</span></span> termserver(<span class="hljs-name"><span class="hljs-name">config-line</span></span>)# transport input ssh</code> </pre> <br>  Now the connection itself.  From the second column ‚Äúshow line‚Äù we find out the line number (let it be 75) and do: <br><pre> <code class="hljs css"><span class="hljs-selector-attr"><span class="hljs-selector-attr">[root@centos ~]</span></span># <span class="hljs-selector-tag"><span class="hljs-selector-tag">ssh</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">consoleuser</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:75</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">10</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">10</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">10</span></span></code> </pre> <br>  Click enter again and see: <br><pre> <code class="hljs">Username:</code> </pre> <br>  And it has already sent the device whose console is connected to the 75th line of the terminal server.  We authenticate to check: <br><pre> <code class="hljs pgsql">Username: <span class="hljs-keyword"><span class="hljs-keyword">admin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Password</span></span>: router1&gt; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> router1 con0 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> now available Press <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> started.</code> </pre> <br><br>  Great, ssh access to the console is there.  It remains to configure sending logs to the console on the monitored equipment.  There is a nuance.  Many do "no logging console", and in general it makes sense.  We can not allow the console to be overloaded with messages, and they can interfere.  However, this is not suitable for our purposes.  Because the first thing on both sides: <br><pre> <code class="hljs lisp">router1(<span class="hljs-name"><span class="hljs-name">config</span></span>)# line console <span class="hljs-number"><span class="hljs-number">0</span></span> router1(<span class="hljs-name"><span class="hljs-name">config-line</span></span>)#speed <span class="hljs-number"><span class="hljs-number">115200</span></span></code> </pre> <br><pre> <code class="hljs lisp">termserver(<span class="hljs-name"><span class="hljs-name">config</span></span>)# line <span class="hljs-number"><span class="hljs-number">1/0</span></span> <span class="hljs-number"><span class="hljs-number">1/15</span></span> termserver(<span class="hljs-name"><span class="hljs-name">config-line</span></span>)#speed <span class="hljs-number"><span class="hljs-number">115200</span></span></code> </pre> <br><br>  In this case, 115200 is set. This is a fairly reliable value from experience (and a damn fast compared to the native 9600), but you still need to check that when receiving large blocks of text, there are no krakozyabry. <br><br>  Next, you need to determine what level of recording to send to the console with the logging console X command, where X is a number from 1 to 7. It is absolutely impossible to include "6" and "7", there are only informational messages (most often useless), which can be many (especially on ‚Äú7‚Äù - this is the debag level, which should be written only to the buffered.) ‚Äú5‚Äù and ‚Äú4‚Äù - usually suits, but it is necessary to analyze how many messages with such a level go into the buffer.  For example, "% ASA-4-106023" are messages about blocking packets on ASA firewalls, which can be extremely many, and we do not need to drive them to the console.  It may make sense to change the facility of individual syslog messages on the device itself.  We are certainly interested in collecting any messages from the facility from 1 to 3, and the rise / fall events of the interfaces do not interfere (although if we are talking about a switch with hundreds of ports, this is questionable).  In general, there is a field for thought. <br><br>  There may be several terminal servers, each with dozens of lines.  Yes, and any router without HWIC-16A is a terminal server on one port (AUX).  Now we have already configured access to consoles via ssh and sending logs to the console, but there is no record of events.  We are starting to write scripts, and such that adding a new console is a simple and pleasant affair. <br><br>  To begin with, we will write a script that will parse the list of hosts and lines, starting connections.  Let it be called startcon.sh <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash #   .       ,          syslog,   . LOGFOLDER="/root/logs/" #      LIST="/root/collectconsole/consolelist.txt" #     ssh LOCATION="/root/collectconsole" #      ¬´75,10.10.0.1,termserver¬ª,    ‚Äì ,  ‚Äì   ,   ‚Äì     ‚Äì      .         ,        ,    for i in $(cat $LIST | egrep -o "[0-9]{1,3},([0-9]{1,3}\.){3}[0-9]{1,3},[a-zA-Z0-9\-]+") ; do #          connectcon.sh ‚Äì ,      . ARGS="$(echo $i | cut -f 1 -d ",") $(echo $i | cut -f 2 -d ",")" #        if ! ps ax | grep -v grep | grep "connectcon.sh $ARGS" &gt; /dev/null ; then $LOCATION/connectcon.sh $ARGS &gt;&gt; $LOGFOLDER$(echo $i | cut -f 3 -d ",").log &amp; fi Done</span></span></code> </pre> <br><br>  Create a consolelist.txt with the line numbers (the second column from the ‚Äúshow line‚Äù of the terminal server), the addresses of the terminal servers and the names of the devices connected to these lines: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">nano</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">consolelist</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.txt</span></span> 66,10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">router1</span></span> 70,10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">router2</span></span> 71,10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">router3</span></span> 74,10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">router4</span></span> 67,10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">router5</span></span> 72,10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">router6</span></span> 75,10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">router7</span></span> 76,10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">router8</span></span> 79,10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">router9</span></span></code> </pre> <br><br>  Create a connectcon.sh script.  Not everything is simple with him.  Initially, I tried to make it an ordinary bash script that invokes ssh.  But as it turned out, ssh, being run in the background, refuses to redirect everything heard to the file.  A solution was found.  First you need to install the expect interpreter ‚Äî for centos, this is ‚Äúyum install expect‚Äù.  Then create a script: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/expect ‚Äìf # ,      ‚Äì      .        . set timeout -1 # ,    . set line [lrange $argv 0 0] set ipaddr [lrange $argv 1 1] #  ssh.  ,    .        ‚Äì  . ..  . ¬´expect timeout¬ª      ,      ,      ssh     ‚Äì   ,  2 . while { true } { spawn ssh consoleuser:$line@$ipaddr expect timeout sleep 120 }</span></span></code> </pre> <br><br>  As you know, multiple connections can not simultaneously use the same console.  And what if you need to go to the console port yourself and perform any actions?  The solution is simple: you need to go into the normal session of the terminal server and podlit the desired line. <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">termserver</span></span><span class="hljs-selector-id"><span class="hljs-selector-id">#clear</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">line</span></span> 75 <span class="hljs-selector-attr"><span class="hljs-selector-attr">[confirm]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[OK]</span></span></code> </pre> <br>  By this we beat the logging server from the terminal server.  The ‚Äúsleep 120‚Äù command in the script will give us 2 minutes to log in by ourselves.  And the logger will continue to knock on the door every 2 minutes until we leave. <br><br>  Everything.  Start startcon.sh: <br><pre> <code class="hljs ruby">[root@centos collectconsole]<span class="hljs-comment"><span class="hljs-comment"># ./startcon.sh [root</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@centos</span></span></span><span class="hljs-comment"> collectconsole]#</span></span></code> </pre> <br><br>  We look at the processes: <br><pre> <code class="hljs kotlin">[<span class="hljs-symbol"><span class="hljs-symbol">root@</span></span>centos collectconsole]# ps -ef | grep -E <span class="hljs-string"><span class="hljs-string">"connectcon|ssh"</span></span> ‚Ä¶ root <span class="hljs-number"><span class="hljs-number">23151</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> /usr/bin/<span class="hljs-keyword"><span class="hljs-keyword">expect</span></span> -f /root/collectconsole/connectcon.sh <span class="hljs-number"><span class="hljs-number">66</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23152</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> /usr/bin/<span class="hljs-keyword"><span class="hljs-keyword">expect</span></span> -f /root/collectconsole/connectcon.sh <span class="hljs-number"><span class="hljs-number">70</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23153</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> /usr/bin/<span class="hljs-keyword"><span class="hljs-keyword">expect</span></span> -f /root/collectconsole/connectcon.sh <span class="hljs-number"><span class="hljs-number">71</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23154</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> /usr/bin/<span class="hljs-keyword"><span class="hljs-keyword">expect</span></span> -f /root/collectconsole/connectcon.sh <span class="hljs-number"><span class="hljs-number">74</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23155</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> /usr/bin/<span class="hljs-keyword"><span class="hljs-keyword">expect</span></span> -f /root/collectconsole/connectcon.sh <span class="hljs-number"><span class="hljs-number">67</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23156</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> /usr/bin/<span class="hljs-keyword"><span class="hljs-keyword">expect</span></span> -f /root/collectconsole/connectcon.sh <span class="hljs-number"><span class="hljs-number">72</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23157</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> /usr/bin/<span class="hljs-keyword"><span class="hljs-keyword">expect</span></span> -f /root/collectconsole/connectcon.sh <span class="hljs-number"><span class="hljs-number">75</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23158</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> /usr/bin/<span class="hljs-keyword"><span class="hljs-keyword">expect</span></span> -f /root/collectconsole/connectcon.sh <span class="hljs-number"><span class="hljs-number">76</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23159</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> /usr/bin/<span class="hljs-keyword"><span class="hljs-keyword">expect</span></span> -f /root/collectconsole/connectcon.sh <span class="hljs-number"><span class="hljs-number">79</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23239</span></span> <span class="hljs-number"><span class="hljs-number">23155</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ssh consoleuser:<span class="hljs-number"><span class="hljs-number">67</span></span>@<span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23240</span></span> <span class="hljs-number"><span class="hljs-number">23156</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ssh consoleuser:<span class="hljs-number"><span class="hljs-number">72</span></span>@<span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23242</span></span> <span class="hljs-number"><span class="hljs-number">23158</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ssh consoleuser:<span class="hljs-number"><span class="hljs-number">76</span></span>@<span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23243</span></span> <span class="hljs-number"><span class="hljs-number">23159</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ssh consoleuser:<span class="hljs-number"><span class="hljs-number">79</span></span>@<span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23244</span></span> <span class="hljs-number"><span class="hljs-number">23153</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ssh consoleuser:<span class="hljs-number"><span class="hljs-number">71</span></span>@<span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23247</span></span> <span class="hljs-number"><span class="hljs-number">23152</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ssh consoleuser:<span class="hljs-number"><span class="hljs-number">70</span></span>@<span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23248</span></span> <span class="hljs-number"><span class="hljs-number">23154</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ssh consoleuser:<span class="hljs-number"><span class="hljs-number">74</span></span>@<span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23255</span></span> <span class="hljs-number"><span class="hljs-number">23151</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> pts/<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ssh consoleuser:<span class="hljs-number"><span class="hljs-number">66</span></span>@<span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 root <span class="hljs-number"><span class="hljs-number">23341</span></span> <span class="hljs-number"><span class="hljs-number">23157</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span> pts/<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ssh consoleuser:<span class="hljs-number"><span class="hljs-number">75</span></span>@<span class="hljs-number"><span class="hljs-number">10.10</span></span>.0.10 ‚Ä¶</code> </pre> <br>  We are looking at the log repository (router4 has already recorded something, the rest are still silent): <br><pre> <code class="hljs mel">[root@centos collectconsole]# <span class="hljs-keyword"><span class="hljs-keyword">ls</span></span> -l /root/logs/ -rw-r--r-- <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">58</span></span> Sep <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> router1.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> -rw-r--r-- <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">58</span></span> Sep <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> router2.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> -rw-r--r-- <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">58</span></span> Sep <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> router3.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> -rw-r--r-- <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">115</span></span> Sep <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">57</span></span> router4.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> -rw-r--r-- <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">58</span></span> Sep <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> router5.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> -rw-r--r-- <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">58</span></span> Sep <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> router6.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> -rw-r--r-- <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">58</span></span> Sep <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> router7.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> -rw-r--r-- <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">58</span></span> Sep <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> router8.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> -rw-r--r-- <span class="hljs-number"><span class="hljs-number">1</span></span> root root <span class="hljs-number"><span class="hljs-number">58</span></span> Sep <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span> router9.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span></code> </pre> <br><br>  We look at a terminal server: <br><pre> <code class="hljs pgsql">termserver#sh <span class="hljs-type"><span class="hljs-type">line</span></span> Tty <span class="hljs-type"><span class="hljs-type">Line</span></span> Typ Tx/Rx A Modem Roty AccO AccI Uses Noise Overruns <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> CTY - - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> AUX <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - * <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - * <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">67</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">68</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">69</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - * <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">70</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - * <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">71</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - * <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">72</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">73</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - * <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">74</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - * <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">75</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - <span class="hljs-number"><span class="hljs-number">1</span></span> - - <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> - * <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">76</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">77</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">78</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - * <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">79</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">81</span></span> TTY <span class="hljs-number"><span class="hljs-number">115200</span></span>/<span class="hljs-number"><span class="hljs-number">115200</span></span>- - - - - <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> -</code> </pre> <br><br>  The lines indicated in the configuration file are occupied (marked with asterisks).  Great, the scripts work. <br><br>  Now to start the startcon.sh script.  You can put it in init.d and / or cron.daily (then the nodes added to the list will start being written the next day or after the system restart).  And - the problem is solved. <br><br>  It remains to note a few important points. <br>  1) It makes sense to restrict the rights of the account used for these purposes by means of the Secure ACS server.  He should be able to login, but nothing else.  And he should log in on a limited list of devices. <br>  2) To run scripts, it is better to create a separate account on a Linux machine.  Respectively, generate RSA keys under it and send them to the terminal server.  Yes, in this article I sat under the rue all the time, but everyone knows that this is not good.  And the location of the log repository is worth changing. <br>  3) Logrotate on Linux will allow log files not to reach astronomical sizes.  It is better to enable it for these files.  The archiving algorithm depends on the speed of filling files. <br>  4) It is necessary to strictly restrict access to log files. <br>  5) It is better to place the log collection server in relation to the terminal server so that the fall of any monitored piece of hardware does not break the connection between the collector and the terminal server for more than a few seconds.  And in general, build networks so that the failure of one device causes a network failure of not more than two or three seconds. <br>  6) Nothing prevents to use these scripts to record events of any devices connected to the terminal server - not only tsiskin devices. <br>  7) The terminal server can be any tsiskin router that has an AUX port.  The console port of the target piece of iron is connected to this port using a <a href="">rollover</a> cable.  And in the same way it is put on record by adding of one line to a config.  This is useful for small offices, where there are one router and a switch - you can monitor the switch. <br>  8) I have little experience in writing shell scripts, and in the proposed configuration you can certainly improve a lot.  I will be glad to any additions. </div><p>Source: <a href="https://habr.com/ru/post/152024/">https://habr.com/ru/post/152024/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../152013/index.html">Google Chrome vs File Downloader</a></li>
<li><a href="../152016/index.html">When a project has more than one founder</a></li>
<li><a href="../152018/index.html">Yandex is 15 years old!</a></li>
<li><a href="../152022/index.html">10 Windows Phone Applications for Administrators</a></li>
<li><a href="../152023/index.html">The Japanese have developed a new type of fuel hydrogen cells</a></li>
<li><a href="../152025/index.html">My "paradigm" of working with threads</a></li>
<li><a href="../152028/index.html">7,100 employees work on the Google Maps project.</a></li>
<li><a href="../152030/index.html">IPhone 5 Review - Habrahabr Edition</a></li>
<li><a href="../152031/index.html">A small review of the large computer Acer Predator</a></li>
<li><a href="../152034/index.html">IR remote for PC and sockets. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>