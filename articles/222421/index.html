<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Organizing OLAP Cube with Python Tools</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, dear readers. 
 Today I will tell you about how you can build a simple data analysis system in Python. This will help me framework cub...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Organizing OLAP Cube with Python Tools</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, dear readers. <br>  Today I will tell you about how you can build a simple data analysis system in Python.  This will help me framework <a href="http://cubes.databrewery.org/">cubes</a> and <a href="http://jjmontesl.github.io/cubesviewer/">cubesviewer</a> package. <br>  <strong>Subes</strong> is a framework for working with multidimensional data using Python.  In addition, it includes an OLAP HTTP server for simplified reporting application development and general data viewing. <br>  <strong>ubesviewer</strong> is a web-interface for working with the above server. <br><br><a name="habracut"></a><br><h3>  Install and configure cubes </h3><br>  First you need to install the libraries necessary for the package to work: <br><br><pre><code class="dos hljs">pip install pytz python-dateutil jsonschema pip install sqlalchemy flask</code> </pre> <br>  Next, install the <strong>cubes</strong> package itself: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="dos hljs">pip install cubes</code> </pre><br>  As practice has shown, it is better to use the version (1.0alpha2) from the current <a href="https://github.com/Stiivi/cubes">repository</a> . <br><br><h5>  Additional settings under windows </h5><br>  If you plan to work under Windows, in the <em>{PYTHON_DIR} \ Lib \ site-packages \ dateutil \ tz.py file,</em> replace the 40 line: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> myfunc(*args, **kwargs).encode()</code> </pre><br>  on <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> myfunc(*args, **kwargs)</code> </pre> <br>  Then, regardless of the platform you are working on, you need to add the following <a href="https://github.com/rgruebel/cubes/commit/4fb6b8e1d85a99bc7bdd4f88697ca6731503eee6">fix</a> for the json parser to work correctly.  You need to <em>add</em> it to <em>{PYTHON_DIR} \ Lib \ site-packages \ cubes-1.0alpha-py2.7.egg \ cubes \ metadata.py</em> starting from line 90: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> len(parts.scheme) == <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> os.path.isdir(source): <span class="hljs-comment"><span class="hljs-comment"># </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> same hack as in _json_from_url return read_model_metadata_bundle(source)</span></span></code> </pre><br><br><h3>  Description of the cube configuration and the process of its deployment </h3><br>  For example, take the OLAP-cube, which comes in delivery with <strong>cubes</strong> .  It is located in the <em>examples / hello_world folder</em> (you can take it from the repository). <br>  Of greatest interest to us are 2 files: <br><ul><li>  <strong>slicer.ini</strong> - http cube server settings file </li><li>  <strong>model.json</strong> - cube model description file </li></ul><br>  Let us dwell on them in more detail.  We start with the file <strong>slicer.ini</strong> , which may include the following sections: <br><ul><li>  <code>[workspace]</code> - configuration of the workplace </li><li>  <code>[server]</code> - server parameters (address, port, etc.) </li><li>  <code>[models]</code> - list of models to download </li><li>  <code>[datastore]  [store]</code> - data storage options </li><li>  <code>[translations]</code> - localization settings for the model. </li></ul><br>  So, we will analyze from our test file that the server will be located on the local machine and will work on port 5000.  The local SQLite database called data.sqlite will be used as storage. <br>  More information about configuring the server can be <a href="http://pythonhosted.org/cubes/configuration.html">found</a> in the documentation. <br>  Also from the file it is clear that the description of the model of our cube is in the <strong>model.json</strong> file, the description of the structure of which we will now deal with. <br>  The description file for the model is a <em>json</em> file that includes the following logical sections: <br><ul><li>  <code>name</code> - model name </li><li>  <code>label</code> - label </li><li>  <code>description</code> - description of the model </li><li>  <code>locale</code> - the locale for the model (if localization is specified) </li><li>  <code>cubes</code> - list of cubes metadata </li><li>  <code>dimensions</code> - a list of measurement metadata </li><li>  <code>public_dimensions</code> - list of available dimensions.  By default, all measurements are available. </li></ul><br>  We are interested in the sections <em>cubes</em> and <em>dimensions</em> , since  all others are optional. <br>  The <em>dimensions</em> list item contains the following metadata: <br><table><tbody><tr><th>  Key </th><th>  Description </th></tr><tr><td>  name </td><td>  measurement ID </td></tr><tr><td>  label </td><td>  Dimension name visible to user </td></tr><tr><td>  description </td><td>  measurement description for users </td></tr><tr><td>  levels </td><td>  List of measurement levels </td></tr><tr><td>  hierarchies </td><td>  Hierarchy list </td></tr><tr><td>  default_hierarchy_name </td><td>  Hierarchy ID </td></tr></tbody></table><br>  The <em>cubes</em> list item contains the following metadata: <br><table><tbody><tr><th>  Key </th><th>  Description </th></tr><tr><td>  name </td><td>  measurement ID </td></tr><tr><td>  label </td><td>  Dimension name visible to user </td></tr><tr><td>  description </td><td>  measurement description for users </td></tr><tr><td>  dimensions </td><td>  list of dimension names given above </td></tr><tr><td>  measures </td><td>  list of measures </td></tr><tr><td>  aggregates </td><td>  list of aggregation function measures </td></tr><tr><td>  mappings </td><td>  markup of logical and physical attributes </td></tr></tbody></table><br>  Based on the above, it can be understood that we will have 2 dimensions in the model ( <strong><em>item, year</em></strong> ).  The measurement <em>item has</em> 3 measurement levels: <br><ul><li>  <strong><em>category</em></strong> .  Display name "Category", fields <em>"category", "category_label"</em> </li><li>  <strong><em>subcategory</em></strong> .  Display name "Sub-category", fields <em>"subcategory", "subcategory_label"</em> </li><li>  <strong><em>line_item</em></strong> .  Display name "Line Item", field <em>"line_item"</em> </li></ul><br>  The <em>‚Äúamount‚Äù</em> field will act as a measure in our cube, for which the functions of the sum and counting the number of lines are performed. <br>  Read more about the markup of the cube model in the <a href="http://pythonhosted.org/cubes/model.html">documentation.</a> <br>  After we figured out the settings, we need to create our test database.  In order to do this, you need to run the <em>prepare_data.py</em> script: <br><br><pre> <code class="dos hljs">python prepare_data.py</code> </pre><br>  Now we just have to start our test server with a cube called <em>slicer</em> : <br><br><pre> <code class="dos hljs">slicer serve slicer.ini</code> </pre><br>  After that you can check the performance of our cube.  To do this, in the browser, you can enter: <br>  <em><a href="http://localhost/">localhost</a> : 5000 / cube / irbd_balance / aggregate? drilldown = year</em> <br>  In response, we will get a json object with the result of the aggregation of our data.  Read more about the server response format <a href="http://pythonhosted.org/cubes/server.html">here</a> . <br><br><h3>  Install cubesviewer </h3><br>  When we set up our cube, you can proceed with the installation of <strong>subesviewer</strong> .  To do this, copy the <a href="https://github.com/nonsleepr/cubesviewer">repository</a> to your disk: <br><br><pre> <code class="dos hljs">git clone https://github.com/nonsleepr/cubesviewer.git</code> </pre><br>  And then just move the contents of the <em>/ src</em> folder to the right place. <br>  It should be noted that <em>cubesviewer</em> is a Django application, so <strong>Django (not higher than version 1.4) is required for its operation</strong> , as well as the <strong>requests</strong> and <strong>django-piston</strong> packages.  Since  This version of Django is already out of date, then I gave a link above from where you can get a subview for Django version 1.6. <br>  Installing it is a little different from the original in that you need to add a line to the <code>[server]</code> section of the <code>[server]</code> configuration file <code>slicer.ini</code> <code><a href="http://localhost/"></a> allow_cors_origin: localhost:8000</code> <br>  After that, you need to <a href="">configure the</a> application in the file <em>{CUBESVIEWER_DIR} /web/cvapp/settings.py</em> .  By specifying the database settings, the address of the OLAP server (variable <code>CUBESVIEWER_CUBES_URL</code> ) and the address of the <code>CUBESVIEWER_BACKEND_URL</code> ( <code>CUBESVIEWER_BACKEND_URL</code> ) <br>  It remains to make a small <a href="https://bitbucket.org/spookylukey/django-piston/commits/40645e760ea2cb9a37d87c9352607b3fa7fac346">fix</a> in <em>dajno-piston</em> <br>  Now you can synchronize our application with the database.  To do this from <em>{CUBESVIEWER_DIR} / web / cvapp</em> you need to run: <br><br><pre> <code class="dos hljs">python manage.py syncdb</code> </pre> <br>  It remains to run the local server Django <br><br><pre> <code class="dos hljs">python manage.py runserver</code> </pre> <br>  Now it remains to enter the address specified in <code>CUBESVIEWER_BACKEND_URL</code> via the browser.  And enjoy the finished result. <br><img src="https://habrastorage.org/getpro/habr/post_images/3ad/9c8/e51/3ad9c8e51035f744f45ed0dd993aa7cd.png"><br><br><h3>  Conclusion </h3><br>  To illustrate the work, I took the simplest example.  It should be noted that for production projects <em>cubes</em> can be <a href="http://pythonhosted.org/cubes/deployment.html">deployed</a> for example on <a href="httpd.apache.org/">apache</a> or <a href="http://uwsgi-docs.readthedocs.org/en/latest/">uswgi</a> .  Well, it will not be difficult to connect <em>Subesviewer</em> to it using this article. <br>  If the topic is interesting to the community, then I will reveal it in one of the future articles. </div><p>Source: <a href="https://habr.com/ru/post/222421/">https://habr.com/ru/post/222421/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../222407/index.html">GPS Navigator in the flashlight</a></li>
<li><a href="../222411/index.html">Python Webmoney API</a></li>
<li><a href="../222415/index.html">ProfsoUX-2014 - videos and overview</a></li>
<li><a href="../222417/index.html">The near mainstream future</a></li>
<li><a href="../222419/index.html">Streaming Internet Video on LG Smart TV</a></li>
<li><a href="../222423/index.html">Using NAS servers in small companies and offices</a></li>
<li><a href="../222425/index.html">Leave a link to your profile - and add one habrazhitel to yourself</a></li>
<li><a href="../222427/index.html">Algorithm textbook translation</a></li>
<li><a href="../222429/index.html">It's time to show new</a></li>
<li><a href="../222431/index.html">Smartphones up to 5,000 rubles: tested in humans</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>