<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ORM in Android using ORMLite</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Currently, there are several solutions for the Android platform that allow implementing the ORM-approach for working with the database, but there are ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ORM in Android using ORMLite</h1><div class="post__text post__text-html js-mediator-article">  Currently, there are several solutions for the Android platform that allow implementing the ORM-approach for working with the database, but there are two main ones.  This is <a href="http://ormlite.com/">ORMLite</a> and <a href="http://greendao-orm.com/">GreenDAO</a> . <br><br>  For beginners, it is worth making a digression and telling what an ORM is.  <a href="http://ru.wikipedia.org/wiki/ORM">ORM</a> - object-ralational mapping.  Object-relational mapping means that it is much more convenient for a programmer to operate with objects that he uses in his application, rather than with tables that store data in <a href="http://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25BB%25D1%258F%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B1%25D0%25B0%25D0%25B7%25D0%25B0_%25D0%25B4%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D1%2585">relational databases</a> .  For the connection of relational DBMS with the object model of the application, ORM technologies are used.  So for solving the problems of object-relational mapping in Android use one of the third-party frameworks.  GreenDAO and ORMLite are open source libraries. <br><a name="habracut"></a><br><br><h5>  GreenDAO </h5><br>  A framework from German developers that they use in their applications. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  Benefits: </h6><br>  Does not use reflection ( <a href="http://ru.wikipedia.org/wiki/%25D0%259E%25D1%2582%25D1%2580%25D0%25B0%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_(%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">Reflection</a> ) to work <br>  Top Performance for Android ORM <br>  Minimum memory usage <br>  The small size of the library does not have a big impact on the Android project. <br><h6>  Disadvantages: </h6><br><ul><li>  There is no mechanism for transferring data when updating a schema. </li><li>  The impossibility of annotating classes, and the need to describe the algorithm for constructing new entities. </li></ul><br><br><h5>  ORMLite </h5><br>  A popular Java framework with an adapted version for Android. <br><br><h5>  Benefits: </h5><br><ul><li>  Powerful yet simple annotation </li><li>  Rich functionality </li><li>  Support for many databases, incl.  Sqlite </li><li>  Architecture in accordance with the KISS principle </li></ul><br><h6>  Disadvantages: </h6><br>  ... hmm ... I did not find them) everything that seems impossible, is realized with a deeper study of the docks. <br><br>  I use OrmLite in several projects and am familiar with it quite closely.  Therefore, just sit about it. <br><br><h4>  Simple annotation of classes </h4><br>  Each class mapping to the database (stored in the database) of which we want to do must be annotated.  ( <a href="http://ormlite.com/javadoc/ormlite-core/doc-files/ormlite_5.html">class-configuration</a> can be used, but this is a completely different story) It is worth noting that the class must have a constructor without arguments.  Annotation example: <br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@DatabaseTable</span></span>(tableName = <span class="hljs-string"><span class="hljs-string">"goals"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Goal</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String GOAL_NAME_FIELD_NAME = <span class="hljs-string"><span class="hljs-string">"name"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@DatabaseField</span></span>(generatedId = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Id; <span class="hljs-meta"><span class="hljs-meta">@DatabaseField</span></span>(canBeNull = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, dataType = DataType.STRING, columnName = GOAL_NAME_FIELD_NAME) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-meta"><span class="hljs-meta">@DatabaseField</span></span>(dataType = DataType.DATE) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Date lastEditDate; <span class="hljs-meta"><span class="hljs-meta">@DatabaseField</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String notes; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Goal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ scheduleList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;Shedule&gt;(); priorities = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;PrioritySchedule&gt;(); } }</code> </pre> <br><br>  The first annotation <code>@DatabaseTable(tableName = "goals")</code> indicates the name of the table where objects of this class will be mapped. <br>  Before each field there should be an annotation <code>@DatabaseField</code> with different arguments.  (you can also leave no arguments - everything will be set by default, and the name of the column in the table will be the same as the name of the field).  The name field has three arguments.  <code>canBeNull = false</code> means that this column cannot be empty in a table.  <code>dataType = DataType.STRING</code> column type to a <code>String</code> type.  (available types can be found <a href="http://ormlite.com/javadoc/ormlite-core/doc-files/ormlite_2.html">here</a> ).  <code>columnName = GOAL_NAME_FIELD_NAME</code> - enforcing the name of a column in a table will help us later when building select queries to retrieve data from the database. <br>  Any field can serve as the primary key - it is enough to specify <code>id = true</code> , but it is recommended to make the auto- <code>generatedId = true</code> id value and set it to <code>generatedId = true</code> .  ORMLite will assign it a unique number. <br>  For indexing a column in the database, <code>index = true</code> specified <code>index = true</code> <br>  A full description of all available annotation field arguments can be found <a href="http://ormlite.com/javadoc/ormlite-core/doc-files/ormlite_2.html">here.</a> <br>  Also, in addition to ORMLite annotations, you can use familiar annotations to some javax.persistence <br><br><h4>  Connect to SQLite in android </h4><br>  There are several ways to access database data using ORMLite on Android.  You can inherit each activity from ORMLiteBaseActivity and then we will not have to follow the life cycle of the database connection, but we will not be able to get access from other classes.  ( <a href="http://ormlite.com/javadoc/ormlite-core/doc-files/ormlite_7.html">see examples</a> ) <br>  Much more preferable is the approach discussed below. <br><br>  You need to create a class that will instantiate an assistant in creating and working with the database: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelperFactory</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> DatabaseHelper databaseHelper; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> DatabaseHelper </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHelper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> databaseHelper; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setHelper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span></span>{ databaseHelper = OpenHelperManager.getHelper(context, DatabaseHelper.class); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">releaseHelper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ OpenHelperManager.releaseHelper(); databaseHelper = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } }</code> </pre><br><br>  Appeal to it will occur during the beginning and end of the life of the application: <br>  This will prevent memory leaks due to an unclosed database connection. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyApplication</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(); HelperFactory.setHelper(getApplicationContext()); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTerminate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ HelperFactory.releaseHelper(); <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onTerminate(); } }</code> </pre><br><br>  Just do not forget to describe our class successor Application in the manifest: <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MyApplication"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/ic_launcher"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/app_name"</span></span></span><span class="hljs-tag"> &gt;</span></span></code> </pre><br><br>  Let's create the DataBaseHelper class, which will be responsible for creating the database and getting references to the DAO: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DatabaseHelper</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OrmLiteSqliteOpenHelper</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TAG = DatabaseHelper.class.getSimpleName(); <span class="hljs-comment"><span class="hljs-comment">//        /data/data/APPNAME/DATABASE_NAME.db private static final String DATABASE_NAME ="myappname.db"; //   ,            onUpgrade(); private static final int DATABASE_VERSION = 1; //  DAO  ,    private GoalDAO goalDao = null; private RoleDAO roleDao = null; public DatabaseHelper(Context context){ super(context,DATABASE_NAME, null, DATABASE_VERSION); } //,         @Override public void onCreate(SQLiteDatabase db, ConnectionSource connectionSource){ try { TableUtils.createTable(connectionSource, Goal.class); TableUtils.createTable(connectionSource, Role.class); } catch (SQLException e){ Log.e(TAG, "error creating DB " + DATABASE_NAME); throw new RuntimeException(e); } } //,        @Override public void onUpgrade(SQLiteDatabase db, ConnectionSource connectionSource, int oldVer, int newVer){ try{ //  ,         TableUtils.dropTable(connectionSource, Goal.class, true); TableUtils.dropTable(connectionSource, Role.class, true); onCreate(db, connectionSource); } catch (SQLException e){ Log.e(TAG,"error upgrading db "+DATABASE_NAME+"from ver "+oldVer); throw new RuntimeException(e); } } //  GoalDAO public GoalDAO getGoalDAO() throws SQLException{ if(goalDao == null){ goalDao = new GoalDAO(getConnectionSource(), Goal.class); } return goalDao; } /  RoleDAO public RoleDAO getRoleDAO() throws SQLException{ if(roleDao == null){ roleDao = new RoleDAO(getConnectionSource(), Role.class); } return roleDao; } //    @Override public void close(){ super.close(); goalDao = null; roleDao = null; } }</span></span></code> </pre><br><br>  As you can see in the example, you need to describe the creation of fields and tables, as well as to obtain a reference to a singleton with a DAO object.  Now consider the DAO itself. <br><br><h4>  DAO </h4><br>  The simplest implementation is the following class. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RoleDAO</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseDaoImpl</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Role</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Integer</span></span></span><span class="hljs-class">&gt;</span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RoleDAO</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ConnectionSource connectionSource, Class&lt;Role&gt; dataClass)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(connectionSource, dataClass); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;Role&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAllRoles</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.queryForAll(); } }</code> </pre><br><br>  Here, only one additional method is created to obtain a collection of all objects of the Role class. <br>  The main methods create, update, delete are implemented in the ancestor BaseDaoImpl. <br>  To access the RoleDao class method in any application class, it suffices to contact the factory class: <br> <code>RoleDAO roleDao = HelperFactory.GetHelper().getRoleDAO();</code> <br> <br><h4>  Creating queries </h4><br>  To build specific queries, you can create your own methods in the DAO class. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;Goal&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGoalByName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> SQLException</span></span>{ QueryBuilder&lt;Goal, String&gt; queryBuilder = queryBuilder(); queryBuilder.where().eq(Goal.GOAL_NAME_FIELD_NAME, <span class="hljs-string"><span class="hljs-string">"First goal"</span></span>); PreparedQuery&lt;Goal&gt; preparedQuery = queryBuilder.prepare(); List&lt;Goal&gt; goalList =query(preparedQuery); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> goalList; }</code> </pre><br><br>  As you can see, there was a search for objects with the corresponding name field. <br>  When building more complex queries, in addition to <code>eq</code> (which means equals) there are others like <code>gt</code> (greater), <code>ge</code> (greater and equals) and the rest corresponding to the standard where-clauses in SQL (see the full list <a href="http://ormlite.com/javadoc/ormlite-core/doc-files/ormlite_3.html">here</a> ) <br>  To build a complex query, you can add <code>and</code> : <br> <code>queryBuilder.where().eq(Goal.GOAL_NAME_FIELD_NAME, "First goal").and().eq(Goal.GOAL_NOTES_NAME_FIELD_NAME,‚Äùaaa‚Äù);</code> <br> <br>  Accordingly, in addition to queries from the database in this way, you can <a href="http://ormlite.com/javadoc/ormlite-core/doc-files/ormlite_3.html">delete and update tables</a> . <br><br><h4>  Work with nested entities </h4><br><br>  Consider the relationship of a lot to one.  Suppose a Goal object has a field pointing to Role. <br>  Accordingly, in the class Goal field must be annotated <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@DatabaseField</span></span>(foreign = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Role role; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setRole</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Role value)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.role = value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Role </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRole</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> role; }</code> </pre><br><br>  Now we can save our objects in the database <br><br><pre> <code class="java hljs"> Goal g = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Goal(); g.setName(‚Äúasd‚Äù); Role r = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Role(); g.setRole(r); HelperFactory.getHelper.getRoleDAO().create(r); HelperFactory.getHelper.getGoalDAO().create(g);</code> </pre><br><br>  To access an object of the Role class that is associated with an object of type Goal: <br><br><pre> <code class="java hljs"> Goal g = HelperFactory.getHelper.getRoleDAO().getGoalByName(‚Äúasd‚Äù); Role r = g.getRole(); HelperFactory.getHelper.getRolelDAO().refresh(g);</code> </pre><br><br>  <code>refresh()</code> must be performed so that r gets all the fields from the database corresponding to this object. <br><br>  When storing links to a collection, the approach is slightly different: <br><br>  in class Goal: <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@ForeignCollectionField</span></span>(eager = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Collection&lt;Role&gt; roleList; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addRole</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Role value)</span></span></span></span>{ value.setGoal(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); HelperFactory.GetHelper().getRoleDAO().create(value); roleList.add(value); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">removeRole</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Role value)</span></span></span></span>{ roleList.remove(value); HelperFactory.GetHelper().getRoleDAO().delete(value); }</code> </pre><br><br>  The argument in the <code>eager</code> annotation means that all the objects from the roleList will be obtained from the database along with the retrieval of a Goal object.  A reference to Goal in the Role object is required.  And you also need to separately save each of the Role objects using RoleDAO. <br>  Accordingly, in the class Role should be abstract: <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@DatabaseField</span></span>(foreign = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, foreignAutoRefresh = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Goal goal;</code> </pre><br><br>  If you do not set <code>eager=true</code> , then lazy-initialization will be performed, i.e.  when the Goal object is requested, the objects of the corresponding roleList collection will not be retrieved.  To extract them, you will need to iterate them: <br><br><pre> <code class="java hljs"> Iterator&lt;Role&gt; iter = state.goal.getRoleList().iterator(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (iter.hasNext()) { Role r = iter.next(); }</code> </pre><br><br>  <a href="http://ormlite.com/releases/">Link to the library</a> . <br>  <a href="http://ormlite.com/javadoc/ormlite-core/doc-files/ormlite_toc.html">Link to tutorials</a> . </div><p>Source: <a href="https://habr.com/ru/post/143431/">https://habr.com/ru/post/143431/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143424/index.html">IOS development as a lottery: 59% do not discourage costs</a></li>
<li><a href="../143426/index.html">Draw Something loses users, the cost of "Zing" falls</a></li>
<li><a href="../143427/index.html">Logitech Performance Mouse MX Mouse Review</a></li>
<li><a href="../143428/index.html">The most important decisions are non-technical.</a></li>
<li><a href="../143430/index.html">Create for the soul</a></li>
<li><a href="../143432/index.html">Apple intends to take the ultrabook market with lower prices for MacBook Air</a></li>
<li><a href="../143433/index.html">"The reverse side" of the Technology Forum 2012: how it works</a></li>
<li><a href="../143434/index.html">Sandbox with augmented reality from the University of California</a></li>
<li><a href="../143435/index.html">Lenovo will spend 800 million US dollars on the development of mobile devices</a></li>
<li><a href="../143436/index.html">The FBI wants to force Facebook, Skype, Google and others to leave backdoors in their products for surveillance and interception</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>