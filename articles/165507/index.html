<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Jailbreak for Windows RT</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After a little over 2 months, the long-awaited jailbreak for Windows RT appeared on the network. A vulnerability was found in the Windows kernel that ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Jailbreak for Windows RT</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/4d4/db6/388/4d4db6388c387db992770c9f6f1d40ca.jpg"><br>  After a little over 2 months, the long-awaited jailbreak for Windows RT appeared on the network.  A vulnerability was found in the Windows kernel that allows running unsigned desktop applications.  Unfortunately, this jailbreak is tied, because  after rebooting turns into a pumpkin. <br>  It's funny that the vulnerability was found on the desktop Windows 8, and from there already migrated to Windows RT.  Read more about this process <a href="http://surfsec.wordpress.com/2013/01/06/circumventing-windows-rts-code-integrity-mechanism/">here</a> . <br><a name="habracut"></a><br><h4>  Installation </h4><br>  The jailbreak process itself is non-trivial, you need a computer with Windows 8 and Visual Studio 2012. But the craftsman with XDA allowed you to do it right on the device. <br><ul><li>  <a href="http://forum.xda-developers.com/attachment.php%3Fattachmentid%3D1634373%26d%3D1357860166">Download the archive</a> and unzip it on your device. </li><li>  Run runExploit.bat </li><li>  Follow the onscreen instructions. </li><li>  When ‚ÄúPlease press VOLUME DOWN now.‚Äù Appears on the screen, press the volume down button. </li></ul><br><br>  Let me remind you that Windows RT is edited by Windows 8 for ARM devices, such as Microsoft Surface. <br><br><h4>  And how does all this actually work? </h4><br>  <i>The text below is a <s>free translation</s> retelling of <a href="http://surfsec.wordpress.com/2013/01/06/circumventing-windows-rts-code-integrity-mechanism/">Circumventing Windows RT's Code Integrity Mechanism</a> .</i>  <i>I omitted a lot of details, because this is a Friday post :)</i> <br><hr><br>  In the Windows kernel, the minimum required digital signature is set by a variable.  In Windows 8, its value is 0 (Unsigned), i.e.  Windows does not require a digital signature to run the application.  But on Windows RT its value is 8 (Microsoft).  The whole jailbreak is reduced to the banal reset of this variable.  It looks simple. <br>  In fact, it is very difficult to do, because  Windows Store applications can use only signed binaries, and from such an application it is impossible to get the security context necessary for attaching to other processes. <br>  But here, Microsoft went to the meeting and released a remote debugger for Windows RT, which perfectly clings to Desktop applications.  With it, you can cling to <br>  CSRSS process and directly change its memory.  The latter, in turn, calls the vulnerable function of the kernel (NtUserSetInformationThread). <br>  One of these calls (found in winsrv.dll): <br><pre><code class="cpp hljs">TerminalServerRequestThread+<span class="hljs-number"><span class="hljs-number">0x230</span></span> MOVS R3, #<span class="hljs-number"><span class="hljs-number">0xC</span></span> ADD R2, SP, #<span class="hljs-number"><span class="hljs-number">0x58</span></span> MOVS R1, #<span class="hljs-number"><span class="hljs-number">9</span></span> MOV R0, <span class="hljs-number"><span class="hljs-number">0xFFFFFFFE</span></span> BL NtUserSetInformationThread</code> </pre> <br>  Using breakpoint, we can change the structure at R2, just before calling NtUserSetInformationThread. <br>  The base address of the kernel is also required.  You can get it by calling NtQuerySystemInformation.  This function returns a list of all loaded drivers and their base address. <br>  Now it remains only to make an injection in winsrv.dll (use a half-empty page for this purpose with an offset of 0 √ó 10800) and after triggering the breakpoint, change the IP register to the beginning of our code. <br>  That's all :) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Conclusion </h4><br>  For those who still read to the end, I give a link to a <a href="http://forum.xda-developers.com/showthread.php%3Ft%3D2092348">post</a> with a collection of programs collected for ARM.  Notepad ++, 7-Zip and VNC client already exist. <br>  You can also collect software yourself, <a href="http://stackoverflow.com/questions/11151474/can-arm-desktop-programs-be-built-using-visual-studio-2012/12347035">read this</a> .  If you need static libraries that are not in the Windows SDK, then you can use <a href="http://forum.xda-developers.com/showthread.php%3Ft%3D2093899">this tool</a> . </div><p>Source: <a href="https://habr.com/ru/post/165507/">https://habr.com/ru/post/165507/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165491/index.html">Briefly about the new: Samsung introduced the first 8-core processor Exynos 5 Octa</a></li>
<li><a href="../165493/index.html">Serenji: IDE for M-technology</a></li>
<li><a href="../165497/index.html">Crossroads of seven roads, or the choice of the path for the programmer</a></li>
<li><a href="../165501/index.html">Wishing to leave the Earth. Mars One - information on the selection of the first colonists of Mars</a></li>
<li><a href="../165503/index.html">Solve 9 Windows Server 2008 management tasks using PowerShell. Part 2</a></li>
<li><a href="../165509/index.html">Eric Schmidt calls on North Korea to open access to the Internet</a></li>
<li><a href="../165511/index.html">The experience of obtaining a universal electronic card. Pink theory versus harsh reality. Part 1</a></li>
<li><a href="../165513/index.html">The digest of interesting news and materials from the world of PHP over the past two weeks, ‚Ññ8 (12.29.2012 - 01.01.2013)</a></li>
<li><a href="../165515/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ39 (January 5 - 11, 2013)</a></li>
<li><a href="../165517/index.html">Photoshop Scripting to automate the printing of large-circulation printing products</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>