<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Probabilistic Scala programming</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello dear readers. Today we are publishing an extraordinary translation - this will be a review article by brilliant Noel Welch on the principles of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Probabilistic Scala programming</h1><div class="post__text post__text-html js-mediator-article">  Hello dear readers.  Today we are publishing an extraordinary translation - this will be a review article by brilliant Noel Welch on the principles of probabilistic programming.  The article is published at the request of readers who ask our blog an ever higher bar - and this is definitely great! <br><a name="habracut"></a><br>  At the <a href="http://typelevel.org/event/2016-03-summit-philadelphia/">Typelevel Summit</a> conference in Philadelphia, I had the opportunity to make a report on probabilistic programming, which I have been <a href="https://github.com/noelwelsh/pfennig">interested in</a> for some time.  Probabilistic programming is at the junction of two smart research areas that blend well with each other - talking about functional programming and machine learning (more specifically, about Bayesian output).  In this article I will try to explain the key ideas of probabilistic programming.  I suppose that you, dear reader, are more a programmer than a statistician, but the numbers do not frighten you either.  Therefore, I will pay more attention to programming, and not machine learning. <br><br>  <b>Probabilistic models and inference</b> <br><br>  To understand probabilistic programming, you first need to understand probabilistic models and logical inference.  A probabilistic model describes how observable phenomena can depend on phenomena that we cannot observe.  It is usually assumed that such a relationship is not deterministic, therefore, the dependence between the observed and the unobservable obeys a certain probability distribution.  A model of this type is sometimes called generative. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Suppose a doctor is trying to make a diagnosis.  He observes various symptoms - for example, fever, rash, shortness of breath - on the basis of which can make an informed conjecture about what kind of disorder could cause such symptoms.  Of course, this process is imperfect.  Different diseases can cause very similar symptoms, as well as the symptoms of the same disease often differ, so this diagnostic model suggests some probabilistic distribution of results. <br><br>  Let's take a closer look at another example.  Suppose we want to sort documents on the topics covered in them - perhaps, to recommend people reading that they might like.  In this case, we can simulate this generative process: <br><br><ol><li>  Select multiple topics and assign weight categories to them; </li><li>  Each topic is characterized by its own distribution of words; </li><li>  Based on this distribution of words, we select specific words read on the page in proportion to the weight categories assigned to one or another topic. </li></ol><br>  A model of this type is called <a href="https://www.cs.princeton.edu/~blei/topicmodeling.html">thematic</a> and is widely used.  Some of the relatively unusual options for its use include the <a href="https://mimno.infosci.cornell.edu/info6150/readings/p1640-hu.pdf">classification of</a> Etsy's <a href="https://mimno.infosci.cornell.edu/info6150/readings/p1640-hu.pdf">aesthetic preferences</a> and an attempt to figure out <a href="https://mimno.infosci.cornell.edu/papers/pompeii.pdf">which rooms were used as one of the remaining houses in Pompeii</a> . <br><br>  I hope these brief examples are enough, and you grasped the idea of ‚Äã‚Äãprobabilistic models.  Many other generative processes can also be imagined - for example, the properties of a celestial body influence the form in which we observe it, the user's behavior online depends on his interests, and the activity of NGOs affects the health situation in the region where such an organization operates. . <br><br>  Generative models work well in cases where we have a priori knowledge about the structure of the world, and we can use them in building a model.  Working with them is very fun, because they allow you to create fictitious data, for example, <a href="https://pdos.csail.mit.edu/archive/scigen/">automatically generated scientific articles</a> - and thus confuse and amuse our colleagues. <br><br>  When we created a probabilistic model (and had a lot of fun with fake data), this model can be used for inference.  Inference is the process of ‚Äúrewinding a model.‚Äù  We are looking at the real data that we have been able to observe, and we are trying to guess how the situation that could not be viewed could look like.  For example, you can use the text of the document and try to find out what topic it is dedicated to, or collect astronomical data and try to determine which star systems are most likely to live.  Since we cannot judge with confidence the state of these unobservable elements of our model, we can construct a probability distribution of all possibilities.  Creating such a distribution is exactly what distinguishes Bayesian inference from alternatives ‚Äî for example, from the maximum likelihood method, which reveals only one state of unobservable properties. <br><br>  <b>Why do we need probabilistic programming</b> <br><br>  We briefly described generative models and the problem of Bayesian inference.  This area of ‚Äã‚Äãstatistics and machine learning has long been studied, and over time, researchers have noticed a number of points: <br><br><ul><li>  Build a generative model is pretty easy;  and </li><li>  all these models have the same structure;  but </li><li>  the inference algorithm for each particular model is written slowly, and usually errors occur. </li></ul><br>  How great it would be if one could make an inference algorithm based only on the model description.  The situation can be compared with programming in assembly language and in high-level language.  Using an assembler, we optimize everything manually, implement our own and control structures, etc., in the context of a specific problem facing us.  The same thing happens when creating a special logical inference algorithm for a specific generative model.  When programming in high-level language, we use ready-made constructs that the compiler itself translates into assembler.  Productivity increases significantly at the cost of a small decrease in machine productivity (which we often do not even notice).  The goal of probabilistic programming is exactly that. <br><br>  <b>Of course, this is a monad!</b> <br><br>  It seems that the goal of probabilistic programming is worthwhile and noble, but in order to achieve it, you first need to understand how to structure our generative models.  An experienced functionary programmer should not be surprised that for this we use the monad.  Now I will explain exactly how. <br><br>  Let's go back to the example of the generative model for creating a document.  To create a document, you need: <br><br><ol><li>  select multiple topics and their respective weight categories; </li><li>  each topic regulates the distribution of words; </li><li>  From such word distributions, we select specific words read on the page, in proportion to the weight categories corresponding to the topic. </li></ol><br>  You can annotate this model with types to show how the problem can be solved.  With the help of <code>Distribution[A]</code> present the distribution by type A. Now the document is generated as follows: <br><br><ul><li>  select some topics - this is how we can get <code>Distribution[Seq[Topic]]</code> (or just <code>Distribution[Topic]</code> for a simpler model). </li><li>  from each topic we get word distribution - this is the function of <code>Topic =&gt; Distribution[Words]</code> . </li><li>  From these word distributions we select specific words that we read on the page - extraction is done from <code>Distribution[Words]</code> . </li></ul><br>  (Here we are trying to balance simplicity and accuracy, so our model does not take into account the grammar or the number of words that make up the document. You may be able to supplement it, but if you get confused, get acquainted with my report, which presents a simpler and more complete example. ) <br><br>  The main part of this model is to connect <code>Distribution[Topic]</code> and <code>Topic =&gt; Distribution[Words]</code> to create <code>Distribution[Words]</code> from which to build a document.  By the way, what needs to be replaced <code>???</code>  so that the following identity is respected? <br><br><pre> <code class="scala hljs"><span class="hljs-type"><span class="hljs-type">Distribution</span></span>[<span class="hljs-type"><span class="hljs-type">Topic</span></span>] ??? <span class="hljs-type"><span class="hljs-type">Topic</span></span> =&gt; <span class="hljs-type"><span class="hljs-type">Distribution</span></span>[<span class="hljs-type"><span class="hljs-type">Words</span></span>] = <span class="hljs-type"><span class="hljs-type">Distribution</span></span>[<span class="hljs-type"><span class="hljs-type">Words</span></span>]</code> </pre> <br>  The answer is <code>flatMap</code> , that is, we have a monad.  (You can see for yourself that the laws of monads are also observed, however, in this case we need to define the semantics of <code>flatMap</code> . See below.) <br><br>  If you have ever worked with ScalaCheck or similar systems, it means that you used the monad of security. <br><br>  <b>Construction of logical inference algorithms</b> <br><br>  There are many ways to implement the probability monad.  If we are dealing only with discrete domains, then everything can be represented inside the domain as <code>List[(A, Probability)]</code> (where <code>Probability</code> can be a <code>Double</code> nickname) and calculate the results exactly.  In real-world applications, the benefits of this approach are small, since we will most likely have to deal with solid domains, either discrete, but still large.  Then the size of the presentation in each <code>flatMap</code> will grow exponentially.  An example implementation is shown <a href="https://github.com/noelwelsh/pfennig/blob/master/src/main/scala/pfennig/Enumeration.scala">here</a> . <br><br>  You can use a sample-based view.  This approach works with solid domains, and the user can create as many samples as they want - to achieve the desired accuracy.  However, this option is still imperfect.  Algorithms for logical inference have been studied for many years, this work is reminiscent of compiler optimization, and we would like to create a system that runs probabilistic mechanisms to analyze the structure of the program and apply the optimal algorithm for the obtained results.  Just like when working with a compiler, we express a probabilistic program in the form of an abstract syntax tree, which can then be manipulated by optimization algorithms. <br><br>  Now you can begin to build logical inference algorithms, and it is here that I‚Äôll get rid of explanations for two reasons: firstly, I believe that the reader is not a machine learning professional, and he will not be interested in discussing logical inference algorithms. second, which is actually more important - as long as it is the cutting edge of research.  In modern systems, generalized inference algorithms are implemented, which, however, are almost not adapted for problem-oriented optimizations.  The general principle, as with compilers, is this: the more information you save, the more you can optimize.  At the same time, most optimizations are useful only in a few programs.  In many respects, it remains an open question how much you can rely on generalized inference algorithms and on computational power to make such a conclusion fast enough, and how much it is worth zealous with complex mathematics to optimize specific cases. <br><br>  <b>Conclusion and further work</b> <br><br>  I am very excited about probabilistic programming, because, I believe, it allows you to radically simplify logical inference, and this will be useful in very many areas - I have already cited a few examples above.  In most subject areas, the issue of time is not so critical, so I am more interested in the study of generalized inference algorithms and parallel / distributed realizations, rather than complex mathematics.  However, I like to run into any things at first in practice, and therefore I am looking for people who need to solve real problems. <br><br>  In addition, probabilistic programming pretty much intersects with my interests in the field of machine learning and programming languages.  If you are interested - here is the <a href="https://www.youtube.com/watch%3Fv%3De1Ykk_CqKTY%26index%3D3%26list%3DPL_5uJkfWNxdkQd7FbN1whrTOsJPMgHgLg">report</a> , <a href="http://noelwelsh.com/assets/downloads/typelevel-summit-philly-2016.pdf">slides</a> , <a href="https://github.com/noelwelsh/pfennig">code</a> . </div><p>Source: <a href="https://habr.com/ru/post/322760/">https://habr.com/ru/post/322760/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322750/index.html">A brief algorithm for selecting a team for a startup</a></li>
<li><a href="../322752/index.html">What does the Landing Page structure consist of and how to write a marketing headline</a></li>
<li><a href="../322754/index.html">Restore data storage and VMFS partitions. Lifting the EMC iomega from that light ...</a></li>
<li><a href="../322756/index.html">Perfectionism. How to stop looking for spiders in a room and start living</a></li>
<li><a href="../322758/index.html">How we conduct interviews at Pivotal</a></li>
<li><a href="../322762/index.html">Simple steps to reduce the code after applying the strategy pattern using generic classes</a></li>
<li><a href="../322764/index.html">Backup & Recovery: in-line and smart deduplication, snapshots and secondary storage</a></li>
<li><a href="../322766/index.html">How programmers were entertained before programming</a></li>
<li><a href="../322768/index.html">How can online business arrange accepting payments in foreign currency for foreign customers?</a></li>
<li><a href="../322770/index.html">How neobanks develop abroad and in Russia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>