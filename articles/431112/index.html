<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to use least squares methods for resource assessment and monitoring of Oracle databases</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In daily activities, Oracle database administrators need to track a significant number of metrics in terms of bandwidth, load, growth of DBMS, DBMS ho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to use least squares methods for resource assessment and monitoring of Oracle databases</h1><div class="post__text post__text-html js-mediator-article"> In daily activities, Oracle database administrators need to track a significant number of metrics in terms of bandwidth, load, growth of DBMS, DBMS hosts, disk subsystems, etc.  All this data is carefully collected and stored by monitoring systems.  So that the information does not lie dead weight, it can be used for forecasting in terms of sizing issues and even proactive monitoring.  In this post we will demonstrate how to do it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/72c/f01/1bf/72cf011bfc922f999875aa9aa56e4678.png"><br><a name="habracut"></a><br>  Take the Oracle Cloud Control.  In the SYSMAN schema in the <code>MGMT_METRICS_1DAY</code> , we store the value of the metric ‚ÄúFilesystem Space Available (MB)‚Äù for a certain host with <code>TARGET_GUID = '6B1E3AFA92B3EA29AD73BB87432C084C'</code> . <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TO_CHAR (<span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span> (ROLLUP_TIMESTAMP <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-built_in"><span class="hljs-built_in">DATE</span></span>), <span class="hljs-string"><span class="hljs-string">'YYYY-MM-DD"T"HH24:MI:SS'</span></span>),        <span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>) AVG_FREE_SPACE_INM   <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SYSMAN.MGMT_METRICS_1DAY  <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TARGET_GUID = <span class="hljs-string"><span class="hljs-string">'6B1E3AFA92B3EA29AD73BB87432C084C'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> METRIC_GUID = HEXTORAW (<span class="hljs-string"><span class="hljs-string">'E8838C71E687BF0A9E02FFACC0C9AC80'</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> KEY_VALUE = <span class="hljs-string"><span class="hljs-string">'/u10'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ROLLUP_TIMESTAMP;</code> </pre><br>  The graph below shows that for three months, from August 14, 2018 to November 15, 2018, free space in the / u01 file system decreased by 1.5TB - from 4.1 TB to 2.6 TB 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/5a6/7e0/845/5a67e0845772e7c839e22085ad274d01.png"><br><br>  To determine the time for which we have enough of the remaining 2.6 TB, we turn to the functions of linear regression. <br><br>  In Oracle, the <code>REGR_SLOPE(x,y)</code> function is used to calculate the slope of the regression line.  The slope function of the regression line REGR_SLOPE is determined by the ratio of the covariance of the sets x and y to the variance of the set y: <br><br><pre> <code class="sql hljs">REGR_SLOPE(x,y) = COVAR_POP(x,y) / VAR_POP(y)</code> </pre> <br>  To calculate the interception of the Y axis, the function <code>REGR_INTERCEPT(x,y)</code> .  The intercept function of the Y axis <code>REGR_INTERCEPT</code> is determined by the difference in the mean value of the set x and the product of the slope of the regression line and the mean value of the set y: <br><br><pre> <code class="sql hljs">REGR_INTERCEPT(x,y) = AVG(x) ‚Äì REGR_SLOPE(x, y) * AVG(y)</code> </pre> <br>  To calculate the R-square or coefficient of determination, the function REGR_R2 (x, y) is used, which is not defined at zero variance y, is equal to one at zero variance x and non-zero dispersion y.  And in the case of a positive variance of x and a non-zero variance, y is equal to the square of the correlation of x and y: <br><br><pre> <code class="sql hljs">NULL if VAR_POP(y)  = 0 1 if VAR_POP(x)  = 0 and VAR_POP(y) != 0 POWER(CORR(expr1,expr),2) if VAR_POP(x)  &gt; 0 and VAR_POP(y)  != 0</code> </pre> <br>  We would describe the coefficient of determination as a value characterizing the percentage of the described variations by the model.  If the coefficient of determination is 1, then our model describes 100% of variations and our forecast will be as accurate as possible. <br><br>  We suggest to take as x the time difference in which the metric was obtained and the current time - ROLLUP_TIMESTAMP-SYSDATE.  As y, we take the average free disk space / u01 in MB - ‚ÄúFilesystem Space Available (MB)‚Äù.  In this case, using the REGR_INTERCEPT function (ROLLUP_TIMESTAMP-SYSDATE, VALUE_AVERAGE) as a group, we can estimate how many days the / u01 disk space runs out. <br><br>  In expanded form, the value of the function of the slope of the regression line, the interception of the axis and the coefficient of determination is obtained by the query: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (ROLLUP_TIMESTAMP - <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) / VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">REGR_SLOPE</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (ROLLUP_TIMESTAMP)- (<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))           <span class="hljs-keyword"><span class="hljs-keyword">REGR_INTERCEPT</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP)-(<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP,<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))      REGR_INTERCEPT_ABS,        <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) = <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-keyword"><span class="hljs-keyword">POWER</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">CORR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)),<span class="hljs-number"><span class="hljs-number">2</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">REGR_R2</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> MGMT_METRICS_1DAY  <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TARGET_GUID = <span class="hljs-string"><span class="hljs-string">'6B1E3AFA92B3EA29AD73BB87432C084C'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> METRIC_GUID = HEXTORAW (<span class="hljs-string"><span class="hljs-string">'E8838C71E687BF0A9E02FFACC0C9AC80'</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> KEY_VALUE = <span class="hljs-string"><span class="hljs-string">'/u10'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ROLLUP_TIMESTAMP;</code> SYSDATE - ROLLUP_TIMESTAMP, NULLIF (ROUND (VALUE_AVERAGE, <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (ROLLUP_TIMESTAMP - <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) / VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">REGR_SLOPE</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (ROLLUP_TIMESTAMP)- (<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))           <span class="hljs-keyword"><span class="hljs-keyword">REGR_INTERCEPT</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP)-(<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP,<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))      REGR_INTERCEPT_ABS,        <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) = <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-keyword"><span class="hljs-keyword">POWER</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">CORR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)),<span class="hljs-number"><span class="hljs-number">2</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">REGR_R2</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> MGMT_METRICS_1DAY  <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TARGET_GUID = <span class="hljs-string"><span class="hljs-string">'6B1E3AFA92B3EA29AD73BB87432C084C'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> METRIC_GUID = HEXTORAW (<span class="hljs-string"><span class="hljs-string">'E8838C71E687BF0A9E02FFACC0C9AC80'</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> KEY_VALUE = <span class="hljs-string"><span class="hljs-string">'/u10'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ROLLUP_TIMESTAMP;</code> (VALUE_AVERAGE, <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (ROLLUP_TIMESTAMP - <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) / VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">REGR_SLOPE</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (ROLLUP_TIMESTAMP)- (<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))           <span class="hljs-keyword"><span class="hljs-keyword">REGR_INTERCEPT</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP)-(<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP,<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))      REGR_INTERCEPT_ABS,        <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) = <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-keyword"><span class="hljs-keyword">POWER</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">CORR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)),<span class="hljs-number"><span class="hljs-number">2</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">REGR_R2</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> MGMT_METRICS_1DAY  <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TARGET_GUID = <span class="hljs-string"><span class="hljs-string">'6B1E3AFA92B3EA29AD73BB87432C084C'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> METRIC_GUID = HEXTORAW (<span class="hljs-string"><span class="hljs-string">'E8838C71E687BF0A9E02FFACC0C9AC80'</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> KEY_VALUE = <span class="hljs-string"><span class="hljs-string">'/u10'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ROLLUP_TIMESTAMP;</code> ROUND (VALUE_AVERAGE, <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (ROLLUP_TIMESTAMP - <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) / VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">REGR_SLOPE</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (ROLLUP_TIMESTAMP)- (<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))           <span class="hljs-keyword"><span class="hljs-keyword">REGR_INTERCEPT</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP)-(<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP,<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))      REGR_INTERCEPT_ABS,        <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) = <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-keyword"><span class="hljs-keyword">POWER</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">CORR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)),<span class="hljs-number"><span class="hljs-number">2</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">REGR_R2</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> MGMT_METRICS_1DAY  <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TARGET_GUID = <span class="hljs-string"><span class="hljs-string">'6B1E3AFA92B3EA29AD73BB87432C084C'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> METRIC_GUID = HEXTORAW (<span class="hljs-string"><span class="hljs-string">'E8838C71E687BF0A9E02FFACC0C9AC80'</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> KEY_VALUE = <span class="hljs-string"><span class="hljs-string">'/u10'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ROLLUP_TIMESTAMP;</code> COVAR_POP (SYSDATE - ROLLUP_TIMESTAMP, NULLIF (ROUND (VALUE_AVERAGE, <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (ROLLUP_TIMESTAMP - <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) / VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">REGR_SLOPE</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (ROLLUP_TIMESTAMP)- (<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))           <span class="hljs-keyword"><span class="hljs-keyword">REGR_INTERCEPT</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP)-(<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP,<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))      REGR_INTERCEPT_ABS,        <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) = <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-keyword"><span class="hljs-keyword">POWER</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">CORR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)),<span class="hljs-number"><span class="hljs-number">2</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">REGR_R2</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> MGMT_METRICS_1DAY  <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TARGET_GUID = <span class="hljs-string"><span class="hljs-string">'6B1E3AFA92B3EA29AD73BB87432C084C'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> METRIC_GUID = HEXTORAW (<span class="hljs-string"><span class="hljs-string">'E8838C71E687BF0A9E02FFACC0C9AC80'</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> KEY_VALUE = <span class="hljs-string"><span class="hljs-string">'/u10'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ROLLUP_TIMESTAMP;</code> (VALUE_AVERAGE, <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (ROLLUP_TIMESTAMP - <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) / VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">REGR_SLOPE</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (ROLLUP_TIMESTAMP)- (<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))           <span class="hljs-keyword"><span class="hljs-keyword">REGR_INTERCEPT</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP)-(<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP,<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))      REGR_INTERCEPT_ABS,        <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) = <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-keyword"><span class="hljs-keyword">POWER</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">CORR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)),<span class="hljs-number"><span class="hljs-number">2</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">REGR_R2</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> MGMT_METRICS_1DAY  <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TARGET_GUID = <span class="hljs-string"><span class="hljs-string">'6B1E3AFA92B3EA29AD73BB87432C084C'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> METRIC_GUID = HEXTORAW (<span class="hljs-string"><span class="hljs-string">'E8838C71E687BF0A9E02FFACC0C9AC80'</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> KEY_VALUE = <span class="hljs-string"><span class="hljs-string">'/u10'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ROLLUP_TIMESTAMP;</code> ROUND (VALUE_AVERAGE <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (ROLLUP_TIMESTAMP - <span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) / VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">REGR_SLOPE</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (ROLLUP_TIMESTAMP)- (<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>))           <span class="hljs-keyword"><span class="hljs-keyword">REGR_INTERCEPT</span></span>,        <span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP)-(<span class="hljs-keyword"><span class="hljs-keyword">COVAR_POP</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP,<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>))/VAR_POP(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))*<span class="hljs-keyword"><span class="hljs-keyword">AVG</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))      REGR_INTERCEPT_ABS,        <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) = <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span>     VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>                <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> VAR_POP (<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)) != <span class="hljs-number"><span class="hljs-number">0</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span>              <span class="hljs-keyword"><span class="hljs-keyword">POWER</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">CORR</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span> - ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span> (VALUE_AVERAGE, <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)),<span class="hljs-number"><span class="hljs-number">2</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">REGR_R2</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> MGMT_METRICS_1DAY  <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TARGET_GUID = <span class="hljs-string"><span class="hljs-string">'6B1E3AFA92B3EA29AD73BB87432C084C'</span></span>        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> METRIC_GUID = HEXTORAW (<span class="hljs-string"><span class="hljs-string">'E8838C71E687BF0A9E02FFACC0C9AC80'</span></span>)        <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> KEY_VALUE = <span class="hljs-string"><span class="hljs-string">'/u10'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ROLLUP_TIMESTAMP;</code> </pre> <br>  Or using the <code>REGR_SLOPE</code> , <code>REGR_INTERCEPT</code> and <code>REGR_R2</code> : <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REGR_SLOPE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>-ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)) RSLP,      <span class="hljs-keyword"><span class="hljs-keyword">REGR_INTERCEPT</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>-ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)) RINSP,       <span class="hljs-keyword"><span class="hljs-keyword">REGR_R2</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>-ROLLUP_TIMESTAMP, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)) RSQR      <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> MGMT_METRICS_1DAY      <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TARGET_GUID=<span class="hljs-string"><span class="hljs-string">'6B1E3AFA92B3EA29AD73BB87432C084C'</span></span>      <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> METRIC_GUID=HEXTORAW(<span class="hljs-string"><span class="hljs-string">'E8838C71E687BF0A9E02FFACC0C9AC80'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> KEY_VALUE=<span class="hljs-string"><span class="hljs-string">'/u10'</span></span>      <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ROLLUP_TIMESTAMP;</code> </pre> <br><pre> <code class="plaintext hljs">REGR_SLOPE = -0.00005 REGR_INTERCEPT = 149.46 REGR_R2 = 0.97</code> </pre> <br>  In our case, the coefficient of determination is close to 1, and we see that after about 149 days on the / u10 file system will end. <br><br>  We can use this method to estimate the time for which we have enough disk space for hosts of productive bases.  In our case, the hosts of the production databases are included in the group with <code>METRIC_GUID='E8838C71E687BF0A9E02FFACC0C9AC80'</code> . <br><br>  Create a <code>User Definded Type T_TYPE</code> with the fields we need for the output: host name, file system name, regression line slope, the number of days after which the space on the file system will end and the coefficient of determination. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> T_TYPE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OBJECT</span></span>(TARGET_NAME VARCHAR2(<span class="hljs-number"><span class="hljs-number">256</span></span>), KEY_VALUE VARCHAR2(<span class="hljs-number"><span class="hljs-number">256</span></span>), RSLP <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>,RINSP <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>,RSQR <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>);</code> </pre> <br>  Create a Nested Table Type R_TYPE based on T_TYPE: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> R_TYPE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> T_TYPE;</code> </pre> <br>  We create a package that includes the <code>GET_VALUES</code> function to extract data from <code>MGMT_METRICS_1DAY</code> and the procedure for sending the received data by mail <code>SEND_VALUES</code> . <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PACKAGE</span></span> EST_FS_EXHAUST <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span></code> </pre> <br>  For the <code>GET_VALUES</code> function <code>GET_VALUES</code> input parameters will be the <code>V_GN</code> variable with the name of the host group and the value of the coefficient of determination <code>V_RSQ</code> . <br><br><pre> <code class="sql hljs">FUNCTION GET_VALUES(V_GN VARCHAR2, V_RSQ NUMBER) RETURN R_TYPE;</code> </pre> <br>  For the <code>SEND_VALUES</code> procedure <code>SEND_VALUES</code> input parameters will be the <code>V_GN</code> and <code>V_RSQ</code> variables, similar to the <code>GET_VALUES</code> function <code>GET_VALUES</code> , plus an email, to which we plan to send our mini-report. <br><br><pre> <code class="sql hljs">PROCEDURE SEND_VALUES(V_GN VARCHAR2, V_RSQ NUMBER, V_MAIL VARCHAR2); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> EST_FS_EXHAUST;</code> </pre><br>  In the package body we define the function <code>GET_VALUES</code> and the procedure <code>SEND_VALUES</code> <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PACKAGE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BODY</span></span> EST_FS_EXHAUST <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> GET_VALUES(V_GN VARCHAR2, V_RSQ <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> R_TYPE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span>  V_REC R_TYPE; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> T_TYPE( M.TARGET_NAME, D.KEY_VALUE, <span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">REGR_SLOPE</span></span>(D.ROLLUP_TIMESTAMP-<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(D.VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)),<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">ABS</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">REGR_INTERCEPT</span></span>(D.ROLLUP_TIMESTAMP-<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(D.VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)))),<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">REGR_R2</span></span>(D.ROLLUP_TIMESTAMP-<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(D.VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)),<span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">BULK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COLLECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> V_REC <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> MGMT_METRICS_1DAY D, MGMT_TARGETS M, MGMT_TARGET_MEMBERSHIPS G <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> M.TARGET_GUID=G.MEMBER_TARGET_GUID <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> M.TARGET_GUID=D.TARGET_GUID <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> G.COMPOSITE_TARGET_NAME=V_GN <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> METRIC_GUID=HEXTORAW(<span class="hljs-string"><span class="hljs-string">'E8838C71E687BF0A9E02FFACC0C9AC80'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> M.TARGET_NAME, D.KEY_VALUE <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REGR_R2</span></span>(D.ROLLUP_TIMESTAMP-<span class="hljs-keyword"><span class="hljs-keyword">SYSDATE</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ROUND</span></span>(D.VALUE_AVERAGE,<span class="hljs-number"><span class="hljs-number">2</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>)) &gt; V_RSQ      ; RETURN V_REC; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> GET_VALUES; PROCEDURE SEND_VALUES(V_GN VARCHAR2, V_RSQ NUMBER, V_MAIL VARCHAR2) IS V_REC R_TYPE; MSG VARCHAR2(2048):=''; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> V_REC:= GET_VALUES(V_GN,V_RSQ); FOR I IN V_REC.FIRST..V_REC.LAST LOOP MSG:=CHR(10)||MSG||' Host '||V_REC(I).TARGET_NAME||' filesystem '||V_REC(I).KEY_VALUE||' will be exhausted in '||V_REC(I).RINSP||' days'|| CHR(9)||CHR(10); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOOP</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">EXECUTE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IMMEDIATE</span></span> <span class="hljs-string"><span class="hljs-string">'ALTER SESSION SET smtp_out_server = ''mail_server'''</span></span>; UTL_MAIL.SEND(SENDER =&gt; 'monitoring@yourmail.com',       RECIPIENTS =&gt; V_MAIL,          SUBJECT =&gt; 'Test Mail',          MESSAGE =&gt; MSG,        MIME_TYPE =&gt; 'text; charset=us-ascii'); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> EST_FS_EXHAUST; /</code> </pre><br>  Suppose we want to get the time after which the place in the file systems of the group of productive hosts 'prod_hosts' ends up with a determination coefficient greater than 0.5: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> EST_FS_EXHAUST.SEND_VALUES(<span class="hljs-string"><span class="hljs-string">'prod_hosts'</span></span>,<span class="hljs-number"><span class="hljs-number">0.5</span></span>,<span class="hljs-string"><span class="hljs-string">'operator@yourdomain.com'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; / PL/SQL procedure successfully completed.</code> </pre><br>  As a result, the message arrives in the mail: <br><br>  Host host1 filesystem / u51 will be exhausted in 342 days <br>  Host host2 filesystem / u40 will be exhausted in 236 days <br>  <b>Host host3 filesystem / u20 / redo01 will be exhausted in 1100310 days</b> <br>  Host host4 filesystem / u10 will be exhausted in 150 days <br>  Host host4 filesystem / u01 / integration will be exhausted in 75080 days <br>  Host host4 filesystem / u01 / app will be exhausted in 135 days <br>  <b>Host host5 filesystem / u30 / redo01 will be exhausted in 62252596 days</b> <br>  Host host6 filesystem / u01 will be exhausted in 260 days <br>  Host host7 filesystem / u99 will be exhausted in 1038 days <br><br>  Pay attention to the file systems / u20 / redo01 and / u30 / redo01 - here are the REDO LOGS and space is not spent.  Our model predicted that the place in / u20 / redo01 on host3 will end in 2990 years, and in / u30 / redo01 on host5 - in 169164 years.  In both cases, the regression line slope is less than ‚Äì1. <br><br>  The use of this method can be extended - for example, estimate the time until the place is exhausted in FAST RECOVERY AREA, in the tablespaces of the database and other areas. </div><p>Source: <a href="https://habr.com/ru/post/431112/">https://habr.com/ru/post/431112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../431102/index.html">How the physical address is displayed in rows and banks DRAM</a></li>
<li><a href="../431104/index.html">How we at Neoflex develop the expertise of DevOps</a></li>
<li><a href="../431106/index.html">How much money did Americans spend on this Black Friday, and what does smartphones mean?</a></li>
<li><a href="../431108/index.html">How to turn satellite images into maps. Computer vision in Yandex</a></li>
<li><a href="../431110/index.html">Stop feeding publishers. EU develops rules for compulsory free access to research</a></li>
<li><a href="../431114/index.html">Facebook for the first time closed access to some publications for Russian IP-addresses.</a></li>
<li><a href="../431116/index.html">Want strange: a review of the upcoming conference DartUP in St. Petersburg</a></li>
<li><a href="../431118/index.html">The whole truth about the RTOS. Article # 22. Mailboxes: ancillary services and data structures</a></li>
<li><a href="../431120/index.html">Suffering at work is not necessary</a></li>
<li><a href="../431122/index.html">Grafana as another tool for technical monitoring of the software products we create.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>