<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Portals of the Undead on Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, news and research about new malicious programs for the Android mobile operating system will surprise no one. But Google is taking certain steps...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Portals of the Undead on Android</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/736/89a/f83/73689af8399cd390220d1eebf020be1b.png"><br><br>  Today, news and research about new malicious programs for the Android mobile operating system will surprise no one.  But Google is taking certain steps to improve platform security (by the way, due to the accepted OS security model and the large fragmentation of OS versions, this is very difficult to do).  And this, in turn, forces virus writers to take new steps to spread their creations. <br>  In this article, I will look at the existing and already used malware distribution vectors for the Android OS.  If interested, then I ask under the cat. <br><br><a name="habracut"></a><h4>  Introduction </h4><br>  At first, the Android malware simply abused the functionality available to them: they received unique device identifiers, geolocation coordinates, received the highest priority SMS messages, etc. And then they sent all this to their creator. <br>  But today's latest news represents the entire RAT system (Remote Administration Tool), and some of them are already using the <a href="http://blogs.360.cn/360mobile/2014/01/17/oldboot-the-first-bootkit-on-android/">bootkit technology</a> to hide <a href="http://blogs.360.cn/360mobile/2014/01/17/oldboot-the-first-bootkit-on-android/">it</a> .  These programs no longer exist under the Android security model, and they are elevating their privileges in the system through various vulnerabilities.  After that, they are free to read / change data from other applications on the device, as well as system files - just like their fellow PCs.  It can be said that evolution follows the exact same route. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The natural step was the emergence of antivirus software right in the app distribution stores.  The logic of this step is clear - do not let users download malware.  So, in 2012 Google <a href="https://jon.oberheide.org/files/summercon12-bouncer.pdf">Bouncer</a> appeared on Google Play, and Yandex.Store, for example, has <a href="http://tech.yandex.ru/events/yac/2013/talks/1127/">its own</a> .  Another problem of the Android OS is the abundance of <a href="http://habrahabr.ru/post/164413/">various app stores</a> , through which both simply stolen apps and malicious functionality can be distributed.  The approach to the pre-moderation of all applications is different, and only two stores are well known that use automated scanning tools for malicious functionality.  But they, as you know, are bypassed if desired. <br><br><h4>  About mobile antivirus </h4><br>  You need to understand that mobile antiviruses work on devices also within the framework of the Android security model - they do not receive any individual privileges.  They work in their sandbox and can do with other applications and the system only what is provided for by the system and was allowed to them when they first started.  In such conditions, it is difficult to fight malware, but antivirus can help with epidemics. <br><br><h4>  Verify apps </h4><br>  A new feature " <a href="http://www.androidauthority.com/android-4-2-verify-apps-security-feature-explained-by-google-131514/">Verify apps</a> " appeared in Android 4.2.  It is primarily useful for applications that are not installed from Google Play.  So, with the option turned on, the system will warn you even before installation, if the application, in its opinion, has malicious functionality (perhaps this is behind the Google-bought service VirusTotal). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b44/c93/383/b44c93383c1f8bd7b951b6fded8099ce.png"><br><br><h4>  Portals </h4><br>  So let's move on to the malware distribution vectors.  I must say, this is my personal view on the current picture of events.  And if you have something to add here, then write in the comments. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6c6/7f3/11b/6c67f311b44d7f8be60b49b6e4cb8697.jpg"><br><br>  1) From the store. <br><br>  From the point of view of security, each Android store can be viewed according to two criteria: <br>  ‚Ä¢ The presence of built-in antivirus in the store; <br>  o However, do not take antivirus as a panacea. <br>  ‚Ä¢ Is it a ‚Äútrusted‚Äù source for your device: <br>  o If the store is provided in the firmware as trusted, then any other store for the firmware will be an ‚Äúuntrusted‚Äù source and requires the installation of a special tick in the settings.  As a rule, everyone wants to be the only app store on the device. <br><br>  1.1) The virus writer has posted his malware to the store, and the user has installed it. <br><br>  The most common scenario.  The attacker either simply spreads his application with malicious functionality, or embeds it in someone else‚Äôs and also uploads - naturally, after disguising his bad functionality with obfuscation, time delays, etc. Then the user himself agrees, accepts the conditions and installs the application.  Game over. <br><br>  1.2) The virus writer laid out the application, which then, over time, downloads the malicious code. <br><br>  You can even put in the store a good, non-malicious application, gain an audience, and then one day roll up the update and turn your users into an army of bots.  Game over. <br>  In this direction, I really liked the latest <a href="http://www.securityfocus.com/archive/1/531394/30/0/threaded">discovery by</a> researcher Daniel Divricean.  He found that the application with only 3 permissions: <br>  ‚Ä¢ android.permission.INTERNET - allows an application to open network sockets; <br>  ‚Ä¢ android.permission.GET_ACCOUNTS - gives access to the list of accounts in the Accounts Service; <br>  ‚Ä¢ android.permission.USE_CREDENTIALS - allows an application to request authtokens from AccountManager, - <br>  it is capable, without your knowledge, to install any applications, with any permissions (you can directly with everyone), on all devices linked to your account!  Game over. <br><br>  1.3) The virus writer bought / hacked a good application that already stands on millions of devices, and added malicious functionality to it with the update. <br><br>  This is not a fantasy of a madman, but a sad <a href="http://www.procontent.ru/news/27286.html">reality</a> .  I think that with time this vector will become more and more popular.  In this connection, the number of hacking / theft of developer accounts will increase.  Game over. <br><br>  2) From unknown sources. <br><br>  To install the application from an unknown source in the Android OS, a user simply needs to put one checkmark in the settings menu. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b49/bca/ed0/b49bcaed01a8b494fb5fc2a1f88bc741.png"><br><br>  2.1) The user himself put the application from somewhere. <br><br>  Why does the user do this?  Maybe 1000 and 1 reason, and consider them all stupid.  The attackers themselves, often with the help of social engineering, are forced to put their application supposedly for safe work with RBS or for free Internet access in cafes, etc. In general, this vector is limited only by the imagination of the attacker and the stupidity / ignorance of his victim.  Game over. <br><br>  2.2) Computer infected with a virus that puts mobile malware on the device. <br><br>  This <a href="http://android-help.ru/blog/2014/01/%25D0%25BD%25D0%25BE%25D0%25B2%25D1%258B%25D0%25B9-%25D0%25B2%25D0%25B8%25D1%2580%25D1%2583%25D1%2581-%25D0%25B7%25D0%25B0%25D1%2580%25D0%25B0%25D0%25B6%25D0%25B0%25D0%25B5%25D1%2582-%25D1%2583%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B9%25D1%2581%25D1%2582%25D0%25B2%25D0%25B0-android-%25D1%2587%25D0%25B5%25D1%2580/">vector is</a> also real and quite original.  True, of course, it has several conditions: permission to install from untrusted sources and permission to debug by ADB.  But at the same time, everything happens transparently for the victim.  Game over. <br><br>  3) Through vulnerability. <br><br>  No matter how surprising it looks, but Android leaves the possibility of the executable code getting from the side into your application and its execution there. <br>  If in iOS (without jailbreak) only Apple-signed code can be executed (ad-hoc applications are a separate story), then in Android you can receive code from your servers and execute it in the context of your application, while there is no default code signature. <br>  And it is often used: <br>  ‚Ä¢ Various advertising networks; <br>  ‚Ä¢ When updating the application (for example, when adding a new level to the game); <br>  ‚Ä¢ In the process of testing the application. <br><br>  3.1) Through code loading. <br><br>  To implement this scenario, the attacker needs a vulnerability leading to RCE and the possibility of conducting a MiTM attack. <br>  If with MiTM everything is quite clear and ordinary (data transfer in the open form or incorrect work with SSL), then we‚Äôll stop on Android RCE in Android.  This can be, for example, achieved in the following ways: <br>  ‚Ä¢ JavaScript Interface: <br>  o We have already discussed this in detail <a href="http://habrahabr.ru/company/dsec/blog/195788/">here</a> ; <br>  ‚Ä¢ Class loaders: <br>  o The attacker's code falls into DexClassLoader (); <br>  ‚Ä¢ Package context: <br>  o A vulnerable application can download and execute code from another application (owned by an attacker).  In this scenario, MiTM is not needed - the main thing is that our application should already have our application on the victim's device, which will help us to get into the context of the vulnerable without elevation of privileges. <br><br>  For example, this kind of unclosed (at the time of this writing) vulnerability in <a href="https://labs.mwrinfosecurity.com/advisories/2014/03/10/paypal-remote-code-execution/">PayPal</a> . <br>  For a deeper understanding of the nature of the problem and its scope, I advise you to refer to the study " <a href="http://cs.ucsb.edu/~yanick/publications/2014_ndss_android-remote-code-execution.pdf">Execute This! Analyzing Unsafe and Malicious Dynamic Code Loading in Android Applications</a> ".  Game over. <br><br>  3.2) Through the vulnerability of another application. <br><br>  Do not forget that in Android a very extensive set of mechanisms for IPC, which can lead to very <a href="http://www.androidpolice.com/2013/09/11/security-firefox-for-android-can-be-tricked-into-automatically-downloading-and-executing-malicious-code/">interesting</a> vulnerabilities.  Android OS itself has vulnerabilities that can be, for example, used by attackers for the <a href="http://thehackernews.com/2013/07/android-vulnerability-allows-hackers-to.html">hidden</a> distribution of the zoos of their monsters. <br><br>  4) Backdoor. <br>  Sadly, but true: in your device already with the purchase can be such a "gift".  How he got there (specifically / accidentally), by whom and for what it will be used, at the level of the built-in application, or OS, or firmware, is a separate story. <br>  Last bright example with <a href="http://redmine.replicant.us/projects/replicant/wiki/SamsungGalaxyBackdoor">Samsung</a> .  Game over. <br><br>  Thanks for attention! <br><br>  PS: For those who want to study mobile malware, I advise you to pay attention to these archives: <a href="http://contagiodump.blogspot.ru/2011/03/take-sample-leave-sample-mobile-malware.html">1</a> , <a href="http://www.mediafire.com/%3F78npy8h7h0g9y">2</a> . </div><p>Source: <a href="https://habr.com/ru/post/217715/">https://habr.com/ru/post/217715/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../217699/index.html">Yandex.Mail will allow you to unsubscribe from mailings</a></li>
<li><a href="../217701/index.html">"Sanctions" and science: 42% of elite Russian scientific journals belong to the USA</a></li>
<li><a href="../217705/index.html">Fujitsu Webinar "A New Level of Reliability for x86 Servers"</a></li>
<li><a href="../217709/index.html">Runet in pictures XIV. "Usurers without anything sacred" or the fastest growing segment of the Russian financial market</a></li>
<li><a href="../217713/index.html">[Poll] Mailing letters: service or server?</a></li>
<li><a href="../217717/index.html">I called to spend your time</a></li>
<li><a href="../217719/index.html">Managerial tools: need formula or how are we squeezed?</a></li>
<li><a href="../217725/index.html">COLT 2.0 released with support for Angular.js, node-webkit</a></li>
<li><a href="../217727/index.html">Starshade - search habitable planets</a></li>
<li><a href="../217729/index.html">FundingTo - fundraising by your rules</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>