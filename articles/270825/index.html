<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Component-oriented C # engine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Several times I came across articles about " component-oriented programming " on the Internet, the general idea of ‚Äã‚Äãwhich is to present each complex ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Component-oriented C # engine</h1><div class="post__text post__text-html js-mediator-article">  Several times I came across articles about " <i>component-oriented programming</i> " on the Internet, the general idea of ‚Äã‚Äãwhich is to present each complex object as a set of independent functional blocks - components. <br><br>  In theory, this sounds very interesting: all independent, small, complex objects are just different combinations of simpler ones.  Recently I decided to try to write a system that will work according to such laws, and everything turned out to be not so trivial.  For details, I invite under the cat. <br><a name="habracut"></a><br>  Probably, everyone knows the feeling when you want to share your decision with others and discuss it, get to know someone else's opinion, maybe help someone. <br><br>  While working on the project for personal learning purposes, I remembered the ‚Äúcomponent-oriented‚Äù approach, again I felt all its advantages and decided to seriously engage in the implementation, which seemed to me not quite trivial. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  What is this component orientation?  Objects are no longer in trend? </h4><br>  Imagine that any complex object of your system looks like a set of smaller ones, each of which is able to perform its and only its own task, but together this symphony of components generates exactly the behavior that is needed.  All that remains is to construct all the complex entities and run the application. <br><br>  This is probably why it says so loudly: " <i>component-oriented programming,</i> " because an object is already a collection not of data (fields) and behavior (methods), but components ‚Äî of other objects. <br><br>  <i>How did this idea seem attractive?</i> <br><br>  Firstly, any component solves one problem - here even without knowledge of the <b>Single Responsibility Principle</b> (SOLID) it is intuitively clear that this is good. <br><br>  Secondly, the components are independent of each other: everyone knows only what he does and what he needs for that.  Such a component is easy to maintain, modify, reuse and test. <br><br>  I may be a romantic, but these two positions were enough to plunge deep into thinking about how to implement such a decision. <br><br>  If we take as a basis the rule that every component attached to a container object must somehow influence the possible behavior of the latter, several problems arise: how does any client code, looking at this abstract container, learn about the set of components that are you? <br><br>  Another caveat: it is necessary to provide the possibility that one component will need to ‚Äúcommunicate‚Äù with another, if they are both located on the same container. <br><br><h4>  Let's start </h4><br>  Following the rules of common sense, it is necessary to try to describe as abstractly as possible the process of how each of the elements of the future system will work.  The simplest consequence is the selection of two abstract entities: <br><br><ul><li>  ‚Äú <i>component</i> ‚Äù is an abstract functional unit of the system; </li><li>  " <i>component container</i> " - an object that can store a set of components. </li></ul><br>  I really like any complex things to work on as simple and intuitive examples as possible, so let's try to present the very simple ‚ÄúPlayer‚Äù entity in the traditional object style: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Player</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Health; <span class="hljs-comment"><span class="hljs-comment">// . public int Mana; // . public int Strength; // . public int Agility; // . public int Intellect; // . public WeaponSlot WeaponSlot; //   . }</span></span></code> </pre> <br>  Now let me show you how I would like to see it all in the component style: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//      . public class Player : ComponentContainer { // -  ,   . } //   . public class BaseStats : Component { public int Health; // . public int Mana; // . } //    . public class CreatureStats : Component { public int Strength; // . public int Agility; // . public int Intellect; // . } //    . public class WeaponSlot : Component { public Weapon Weapon; // . }</span></span></code> </pre><br>  As you can see, none of the components have any idea about the others, nor about the player himself.  How then do we create it? <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//  -     . public Player CreatePlayer() { var player = new Player(); //  new ComponentContainer(); player.AddComponent&lt;BaseStats&gt;(); player.AddComponent&lt;CreatureStats&gt;(); player.AddComponent&lt;WeaponSlot&gt;(); return player; }</span></span></code> </pre><br>  If the effectiveness of the system design is manifested exactly when changes come, then with the current version we will have problems if we try to consider a more complex example: the player‚Äôs interaction with a non-game character (NPC). <br><br>  So, the context of the problem is as follows: at some point, the player <i>clicks</i> on the NPC model (or presses a button on the keyboard) and activates the dialog box call.  It is necessary to display all the tasks that are available to the player at the moment, taking into account the level restrictions. <br>  I will try to sketch a brief outline of how it will look like: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// ...    . // -    " " -  . var player = GetPlayer(); var questGiverNpc = GetQuestGiver(); var playerStats = player.GetComponent&lt;StatsComponent&gt;(); if (playerStats == null) return; //        ,     10. if (playerStats.Level &lt; 10) return; var questList = questGiverNpc.GetComponent&lt;QuestList&gt;(); if (questList == null) return; //     . var availableQuests = questList.Where(quest =&gt; quest.Level &gt;= playerStats.Level); // ... -    .</span></span></code> </pre><br>  As you can see, given that we do not know (and do not want to know) anything about the contents of the containers, the only way is to try to get the appropriate components.  Sometimes, such a decision is enough, but I wanted to go further and understand what else can be done with this and how to transform it in order to turn it into a very convenient model. <br><br>  First step: remove the interaction of container objects in a separate layer.  Thus, an abstraction of <b>Interactor</b> appears (from the English. Interaction - interaction, therefore, the <i>interactor</i> is the one who interacts). <br><br>  When developing any system, I like to imagine what the top level code will look like, in other words: ‚ÄúIf this is a framework, how will the end user work with it?‚Äù <br><br>  Let's take as a basis the code of the last example with tasks: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// ...     NPC. var player = GetPlayer(); var questGiver = GetQuestGiver(); player.Interact(questGiver).Using&lt;QuestDialogInteractor&gt;();</span></span></code> </pre><br>  All intrigue went to the class <b>QuestDialogInteractor</b> .  How to organize it to magically achieve the result?  I will show the most simple and obvious, again based on the previous example: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">QuestDialogInteractor</span></span> : <span class="hljs-title"><span class="hljs-title">Interactor</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Interact</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ComponentContainer a, ComponentContainer b</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> player = a <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Player; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (player == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> questGiver = b <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> QuestGiver; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (questGiver == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> playerStats = player.GetComponent&lt;StatsComponent&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (playerStats == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (playerStats.Level &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> questList = questGiverNpc.GetComponent&lt;QuestList&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (questList == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> availableQuests = questList.Where(quest =&gt; quest.Level &gt;= playerStats.Level); <span class="hljs-comment"><span class="hljs-comment">//   . } }</span></span></code> </pre><br>  Almost immediately it is clear that the current implementation is terrible.  First, we are fully tied to the check: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (playerStats.Level &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre><br>  One character issues tasks for level 5, another for level 27, and so on.  Secondly, the most serious puncture: there is a dependence on the <i>Player</i> and <i>QuestGiver types</i> .  They can be replaced by <i>ComponentContainer</i> , but what if I still need references to specific types?  And needed for these types, need for others.  Any change will violate the <b>Open / Closed Principle</b> (SOLID). <br><br><h4>  Reflection </h4><br>  The solution was found in the meta-data mechanism proposed in .NET, which allows you to enter a number of rules and restrictions. <br><br>  The general idea is to be able to define methods in the successor of the <i>Interactor</i> type, which take two parameters with types derived from <i>ComponentContainer</i> .  Such a method will not be valid unless it is marked with the <i>[InteractionMethod]</i> attribute. <br><br>  Thus, the previous code becomes intuitive: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">QuestDialogInteractor</span></span> : <span class="hljs-title"><span class="hljs-title">Interactor</span></span> { [InteractionMethod] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlayerAndQuestGiver</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Player player, QuestGiver questGiver</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> playerStats = player.GetComponent&lt;StatsComponent&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (playerStats == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (playerStats.Level &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> questList = questGiverNpc.GetComponent&lt;QuestList&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (questList == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> availableQuests = questList.Where(quest =&gt; quest.Level &gt;= playerStats.Level); <span class="hljs-comment"><span class="hljs-comment">//   . } }</span></span></code> </pre><br>  Still striking are these ‚Äúattempts‚Äù to get the component out of the container that I would like to remove somewhere. <br><br>  With the help of the same tool, we introduce an additional contract in the form of the <i>[RequiresComponent (parameterName, ComponentType)]</i> attribute: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">QuestDialogInteractor</span></span> : <span class="hljs-title"><span class="hljs-title">Interactor</span></span> { [InteractionMethod] [RequiresComponent(<span class="hljs-string"><span class="hljs-string">"player"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(StatsComponent))] [RequiresComponent(<span class="hljs-string"><span class="hljs-string">"questGiver"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(QuestList))] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlayerAndQuestGiver</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Player player, QuestGiver questGiver</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> playerStats = player.GetComponent&lt;StatsComponent&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (playerStats.Level &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> questList = questGiverNpc.GetComponent&lt;QuestList&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> availableQuests = questList.Where(quest =&gt; quest.Level &gt;= playerStats.Level); <span class="hljs-comment"><span class="hljs-comment">//   . } }</span></span></code> </pre><br>  Now everything looks clean and neat.  What has changed since the original version: <br><br><ul><li>  added an interaction layer; </li><li>  added rules and restrictions. </li></ul><br>  In addition to the interaction of two container objects, there was a problem with how to ensure interaction between several components inside a single container.  To solve this problem, I used a similar approach to the previous one: when a user adds a component to a container, he calls the first handler method, passing himself as a parameter: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ComponentContainer</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Component component</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ... , . component.OnAttach(this); } }</span></span></code> </pre><br>  The <i>OnAttach</i> method in turn finds a method with a specific component type (using reflection and polymorphism), marked with the attribute <i>[AttachHandler]</i> , which can work with a specific type of container. <br><br>  If such component requires some other components of the container to work, its class can be marked with the same attribute <i>[RequiresComponent (ComponentType)]</i> . <br><br>  Consider the example of a component whose task is to draw a texture using the <b>XNA</b> library: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">RequiresComponent(typeof(PositionComponent))</span></span>] [RequiresComponent(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(SpriteBatch))] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TextureDrawComponent</span></span> : <span class="hljs-title"><span class="hljs-title">Component</span></span> { [AttachHandler] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTextureHolderAttach</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ITexture2DHolder textureHolder</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   ITexture2DHolder   GetComponent,  //     ComponentContainer,      Component, //    protected  GetComponent    Component. var spriteBatch = GetComponent&lt;SpriteBatch&gt;(); spriteBatch.Draw(textureHolder.Texture2D, GetComponent&lt;Position&gt;(), Color.White); } }</span></span></code> </pre><br>  Finally, I would like to give a couple of very simple examples of interaction: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//   . player.Interact(monster).Using&lt;AttackInteractor&gt;(); //    . player.Interact(healthPotion).Using&lt;ItemUsingInteractor&gt;(); //      . player.Interact(monster).Using&lt;LootInteractor&gt;();</span></span></code> </pre><br><h4>  Results </h4><br>  So far, the system is not fully ready: there are several windows for expansion, optimization (after all, reflection is actively used, it‚Äôs necessary not to be stingy with caching), it is necessary to think over the interaction of <i>VERY</i> complex entities more carefully. <br>  I would like to add to the <i>[RequiresComponent]</i> attribute a variant of behavior in case the code does not correspond to the contract (ignore or throw an exception). <br><br>  It is likely that, in the end, this ‚Äúrace‚Äù for extensibility and convenience will not lead to anything good, but, in any case, it will be an invaluable experience. <br><br>  I called the approach itself <b>CIM</b> - <b>Component Interactor Model</b> , and I plan to carefully test it for operability in the nearest "home" projects.  If the topic is of interest to someone, in the next part I can consider the <i>source-code of</i> such classes as <i>Component</i> , <i>ComponentContainer</i> , the implementation associated with <i>Using &lt;T&gt;</i> and <i>Interactor</i> . <br><br>  <a href="http://habrahabr.ru/post/271309/">The second part of.</a> <br><br>  <i>Thanks for attention!</i> </div><p>Source: <a href="https://habr.com/ru/post/270825/">https://habr.com/ru/post/270825/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270809/index.html">Voice control multimedia center</a></li>
<li><a href="../270813/index.html">Online algorithms in high-frequency trading: problems of competition</a></li>
<li><a href="../270815/index.html">Security Week 46: Versatile Java Bug, Life for Crypto-Folders, 17 Adobe Flash Patches</a></li>
<li><a href="../270821/index.html">Pirate metrics: how to create an email campaign based on the AARRR principle. Part 4</a></li>
<li><a href="../270823/index.html">First article about checking C # project</a></li>
<li><a href="../270827/index.html">PostgreSQL on multicore servers Power 8</a></li>
<li><a href="../270829/index.html">Development and debugging of applications for Android Wear</a></li>
<li><a href="../270837/index.html">Embedding Addictions in Angular 2</a></li>
<li><a href="../270839/index.html">Class Requests at InterSystems Cach√©</a></li>
<li><a href="../270841/index.html">Cisco ipsec tunnel without using crypto map</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>