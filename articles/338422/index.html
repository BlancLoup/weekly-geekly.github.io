<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New FinFisher cyber espionage operation: MitM attacks at the provider level?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ESET has identified new operations using FinFisher spyware, also known as FinSpy, once sold to government agencies around the world. In addition to th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New FinFisher cyber espionage operation: MitM attacks at the provider level?</h1><div class="post__text post__text-html js-mediator-article">  ESET has identified new operations using FinFisher spyware, also known as FinSpy, once sold to government agencies around the world.  In addition to the technical improvements of FinFisher, a new, previously unknown vector of infection was fixed, indicating possible participation in the scheme of a large Internet provider (ISP). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/50f/735/fcb/50f735fcbe9442f9903c4fe8f7c568ba.jpg"></div><br>  <a href="https://en.wikipedia.org/wiki/FinFisher">FinFisher has a</a> wide range of capabilities for surveillance via a webcam and microphone, as well as keylogging and file theft functions.  What distinguishes FinFisher from other surveillance tools is the contradictory information about its implementation.  FinFisher positioned as a law enforcement tool, it is believed that <a href="https://citizenlab.ca/2013/03/you-only-click-twice-finfishers-global-proliferation-2/">it is used by dictatorships</a> .  We found the latest versions of FinFisher in seven countries.  Unfortunately, we cannot call them, so as not to endanger anyone. <br><br><a name="habracut"></a><h3>  Infecting targets </h3><br>  In FinFisher campaigns, various infection mechanisms are used, including targeted phishing, manual installation with physical access to devices, <a href="https://www.fireeye.com/blog/threat-research/2017/09/zero-day-used-to-distribute-finspy.html">zero-day vulnerability,</a> and watering hole attacks ‚Äî infecting sites that potential victims allegedly visit (the scheme was used to distribute the mobile version of FinFisher). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The new and most disturbing in the latest FinFisher campaigns is the emergence of the man-in-the-middle scheme, where the indicated ‚Äúman‚Äù is most likely at the level of the Internet provider.  We have seen the use of this vector in two countries where the latest version of FinFisher is found (the other five countries use traditional infection vectors). <br><br>  When the user (the object of surveillance) is going to download one of the popular legitimate applications, it is redirected to the version of the program infected with FinFisher.  We saw trojanized versions of WhatsApp, Skype, Avast, WinRAR, VLC Player and some other programs.  It is important to note that in theory this way you can use any legitimate application. <br><br>  The attack begins when a user searches on legitimate sites for one of the mentioned applications.  When he clicks on the download link, his browser receives a modified link that redirects it to a trojanized installer hosted on the attacker's server.  After downloading and execution, not only the legitimate application will appear on the user's device, but also FinFisher spyware. <br><br><img src="https://habrastorage.org/web/e0e/052/b19/e0e052b19480440889fd60cb231345c2.png"><br>  <i>Figure 1. The infection mechanism with the latest versions of FinFisher</i> <br><br>  Forwarding is done by replacing the legitimate link with a malicious one. <br><br>  The modified malicious link is delivered to the user's browser using the HTTP 307 Temporary Redirect redirect status response code (the requested content is temporarily moved to the new address).  The redirection process is invisible to the user. <br><br><img src="https://habrastorage.org/web/226/cd1/b83/226cd1b83af74632be20ec3a5c30f831.png"><br>  <i>Figure 2. Detailed description of the infection mechanism</i> <br><br><h3>  FinFisher: work out of sight </h3><br>  The latest version of FinFisher has been technically improved, the authors have focused on providing stealth.  Spyware uses custom code virtualization to protect most components, including the kernel-mode driver.  In addition, the code provides anti-disassembly techniques.  We discovered anti-debug, anti-emulation, and anti-virtualization techniques in FinFisher. <br><br>  After overcoming the first level of protection (anti-disassembly), the next level is code virtualization.  In the virtual machine manager 34 handler;  Almost all spyware execution is done in the interpreter, which adds another level of protection that will have to be dealt with during the analysis. <br><br><img src="https://habrastorage.org/web/1bc/7b7/dcf/1bc7b7dcf3b74575bb32c66c86c67da7.png"><br>  <i>Figure 3. Visualization of numerous handlers that complicate code analysis</i> <br><br>  In the next report, we will present a more detailed technical analysis of the latest version of FinFisher. <br><br><h3>  A special approach to users interested in privacy <br></h3><br>  During the analysis of recent campaigns, we found an interesting sample - FinFisher, disguised as an executable file called Threema.  It can be used to attack users who are concerned about privacy issues ‚Äî Threema's legitimate application provides secure instant messaging with end-to-end encryption.  There is a certain irony in the fact that a user who is seeking privacy, uploads a file with his own hands and starts the surveillance process. <br><br>  The focus on users interested in encryption is not limited to instant messengers.  During the study, we discovered a FinFisher infected installation file in the once very popular TrueCrypt disk encryption software. <br><br><h3>  Who is he - man-in-the-middle? </h3><br>  Technically, it can be assumed that man-in-the-middle is involved in an attack at one of the stages of the path from the target computer to the legitimate server (as an option, it could be a compromised Wi-Fi point).  However, the geographical distribution of the latest versions of FinFisher, discovered by ESET, suggests that MitM attacks are made at a higher level, and the most likely option is the participation of an Internet service provider (ISP). <br><br>  This assumption confirms a number of facts.  First, according to WikiLeaks‚Äôs leaked materials, the FinFisher developer offered a solution called ‚ÄúFinFly ISP‚Äù for deployment in ISP networks with functions reminiscent of those needed for MitM attacks.  Secondly, the infection method (HTTP 307 redirection) is used in the same way in both countries where the infection occurred.  It is unlikely that these schemes are developed and / or provided by different sources.  Thirdly, all the targets hit within the country use the services of one Internet provider.  Finally, the same method and redirection format is used by providers to filter Internet content in at least one of these countries. <br><br>  The use of the MitM technique at the provider level, which is referred to in the document leaked to the network, has not yet been detected anywhere - until today.  If this information is confirmed, new attacks with FinFisher are the beginning of new ones, unprecedented in their techniques, methods, and coverage of cyber espionage operations. <br><br><h3>  Is my computer infected? </h3><br>  All ESET products detect and block this threat as Win32 / FinSpy.AA and Win32 / FinSpy.AB.  With <a href="https://www.eset.com/ng/home/products/online-scanner/">ESET Online Scanner,</a> you can check your computer for a threat and delete it when it is detected.  ESET users are automatically protected. <br><br><h3>  Indicators of compromise </h3><br>  <b>ESET detection names:</b> <br>  Win32 / FinSpy.AA <br>  Win32 / FinSpy.AB <br><br>  <b>Call Forwarding:</b> <br>  HTTP / 1.1 307 Temporary Redirect \ r \ nLocation: \ r \ nConnection: close \ r \ n \ r \ n <br><br>  <b>The list of URLs found during the research process:</b> <br> <code>hxxp://108.61.165.27/setup/TrueCrypt-7.2.rar <br> hxxp://download.downloading.shop/pcdownload.php?a=dad2f8ed616d2bfe2e9320a821f0ee39 <br> hxxp://download.downloading.shop/pcdownload.php?a=84619b1b3dc8266bc8878d2478168baa <br> hxxp://download.downloading.shop/pcdownload.php?a=ddba855c17da36d61bcab45b042884be <br> hxxp://download.downloading.shop/pcdownload.php?a=d16ef6194a95d4c8324c2e6673be7352 <br> hxxp://download.downloading.shop/pcdownload.php?a=95207e8f706510116847d39c32415d98 <br> hxxp://download.downloading.shop/pcdownload.php?a=43f02726664a3b30e20e39eb866fb1f8 <br> hxxp://download.downloading.shop/pcdownload.php?a=cb858365d08ebfb029083d9e4dcf57c2 <br> hxxp://download.downloading.shop/pcdownload.php?a=8f8383592ba080b81e45a8913a360b27 <br> hxxp://download.downloading.shop/pcdownload.php?a=e916ba5c43e3dd6adb0d835947576123 <br> hxxp://download.downloading.shop/pcdownload.php?a=96362220acc8190dcd5323437d513215 <br> hxxp://download.downloading.shop/pcdownload.php?a=84162502fa8a838943bd82dc936f1459 <br> hxxp://download.downloading.shop/pcdownload.php?a=974b73ee3c206283b6ee4e170551d1f7 <br> hxxp://download.downloading.shop/pcdownload.php?a=cd32a3477c67defde88ce8929014573d <br> hxxp://download.downloading.shop/pcdownload.php?a=36a5c94ffd487ccd60c9b0db4ae822cf <br> hxxp://download.downloading.shop/pcdownload.php?a=0ebb764617253fab56d2dd49b0830914 <br> hxxp://download.downloading.shop/pcdownload.php?a=f35e058c83bc0ae6e6c4dffa82f5f7e7 <br> hxxp://download.downloading.shop/pcdownload.php?a=64f09230fd56149307b35e9665c6fe4c <br> hxxp://download.downloading.shop/pcdownload.php?a=b3cc01341cb00d91bcc7d2b38cedc064 <br> hxxp://download.downloading.shop/pcdownload.php?a=5fc0440e395125bd9d4c318935a6b2b0 <br> hxxp://download.downloading.shop/pcdownload.php?a=5ca93ad295c9bce5e083faab2e2ac97a <br> hxxp://download.downloading.shop/pcdownload.php?a=f761984bb5803640aff60b9bc2e53db7 <br> hxxp://download.downloading.shop/pcdownload.php?a=5ca93ad295c9bce5e083faab2e2ac97a <br> hxxp://download.downloading.shop/pcdownload.php?a=514893fa5f3f4e899d2e89e1c59096f3 <br> hxxp://download.downloading.shop/pcdownload.php?a=a700af6b8a49f0e1a91c48508894a47c <br> hxxp://download.downloading.shop/pcdownload.php?a=36a5c94ffd487ccd60c9b0db4ae822cf <br> hxxp://download.downloading.shop/pcdownload.php?a=a700af6b8a49f0e1a91c48508894a47c <br> hxxp://download.downloading.shop/pcdownload.php?a=395ce676d1ebc1048004daad855fb3c4 <br> hxxp://download.downloading.shop/pcdownload.php?a=cd32a3477c67defde88ce8929014573d <br> hxxp://download.downloading.shop/pcdownload.php?a=49d6d828308e99fede1f79f82df797e9 <br> hxxp://download.downloading.shop/pcdownload.php?a=d16ef6194a95d4c8324c2e6673be7352</code> <br> <br>  <b>Samples (SHA-1)</b> <br> <code>ca08793c08b1344ca67dc339a0fb45e06bdf3e2f <br> 417072b246af74647897978902f7d903562e0f6f <br> c4d1fb784fcd252d13058dbb947645a902fc8935 <br> e3f183e67c818f4e693b69748962eecda53f7f88 <br> d9294b86b3976ddf89b66b8051ccf98cfae2e312 <br> a6d14b104744188f80c6c6b368b589e0bd361607 <br> 417072b246af74647897978902f7d903562e0f6f <br> f82d18656341793c0a6b9204a68605232f0c39e7 <br> df76eda3c1f9005fb392a637381db39cceb2e6a8 <br> 5f51084a4b81b40a8fcf485b0808f97ba3b0f6af <br> 4b41f36da7e5bc1353d4077c3b7ef945ddd09130 <br> 1098ba4f3da4795f25715ce74c556e3f9dac61fc <br> d3c65377d39e97ab019f7f00458036ee0c7509a7 <br> c0ad9c242c533effd50b51e94874514a5b9f2219 <br> a16ef7d96a72a24e2a645d5e3758c7d8e6469a55 <br> c33fe4c286845a175ee0d83db6d234fe24dd2864 <br> cfa8fb7c9c3737a8a525562853659b1e0b4d1ba8 <br> 9fc71853d3e6ac843bd36ce9297e398507e5b2bd <br> 66eccea3e8901f6d5151b49bca53c126f086e437 <br> 400e4f843ff93df95145554b2d574a9abf24653f <br> fb4a4143d4f32b0af4c2f6f59c8d91504d670b41 <br> f326479a4aacc2aaf86b364b78ed5b1b0def1fbe <br> 275e76fc462b865fe1af32f5f15b41a37496dd97 <br> df4b8c4b485d916c3cadd963f91f7fa9f509723f <br></code> </div><p>Source: <a href="https://habr.com/ru/post/338422/">https://habr.com/ru/post/338422/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338412/index.html">RailsClub 2017. Interview with Nikita Sobolev, the organizer of elixir-lang.moscow</a></li>
<li><a href="../338414/index.html">How operators form tariffs in different countries of the world</a></li>
<li><a href="../338416/index.html">10 things that hx writers hate</a></li>
<li><a href="../338418/index.html">Resource management in product development in mechanical engineering</a></li>
<li><a href="../338420/index.html">Toy Front End for LLVM written in Rust: Beginner's Guide</a></li>
<li><a href="../338424/index.html">IT work in Barcelona, ‚Äã‚Äãbriefly failed</a></li>
<li><a href="../338426/index.html">Three ideas on how to improve development efficiency: the results of the hackathon for Machine Learning in SberTech</a></li>
<li><a href="../338428/index.html">How we teach AI to help find employees</a></li>
<li><a href="../338430/index.html">REQ Labs 2017. Online conference for business and system analysts</a></li>
<li><a href="../338432/index.html">Uptime day 2: Russian IT companies will talk about how to cope with disasters</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>