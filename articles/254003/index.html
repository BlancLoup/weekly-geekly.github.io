<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Analysis of Common Terminals</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Watch Dogs game perfectly describes the near future: around all kinds of devices, means for issuing and receiving cash, as well as various devices wit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Analysis of Common Terminals</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/8e3/e47/971/8e3e479715e94a53a0a7aad5e7d3cf75.jpg"><br><br>  Watch Dogs game perfectly describes the near future: around all kinds of devices, means for issuing and receiving cash, as well as various devices with Internet access, stuffed with vulnerabilities, the exploitation of which allows the hacker to extract certain benefits.  For example, in a game, the protagonist with a smartphone can compromise the video surveillance system, thereby obtaining the ability to conduct surveillance and obtain additional information. <br><a name="habracut"></a><br>  Watch Dogs fans disagreed: someone says it‚Äôs too ‚Äúutopian‚Äù to get a smartphone and break everything.  Others realize that ‚Äúa fairy tale is a lie, but a hint in it‚Äù and the game world partly reflects the real one. <br><br>  We will try to put forward some more arguments in favor of the fact that the devices around us, which we barely notice in parks and public places, can be vulnerable and carry danger - at least for our wallet. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Terminal terminators </h3><br>  The number of public devices that are waiting for their hero from a computer game goes off scale.  Parks and streets are full of parking payment terminals of various means of transportation and cozy ‚Äúbooths‚Äù of fast recharging of a mobile device.  Airports and train stations offer various devices for paying for tickets and receiving background information.  The cinemas have terminals for buying and booking tickets for movie shows.  In polyclinics and public institutions, visitors are greeted by electronic queuing devices and printing any receipts.  Even toilets are equipped with payment terminals.  True, hardly anyone will be able to handle the latest devices - the spirit is not enough :). <br><br><img src="https://habrastorage.org/files/1ae/c04/04e/1aec0404e86f44e6a7f740970858ea71.jpg"><br><br><img src="https://habrastorage.org/files/c27/7bc/9ad/c277bc9adfcf4d1ea2addc924e80c4ea.jpg"><br><br>  However, life teaches developers of such devices the fact that not all their users touch touchscreens with good intentions.  If we type in a request of the form terminal hacked into Google, we get many relevant videos in which the main characters play solitaire on one or another terminal or paint any obscenities in Paint.  The reason for this may be various bugs in the terminal applications, and they often carry a similar operating principle. <br><br><img src="https://habrastorage.org/files/525/003/c89/525003c897e1471ea61d47d3baadc898.jpg"><br><br>  So, in one of the videos, the participant holds his finger on the screen for about ten seconds, and this leads to the result of ‚Äúright-clicking‚Äù.  On the other guys randomly poke in the lower left corner of the screen - and the full-screen application is minimized.  Someone even thought of closing the terminal‚Äôs GSM antenna with his palm and thus provoking a connection error. <br><br><img src="https://habrastorage.org/files/8b9/087/677/8b90876772dd4059b8d3d442fa71cc14.jpg"><br><br>  Of the cases of such devices being compromised, the incident with the payment terminals of one well-known electronic payment vendor is the most interesting.  The attacker entered the line ‚Äúlast_page = StyleSheet.css‚Äù in the input field of the payment purpose using the virtual on-screen keyboard of the application, which is available in the interface of the payment system.  As a processor for the file with this extension, notepad.exe was opened, which, through its help system, allowed the villain to move to the system control panel and launch the operating system's virtual keyboard. <br><br><img src="https://habrastorage.org/files/4e9/bfd/4d6/4e9bfd4d646e4b169d76dfdc1aba6e8e.jpg"><br><br><h3>  Methods of security analysis of public terminals </h3><br>  Based on such videos and the sad experience of vendors, you can create a simple method of analyzing the security of devices of this type. <br><br><img src="https://habrastorage.org/files/36f/7ad/7e6/36f7ad7e6a9747ef8d37bd0d8b1345b2.jpg"><br><br>  Our task: having a full-screen application in hand, which most likely functions on the basis of the Windows operating system, go beyond its limits into the system environment.  For this you can use the so-called Tap-fuzzing.  In other words - to work with your fingers.  Click on different parts of the application in order to provoke its undocumented behavior.  Or you can use Data-fuzzing and substitute various data in the input fields in order to provoke incorrect processing of incoming data. <br><br>  As soon as you manage to call up an element of the standard interface of the operating system, the next step will be to get into the control panel, for example, through the help sections. <br><br>  Entering the control panel will be the starting point for launching a virtual keyboard with corresponding consequences. <br><br><h3>  Traffic situation </h3><br>  Moscow residents are increasingly likely to find bicycle parking meters in the parks of their city.  The essence of these devices is quite simple: there is a payment terminal for paying for a bicycle and a stand with bicycles.  The output device in the payment terminal is a display, where the user can register to ride a bike and get background information. <br><br>  The system interface is designed specifically for this type of device (if you have ever paid for something in the payment terminals, you can imagine what this is about), and it is difficult to get confused.  In this interface, the user has the opportunity to get the current location of the parking machine, or rather, to see the mark on the Google map. <br><br>  All such devices operate on the basis of classic operating systems (most often Windows-like) with all their vulnerabilities. <br><br>  However, a specialized interface is a full-screen application with very limited functionality, which does not allow the user to get under the hood and deliberately or unintentionally mess things up nonsense.  Accordingly, when analyzing the security of terminals, the main task is to go beyond the limits of this full-screen application.  After that, you can play pranks: launch your applications, raise privileges, dump valuable information and so on. <br><br>  In the considered systems of parking machines, an interesting feature was found.  In the "Maps" section, the developers did not invent anything new and used maps from Google.  And everything would be decent if only the widget from Google didn‚Äôt have a statusbar line, which among other information (current scale, copyrights, etc.) contains ‚ÄúReport an error‚Äù, ‚ÄúPrivacy‚Äù and ‚ÄúTerms of Use‚Äù links, which open Internet Explorer Standard Window ... <br><br><img src="https://habrastorage.org/files/c1a/7f4/a52/c1a7f4a5225c46278b9b55055b73f769.jpg"><br><br><h3>  And let's take a ride! </h3><br>  In addition to the described link, other links are imperceptibly scattered in this application (for example, when showing certain restaurants, you can click the Details button), by clicking on which you can open a browser. <br><br><img src="https://habrastorage.org/files/c31/c7e/e5d/c31c7ee5dd6d407491572ecea22612f7.jpg"><br><br>  "So what?  Well, I opened the browser - there are still no keyboards! ‚ÄùNow it will be: the links on the pages with reference information allow you to go to the help section, which is called‚Äú Special features ‚Äù, where the virtual keyboard is hidden (here‚Äôs another nasty minus Windows) . <br><br><img src="https://habrastorage.org/files/be6/0cd/36d/be60cd36d3d641d691cdcbb8763e3106.jpg"><br><br>  Then everything depends on the imagination and the degree of arrogance of the attacker.  Running cmd.exe demonstrates another configuration flaw: the current session of the operating system is running with administrator privileges, which means that we can potentially download and run any application completely free. <br><br><img src="https://habrastorage.org/files/e22/12b/243/e2212b24396647e0a79d16914e2de5c4.jpg"><br><br>  So, an attacker can get the NTLM hash of the administrator password.  At the same time, it is likely that the password set on this device fits the other devices of this type - and this is the third lack of configuration. <br><br>  On this adventure ends, so let's speculate that from all this an attacker can extract. <br><br><h3>  Terminals of public institutions </h3><br>  By state institutions, we mean those that are in buildings that have a coat of arms or a Russian flag.  Without specifics and mention of manufacturers, but in fact :). <br><br>  So, we have a full-screen application interface, which, based on the data we have entered, offers to print a receipt for payment. <br><br><img src="https://habrastorage.org/files/b11/b1d/1fe/b11b1d1fe6ae481bba2ed9c004759dfb.jpg"><br><br>  After filling in all the fields and details, we press the ‚ÄúCreate‚Äù button and observe the following picture: the terminal opens a standard print window for a few seconds, which contains all the print parameters of our document and automatically clicks the ‚ÄúPrint‚Äù button. <br><br><img src="https://habrastorage.org/files/b8f/69d/485/b8f69d4858cc4502ae1c6e18a688b99a.jpg"><br><br>  As a result, if an attacker manages to click on the ‚ÄúChange‚Äù button, he gets an opportunity, through simple manipulations with print parameters, to go to the help section ... <br><br><h3>  Whitekheta fall asleep, blackheats wake up </h3><br>  Post-exploitation scenarios arise from the features of these devices: <br><br><ul><li>  All of them are located in public places. </li><li>  Available 24/7. </li><li>  Have the same configuration. </li><li>  Have a higher degree of trust from the user. </li><li>  They are connected with each other and may have access to other ‚Äúprivate‚Äù networks. </li></ul><br><br>  The main purpose of the attacker is direct or indirect financial gain as a result of the device being compromised.  In this case, to achieve this goal, he can get not just an NTLM hash, which still needs to be brute-force to get a password, but immediately an administrator password.  To do this, the attacker can extract passwords in clear text that are stored in memory.  By the way, the latest version of the WCE utility can now not only dump passwords by inserting code into the lsass.exe process, but directly read the memory in the current session. <br><br>  Add here support for Windows 7, on the basis of which work parking meters, and get the "key" immediately to all devices of this vendor. <br><br><img src="https://habrastorage.org/files/32f/1ac/ca5/32f1acca5eb24ea28267545fbfabb15d.jpg"><br><br>  In addition, an attacker can get a dump of the bicycle parking application, which kindly collects information about those who want to go: name, email address and telephone.  It is possible that a database with important information is stored somewhere nearby.  It is not necessary to explain that such a database will be of particular value in the market, because it contains verified phone and email addresses.  In the event that there is no such database, the villain can install his keylogger, which intercepts all data entered by users and sends it to a remote server. <br><br>  Considering one of the features of these devices - working 24/7, you can organize, for example, a pool for mining or use it for other hacking purposes that require an around-the-clock presence of an infected workstation on the network. <br><br>  Particularly arrogant attackers can implement an attack scenario that will result in the receipt of user billing information: in the main window of the parking machine application, you can leave a field for entering plastic card details in an unobtrusive form, and with a high degree of probability, a misleading user will kindly leave them with his name, phone number and email ... <br><br>  The abundance of scenarios that open up opportunities for access to personal data and the wallet of unsuspecting people is limited only by the imagination of intruders.  The described situation with the protection of parking machines clearly demonstrates how several configuration flaws form a vulnerability. <br><br>  In addition, a compromised terminal may be the starting point for further attacks on the corporate network.  Very often, such devices access a terminal server or an entire subnet that is located in a trusted area of ‚Äã‚Äãthe company, which means that a small targeted attack using malware and / or social engineering can allow an attacker to be in the main office.  Without knocking. <br><br><img src="https://habrastorage.org/files/d9f/6bc/9fc/d9f6bc9fcc0a493e8867d2d055eee9b2.jpg"><br><br><h3>  Recommendations </h3><br>  Our analysis of the protection of parking machines demonstrates how several configuration flaws make the device vulnerable.  And the above attack scenarios - how it can open access to personal data and wallets for unsuspecting people to attackers. <br><br>  In order to eliminate malicious activity on public devices, developers and administrators of bicycle parking terminals and other terminals located in public places, we recommend: <br><br><ul><li>  Prevent the ability to open external links in a full-screen application. </li><li>  Do not allow any elements of the Windows interface to be called up (for example, with the right mouse button, using the print windows). </li><li>  Run the current operating system session with the limited privileges of a regular user. </li><li>  On each device, create a unique account with a unique password. </li></ul><br><br>  We recommend users of payment terminals not to enter full details of their payment cards.  In no case can you enter the CVV2 / CVC2-card number, they are not required to make a payment.  One should not neglect the possibility to pay the cash service in the terminal. <br><br><img src="https://habrastorage.org/files/ae7/b1e/a6d/ae7b1ea6dafa4322801be08f7119e8c2.jpg"><br><br>  <i>First published in the Hacker magazine dated 12/2014.</i> <i><br><br></i>  <i>Subscribe to "Hacker"</i> <i><br></i> <ul><li>  <i><a href="http://bit.ly/habr_subscribe_paper">Paper version</a></i> </li><li>  <i><a href="http://bit.ly/xakep_on_ipad">Hacker on iOS / iPad</a></i> </li><li>  <i><a href="http://bit.ly/habr_android">"Hacker" on Android</a></i> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/254003/">https://habr.com/ru/post/254003/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253991/index.html">Google will enhance Chrome web browser security for Windows</a></li>
<li><a href="../253995/index.html">DIY thermometer for Instagram on arduino nano</a></li>
<li><a href="../253997/index.html">Apple forensic. Extract data from iOS devices using open source tools</a></li>
<li><a href="../253999/index.html">Docker and crutches in production</a></li>
<li><a href="../254001/index.html">In Berlin, the developers showed their vision of a smart car</a></li>
<li><a href="../254005/index.html">We write the extension for Chrome "download audio recordings from Vkontakte"</a></li>
<li><a href="../254007/index.html">15 tips and tricks of the Chrome developer tools you need to know</a></li>
<li><a href="../254009/index.html">How I saved a few lives with optimization and a little about working at Zeptolab</a></li>
<li><a href="../254011/index.html">Recover Lost LVM Volume in XenServer</a></li>
<li><a href="../254015/index.html">Experience roentgenoscopy at home</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>