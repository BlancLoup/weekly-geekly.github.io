<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Knockout, hands-on experience</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago, I promised to talk about our experience with Knockout. We use this library in one of the projects during the last 4 months. This is not...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Knockout, hands-on experience</h1><div class="post__text post__text-html js-mediator-article">  Some time ago, I promised to talk about our experience with Knockout.  We use this library in one of the projects during the last 4 months.  This is not much, but during this time the team gained some experience, which, I think, may be of interest to readers. <br><a name="habracut"></a><br>  But for a start quite a bit of theory. <br><br><h2>  MVC, MVP and MVVM. </h2><br><br>  If most of the first two templates are more or less familiar, very few have heard about the latter: the MVVM template appeared in Microsoft and became popular among .net developers, but it is not so widely known among them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What is all the fuss?  MVC got accustomed to the web in many respects because it fits perfectly on the request-response script.  A request arrived, it was transmitted to the appropriate controller, it initiated some processes in the model, and then a View is created.  This is usually a template that is filled with data from the model.  Then the resulting markup is passed to the client in the browser. <br><br><img src="https://habrastorage.org/storage2/9c0/25b/523/9c025b52317a7ca79af3f26aa31b26b1.png"><br><br>  The main feature of this scenario is the short lifetime of the View - it is created for each request, it is simply filled with data in one pass - that's all. <br><br>  When Ajax appeared, and after it single-page applications, it turned out that the Presentation lives for a long time, and therefore a simple template is not enough.  Increased lifetime means complication of what is called the lifecycle, and therefore the appearance of logic on the View. <br><br>  Naturally, no one wants it, everyone wants it - so that the application logic is provided in the code, and not in the markup.  It is easier to maintain, easier to test and change.  What do they do in such cases? <br><br>  <strong>Idea 1:</strong> Enter MVP.  The presentation logic is carried out in a special layer and merged with the controller into the Presenter.  The task of the presenter is to separate the model from the presentation, be responsible for transferring data between them, and contain the logic to change the presentation. <br><br><img src="https://habrastorage.org/storage1/f66878c8/fe2348ea/76cee647/bd5dbae6.png"><br><br>  Presenter - mediator.  He could be stateful or stateless.  However, in reality there is always a state in it - it is a state of the species.  An alternative would be to keep it in the model, but, of course, no one wants that either.  Therefore, we assume that there is a state in Presenter. <br><br>  If we look at MVP in relation to the web, then our Presenter could be an object in JavaScript with state fields.  How does it change through HTML and user interaction?  - Through DOM events.  Those.  our Presenter is an object with fields and event listeners for communicating with View. <br><br>  <strong>Idea 2:</strong> You can also use the event to connect the presenter with the model.  Those.  whenever a change occurs in the fields of the presenter object, the corresponding event is launched.  Event handlers invoke business methods in the model, and the result is also reflected as changes in the values ‚Äã‚Äãof the other fields of the presenter.  Events are called again, but this time it could be view handlers, for example.  Then changes in the model are reflected in the user interface.  Here is such an event-driven workflow. <br><br>  <strong>Idea 3:</strong> Now if the message processing infrastructure is removed from the presenter, hidden in a separate framework, the object itself is transformed into a simple object with fields.  Changing the values ‚Äã‚Äãof the fields, we initiate some processes in the model or in the presentation.  Such a simple object is called ViewModel - it simulates the user interface from the point of view of our business logic, without going into details. <br><br><img src="https://habrastorage.org/storage1/ca765613/d804afde/dba8310b/429fa832.png"><br><br>  The .net pattern got accustomed largely due to the fact that for the UI component layout they began to use XAML, a markup in which the binding of elements to the ViewModel fields can be described declaratively.  On the other hand, events are supported at the framework level, so implementing a ViewModel and Model can also be very convenient. <br><br>  In JavaScript, we don‚Äôt have this kind of event support, so two things are needed to implement an MVVM template: <br><ol><li>  The mechanism for binding the properties of DOM elements to the fields of the ViewModel. </li><li>  PubSub-infrastructure to support events related to changes in the values ‚Äã‚Äãof ViewModel fields. </li></ol><br><br><h2>  Knockout js </h2><br><br>  Knockout JS is just such a framework that implements these two mechanisms.  For communication View-ViewModel used HTML5 data-attributes. <br><br>  Example: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> =‚Äù <font color="#ff0000">customerDetails</font> ‚Äù <font color="#ff0000">data-bind</font> =‚Äù <font color="#ff0000">visible:</font> <font color="#ff0000">currentCustomer</font> () !== <font color="#ff0000">null</font> ‚Äù <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  currentCustomer - field in the ViewModel object.  Actually, this is not quite a field: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> vewModel = { <br> currentCustomer: ko.observable(defaultCustomer), <br> ‚Ä¶ <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  As you can see, the value of the field is wrapped in ko.observable.  Through this wrapper, Knockout monitors how the field value changes.  Those.  corresponding event handlers are called there.  The disadvantage, of course, is that you have to work everywhere by calling the method, writing brackets. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">viewModel.currentCustomer = joeCoder;</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  turns into <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">viewModel.currentCustomer(joeCoder); <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  You can get used to it, but sometimes the brackets in the getter are forgotten. <br><br>  To subscribe, you need to write the following: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">viewModel.currentCustomer.subscribe( <font color="#0000ff">function</font> (newValue) { <br> <font color="#008000">// this === context</font> &lt;br&gt; <br> }, context);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  So you can bind the ViewModel to our business methods.  Inside the framework, for all data-bind attributes, the same handlers are actually created.  The entire binding is initiated by the call. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">ko.applyBindings(viewModel)</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  So on the surface everything is quite accessible - no magic. <br><br>  Of course, if the matter was limited only to this, then it would be quite nice.  But Uncle Sanderson went on. <br><br>  <strong>First, he made a wrapper for arrays: ko.observableArray.</strong>  True, he knows a little: pop, push, reverse, shift, sort, splice, unshift, slice, remove, removeAll, indexOf.  Quite enough for work, but some underscore frills are not enough.  Understandably, you can read the value ‚Äî the array itself ‚Äî to perform operations with it, and then write it back in its entirety.  But it turns ugly (why, I will explain further).  Therefore, it is better to hold on to what is already there. <br><br>  <strong>The second important addition is ko.dependentObservable ().</strong>  Those.  You can define a property in the ViewModel that will depend on other properties.  At the same time, knockout leads <a title="Read the source -" href="">automatic tracking of dependencies</a> !  This is one of the most important features of the library - I strongly recommend using it.  Again, there is no magic inside.  When calculating, ko keeps track of which observabl are addressed and adds them to the tracker.  If the value of one of these properties has changed, recalculation for the dependent property is called.  It is clear that dependent properties can also act as the properties of the fundamentals. <br><br>  What can I do with dependentObservable?  Its main purpose is to simplify the logic.  It often happens that a complex condition appears in the data-bind.  It looks very uncomfortable - JavaScript in my HTML !! 1.  Debug of this condition also turns out to be inconvenient - the debugger will not enter the attribute body.  Therefore, it is easier to make a condition or its component in the form of dependentObservable and then work with it. <br><br>  By the way, to the issue of debugging.  As I said, the debugger does not enter the attribute body.  That's because in applyBindings, the framework runs through all tags and creates its own dependentObservables for all buyindings.  He does it, naturally, through eval.  Not very good, but it is a choice between readability and cleanliness.  By the way, for those who believe that seeing pieces of JavaScript code in HTML attributes is a return to inline Internet dawn handlers like onclick, I hurry to inform you that no one forces you to do this.  You can hang them through a DOM-api, as, for example, shown here: <a title="Unobtrusive Knockout support library for jQuery" href="https://gist.github.com/1006808">Unobtrusive Knockout support library for jQuery</a> <br><br>  <strong>What else?</strong>  <strong>There is support for jQuery-Tmpl templates.</strong>  At one time it was expected that this plugin will become part of jQuery, but the developers' plans have changed.  On the other hand, Microsoft is also not actively developing it anymore - the only developer has moved on to other projects.  So the project is a little stillborn - my prediction: it will be in beta1 state for about a year.  Then either thrown out, or brought to mind. <br><br>  But even for beta1, it seemed to me sufficient, especially in conjunction with Knockout.  In fact, in our project we do not use template logic - all these expressions are in curly braces.  We iterate through Knockout foreach, substitute values ‚Äã‚Äãinto the body and tag attributes, too, through ko.  First, starting to apply data-bind-attributes, we would like to apply them everywhere, and secondly, when rendering via foreach in combination with operations from ko.observableArray, not the entire collection is redrawn, but only the changed elements.  That is why I believe that, if possible, it is worth confining to only those operations. <br><br>  Still you should not forget that in the template parameters you can specify the afterRender callback.  With it, you can finish building in the template that it is inconvenient to build by the forces of the windings, well, or to perform some additional actions.  We in the afterRender initiate widgets, if any, should be in the template.  Two parameters are passed to the callback.  The first is the renderedNodesArray, a fragment of the DOM that rendered the template.  The second is data - the data passed to the template. <br><br><h2>  Why did I like this framework? </h2><br>  Largely due to declarativeness.  I noticed a long time ago that the more my code of conditions, cycles and nesting levels, the harder it is to understand, maintain and debug this code.  In addition, if earlier I liked all this, now with experience the actions themselves seem boring to me - the tasks and their solutions are much more interesting, and the higher the level of description of the solution, the easier it is to understand and the less chance there is to make a mistake in it. <br><br>  UI code is very difficult to debug.  On the one hand, it does not seem particularly complicated compared to the same business logic.  On the other hand, it is difficult to approach him, it is difficult to tear him out of context, it is difficult to place him in a unit test, for example.  Knockout allows me to describe UI not with code, but with rules.  This is a huge plus. <br><br>  The fact that the rules are described in the markup is also a plus - in my opinion.  Here is the section responsible for the toolbar, and here are the rules for its behavior.  Very comfortably!  Special bold plus for the fact that markup remains understandable for design tools - no custom tags, no XML neimspaces.  Any editor will open your HTML without problems. <br><br><h2>  Knockout <em>vs.</em>  Backbone </h2><br>  An alternative to Knockout today for many is Backbone.  There is a lot of good in it.  Collections work with underscore - this is a big plus when writing conversion logic, filtering, etc.  There is support for data synchronization with the server, there is history management.  But when working with UI, I have to prescribe all the connections of the model with the DOM with my hands.  It is not difficult, but very tiring.  The code turns out a little, especially if you compare the unobstrusive Knockout binding option.  But the fact that this monotonous code has to be written by hand is very upsetting. <br><br>  On the other hand, in Knockout there is nothing on the model side outside the event in ViewModel.  There is something backbone and strong.  In fact, your choice in favor of a particular library should be based on how large the UI or Model component in your code is.  Imagine that you are writing a project from scratch without using any of these libraries.  If you foresee that most of the problems will arise on the DOM side, then probably it is better to take a Knockout so that it will make your life easier.  If the main difficulty arises on the integration side, then Backbone will probably suit you. <br><br>  I personally see the main advantage of Backbone in front of Knockout in Sync - the ability to synchronize data with the server.  However, Sync works well only when the server API obeys REST rules.  Many people think supposedly great, now I will make it work.  However, they overlook the fact that REST and JSON-over-HTTP are not the same thing!  If with the first one Backbone works out of the box - you just indicate the URL of the resource, then with the second one you need to file it.  And then you ask yourself: is it really better than Sync than a simple $ .ajax call? <br><br>  In our project we had to deal with JSON-over-HTTP.  In addition, the number of types of messages that we send and receive from the server is small, while only four.  Only one of them is data synchronization.  Everything else is a one-time user action.  Even though you have to write these calls yourself, it‚Äôs not too difficult for my team. <br><br>  By the way about the team.  Of the four people, I alone have experience with JavaScript in general.  To get started, I conducted a language and library course with them.  It turned out that for all it is the DOM api that presents the greatest complexity, even in the guise of jQuery.  This is partly due to CSS and the fact that they simply do not know which attribute is responsible for what.  Therefore, they really liked that all work with it could be localized around a single object - ViewModel.  Working on different nodes, they practically do not step on each other‚Äôs feet. <br><br>  If you are interested in comparing two libraries, there is a <a title="Knockout.js vs. Backbone.js - Part 2" href="http://ifandelse.com/%3Fp%3D70">series of posts</a> .  It describes the application for a simple script.  But scenarios are different :) <br><br><h2>  Practice </h2><br>  Let me tell you better about those rakes that have to be stepped on, and those moments that cause difficulty. <br><br>  <strong>1. Difference of ViewModel from Model.</strong> <br><br>  Not everyone feels the difference.  Simple rule: <br><ul><li>  Model answers the question ‚ÄúWhat is in my application and what can it do?‚Äù </li><li>  ViewModel - to the question ‚ÄúWhat am I showing on the page?‚Äù </li></ul><br>  Why am I doing this?  And the fact that many are beginning to look at the ViewModel, as a model.  Here they have a number of questions.  For example: in the Presenter the list of goods, the selected goods and the index of the selected goods can be indicated.  Immediately there will be someone who will say that it is not necessary to store both the selected product and the index - they say, the data are duplicated.  However, unlike the model, it does not matter to us whether there is any kind of redundancy in the ViewModel.  If it allows us to significantly simplify the application code, then why not? <br><br>  Many also ask if you can use multiple ViewModel.  It is possible, but is it necessary?  We made such an attempt, but our mistake was that we shared responsibilities between ViewModels in accordance with their content - that is, we worked with them as with model entities.  Whereas ViewModels represents page sections and each of them works only with its own section.  Then, when you need to display data from one ViewModel on another part of the page, nothing will come out directly through the data-bind. <br><br>  So my advice to you: use one ViewModel for the entire page - everything will just work.  There is a risk that the object will become large, but nobody prevents you from writing several times in the code. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">_.extend(ViewModel, { <br> <font color="#008000">//    </font> &lt;br&gt; <br> })</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Such blocks can be divided into functional modules. <br><br>  <strong>2. Despite the fact that the examples for the Knockout Model are completely absent, and the supporters themselves declare to you with a smile that <a href="http://stackoverflow.com/questions/6520568/knockout-js-why-do-all-the-examples-only-contain-viewmodel-view-but-no-model">she is on the server</a> , do not believe them.</strong> <br><br>  There is a model on the client too, and it will have to be written with pens - unlike Backbone, Knockout will not help you with this.  On the other hand, it is not so scary, and your common sense and general rules of hygiene will help you.  Remember two things: events and modularity.  If ajax code becomes a problem for you, look towards <a title="Amplifyjs" href="http://amplifyjs.com/">AmplifyJS</a> . <br><br>  <strong>3. Unfortunately, even in those rare cases when Knockout wants to help us in model making, it doesn‚Äôt work well.</strong> <br><br>  The ko.toJSON method does <a href="http://stackoverflow.com/questions/5942789/in-knockoutjs-does-ko-tojson-work-with-dates">not know how to work with dates</a> , and writes null in them.  There are ways around this, but they are all a bit clumsy.  The easiest is to add another dependentObservable property with the value JSON.stringify (date ()) - there it will just be a string that can be sent to the server.  But ugly!  - two fields for each date, and marshalling works only in one direction.  Therefore, we went the other way: we just wrote our own crawler for the ViewModel, who carefully handles dates.  The blessing ko offers the unwrapObservable method which returns a simple object.  It works, however, only at the top level, so then you have to bypass all the properties of the received object in case there are still observables somewhere <br><br>  <strong>4. Despite templating, sometimes you have to create DOM using other methods.</strong> <br><br>  This is especially true for widgets and third-party components.  In such cases, ko can also interfere: for example, when a component requires a simple array, and in our case it is observableArray, i.e.  in the component code: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">items.pop()</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  and we would like it to be there <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">items().pop()</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  It all depends on the situation.  Sometimes we patch components for internal use - especially if they are small or if some changes have already been made to them.  But in most cases we pass unwrapped array there, and we have to work with change subscriptions, most often, write two processors ‚Äî to change the data in the component and to change the data in the ViewModel. <br><br>  <strong>5. Knockout works very well under traditional business scenarios.</strong> <br><br>  Forms, data output, tables - if this is exactly what your application does, then it will suit you 100%. <br><br>  If you have something exotic, for example, working with SVG and Canvas, many DOM elements that are dynamically created and modified without your control, as in our project, then you should have doubts.  We chose ko, because in our project, both from it and from Backbone, there is not much sense in general - two thirds of the code is completely unrelated to the tasks that these libraries perform.  But even in the remaining third of Knockout, it seemed to us more useful. <br><br><h2>  Knockout <em>and</em> backbone </h2><br>  Many of you in the process of reading the article might have an idea to combine Backbone and Knockout.  Unfortunately, this is easier said than done.  Framework functionality overlaps in many ways; it is difficult to determine where to draw a line between them.  We tried to do this between the Knockout ViewModel and the Backbone Model, but the code became too cumbersome as a result: we had to write a data synchronizer, which in size combined with the Backbone model became more than what we wrote to connect the ViewModel to the server.  Debugging also became more complicated, and Sync was not so convenient to use for our services as we had hoped. <br><br>  So for now you have to choose between one or the other.  In the future, there will probably be a backbone banding and an analogue of the Sync in Knockout.  If you feel like a pioneer, are an ardent supporter of Backbone, and you want to see some kind of binging in it, I will give you one more piece of advice.  Take a closer look at <a title="jQuery-Link" href="http://api.jquery.com/link/">jQuery-Link</a> .  This is another plugin from Microsoft, which they also sluggishly modify, like jQuery-Tmpl.  But nevertheless, it can become the basis for the realization of binding. <br><br>  Microsoft itself seems to have been waiting.  Steve Sunderson - the author of Knockout - works for them, and the video from his presentation on MIX11 has become the most popular, overtaking all keyouts and all IE10 presentations, performance optimization and future HTML5, EcmaScript and any other technologies of the company.  Now Steve with the .net star Scott Guthrie travels around the world and shows everyone his creation.  And this week he published new educational materials.  If the framework takes off, the company will support it in the same way as jQuery. <br><br>  Backbone is also not going anywhere, there is a big interest in it among rubists, NodeJS programmers and the entire avant-garde of the JavaScript community.  So choosing any of them you can be sure - you will not lose! </div><p>Source: <a href="https://habr.com/ru/post/124731/">https://habr.com/ru/post/124731/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../124725/index.html">Installing common lisp as a user</a></li>
<li><a href="../124727/index.html">The iTwin gadget simplifies remote file transfer from PC to PC</a></li>
<li><a href="../124728/index.html">Building an index for a search engine</a></li>
<li><a href="../124729/index.html">kedDroid - S04E02. Video review software for Android</a></li>
<li><a href="../124730/index.html">Service selection of names and names from idea to implementation</a></li>
<li><a href="../124732/index.html">MultiMi is a good aggregator of your life on the Web.</a></li>
<li><a href="../124733/index.html">Google introduces credit cards for advertisers</a></li>
<li><a href="../124734/index.html">Where does the suitcase go or ...</a></li>
<li><a href="../124737/index.html">Durov responded to Mail.Ru Group attempts to swallow "VKontakte"</a></li>
<li><a href="../124738/index.html">Lenovo X1 review: the thinnest and lightest ThinkPad</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>