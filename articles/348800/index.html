<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Telegram bot to remove spam</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I decided to write this post because I 'm tired of explaining the same thing to people who want to use my telegram bot @daysandbox_bot . So, a few mon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Telegram bot to remove spam</h1><div class="post__text post__text-html js-mediator-article"><p>  I decided to write this post because  I <a href="https://tgdev.io/bot/daysandbox_bot">'m</a> tired of explaining the same thing to people who want to use my telegram bot <a href="https://tgdev.io/bot/daysandbox_bot">@daysandbox_bot</a> .  So, a few months ago I developed a bot to remove spam on a very simple basis: if a person went into the chat and spent less than a day in it, then any links or forward messages from this person are deleted.  Everything.  No neural grids, frequency analysis, moderated white- and black-sheets and other complex things.  Surprisingly, the bot has gained some popularity and is already working in more than six hundred chatikas.  Next, I will try to describe in detail the principle of the bot, to continue to give a link to this article. </p><a name="habracut"></a><br><h4 id="princip-raboty-bota">  The principle of the bot </h4><br><p>  From the moment of adding to the chat, the bot keeps track of events when new users enter the group and thus knows when someone has entered the chat and how much time he has already spent in the chat.  Due to the limitations of the telegram API, I cannot find out when those users who were already at the time of adding the bot to the chat joined the chat.  The bot does not analyze messages from users that exist at the time of adding the bot.  So, the bot knows when new users entered the chat.  If the bot sees, the user spent less than a day in the chat and posted a message that meets the definition of spam, the bot deletes the message.  He does not ban the user, does not give him read-only rights, the bot simply deletes the spam message.  If the user posts a non-spam message, it will be posted.  What messages are considered spam?  First, any messages containing a link: URL, email or <a href="https://habr.com/ru/users/username/" class="user_link">username</a> .  Secondly, any forward messages i.  Messages forwarded from another chat.  For the <a href="https://habr.com/ru/users/username/" class="user_link">username</a> rule there is an exception, if <a href="https://habr.com/ru/users/username/" class="user_link">username</a> refers to the user, then such a message is allowed.  The bot deletes only those messages with <a href="https://habr.com/ru/users/username/" class="user_link">username</a> that refer to the group or channel.  This is done so that there are no false positives, when a new user simply tries to contact some chat participant by his username. </p><br><h4 id="chto-bot-daysandbox_bot-ne-delaet">  What the daysandbox_bot bot does NOT do </h4><br><ul><li>  The bot does not ban anyone and never </li><li>  The bot does not filter messages from those chat participants that were already in the chat at the time of adding the bot </li><li>  The bot filters messages only for those users who have spent less than a day in the chat.  If the user spent more than a day in the chat, his messages are not processed by the bot in any way. </li><li>  The bot does not analyze the text of the message, it simply deletes the message with links.  Everything. </li></ul><br><h4 id="kak-pravilno-dobavit-bota-v-chat">  How to add a bot to chat </h4><br><p>  I describe the algorithm for the desktop client.  It is implied that you are admin chat and can add other admins to it. </p><br><ul><li>  Go to chat, click on the name of chat on top </li><li>  In the window that opens, at the top right of the inscription "Information about the group," click on the icon of three dots. </li><li>  In the menu that opens, click on "Group Management" </li><li>  In the menu that opens, click on "Administrators" </li><li>  In the window that opens, click on "Add Administrator" </li><li>  In the window that opens in the search bar, enter the daysandbox_bot </li><li>  In the updated search results, we click on the DaySandBox bot, it should have a yellow icon for Pakman. </li><li>  In the opened window, we set the bot to delete messages; we disable all other rights. </li><li>  Click "Save" </li></ul><br><h4 id="nastroyki-bota">  Bot settings </h4><br><p>  The bot has several settings. </p><br><p> Write in the chat <code>/daysandbox_set safe_hours=N</code> to set the time during which messages from new users are analyzed for signs of spam.  By default, this period is equal to days.  You can specify the number of hours from zero to 8760 (one year).  A period of zero hours essentially deactivates the bot. </p><br><p>  Write in the chat <code>/daysandbox_set publog=yes</code> to allow the bot to write messages in the chat that the message of a user has been deleted.  By default, the bot does just that. </p><br><p>  The current values ‚Äã‚Äãof these two settings can be obtained with the <code>/daysandbox_config</code> . </p><br><h4 id="nemnogo-statistiki">  Some statistics </h4><br><p>  I‚Äôm too lazy to draw beautiful graphics, I‚Äôll just say that the bot removes from 10 to 15 thousand messages a day and works in more than 600 posts. </p><br><h4 id="open-source">  Open source </h4><br><p>  The bot's sources are publicly <a href="https://github.com/lorien/daysandbox_bot">available on github</a> . <br>  UPD (February 11, 2019): currently the source code for the outdated version of the bot is in the repository.  I do not provide the source code for the current version of the bot. </p><br><h4 id="drugie-moi-boty">  My other bots </h4><br><p>  You may be interested in other bots that I developed.  The full list of bots can be found at <a href="https://tgdev.io/">https://tgdev.io</a> </p><br><h4 id="kontakty-dlya-svyazi">  Contact us </h4><br><p>  Groups to discuss my bots: </p><br><ul><li>  <a href="https://t.me/tgdev_ru">@tgdev_ru</a> </li><li>  <a href="https://t.me/tgdev_en">@tgdev_en</a> </li><li>  <a href="https://t.me/tgdev_uz">@tgdev_uz</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/348800/">https://habr.com/ru/post/348800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348786/index.html">Creating an atmospheric Victorian city from modules</a></li>
<li><a href="../348792/index.html">Bloomberg: how Ilon Mask‚Äôs sale of flame throwers will change start-up financing</a></li>
<li><a href="../348794/index.html">Hyperapp + Parcel</a></li>
<li><a href="../348796/index.html">Interview. Content Marketing for a Startup: Attracting First Customers and Optimizing Costs</a></li>
<li><a href="../348798/index.html">How to manage infrastructure in hundreds of servers and avoid problems: 5 tips from King Servers engineers</a></li>
<li><a href="../348804/index.html">How I promoted my game for free through YouTube</a></li>
<li><a href="../348808/index.html">What's inside of HR? (Anatomy will not)</a></li>
<li><a href="../348810/index.html">We will help developers: advantages and disadvantages of loud, we will provide 1000 cloud servers in the Netherlands and the USA for free</a></li>
<li><a href="../348812/index.html">How not to become an honest mailer</a></li>
<li><a href="../348818/index.html">Amazing Angular</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>