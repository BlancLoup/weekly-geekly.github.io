<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Integrating your data sources with Windows 7 federated search is easy!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How often do you have to look for different information? Most likely this happens every day. It should be noted that the task of finding information i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Integrating your data sources with Windows 7 federated search is easy!</h1><div class="post__text post__text-html js-mediator-article">  How often do you have to look for different information?  Most likely this happens every day.  It should be noted that the task of finding information is far from trivial.  The situation is complicated by the fact that information can be found in completely different sources - in files, in e-mail messages, in documents, etc.  It is no secret that most of the information is in the network - local and global. <br><br>  To simplify information retrieval in Windows Vista, a Windows Search tool was developed that allows you to easily and conveniently search for information based on previously prepared indexes.  In Windows 7, the search theme was continued and the Windows 7 Federated Search tool appeared in the new operating system. <br><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7_76F5/image_c29fe999-3484-41d8-ac6c-4a52c0d1059f.png"></div><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Windows 7 Federated Search</b> is a tool that allows you to search for information on the web based on Windows Explorer.  In this case, anything can be a source of data - a corporate website, an online store, online auctions, etc. <br><br>  The difference between federated search and Windows Search is that the federated search mechanisms do not index data sources, but simply ask them to perform a search query.  Federated search is focused on distributed information sources.  When it comes to remote sources, their indexing can be inefficient and lead to unnecessary consumption of traffic.  That is why an approach was chosen in which the task of processing a search query falls on the shoulders of a remote source.  Thus, it becomes possible to connect all remote sources and search for them without leaving the usual Windows Explorer. <br><br>  Despite all the convenience of such a search, implementing a search provider is a very simple task.  Federated search in Windows 7 is based on the OpenSearch 1.1 standard and works as follows.  To perform a search, Windows 7 accesses an external web service built on the basis of the REST approach.  This means that the search string, as well as other data required for the search, is passed to the URI when accessing this web service.  The web service based on this data should perform a search in its data source and return the result in RSS or AtomPub format.  After that, Windows 7 will present the search results from the received data as files and display them to the user. <br><br>  To add your search provider in Windows 7, you must create a description file for this provider.  The format of this file is based on XML and contains information about this search service, incl.  URI format for accessing the service. <br><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7_76F5/image_6faa2e2a-74b3-4903-aac8-db57091c4aba.png"></div> <br><br>  Thus, to implement your own federated search provider in Windows 7, you need to perform two simple steps - create a REST service to search for information and make a description file for it. <br><br>  Let's look at the process of creating a search provider using the following example.  There is a list of books with a description, author and other information.  In this case, this list is contained in the XML file (for a demo).  Anything can be used as a data source.  Make a search provider for this list. <br><br>  The search provider description file is an XML file and has the extension ‚Äú.osdx‚Äù.  This file has the following structure. <br><br> <code>&lt;?xml version="1.0" encoding="utf-8" ?&gt; <br> &lt;OpenSearchDescription xmlns="http://a9.com/-/spec/opensearch/1.1/"&gt; <br> &lt;ShortName&gt;Federated Search sample provider&lt;/ShortName&gt; <br> &lt;Url type="application/rss+xml" template="http://somehost.com/search/?q={searchTerms}&amp;start={startIndex}&amp;count={count}" /&gt; <br> &lt;/OpenSearchDescription&gt;</code> <br> <br>  In the Url section of this file, an address pattern is defined that will be used when accessing a web service.  It can be seen that this address can take a completely different form.  The address pattern uses several sections into which values ‚Äã‚Äãwill be inserted.  The main section is the ‚ÄúsearchTerms‚Äù section.  This section will be substituted for the string to search.  Federated search Windows 7 retrieves data page by page, so there are sections ‚Äúcount‚Äù and ‚ÄústartIndex‚Äù, which specify the size and number of the page.  This is necessary so that Windows can get the first search results, display them to the user, and then do the rest of the items. <br><br>  The demo will create a web service that will be hosted on a local machine.  For this reason, the description file of the search provider will look like this. <br><br> <code>&lt;?xml version="1.0" encoding="utf-8" ?&gt; <br> &lt;OpenSearchDescription xmlns="http://a9.com/-/spec/opensearch/1.1/"&gt; <br> &lt;ShortName&gt;Federated Search sample provider&lt;/ShortName&gt; <br> &lt;Url type="application/rss+xml" template="http://localhost:8731/FederatedSearchProviderSample/search/{searchTerms}/?start={startIndex}&amp;count={count}" /&gt; <br> &lt;/OpenSearchDescription&gt;</code> <br> <br>  The last thing you need to do is create the service itself that will perform the search.  In this case, there is no binding to a specific technology and the only requirement is that the service must return the result in RSS / Atom format.  It is clear that the service itself can be built on completely different platforms and technologies.  This could be PHP, Ruby, Native CGI, etc.  If we consider a set of technologies for building REST services from Microsoft, then the best choice in this case is to use WCF features to build REST services.  Much attention has already been paid to the construction of such services, so I will not dwell on this in detail, but will only describe the key steps. <br><br>  The first thing to do is to define a contract.  The contract will contain two operations - search and obtain detailed information. <br><br> <code>[ServiceContract] <br> [ServiceKnownType(typeof(Atom10FeedFormatter))] <br> [ServiceKnownType(typeof(Rss20FeedFormatter))] <br> public interface ISearchProvider <br> { <br> [OperationContract] <br> [WebGet(UriTemplate = "search/{searchTerms}/*")] <br> SyndicationFeedFormatter Search(string searchTerms); <br> [OperationContract] <br> [WebGet(UriTemplate = "details/{id}")] <br> Stream Description(string id); <br> }</code> <br> <br>  The most important thing to pay attention to at this moment is the definition of the URI pattern.  As you can see in this case, the ‚Äúsearch / {searchTerms} / *‚Äù template is fully consistent with what was defined in the description file. <br><br>  It remains only to implement this service.  When implementing, it is necessary to take into account the specified parameters when accessing the service (searchTerms, start, count) and break the search result into pages if necessary.  LINQ - Take / Skip methods are ideal for this.  Thus, the implementation of the service will be as follows. <br><br> <code>public class SearchProvider : ISearchProvider <br> { <br> public SyndicationFeedFormatter Search(string searchTerms) <br> { <br> int count; <br> int startIndex; <br> int.TryParse(WebOperationContext.Current.IncomingRequest.UriTemplateMatch.QueryParameters.Get("count"), out count); <br> int.TryParse(WebOperationContext.Current.IncomingRequest.UriTemplateMatch.QueryParameters.Get("start"), out startIndex); <br> var result = SearchBooks(searchTerms); <br> if (count &gt; 0) <br> { <br> if (startIndex &gt;= 0) <br> { <br> result = result.Skip(count * (startIndex - 1)).Take(count); <br> } <br> else <br> { <br> result = result.Take(count); <br> } <br> } <br> return new Rss20FeedFormatter( <br> new SyndicationFeed("Federated search sample", String.Empty, null, <br> from item in result <br> select new SyndicationItem(item.Element(XName.Get("name")).Value, <br> item.Element(XName.Get("description")).Value, <br> new Uri(WebOperationContext.Current.IncomingRequest.UriTemplateMatch.BaseUri.ToString() + @"/details/" + item.Element(XName.Get("id")).Value)) <br> { <br> PublishDate = DateTimeOffset.Parse(item.Element(XName.Get("date")).Value), <br> })); <br> } <br> //... <br> }</code> <br> <br>  Also in the service there are methods for displaying detailed information and performing a search.  If you wish, you can download an example and see their implementation there. <br><br>  After the service is ready and running, you need to open the service description file (.osdx) in Windows and agree with the suggestion to add a search provider.  After that, this provider will appear in the general list of search providers. <br><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7_76F5/image_6d4ffec2-ea36-463b-b1e2-f0a534b89382.png"></div><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7_76F5/image_402d20b4-55ea-47f2-a89a-8896325305bb.png"></div><br><br>  Now that the web service is running and the search provider has been successfully added, you can search the network resource directly from Windows Explorer.  In addition, you can use the preview window.  By default, the content that is located at the address to which this item refers is loaded into it (in the ‚Äúdemo application, this is‚Äú / details / {id} ‚Äù).  This address can be located HTML-content that will be displayed to the user. <br><br><div style="text-align:center;"><img src="http://blogs.gotdotnet.ru/personal/sergun/content/binary/WindowsLiveWriter/Windows7_76F5/image_17988c60-e595-4d1b-bf3d-316ced15779c.png"></div><br><br>  As you can see, the implementation of the search provider for Windows 7 Federated Search is very simple, however, it can make using your data much more convenient and easier.  One of the most successful examples of implementing a federated search by external sources is the search provider for Sharepoint-based corporate sites.  Why don't we also implement this functionality for our applications? <br><br>  Demo application: <br>  <a href="http%253A%252F%252Fblogs.gotdotnet.ru%252Fpersonal%252Fsergun%252Fcontent%252Fbinary%252FWindowsLiveWriter%252FWindows7_76F5%252FFederatedSearchProviderSample.zip">FederatedSearchProviderSample.zip</a> </div><p>Source: <a href="https://habr.com/ru/post/62027/">https://habr.com/ru/post/62027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../62021/index.html">Comparison of games for programmers</a></li>
<li><a href="../62023/index.html">ZFDebug</a></li>
<li><a href="../62024/index.html">Russian translation of the Google Wave presentation</a></li>
<li><a href="../62025/index.html">Expansion of the range of provider services - KTV</a></li>
<li><a href="../62026/index.html">Site logo and home link - an eternal dilemma</a></li>
<li><a href="../62028/index.html">Online P2P client</a></li>
<li><a href="../62030/index.html">Kerio vpn client for Gentoo</a></li>
<li><a href="../62039/index.html">ADOBE European Tour in Minsk. Open Lecture on Flex 4, Flex Builder 4, Flash Catalyst and ColdFusion June 26</a></li>
<li><a href="../62040/index.html">Several handy tools for testing the site</a></li>
<li><a href="../62043/index.html">Mandelbrot on .bat "for fun"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>