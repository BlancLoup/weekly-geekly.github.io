<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ExtJS review 4. Porting experience from the old version</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Despite the fact that the fourth version of the ExtJS framework has been published for a long time, there are not too many materials on this version. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ExtJS review 4. Porting experience from the old version</h1><div class="post__text post__text-html js-mediator-article">  Despite the fact that the fourth version of the ExtJS framework has been published for a long time, there are not too many materials on this version.  And if we consider that in the fourth version, the API has been significantly reworked, the structure of classes and the proposed architecture of the application, then I think there is something to talk about. <br><br>  In this article I will try to tell my impressions of the framework in the context of porting the existing code base to the new version;  I will also try not to forget about the pitfalls and links to useful (and not so) help pages. <br><a name="habracut"></a><br><br><blockquote>  <i>Ext4, ugh.</i>  <i>Not backward compatible with Ext3, and imposing all ordering to make it "easier".</i>  <i>The Windows Vista of Javascript frameworks</i> </blockquote>  (one of the comments on <a href="http://stackoverflow.com/">stackoverflow.com</a> ) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ExtJS 4 is incompatible with previous versions of the framework. <br>  This means that your application written for any other version of the framework will not work (except in trivial cases).  It will happen for the following reasons: <br><ol><li>  Changed requirements for application architecture </li><li>  The class structure has changed </li><li>  Partially changed API semantics </li></ol><br><br><h4>  Application architecture </h4><br>  The most significant change concerns the architecture: ExtJS4 now preaches the MVC pattern on the client side.  All the ‚Äúbusiness logic‚Äù of your component must be moved to the ‚ÄúController‚Äù entity, and what the visual interface provides is to make the ‚ÄúView‚Äù;  The logic of working with data should be moved to the ‚ÄúModels‚Äù layer (to which <a href="http://docs.sencha.com/ext-js/4-0/">Ext.data.Model itself</a> , previously known as <a href="http://docs.sencha.com/ext-js/3-4/">Ext.data.Record</a> , and <a href="http://docs.sencha.com/ext-js/4-0/">Ext.data.Store</a> storages, <a href="http://docs.sencha.com/ext-js/4-0/">belong directly</a> ). <br><br>  In fact, all visual components - panels, tables, trees, etc.  - These are claimants to be a representation or part of it.  The possibility of nesting (aggregation) of visual components is now possible only for the view level: controllers exist, in fact, in a flat layer. <br><br>  Representations report "upstairs" about changing their state through the mechanism of events. <br>  Important from the point of view of the "business problem" events must be processed in the controller.  For this, each controller has a magic <a href="http://docs.sencha.com/ext-js/4-0/">control</a> () method, with which it subscribes to events coming from some part of the view.  The controller tells you who it wants to receive events from using the CSS-like syntax called <a href="http://docs.sencha.com/ext-js/4-0/">ComponentQuery</a> : <br><pre><code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'My.controller.Header'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">extend</span></span>: <span class="hljs-string"><span class="hljs-string">'Ext.app.Controller'</span></span>, <span class="hljs-comment"><span class="hljs-comment">//... init: function() { this.control({ 'button[action=help-toggle]': { scope: this, click: this.toggleHelp }, 'mainmenuview': { scope: this, afterrender: this.menuRendered } } ); }, toggleHelp: function () { //some actions }, menuRendered: function () { //some other actions } } );</span></span></code> </pre> <br>  Here it is important to understand the following things: <ol><li>  Each controller ‚Äúsees‚Äù the <i>entire</i> available viewport, so it is often necessary to specify that you need a well-defined socket or a completely unique button, and this is not always easy. </li><li>  ComponentQuery, written in a parameter to control (), is an event selection rule, and it acts dynamically.  This means that for any event from view the application decides whether this handler can be called in the controller or not. </li></ol><br>  Thus, what was previously encapsulated in one component, which could be easily reused, now turns out to be broken into several separate parts: a set of "mindless" representations, a set of models and a set of controllers.  This creates an advantage for small applications with statically defined elements and serious difficulties for pages with dynamic component creation (you can read about such a problem, for example, <a href="http://www.sencha.com/forum/showthread.php%3F136613-MVC-concept-is-unusable%26s%3D059ea5a8eedb737270f80cc42a70f4dd">here</a> ). <br><br><h4>  Classes and components </h4><br>  In the fourth version of the framework, the structure of standard classes has been seriously revised.  The names of the classes themselves have become more concise, the division of responsibilities between the classes is more thoughtful. <br>  I was pleased, for example, that the read / write logic for the Store is now really encapsulated in <a href="http://docs.sencha.com/ext-js/4-0/">Ext.data.proxy.Proxy</a> (earlier, for example, to override the work with the RESTful server, it was necessary to overlap both the corresponding methods in Proxy and in the repository - in the onWrite, onRead and onUpdate methods). <br>  In addition, there is no longer that strange situation with <a href="http://docs.sencha.com/ext-js/3-4/">GroupingStore</a> , when you had to choose whether the Store will work with JSON (JsonStore), XML (XmlStore) data or it will be able to group data (GroupingStore) for the table, and all these 3 classes were on one hierarchy level. <br><br>  In some cases, the behavior of objects has become more predictable.  So, now before the component is rendered (before the 'render' event), its items collection is of type MixedCollection, not an array, <a href="http://habrahabr.ru/blogs/javascript/127908/">as before</a> (a trifle, but nice), and the Ext.grid.Panel table is now self-processing the selection loss after reloading the storage (earlier this situation had to be described manually). <br><br>  ExtJS 4 does not change the prototypes of standard javascript classes. <br>  So, now the utilitarian functions that were previously added to the prototypes (Function. <a href="http://docs.sencha.com/ext-js/3-4/">CreateDelegate</a> (), String. <a href="http://docs.sencha.com/ext-js/3-4/">Format</a> (), Array. <a href="http://docs.sencha.com/ext-js/3-4/">IndexOf</a> ()) are rendered into separate sinlet objects (Ext.Function. <a href="http://docs.sencha.com/ext-js/4-0/">Bind</a> (), Ext.String. <a href="http://docs.sencha.com/ext-js/4-0/">Format</a> ( ) and Ext.Array. <a href="http://docs.sencha.com/ext-js/4-0/">indexOf</a> () respectively). <br><br><h4>  API changes </h4><br>  In most cases, the names of the methods also became more concise, but as a fact, they have changed.  Accordingly, you will need to spend time trying to make sure everything in your application works correctly.  For example, the SelectRow () method of the SelectionModel now corresponds to the new select (). <br><br>  From the bad: the semantics of working with storages working with remote data has changed a lot.  I was surprised when it turned out that the Store no longer has ‚Äúpens‚Äù in order to add an additional set of parameters for the request to the server.  No analogues setBaseParam () or load (params) is no longer provided. <br>  The underlying Proxy class can work with any set of parameters, as before, but at the Store level there is a well-defined set of keys that are given to the Proxy. <br><br>  <i>UPD</i> The comments suggest that <a href="http://habrahabr.ru/blogs/extjs/132978/">you can</a> actually pass additional parameters (thanks to <a href="https://habrahabr.ru/users/mrslonoed/" class="user_link">MrSLonoed</a> for the addition). <br><br>  Obviously, as an alternative to <a href="http://docs.sencha.com/ext-js/3-4/">setBaseParam</a> (), the repositories support the so-called filters and sorters (Filters and Sorters).  These entities can be used both locally (working on an existing dataset) or remotely (being sent to the server as parameters).  What is characteristic: for filters and sorters there is no flexible possibility of serialization into HTTP parameters.  So, the filters will always be serialized as follows. <br> <code><a href="http://mywebserver/"></a> mywebserver?{otherparams}&amp;filters={your serialized filters}</code> <br>  You can control the serialization of filters only within the <code>{your serialized filters}</code> , and you will not be able to get rid of the filter parameter using standard tools. <br><br>  Here is an example of how filters can be used to add additional parameters to a query: <br><br><pre> <code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'My.proxy.Ajax'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">extend</span></span>: <span class="hljs-string"><span class="hljs-string">'Ext.data.proxy.Ajax'</span></span>, <span class="hljs-attr"><span class="hljs-attr">alias</span></span>: <span class="hljs-string"><span class="hljs-string">'proxy.myajax'</span></span>, <span class="hljs-attr"><span class="hljs-attr">filterParam</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">getParams</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">params, operation</span></span></span><span class="hljs-function">) </span></span>{ params = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.callParent(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> filters = operation.filters; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.filterParam === <span class="hljs-string"><span class="hljs-string">''</span></span> &amp;&amp; filters &amp;&amp; filters.length) { Ext.apply(params, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.encodeFilters(filters)) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> params; }, <span class="hljs-attr"><span class="hljs-attr">encodeFilters</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">filters</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f, po = {}, i; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; filters.length; ++i) { f = filters[i]; po[f.property] = f.value; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> po; } } );</code> </pre> <br>  UPD: Pay attention to an important detail: by default, the added filters will work both remotely and locally.  This means that if you add the filter ‚Äúq = myValue‚Äù, this filter will be serialized into the corresponding HTTP parameter (which is good), but then it will be applied to the Store after loading.  And to catch the reason for the disappearance of records, when they were all received, you can also take a long time.  Therefore, look at the parameter Store.  <a href="http://docs.sencha.com/ext-js/4-0/">filterOnLoad</a> . <br><br>  The second unpleasant moment is also associated with AJAX.  For some reason, ExtJS4 lacks the simple case of Writer, which sends an object as a set of HTTP key-value parameters.  Its implementation is trivial, but the ‚Äúsediment remains‚Äù: <br><pre> <code class="javascript hljs">Ext.define(<span class="hljs-string"><span class="hljs-string">'My.data.writer.Http'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">extend</span></span>: <span class="hljs-string"><span class="hljs-string">'Ext.data.writer.Writer'</span></span>, <span class="hljs-attr"><span class="hljs-attr">alias</span></span> : <span class="hljs-string"><span class="hljs-string">'writer.http'</span></span>, <span class="hljs-attr"><span class="hljs-attr">writeRecords</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request, data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Ext.isArray(data)) { data = data[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } Ext.apply(request.params, data); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request; } } );</code> </pre><br><br><h4>  Dynamic loading </h4><br>  The new version of the framework provides the ability to dynamically load JS-resources (including cross-domain and even for the <code>file://</code> protocol - for example, the help can be opened simply as an html-file from the file system).  In this regard, it is recommended that in each of its classes it is explicitly prescribed the names of the classes or packages on which this class depends. <br>  This is done by calling Ext.require () or using the <a href="http://docs.sencha.com/ext-js/4-0/">same section</a> in the body of the class declaration. <br><br>  When the source code is enabled, ExtJS ensures that the class graph is correctly loaded in such a way that all dependencies are correctly taken into account. <br>  A new requirement related to the location of source codes in the file system is associated with the same feature: the full class name must unambiguously determine the location of the file in the file system (as is customary, for example, in Java or in the Zend Framework in PHP). <br><br>  ExtJS sources now also have several options: <br><ul><li>  ext-all-debug.js </li><li>  ext-all-debug-w-comments.js </li><li>  ext-all-dev.js </li><li>  ext-all.js </li><li>  ext-debug.js </li><li>  ext-dev.js </li><li>  ext.js </li></ul><br><br>  The ext * .js files that do not contain the all suffix in the name are sources with dynamic loading enabled.  Such resources should be used only in debug mode. <br>  By the way, ‚Äúaccidentally‚Äù included dynamic resource loading is another source of ExtJS ‚Äúsilent‚Äù crashes, if the resource being loaded contains a syntax error.  However, <a href="http://jslint.com/">JSLint</a> has not been canceled yet. <br><br>  More information about the goals of each of the options "linking¬ª ExtJS can be found <a href="http://www.sencha.com/forum/showthread.php%3F142565-Description-of-the-files-ext-all.js-ext-debug.js-ext-all-debug.js-ext-dev-...%26p%3D643539%26viewfull%3D1">here</a> . <br><br>  Read the source and be good programmers! <br>  Thanks for attention </div><p>Source: <a href="https://habr.com/ru/post/132978/">https://habr.com/ru/post/132978/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132973/index.html">Testing ICQ Web Clients</a></li>
<li><a href="../132974/index.html">Kodorebus or strategy pattern on .Net 4.0</a></li>
<li><a href="../132975/index.html">Extend conky functionality: add function to display MPD track date</a></li>
<li><a href="../132976/index.html">Conversion function stdClass to SimpleXml</a></li>
<li><a href="../132977/index.html">DasKeyboard Ultimate S Review (Perhaps the first in several years)</a></li>
<li><a href="../132979/index.html">Can we make the software world better?</a></li>
<li><a href="../132981/index.html">The main format of configuration files in your projects:</a></li>
<li><a href="../132982/index.html">Fear VS Greed in startups</a></li>
<li><a href="../132983/index.html">OS.js: JavaScript desktop</a></li>
<li><a href="../132985/index.html">Neutrino speed rechecked</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>