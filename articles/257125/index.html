<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to earn points without even starting the game</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One evening, while sitting at the computer, I came across one indie game called ‚ÄúShoot First‚Äù (the game can be downloaded absolutely free from the aut...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to earn points without even starting the game</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/a15/a1d/4cd/a15a1d4cd4a9063963d47d1e3ee32b13.gif" alt="image"><br><br>  One evening, while sitting at the computer, I came across one indie game called <b>‚ÄúShoot First‚Äù</b> (the game can be <a href="http://teknopants.com/2011/05/shoot-first/">downloaded</a> absolutely free from the author‚Äôs site, and for donating any size you will get a special version with two new weapons and another type levels).  Its gameplay is pretty straightforward - the player needs to run around the floors in search of a passage to the next level, if necessary collecting various items (maps, keys, etc) and simultaneously killing the enemies who have met on his way.  In general, a sort of action <a href="http://en.wikipedia.org/wiki/Roguelike">roguelike</a> .  Despite the seeming simplicity, the game hooked me pretty much, and I spent more than one hour trying to get as far as possible and earn as many points as possible. <br><br>  Speaking of glasses.  After the death of the character and entering the name, the game displays an online table of records: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/a4e/d45/ea5/a4ed45ea556219e165e2d37fec36fb86.png" alt="image"><br><br>  Having played enough, I decided to figure out how it works and try to deceive the game, saying that I earned an unreal amount of points. <br><br>  How was the process, and what came of it, read under the cut (carefully, a <b>lot of screenshots</b> ). <br><a name="habracut"></a><br>  The first thing that comes to mind, probably, to any person who has ever been engaged in dishonest money in sign-player games, is <a href="http://www.artmoney.ru/rus.htm">ArtMoney</a> .  Well, why not? <br><br>  We start the game, earn some ‚Äúunusual‚Äù number of points, load the process into ArtMoney and look for this very value.  After much torment, I never managed to find the integer value with the number of points I had collected, which, if I changed, I would achieve my goal. <br><br>  Well, okay, let's go the other way. <br><br>  Obviously, the game climbs into the network to get the record table, and interaction with the network in Windows, as you know, lies on the shoulders of <a href="http://en.wikipedia.org/wiki/Winsock">WinSock</a> , the implementation of which is in <b>WS2_32.dll</b> .  We take WPE Pro into our hands (unlike, for example, Wireshark, it can intercept packages of a specific application, which is much more convenient in our case), indicate the process of our game, die and look at the result: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/889/c1c/fc2/889c1cfc2fda0b8bb429a57f3b67d473.png" alt="image"><br><br>  As you can see, the game sends to teknopants.com. GET requests of the form. <br><br>  /games/shootfirst/score12.php?alltime=15&amp;monthly=15&amp;weekly=15&amp;daily=15&amp;name=% <b>name%</b> &amp; score = <b>% score%</b> &amp; data = Floor% 20 <b>% floor%%</b> 20% 5b <b>% player%</b> P% 5d &amp; hash = <b>% hash%</b> <br><br>  where <b>% name%</b> is the player's name, <b>% score%</b> is the number of points, <b>% floor%</b> is the floor on which the player was killed, <b>% player%</b> is the player's number (two people can play simultaneously with one computer - <b>1P</b> and <b>2P</b> respectively ) and <b>% hash%</b> - a hash, obviously, necessary to verify the correctness of the sent data. <br><br>  Please note that the GET request simultaneously contains information about what data you need to get (alltime, weekly and daily parameters) and what data you need to add (name, score, data and hash parameters). <br><br>  It is clear that you can‚Äôt just change the number of points earned in the sent GET request, for this we also need to generate a new hash.  Solving the problem by conducting experiments is almost pointless, so it's time to take on another tool - this time <a href="http://www.ollydbg.de/">OllyDbg</a> . <br><br>  But before loading the process into OllyDbg, let's check if our game is packed.  Take <a href="https://github.com/horsicq/old-DIE">DiE</a> , open the executable file of the game and see the following picture: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5c1/de3/192/5c1de3192e2b3b05f7121189ab4fcc72.png" alt="image"><br><br>  It turns out that with high probability the game is not protected by anything. <br><br>  Well, great.  Then we run the test subject in OllyDbg and try to find a place where the game makes GET requests.  In WinSock, there are two functions that are directly responsible for sending data - <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms740149(v%3Dvs.85).aspx">send</a> and <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms742203(v%3Dvs.85).aspx">WSASend</a> .  Switch to the module of our executable file (Alt-E -&gt; Shoot First% version% .exe) and look for them in the list of "Intermodular calls" (right-click on the CPU window -&gt; Search For -&gt; All intermodular calls).  Oddly enough, but there is no one or the other functions.  Two options come to mind at once - a developer could copy their code from <b>WS2_32.dll</b> directly into their application or simply call them from some other module.  The second option is much easier to track, so let's start with it. <br><br>  We look at the directory with the game for some additional dynamic libraries.  We find one that hints by its name that our searches will be short-lived: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8fa/900/eb7/8fa900eb722ad87c1f05c87512dcef00.png" alt="image"><br><br>  Switch to it (Alt-E -&gt; plaidscores.dll) and also look for <b>send</b> and <b>WSASend calls</b> .  There is only one: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/301/6f1/5f2/3016f15f222c3c21ed52b947dd14e48a.png" alt="image"><br><br>  Put a software breakpoint on it (left click -&gt; F2), die (of course, in the game) and ... stop before calling the <b>send</b> function: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd9/c3a/28d/bd9c3a28db6ba16edd6225858662a681.png" alt="image"><br><br>  Arguments are visible on the stack, the most interesting of which is <b>Data</b> for us.  If you look at what is located at this address (right click -&gt; Follow in Dump), then we will see the GET request that is already familiar to us: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0de/069/482/0de0694827694d13759c937972f3c99e.png" alt="image"><br><br>  Thus, we realized that sending data to the server is carried out in the <b>plaidscores.dll</b> module.  Obviously, the module <b>Shoot First% version% .exe</b> must somehow tell the dll some data (at least, these are all the same points, while the hash, for example, can be generated already in the dll).  There are, of course, options for transferring data here, in general, a whole mass (files, registry, sockets, etc), but in most cases, developers simply call the exported function from the dll with the appropriate arguments.  We look from where we were called (for this we need to open the call stack with Alt-K): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2a/05a/c6d/e2a05ac6dc041bfb31ae9853b4cbc374.png" alt="image"><br><br>  As you can see, for sending data, the exe-module calls us from the place allocated on the screenshot.  We remove the breakpoint from the send function, jump to the call (right-click -&gt; Show call) and set the software breakpoint with F2.  We die again and look at the situation: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/af2/65d/990/af265d9906a62b7c876c2e2c1d1efd39.png" alt="image"><br><br>  What do we see here? <br><br>  First, the name of the exported function is <b>psSubmit</b> . <br>  Secondly, the state of the stack at the time of its call. <br><br>  Unfortunately, it is guaranteed to understand how many arguments are passed to the exported function, it is possible only if their names were decorated (if you wish, you can read about it, for example, <a href="http://stackoverflow.com/questions/1548637/is-there-any-native-dll-export-functions-viewer">here</a> ).  Well, let's check.  Run <a href="http://www.dependencywalker.com/">Dependency Walker</a> , open our dll and look at the list of exported functions: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4c5/d41/8b7/4c5d418b71c6bf8bde1640ec0df481fd.png" alt="image"><br><br>  Unfortunately, their names are not decorated.  In this case, we will have to analyze the code before calling the <b>psSubmit</b> function in search of PUSHs.  Most likely, all 4 PUSHs in the case block of the above screenshot are the arguments of our investigated function.  Let's look at them again: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c39/f80/9a0/c39f809a0ebde740ff21c479ac64987c.png" alt="image"><br><br>  With the first and last arguments of the questions should not arise - this is the name of the player, the floor on which he died, and 1P / 2P.  Most likely, one of the remaining arguments is our goal - points.  To understand which one is specifically of them, let's earn some of them before dying (before that I died without scoring).  Press F9, perform the task, die and stop at the same place, but with other data on the stack: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/82d/aed/a5f/82daeda5f096902cec77fe01466dbb0a.png" alt="image"><br><br>  I scored 9 points, and the value of one of the arguments really changed - now in its place 0x40220000 is flaunted.  On 9 in hex, it doesn't look like much, so let's do some more experiments: <br><br>  Number of points in the game - the value of the argument <br>  6 - 0x40180000 <br>  7 - 0x401C0000 <br>  8 - 0x40200000 <br>  9 - 0x40220000 <br>  10 - 0x40240000 <br><br>  As you can see, the values ‚Äã‚Äãare increasing unevenly, so that we are guaranteed to reverse the conversion right now.  But at least let's check that when this value changes, before the <b>psSubmit</b> call <b>, the</b> game really thinks that we scored a different number of points, and sends fake data to the server.  We die without earning points, stop before calling <b>psSubmit</b> and change (left click -&gt; Ctrl-E) the value of the corresponding argument to, say, 0x40220000, i.e.  9 points.  Press F9 and see that our fake value really went to the server. <br><br>  Now we still have two unsolved problems: <br><ul><li>  What format are the points earned in? </li><li>  Why do we need another argument, which in all the experiments was zero </li></ul><br><br>  The second point is not to say that the problem, but no one likes, when what he is studying is not explicable, right?  However, let us dwell on the first paragraph for now. <br><br>  Once <b>plaidscores.dll</b> forms a GET request with a ‚Äúreadable‚Äù number of points, it receives an ‚Äúencoded‚Äù version as input, it knows how to do the transformation we need (in principle, the exe module knows it, since it can display the number points to the player).  In this regard, we can now take up the study of the decoding algorithm, but what if there is a simpler way?  We have forgotten that we have a hash that looks a lot like MD5.  Recalling that WinAPI has a function for getting an MD5 hash (and some other types) for the data passed to it, we can assume that the game simply calls it to get this hash, so that we can understand what the game takes hash.  If there is such a call, it should be in <b>plaidscores.dll</b> , because, as we have seen, only four arguments are passed to <b>psSubmit</b> , each of which is not very similar to the MD5 hash. <br><br>  The function in question is called <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa379947(v%3Dvs.85).aspx">CryptGetHashParam</a> (in fact, there are a number of functions that need to be called one by one, but everything leads to it), so let's look for it among the ‚ÄúIntermodular calls‚Äù.  Unfortunately, there was no such function. <br><br>  Well, nothing - again we stop before calling <b>psSubmit</b> , jump inside this function by pressing F7 and put a hardware breakpoint on the memory area with our glasses.  To do this, look for the address where points are stored in ‚ÄúMemory Dump‚Äù (you can use Ctrl-G) -&gt; right-click on the first byte -&gt; Breakpoint -&gt; Hardware, on access -&gt; Dword.  Press F9 and get to the following place: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f58/ee8/460/f58ee8460792bd086536c8ead747226e.png" alt="image"><br><br>  Unlike software, hardware breakpoints stop at instructions that follow after performing actions of interest to us, so we look at what is located at 0x09F60195.  Here you can see the <a href="http://x86.renejeschke.de/html/file_module_x86_id_100.html">FLD</a> instruction: <br><br><blockquote>  Pushes the register stack.  Extended-precision floating-point format </blockquote><br><br>  So that's it!  It turns out that the value is not coded at all, but is merely represented as a floating point number!  If you look at the register ST0, then we really see the number of our points: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a5/53a/d1c/0a553ad1c09a34d828da4d2b710da9cc.png" alt="image"><br><br>  Frankly, I did not expect this, because it is simply impossible to earn a non-integer number of points (at least, visually and according to the table of records). <br><br>  For a final check of our assumptions, you can use some <a href="http://gregstoll.dyndns.org/~gregstoll/floattohex/">online service</a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/188/167/944/1881679442ceca3cd61844be8341112a.png" alt="image"><br><br>  Moreover, as you can see, FLD refers not only to the value we are examining, but also to the last unknown argument.  Therefore, it is an 8-byte floating point number. <br><br>  Looking back, I understand that Art Money could help in this situation immediately, if I knew that it was not necessary to look for an integer value at all: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/998/7a1/1e7/9987a11e7f0a13312a53b5c69af19fa3.png" alt="image"><br><br>  However, is this really all?  It‚Äôs not very convenient to use this solution, so I decided to write a separate program that will send a GET request with user-defined data (to simplify the code, I removed some checks): <br><br><pre><code class="hljs rust">#include &lt;boost/scope_exit.hpp&gt; #define WIN32_LEAN_AND_MEAN #include &lt;Windows.h&gt; #include &lt;cstdlib&gt; #include &lt;iostream&gt; #include &lt;sstream&gt; typedef void(__cdecl *submit_proc_t)(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>*, double, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>*); int main() { HMODULE scores_dll = LoadLibraryA(<span class="hljs-string"><span class="hljs-string">"PlaidScores.dll"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (scores_dll == NULL) { std::cerr &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Unable to load DLL \n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXIT_FAILURE; } BOOST_SCOPE_EXIT_ALL(scores_dll) { FreeLibrary(scores_dll); }; submit_proc_t submit_proc = (submit_proc_t)GetProcAddress(scores_dll, <span class="hljs-string"><span class="hljs-string">"psSubmit"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (submit_proc == NULL) { std::cerr &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Unable to find submit procedure \n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXIT_FAILURE; } std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Enter your name: "</span></span>; std::string name; std::getline(std::cin, name); std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Enter scores count: "</span></span>; int scores; std::cin &gt;&gt; scores; std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Enter floor: "</span></span>; int floor; std::cin &gt;&gt; floor; std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Enter player number: "</span></span>; int player_number; std::cin &gt;&gt; player_number; std::ostringstream osstr; osstr &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Floor "</span></span> &lt;&lt; floor &lt;&lt; <span class="hljs-string"><span class="hljs-string">"["</span></span> &lt;&lt; player_number &lt;&lt; <span class="hljs-string"><span class="hljs-string">"P]"</span></span>; submit_proc(name.c_str(), scores, osstr.<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>().c_str()); std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Done \n"</span></span>; }</code> </pre> <br>  We start, we look excitedly at the table of records, and ... Nothing happens. <br><br>  At first glance, everything looks the same as in the case of calling <b>plaidscores.dll</b> from the game.  What went wrong?  Let's try to figure it out. <br><br>  We load our executable file into OllyDbg, set the breakpoint on <b>psSubmit</b> and look at the stack: <br><br><img src="https://hsto.org/files/2cb/3e5/afe/2cb3e5afe1cd40fb850750c886f4948c.PNG" alt="image"><br><br>  Visually, everything looks exactly the same as in the case of the game.  Maybe we made a mistake with the number of arguments?  But before undertaking the analysis of PUSHs before calling <b>psSubmit</b> from the exe-module of the game, remember how the work with dynamic libraries in Windows usually happens.  You have probably heard more than once that <b>DllMain</b> is a function that is rather limited by what you can do in it.  However, very often there is a situation when the DLL needs to initialize some data at startup in order not to do it constantly when calling each exported function.  In this regard, DLL developers often provide an exported function for initialization (and also often for deinitialization) in which they perform all the actions they need.  Let's see if there is such a function in <b>plaidScores.dll</b> using Ctrl-N: <br><br><img src="https://hsto.org/files/73d/4ac/4d1/73d4ac4d1bc04cbf92ee42e8478ade53.PNG" alt="image"><br><br>  As you can see, it really is.  We start the game in OllyDbg, set a bryak on <b>psInit</b> , look where we were called from and see that, most likely, it takes two arguments: <br><br><img src="https://hsto.org/files/34c/602/06e/34c60206e66243838060443d335abbf8.PNG" alt="image"><br><br>  One of them is the link to which you must perform a GET request (http://teknopants.com/games/shootfirst/score12.php), and the other is the string ‚Äú5hoo7first12‚Äù. <br><br>  Based on the new data, we will slightly change the source code of our program: <br><br><pre> <code class="hljs rust">#include &lt;boost/scope_exit.hpp&gt; #define WIN32_LEAN_AND_MEAN #include &lt;Windows.h&gt; #include &lt;cstdlib&gt; #include &lt;iostream&gt; #include &lt;sstream&gt; typedef void(__cdecl *init_proc_t)(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>*, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>*); typedef void(__cdecl *submit_proc_t)(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>*, double, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>*); int main() { HMODULE scores_dll = LoadLibraryA(<span class="hljs-string"><span class="hljs-string">"PlaidScores.dll"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (scores_dll == NULL) { std::cerr &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Unable to load DLL \n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXIT_FAILURE; } BOOST_SCOPE_EXIT_ALL(scores_dll) { FreeLibrary(scores_dll); }; init_proc_t init_proc = (init_proc_t)GetProcAddress(scores_dll, <span class="hljs-string"><span class="hljs-string">"psInit"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (init_proc == NULL) { std::cerr &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Unable to find init procedure \n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXIT_FAILURE; } submit_proc_t submit_proc = (submit_proc_t)GetProcAddress(scores_dll, <span class="hljs-string"><span class="hljs-string">"psSubmit"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (submit_proc == NULL) { std::cerr &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Unable to find submit procedure \n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EXIT_FAILURE; } std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Enter your name: "</span></span>; std::string name; std::getline(std::cin, name); std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Enter scores count: "</span></span>; int scores; std::cin &gt;&gt; scores; std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Enter floor: "</span></span>; int floor; std::cin &gt;&gt; floor; std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Enter player number: "</span></span>; int player_number; std::cin &gt;&gt; player_number; std::ostringstream osstr; osstr &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Floor "</span></span> &lt;&lt; floor &lt;&lt; <span class="hljs-string"><span class="hljs-string">"["</span></span> &lt;&lt; player_number &lt;&lt; <span class="hljs-string"><span class="hljs-string">"P]"</span></span>; init_proc(<span class="hljs-string"><span class="hljs-string">"http://teknopants.com/games/shootfirst/score12.php"</span></span>, <span class="hljs-string"><span class="hljs-string">"5hoo7first12"</span></span>); submit_proc(name.c_str(), scores, osstr.<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>().c_str()); std::cout &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Done \n"</span></span>; }</code> </pre><br>  We start and enjoy - this time the result appeared in the table of records. <br><br>  How to find out what is the maximum number of points?  There are two options - either the author performs the necessary checks directly in the dll, or on the server.  In both cases, the easiest way is to search the module for strings with similar content, so we right-click on the CPU -&gt; Search for -&gt; All referenced text strings window and carefully go over the list.  Your attention should attract the following lines: <br><br><img src="https://hsto.org/files/94a/545/e5d/94a545e5df6d4d78a9d392760f187d53.PNG" alt="image"><br><br>  We set breakpoints in the places where they are accessed, as well as on the call to the <b>send</b> function, we transfer a huge amount of points and see that the application makes a GET-request, but after executing it, it understands that something went wrong and really refers to the string with a description of the possible cause of the error.  After that, you can conduct a series of experiments and finally find out that the maximum allowable value is 2 ^ 31 - 1. The results of the experiments can be seen in the screenshot: <br><br><img src="https://hsto.org/files/05a/ca9/939/05aca9939fe3415d92b9dcb63213642c.PNG" alt="image"><br><br>  By the way, the player number can be made more than two - for example, 999P works fine. <br><br><h3>  Afterword </h3><br>  I do not in any way agitate to break the game, falsify the results and in every way interfere with the normal gameplay (the pleasure of the game is in any case achieved by other things).  With this article I just wanted to demonstrate one of the solutions to the problem that arose on my way.  I already wrote to the author of the game. <br><br>  I hope that the article seemed interesting to someone. </div><p>Source: <a href="https://habr.com/ru/post/257125/">https://habr.com/ru/post/257125/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../257115/index.html">Simple control of arduino via the Internet</a></li>
<li><a href="../257117/index.html">Lab penetration testing "Test lab v.7" is open</a></li>
<li><a href="../257119/index.html">Lectures of the Technosphere. Semester 2 Modern methods and tools for building information retrieval systems</a></li>
<li><a href="../257121/index.html">Image and video analysis. Image segmentation</a></li>
<li><a href="../257123/index.html">Develop a simple game in the game maker. Episode 1</a></li>
<li><a href="../257127/index.html">Microsoft showed Project Astoria: what it will look like using Android code in Windows applications</a></li>
<li><a href="../257129/index.html">Creating plug-ins for AutoCAD using the .NET API (part 4 - inserting primitive objects)</a></li>
<li><a href="../257131/index.html">WS2812B protocol on STM32 without empty loops and interrupts. And how to make the right rainbow</a></li>
<li><a href="../257133/index.html">Beeline automatically adds a Mail.Ru search toolbar.</a></li>
<li><a href="../257135/index.html">Transhumanism to the masses: unlocking the device on Android Lollipop with an implanted NFC chip</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>