<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What to choose for a 3D site - Three.js or Blend4Web?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have known Blender for many years, using Unity for my games, but a complete newcomer to WebGL. However, the future is precisely for this technology,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What to choose for a 3D site - Three.js or Blend4Web?</h1><div class="post__text post__text-html js-mediator-article">  I have known Blender for many years, using Unity for my games, but a complete newcomer to WebGL.  However, the future is precisely for this technology, and it would be nice to deal with its use.  Unfortunately, the Unity exporter for WebGL is not yet working and a different tool is needed. <br><br>  I do not like to reinvent the wheel and prefer ready-made solutions.  Blend4Web found earlier looks very tempting (integration with Blender, quality exporter, etc.), but there are quite a few other libraries and platforms for working with WebGL. <br><br>  The eternal question: what to choose a newbie?  I worked with the Blend4Web and Three.js platforms.  What came of it - read on. <br><img src="https://habrastorage.org/files/281/b63/5e6/281b635e644048839153fb27bdfa4784.jpg" alt="image"><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Basic knowledge: <br><ul><li>  <a href="https://www.blend4web.com/ru/">Blend4Web</a> is tightly integrated with Blender, so Blender is installed and configured accordingly. </li><li>  <a href="http://threejs.org/">Three.js</a> - software library.  Able to import scenes and objects from the same Blender.  To do this, you also need to install a special plugin in the editor. </li></ul><br>  I will not consider in detail the process of setting up both platforms, but I will touch on one important point.  Since the systems are designed exclusively for creating WebGL applications, for testing they need to raise a local server.  In the case of Blend4Web, after deploying the SDK, you will already get a working server at: localhost: 6687 (the port can be changed in the settings).  For Three.js, this server will have to be installed separately.  For example, use WampServer or select the appropriate one from the Utils folder (SDK Three.js). <br><br>  However, you can do it easier and configure the browser to load local data.  Just keep in mind that with such a browser you should not go on the real Internet. <br><br><h4>  Work with Three.js </h4><br>  Do you think the familiar ‚ÄúHello World‚Äù?  No, the specialized ‚Äúhello‚Äù, but only from the 3D point of view.  First of all, I am interested in practical application and usability.  Therefore, I tried to do the most primitive - a standard scene with objects, a camera, lighting and simple animation. <br><br>  In addition, the study and work with each platform was supposed to spend no more than 3 hours (for the purity of the experiment).  A sort of marathon from scratch. <br><br>  The initial choice fell on Three.js.  So start ... <br><br>  It all starts with the documentation.  It is concise with the engine and has individual small examples for almost every function.  The SDK has a large number of practical projects. <br><br>  First, consider the preparation of HTML: <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Test<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"three.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"webGL-container"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"main.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  This universal preparation and there is nothing interesting here.  The Three.js library connects to the string.  There is a more compact version of three.min.js.  However, I decided to stop at the full version.  The executable code is in a separate main.js file.  It is in it that I am going to store the code for working with the engine. <br><br>  Creating code for Three.js begins with a scene ad, camera, and render: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> scene = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Scene(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> camera = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.PerspectiveCamera( <span class="hljs-number"><span class="hljs-number">75</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth/<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight, <span class="hljs-number"><span class="hljs-number">0.1</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> renderer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.WebGLRenderer();</code> </pre><br>  After that, you can start creating objects.  In my case, I settled on a regular cube. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> geometry = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.BoxGeometry( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> material = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.MeshBasicMaterial( { <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-number"><span class="hljs-number">0xffffff</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cube = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Mesh( geometry, material );</code> </pre><br>  Created geometry, set up color, mixed and here it is Cube.  Oh yes, you still need to add it to the scene with the scene.add (cube) command; <br><br>  Now you can do anything with this object.  For example, rotate it slightly along one axis. <br><br><pre> <code class="javascript hljs">cube.rotation.z += <span class="hljs-number"><span class="hljs-number">0.1</span></span>;</code> </pre><br>  Likewise, it is necessary to displace the camera, because by default it is created in coordinates (0,0,0), like a cube. <br><br><pre> <code class="javascript hljs">camera.position.z = <span class="hljs-number"><span class="hljs-number">5</span></span>;</code> </pre><br>  And the final finishing touch is the initialization and render call.  The entire base code of the test scene is as follows: <br><br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> scene = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Scene(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> camera = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.PerspectiveCamera( <span class="hljs-number"><span class="hljs-number">45</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth/<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight, <span class="hljs-number"><span class="hljs-number">0.1</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> renderer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.WebGLRenderer(); renderer.setSize (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth,<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight); renderer.setClearColor (<span class="hljs-number"><span class="hljs-number">0x000000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> geometry = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.BoxGeometry( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> material = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.MeshBasicMaterial( { <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-number"><span class="hljs-number">0xffffff</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cube = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Mesh( geometry, material ); scene.add( cube ); camera.position.z = <span class="hljs-number"><span class="hljs-number">5</span></span>; cube.rotation.z += <span class="hljs-number"><span class="hljs-number">0.1</span></span>; $(<span class="hljs-string"><span class="hljs-string">"#webGL-container"</span></span>).append (renderer.domElement); renderer.render(scene, camera); });</code> </pre><br>  I did not explain some points in the code, but another thing is important, the realization that for the declaration of a primitive cube in the scene, as many as 4 lines were used.  It inspired sad reflections on full-fledged models with textures, animation. <br><br>  After reading the documentation, the features of Three.js became clear.  Several types of cameras, full-fledged types of lighting, support for materials, textures, animations, stage effects are a completely credible list.  Basically, all this wealth is added to the scene as previously indicated.  For example, a lamp can be created and placed as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> light = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.PointLight(<span class="hljs-number"><span class="hljs-number">0xffffff</span></span>); light.position.set(<span class="hljs-number"><span class="hljs-number">-100</span></span>,<span class="hljs-number"><span class="hljs-number">200</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>); scene.add(light);</code> </pre><br>  As an indie game developer, I realized that the lack of an editor puts an end to the use of this library, at least for me.  But people work with her and do cool things!  And having rummaged on a site of developers, I found two interesting utilities: a plug-in under Blender and a certain editor, sharpened exclusively under Three.js. <br><br>  First of all I tried to work with the plugin.  Remember what task was assigned?  Create a scene with objects, camera and light. <br><br>  Suppose it should be a cube lying on a plane.  Indeed, there is no problem to draw all this with the help of the engine functions, and transfer the placement, rotation, and scale parameters from the same Blender, having previously created this scene in it.  But let's imagine for a minute a typical game level consisting of hundreds of objects, and it will become sickening. <br><br>  Therefore, I looked at the plugin with great hope.  With it, you can export both a single object and the entire scene (meaning only objects in the scene).  And with animation, bones, textures.  It looked very tempting.  However, in practice, everything was more complicated. <br><br>  The epic began with an attempt to download only one model.  There are no complaints about the work of the exporter in JSON.  The code is generated intuitively and complex settings are not there.  But to introduce it into the engine was not easy. <br><br>  API Three.js contains more than a dozen loaders for various objects.  Naturally, I chose the universal THREE.JSONLoader.  This was facilitated by the official documentation and a large number of lessons that I reviewed.  That's just a damn thing it did not work! <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// var loader = new THREE.JSONLoader(); loader.load( "plane.json", createScene1 ); //    function createScene1( geometry, materials ) { mesh = new THREE.Mesh( geometry, new THREE.MeshFaceMaterial( materials ) ); scene.add( mesh ); }</span></span></code> </pre><br>  I experimented with different settings of the exporter, tried other bootloader designs, drawn from lessons on the Internet, alternative functions - the result is zero.  The console persistently repeated to me: ‚ÄúIncorrect JSON‚Äù, and the screen showed a pristine clean look. <br><br>  Where do you think the snag was?  It is ridiculous to say - in the absence of light.  Yes, this is a stupid mistake of a person who is used to working in full-fledged editors.  In the same Blender or Unity, removing light sources made it possible to see objects in the scene, right there is a clean program code.  But the absence of such a seemingly obvious feature in official tutorials has spoiled a lot of my blood.  By the way, the error ‚ÄúIncorrect JSON‚Äù has not disappeared.  Well, okay, turn to the loading scene. <br><br>  Actually - this is the most important thing that interested me.  Ability to configure and place objects in Blender, overtake them in JSON and manage them in code.  An Internet search led me to the THREE.SceneLoader function.  Like what you need! <br><br>  But there is no such function in the official API reference.  Further searches on the network brought information that this function was removed as unnecessary.  It was a cool bummer ... <br><br>  The option with the placement of objects in Blender and the transfer of pens to the code I dismissed immediately.  The productivity of this approach is questionable.  In addition, one would have to take into account the inconsistency between the Blender and Three.js coordinate systems.  So I decided to look at the editor proposed by the Three.js developers.  It is available at the link on the official site. <br><br>  So what we have.  Launched in the browser, the 3D editor allows you to import models, arrange them and perform customization.  Back you can export a separate object, the scene as a JSON and a solid application with a wrapper in HTML.  I didn‚Äôt study the editor, because I hadn‚Äôt found the JSON scene loading function in my project before.  In addition, two in the morning signaled that the time allotted for Three.js was clearly over. <br><br>  The working code of the test application, if anyone is interested.  Experimental constructions deleted: <br><br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> container,scene,camera,render,cube; init(); render(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ container = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById( <span class="hljs-string"><span class="hljs-string">'webGL-container'</span></span> ); camera = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.PerspectiveCamera( <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth / <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">10000</span></span> ); camera.position.z = <span class="hljs-number"><span class="hljs-number">10</span></span>; scene = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Scene(); light = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.DirectionalLight( <span class="hljs-number"><span class="hljs-number">0xffffff</span></span> ); light.position.set( <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> ).normalize(); scene.add( light ); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> loader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.JSONLoader(); loader.load( <span class="hljs-string"><span class="hljs-string">"cube.json"</span></span>, createScene1 ); renderer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.WebGLRenderer( { <span class="hljs-attr"><span class="hljs-attr">antialias</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } ); renderer.setPixelRatio( <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.devicePixelRatio ); renderer.setSize( <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight ); container.appendChild( renderer.domElement ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createScene1</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> geometry, materials </span></span></span><span class="hljs-function">) </span></span>{ cube = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Mesh( geometry, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.MeshFaceMaterial( materials ) ); scene.add( cube ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ requestAnimationFrame( render ); cube.rotation.y +=<span class="hljs-number"><span class="hljs-number">0.01</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  renderer.render( scene, camera ); } });</span></span></code> </pre><br><br><h4>  Work with Blend4Web </h4><br>  I already <a href="http://habrahabr.ru/post/260391/">considered</a> Blend4Web from the point of view of the designer and I was curious about what this platform could offer the programmer.  Here, in comparison with Three.js, on the contrary, you are afraid of too close integration with the editor, and thereby reducing the possibility of programming. <br><br>  Blend4Web offers all the visual work to do in Blender: adjust the scene, create models and arrange them, control physics or particles.  Therefore, there is no such problem as with Three.js.  But to get a complex application only visual means will not succeed. <br><br>  The task remains the same - creating a simple scene with several objects, a camera, a light source.  Plus simple animation of one object programmatically.  And, of course, the time limit is 3 hours.  So let's see how easy and complete the documentation will be, working with the API is intuitive.  Go‚Ä¶ <br><br>  The official website has clear instructions on the location of the project files in the SDK folders.  So Blender projects are stored in the SDK / Blender / ProjectName folder, and the resources and the actual result of the export to SDK / Deploy / Assets / ProjectName.  Initially, it looks like snobbery and you do not understand the meaning of such stringent requirements, but over time it comes to why this is necessary. <br><br>  After installing the SDK, the server automatically rises and becomes available at <a href="http://localhost/">localhost</a> : 6687.  Documentation and examples are offered on the start page, but the main thing is that the server can be used to test your applications. <br><br>  I created a simple scene in Blender with the above mentioned objects and saved all the data, as required by the SDK help.  The first surprise was waiting when trying to export to JSON.  In the exporter settings there is a Run in Viewer option and if it is enabled, then after export the result will immediately open in the browser in a special viewer.  In it you can finally check your scene and even customize all the parameters of the objects or the environment. <br><br>  So, the export result is two files: json and bin.  The latter contains arrays of data on the models.  Now it‚Äôs time to create the file being run. <br><br>  The first question that puzzled me is not how to write, but where to save the scripts and HTML.  Since the developers of Blend4Web urge to use certain folders for the project, it would be logical to assume that there is a place for software parts.  I did not find confirmation of this and simply created files in the folder with Deploy / Assets / ProjectName. <br><br>  By tradition, I rendered the executable code in a separate script.  In this regard, the HTML wrapper looks like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b4w.full.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"main.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">body</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">margin</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">overflow</span></span></span><span class="css">: hidden; } </span><span class="hljs-selector-id"><span class="css"><span class="hljs-selector-id">#container_id</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">position</span></span></span><span class="css">: absolute; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">100%</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">height</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">100%</span></span></span><span class="css">; } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container_id"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  There is nothing interesting in HTML, so let's go to main.js.  Initialization of the engine and loading the scene is carried out in several stages.  First, we connect the necessary modules: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> app = b4w.require(<span class="hljs-string"><span class="hljs-string">"app"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = b4w.require(<span class="hljs-string"><span class="hljs-string">"data"</span></span>);</code> </pre><br>  Then we perform initialization: <br><pre> <code class="javascript hljs">app.init({ <span class="hljs-attr"><span class="hljs-attr">canvas_container_id</span></span>: <span class="hljs-string"><span class="hljs-string">"container_id"</span></span>, <span class="hljs-attr"><span class="hljs-attr">physics_enabled</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">autoresize</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">callback</span></span>: load_cb });</code> </pre><br>  By the name of the arguments, I think it is clear what the init function does.  After initialization, the load_cb function is called.  It can accommodate JSON downloads. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load_cb</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ data.load(<span class="hljs-string"><span class="hljs-string">"test.json"</span></span>, loaded_cb); }</code> </pre><br>  The last function in the test script is loaded_cb, which is called after the scene is loaded.  This is where the application logic is created. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loaded_cb</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//-  //       app.enable_controls(); app.enable_camera_controls(); }</span></span></code> </pre><br>  Loading a scene in Blend4Web was very easy.  Everything that I included in Blender - the engine correctly displayed.  There are no problems with the placement of objects, the inclusion of shadows, setting meshes, etc.  But how about access to individual objects?  It is clear that you can make animations in Blender and run them programmatically.  I am sure of it, although I did not search.  But I need a simple rotation around the axis, according to the principle performed for Three.js (cube.rotation.y + = 0.01). <br><br>  It turned out to be more difficult than I expected.  The Blend4Web API has a function that allows you to call custom procedures every frame, and from this side everything is fine.  However, I did not find the possibility of direct rotation along the axes.  Only quaternions can be used.  In this regard, the code is somewhat cumbersome: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Cube = scene.get_object_by_name(<span class="hljs-string"><span class="hljs-string">"Cube"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _angle = <span class="hljs-number"><span class="hljs-number">0.05</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _vec4; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj_quat = transform.get_rotation(Cube, _vec4); quat.rotateY(obj_quat, _angle, obj_quat); transform.set_rotation_v(Cube, obj_quat); }</code> </pre><br><h4>  Small results </h4><br>  I set myself a simple and clear task - to explore the capabilities of both platforms on the example of a standard scene.  The conditions were the same, but the result was not unambiguous. <br><br>  Three.js is a popular library for which a lot of lessons are written, including on Habr√©.  However, the basic functions were created by me with difficulty.  Fabulous time spent on the simplest loading model in the scene.  Could, probably, in the official tutorial to enter information about the mandatory light sources.  Well, at least, for such "cool" programmers like me. <br><br>  Most importantly, I used to work with comfort and see what I was doing.  I need an editor to prepare the scene and are not at all interested in the problems associated with driving the data to the engine.  I sat down to make a game, not poking around with broken basic functions.  Time is money, and Three.js has taken it away. <br><br>  The situation with Blend4Web looks much better, but not everything is so brilliant. <br><br>  The entire preparation of the scene is carried out in a full-fledged editor, and you don‚Äôt even think about how the engine will take it all in - this is its task, not the developer.  However, problems have arisen related to direct programming. <br><br>  Much time was spent on the initial reading of the documentation on the part of working with the SDK.  I still wanted to do what the developers advise.  For example, they suggest using a special Python script to build a complete application.  With it, you can pack data, collect scattered files in a heap, etc.  It looked tempting, but I did not.  Popped up errors in the Python script, which I did not even consider. <br><br>  The Three.js documentation is replete with many small examples.  Unfortunately, for Blend4Web there are none.  So you had to scroll through the lessons and watch extensive listings.  Took a little from one page, a little more from another.  As a result, I wrote code that could successfully be already in the examples of the SDK documentation.  Yes, there is such an application in the SDK - <a href="https://www.blend4web.com/apps/code_snippets/code_snippets.html%3Fscene%3Dcanvas_texture">Code Snippets</a> , demonstrating the various possibilities of the platform with the source code.  But I would like to just small and simple examples.  How to move the object, how to rotate the model, how to link the execution of the function to the frame update, etc.  So, to rotate the object, I took a piece of code from the example of the game on the official site.  But maybe there is a more optimal rotation option than through direct change of quaternions?  In the end, I used only what I found. <br><br>  Still, you feel more comfortable with Blend4Web.  This platform is much more user friendly than the considered opponent. <br><br>  <a href="http://www.prandgames.com/share/threejs_test/test_treejs.html">Scene Three.js</a> <br>  <a href="http://www.prandgames.com/share/blend4web/test.html">Blend4Web Scene</a> </div><p>Source: <a href="https://habr.com/ru/post/262749/">https://habr.com/ru/post/262749/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../262733/index.html">Protection mechanisms in the HP Superdome X</a></li>
<li><a href="../262735/index.html">How does the color</a></li>
<li><a href="../262743/index.html">Modernizing corporate mobile communications using AltegroCloud FMC SIM cards</a></li>
<li><a href="../262745/index.html">Joker 2015 Java Conference Announcement</a></li>
<li><a href="../262747/index.html">Adaptation for various screens of Windows Store applications</a></li>
<li><a href="../262751/index.html">Russian conferences for programmers this year</a></li>
<li><a href="../262755/index.html">Creating a program guide for IPTV channel based on the Flussonic media server</a></li>
<li><a href="../262757/index.html">Squirrels, hackers and Facebook: Because of what the "exchange" falls</a></li>
<li><a href="../262761/index.html">Modern HP ProLiant Mass Series Servers (DL380, DL360, BL460c Gen9)</a></li>
<li><a href="../262765/index.html">Check your websites for TLS Logjam vulnerability</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>