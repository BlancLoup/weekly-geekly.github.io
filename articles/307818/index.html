<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As protection from Microsoft deleted the code on the servers. Bike about Defender</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today is on the calendar August 16, 2016. Windows Defender deleted the working code from the host. How it was: 

 Discussing with a colleague news abo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As protection from Microsoft deleted the code on the servers. Bike about Defender</h1><div class="post__text post__text-html js-mediator-article">  Today is on the calendar August 16, 2016. Windows Defender deleted the working code from the host.  How it was: <br><br>  Discussing with a colleague news about a series of problems with Microsoft, which are full of news.  It hung there, it disappeared, there was something else - apparently he crap himself of problems.  Working on a virtual server with IIS code, I suddenly get a warning that Windows Defender detected the Worm inside many ASP files on the host and strongly recommends deleting it. <br><br>  The beauty is that the options does not offer Defender.  Files are already empty and locked.  Until yesterday, this problem did not exist.  Any attempt to restore files from the repository - causes outrage at Defender, with the subsequent deletion of files. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Checking the settings showed that Windows Defender was updated on 8/15/16 to version 1.225.3982.0.  The scanner persistently saw Worm: VBS / VBSWGbased.gen in ASP (VBScript) files.  Checking one of the files on virustotal.com showed the same results.  Of the 53 test tests - only Microsoft Defender finds Worm: VBS / VBSWGbased.gen. <br><a name="habracut"></a><br>  Next comes a lot of hours trying to understand exactly what made the virus find and remove the code.  Going through the line options and checking each line with the scanner, we managed to delete everything and get the minimum test file that causes madness for Defender. <br><br><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> SafeSQLLogin() <span class="hljs-keyword"><span class="hljs-keyword">Execute</span></span>(SafeSQLLogin()) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Stream_StringToBinary(Text) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> BinaryStream = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"ADODB.Stream"</span></span>) BinaryStream.Type = adTypeText BinaryStream.CharSet = <span class="hljs-string"><span class="hljs-string">"us-ascii"</span></span> BinaryStream.Open BinaryStream.WriteText Text BinaryStream.Position = <span class="hljs-number"><span class="hljs-number">0</span></span> BinaryStream.Type = adTypeBinary BinaryStream.Position = <span class="hljs-number"><span class="hljs-number">0</span></span> Stream_StringToBinary = BinaryStream.Read <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> BinaryStream = <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> strCrypt() <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Len</span></span>(Text) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span></code> </pre> <br>  The code is strange only because I deleted as much as I could while the scanner still saw the Worm.  This text is minimal, any change or removal of one of the lines - stops driving Defender crazy. <br><br>  <strong>Update: a</strong> more recent version of the text to take it for a virus: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> S <span class="hljs-keyword"><span class="hljs-keyword">Execute</span></span> S <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Len</span></span> T</code> </pre> <br>  Saving the text to a file as test.txt and sending it to virustotal.com still issues a confirmation about the Worm, despite the fact that Defender has already received several new updates.  Here is the result from virustital.com <br><br>  <a href="https://www.virustotal.com/en/file/ccb6be34fa788a8e6131e25ceba60c57b578053e983a34e642c7cdef51e5eeb8/analysis/1471298147/">Result</a> <br><br>  Attempting to contact Microsoft's tech center in chat mode, slightly cheered up.  The girl + specialist persistently tried to help me restore the system and RestorePoint issuing commands like SCN and others. All attempts to clarify that the problem was not with me with the computer were conducted around the persistent attempt to solve my problem with my computer.  Understanding that reporting a problem with Defender would fail, I contacted Host Administrators with a warning that we might have problems on all servers. <br><br>  Administrators are not normally available.  I hope that they will not respond as usual, when something already collapsed.  (sarcasm) <br><br>  Analysis of the "malware" when, does not give an understanding of any logic.  Everything leads to a random set of some kind of coincidence.  Any change in the text leads to the fact that the Worm is no longer located.  But the whole trick is that the text does not go in a row !!!  This code is cleared of everything else, and this is only part of the lines, between these lines were hundreds of lines of other code.  Finding the Worm worked only when these lines existed among other lines of code weighing 80kb.  So this is not a template, but rather on a regular basis finding some number of certain words or phrases.  I did not see any other logic. <br><br>  I have nothing against Microsoft, but something recently their mistakes are fraught with enormous consequences.  Administrators have a hard and fast rule - No updates on servers !!!  First, long tests on test machines.  I understand that this does not sound new - but Microsoft's fixes should fix and protect and not kill and create new problems, even more terrible. <br><br>  <strong>PS</strong> Defender received the next batch of updates, v1.225.4025.0 - but it still persistently blocks and deletes files on the test PC, on other machines it is disabled everywhere. </div><p>Source: <a href="https://habr.com/ru/post/307818/">https://habr.com/ru/post/307818/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307806/index.html">Acquaintance: BBC micro: bit and mbed OS 5</a></li>
<li><a href="../307808/index.html">Scenario testing to help 1C programmer</a></li>
<li><a href="../307810/index.html">Interfaces and usability: who, why and how designs UX</a></li>
<li><a href="../307814/index.html">Simulation of dynamic systems (Lagrange method and Bond graph approach)</a></li>
<li><a href="../307816/index.html">Using Q_GADGET in C ++ & QtQuick</a></li>
<li><a href="../307820/index.html">How to learn to evaluate tasks if you are not able: 4 complexity factors</a></li>
<li><a href="../307822/index.html">I looked into the node_modules folder, and you won‚Äôt believe what happened</a></li>
<li><a href="../307824/index.html">CSS of our days</a></li>
<li><a href="../307826/index.html">20+ My favorite AngularJS helpers</a></li>
<li><a href="../307828/index.html">Discovered a new hacking mechanism for cloud virtual machines</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>