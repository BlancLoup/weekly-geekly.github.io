<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Conference DEFCON 16. Fedor, hacker InSecure.org. NMAP Internet Scan</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, my name is Fedor, I am from InSecure.org and I am the author of the Nmap security scanner project, released in 1997. I would like to t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Conference DEFCON 16. Fedor, hacker InSecure.org. NMAP Internet Scan</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, my name is Fedor, I am from <b>InSecure.org</b> and I am the author of the <b>Nmap</b> security scanner project, released in 1997.  I would like to thank everyone who came here and <b>Defcon</b> himself for inviting me here.  I am a big fan of such conferences, where people who have a real passion for amateur technologies, but who do not have companies willing to pay thousands of dollars for a ticket, can come. <br><br>  I want to warn you that this conversation is not about how to conduct cross-site scripting attacks on social networks or how to hack <b>Twitter</b> channels.  It's about port scanning and more than port scanning, and if you don't like port scanning, then the next 50 minutes will be your worst nightmare. <br><br><img src="https://habrastorage.org/webt/9v/is/84/9vis84enhamknaaxpa5xhr42w4s.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Because for me, talking about something else would be as unusual as hearing Dan Kaminsky, who does not talk about <b>DNS</b> .  I mean, I can rush into detecting some operating systems or acting as a nmap script handler just as Dan can take his <b>DNS</b> and use it to tunnel <b>YouTube</b> to fool some dummy, but in both cases we just expand our key topic. <br><br>  My topic, as can be seen from the first slide, is devoted to scanning the Internet.  I spent a lot of time this summer scanning tens of millions of hosts on the Internet and collecting the necessary data. <br><br>  And when I tell people about this, they often ask: ‚ÄúWhy‚Äù?  For me, scanning is valuable in and of itself, but if you need some reason, then in this case, in this case, I had some specific goals for the project.  The first is to collect empirical data and use them to extend and improve the functionality of <b>Nmap</b> , we will talk about this a little later. <a name="habracut"></a><br><br>  The second goal is to use data to help knowledgeable people scan more efficiently.  There are many people gathering information about the structuring and population of networks to find out which scanning methods are best suited.  But usually they wonder how to set up existing scanning tools without finding anything suitable.  So you can use my empirical data for your own needs, they will help you learn how to scan and collect the results. <br><br><img src="https://habrastorage.org/webt/oy/uq/dl/oyuqdl-ntfkjp2b3_dha_dtz0hk.jpeg"><br><br>  The third goal is to detect and eliminate <b>Nmap</b> errors and improve performance for large-scale scanning.  Because the scanning of millions of hosts is performed in a variety of situations, and at the same time it is possible to track how <b>Nmap</b> reacts to it.  I managed to correct errors that caused the system to crash or ‚Äúfreeze‚Äù, speed up the process, finding out what was causing the scan to slow down. <br><br>  The fourth goal is to demonstrate technologies that can be used for both conventional scanning and large-scale Internet scanning. <br><br>  The idea is that if this scan works for 25 million hosts, then it will certainly cope with scanning 25 thousand hosts or how many you need to scan. <br>  Let's look at the problems that I had to face when scanning.  First of all, I want to say that it is better to conduct dozens of large, but targeted scans instead of one huge scan.  Each of these goals allows you to collect useful data of a certain kind, but the problem is to determine the specific IP addresses that need to be scanned. <br><br>  There are many possibilities for this: <b>BGP</b> routing tables that let you know which networks are routed, DNS zone files, register allocation tables, etc. <br><br><img src="https://habrastorage.org/webt/ga/3e/ju/ga3eju_sc7izbygov4butufo4_i.jpeg"><br><br>  I decided to use <b>Nmap's</b> own IP address script generator, which allows you to create 25,000,000 IP addresses, and I also made an additional 200,000 due to possible duplicates.  In this case, not computers are actually scanned, but a list of them, because I scan the machines themselves later.  As a result, I received a list of 25 million IP addresses that I used to scan.  It was a way to generate random numbers, but as soon as you have specific targets that need to be scanned, the following question arises: what source are you going to use. <br><br>  Here I had many ideas, one crazier than the other, for example, P2P scanning.  I was going to distribute a client called <b>Nmapster</b> , which people could download.  He would scan their computers and report that we are collecting data for generalization.  But I decided that the key goal was to make <b>Nmap</b> faster and more efficiently for everyday scanning and that it was better to focus on using <b>Nmap</b> itself rather than creating custom programs for it. <br><br>  The second big obstacle was the illegality of such actions.  When you scan a lot of hosts, people may get indignant, but I don‚Äôt want my Internet provider to deny me service again, but the possibility of being arrested looks even worse.  Therefore, I decided to go online through a free wireless access point of my neighbor (applause and laughter in the hall). <br><br>  No, I'm just kidding, besides, my neighbor's Internet channel would not have enough bandwidth to handle the amount of traffic I needed. <br><br>  Therefore, I decided to use the ISP, which I use for colocation, and perform a scan from there, that is, through the equipment located on its territory.  Fifteen minutes after the scan began, these guys contacted me, frantically asking what the hell was going on, maybe my computer is infected with the worst worm on the Internet, because it goes crazy and probes thousands of machines per second all over the Internet!  They offered to turn me off, but I explained that they did not worry, I did not suffer, I did it for a specific purpose.  Then they thought that I was some kind of spammer or even worse, if that was possible, and I should be arrested.  Then I got scared and thought that I‚Äôm finished, I‚Äôll have to quit my project and start exploring cross-site vulnerabilities.  Fortunately, it turned out that they were users of <b>Nmap</b> and I was able to explain that this scan is needed in order to make my program more efficient and productive.  To which they said: "Well, then you can continue!" <br><br>  I slowed down the scanning speed a bit because I didn‚Äôt want their fuses to blow, and continued this great thing.  Unfortunately, the US Department of Defense was not so kind, they didn‚Äôt like my scanning at all, and they told me to stop scanning important military targets.  I thought that <b>Nmap's</b> ability to skip scanning certain networks would be useful for me, but they would not even let me define these networks, because they were also military targets.  So since then I‚Äôm a little nervous if military planes fly over my head. <br><br><img src="https://habrastorage.org/webt/hf/ll/6-/hfll6-8r-tzrkxmmib8mjlfwwp8.jpeg"><br><br>  The next obstacle to scanning became firewalls.  For some cases, it was enough for me to get results from the unprotected segment of the Internet, but for others it would be nice to learn how it looks behind the firewalls of companies.  You know that they often control different ports, so from the inside, an open network looks completely different.  I am pleased to say that I was able to break through a series of firewalls, not with the help of something like an advanced fragmentation attack, but with the help of technologies that simply ‚Äúasked‚Äù them to provide the necessary data. <br><br>  There are many large companies that daily scan their networks with <b>Nmap</b> , and they were happy to contribute in the form of data that will help improve it. <br><br>  The next problems were performance and accuracy.  Scanning the Internet is a long and hard work.  The key goal was to improve the performance of Nmap, because its usage statistics were disappointing: <br><br><ul><li>  Time has passed since the beginning of the scan 93 h 57 min  40 s (more than 4 days); </li><li>  during this time, out of 254868 scheduled hosts, a UDP scan of 65,000 ports on 2048 hosts was performed; </li><li>  during this time, a UDP scan of about 11.34% of the planned number was performed, the time for scanning other hosts will be 688 h 41 min 48 s. </li></ul><br>  When your assessment of the remaining time leads to an "overflow of integers" and brings one negative, this is not a very encouraging sign.  This particular scan is still in progress, and maybe at the DEFCON conference next year I will tell you what came of it.  Fortunately, some of our other scans ended much earlier, so this is a kind of introduction to what types of scans we performed and why. <br><br>  Now let's get to more practical tips that can serve as useful details and let you know how to use this as an aid for your own scanning.  Detecting hosts is a good start, because the first thing you want to do when exploring a network is to discover the location of the host and find out which networks are available for scanning.  Therefore, you should not spend time scanning IP addresses that are not tapped by hosts, and decide which methods to perform the scan. <br><br>  There was a time when most hosts responded to <b>ICMP</b> echo requests or ping packets, which <b>Nmap</b> defaulted to port 80 by default, but unfortunately, this time ended 10 years ago. <br><br><img src="https://habrastorage.org/webt/_a/fs/mw/_afsmwlpzn-nhxdeg02dccxrm-k.jpeg"><br><br>  Now most companies are blocking ping packages and I had to use more efficient methods. <br><br>  The first was a <b>TCP-</b> based method for discovering hosts using synthetic <b>SYN</b> packets <b>(-PS)</b> , which work best against static filtering firewalls, which use a constant list of exceptions, and using <b>ACK (-PA)</b> packets that are effective against dynamic filtering firewalls. <br><br>  Those firewalls that pass synthetic packets usually block <b>ACK</b> packets, and vice versa. <br><br>  I‚Äôll show a quick example of using <b>Nmap</b> with a synthetic package for port 80 on <b>sun.com</b> .  As you can see, the answer came very quickly and it shows that the host is available. <br><br><img src="https://habrastorage.org/webt/al/bu/3s/albu3sgpef4jt-4iqjbkty9ho1s.jpeg"><br><br>  Then we use <b>ACK</b> packets for the same host, you see that the scan took longer and the host did not respond because it blocked pinging. <br><br><img src="https://habrastorage.org/webt/2s/nq/qx/2snqqx8epjv16gzopg9rqc9nk4y.jpeg"><br><br>  Thus, it is possible to understand which firewall is installed on this host - with static or dynamic filtering.  In this case, we have a static firewall that missed <b>SYN</b> packets and blocked <b>ACK</b> packets. <br><br>  It may be asked what kind of port sounding is better to use.  I will answer - you need to send both kinds of packets until the host misses one of them. <br><br>  The next question is which port to use.  You have 65,000 ports, and it is often impossible to choose the ones that work best.  Therefore, I made a sample of ports based on empirical data, which is shown on the next slide.  This is the best 10-ka ports to detect certain types of hosts. <br><br><img src="https://habrastorage.org/webt/mf/p4/qj/mfp4qjgn7gqraj12nk9eyqmll-k.jpeg"><br><br>  Some people may look at this list and ask, where are the most common <b>Windows</b> ports 135 or 139? <br><br>  However, remember that I created my database based on well-protected hosts, so if you have problems installing a firewall, you'd better block these <b>Windows</b> ports.  I would recommend part of these ports to ‚Äúprobe‚Äù <b>SYN-packets</b> , the other part - <b>ACK</b> packets. <br><br>  Next we have the discovery of <b>UDP</b> hosts.  In this case, closed <b>UDP</b> ports are better open because they are more likely to respond.  Open ports, getting a clean packet, do not know what to do with it and just ignore it.  Closed ports, however, usually respond to such a packet with a ban, and this means that the host is located here.  Port 53 often falls into firewall exceptions because it is intended for <b>DNS</b> . <br><br>  I also used the <b>ICMP</b> host detection method <b>(PE, PM, PP)</b> .  Some systems readily accept echo requests, but they block others.  For example, <b>Google.com</b> administrators do not see a threat in receiving ping packets, but they block network mask requests and timestamps because they believe that hackers use them. <br><br>  Other administrators explicitly block echo requests as hacking, but forget about blocking network mask requests and the <b>netmask / timestamp</b> time stamp.  Therefore, I advise you to use both types of requests - an echo request and one of the second type requests. <br><br>  We also have a new feature called <b>Protocol Ping (PO)</b> .  By default, this protocol uses 3 types of IP packets: 1 ( <b>ICMP</b> ), 2 ( <b>IGMP</b> ) and 4 ( <b>IPinIP</b> ) in order to obtain an available response if the host is ‚Äúalive‚Äù.  I did not test to find out which protocols are most useful, so all 3 are used by default. <br><br>  Now I want to talk about the different technologies of detecting the hosts that I used, and you can ask which of these heaps are the most valuable and what is the difference between them.  The slide shows an example when I generated 50 thousand IP addresses and used ping scanning by default, as a result of which 3348 hosts were found in 1600 seconds, or 27 minutes. <br><br><img src="https://habrastorage.org/webt/fb/v7/sx/fbv7sxugrzktxcdpualc7orgalu.jpeg"><br><br>  This is quite a lot of computers, and this scan looks pretty successful.  But then I decided to use ‚Äúadvanced‚Äù scanning, took almost the same list of 50,000 hosts and added several different detection techniques, such as echo reply, time stamps, <b>SYN</b> probing for a heap of ports, and set the source port 53 to disguise under <b>DNS</b> .  This allowed us to detect 4473 "live" host, but it took a little longer - 4259 seconds. <br><br><img src="https://habrastorage.org/webt/rw/s3/k-/rws3k-qfpxhycgo0k8ks44ri5k4.jpeg"><br><br>  A comparison of these two scanning methods ‚Äî with the default and advanced settings ‚Äî showed that the second took 167% more time (41 minutes versus 27) and found 34% more hosts. <br><br>  Now I want to talk about <b>Nmap</b> upgrades, which were conducted on the basis of these studies. <br><br>  The site <a href="http://nmap.org/changelog.html">http://nmap.org/changelog.html</a> contains the latest version of <b>Nmap 4.68</b> , in which bugs were fixed and performance improved.  There is also the latest <b>SVN</b> release, which can be found at <a href="http://nmap.org/book/install.html">http://nmap.org/book/install.html#instsvn</a> . <br><br>  I am tired of error messages, where it says that ‚Äúyes, we fixed it in 2003,‚Äù because there are a lot of people who don‚Äôt want to perform frequent updates.  Then they complain that <b>Nmap is</b> long outdated because it tells you which port numbers are open, but does not tell you which services are behind them.  Recently, I have added a number of improvements to the program, and if you need the most advanced version of the program - the <b>BHD CO 8 Black Hat DefCon release</b> , you can find it at the special link <a href="http://svn//svn.insecure.org/nmapexp/bhdc08">svn: //svn.insecure.org/nmapexp/bhdc08</a> using the guest login and password.  This newest version contains the <b>Top Ports</b> scanning feature and some other features that I will discuss later. <br><br>  So, the <b>Top Ports</b> project is another big scan of millions of IP addresses to detect open <b>TCP</b> and <b>UDP</b> ports using a sample of popular ports.  Some large organizations also provided the ability to scan internal network data located behind firewalls.  At the same time, the service <b>Nmap</b> files were supplemented with the frequency data of each port. <br><br>  Consider the ports that were scanned by default.  <b>Nmap 4.68</b> scanned 1715 <b>TCP</b> ports and 1488 <b>UDP</b> ports, scanned ports from 1 to 1024 and all named higher ports.  I note that many ports were invented many years ago and have not been used for a long time.  At the same time, there are many open, nameless ports. <br><br><img src="https://habrastorage.org/webt/ei/ym/sp/eiymspkq4wcc7jgq4-7x00nrqfi.jpeg"><br><br>  The final version of <b>Nmap</b> used the frequency data of the Top 1000 ports for each protocol, so in many cases I got better results.  This made it possible not to waste time on scanning old unused ports, thus scanning proceeds faster, because in fact a little more than half of all existing ports are scanned. <br><br>  Quick scan is very different from the default scan.  In <b>Nmap,</b> it is denoted by the letter ( <b>-F</b> ).  This time, <b>Nmap 4.68</b> scanned 1276 <b>TCP</b> ports and 1017 <b>UDP</b> ports over the entire range of numbers.  You may ask why the default scan has processed more ports, but there is nothing dramatic here ‚Äî a quick scan just took less time.  However, in this case, the scanner did not check all existing ports, but worked only with those whose names were in the new <b>Nmap</b> service file.  As a result, the scan was done for the TOP 100 ports for each protocol, and I got a speed gain an order of magnitude greater than with the default scan.  This is much more useful for <b>TCP</b> and even more useful for <b>UDP</b> , because I know that many people never perform <b>UDP</b> scanning, considering it very time consuming and difficult to filter open ports.  Therefore, they pretend that <b>UDP</b> simply does not exist.  However, hackers do not pretend, so it is very important for us to understand what is happening with this protocol. <br>  The next slide shows examples of fast scanning using different versions of <b>Nmap</b> .  The letter <b>U</b> in the designation of the scan mode <b>Nmap - sUV - F-T4</b> indicates a <b>UDP</b> port, <b>F</b> is a fast scan.  There is a filtering problem in this open version, because <b>Nmap</b> does not receive a response and cannot determine whether the port is filtered or open.  This happens if you use the version from <b>scanme.nmap.org</b> .  So it's great that I managed to get a report with data that showed all open and filtered ports. <br><br><img src="https://habrastorage.org/webt/hs/pp/gz/hsppgzr9m1x8sd-i2y3n9zln-di.jpeg"><br><br>  Thus, scanning using <b>Nmap 4.68</b> took an hour, scanning with the release version of <b>Blackhat DefCon 08</b> lasted 6 and a half minutes, scanning with the ‚Äúadvanced‚Äù version of <b>Blackhat DefCon 08</b> was only 13 seconds.  All 3 versions found the same open port 53. <br><br>  The new versions used new scanning features: <pre><code class="hljs xml">- top-ports <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">n</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  She scanned the most popular open ports with each required protocol, and the function: <br><pre> <b><code class="hljs xml">‚Äìport-ratio <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">n</span></span></span><span class="hljs-tag">&gt;</span></span></code></b> </pre> <br>  where <b>n</b> was selected between 0 and 1, scanned all ports with a frequency set at this level. <br><br>  The latest version worked with the ‚Äú <b>‚Äîversion ‚Äî intensity 0</b> ‚Äù flag.  This meant that <b>UDP-</b> requests were sent to certain ports using certain protocols, that is, only <b>DNS was</b> tried for 53, only <b>SNMP</b> for 161 ports, etc.  This reduced the scanning time to 13 seconds. <br><br>  The moral of this story is that if you know what data you really need, you can optimize the scan a bit and make it much faster.  In this case, we received the same data, but instead of the hourly wait, we waited only 13 seconds.  So setting up the functions helps a lot, especially the top ports feature.  You just need to choose between the default scan of 1000 ports and the fast scan of 100 ports and specify arbitrarily how many ports you want to scan. <br><br>  This raises the question of which Top Ports feature works best.  Next, the slide shows the Top-10 <b>TCP</b> ports and a sample of the effectiveness of the ‚Äútops‚Äù, which I did based on empirical data.  This sample shows how many open ports I found using this or that ‚Äútop‚Äù. <br><br>  If you use the fastest scanning "dozens" of ports, you can find a little more than half of the open TCP ports.  Using the "Top 100" ports, you can detect 73% of open ports, using the default "Top 1000" detects 93%, but at the same time you scan only 2% of the 65 thousandth port space. <br><br><img src="https://habrastorage.org/webt/n2/-h/bi/n2-hbirh4bne2rwbrtttz1zy64o.jpeg"><br><br>  Next, I will give the statistics of finding open <b>UDP</b> ports.  It is dominated by typical <b>Microsoft</b> ports, although <b>SNMP</b> and <b>NTP</b> are also available. <br><br><img src="https://habrastorage.org/webt/qu/mx/wb/qumxwbhtyig_yuurlf8pwp3tdpc.jpeg"><br><br>  The effectiveness of <b>UDP</b> differs from the efficiency of <b>TCP</b> ; here a larger percentage of open ports is determined with smaller values ‚Äã‚Äãof the ‚Äútop‚Äù.  Thus, the "Top 100" <b>UDP</b> detects 90% of ports versus 73% for <b>TCP</b> . <br><br>  I used another function that I developed recently, this is the speed control of <b>Packet Rate Control</b> packages. <br><br><img src="https://habrastorage.org/webt/ph/o4/py/pho4pyq2omqghei4pjn4opkzaoy.jpeg"><br><br>  In her regard, I have mixed feelings.  I am proud of <b>Nmap‚Äôs</b> download control and other technologies to figure out which scan speeds work best.  But there are a lot of people who say that they would just like to scan ports with a certain frequency and not worry if any packets are lost.  This is one of the reasons why they use scanners like <b>RAND</b> or <b>Unicorn</b> .  For such cases, I decided to add a function that sets the maximum and minimum frequency of sending packets per second. <br><br>  It turned out to be very useful when I almost ‚Äúmelted down the fuses‚Äù of my Internet host, because I was able to set the scan parameter for <b>Nmap</b> at 300 packets per second and make these guys from the <b>ISP a</b> little happier. <br><br>  The next slide shows an example of how to put together all the useful functions of <b>Nmap</b> . <br><br><img src="https://habrastorage.org/webt/gc/pj/9j/gcpj9jngrejwaro_17cio98at70.jpeg"><br><br>  Here you can enter the source IP address that I wanted to use for this particular scan and indicate the debug mode.  I often used this function to interact with the program during scanning, because people do not know that you can press the <b>D</b> key and open debug mode, and if you click on it several times, you can scroll the screen and see what <b>Nmap</b> does in this moment. <br><br>  Here I used low latency, because I didn‚Äôt want to wait for hosts for which the packet frequency was limited.  I applied the log file creation function using the time value function <b>STRF</b> , which automatically inserts the date and time. <br><br>  Next, I entered the name of the file that I want to get in the end and noted that I do not want to do more than 1 retry scan, because I am going to perform a large amount of scanning as soon as possible. <br><br>  Further here, randomization of hosts is noted, the port numbers are scanned, a large group of host MAC addresses is listed, the minimum scan rate is 175 packets per second and the maximum 300 packets per second. <br><br>  This is an example of how I kept changing and improving the algorithm of <b>Nmap</b> , until I found an option that worked better than others. <br><br>  And now I want to use the remaining time to tell you the latest <b>Nmap</b> news.  Some of them are new and interesting features, for example, the <b>NSE</b> scripting engine.  This is a modular mechanism that polls ports in a certain way.  In this case, we make <b>HTML</b> headings for the websites that it finds. <br><br><img src="https://habrastorage.org/webt/0o/x6/po/0ox6poasnhj2vbdbgc3svhaedjc.jpeg"><br><br>  There are now over 50 scripts supported by <b>Nmap</b> that are compatible with <b>Whois</b> data, <b>brute-forcing pop3</b> passwords and other crazy things you want to use. <br><br>  Now I will quickly show you how the <b>Nmap Scripting Engine</b> works. <br><br><img src="https://habrastorage.org/webt/qz/fw/_u/qzfw_ubczy1m0sccp4grsu4dwuq.jpeg"><br><br>  This is a long command, so I will copy it from another place.  She negotiates <b>Nmap's</b> verbose mode ‚Äî do not ping, perform <b>UDP</b> probing for port 53, use aggressive timing, and use 3 scripts here that will help avoid the <b>DNS</b> error that Dan spoke about last Sunday.  One script simply checks if the DNS server resolves recursion, the second checks whether it randomizes the original port numbers, and the third checks if it has a randomized transaction ID.  These are the mistakes that people want to fix in order to reduce the cache poisoning problem. <br><br>  In our case, I want to demonstrate the operation of <b>NSE</b> during the port scan of one of the <b>BlackHat</b> servers and one of the <b>Shmoo.com</b> servers.  It takes a little time, and then the result is displayed right next to the port number. <br><br>  You can see that for <b>blackhat.com</b> with the IP address 216.231.64.55, when <b>UDP</b> scanned port 53 in both cases, the server recursion failed, so it was not possible to ‚Äúinterrogate‚Äù it further.  For the server <b>archimedes.shmoo.com</b> with the IP address 12.21.210.234 recursion took place.  But I am pleased to report that it was great in terms of port randomization. <br><br>  I wanted to show one of the few examples when my idea failed miserably, so that one could play the game ‚Äúwho can poison the cache first‚Äù, but decided that this was not a good idea for our presentation.  In addition, I have more interesting material on the topic that <b>concerns</b> me - this is a new graphical user interface <b>Zenmap GUI</b> . <br><br><img src="https://habrastorage.org/webt/-h/lp/fm/-hlpfm6p8orb55ubz87fwyvko20.jpeg"><br><br>  Many people say that they do not need a graphical interface, because they have been working with <b>Nmap</b> for 10 years and know all its 130 options to the core.  However, this interface is a powerful tool for working with the scanner, which I will now quickly demonstrate. <br><br>  It shows a window with output data, every open host, you can filter the display of <b>HTTP</b> or <b>SSH,</b> and so on.  In addition, in the newest version of the scanner, we have added an interesting feature.  For those people who say: ‚Äúsince you called this tool <b>H-map</b> , give me the hell this map!‚Äù, We added a graphic diagram of the topology of the scanned network. <br><br><img src="https://habrastorage.org/webt/o8/ht/fx/o8htfxtaeolm1643vupmss0rvc8.jpeg"><br><br>  This is a fairly accurate thing that draws the result of a network scan and places it in the center of the source node, and in concentric circles around this center each jump into the network and the computers you scanned are shown.  You can take such a node and say: ‚ÄúHey, well, show me what else there is data on this particular scan, show me open ports, etc.‚Äù, that is, when you hover over the yellow circle, a window opens with all the details scanned  You can scan new machines and they will also be added to the scheme.  You can also center the layout relative to the other host ‚Äî just click on the node and drag it in the desired direction. <br><br><img src="https://habrastorage.org/webt/rn/wv/7k/rnwv7kjrqniifg7cfwu-wg3m4fe.jpeg"><br><br>  Another big plus of the graphical interface is that now <b>Windows</b> users can work with <b>Nmap</b> , who have no idea how to manage the program using the command line.  I already received letters from them in which it was written: ‚ÄúI double-clicked on the <b>nmap.exe</b> icon on the desktop, after which a black box popped up for a second, and then everything disappeared.  Obviously, your program is not working at all. ‚Äù  So I hope that <b>Zenmap GU</b> I will help them.  Although, on the other hand, maybe such people should not use <b>Nmap at all</b> . <br><br>  We also have a second generation OS detection system. <br><br><img src="https://habrastorage.org/webt/pk/vb/sb/pkvbsbemplkqqq8xzk6bfd-n2y4.jpeg"><br><br>  It embodied everything that I had learned about OS detection in the previous 7 years, and contains 1,500 signatures of new operating systems.  So Nmap users will be able to find any tool imaginable on our website <b>nmap.org</b> and download the version of the program for <b>Windows</b> or <b>Linux</b> .  We also have a tool for discovering software versions. <br><br><img src="https://habrastorage.org/webt/gg/ah/ae/ggahaex349u6cwbcg0fwvdtnz2k.jpeg"><br><br>  There is also a function called <b>Reason</b> .  This is a kind of filter that shows for what reason a port was opened - due to the use of synthetic or <b>ACK</b> packets, or for what reason the port was closed, for example, due to a reboot. <br><br><img src="https://habrastorage.org/webt/gx/ur/rj/gxurrj8onqqrpoas8t9ugkvjj7y.jpeg"><br><br>  This is a very good tool for understanding what <b>Nmap</b> actually does.  The next function that can provide you with a lot of useful information is called Packet Tracing, or <b>Packet trace</b> . <br><br><img src="https://habrastorage.org/webt/r1/eo/ub/r1eoublly9mmogftzheu8wo8j8k.jpeg"><br><br>  Thanks to her, I can find out if port 25 is the end host returning packets to me, or if the firewall is throwing them back.  After reviewing the packet trace during a quick <b>Nmap</b> scan, I can tell which device they are interacting with.  Here you can see the frequency, the scan options used, the IP ID, and with this feature I can find out if the same host sent me packets in both cases or not.  This is useful for understanding the firewalls and filtering systems used. <br><br>  Another feature called Advanced Tracing Routing, <b>Advanced Traceroute,</b> shows which type of sensing is best used for penetration.  This is a quick function because <b>Nmap</b> can execute it parallel to the scan. <br><br><img src="https://habrastorage.org/webt/1n/24/ny/1n24nypdgor-oq5kd9qe7u49d2w.jpeg"><br><br>  Next, I made several improvements in scan performance and accuracy. <br><br><img src="https://habrastorage.org/webt/15/lz/vm/15lzvm2v_ythhvwtsxjijul9sn4.jpeg"><br><br>  There is a whole section on the main page of the program interface, which shows all the options that you can use to work.  Next we have the <b>TCP</b> and <b>IP</b> header option, which allows you to specify the source route or the source entry. <br><br><img src="https://habrastorage.org/webt/st/jv/h_/stjvh_evswjq_10l6acsudlabsw.jpeg"><br><br>  Many of you will say that the original routes were needed 15 years ago and now nobody needs it.  But I talked to one guy who recently tested a local network in one company.  It was located in something like a conference room and could only connect to servers of a specific series, so it was not possible to establish contact with all the computers of the company.  They had created something like a <b>DMZ</b> to access the conference room.  Then this guy took one of their servers and lost the original route through it, found the destination computer, and thus was able to get around this restriction. <br><br>  We have developed another brand new tool called <b>Ncat</b> . <br><br><img src="https://habrastorage.org/webt/0s/gz/je/0sgzjebkau6wsgssjap8todaxxm.jpeg"><br><br>  This is the modern interpretation of the venerable Hobbit <b>Netcat</b> .  It virtually supports all the features of <b>Netcat 1.10</b> , except for the basic port scanner, because I prefer to use my <b>Nmap</b> as a scanner.  It also supports many new cool features: <b>SSL, IPv6</b> on various platforms running <b>Linux, Windows, Mac OS</b> , network mediation, port forwarding, proxy (client, server, chain) to scan through another computer, shell execution, access control etc.  This program was created by Chris Cutterjon in 2005 and is now fully ready for release.  Chris also added some features like IP options and ping detection mode. <br><br>  The next tool is <b>Ndiff</b> , which many people have been waiting for a long time. <br><br><img src="https://habrastorage.org/webt/7z/_8/we/7z_8we-vynptllhlqecnzy6rcw0.jpeg"><br><br>  This utility compares the results of two or more scans and shows changes: new or remote hosts, ports, modified services, etc.  It is great for quickly detecting changes when rescanning.  For example, every day I scan a network of some company, and at the end of work I call this utility and say: ‚Äúsend me the changes that have occurred since yesterday‚Äù.  So I can see new open ports, added computers and so on. <br><br>  Finally, I want to show you my book Network Scanning with Nmap, I‚Äôve been working on it for several years.  It talks not only about the capabilities of my network scanner, but also about network scanning techniques. <br><br><img src="https://habrastorage.org/webt/fz/z2/vn/fzz2vn3oujq85hciqnlyv3pet9o.jpeg"><br><br>  I printed 170 copies of this book that I want to distribute here, but I am afraid that they will be sold the next morning.  The book will also be sold on Amazon and will be available for free download at <b>denman.org/book</b> .  You can add yourself to the <b>Nmap</b> hacker list and receive news about my program. <br><br>  The next slide lists those who contributed to the improvement of the <b>Nmap</b> program, starting with version 4.50, which was released 9 months ago.  I could not do anything without their help.  Our project is very much obliged to volunteers who joined him and helped him to become better. <br><br>  And now I still have time to answer a couple of questions. <br><br>  Indeed, I do not feel well in Germany and the United Kingdom and in other countries that have passed laws that prohibit people from using tools like <b>Nmap</b> .  Yes, they can be used by both good and bad people, but it is better to improve our networks, rather than act by analogy with those who prohibit the use of hammers, because they can kill a person.  Personally, I like to speak in Germany and England, so such a ban can be a potential problem for me, because I don‚Äôt want to be arrested for breaking the law. <br><br><img src="https://habrastorage.org/webt/xw/cq/op/xwcqoppx90fzzkok68ltwunn5ry.jpeg"><br><br>  I could not even explain to the judge what my motivation is, because I do not know German at all.  Therefore, I am glad that some associations of people are fighting against this law. <br><br>  If you have more questions, I will be glad to answer them in room 103, directly opposite the hall.  Thank you all for your attention! <br><br><img src="https://habrastorage.org/webt/zn/ps/4p/znps4p11w5dq6gzenwjfpdw16qi.jpeg"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Hk-21p2m8YY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Thank you for staying with us.  Do you like our articles?  Want to see more interesting materials?  Support us by placing an order or recommending to friends, <b>30% discount for Habr users on a unique analogue of the entry-level servers that we invented for you:</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">The whole truth about VPS (KVM) E5-2650 v4 (6 Cores) 10GB DDR4 240GB SSD 1Gbps from $ 20 or how to share the server?</a>  (Options are available with RAID1 and RAID10, up to 24 cores and up to 40GB DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 Cores) 10GB DDR4 240GB SSD 1Gbps until December for free</b> if you pay for a period of six months, you can order <a href="https://ua-hosting.company/vpsnl">here</a> . <br><br>  <b>Dell R730xd 2 times cheaper?</b>  Only we have <b><a href="https://ua-hosting.company/serversnl">2 x Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 TV from $ 249</a> in the Netherlands and the USA!</b>  Read about <a href="https://habr.com/company/ua-hosting/blog/329618/">How to build an infrastructure building.</a>  <a href="https://habr.com/company/ua-hosting/blog/329618/">class c using servers Dell R730xd E5-2650 v4 worth 9000 euros for a penny?</a> </div><p>Source: <a href="https://habr.com/ru/post/422767/">https://habr.com/ru/post/422767/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../422757/index.html">Without politics. How to permanently transform street protests using a mobile application?</a></li>
<li><a href="../422759/index.html">Interactive map for a web application in a couple of hours</a></li>
<li><a href="../422761/index.html">Four paths from the Yandex Data Analysis School</a></li>
<li><a href="../422763/index.html">Digital events in Moscow from 10 to 16 September</a></li>
<li><a href="../422765/index.html">OpenID Connect 1.0 On Fingers</a></li>
<li><a href="../422769/index.html">Winners Startup Battlefield TechCrunch Disrupt San Francisco 2018</a></li>
<li><a href="../422771/index.html">Design rules, a new level and design thinking</a></li>
<li><a href="../422773/index.html">Nvidia. Revealing the secrets of the next generation GPU Turing architecture: double Ray Tracing, GDDR6, and more</a></li>
<li><a href="../422775/index.html">Conference DEFCON 22. Andrew "Zoz" Brooks. Don't screw it up! Part 1</a></li>
<li><a href="../422777/index.html">A simple introduction to the ALU for neural networks: an explanation, physical meaning and implementation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>