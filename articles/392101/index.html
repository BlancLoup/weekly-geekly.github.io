<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About the pulse transformer say a word</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Despite the fact that not so long ago, quite well written articles about the calculation of a transformer of a switching power supply skipped, I will ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About the pulse transformer say a word</h1><div class="post__text post__text-html js-mediator-article">  Despite the fact that not so long ago, quite well written articles about the calculation of a transformer of a switching power supply skipped, I will offer you my method, and not just a bare method, but the most transparent description of the principles used in it. <br><br>  There will be no pictures, there will be about 18 simple formulas and a lot of text.  Anyone wishing to join please. <br><a name="habracut"></a><br>  I want to tell you about how to calculate such a cunning beast as a pulse transformer of the flyback power source.  A reverse switch or FlyBack is probably the most popular topology of a pulse converter.  In my opinion, in the IIP there are two very important and subtle points - this is a transformer and a feedback loop.  In this article, I want to show one of the possible sets of simple mathematical equations, solving which we can obtain the data of a quite real transformer for flyback. <br><br>  On the Internet, in various authors' articles, or in AppNotes of various producers, one can find various calculation methods that are often ‚Äúcompressed‚Äù as much as possible, so that the formulas do not understand how they work out.  I want to focus not on accuracy, but on maximum clarity and transparency of the calculations made, so that you understand ‚Äúwhy so‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Next, I will try to write briefly and capaciously, so that you can sit down and count immediately after reading the article.  I will not draw diagrams of voltages and currents in the flyback source, I think that you are sufficiently prepared for such terms as ‚Äúleakage inductance‚Äù, ‚Äúreflected voltage‚Äù, ‚Äúpeak value of current through the power switch‚Äù, ‚Äúdemagnetization of the magnetic circuit‚Äù to you are clear. <br><br>  So, we will consider the transformer of the return power source, without the power factor corrector, as the most common, and my ‚Äúcalculation‚Äù is only sharpened for it. <br><br>  Separately, I will make a note of what the so-called  quasi-resonant mode of operation of the converter, when the pumping of energy into the transformer begins immediately after the complete demagnetization of the magnetic circuit.  Those.  so-called  "Current continuity coefficient" = 1, i.e.  as soon as all the energy has flowed out through the secondary winding (and dissipated in the snubber circuit), immediately turn on the key and pump it up again.  Such a regime has recently been very popular in flyback power sources, since  allows you to increase efficiency slightly. <br><br>  I would like to make a reservation in advance - the method below is very rough, but it ‚Äúworks in reinforced concrete‚Äù, it has been repeatedly tested on real transformers in real power sources. <br><br>  To get started, download the calculation, open, run over your eyes.  The values ‚Äã‚Äãfor calculating the transformer of the power source, with an output power of 100W, have already been ‚Äúdriven into‚Äù it. <br><br>  Calculation: <i>unfortunately, for some unknown reason, the public link is not displayed.</i> <i><br></i>  <i>Perhaps the publication of public links is contrary to the rules.</i>  <i>I hope that the moderators will hear this cry from the heart and send me a personalized filter setting, but for now you can rewrite to Excel, or matkad, all the below formulas and get a good result.</i> <br><br><br>  So let's go.  In order to start the calculation we need to specify several initial parameters (all of them are highlighted in green in the calculation), namely: <br><br>  1. The output power of the power source for which we make a transformer (POUTmax). <br>  2. The output voltage of the source (Uout) (1). <br>  3. The output voltage of the service winding (Ubias) (2). <br>  4. Minimum supply voltage (UACmin) (3). <br>  5. Maximum mains voltage (UACmax) (3). <br>  6. The ripple level on the filter capacitor of the mains rectifier (Urpl) (4). <br>  7. The expected efficiency of the transformer (take 0.85 and do not lose) (≈ã). <br>  8. Frequency of the converter (5). <br>  9. Peak value of the current flowing through the key switching primary winding (ILPRpeak) (6). <br><br>  (1) If the output voltages are low enough, consider the direct voltage drop across the diode. <br>  (2) In the overwhelming majority of power supply designs, a third winding is required, from which the control chip will be powered. <br>  (3) Always take with a stock, i.e.  if the range is 180-264, take from 160 to 280. <br>  (4) This parameter can often only be guessed; take 10% of the constant component on it and you will not go wrong; in fact, the resulting working prototype is ‚Äúdredged‚Äù. <br>  (5) Frequency to converters with expectation of demagnetization of the core - floating, we take "from the ceiling" the one we want to get at full load. <br>  (6) I hope you know that the current shape is triangular, that the key switches, what is a key, etc. <br><br>  So, the first formula: <br>  We begin by defining the inductance of the primary winding, Lpr. <br><pre> Lpr = (1000 √ó 2 √ó POUTmax) / (≈ã √ó F √ó ILPRpeak ^ 2) (1)
</pre><br>  For simplicity, I‚Äôll throw out efficiency, and a factor of 1000, which is needed only to bring the result to Henry‚Äôs micro, will have the following equation: <br><br><pre> Lpr = (2 √ó POUTmax) / (F √ó ILPRpeak ^ 2) (1.1)
</pre><br>  At first glance, it is completely incomprehensible how this happens.  Let's try to convert it.  Transferring the multipliers from right to left, we get. <br><br><pre> (Lpr √ó ILPRpeak ^ 2) / 2 = POUTmax / F (1.2)
</pre><br>  Transform the right side, we get: <br><br><pre> (Lpr √ó ILPRpeak ^ 2) / 2 = POUTmax √ó T (1.3)
</pre><br>  So, on the left side we have the energy contained in the inductance (physics textbook, if it is not clear).  In the right part we have the power consumed during the period of the converter operation.  Those.  the energy stored in the inductance of the primary winding (at the pumping stage, from the beginning of the period to the opening of the key) is equal to the power transmitted to the load over the entire period T (from the beginning of the pumping, until the energy in the transformer is completely exhausted and the beginning of a new pulse). <br><br>  In the steady state, what is pumped into the transformer from the network should be equal to what was poured into the load.  Those.  all the arguments suggest that our source is already working, and not starting. <br><br>  Let us leave this formula (1) for now, we will use it later in the calculation, I just wanted to demonstrate how it turns out. <br>  Now about the parameters.  Let's look at the formula.  By fixing (choosing at our discretion) three out of four unknowns, we can get the value of the fourth. <br><br>  Power (POUTmax), we have already set. <br><br>  Frequency, you can simply choose at will.  Without further ado, let's say 50kHz and not lose.  Climb over 150kHz is not worth it, since the switching loss will become unreasonably high, and even the skin effect, we do not need it in the flyback. <br><br>  The peak value of the current through the primary winding, and at the same time the key, ILPRPeak, is a parameter on the nerves of which we will play.  Choosing its value ILPRPeak, we change the Lpr, and with it a lot of other things.  In my calculation, we will change ILPRpeak and observe other cells of the table, which will contain the results of other formulas.  Again, closer to reality, for a 100W source, you can set ILPRpeak = 3 ... 4A to start. <br><br>  Just try to substitute different numbers in the cell, and you will see how other derived parameters change.  In particular, choosing the peak current of the ‚Äúprimary‚Äù, we look at the ‚Äúreflected‚Äù voltage, and proceed from the considerations of the keys that we have.  Also, this parameter affects the peak value of the ‚Äúsecondary‚Äù current, which is also important, because in flybacks the currents have the shape of a right triangle, and the peak values ‚Äã‚Äãare several times higher than the effective ones, i.e.  if the load current is 5A, then the peak may be 50, be guided by the presence of diodes and losses in the copper winding. <br><br>  The second formula: <br><br><pre> UDCmin = UACmin √ó 1.41-Urpl (2)
</pre><br>  There is nothing to simplify, I think it is clear that we get the worst value of the constant voltage, taking into account the drawdown on the buffer capacitor, which is behind the network rectifier, or behind the CMC. <br><br><pre> Ton = (Lpr √ó ILPRpeak) / UDCmin (3)
</pre><br>  In the formula (3) we calculate how much time the key must be open, so that the current in the inductance, when our worst UDCmin is applied to it, grows from zero to the desired ILPRpeak. <br><br><pre> T = 1 / F √ó 1000 (4) 
</pre><br>  We set the frequency earlier, the period was calculated in (4).  We multiply by 1000 because we recorded the desired frequency in kHz and not in the 1000 Hertz. <br><br><pre> Toff = T-Ton (5)
</pre><br>  The rest of the period, which will be devoted to the transfer of energy to the load, is calculated by the formula (5). <br><br><pre> Q = Toff / Ton (6)
</pre><br>  The maximum fill factor for the worst voltage in the network and the maximum drawdown on the filter capacitor is calculated in (6). <br><br><pre> Urv = UDCmin √ó Ton / Toff (7)
</pre><br>  "Reflected" voltage.  Our transformer, albeit a flyback, but still a transformer, and therefore the transformation ratio to it is also applicable.  If on our secondary winding during the current flow through a rectifier diode, the voltage (for example) is 12.7V, then through the ratio of the number of turns this voltage is transformed into the primary winding (after all, the magnetic flux washes all the windings simultaneously). <br><br>  Formula (7), a little tricky, let's try to unleash it.  We get: <br><br><pre> UDCmin √ó Ton = Urv √ó Toff (7.1)
</pre><br>  (7.1) Demonstrates one very important point, popularly called ‚Äúequality of volt * second intervals‚Äù.  Perhaps the validity of the statement (7.1) is not obvious, or is not immediately clear, as long as we use the numerical value obtained using (7) as it is, do not doubt its validity. <br><br><pre> UVTmax = UACmax √ó 1.41 + Urv (8)
</pre><br>  I hope you understand well that on the reverse course, the primary winding, for a constant voltage, is just a piece of wire on the filter capacitor, i.e.  if our filter capacitor is still charged up to 310V, then when the power key is open, the current flows through the secondary winding, the constant simply ‚Äúpasses‚Äù through the primary and is applied to the key, but the reflected voltage is also added to the key.  And the saddest thing is that it adds up to a constant.  And this is without taking into account the emission from the leakage inductance, keep this in mind, in the calculation this circumstance is specifically highlighted in red. <br><br>  Then (8) shows what voltage will be applied to the power switch on the return stroke.  You can immediately add to the maximum voltage, on which the key is designed, still on top of the volts that way 200 and you can‚Äôt go wrong.  Layout will show the real amplitude of the voltage surge generated by the leakage inductance. <br><br>  Now we can calculate the transformer ratio, for example: <br><br><pre> Kfb = Uout / Urv (9)
</pre><br>  I call this transformation ratio "inverse", because  He is considered backwards.  Now the classic transformation ratio, which can be obtained: <br><br><pre> K = 1 / Kfb (10)
</pre><br>  Next, we calculate the maximum voltage that will be applied to the rectifier diode in the forward path of the converter.  I think you are well aware that it will be the sum of the voltage across the filtering capacitor of the load, which in operating mode, can be considered constant, and transformed, through the transformation ratio, the voltage applied to the primary winding. <br><br><pre> UVDmax = Uout + (VACmax √ó 1.41) / K (11)
</pre><br>  And do not forget that the emissions from the parasitic inductances of the transformer windings act on the diode including.  If we are talking about sources with high output voltages, take a voltage margin of at least 200V.  For low voltage, at least 1.5, and carefully look at the rectifier with an oscilloscope. <br><br>  Further. <br><br><pre> Lsec = Lpr / K ^ 2 (12)
</pre><br>  From (12) we obtain the inductance of the secondary winding of the transformer.  The rule that is used in the formula states that "the inductances of the transformer windings are related as squares of their turns", since  expression can be represented as: <br><br><pre> Lsec / Lpr = N2 ^ 2 / N1 ^ 2 (12.1) (N2 ^ 2 / N1 ^ 2 = K ^ 2)
</pre><br>  Next, calculate the peak current of the secondary winding.  Get ready to get large enough numbers here, because this is a ‚Äúreturn flow‚Äù, and its current in the ‚Äúsecondary housing‚Äù is triangular, and the peak value can be significantly greater than the load current. <br><br><pre> ILSECpeak = ‚àö (1000 √ó 2 √ó POUTmax) / (F √ó √ó Lsec) (13)
</pre><br>  This formula is converted in the same way as the first formula for ILPRpeak. <br><br><pre> ILSECrms = ILSECpeak‚àö (1-Q) / 3 (14)
</pre><br>  In (14), the effective current value is calculated through the secondary winding of the transformer.  I cannot explain why the root of (1-Q) / 3, it can probably be explained by plotting and resorting to geometry.  Here we also estimate the effective value of the current of the primary winding. <br><br><pre> ILPRrms = ILPRmax ‚àöQ / 3 (15)
</pre><br>  So, inductances, currents, frequencies are calculated.  And how to choose a magnetic core, you ask how to calculate a non-magnetic gap?  To begin with, we will ‚Äúestimate‚Äù it, based on our life experience, and ‚Äúhaving driven‚Äù its parameters into the calculation, having looked at the calculated induction, we can choose another magnetic circuit.  Here I wanted a power source of 100W, with an output voltage of 12V.  I take the ‚ÄúPQ2620‚Äù magnetic core ‚Äúfrom the ceiling‚Äù. <br><br>  From his Datasheet I write out Ae, the estimated gap, and inductance coefficient for a given gap (in Epcos datasheets, a table is often given with standard gaps for a given magnetic circuit, and Al and equivalent permeability values).  If there is no data on the Al coefficient for the gap you want, you will have to make it (the gap), wind the trial 100 turns, and calculate it using the simple formula Al = ‚àö (L / N ^ 2), where L is the measured inductance value on the core with a gap that you sawed through, N is the number of turns that you have sketched (I recommend to wind the trial 100 turns). <br><br>  Explain that Such Ae, G, and Al will not, assuming that you yourself know why you need a gap in the magnetic core, and that such Al.  Also, the equivalent permeability of the core with a gap can be entered into the calculation, but it is not used there (purely for beauty).  In formula (16) we consider the required number of turns. <br><br><pre> Npr = ‚àö Lpr / Al (16)
</pre><br>  One of the most important parameters for a transformer is the peak value of the flux of magnetic induction. <br><br><pre> B = (Lpr √ó ILPRpeak) / (Npr √ó Ae) (17)
</pre><br>  To exceed the value of 0.3, I categorically do not recommend, and 0.4 is a disaster.  Coincidentally, this magnetic circuit seems to fit well with our needs.  Induction is less than 0.3 TL, and I want to lay it under our needs.  Unfortunately, the calculation does not contain formulas for calculating the filling of the magnetic window of the magnetic circuit; therefore, it is impossible to give a final verdict on it. <br><br>  If the induction is greater than 0.3 Tl, we can either choose a larger magnetic circuit, or increase the gap.  Increasing the gap, we get a different value of Al and acc.  induction flow value. <br><br>  In general, life experience shows that it is better not to climb into the gaps of more than 1.5mm., Because they are characterized by their parasitic phenomena, such as buckling of magnetic field lines, heating the coils located near the gap, to temperatures at which they can come "Khan", in short from 0.2mm to 1.5mm.  Less than 0.2 - temperature expansion of the material can significantly change the parameters of the transformer.  More than 1.5mm - wrote above. <br><br>  Choosing the magnetic core, namely comparing different models, only along the core cross-section (Ae), one can lose sight of the fact that the length of the magnetic line also affects Al with the same cross-section and gap. <br><br>  For example, the PQ2620 magnetic core has a core area of ‚Äã‚Äã122mm.kV, and ETD34 is only 97mm.kv, but the lengths of the magnetic lines of these magnetic circuits are different, and you can also successfully pump 100W through ETD34, as well as through PQ2620.  I mean, take and substitute in the calculation all the ferrrites that are near those sizes that, as you think, can pump the desired power. <br>  After calculating the magnetic induction in the calculation, the number of turns of the secondary winding and the auxiliary winding is calculated, I will not dwell on them specifically, the methodology is the same as before. <br><br>  I hope the above will be useful to you.  The development of an IIP is a huge reservoir of applied science, and this ‚Äúcalculation‚Äù is only a small leaf of one of the Talmuds, in which all the experience of mankind is gathered, but it is extremely useful in the applied plan for developing simple ‚Äúflybacks‚Äù. <br><br>  My ‚Äúcalculation‚Äù (and not really mine, but inherited from the ideological mastermind) is a rather primitive tool, so I can recommend using the collection of programs of Vladimir Denisenko, which are easily found through a search engine.  Those who "chop" in the "power" theme, and has something to say, to my co-workers in comments.  Any criticism is welcome! <br><br>  What is not clear - ask, I will supplement the article with more detailed explanations. </div><p>Source: <a href="https://habr.com/ru/post/392101/">https://habr.com/ru/post/392101/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../392085/index.html">Created a prototype of a wearable device for the automatic diagnosis and correction of the blood glucose level of diabetics</a></li>
<li><a href="../392087/index.html">Developed in Russia: Meet the TrendVision DVRs</a></li>
<li><a href="../392093/index.html">Sound through the bones. SoundAround Headset Overview</a></li>
<li><a href="../392095/index.html">Microsoft apologized for organizing a party with erotic dances</a></li>
<li><a href="../392099/index.html">In the US, the wrong house was demolished due to an error on Google Maps</a></li>
<li><a href="../392103/index.html">Inventions of George Stiebitz</a></li>
<li><a href="../392105/index.html">The first electronic computer with a binary number system. Forgotten ABC Project</a></li>
<li><a href="../392107/index.html">An artist from New York has printed openwork armor and a prosthesis on a 3D printer.</a></li>
<li><a href="../392109/index.html">New photos of the world's largest airship Airlander 10</a></li>
<li><a href="../392113/index.html">Microsoft launched a teenager on Twitter - a teenager, and he learned bad things in a day</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>