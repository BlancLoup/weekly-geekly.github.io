<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New java ee leader? WildFly 8 in InfoboxCloud IaaS. Part 2. Domain Mode</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the first part, we deployed WildFly 8 to the InfoboxCloud Cloud Designer in Standalone mode. Let's see how you can deploy WildFly 8 in domain mode....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New java ee leader? WildFly 8 in InfoboxCloud IaaS. Part 2. Domain Mode</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/company/infobox/blog/210536/">In the first part,</a> we deployed WildFly 8 to the <a href="http://infobox.ru/cloudconstructor/">InfoboxCloud Cloud Designer</a> in Standalone mode.  Let's see how you can deploy <a href="http://wildfly.org/">WildFly</a> 8 in domain mode. <br><br>  <b>The goal: to deploy WildFly 8 in domain mode with a separate domain controller and two hosts on which 2 WildFly application servers can run in high availability mode.</b> <br><br> <a href="http://infobox.ru/cloudconstructor/"><img src="https://habrastorage.org/getpro/habr/post_images/ddb/3a5/4fd/ddb3a54fdf500e9cf47c3bcb225fb206.png" alt="image"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Domain mode or offline mode? </h4><br>  Offline mode is more suitable for development scenarios when only one server is needed.  Only in this mode <a href="http://arquillian.org/">Arquillian</a> tests will work.  Also, offline mode is suitable if you use a lot of WildFly servers with a self-written server management system. <br><br>  Domain mode (Domain mode) allows you to centrally manage configurations WildFly.  Using a domain is convenient for deploying and supporting clusters consisting of WildFly nodes. <br><br>  WildFly elements in domain mode: <br><img src="https://habrastorage.org/getpro/habr/post_images/243/6a3/49c/2436a349ccdfdceea634ad880aeefdf4.jpg" alt="image"><br><a name="habracut"></a><br>  The following elements can be distinguished in the domain: <br><ul><li>  <b>Domain controller</b>  Application server running in domain mode.  Will run at least one domain controller process.  The domain controller manages centralized configurations that are distributed to the hosts in the domain. </li><li>  <b>Host controller</b>  The process is responsible for coordinating the domain controller and the life cycle of the application servers.  Through the host controller, applications are deployed from the domain controller to the application servers.  In fact, the host is a virtual or physical server. </li><li>  <b>Application server node.</b>  Normal java-processes that are executed on the application server.  Each application server node belongs to a server group. </li><li>  <b>Server group</b>  A logical combination of two hosts for use by different applications.  For example, you can use the main-server-group for a stable version of the application and the other-server-group for the development version.  Both applications will work without a point of failure and will be distributed between two hosts. </li><li>  <b>Process controller</b>  Very lightweight processes.  Their main function is to spawn the server and host controller processes and control their input / output streams. </li></ul><br>  If something goes wrong when setting the domain mode, you can always see the host controller logs ( <b>/usr/share/wildfly/domain/log/host-controller.log</b> ) and the process controller ( <b>/ usr / share / wildfly / domain / log / process-controller.log</b> ). <br><br><h4>  Setting up WildFly 8 in domain mode in InfoboxCloud </h4><br><h5>  1. Creating an account in InfoboxCloud </h5><br>  If you do not have an account with InfoboxCloud Cloud Designer - <a href="http://infobox.ru/cloudconstructor/">register for a trial version for free</a> .  Using the cloud is ideal for JavaEE deployment scenarios, as it allows not to use unnecessary resources during the development period, and when commissioning software systems into operation, allows flexibility in adapting resources to the real load.  The cloud designer provides the ability to set the values ‚Äã‚Äãof CPU, Ram, disk and other resources independently of each other, thereby creating servers suitable for your task. <br><br><h5>  2. Creating servers in InfoboxCloud for the domain controller and hosts </h5><br>  Create a server for a domain controller and 2 hosts in the <a href="http://infobox.ru/cloudconstructor/">cloud designer</a> (in case of difficulty, you can refer to the <a href="http://habrahabr.ru/company/infobox/blog/210536/">first part of the article cycle</a> . At the time of setup, it is recommended to allocate more resources to each server you create, and after setting up and deploying applications, you can find the optimal minimum. and setting up WildFly. Since you only pay for the actual resources used per hour - setting up powerful servers is very pleasant and costs very little.  we made the domain controller and hosts such: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aeb/76b/d04/aeb76bd04c13492873bfe567886b7952.jpg" alt="image"><br><br>  We used the CentOS operating system on all hosts.  After the servers are created, the generated server passwords will come to the mail.  If you wish, you can change them in the server control panel.  You are also free to switch to key access, which will make working with servers safer and protect bots from selecting passwords (do not forget to disable password access in this case). <br><br>  In order not to waste your time on manually installing WildFly, dependencies and creating a service, we automated the installation process.  If you need to install WildFly manually, you can view the installation script and understand what is happening or send the author advice on how to do better with the implementation :) <br><br>  To install WildFly on each of the three servers created, run the script: <br><pre><code class="bash hljs">wget repository.jelasticloud.com/scripts/wildfly8/linux64/wildfly-domain &amp;&amp; chmod +x wildfly-domain &amp;&amp; ./wildfly-domain &amp;&amp; rm -rf wildfly-domain</code> </pre> <br>  <i>After the release of Java 8 in this post and in the <a href="http://infoboxcloud.ru/community">InfoboxCloud Community, there</a> will be links to an additional script for installing WildFly with JDK 8 included.</i>  <i>While the latest version of JDK7 is being installed.</i> <br><br>  Upon completion of the installation, let's make it on all servers so that WildFly starts automatically when the server is loaded: <br><pre> <code class="bash hljs">chkconfig --add wildfly chkconfig --level 234 wildfly on</code> </pre><br><h5>  3. Configure the domain.xml domain controller </h5><br>  The domain configuration is set via the <b>domain.xml</b> file located in <b>/ usr / share / wildfly / domain / configuration</b> .  It is necessary to define the configuration <b>of server groups</b> (which can always be changed in real time). <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server-groups</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server-group</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"main-server-group"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">profile</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"full"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jvm</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">heap</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"64m"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max-size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"512m"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jvm</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socket-binding-group</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"full-sockets"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server-group</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server-group</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"other-server-group"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">profile</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"full"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jvm</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">heap</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"64m"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max-size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"512m"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jvm</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socket-binding-group</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"full-sockets"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server-group</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server-groups</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  As you can see, two server groups are defined by default: <b>main-server-group</b> and <b>other-server-group</b> .  <b>Profile</b> and <b>socket-binding-group are</b> set for each <b>group</b> . <br><br>  WildFly supports four pre-configured profiles: <br><ul><li>  <b>default</b> : Supports <b>Java EE Web-profile</b> and extensions to support <b>REST</b> and <b>EJB remote invocations</b> .  For <b>socket-binding-group</b> , the value should be set to <b>"standard-sockets"</b> . </li><li>  <b>full</b> : Fully supports <b>Java EE Full-profile</b> and all the features of an application server without clustering.  For <b>socket-binding-group</b> , the value should be set to <b>"full-sockets"</b> . </li><li>  <b>ha</b> : default profile with clustering enabled.  For <b>socket-binding-group</b> , the value must be set to <b>"ha-sockets"</b> . </li><li>  <b>full-ha</b> : A complete Java EE profile with clustering support.  For <b>socket-binding-group</b> , the value should be set to <b>"full-ha-sockets"</b> . </li></ul><br><h5>  4. Configure host.xml for a domain controller </h5><br>  The <b>host.xml</b> file located at <b>/ usr / share / wildfly / domain / configuration</b> defines: <br><ul><li>  application servers that are part of the domain and server groups in which they belong. </li><li>  network interfaces and security settings for these application servers. </li><li>  hosted domain controller. </li></ul><br>  In our domain configuration, there will be no application servers running on the same host.  We want to have a dedicated domain controller.  To do this, you need to remove the contents from the <b>servers</b> section as <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servers</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servers</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <i>Note: Failure of a domain controller will not stop applications in the cluster.</i>  <i>Fails - lift another or recover from snapshot.</i>  <i>A domain controller is only needed to manage the domain and deploy applications to it.</i> <br><br>  The next step is to specify that the domain controller is running on the same host.  To do this, configure the <b>domain-controller</b> section in <b>host.xml</b> as <b>follows</b> : <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">domain-controller</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">local</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">domain-controller</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Next, add a user to manage the domain via <b>/usr/share/wildfly/bin/add-user.sh</b> . <br><img src="https://habrastorage.org/getpro/habr/post_images/8ed/25b/801/8ed25b801458ed74296376266b9bb84c.jpg" alt="image"><br>  Do not forget to save the base64 key secret value, which the utility writes after adding the user.  We need it to configure the hosts.  Just do not forget to answer the last question yes, as in the screenshot. <br><br>  For security purposes in production use, it is recommended to limit the ip from which domain management is possible.  This can be done in the <b>/usr/share/wildfly/domain/configuration/host.xml</b> file, replacing <b>&lt;any-address /&gt;</b> in the <b>management</b> section with <b>&lt;inet-address value = "$ {jboss.bind.address.management:127.0. 0.1} "/&gt;</b> and substituting 127.0.0.1 for the address from which domain control is allowed. <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interfaces</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"management"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">inet-address</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${jboss.bind.address.management:127.0.0.1}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"public"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">any-address</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"unsecure"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Used for IIOP sockets in the standard configuration. To secure JacORB you need to setup SSL --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">inet-address</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${jboss.bind.address.unsecure:127.0.0.1}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interfaces</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Now restart the domain controller with the command <br><pre> <code class="bash hljs"> service wildfly restart</code> </pre><br>  In the WildFly control panel on port 9990 at the address of your domain controller, we see that so far no servers are connected to it on which our Java EE applications will run. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f10/aba/824/f10aba824017b334a562d4cb1fbc0e7f.jpg" alt="image"><br><br><h5>  5. Setting up hosts </h5><br>  Host configuration is done in the <b>host.xml</b> file located at <b>/ usr / share / wildfly / domain / configuration</b> . <br>  We assign a unique name for each host (in the configuration below, the name is <b>wh0</b> . For the other host, <b>wh1</b> . The names must not be the same): <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">host</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wh0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:jboss:domain:2.0"</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">host</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Specify how the host controller will connect to the domain controller. <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">domain-controller</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- &lt;local/&gt; --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Alternative remote domain controller configuration with a host and port --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">remote</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">host</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"10.127.5.203"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"9999"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">username</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"trukhinyuri"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">security-realm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ManagementRealm"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">domain-controller</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Do not forget to change the ip ‚Äì address specified in the configuration to the address of your host.  You can use a private ip-address, since both the domain controller and the hosts are running in the same cloud.  Also replace the username with the one you specified when adding the management user to the domain controller via <b>./add-user.sh</b> . <br><br>  It's time to set up a secret base64 key to access the domain controller.  We <b>act</b> in the same place in <b>host.xml</b> host: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">management</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security-realms</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security-realm</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ManagementRealm"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server-identities</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">secret</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"secretBase64key"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server-identities</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security-realm</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security-realms</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">management</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The last step in configuring hosts is to change the <b>server</b> section in <b>hosts.xml</b> . <br>  For the first <b>wh0</b> node: <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"server-one"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">group</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"main-server-group"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Remote JPDA debugging for a specific server &lt;jvm name="default"&gt; &lt;jvm-options&gt; &lt;option value="-agentlib:jdwp=transport=dt_socket,address=8787,server=y,suspend=n"/&gt; &lt;/jvm-options&gt; &lt;/jvm&gt; --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"server-two"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">group</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"other-server-group"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">auto-start</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- server-two avoids port conflicts by incrementing the ports in the default socket-group declared in the server-group --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socket-bindings</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port-offset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"150"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servers</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  for the second node <b>wh1</b> : <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"server-three"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">group</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"other-server-group"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Remote JPDA debugging for a specific server &lt;jvm name="default"&gt; &lt;jvm-options&gt; &lt;option value="-agentlib:jdwp=transport=dt_socket,address=8787,server=y,suspend=n"/&gt; &lt;/jvm-options&gt; &lt;/jvm&gt; --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"server-four"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">group</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"main-server-group"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">auto-start</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- server-two avoids port conflicts by incrementing the ports in the default socket-group declared in the server-group --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socket-bindings</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">port-offset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"150"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">server</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servers</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  All is ready.  Reboot the hosts: <br><pre> <code class="bash hljs">service wildfly restart</code> </pre><br>  Now we‚Äôll go back to the domain controller‚Äôs control panel: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/947/77f/594/94777f59412b199edf69d1f154e3eb9c.jpg" alt="image"><br>  We see that the hosts have appeared and you can manage them or deploy applications to them.  For application servers 2 and 4, we deliberately turned off the automatic start in the <b>servers</b> section of the <b>hosts.xml</b> file.  Try running them from the control panel of the domain controller. <br><br>  In this article, WildFly 8 was successfully configured in the domain controller mode in the <a href="http://infobox.ru/cloudconstructor/">InfoboxCloud Cloud Designer</a> .  We left behind the balancer setting and many other details, which will be discussed in the following articles.  For any questions about setting up or generally on the cloud, you can write to the author <a href="">Yuri Trukhin</a> or to the <a href="https://www.facebook.com/groups/infoboxcloud/">InfoboxCloud Community on Facebook</a> .  Successful work! </div><p>Source: <a href="https://habr.com/ru/post/212031/">https://habr.com/ru/post/212031/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../212015/index.html">Creating a Markdown Tag Using Polymer / Web Components</a></li>
<li><a href="../212019/index.html">A passion for programming. Chapter 22. Remember who you work for</a></li>
<li><a href="../212023/index.html">Developing Backbone.js Applications</a></li>
<li><a href="../212027/index.html">The wxWidgets tool library. Assembly</a></li>
<li><a href="../212029/index.html">The public alpha version of the decentralized Tox messenger has been released.</a></li>
<li><a href="../212035/index.html">Keyboard Oktodon in search of the Right Click</a></li>
<li><a href="../212037/index.html">Microsoft released a set of updates, February 2014</a></li>
<li><a href="../212039/index.html">The method of localization of persons using the method of fast comparison based on the OSAD algorithm (excerpt from the publication)</a></li>
<li><a href="../212041/index.html">BYOD in Windows 8.1</a></li>
<li><a href="../212045/index.html">Like graphene, only from phosphorus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>