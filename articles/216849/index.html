<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Setting up the development environment for OpenStack</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About the OpenStack system there were a lot of articles on Habr√©, but none touched on the development and testing of composite services. I will say ri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Setting up the development environment for OpenStack</h1><div class="post__text post__text-html js-mediator-article">  About the OpenStack system there were a lot of articles on Habr√©, but none touched on the development and testing of composite services.  I will say right away, it is not easy and not very gratifying to tune the environment with bare hands.  Fortunately, there is an official program called <a href="http://devstack.org/">Devstack</a> , which is a set of scripts to automatically install OpenStack on a local virtual machine.  Well, I would like to finish the article here, but not everything is so smooth with this Devstack.  Namely, to install it is a whole process of dancing with tambourines and choosing the right configuration parameters.  In addition, the project is moving its own step, and what worked today can take off with any new committee. <br><br><h4>  Task </h4><br>  It is necessary to build a development environment for OpenStack for testing, bugfixing and adding features to the system services (nova, keystone, swift, heat, etc.).  The environment should be built almost automatically, so that it is possible at any time to erase the created virtual machine, create a new one, run scripts and get the environment ready in a few minutes.  And the environment should be <b>the same</b> as on the previous VM.  Since the service of interest to me at the time of writing this article is heat, the configuration will be oriented to it, but by replacing a pair of lines you can adapt the entire configuration to any other service. <br><a name="habracut"></a><br><h4>  We collect </h4><br>  For assembly in the arsenal should be the following tools: VirtualBox, Vagrant.  Everything else must be delivered by itself.  I compiled on OSX 10.9.2, but I think there should be no problems with other * nix OSs. <br><br><h6>  Virtualbox </h6><br>  Everything is simple, go to <a href="https://www.virtualbox.org/">www.virtualbox.org</a> , download the release for your operating system and install.  I put 4.3.8 for Vagrant sometimes spits on 4.2. *, Threatening to put nfs wrong. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  Vagrant </h6><br>  We put <a href="http://www.vagrantup.com/%25E2%2580%258E">Vagrant</a> version <b>1.3.5</b> (note, when installing any other version, nfs is not guaranteed to work) and create a directory where we will store our environment, say / home / user / devstack.  Put the Vagrantfile file in the folder with the following content: <br><br><pre><code class="ruby hljs">-- <span class="hljs-symbol"><span class="hljs-symbol">mode:</span></span> ruby -- <span class="hljs-symbol"><span class="hljs-symbol">vi:</span></span> set ft=ruby : Vagrant config VAGRANTFILE_API_VERSION = <span class="hljs-string"><span class="hljs-string">"2"</span></span> Vagrant.configure(VAGRANTFILE_API_VERSION) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|config|</span></span> config.vm.box = <span class="hljs-string"><span class="hljs-string">"heat"</span></span> config.vm.box_url = <span class="hljs-string"><span class="hljs-string">"http://files.vagrantup.com/precise32.box"</span></span> <span class="hljs-comment"><span class="hljs-comment">#    VM  2048MB config.vm.provider :virtualbox do |vb| vb.customize ["modifyvm", :id, "--memory", "2048"] end #     Horizon config.vm.network :forwarded_port, guest: 80, host: 8080 #  IP ,  NFS config.vm.network :private_network, ip: "192.168.11.10" #  /opt/stack c  /home/user/devstack. config.vm.synced_folder "/home/user/devstack", "/opt/stack", nfs:true end</span></span></code> </pre> <br><br>  Save the file, go to / home / user / devstack and build the VM <br><pre> <code class="bash hljs">vagrant up</code> </pre> <br>  We get access to VM <br><pre> <code class="bash hljs">vagrant ssh</code> </pre> <br>  We can now go directly to installing packages and the devstack itself.  Since the machine we received is completely empty, we must put everything ourselves. <br><br><pre> <code class="bash hljs">sudo apt-get update &amp;&amp; sudo apt-get -y install git vim-gtk libxml2-dev libxslt1-dev libpq-dev python-pip libsqlite3-dev &amp;&amp; sudo apt-get -y build-dep python-mysqldb &amp;&amp; sudo pip install git-review tox &amp;&amp; git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://git.openstack.org/openstack-dev/devstack -b stable/havana &amp;&amp; chown -R vagrant:vagrant devstack &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> devstack</code> </pre><br><br>  Congratulations, you now have a non-configured but stable devstack release havana. <br><br><h6>  Devstack </h6><br>  Devstack can be customized as you like.  The configuration is quite flexible, and sometimes confusing.  I‚Äôve put together a configuration that puts all the stable (havana) OpenStack services, except heat.  Make sure that you are in the devstack folder and create a local.conf file (you can also use localrc, devstack to work with both) <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#, ... ADMIN_PASSWORD=devstack MYSQL_PASSWORD=devstack RABBIT_PASSWORD=devstack SERVICE_PASSWORD=devstack SERVICE_TOKEN=devstack #   #RECLONE=yes #OFFLINE=True # Swift #SWIFT_REPLICAS=1 #SWIFT_HASH=011688b44136573e209e #   HOST_IP=192.168.11.10 HOST_IP_IFACE=eth1 FLAT_INTERFACE=br100 PUBLIC_INTERFACE=eth1 FLOATING_RANGE=192.168.11.224/27 #   LOGFILE=/opt/stack/logs/stack.sh.log VERBOSE=True LOG_COLOR=True SCREEN_LOGDIR=/opt/stack/logs #      NOVA_BRANCH=stable/havana CINDER_BRANCH=stable/havana GLANCE_BRANCH=stable/havana HORIZON_BRANCH=stable/havana KEYSTONE_BRANCH=stable/havana NEUTRON_BRANCH=stable/havana SWIFT_BRANCH=stable/havana HEAT_BRANCH=stable/havana CEILOMETER_BRANCH=stable/havana # Horizon ENABLED_SERVICES+=,horizon #  Heat (master branch) HEAT_REPO=https://github.com/openstack/heat.git HEAT_BRANCH=master #   ##   Neutron disable_service n-net enable_service q-svc enable_service q-agt enable_service q-dhcp enable_service q-l3 enable_service q-meta enable_service neutron #  Cinder disable_service cinder disable_service c-api disable_service c-sch disable_service c-vol ##   Swift,      :) #enable_service s-proxy s-object s-container s-account ##  Heat ENABLED_SERVICES+=,heat,h-api,h-api-cfn,h-api-cw,h-eng IMAGE_URLS+=",http://fedorapeople.org/groups/heat/prebuilt-jeos-images/F17-x86_64-cfntools.qcow2" IMAGE_URLS+=",https://launchpad.net/cirros/trunk/0.3.0/+download/cirros-0.3.0-x86_64-disk.img" ##  Ceilometer #   ,     ,       - postgres #CEILOMETER_BACKEND=mongo ENABLED_SERVICES+=,ceilometer-acompute,ceilometer-acentral,ceilometer-collector,ceilometer-api ENABLED_SERVICES+=,ceilometer-alarm-notify,ceilometer-alarm-eva</span></span></code> </pre><br>  Make sure your HOST_IP matches the value of private_network ip in the Vagrantfile. <br>  <u>I remind the working version of the software for this configuration: VirtualBox 4.3.8, Vagrant 1.3.5</u> <br><br>  Look like that's it.  Save the file and run ./stack.sh.  Everything is going for quite a long time, considering that Heat pumps two disk images for testing.  But this can be easily removed if the focus is not on heat, but on another service. <br>  These configs on GitHub: <a href="https://github.com/sorantis/stackenv">github.com/sorantis/stackenv</a> <br>  Questions, suggestions, leave in the comments, I will be glad to bring the whole process to a one-click button! <br><br>  PS If the article turned out to be useful to someone, then I can continue to share my experience here. </div><p>Source: <a href="https://habr.com/ru/post/216849/">https://habr.com/ru/post/216849/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../216833/index.html">Where "soap" in WPF comes from and how to deal with it</a></li>
<li><a href="../216837/index.html">Devise: login and registration in modal windows</a></li>
<li><a href="../216839/index.html">The colors and the difference between them in LESS / Sass</a></li>
<li><a href="../216843/index.html">We start to study Cortex-M on the example of STM32</a></li>
<li><a href="../216845/index.html">Search for solutions for games with words. Boron application</a></li>
<li><a href="../216851/index.html">We control the machine via Bluetooth from a tablet or phone for Android</a></li>
<li><a href="../216853/index.html">Gateway between IRC and Google Hangouts</a></li>
<li><a href="../216857/index.html">Synchronization in Android applications. Part two</a></li>
<li><a href="../216865/index.html">Use a hash search, not an array search</a></li>
<li><a href="../216869/index.html">Alternative GDC Arcade: Home-Made Freak Controllers Gallery</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>