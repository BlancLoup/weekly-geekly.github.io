<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kibershpana attacks accounting. Analysis of attacks on 1C bases</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Everyone has heard about the sensational hacker attacks on financial institutions. Attackers steal millions of dollars, their actions are thoroughly i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Kibershpana attacks accounting. Analysis of attacks on 1C bases</h1><div class="post__text post__text-html js-mediator-article">  Everyone has heard about the sensational hacker attacks on financial institutions.  Attackers steal millions of dollars, their actions are thoroughly investigated by researchers, the whole industry feeds on means of protection against them.  In the world of offline crime, loud murders are also widely discussed, not petty thefts.  Small companies are of no interest to serious cybercrime, but they are attacked at least by large banks.  This is usually a variety of malware, in particular encryption viruses, extort money for decrypting files.  But there are also real ‚Äúhackers‚Äù who want to profit from unlucky businessmen. <br><br>  Recently, we were able to study two compromised systems that were subject to similar attacks.  Using their example, we will look at how attackers act and what errors allowed them to successfully penetrate the servers of organizations. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c80/34c/0bc/c8034c0bcc2d4df78b5de67296d64e25.jpg"></div><a name="habracut"></a><br><h3>  Victim 1 </h3><br>  A small company (less than 50 employees).  1 server running Win 2008. 1C Accounting is installed on the server, file balls are deployed.  The domain is not deployed, on the automated workplace and server, local accounts for employees are used.  Accountants can come from home via RDP to a server for remote work in 1C.  Admin coming.  In general, the picture is quite characteristic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      On Monday morning, accountants do not start 1C.  This happens.  According to the instructions of the administrator, the accountant enters the folder with the 1C databases in order to ‚Äúdistort‚Äù them.  I do not know what this 1C mode of operation is, which requires ‚Äúdistorting‚Äù the bases, and what this generally means, but the bases in the folder are not found.  Instead of them is the file "READ !!!!!!. Txt".  It says (without any respect for spelling and punctuation) that the bases are stolen.  If you wish to return the database, you are invited to contact the specified email-address (in the style of vasyanpetrov2001@mail.ru). <br><br>  Panic begins.  An administrator is called to the company and unsuccessfully trying to figure out what happened and restore the system.  The director writes a letter to the hacker.  The hacker succinctly requests the server‚Äôs IP address and then demands 30,000 rubles.  for the return of bases.  To be honest, we thought that we should demand an order of magnitude more, but the attackers obviously know their victims better. <br><br>  Our specialist was asked to help.  The administrator returned the server to the office from the house where he was taking it for analysis, and he joined our specialist.  Hard disk analysis has shown that recovering deleted databases is already difficult.  Due to the multiple inclusion of the server, attempts to restore backups and other manipulations, deleted files are overwritten with new ones.  No signs of system infection, rootkits, etc.  not found.  In the logs (they were not cleaned), it was clearly visible that on Friday evening a brute force of logins / passwords started on the RDP.  On Sunday, a simple password for one of the accountants was chosen.  The search continued and ended only after the attacker's login to the car on Monday night. <br><br>  Common sense suggested that the logic of the "business" of the attacker did not involve the return of databases, and indeed their copying to a remote server.  Encryption viruses need a good reputation for the growth of payments, since they work massively and victims can read about them on the Internet.  Here it was logical in place of the hacker to simply demand more money after receiving the first tranche.  To check this version, data from the billing of the provider was requested.  Indeed, no one downloaded the database.  They just removed.  Communication with not respecting Rosenthal hacker, respectively, was minimized. <br><br>  Further research showed that, for some reason, in a panic, everyone decided that the last backup was a couple of months ago.  Moreover, the backup bases were on the same hard disk as the combat bases, and were accessible to the hacker, but he did not bother to look for them.  In fact, the backup was made 1 working day before the hacking and information can be quickly restored.  Everyone mentally wished the hacker a painful death and the joyful ones parted ways. <br><br>  Recommendations that could be given to the affected company (given its modest size): <br><br><ul><li>  backups should be made regularly and stored separately; </li><li>  user rights should be minimized (all accountants had full access to everything on the server); </li><li>  Remote access is best organized by VPN and use the token in addition to the password.  It practically does not require costs, and security will grow decently. </li></ul><br><h3>  Victim 2 </h3><br>  A large company that has servers on collocation in one of the commercial data centers in Moscow.  The data center receives information that a stream of malicious traffic is being recorded from one of the white IP companies (no details were provided).  We were asked to help administrators figure out what was going on. <br><br>  Analysis showed that the traffic comes from a virtual server with a management console of Kaspersky Anti-Virus.  Those who have worked with this product know that, more often than not, control over the console gives administrator rights on all machines where antivirus is installed.  It is clear that the gray hair from such news from the administration group greatly increased.  Immediately, a snapshot of the virtual machine was created with the preservation of RAM data.  After that, the machine in the work network was extinguished and the analysis of the copy in the isolated segment began. <br><br>  What was our surprise when we discovered that the hacking was also carried out through a brute force password on the RDP from the Internet.  Administrators claimed that the server was not published on the Internet.  In parallel, they began to study the effects of hacking and how RDP was available from the external network. <br><br>  The second came out quickly.  It turned out that the network administrator edited the access lists (ACLs) on the Cisco border router through the console.  After completing the work, he rolled the ACL on the interface ... vice versa.  That is, incoming and outgoing were confused in places, opening up full access to a set of servers from the Internet.  No one noticed. <br><br>  The password was picked up very quickly.  The company adopted a password policy, but then for some reason forgot about it.  Then, 4 accounts with local administrator rights (Adm1n, Default User, Register, ASPNET) were created on the server.  After some time, the attacker entered ASPNET account.  Not finding 1C databases (it will become clear later, as we realized that hunters on 1C were also operating there), the hacker manually opened the browser, launched speedtest.net to understand the bandwidth of the channel to the server, and uploaded the RDP utility to the server for searching passwords.  Manually poshamaniv with the settings, the hacker launched an attack on external servers.  There were no signs of attempts to develop an attack on the internal network or use the Kaspersky console.  If the malefactor could even think a bit about his brain, he would eventually be able to extort from the victim a lot more than 30,000 rubles. <br><br>  For the password brutus, the utility downloaded from the popular ‚Äúhacker‚Äù forum was used.  A hacker manually uploaded brute force dictionaries and launched an attack.  The search went for uchetok with speaking names: Administrator, User1, User2, Buh, Buh1, Buh2, Buhgalter, Glbuh. <br><br>  You can laugh at the primitiveness of the approaches, the complete lack of automation and the weak technical knowledge of the hacker, but all this has turned out to be quite effective.  During the work of the utility, 4 real servers of Russian companies were hacked (with passwords like 12345).  The attacker manually entered the hacked server from which the attack was proceeding and checked the catch, which was added to a file in the folder with the utility. <br><br>  In general, the company made conclusions after the incident: <br><br><ul><li>  It became quite obvious that the existence of policies does not guarantee their implementation.  It is necessary to introduce control procedures. </li><li>  The process of stripping the internal network from unprotected machines has begun.  Everyone was convinced that the attacker could get to them under certain circumstances. </li><li>  The procedure of automatic control of network changes on the network perimeter was introduced (automatic scanning 2 times per day). </li><li>  The change control procedures have been added. </li><li>  A regular scan for vulnerabilities outside and inside the network was introduced. </li><li>  In general, some kind of intrusion detection system, which would stop brute force during an attack, would not hurt. </li></ul><br><h3>  Conclusion </h3><br>  The cause of both hacks is more likely not the money-craving scripts that are greedy for easy money, but the disorder or mistakes of the administrators themselves.  There will be an opportunity to profit, there will be those who wish.  Especially if it does not require much effort.  Yes, and a superficial approach to hacking can be explained not by laziness and unprofessional hackers, but by a streaming approach to attacks: it is easier to sort out the extra hundred servers than to dig with one. <br><br>  In any case, even such simple attacks can cost companies of any size very expensive.  Offline banks build underground safes, and a barn lock is hung on a stall for the night. <br><br>  Nobody leaves the door wide open.  On the Internet, everything is still somewhat different.  To the delight of attackers of all stripes and levels of professionalism. <br><br>  Andrey Yankin, <a href="https://geektimes.ru/users/itsecurity/" class="user_link">itsecurity</a> </div><p>Source: <a href="https://habr.com/ru/post/369903/">https://habr.com/ru/post/369903/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../369889/index.html">What sound black holes can tell us about real</a></li>
<li><a href="../369891/index.html">Pricing in High End: a little about the "sheepskin" and "dressing"</a></li>
<li><a href="../369893/index.html">Ask Ethan # 106: Where exactly was Newton wrong?</a></li>
<li><a href="../369899/index.html">Scanning the physical structure of the brain establishes a person‚Äôs identity with accuracy close to 100%</a></li>
<li><a href="../369901/index.html">HSE Business Incubator opens the second set of participants of the FINTECH program</a></li>
<li><a href="../369905/index.html">How I tried to promote regional robotics via the Internet</a></li>
<li><a href="../369907/index.html">Ultrabook Review ASUS UX330UA</a></li>
<li><a href="../369909/index.html">Black and Black Friday ...</a></li>
<li><a href="../369911/index.html">Cassini is preparing for his final mission: traveling to the rings of Saturn with a deadly immersion into the atmosphere of the planet.</a></li>
<li><a href="../369913/index.html">Neural network Google Translate has made a single database of meanings of human words</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>