<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Static analysis as part of the Unreal Engine development process</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Unreal Engine project is developing - a new code is added and the already written will be changed. The inevitable consequence of the development o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Static analysis as part of the Unreal Engine development process</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dda/dc7/98b/ddadc798b6b8f4cdd200b7d9360dffd4.png" alt="PVS-Studio &amp; Unreal Engine"></div><br>  The Unreal Engine project is developing - a new code is added and the already written will be changed.  The inevitable consequence of the development of the project is the appearance in the code of new errors that it is desirable to detect as soon as possible.  One way to reduce the number of errors is to use the PVS-Studio static code analyzer.  Moreover, the analyzer is also developing rapidly and is learning to find new error patterns, some of which will be discussed in this article.  If you are concerned about the quality of the code of your projects, then this article is for you. <br><a name="habracut"></a><br>  <i>The publication was prepared by Andrei Karpov, code samples were provided by Ilya Ivanov and Sergey Vasiliev from the PVS-Studio team.</i>  <i>The original source is the Unreal Engine Blog: " <a href="https://www.unrealengine.com/en-US/blog/static-analysis-as-part-of-the-process">Static Analysis as part of the Development Process</a> ".</i> <br><br><h2>  Static code analysis, theory </h2><br>  Static code analysis is the process of identifying errors and shortcomings in the source code of programs.  Static analysis can be viewed as an automated code review process.  Let us dwell on the review of the code in more detail. <br><br>  Code review is one of the oldest and most useful methods for detecting defects.  It consists in joint attentive reading of the source code and making recommendations for its improvement.  In the process of reading the code, errors or sections of code that may become erroneous in the future are detected.  It is also considered that the author of the code during the review should not give an explanation of how this or that part of the program works.  The algorithm must be understood directly from the program text and comments.  If this condition is not met, then the code should be refined. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a rule, code review works well, because programmers are much easier to notice errors in someone else's code.  More details on the code review methodology can be found in Steve McConnell's excellent book ‚ÄúCode Complete‚Äù. <br><br>  The code review methodology has two drawbacks: <br><br><ol><li>  Extremely high price.  It is necessary to regularly distract several programmers from their main work in order to review a new code or re-review a code after making recommendations.  In this case, programmers should regularly take breaks for rest.  If you try to view large fragments of code at once, then the attention is quickly dulled, and the benefits of reviewing the code quickly disappear. </li><li>  It is difficult for people to detect errors that are not directly related to the new / modified code.  Considering the freshly written fragment, it is difficult to assume that the <i>malloc</i> function is working incorrectly in it due to the fact that the <i>stdlib.h</i> header file is not <i>included</i> .  This situation is described in more detail in the article " <a href="https://www.viva64.com/ru/b/0033/">Beautiful 64-bit error in the C language</a> ".  Another example: changing the type of function or variable in the header file.  In theory, after such changes, you must look through all the code in which this function or variable is used.  In practice, this is too time consuming and, as a rule, the review is limited only to those places where the programmer has changed something. </li></ol><br>  On the one hand, I want to regularly review the code.  On the other hand, it is too expensive.  A compromise solution is static code analysis tools.  They process the source code of the programs and give the programmer recommendations to pay increased attention to certain areas of the code.  At the same time, the analyzers do not get tired and check all the code affected by the edits in the header files.  Of course, the program will not replace a full review of the code performed by a team of programmers.  However, the benefit / price ratio makes using static analysis a very useful practice used by many companies. <br><br>  Like any other error detection methodology, static analysis has its strengths and weaknesses.  There is no one ideal program testing method.  The best result can be obtained using a combination of different approaches, such as: good coding style, static code analysis, dynamic code analysis, unit testing, regression testing, and so on. <br><br>  An important advantage of static analysis is the ability to find many errors immediately after they appear in the code, which means that their correction will be very cheap. <br><br>  The fact is that the earlier the error is detected, the lower the cost of fixing it.  So, according to the data given in McConnell's ‚ÄúPerfect Code‚Äù, the correction of an error at the testing stage is ten times more expensive than at the coding (writing code) stage: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/375/a56/a0f/375a56a0faaadcadc7d11bccdd739a8e.png" alt="Table 1. The average cost of correcting defects depending on the time of their detection (data for the table are taken from the book by S. McConnell &quot;The Perfect Code&quot;)."></div><p></p><br>  <font color="#999999"><i>Table 1. The average cost of correcting defects depending on the time of their detection (data for the table are taken from S. McConnell‚Äôs ‚ÄúPerfect Code‚Äù).</i></font> <br><br>  Static analysis tools allow you to identify a large number of errors characteristic of the stage of writing code, which significantly reduces the cost of developing the entire project. <br><br>  The urgency of using static analyzers will only grow over time.  This is due to the gradual increase in the size of the code of modern applications.  Programs are getting bigger, getting harder.  At the same time, the error density in the code depends on its size nonlinearly. <br><br>  The larger the project, the more errors per 1000 lines of code it contains.  Take a look at this interesting table: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bdc/44e/987/bdc44e987664971605e82415fd055dc0.png" alt="Table 2. Project size and typical error density. Data Sources: &amp; quot; Program Quality and Programmer Productivity &amp; quot; (Jones, 1977), &amp; quot; Estimating Software Costs &amp; quot; (Jones, 1998)."></div><p></p><br>  <font color="#999999"><i>Table 2. Project size and typical error density.</i></font>  <font color="#999999"><i>Data sources: ‚ÄúProgram Quality and Programmer Productivity‚Äù (Jones, 1977), ‚ÄúEstimating Software Costs‚Äù (Jones, 1998).</i></font> <br><br>  To make it easier to perceive the data, we will construct graphs. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6e/81a/a2c/c6e81aa2cc1059d252907bd38022d4f2.png" alt="Typical error density in the project"></div><p></p><br>  <font color="#999999"><i>Chart 1. Typical density of errors in the project.</i></font>  <font color="#999999"><i>Blue is the maximum amount.</i></font>  <font color="#999999"><i>Red is the average.</i></font>  <font color="#999999"><i>Green is the least.</i></font> <br><br>  It follows from the graph that as the project grows, programmers have to use more and more means that will allow them to maintain the required quality of the project.  You can not do everything the same to create high-quality code, which was done, say, 8 years ago.  This can be an unpleasant discovery for the team: they seem to be writing code as always, and the quality situation is getting worse. <br><br>  It is necessary to master new methodologies and tools, otherwise, with the growth of the project, the old technologies will not be enough.  And one of the extremely useful techniques that should be used is the static code analysis that we reviewed. <br><br>  If the reader was not yet familiar with the methodology of static code analysis, I hope I managed to interest him.  For a more detailed acquaintance with her, I offer several links: <br><br><ol><li>  John Carmack.  <a href="https://www.viva64.com/ru/a/0087/">Static code analysis</a> . </li><li>  Wikipedia.  <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2582%25D0%25B0%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25B0%25D0%25BD%25D0%25B0%25D0%25BB%25D0%25B8%25D0%25B7_%25D0%25BA%25D0%25BE%25D0%25B4%25D0%25B0">Static code analysis</a> . </li><li>  Wikipedia.  <a href="https://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis">List of tools for static code analysis</a> . </li><li>  Al Bessey, Ken Block, Ben Chelf, Andy Chou, Bryan Fulton, Seth Hallem, Charles Henri-Gros, Asya Kamsky, Scott McPeak, Dawson Engler.  <a href="http://cacm.acm.org/magazines/2010/2/69354-a-few-billion-lines-of-code-later/fulltext">A Few Billion Lines Of Code Of Conduction Of The Real World</a> . </li><li>  Catherine Milovidova.  <a href="https://www.viva64.com/ru/b/0501/">A selection of videos about static code analysis</a> . </li><li>  <a href="https://www.viva64.com/ru/b/">Blog</a> of the PVS-Studio team. </li></ol><br>  Now is the time to move from theory to practice and see how static analysis helps a project like the Unreal Engine. <br><br><h2>  Unreal engine </h2><br>  Our team again had the honor of working with the Unreal Engine code! <br><br>  Although we already <a href="https://www.unrealengine.com/blog/how-pvs-studio-team-improved-unreal-engines-code">did this</a> two years ago, but in the intervening time, we have recruited more work on editing and improving the code.  It is always useful and interesting to look at the code base of such a project after a two-year break.  There are several reasons for this. <br><br>  First of all, we are interested to look at the false alarms of the analyzer.  Something can be corrected in our tool, and this will reduce the number of unnecessary messages.  The fight against false positives is a constant task for developers of any code analyzers.  Those who are interested in this topic, I propose to read the article " <a href="https://www.viva64.com/ru/b/0488/">How and why static analyzers are struggling with false positives</a> ." <br><br>  For two years, the Unreal Engine code base has changed quite a lot.  Some fragments disappeared, some were added.  Sometimes even whole folders.  Therefore, not all parts of the code received enough attention, which means that there is also work for PVS-Studio there. <br><br>  I would like to praise Epic Games for the fact that it pays great attention to the quality of the code and uses such tools as PVS-Studio.  The reader, of course, can smile: "Of course, your team should praise Epic Games, because it is your client."  Frankly, we have a motive to leave a positive review about the developers from Epic Games.  However, I praised the company sincerely.  The fact that static code analysis tools are used indicates the maturity of the project development cycle and the company's concern for the reliability and security of the code. <br><br>  Why am I sure that using PVS-Studio can significantly improve the quality of the code?  Because it is one of the most powerful static analyzers that easily detects errors even in such projects as: <br><br><ul><li>  GCC ( <a href="https://www.viva64.com/ru/b/0425/">errors</a> ) </li><li>  Clang ( <a href="https://www.viva64.com/ru/b/0108/">errors</a> , <a href="https://www.viva64.com/ru/b/0155/">errors</a> , <a href="https://www.viva64.com/ru/b/0446/">errors</a> ) </li><li>  Valgrind ( <a href="https://www.viva64.com/ru/b/0504/">errors</a> ) </li><li>  GDB ( <a href="https://www.viva64.com/ru/b/0430/">errors</a> ) </li><li>  FreeBSD ( <a href="https://www.viva64.com/ru/b/0377/">errors</a> , <a href="https://www.viva64.com/ru/b/0496/">errors</a> ) </li><li>  <a href="https://www.viva64.com/ru/inspections/">and so on</a> . </li></ul><br>  Using PVS-Studio raises the quality of the code by one extra step.  Epic Games takes care of everyone who uses the Unreal Engine in their projects.  Each corrected error will reduce someone's headache. <br><br><h2>  Interesting mistakes </h2><br>  I will not talk about all the errors found and fixed by us in the Unreal Engine, but will highlight only a few that, in my opinion, deserve attention.  Those interested can familiarize themselves with other errors by looking at the GitHub <a href="https://github.com/EpicGames/UnrealEngine/pull/3462">pull request</a> .  To access the source code and the specified pull request, you must have access to the Unreal Engine repository on GitHub.  To do this, you must have GitHub and EpicGames accounts, which must be linked to <a href="https://www.unrealengine.com/">unrealengine.com</a> .  After that, you need to accept an invitation to join the <a href="https://github.com/EpicGames/">Epic Games</a> community on GitHub.  <a href="https://www.unrealengine.com/ue4-on-github">Instructions</a> . <br><br>  The development of the PVS-Studio analyzer is connected not only with the advent of new diagnostics, but also with the improvement of existing ones.  For example, algorithms for calculating possible values ‚Äã‚Äãof variables are improved.  Due to this, about a year ago, the analyzer began to detect errors like this: <br><br><pre><code class="cpp hljs">uint8* Data = (uint8*)PointerVal; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Data != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> || DataLen == <span class="hljs-number"><span class="hljs-number">0</span></span>) { NUTDebug::LogHexDump(Data, DataLen); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Data == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>) { Ar.Logf(TEXT(<span class="hljs-string"><span class="hljs-string">"Invalid Data parameter."</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-comment"><span class="hljs-comment">// if (DataLen == 0) { Ar.Logf(TEXT("Invalid DataLen parameter.")); }</span></span></code> </pre> <br>  PVS-Studio analyzer warning: V547 Expression 'Data == nullptr' is always true.  unittestmanager.cpp 1924 <br><br>  If the condition <i>(Data! = Nullptr || DataLen == 0)</i> fails, then this means that the <i>Data</i> pointer is exactly equal to <i>nullptr</i> .  Therefore, further testing <i>(Data == nullptr)</i> does not make sense. <br><br>  <a href="">The correct</a> code is: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Data != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> &amp;&amp; DataLen &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  Diagnostics V547 exists in the analyzer since 2010.  However, the imperfection of the mechanism for calculating the values ‚Äã‚Äãof variables did not allow finding this error.  The analyzer saw the presence in the first condition of checking the value of the <i>DataLen</i> variable, and could not figure out what the values ‚Äã‚Äãof the variables are equal in different conditions.  For a person, the analysis of the above code does not constitute any problems, but from the point of view of writing algorithms to search for such errors, everything is not so simple. <br><br>  I demonstrated the improvement of the internal mechanisms of PVS-Studio, which allowed us to reveal a new error.  Figuratively speaking, these improvements were made "in depth", i.e.  the analyzer started working more accurately. <br><br>  We are also making improvements in breadth, supporting new constructions that appear in new versions of the C ++ language.  It is not enough to learn how to parse C ++ 11 code, C ++ 14 code, and so on.  It is equally important to improve the old diagnostics and implement new ones in order to detect errors in new language constructs.  As an example, let me give you the V714 diagnostics, which is looking for incorrect range-based cycles.  In the Unreal Engine, V714 diagnostics indicate the following cycle: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (TSharedPtr&lt;SWidget&gt; SlateWidget : SlateWidgets) { SlateWidget = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; }</code> </pre> <br>  PVS-Studio warning: V714 is not passed through the loop.  vreditorradialfloatingui.cpp 170 <br><br>  The programmer wanted to assign the value <i>nullptr to</i> all elements in the <i>SlateWidgets</i> container.  The error is that <i>SlateWidget</i> is an ordinary local variable, created again at each iteration of the loop.  Writing a value to this variable does not change the item in the container.  For the code to work <a href="">correctly</a> , you need to create a link: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (TSharedPtr&lt;SWidget&gt; &amp;SlateWidget : SlateWidgets) { SlateWidget = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; }</code> </pre> <br>  We, of course, gradually add to the analyzer and diagnostics that have little to do with the language.  For example, V767 diagnostics did not exist in 2015, when our team wrote a previous <a href="https://www.unrealengine.com/blog/how-pvs-studio-team-improved-unreal-engines-code">article</a> about testing the Unreal Engine project.  Diagnostics appeared in PVS-Studio version 6.07 (August 8, 2016).  Thanks to her appearance, such an error was revealed: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; SelectedObjects.Num(); ++i) { UObject* Obj = SelectedObjects[<span class="hljs-number"><span class="hljs-number">0</span></span>].Get(); EdObj = Cast&lt;UEditorSkeletonNotifyObj&gt;(Obj); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(EdObj) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre> <br>  PVS-Studio warning: V767 Suspicious access to element of SelectedObjects' array by a constant index inside a loop.  skeletonnotifydetails.cpp 38 <br><br>  The loop should search for an element that is of the type <i>UEditorSkeletonNotifyObj</i> .  Because of a random typo when choosing an element, the numeric literal <i>0 is</i> written instead of the variable <i>i</i> . <br><br>  <a href="">The correct</a> code is: <br><br><pre> <code class="cpp hljs">UObject* Obj = SelectedObjects[i].Get();</code> </pre> <br>  Let's look at another recently created diagnostics of the V763, which, like the V767, appeared in PVS-Studio version 6.07.  The error is interesting, but in order to show it, I will have to bring in the article a rather long body of the <i>RunTest</i> function: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> FCreateBPTemplateProjectAutomationTests::RunTest( <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FString&amp; Parameters) { TSharedPtr&lt;SNewProjectWizard&gt; NewProjectWizard; NewProjectWizard = SNew(SNewProjectWizard); TMap&lt;FName, TArray&lt;TSharedPtr&lt;FTemplateItem&gt;&gt; &gt;&amp; Templates = NewProjectWizard-&gt;FindTemplateProjects(); int32 OutMatchedProjectsDesk = <span class="hljs-number"><span class="hljs-number">0</span></span>; int32 OutCreatedProjectsDesk = <span class="hljs-number"><span class="hljs-number">0</span></span>; GameProjectAutomationUtils::CreateProjectSet(Templates, EHardwareClass::Desktop, EGraphicsPreset::Maximum, EContentSourceCategory::BlueprintFeature, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, OutMatchedProjectsDesk, OutCreatedProjectsDesk); int32 OutMatchedProjectsMob = <span class="hljs-number"><span class="hljs-number">0</span></span>; int32 OutCreatedProjectsMob = <span class="hljs-number"><span class="hljs-number">0</span></span>; GameProjectAutomationUtils::CreateProjectSet(Templates, EHardwareClass::Mobile, EGraphicsPreset::Maximum, EContentSourceCategory::BlueprintFeature, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, OutMatchedProjectsMob, OutCreatedProjectsMob); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( OutMatchedProjectsDesk == OutCreatedProjectsDesk ) &amp;&amp; ( OutMatchedProjectsMob == OutCreatedProjectsMob ); }</code> </pre> <br>  From the above code, the following is important to us: <br><br><ul><li>  Using the first call to the <i>CreateProjectSet</i> function, they attempt to initialize the <i>OutMatchedProjectsDesk</i> and <i>OutCreatedProjectsDesk variables</i> . </li><li>  Using the second call, the <i>CreateProjectSet</i> function attempts to initialize the <i>OutMatchedProjectsMob</i> and <i>OutCreatedProjectsMob variables</i> . </li></ul><br>  Then check that the values ‚Äã‚Äãof these variables satisfy the condition: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( OutMatchedProjectsDesk == OutCreatedProjectsDesk ) &amp;&amp; ( OutMatchedProjectsMob == OutCreatedProjectsMob );</code> </pre> <br>  Do not look for errors in the body of the considered function, they are not there.  I gave this code to show that the <i>CreateProjectSet</i> function is expected to write values ‚Äã‚Äãin two variables, passed to it as the last two actual arguments. <br><br>  The error traps us just in the <i>CreateProjectSet</i> function: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateProjectSet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(.... int32 OutCreatedProjects, int32 OutMatchedProjects)</span></span></span><span class="hljs-function"> </span></span>{ .... OutCreatedProjects = <span class="hljs-number"><span class="hljs-number">0</span></span>; OutMatchedProjects = <span class="hljs-number"><span class="hljs-number">0</span></span>; .... OutMatchedProjects++; .... OutCreatedProjects++; .... }</code> </pre> <br>  PVS-Studio tool will issue two warnings here: <br><br><ul><li>  V763 Parameter 'OutCreatedProjects' is always rewritten in function body before being used.  gameprojectautomationtests.cpp 88 </li><li>  V763 Parameter 'OutMatchedProjects' is always rewritten in function body before being used.  gameprojectautomationtests.cpp 89 </li></ul><br>  The analyzer is absolutely right when it warns that the values ‚Äã‚Äãof <i>OutCreatedProjects</i> and <i>OutMatchedProjects</i> are not used at all, but are immediately overwritten with the value <i>0</i> . <br><br>  The error is simple: forgot to make variable references.  <a href="">The correct</a> code is: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateProjectSet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(.... int32 &amp;OutCreatedProjects, int32 &amp;OutMatchedProjects)</span></span></span></span></code> </pre> <br>  Above, I cited errors that require at least some care for their detection.  But much more quite simple mistakes.  For example, the <i>break</i> statements are missing: <br><br><pre> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> EWidgetBlendMode::Opaque: ActualBackgroundColor.A = <span class="hljs-number"><span class="hljs-number">1.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> EWidgetBlendMode::Masked: ActualBackgroundColor.A = <span class="hljs-number"><span class="hljs-number">0.0f</span></span>; }</code> </pre> <br>  Or incorrect comparison of several variables for equality: <br><br><pre> <code class="cpp hljs">checkf(GPixelFormats[PixelFormat].BlockSizeX == GPixelFormats[PixelFormat].BlockSizeY == GPixelFormats[PixelFormat].BlockSizeZ == <span class="hljs-number"><span class="hljs-number">1</span></span>, TEXT(<span class="hljs-string"><span class="hljs-string">"Tried to use compressed format?"</span></span>));</code> </pre> <br>  If someone is new to C ++ and did not understand that this comparison is wrong, I suggest looking into the description of the <a href="https://www.viva64.com/ru/w/V709/">V709</a> diagnostic. <br><br>  Most of such errors are among the detected by PVS-Studio.  But since they look so simple, why go unnoticed? <br><br>  These errors are simple when they are highlighted in the article for the reader.  In the code of real applications it is extremely difficult to notice them.  Even with code reviews, a glance can slide along the block. <br><br><pre> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> EWidgetBlendMode::Opaque: ActualBackgroundColor.A = <span class="hljs-number"><span class="hljs-number">1.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> EWidgetBlendMode::Masked: ActualBackgroundColor.A = <span class="hljs-number"><span class="hljs-number">0.0f</span></span>; }</code> </pre> <br>  and ignore the mistakes in it.  The code seems so simple that the programmer does not even read into it, considering it to be absolutely correct. <br><br>  Let us now discuss the question a bit: is it possible to somehow reduce the number of such errors? <br><br><h2>  Recommendation </h2><br>  The errors described in the article were found using <a href="https://www.viva64.com/ru/pvs-studio/">PVS-Studio</a> and, most likely, the reader expects me to recommend using static code analysis tools.  Yes, I recommend integrating the PVS-Studio static code analyzer into the development process.  There is no need to deny yourself the opportunity to find a number of errors immediately after writing the code. <br><br>  However, in this section I would like to discuss a very important point, which, as a rule, is not mentioned in the articles on the quality of the code. <br><br>  <b>It is impossible to achieve a high quality project, as long as the team of programmers does not recognize for itself that it makes mistakes, including simple ones.</b> <br><br>  This phrase sounds trite, but it is very important.  As long as the programmer does not realize that this statement does not apply to an abstract programmer, but to himself, no tool or methodology will benefit.  In other words, programmers are often too proud to admit that they need assistive tools and techniques for writing quality code. <br><br>  All programmers know that there are errors in the programs.  However, they believe that the rules, recommendations and tools do not exist for them, since they are professional developers and write good code. <br><br>  This is the problem of a person reassessing his level.  About her well written in the article " <a href="https://habrahabr.ru/post/98640/">Programmers 'above average'</a> " ( <a href="http://www.lessonsoffailure.com/developers/problem-above-average-programmers/">en</a> ).  I will quote the passage: <br><br>  <b><i>How do you rate your level as a programmer (below average, average, above average)?</i></b> <br><br>  <i>According to <a href="http://sivers.org/below-average"><i>psychological surveys among different groups</i></a> , about 90% of programmers answer "Above average".</i> <br><br>  <i>Obviously, this cannot be true.</i>  <i>In a group of 100 people, 50 will always be higher and 50 - below the average.</i>  <i>This effect is known as the <a href="http://en.wikipedia.org/wiki/Illusory_superiority"><i>illusion of superiority</i></a> .</i>  <i>It is described in many areas, but even if you have heard about it, you still probably answer "above average".</i> <br><br>  This is a problem that prevents programmers from mastering new technologies and methodologies.  And my main recommendation is to try to rethink my attitude towards my own work and the work of the team as a whole.  The position ‚ÄúI / we are writing an excellent code‚Äù is counterproductive.  People can make mistakes, and so can programmers. <br><br>  Having understood all this, you can take the biggest step in the direction of high-quality software. <br><br>  <i>Note.</i>  <i>Project managers, I additionally suggest to look at <a href="https://www.viva64.com/ru/b/0498/"><i>this article</i></a> .</i> <br><br>  I wanted to warn against a single error of reasoning.  Static and dynamic analyzers, in general, find fairly simple errors and typos.  Yes, they will not find a high-level error in the algorithm, since artificial intelligence has not yet been invented.  However, a simple mistake can cause great harm and take a lot of time / effort / money.  More: " <a href="https://www.viva64.com/ru/b/0499/">A simple error in coding does not mean a non-terrible error</a> ." <br><br>  And again: do not look for a silver bullet.  Use a combination of different elements, such as: <br><br><ul><li>  Out of the head "our team is above average"; </li><li>  The coding standard that <b>all</b> developers in the team adhere to; </li><li>  Code reviews (at least for the most important sites and sites written by new employees); </li><li>  Static code analysis; </li><li>  Dynamic code analysis; </li><li>  Regression testing, smoke testing; </li><li>  Using unit tests, TDD; </li><li>  and so on. </li></ul><br>  I do not urge to start using all the above at once.  In different projects, something will be more useful, something less.  The main thing is not to hope for one thing, but to use a reasonable combination of techniques.  Only this will give an increase in the quality and reliability of the code. <br><br><h2>  Conclusion </h2><br>  The Unreal Engine developers take care of the quality of their code, and the PVS-Studio team, as far as they can, helps them with this. <br><br>  The PVS-Studio team is ready to work with the code and your projects.  In addition to selling the PVS-Studio analyzer and its maintenance, we <a href="https://www.viva64.com/ru/b/0500/">conduct code audits, code migration, etc.</a> <br><br>  I wish everyone as few bugs as possible in the programs. </div><p>Source: <a href="https://habr.com/ru/post/331724/">https://habr.com/ru/post/331724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331712/index.html">Evolution after evolution</a></li>
<li><a href="../331714/index.html">Translation of the Appium Essentials book. Chapter 3</a></li>
<li><a href="../331718/index.html">How to earn $ 80,000 on the App Store</a></li>
<li><a href="../331720/index.html">Tuning a Linux network stack for the lazy</a></li>
<li><a href="../331722/index.html">Training at PG Day'17 Russia</a></li>
<li><a href="../331726/index.html">Security issues and major achievements of AI</a></li>
<li><a href="../331728/index.html">Apache Spark: from open source to industry</a></li>
<li><a href="../331730/index.html">Intel Vpro or IP-KVM for desktops</a></li>
<li><a href="../331732/index.html">Signs of distressed design</a></li>
<li><a href="../331734/index.html">The book "Command shell scripts. Linux, OS X and Unix. 2nd edition ¬ª</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>