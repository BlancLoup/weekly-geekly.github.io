<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Development of LVDS scaler with two DisplayPort interfaces</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, Habr! 

 Description of the project of a scaler board developed on a Realtek chip - RTD2662 for a dual-channel matrix. To whom the topic is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Development of LVDS scaler with two DisplayPort interfaces</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/et/y-/ts/ety-tsmwzffna3ek4xrmvt6flpi.jpeg"><br><br>  Good day, Habr! <br><br>  Description of the project of a scaler board developed on a Realtek chip - RTD2662 for a dual-channel matrix.  To whom the topic is interesting, welcome under cat. <br><a name="habracut"></a><br>  I have always been attracted to the subject of displaying images on matrices.  Earlier, I developed a scaler board on a TSUMV59 chip (compatible with TSUMV29), a very interesting copy from MStar.  I think that I will write a separate article on this topic.  It would seem that everything is good in this chip, but something was missing, namely, the ability to write your own software for displaying the on-screen menu and processing GPIO.  All firmware is distributed in binary form and flashed via USB, but the source code could not be found (if someone knows / heard something, please write, since the topic is very interesting).  Until a certain time, this was enough for some of its needs.  There were moments when it was not possible to pick up the firmware for a particular matrix, for example with a non-standard aspect ratio, but this is all the little things until there was an order to develop the device, which had to have a strictly defined menu, logo, and device operation logic whole  Then we began to think how to be and in which direction to go.  The main problem was the lack of time, it was necessary in the shortest time to get the first batch of devices - 100 pcs.  The second is the presence of two DisplayPort interfaces on board.  The third is a small number of devices, which does not allow working / receiving documentation and samples from chip manufacturers / distributors. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I will list the main software / hardware issues that needed to be supported: <br><br>  - DisplayPort - 2 pcs; <br>  - Ethernet 10/100 - 1 pc; <br>  - Dual-channel LVDS for 32 ‚Äùmatrix - 1 pc; <br>  - Support for capacitive keyboard of 4 buttons - 1 pc; <br>  - Temperature sensor on the board - 1 pc; <br>  - WEB-interface; <br>  - OS Linux; <br>  - External power 24V. <br><br>  Now a little about everything and in order. <br><br><h2>  Displayport </h2><br>  Everything seemed relatively simple here, you need to choose a chip with HDMI input, set the switch and the converters from DisplayPort to HDMI.  The same chip must have a dual-channel LVDS output to the matrix and support FullHD.  Also, it is desirable that he had on board RMII (Ethernet) and the ability to draw a menu on top of the image.  And then the problems started.  Nothing like that, so you can quickly buy, mamaketirovat and run the party, could not be found. <br><br>  As a hobby, I repair equipment and it‚Äôs not about income, but about acquired skills that are very useful in developing my projects and drawing ideas and technologies.  Who dismantled the original technique of Sony and Panasonic, he will understand.  I am particularly attracted to audio / video / car devices.  The quality of polygon laying (even on the upper layers), analog lands and power, the relative position of feeders on the board, tracing RAM, HF ... dizzy from how beautifully and thoughtfully everything is done (of course, this is not always the case). <br><br>  Okay, what am I talking about?  So, if you remember what is usually put on budget televisions, the first thing that came to mind is TSUMV29 / TSUMV59, but as we remember, they don‚Äôt suit us.  What else do TVs and monitors do, but what can you buy by the piece?  A colleague suggested Realtek, which even seems to have the source code for it, which will greatly simplify the task.  It turned out that the source code is really for Keil, for the RTD2662 chip.  The chip is not the newest, but it has two HDMI inputs and FullHD support. <br><br><img src="https://habrastorage.org/webt/1j/sb/ii/1jsbiiulx1uflgj4mserw8zrels.jpeg"><br>  <i>Fig.1.</i>  <i>RTD2662</i> <br><br>  Wiring diagram as in all chassis for TV.  The chip is powered by two voltages - 3.3V and 1.8V.  It was not possible to find a full-fledged datasheet, and it was not necessary.  It was necessary to add only converters from DisplayPort.  After a brief search, a Texas Instruments converter - SN75DP139 was chosen.  I recommend in development, a good chip.  The chips are located on the bottom of the board (I had to do so in order to avoid cross lines of data, I will probably try to repartition on one side). <br><br><img src="https://habrastorage.org/webt/n-/zm/s5/n-zms5emqefe2hqb8bcw3lwxodq.png"><br>  <i>Fig.2.</i>  <i>SN75DP139 power circuit</i> <br><br>  The inclusion scheme turned out like this.  For the first time I contacted DisplayPort interface and for me it was a kind of revelation that the input and output of this interface have different pinouts, that is, it is one on the PC connector, another on the monitor.  Although some kind of logic in this is. <br>  Realtek firmware is stored in a separate SPIFlash. <br><br><h2>  Ethernet 10/100 </h2><br>  Ethernet is needed for several things: device monitoring, configuration and updating;  therefore, 10/100 physics is enough.  I installed LAN8742AI from Microchip, used it for the first time, and chose it, since the customer needed a certain ‚ÄúWake on LAN‚Äù function, before that there was no such need.  In a nutshell, WoL support allows you to wake your device over an Ethernet network. <br><br><img src="https://habrastorage.org/webt/ry/x6/qp/ryx6qpawkmsu7e1xx2isdk2r22e.jpeg"><br>  <i>Fig.3.</i>  <i>Ethernet 10/100</i> <br><br>  Physics requires almost no binding and is easy to trace.  It works stably, there was not a single fall off of the network. <br><br><h2>  Lvds </h2><br>  Two channels are needed to connect the matrix AUO 32 ".  Connector and pinout used standard.  The power supply is 12V, made on DC / DC TPS54560DDAR - this is a great 5A feeder from TI.  Illumination of the matrix 24V, took from the input voltage.  The matrix has a built-in backlight driver with the ability to adjust on and off.  The board is made on 4 layers, so there were no problems with tracing LVSD, HDMI and DisplayPort. <br><br><img src="https://habrastorage.org/webt/f9/_g/yp/f9_gypswe0nt1krr_orqcx-pkxu.png"><br>  <i>Fig.4.</i>  <i>LVDS trace</i> <br><br>  As you can see here all directly, a small discrepancy in length does not affect the image quality at all. <br><br><h2>  KEY </h2><br>  The buttons are implemented on the SX8634 chip from Semtech Corporation - this chip is somewhat ambiguous in its work.  Programmers had to saw through the entire driver to get the expected result.  It turned out something like this: there are 4 buttons for navigating through the menu, they are sensory (capacitive through glass) with RGB illumination from the inside through the holes in the board.  Only the lower button is constantly lit, it also goes into sleep mode and back (with a change in luminescence).  When you put your hand on 5cm, the rest of the buttons light up and pops up the menu opposite them.  We remove the hand, after 3c the menu disappears, the buttons go out.  Looks interesting. <br><br><img src="https://habrastorage.org/webt/sn/v2/ob/snv2obul-ajfho1ynqmhwym0u5k.jpeg"><br>  <i>Fig.5.</i>  <i>Touch Button Board</i> <br><br>  The top of the board (top) is adjacent to the glass, so there are no components on it, they are all located on the bottom.  The difficulty in setting and calibration was due to the width of the board, it is only 12mm.  If it is boring for someone to live, they can use this chip in their projects. <br><br><h2>  TEMP </h2><br>  The temperature inside the case is measured using the LM75AD temperature sensor from NXP over the I2C bus.  It was delivered as it is easy to get it and it is stored in large volumes in warehouses. <br><br><h2>  WEB </h2><br>  The web interface and the project itself are implemented on the basis of a young engine born by an independent team of 11-parts ‚Äî our partner in software development for Linux-based systems. <br>  The platform has many blocks, provided with technical support and warranty with the possibility of improvements and updates. <br><br>  If it is even simpler, this is a framework project with advanced functionality that is constantly improving and enhancing functionality.  From the main blocks, you can note the network manager, dynamic WEB interface, update and project collector.  Based on the engine, you can implement various devices ranging from an mp3 player to a multi-port 10Gbit SIP server.  and this is exactly what we needed in this project. <br><br>  From the web interface you can not only control the panel parameters, but also change settings, for example, brightness, contrast, image clarity, track which PC is connected to which port and which of them is currently active, switch between them. <br><br>  Also in this project, support for SNMP 1,2 and 3 versions is implemented with support for SET, GET commands and sending traps either by interval or by event.  Those.  Information about any parameter, for example, brightness / contrast can be transferred to the server via the SNMP protocol, by pressing the parameter change button or, for example, every 10 seconds.  You can turn off the display or change the parameter remotely using the SNMP SET command.  SNMP is also included in the engine. <br><br><h2>  iMX6ULL </h2><br>  Since the Realtek chip does not have Ethernet onboard, this project uses the NXP iMX6ULL processor, which runs the Linux OS and runs the main logic of the work.  iMX and Realtek are interconnected via UART and exchange commands with each other.  For quick events there are several GPIO. <br><br><img src="https://habrastorage.org/webt/xp/mo/jf/xpmojf9gpi6fjizzmdwrfcxjrag.jpeg"><br>  <i>Fig.6.</i>  <i>iMX6ULL</i> <br><br>  All information is stored in NAND, u-boot is loaded from SPIFlash.  One chip of RAM and nothing more.  The SD card is derived for software updates (this is in addition to the ability to do this from the web). <br><br><h2>  Power </h2><br>  The secondary power supply of 5V is implemented on the same DC / DC as for the matrix power supply - TPS54560DDAR.  Power supply 1.8V and 1.35V for AP3418 from Diodes, and 3.3V for ST1S10PHR from ST. <br><br><img src="https://habrastorage.org/webt/gn/av/lp/gnavlpdfwa-5o9aqewktkf1xlnm.jpeg"><br>  <i>Fig.7.</i>  <i>DC / DC</i> <br><br>  The DC / DC microcircuits were chosen with a large margin, since the matrix had large peak currents in terms of power and illumination, and since there was only one iteration, I really didn‚Äôt want to risk. <br>  All the power supplies are separated by polygons in a separate layer, with the exception of the matrix supply, since I really did not want to cut the main power supplies with this conductor.  Tracing screens is useless, except that someone will be interested in an interface.  For food and land, I also want to give a separate article, for example, in this project a total of 27 polygons, in my new project on iMX7 there will be about 100, and in the framework of this article it simply does not fit. <br><br>  If a little more deep into the logic of the board.  iMX works with Ethernet and front panel buttons.  It is associated with Realtek, which takes the image from the active DisplayPorta and outputs it to the LVDS matrix.  Commands from the buttons, SNMP and web fly to Realtek, which in turn reacts to them and changes the display settings, displays the menu, etc. <br><br>  The result was a rather interesting project in a short time.  Probably, it contains too many modules, but at the time of development, in my opinion, this was the best solution in accordance with the timing, cost and risk. <br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/418459/">https://habr.com/ru/post/418459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../418447/index.html">Why Moscow Python Conf is now ++</a></li>
<li><a href="../418449/index.html">Binary modules for Python</a></li>
<li><a href="../418451/index.html">3D printing lessons. Effective support and changing the height of the layers in practice from the company 3Dtool</a></li>
<li><a href="../418453/index.html">GRAVITY observations further confirm the general theory of relativity.</a></li>
<li><a href="../418455/index.html">Open webinar "Specialist" at the helm ": first experience and mistakes"</a></li>
<li><a href="../418463/index.html">Working with data in Angular</a></li>
<li><a href="../418465/index.html">A new version of Specter attack was discovered with the ability to remotely receive data over the network.</a></li>
<li><a href="../418467/index.html">Marking Arts Developer Rankings</a></li>
<li><a href="../418469/index.html">When not to use STL algorithms. Example with sets</a></li>
<li><a href="../418475/index.html">Windows 10 uses machine learning technology to determine the possibility of an update.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>