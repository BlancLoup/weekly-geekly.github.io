<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Neoquest 2018: ‚ÄúAirship? Yeah! ‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="CTF NeoQuest 2018 has recently ended. Under the cat analysis of the second part of the task about the airship, ZeroNet , the shift register with feedb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Neoquest 2018: ‚ÄúAirship? Yeah! ‚Äù</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ma/vp/yt/mavpyt_5jcyelrvcrhoxyvwgdlm.jpeg" align="left" height="150">  CTF <a href="https://habrahabr.ru/company/neobit/blog/348306/">NeoQuest 2018</a> has recently ended.  Under the cat analysis of the second part of the task about the airship, <a href="https://ru.wikipedia.org/wiki/ZeroNet">ZeroNet</a> , the shift register with feedback and the system of linear equations. <br><a name="habracut"></a><br>  The task was given the address of the <a href="http://127.0.0.1:43110/1NeoChatZK4DxZJdg5WwocwxcUppA1eJgL">site</a> on the ZeroNet network, where the chat is deployed.  Since  in ZeroNet, the contents of the site are downloaded to the local computer, then having stuck the folder with the site, I found the first key, as well as encrypted_storage.json: <br><br><pre><code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"encrypted_storage"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"secret_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"SiteName"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"secret_value"</span></span>: <span class="hljs-string"><span class="hljs-string">"84a303b9f188b0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"date_added"</span></span>: <span class="hljs-number"><span class="hljs-number">1519915207692</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"secret_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"SiteAddress"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"secret_value"</span></span>: <span class="hljs-string"><span class="hljs-string">"e68cd4a46ee074121a040a6188d3f6d495f24480fc0e08b0d45d8fba875d9fd38e88"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"date_added"</span></span>: <span class="hljs-number"><span class="hljs-number">1519915235730</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"secret_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"AdminUsername"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"secret_value"</span></span>: <span class="hljs-string"><span class="hljs-string">"0d9ef480aa"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"date_added"</span></span>: <span class="hljs-number"><span class="hljs-number">1519915256867</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"secret_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"AdminCert"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"secret_value"</span></span>: <span class="hljs-string"><span class="hljs-string">"4b95e6dfd893b37293fe041188cd6d8da5af08d4fb80b0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"date_added"</span></span>: <span class="hljs-number"><span class="hljs-number">1519915282130</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"secret_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"SecondKey"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"secret_value"</span></span>: <span class="hljs-string"><span class="hljs-string">"c73ab54b91c6099b0f0081ea9124e2f50e846f6fc674046b3b41a86048ae3e27b04d354c9b9786a158f9722821005362bcfae8d6c0a261addb0b2ef8e16fbdfc851b82e0829d"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"date_added"</span></span>: <span class="hljs-number"><span class="hljs-number">1519915320471</span></span> } ] }</code> </pre> <br>  Apparently, we need to decrypt ‚Äúsecret_value‚Äù.  You may notice that the length of the ciphertext for <i>AdminUsername is</i> 5 bytes.  Perhaps clear text - ‚Äúadmin‚Äù?  If it is a gamma cipher, then we can get 5 bytes of gamma and check whether they are suitable for other "secrets".  Check on the first 5 bytes of <i>SiteName</i> , we get b "\ xe8Y \ x9aP5".  The result is not very ... <br><br>  Another site has this page: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/1e/ro/x9/1erox9qz7auaza_cmasls6jjntu.jpeg"><br><br>  Stumbling, you can see that the length of the ciphertext is equal to the length of the plaintext, and encryption and decryption is the same operation.  Very similar to gamma, maybe there is the same algorithm that is encrypted second secret? <br><br>  The algorithm itself is in the <i>js / lfsr.js file</i> .  Gamma in it is generated by function <br><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">genKeyStream</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key, iv, length</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res = [] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> state_len = bitLength(key) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> state = iv.mod(bigInt(<span class="hljs-number"><span class="hljs-number">1</span></span>).shiftLeft(state_len)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> next_byte = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; j++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> next_bit = bitCount(state.and(key)) % <span class="hljs-number"><span class="hljs-number">2</span></span> next_byte = (next_byte &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) | (next_bit &lt;&lt; <span class="hljs-number"><span class="hljs-number">7</span></span>) state = state.shiftRight(<span class="hljs-number"><span class="hljs-number">1</span></span>).or(bigInt(next_bit).shiftLeft(state_len - <span class="hljs-number"><span class="hljs-number">1</span></span>)) } res.push(next_byte) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res.reverse() }</code> </pre><br>  This is a shift register with feedback.  The register length is equal to the key length; the location of the taps is specified by the key.  <i>IV</i> is cut to the length of the key and is used as the initial fill.  Only in contrast to the <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25B3%25D0%25B8%25D1%2581%25D1%2582%25D1%2580_%25D1%2581%25D0%25B4%25D0%25B2%25D0%25B8%25D0%25B3%25D0%25B0_%25D1%2581_%25D0%25BB%25D0%25B8%25D0%25BD%25D0%25B5%25D0%25B9%25D0%25BD%25D0%25BE%25D0%25B9_%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B9_%25D1%2581%25D0%25B2%25D1%258F%25D0%25B7%25D1%258C%25D1%258E">usual shift register with feedback,</a> here the gamma is taken not from the output of the register, but from its input. <br><br>  You can also see that the first bytes of the gamma will encrypt the last bytes of the OT ... We return to <i>encrypted_storage.json</i> , take the gamma from ‚Äúadmin‚Äù and shuffle the last 5 bytes of <i>SiteName to it</i> : ‚ÄúoChat‚Äù is a completely different result!  We decipher the end of the <i>SiteAddress</i> line - we see that the line contains ‚Äú1NeoChatZK4DxZJdg5WwocwxcUppA1eJgL‚Äù - the site address.  The length of this string is 34 bytes, i.e.  we have the first 34 bytes (272 bits) gamma. <br>  In principle, encryption using shift registers is no longer considered persistent, but still having only a small piece of the gamut won't easily break it ... But this cipher has a slight difference from the ‚Äúclassics‚Äù - the gamma is taken from the register input.  After thinking about it, it can be understood that after L = len (key) iterations IV will be completely ‚Äúforced out‚Äù of the shift register, and the entire internal state (register filling) will be equal to the last L bits of the gamma.  Then for all <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi><mtext>&amp;#xA0;</mtext><mi>g</mi><mi>e</mi><mi>q</mi><mi>L</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.235ex" height="2.419ex" viewBox="0 -780.1 2684.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-69" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-67" x="595" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-65" x="1076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-71" x="1542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4C" x="2003" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mtext>&nbsp;</mtext><mi>g</mi><mi>e</mi><mi>q</mi><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> i \ geq L </script>  You can write the following equation: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>&amp;#x2217;</mo><msub><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub><mo>&amp;#x2217;</mo><msub><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>L</mi><mo>&amp;#x2212;</mo><mn>2</mn></mrow></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mi>L</mi></mrow></msub><mo>&amp;#x2217;</mo><msub><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn></mrow></msub><mo>=</mo><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.223ex" height="2.539ex" viewBox="0 -780.1 21623.7 1093.4" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-47" x="0" y="0"></use><g transform="translate(786,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2212" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-31" x="1124" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2217" x="2257" y="0"></use><g transform="translate(2980,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4B" x="0" y="0"></use><g transform="translate(849,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2212" x="681" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-31" x="1460" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2B" x="5538" y="0"></use><g transform="translate(6538,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-47" x="0" y="0"></use><g transform="translate(786,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2212" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-32" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2217" x="8796" y="0"></use><g transform="translate(9519,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4B" x="0" y="0"></use><g transform="translate(849,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2212" x="681" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-32" x="1460" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2B" x="11854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2E" x="12633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2E" x="13078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2E" x="13523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2B" x="13968" y="0"></use><g transform="translate(14747,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-47" x="0" y="0"></use><g transform="translate(786,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2212" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4C" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2217" x="17132" y="0"></use><g transform="translate(17855,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-30" x="1201" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-3D" x="19436" y="0"></use><g transform="translate(20492,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-69" x="1112" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo>‚àó</mo><msub><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>‚àí</mo><mn>2</mn></mrow></msub><mo>‚àó</mo><msub><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mi>L</mi><mo>‚àí</mo><mn>2</mn></mrow></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>G</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>‚àí</mo><mi>L</mi></mrow></msub><mo>‚àó</mo><msub><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo>=</mo><msub><mi>G</mi><mi>i</mi></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> G_ {i-1} * K_ {L-1} + G_ {i-2} * K_ {L-2} + ... + G_ {i-L} * K_ {0} = G_i </script></p>  Where: <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.626ex" height="2.419ex" viewBox="0 -780.1 1130.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-69" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-3"> G_i </script>  - i-th bit of gamma <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>K</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.773ex" height="2.419ex" viewBox="0 -780.1 1193.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-69" x="1201" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-4"> K_i </script>  - i-th key bit <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> L </script>  - key length <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x2217;</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.335ex" viewBox="0 -520.7 500.5 574.6" role="img" focusable="false" style="vertical-align: 0.079ex; margin-bottom: -0.204ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2217" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>‚àó</mo></math></span></span><script type="math/tex" id="MathJax-Element-6"> * </script>  - logical AND <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>+</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.808ex" height="1.937ex" viewBox="0 -676.4 778.5 834" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> + </script>  - exclusive OR (XOR) <br>  Solving a system of L such equations, one can find the key.  And knowing the key and the internal state (the last L bits of the gamma), you can generate as many gammas as you need!  In order for a system to have at most one solution, it must have at least L linearly independent equations.  Those.  on the right side will stand <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.626ex" height="2.419ex" viewBox="0 -780.1 1130.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-69" x="1112" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-8"> G_i </script>  for <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>[</mo><mi>L</mi><mo>,</mo><mn>2</mn><mi>L</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.239ex" height="2.66ex" viewBox="0 -832 6130.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-69" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-69" x="595" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-6E" x="941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-5B" x="1541" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4C" x="1820" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2C" x="2501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-32" x="2946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4C" x="3447" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2212" x="4350" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-31" x="5351" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-5D" x="5852" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mo stretchy="false">[</mo><mi>L</mi><mo>,</mo><mn>2</mn><mi>L</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-9"> i \ in [L, 2L - 1] </script>  .  So we can solve the problem if the key length is not more than <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>272</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>$</mo></mrow><mn>13</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.398ex" height="2.66ex" viewBox="0 -832 5338.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-37" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-32" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-2F" x="1501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-32" x="2002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-3D" x="2780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-24" x="3836" y="0"></use><g transform="translate(4337,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-33" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>272</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>$</mo></mrow><mn>13</mn></math></span></span><script type="math/tex" id="MathJax-Element-10"> 272/2 = $ 13</script>  bit. <br><br>  To solve it, I had to write a function that solves the system according to the Gauss method, since  all the ready-made functions found solved everything in the field of real or complex numbers, and not on the set (0, 1) with the AND and XOR operations.  Then I went through different values ‚Äã‚Äãof L, if the system turned out to be joint, I checked whether the next bits of the gamma generated by such a key would match those known to me.  Match for <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo>=</mo><mn>128</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.169ex" height="2.057ex" viewBox="0 -780.1 3517.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-3D" x="959" y="0"></use><g transform="translate(2015,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/351674/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiQ3c_mDFn1NjIuHwQ2pwpU9xfC-A#MJMAIN-38" x="1001" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>=</mo><mn>128</mn></math></span></span><script type="math/tex" id="MathJax-Element-11"> L = 128 </script>  .  A few minutes later the key was counted! <br><br>  In fact, it was possible not to go through different Ls, but to immediately write down a system of 134 equations with 134 unknowns, just for the key, the first 6 bits would be zero. <br><br><div class="spoiler">  <b class="spoiler_title">Decision code</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> hashlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sha1 N_ct = <span class="hljs-number"><span class="hljs-number">70</span></span> * <span class="hljs-number"><span class="hljs-number">8</span></span> N = <span class="hljs-number"><span class="hljs-number">0x22</span></span> * <span class="hljs-number"><span class="hljs-number">8</span></span> O_hex = <span class="hljs-string"><span class="hljs-string">"D7 C2 B1 CB 2D 88 15 66 40 4F 3E 25 F0 89 BC B0 F2 C7 13 F7 93 6D 7F C8 B7 08 FF CA C6 6C FA 99 E9 C4"</span></span>.replace(<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) O_int = int(O_hex, <span class="hljs-number"><span class="hljs-number">16</span></span>) O = [int(c) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> bin(O_int)[<span class="hljs-number"><span class="hljs-number">2</span></span>:]] O.reverse() O_full = O_int ct = int(<span class="hljs-string"><span class="hljs-string">"C7 3A B5 4B 91 C6 09 9B 0F 00 81 EA 91 24 E2 F5 0E 84 6F 6F C6 74 04 6B 3B 41 A8 60 48 AE 3E 27 B0 4D 35 4C 9B 97 86 A1 58 F9 72 28 21 00 53 62 BC FA E8 D6 C0 A2 61 AD DB 0B 2E F8 E1 6F BD FC 85 1B 82 E0 82 9D"</span></span>.replace(<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">solve_linear_eq</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(A)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""A[l, l+1]"""</span></span> l = len(A) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> len(A) + <span class="hljs-number"><span class="hljs-number">1</span></span> == len(A[<span class="hljs-number"><span class="hljs-number">0</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(l): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(j, l): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> A[i][j] == <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> A[j], A[i] = A[i], A[j] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(l): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i != j <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> A[i][j] == <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(l + <span class="hljs-number"><span class="hljs-number">1</span></span>): A[i][k] ^= A[j][k] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(l): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(l): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i != j <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> A[i][j] == <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> i==j <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> A[i][j] == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [A[i][<span class="hljs-number"><span class="hljs-number">-1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(l)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">preapare_linear_eq</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(L)</span></span></span><span class="hljs-function">:</span></span> A = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(L, <span class="hljs-number"><span class="hljs-number">2</span></span>*L): A.append([]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, L): A[<span class="hljs-number"><span class="hljs-number">-1</span></span>].append(O[n-L+i]) A[<span class="hljs-number"><span class="hljs-number">-1</span></span>].append(O[n]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> A <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gamma</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(K)</span></span></span><span class="hljs-function">:</span></span> O_full = O.copy() L = len(K) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(N, N_ct): s = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, L): s ^= O_full[n - L + i] &amp; K[i] O_full.append(s) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> O_full <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_key</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(K)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(L, N): s = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, L): s ^= O[n - L + i] &amp; K[i] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s != O[n]: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> found = <span class="hljs-number"><span class="hljs-number">0</span></span> not_found = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> L <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">8</span></span>, N//<span class="hljs-number"><span class="hljs-number">2</span></span>): A = preapare_linear_eq(L) K = solve_linear_eq(A) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> K <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> check_key(K): found += <span class="hljs-number"><span class="hljs-number">1</span></span> print(L, K) O_full = gamma(K) O_full_int = <span class="hljs-number"><span class="hljs-number">0</span></span> O_full.reverse() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> O <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> O_full: O_full_int = (O_full_int &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) + O pt = O_full_int ^ ct pt = pt.to_bytes(<span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-string"><span class="hljs-string">"big"</span></span>) print(pt) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: not_found += <span class="hljs-number"><span class="hljs-number">1</span></span> print(sha1(pt).hexdigest())</code> </pre> </div></div></div><p>Source: <a href="https://habr.com/ru/post/351674/">https://habr.com/ru/post/351674/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351662/index.html">One day in the life of a hardened admin or a story about how to tame the storage system</a></li>
<li><a href="../351664/index.html">DNSCrypt 2.0 and ad blocking</a></li>
<li><a href="../351666/index.html">Cocos2d-x Design Patterns</a></li>
<li><a href="../351670/index.html">LG has announced the release of an open platform WebOS Open Source Edition</a></li>
<li><a href="../351672/index.html">About porting the MIPSfpga project</a></li>
<li><a href="../351676/index.html">How professional interest stole my weekend</a></li>
<li><a href="../351678/index.html">Angular application architecture. We use NgModules</a></li>
<li><a href="../351680/index.html">DEFCON conference 17. ‚ÄúStealing profits from spammers: how I stopped worrying about spam and loved it‚Äù. Grant jordan</a></li>
<li><a href="../351682/index.html">Graal: how to use the new JIT JIT compiler in real life</a></li>
<li><a href="../351684/index.html">In google with no work experience. Programmer from Silicon Valley about Russian diplomas, interviews and work in the US</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>