<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Exhaustive list of differences between VB.NET and C #. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="According to the TIOBE rating in 2018, VB.NET overtook C # in popularity. Coincidence or not, but in February Eric Lippert, one of the creators of C #...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Exhaustive list of differences between VB.NET and C #. Part 1</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/lv/zu/ex/lvzuexv-rlsyr8aeycle0f9r--4.png" alt="image"><br><br>  According <a href="https://www.tiobe.com/tiobe-index/">to the</a> TIOBE <a href="https://www.tiobe.com/tiobe-index/">rating</a> in 2018, VB.NET overtook C # in popularity.  Coincidence or not, but in February Eric Lippert, one of the creators of C #, <a href="https://ericlippert.com/2019/02/12/exhausting-vs-exhaustive">urged</a> readers to pay attention to the blog of his friend, a former colleague of the Roslyn compiler and, concurrently, an ardent fan of VB.NET, <a href="https://twitter.com/ThatVBGuy">Anthony Green</a> .  ‚ÄúSuch resources are in-depth details from experts who are not so easy to find while reading the documentation,‚Äù writes Eric.  We present to your attention the first part of the translation of the article by Anthony Green ‚ÄúAn exhaustive list of differences between VB.NET and C #‚Äù.  Perhaps it is in these differences lies the secret of the dynamics of the rating of these languages. <br><a name="habracut"></a><br>  For almost half my life, I witnessed and participated in countless discussions about how similar the two most popular .NET languages ‚Äã‚Äãare or differ.  First as an amateur, then as a professional and, finally, as a client advocate (customer advocate), a program manager and a language designer, I can say without exaggeration how many times I have heard or read something like: <br><blockquote>  <i>‚Äú... VB.NET is actually just a thin layer on top of IL, like C # ...‚Äù</i> </blockquote>  or <blockquote>  <i>"... VB.NET is actually just C # without semicolons ..."</i> </blockquote>  As if languages ‚Äã‚Äãwere an XML transformation or style sheet. <br><br>  And if a certain ardent visitor does not write this in the comments, then this is often implied in questions like: <i>‚ÄúHi, Anthony!</i>  <i>I ran into such a small difference in one place ‚Äî is it a bug?</i>  <i>How could these two otherwise identical languages, which should be identical for the sake of all the good and holy in this world, disperse in this one place?</i>  <i>Why do we need such injustice ?!</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ‚Äú <b>Break up,</b> ‚Äù as if they were the same until a mutation occurred, and <i>then</i> became separate species.  HA! <br><br>  But I understand that.  Before I joined Microsoft, I might also vaguely stick to this idea and use it as an argument to respond to opponents or to reassure someone.  I understand her charm.  It is easy to understand and very easy to repeat.  But working on Roslyn (essentially rewriting VB and C # completely from scratch) for 5 years, I realized how <b>uniquely false this idea is</b> .  I worked with a team of developers and testers to re-implement every inch of both languages, as well as their tools in a huge multi-project solution with millions of lines of code written in both languages.  And given the large number of developers switching back and forth between them, and the high level of compatibility with the results and experience of previous versions, as well as the need to reliably reproduce the enormous amount of API in the smallest details, I was forced to very closely become familiar with the differences.  In fact, sometimes it seemed to me that I learned something new about VB.NET (my favorite language) every day. <br><br>  And finally, I took the time to sit down and unload from the brain a particle of what I learned, using and creating VB.NET over the past 15 years, in the hope that I can at least save my time next time. <br><br>  Before turning to the list, I will set out the basic rules: <br><br><ul><li>  This list is not exhaustive in the usual sense.  He is an exhaustive force.  These are not all existing differences.  It's not even all the differences that I generally know.  These are just the differences that I can remember first, before I get too tired to continue;  until i'm running out of power.  If I or some of you meet or remember other differences, I‚Äôll be happy to update this list. </li><li>  I will start from the beginning of the VB 11 specification and move down using its content to remind myself of the differences that come to mind first on this topic. </li><li>  <b>This is NOT a list of functions in VB that are not in C #.</b>  So no "XML literals vs. pointers."  This is too trite, and there are already tons of such lists on the Internet (some of which were written by me, and perhaps in the future I will write more).  I will focus primarily on constructs that have an analogue in both languages, and where an ignorant observer may assume that these two things behave in the same way, but where there are small or large differences;  they may look the same, but work differently or ultimately generate different code. </li><li>  <b>This is NOT a list of syntactic differences between VB and C #</b> (of which there are countless).  I will mainly talk about semantic differences (what things mean), and not about syntax differences (how things are written).  So no ‚ÄúVB starts comments with ', and C # uses //‚Äù or ‚Äúin C # _ is a valid identifier, but not in VB‚Äù.  But I‚Äôll break this rule for a few occasions.  In the end, the first section of the specification is devoted to lexical rules. </li><li>  Quite often I will give examples, and sometimes I will offer justifications why the design could go one way or another.  Some design decisions were made before my eyes, but the vast majority preceded my time, and I can only guess why they were taken. </li><li>  Please leave a comment or tweet me ( <a href="https://twitter.com/ThatVBGuy">@ThatVBGuy</a> ) to let me know your favorite differences and / or those you would like to know more deeply about. </li></ul><br>  Deciding on expectations and without further delay ... <br><br><h2>  Content </h2><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><h4>  Syntax and preprocessing </h4><br><ul><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">1. Keywords and VB operators can use full-width characters.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">2. VB supports smart quotes</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">3. The preprocessing constants can be of any primitive type (including dates) and can contain any constant value.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">4. Arbitrary arithmetic operators can be used in preprocessing expressions.</a> </li></ul><br><h4>  Announcements, etc. </h4><br><ul><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">5. VB sometimes skips implements declarations in IL to prevent accidental implicit interface implementations named</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">6. VB by default hides the members of the base class by name (Shadows), not by name and signature (Overloads)</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">7. VB11 and below are more restrictive to Protected members in generics.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">8. The syntax "named argument (Named argument)" in attributes always initializes properties / fields</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">9. All top-level declarations (usually) are implicitly in the root namespace of the project.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">10. Modules are not generated as sealed abstract classes in IL, so they do not look exactly like static C # classes and vice versa.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">11. You do not need an explicit method for the entry point (Sub Main) in WinForms applications.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">12. If you call some obsolete VB runtime methods (for example, FileOpen), the calling method will be implicitly flagged with an attribute to disable inlayning for correctness reasons.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">13. If your type is marked with the DesignerGenerated attribute and does not contain any explicit constructor declarations, then the compiler-generated default will call InitializeComponent if it is defined for this type.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">14. The absence of the Partial modifier does NOT mean that the type is not partial.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">15. In classes, the default access level is Public for everything except fields, and in Public structures for fields too</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">16. VB initializes fields AFTER the call to the base constructor, while C # initializes them BEFORE the call to the base constructor</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">17. The implicitly declared auxiliary field (backing field) of VB events has a different name than in C #, and is available by name.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">18. The implicitly declared auxiliary field of VB auto-properties has the usual name and is accessible by that name.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">19. The implicitly declared auxiliary field of read-only auto-properties allows writing</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">20. Event attributes are sometimes applied to an auxiliary event field.</a> </li></ul><br><h4>  Instructions </h4><br><ul><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">21. The scope of a label is the body of the whole method containing it;</a>  <a href="https://habr.com/ru/company/jugru/blog/443684/">You can jump inside the blocks (not all)</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">22. The lifetime of the local variable &lt;&gt; scope</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">23. Variables are always initialized with the default value for the corresponding type.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">24. RaiseEvent does NOT throw an exception if the auxiliary field is null</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">25. Assignments are not always the same;</a>  <a href="https://habr.com/ru/company/jugru/blog/443684/">sometimes assigning a reference type performs a shallow clone</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">26. Select Case does not support fall-through;</a>  <a href="https://habr.com/ru/company/jugru/blog/443684/">no break required</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">27. Each Case block has its own scope</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">28, 29, 30. Select Case works with non-primitive types, can use arbitrary non-constant expressions in checks and uses the = operator by default</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">31. Variables declared inside loops retain their value in some way between iterations.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">32. The three For loop expressions are evaluated only once at the beginning of the loop.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/443684/">33. For Each loops in VB can use the GetEnumerator extension method</a> </li></ul></div></div><br><h2>  Syntax and preprocessing </h2><br><a name="section1"></a><h3>  1. Keywords and VB operators can use full-width characters. </h3><br>  In some languages ‚Äã‚Äã(I don‚Äôt know how many exactly, but at least in some forms of Chinese, Japanese and Korean) full-width characters are used.  In short, this means that when using a monospaced font (as most programmers do), the Chinese character will take up twice the horizontal space than the Latin characters that we used to see in the west.  For example: <br><br><img src="https://habrastorage.org/webt/wl/j8/0u/wlj80uri5nr810dqgpwymj5eru0.png"><br><br>  Here I have a declaration of a variable written in Japanese, and initialization with a string, also written in Japanese.  According to the Bing translator, the variable is called ‚Äúgreeting‚Äù, and the string says ‚ÄúHello World!‚Äù.  The name of a variable in Japanese is only 2 characters, but it occupies a space of 4 characters half-width, which my keyboard usually gives out, as the first comment shows.  There are full-width versions of numbers and all other printed ASCII characters that have the same width as the Japanese.  To demonstrate this, I wrote a second comment using full-width numbers "1" and "2".  These are not such "1" and "2", as in the first comment.  There are no spaces between the numbers.  You can also see that the size of the characters - not exactly 2 characters wide, there is a slight offset.  This is partly because this program mixes full-width and half-width characters in one line and in all three lines. <br><br>  Spaces are half width, alphanumeric characters are full width.  We are not programmers, if not obsessed with text alignment.  And it seems to me that if you are Chinese, Japanese or Korean (or someone else who uses full-sized characters for their language) and use identifiers or strings written in their own language, these minor alignment errors are infuriating. <br><br>  As far as I understand, depending on your Japanese keyboard, switching between hieroglyphs and Latin is easy, but it is preferable to use full-width Latin characters.  VB supports this in keywords, spaces, operators and even quotes.  So all this can be written like this: <br><br><img src="https://habrastorage.org/webt/me/mq/ph/memqph465sxyx_tvxov6fglrjfw.png"><br><br>  As you can see, in this version, keywords, spaces, comments, operators, even quotes use their full-size versions.  Order is brought into chaos. <br><br>  Yes.  The Japanese use VB.  In fact, despite the syntax that is similar to English (and maybe that is why), for the majority of VB users, whom I see on the forums, English is not the main language.  During my time at Microsoft, I met the Japanese VB MVP several times, at least one of them brought Japanese sweets all the time.  If you are a VB programmer from China, Japan or Korea (or from any other country that uses full-width characters), please write in the comments.  (In the comments the author wrote that the Japanese are trying to use ascii everywhere in the code - <i>Approx. Trans.</i> ) <br><br>  <i><b>Funny moment:</b> When I originally implemented interpolated strings in VB, I (to my disgrace) did not take into account the possibility of full-width curly braces at the placeholders.</i>  <i>Vladimir Reshetnikov ( <a href="https://twitter.com/vreshetnikov">@vreshetnikov</a> ) discovered and corrected this error, so the great tradition of VB tolerance to the width of characters remained in force.</i> <br><br><a name="section2"></a><h3>  2. VB supports smart quotes </h3><br>  Well, it is, of course, a trifle, but worthy of mention.  Have you ever seen sample code in a text document like this: <br><br><img src="https://habrastorage.org/webt/ls/8l/qc/ls8lqckokgku3b0raqiboefn9bc.png"><br><br>  And after copying the example into your code, did you find that none of the (highlighted) quotes work, because Word replaces all the usual ASCII quotes with <code>‚Äú</code> smart quotes <code>‚Äù</code> ? <br><br>  Me not.  Well, I had this, but only when I copied the examples in C #.  In VB, smart quotes are valid delimiters for strings (funny that Russian quotes <code>¬´¬ª</code> do not work - Approx. Trans.): <br><br><img src="https://habrastorage.org/webt/l0/yk/wi/l0ykwi3ebeigkgrkkrzq8lfrwhm.png"><br><br>  They also work within lines, although perhaps in a strange way.  If you double smart quotes for screening, all you get at runtime is just a regular (‚Äústupid‚Äù) quote.  This may seem a bit strange, but nevertheless it is very practical, since almost everywhere there are no more smart quotes allowed in the string.  The compiler does NOT force you to end up with a smart quotation mark or use the right one if you started with a smart one, so you can mix it up and not bother.  And yes, it also works with the single quote character used for comments: <br><br><img src="https://habrastorage.org/webt/4y/9j/8n/4y9j8n7mexmkyvtx_vmj-jesfak.png"><br><br>  I tried to get Paul Wick ( <a href="https://twitter.com/panopticoncntrl">@panopticoncntrl</a> ) to admit that he did this solely because he was tortured with this problem while working on the specification, but he denies the blame.  This was not the case in VB6, so someone added this later. <br><br><a name="section3"></a><h3>  3. The preprocessing constants can be of any primitive type (including dates) and can contain any constant value. </h3><br><p><img src="https://habrastorage.org/webt/sd/0f/jv/sd0fjva0vsarlwmx7vgwn8yf8xq.png"></p><br><a name="section4"></a><h3>  4. Arbitrary arithmetic operators can be used in preprocessing expressions. </h3><br><p><img src="https://habrastorage.org/webt/hx/cw/0k/hxcw0k25imfieuvg_ncshwbizim.png"></p><br><br><h2>  Announcements, etc. </h2><br><a name="section5"></a><h3>  5. VB sometimes skips implements declarations in IL to prevent accidental implicit interface implementations by name. </h3><br>  This item is from the category of esoteric.  In VB, an interface implementation is always done explicitly.  But it turns out that in the absence of an explicit implementation, the default behavior of the CLR when calling an interface method is to look for public methods by name and signature.  In most cases this is normal, because in VB you <i>usually</i> need to provide an implementation for each member of the interface that you implement, except for one case: <br><br><pre> <code class="vbscript hljs">Interface IFoo <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Interface <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> IFoo_Baz() Implements IFoo.Baz <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> FooDerived Inherits Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-comment"><span class="hljs-comment">' Does something unrelated to what an IFoo.Baz would do. End Sub End Class</span></span></code> </pre><br>  <a href="https://gist.github.com/AnthonyDGreen/39634fd98a0cacc093719ab62d7ab1e6">gist.github.com/AnthonyDGreen/39634fd98a0cacc093719ab62d7ab1e6#file-partial-re-implementation-vb</a> <br><br>  In this example, the class <code>FooDerived</code> just wants to reassign <code>IFoo.Bar</code> to a new method, but leave the remaining implementations unchanged.  It turns out that if the compiler simply generates the implements directive for <code>FooDerived</code> , the CLR will also catch <code>FooDerived.Baz</code> as a new implementation of <code>IFoo.Baz</code> (although in this example it is not related to <code>IFoo</code> ).  In C # this happens implicitly (and I‚Äôm not sure if it can be discarded), but in VB the compiler actually omits 'Implements' from the entire declaration to avoid it, and overrides only specific members that have been re-implemented.  In other words, if you ask <code>FooDerived</code> if it <code>IFoo</code> directly, it will say no: <br><p><img src="https://habrastorage.org/webt/kz/u7/fr/kzu7fr0j1zz4eadll-m5gto7f8q.png"></p><br>  Why do I know this and why is it important?  For years, VB users have requested support for implicit interface implementations (without explicitly stating <code>Implements</code> in each declaration), usually for code generation.  Just turning it on with the current syntax would be breaking change, because <code>FooDerived.Baz</code> now implicitly implements <code>IFoo.Baz</code> , although it hasn‚Äôt done so before.  But more recently, I learned about this behavior better when discussing potential problems in the design of the ‚Äúdefault interface implementation‚Äù feature that would allow interfaces to include some members' default implementations and not require re-implementation in each class.  This would be useful for overloads, for example, when the implementation is likely to be the same for all implementers (delegation of the main overload).  Another scenario is versioning.  If the interface can include default implementations, you can add new members to it without breaking the old implementation.  But there is a problem.  Because the CLR default behavior is to look for public implementations by name and signature, if the VB class does not implement interface members with default implementations, but has public members with a suitable name and signature, they implicitly implement these interface members, even if they do it completely was not supposed to.  There are things that can be done to get around this when the full set of interface members is known at compile time.  But in case a member was added after the code was compiled, it would just silently change the behavior at runtime. <br><br><a name="section6"></a><h3>  6. VB by default hides the members of the base class by name (Shadows), not by name and signature (Overloads) </h3><br>  I think this distinction is quite well known.  The scenario is this: you inherit a base class ( <code>DomainObject</code> ), perhaps beyond your control, and declare a method with a name that makes sense in the context of your class, for example, <code>Print</code> : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> DomainObject <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Invoice Inherits DomainObject <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Print(copies As Integer) <span class="hljs-comment"><span class="hljs-comment">' Sends contents of invoice to default printer. End Sub End Class</span></span></code> </pre> <br>  <a href="https://gist.github.com/AnthonyDGreen/863cfd1e7536fe8bda7cd145795eaf9f">gist.github.com/AnthonyDGreen/863cfd1e7536fe8bda7cd145795eaf9f#file-shadows-example-vb</a> <br><br>  That the invoice can be printed makes sense.  But in the next version of the API, where your base class is declared, they decide to add a method to all DomainObjects for debugging, which displays the full contents of the object in the debugging window.  This method is brilliantly called Print.  The problem is that the client of your API may notice that the Invoice object has the methods <code>Print()</code> and <code>Print(Integer)</code> , and think that these are related overloads.  Maybe the first one simply prints one copy.  But this is not at all what you conceived as the author of Invoice.  You had no idea what <code>DomainObject.Print</code> would appear.  So yes, in VB it doesn't work that way.  When this situation pops up, a warning appears, but more importantly, the default behavior in VB is to hide by name.  That is, unless you explicitly specify using the <code>Overloads</code> keyword that your <code>Print</code> is the base class's <code>Print</code> overload, the base class member (and any of its overloads) is completely hidden.  Only the API you initially declared is shown to clients of your class.  This is how it works by default, but you can do it explicitly through the Shadows keyword.  C # can only <code>Overloads</code> (although it takes <code>Shadows</code> into account when referencing the VB library) and does so by default (using the <code>new</code> keyword).  But this distinction pops up from time to time, when some inheritance hierarchies appear in projects, where one class is defined in one language and another in another, and there are overloaded methods, but this is beyond the scope of the current item in the list of differences. <br><br><a name="section7"></a><h3>  7. VB11 and below are more restrictive to Protected members in generics. </h3><br>  In fact, we changed it between VS2013 and VS2015.  In particular, we decided not to bother with re-implementation.  But I am writing this distinction in case you use the old version and notice it.  In short: if a Protected member is declared in the generic type, the heir, being also a generic, can access this protected member only through the inherited instance with the same type arguments. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base(Of T) Protected x As T <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of T) Inherits Base(Of T) <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> F(y As <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>)) <span class="hljs-comment"><span class="hljs-comment">' Error: Derived(Of T) cannot access Derived(Of String)'s ' protected members yx = "a" End Sub End Class</span></span></code> </pre> <br>  <a href="https://gist.github.com/AnthonyDGreen/ce12ac986219eb51d6c85fa02c339a2f">gist.github.com/AnthonyDGreen/ce12ac986219eb51d6c85fa02c339a2f#file-protected-in-generics-vb</a> <br><br><a name="section8"></a><h3>  8. The syntax "named argument (Named argument)" in attributes always initializes properties / fields </h3><br>  VB uses the same syntax <code>:=</code> to initialize attribute properties / fields as for passing method arguments by name.  Therefore, there is no way to pass an argument to an attribute constructor by name. <br><br><a name="section9"></a><h3>  9. All top-level declarations (usually) are implicitly in the root of the project namespace. </h3><br>  This difference is almost in the category ‚Äúadditional features‚Äù, but I included it in the list, because it changes the meaning of the code.  In the properties of the VB project there is a field: <br><br><p><img src="https://habrastorage.org/webt/0y/hy/7_/0yhy7_k2xkchvxq70v1duka5z4a.png"></p><br>  By default, this is just the name of your project at the time of creation.  This is <b>NOT</b> the same field as the ‚ÄúDefault namespace‚Äù in the C # project properties.  Default namespace simply specifies which code is added by default to new files in C #.  But root namespace in VB means that, unless otherwise specified, every top-level declaration in this project is implicitly located in this namespace.  This is why VB document templates usually do not contain any namespace declarations.  Moreover, if you add a namespace declaration, it does not override the root, but is added to it: <br><br><pre> <code class="vbscript hljs">Namespace Controllers <span class="hljs-comment"><span class="hljs-comment">' Child namespace. End Namespace Namespace Global.Controllers ' Top-level namespace End Namespace</span></span></code> </pre> <br>  <a href="https://gist.github.com/AnthonyDGreen/fd1e5e3a58aee862a5082e1d2b078084">gist.github.com/AnthonyDGreen/fd1e5e3a58aee862a5082e1d2b078084#file-root-namespace-vb</a> <br><br>  Thus, the <code>Controllers</code> namespace actually declares the <code>VBExamples.Controllers</code> namespace, unless you get rid of this mechanism by explicitly declaring the <code>Global</code> namespace. <br><br>  This is convenient because it saves one level of indentation and one unnecessary concept per VB file.  This is especially useful if you are creating a UWP application (because everything in the UWP should be in a namespace), and it‚Äôs extremely convenient if you decide to change the top-level namespace for your entire project, say, from some code name like Roslyn to a longer release version like <code>Microsoft.CodeAnalysis</code> , since you don‚Äôt have to manually update each file in a solution.  It is also important to keep this in mind when working with code generators, XAML namespaces and the new <code>.vbproj</code> file <code>.vbproj</code> . <br><br><a name="section10"></a><h3>  10. Modules are not generated as sealed abstract classes in IL, so they are not exactly like static C # classes and vice versa. </h3><br>  Modules in VB existed before the static C # classes, although we tried in 2010 to make them identical in terms of IL.  Unfortunately, it was breaking change, because the XML Serializer (or maybe it was binary) for that version of .NET (I think they fixed it) did not want to do serialization of a type nested in a type that cannot be created (and the abstract class can not).  He threw an exception. <br><br>  We discovered this after making changes and rolled them back, because some code somewhere used the enum type, which was nested in a module.  And since you don‚Äôt know which version of the serializer the compiled program will work with, it will never change, because in one version of the application it will work, and in others it will throw exceptions. <br><br><a name="section11"></a><h3>  11. You do not need an explicit method for the entry point (Sub Main) in WinForms applications. </h3><br>  If your project uses Form as a start object and does not use the ‚ÄúApplication Framework‚Äù (more on this in the next post), VB generates <code>Sub Main</code> , which creates your start form and passes it to <code>Application.Run</code> , saving you either this way or a whole file to manage this process, either an additional method in your <code>Form</code> , or even the need to think about this problem. <br><br><a name="section12"></a><h3>  12. If you call some obsolete VB runtime methods (for example, FileOpen), the calling method will be implicitly flagged with an attribute to disable inlayning for correctness reasons. </h3><br>  In short, methods for working with VB6-style files like <code>FileOpen</code> rely on the context specific to the assembly where the code is located.  For example, file # 1 can be a log in one project and a config in another.  <code>Assembly.GetCallingAssembly()</code> is called to determine which assembly is running.  But if JIT embeds ( <i>inlines</i> ) your method into the caller, then from a stack point of view, the VB-runtime method will not be called by your method, but by the caller, which may be in a different assembly, which may then allow your code to access or break the internal state of the caller. object.  This is not a security issue, because if the compromising code is running in your process, you have already lost.  This is a question of correctness.  Therefore, if you use these methods, the compiler disables inlining. <br><br>  This change was made at the last moment in 2010, because the x64 JIT is VERY aggressive at inlining / optimizing code, and we found it very late, and it was the safest option. <br><br><a name="section13"></a><h3>  13. If your type is marked with the DesignerGenerated attribute and does not contain any explicit constructor declarations, then the compiler-generated default will call InitializeComponent if it is defined for this type. </h3><br>  In the era before the emergence of Partial-types, the VB team waged war on reducing boilerplate code in WinForms projects.  But even with <code>Partial</code> this is useful because it allows the generated file to completely omit the constructor, and the user can manually declare it in his file, if needed, or not declare it if not.  Without this, the designer would have to add a constructor only to call <code>InitializeComponent</code> , and if the user adds too, they will be duplicates, or the toolkit must be smart enough to move the designer from the designer file to the user and not re-generate it in the designer, if it is already exists in the user file. <br><br><a name="section14"></a><h3>  14. The absence of the Partial modifier does NOT mean that the type is not partial. </h3><br>  Technically, in VB only one class should be marked as Partial.  This is usually (in GUI projects) generated file. <br><br>  <b>Why?</b>  This keeps the user file nice and clean, and can be very convenient for inclusion after generating or completing the generated code with user code.  However, it is recommended that a maximum of one class not have a Partial modifier, otherwise a warning is issued. <br><br><a name="section15"></a><h3>  15. In classes, the default access level is Public for everything except fields, and in Public structures for fields too </h3><br>  I have mixed feelings about this.  In C #, everything is by default <code>private</code> (hooray, encapsulation!), But there is an argument to do depending on what you often declare: a public contract or implementation details.  Properties and events, as a rule, are intended for external ( <code>public</code> ) use, and operators cannot be accessible otherwise than <code>public</code> .  However, I rarely rely on default accessibility (except for demos like the examples from this article). <br><br><a name="section16"></a><h3>  16. VB initializes fields AFTER the call to the base constructor, while C # initializes them BEFORE the call to the base constructor </h3><br>  Have you heard how ‚Äúsome‚Äù say that the first thing that happens in the constructor is a call to the constructor of the base class?  Well, it is not, at least in C #.  In C #, before calling <code>base()</code> , explicitly or implicitly, first the field initializers are executed, then the constructor call, and then your code.  This decision has consequences, and I think I know why language developers could have taken this or that way.  I consider one of these consequences - that the following code cannot be translated into C # directly: <br><br><pre> <code class="vbscript hljs">Imports System.Reflection <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> ReflectionFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringType As Type = GetType(<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringLengthProperty As PropertyInfo = StringType.GetProperty(<span class="hljs-string"><span class="hljs-string">"Length"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringGetEnumeratorMethod As MethodInfo = StringType.GetMethod(<span class="hljs-string"><span class="hljs-string">"GetEnumerator"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringEnumeratorType As Type = StringGetEnumeratorMethod.ReturnType <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>() Console.WriteLine(StringType) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span></code> </pre> <br>  <a href="https://gist.github.com/AnthonyDGreen/37d01c8e7f085e06172bfaf6a1e567d4">gist.github.com/AnthonyDGreen/37d01c8e7f085e06172bfaf6a1e567d4#file-field-init-me-reference-vb</a> <br><br>  At the time when I was engaged in Reflection, I often wrote such code.  And I vaguely recall a colleague to Microsoft (Josh), who translated my C # code, sometimes complaining about the need to transfer all my initializers to the constructor.  In C #, it is forbidden to refer to the created object before <code>base()</code> is called.  And since the field initializers are executed before the specified call, they also cannot refer to other fields or any members of the object instance.  So this example also works only in VB: <br><br><pre> <code class="vbscript hljs">MustInherit <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base <span class="hljs-comment"><span class="hljs-comment">' OOP OP? Private Cached As Object = DerivedFactory() Protected MustOverride Function DerivedFactory() As Object End Class Class Derived Inherits Base Protected Overrides Function DerivedFactory() As Object Return New Object() End Function End Class</span></span></code> </pre> <br>  <a href="https://gist.github.com/AnthonyDGreen/fe5ca89e5a98efee97ffee93aa684e50">gist.github.com/AnthonyDGreen/fe5ca89e5a98efee97ffee93aa684e50#file-base-derived-init-vb</a> <br><br>  Here we have a base class, which presumably has a lot of functionality, but it needs some key object to manage, work, which is determined by the derived type.  There are many ways to implement such a pattern, but I usually use this one because: <br><br><ul><li>  he is short; </li><li>  does not require a constructor ad from me; </li><li>  It does not require me to put the initialization code in the constructor, if it has one; </li><li>  allows me to cache the created object and does not require derived types to declare and manage storage for the provided object, although now this is not a problem with automotive properties. </li></ul><br>  Further, I have been in both situations: when a field in a derived type wanted to call a method declared in the base class, and when the initializer of the base class field needed to call the <code>MustOverride</code> member implemented by the derived type.  Both are valid in VB and none in C #, and that makes sense.  If the initializer of the C # field could call a member of the base class, this member could depend on the fields initialized in the basic constructor (which is not yet running) and the results would almost certainly be wrong, and this would not work around. <br><br>  But in VB, the base constructor has already worked out, so you can do anything!  In the reverse situation, everything is a bit more complicated, because calling an <code>Overridable</code> member from the initializer (or constructor) of the base class can lead to access to the fields before they are ‚Äúinitialized‚Äù.  But only your implementation knows if this is a problem.  In my scenarios, this just does not happen.  They are independent of the instance state, but cannot be <code>Shared</code> members, because you cannot have a <code>Shared Overridable</code> member in any language for technical reasons beyond the scope of this article.  In addition, it is clearly defined what happens to the fields prior to the launch of user initializers - they are initialized with default values, like all variables in VB.  No surprises. <br><br>  <b>So why?</b>  In fact, I don‚Äôt know if my scripts were what the original VB.NET team had in mind when they designed it.  Just in my case, it really works!  ,       :  VB ,         ,       .              .          . <br><br> <i> ,              ,    ,          C#  VB,       ,    VB  ,   C#.</i> <br><br><a name="section17"></a><h3> 17.     (backing field)  VB   ,   C#,     </h3><br>          (       ).        <code>E</code> ,  VB   (  IDE)    <code>EEvent</code> .  C#     <code>E</code> ,     ,   <code>E</code>   ,    . <br><br><a name="section18"></a><h3> 18.      VB         </h3><br>      <code>P</code> ,      <code>_P'</code> .    IntelliSense,      .  C#    ¬´¬ª ( <i>mangled</i> ) ,  ,            C#     . <br><br> <b> ?</b>  VB    , -,             ¬´WithEvents¬ª,  -,     ,   -     ,        . <br><br><a name="section19"></a><h3> 19.     read-only    </h3><br>    ,        ,  ‚Ä¶.   VB     ¬´ ¬ª    .    <code>WithEvents</code> -, non-Custom           ,       ,     .    IntelliSense,      ,     ,  .   FTW!  ,   VB  ,    private set;   C#. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Alarm <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> ReadOnly Code As Integer ReadOnly <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Status As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-string"><span class="hljs-string">"Disarmed"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>(code As Integer) <span class="hljs-keyword"><span class="hljs-keyword">Me</span></span>.Code = code <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Arm() <span class="hljs-comment"><span class="hljs-comment">' I'm motifying the value of this externally read-only property here. _Status = "Armed" End Sub Function Disarm(code As Integer) As Boolean If code = Me.Code Then ' And here. _Status = "Disarmed" Return True Else Return False End If End Function End Class</span></span></code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/57ce7962700c5498894ad417296f9066">gist.github.com/AnthonyDGreen/57ce7962700c5498894ad417296f9066#file-read-only-auto-property-backing-field-is-writeable-vb</a> <br><br><a name="section20"></a><h3> 20.         </h3><br>  ,  <code>NonSerialized</code> . <br><br>   VB       (expanded) Custom-  2005  (?) <b></b>       ,         ,  ,   <code>NonSerialized</code> .  ,     ,   ,   ,       ¬´¬ª       ,    ¬´ ¬ª. <br><br>     ,   ,          ,  ,   . , , ,     ,     two-way bindable ( ,   <code>PropertyChanged</code> ),     ,    , , ,    . <br><br>   ,     ,       CLSA ¬´Expert Business Objects¬ª <a href="https://twitter.com/rockylhotka">  (Rocky Lhotka)</a> ,      undo/redo (    ,    ,   - ,  ,     ),       .  ,         .  ,  ,        ,    . <br><br><h2>  Instructions </h2><br><a name="section21"></a><h3> 21.    ‚Äî    ,  ;      ( ) </h3><br>   ,      <code>GoTo</code>     .   ,        -   . ,       <code>For</code>  <code>For Each</code> ;  <code>Using</code> , <code>SyncLock</code>  <code>With</code> ,   ,     ,        <code>Finally</code> .   <code>If</code>  <code>Select Case</code> ,  <code>Do</code>  <code>While</code> ,    Try ‚Äî    ,        : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> retryCount = <span class="hljs-number"><span class="hljs-number">0</span></span> Try Retry: <span class="hljs-comment"><span class="hljs-comment">' IO call. Catch ex As IO.IOException When retryCount &lt; 3 retryCount += 1 GoTo Retry End Try End Sub End Module</span></span></code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/b93adcf3c3705e4768dcab0b05b187a0">gist.github.com/AnthonyDGreen/b93adcf3c3705e4768dcab0b05b187a0#file-try-goto-retry-vb</a> <br><br>  ,  ,   ,   .NET  VB      ¬´¬ª.  VB6        Quick Basic  ( )       .      QB,      .     ,       ¬´ ¬ª,           .        GoTo,         ‚Äî   ,        . <br><br> <b></b> :    <code>Try</code>    ,  VB -   <code>await</code>   <code>Catch</code>  <code>Finally</code> ,  ,     <code>GoTo</code>    . <br><br><a name="section22"></a><h3> 22.     &lt;&gt;   </h3><br>    ,  VB   (     )  ( <code>static</code> )        (      ).    ,     .        <code>Catch</code>       3 .      <code>Try</code>      <code>Catch</code> ,      ,   ,       <code>Try</code>     . <br><br>  ,  VB.NET     ,     .       CLR      VB   .      :           ,    . <br><br> <i>, C# ,        ,       ¬´¬ª.   VB.NET     .</i> <br><br><a name="section22"></a><h3> 23.          </h3><br>       ,        ,    C#       ¬´ ¬ª ( <i>definite assignment</i> ).   ,    , ,         ¬´ ¬ª.   ,   ( )           ,   ,          .    C/C++.      , !   ,        .  ,        ,    , ‚Äî  .           ,     ,   ,         ,  ,         ,      ,          ,    .  ,  BASIC   ,          ,      ¬´¬ª ,       <code>= Nothing</code> , <code>= 0</code> , <code>= False</code>  .. <br><br> ,   ( <i>flow analysis</i> )  VB    ,    . <br><br>         ,    C#   ,  ,          ,            . VB    <i></i>  ,       ,        ,       .  Roslyn, , API       ¬´ ¬ª,       ,      . <br><br><a name="section24"></a><h3> 24. RaiseEvent   ,     null </h3><br>     ,  -     C#  VB. <code>RaiseEvent</code>  VB ‚Äî        ,     <code>null</code> ( ),    <code>null</code> - ‚Äî  ,      . <br><br><pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">' You don't have to write this: If PropertyChangedEvent IsNot Nothing Then RaiseEvent PropertyChanged(Me, e) End If ' You don't have to write this: Dim handlers = PropertyChangedEvent If handlers IsNot Nothing Then handlers(Me, e) End If ' You don't have to write this either: PropertyChangedEvent?(Me, e) ' Just write this: RaiseEvent PropertyChanged(Me, e)</span></span></code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/c3dea3d91ef4ffc50cfa92c41f967937">gist.github.com/AnthonyDGreen/c3dea3d91ef4ffc50cfa92c41f967937#file-null-safe-event-raising-vb</a> <br><br> ,    null-conditional   C#  VS2015     C#   ,      VB (  ),       ,     ;   VB.NET    . <br><br><a name="section25"></a><h3> 25.    ;        (shallow clone) </h3><br>     , ,        17 , ,     .     (boxed)      Object,       <code>System.Runtime.CompilerServices.RuntimeHelper.GetObjectValue</code> .   ,   CLR.    ,    : <br><br><ul><li>     ,      . <br></li><li>       ,    (,     Integer ),      . <br></li><li>        ,            . <br></li></ul><br>    ,     ,  ,    ,       ( <i>late-bound situations</i> ). ,        ,     (    )  ,           ,   ,        ,      ( <i>caller's copy</i> ).          ,     ,  - , ‚Äî     . <br><br>          .     : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Value As Object <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Structure MyStruct <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> X, Y As Integer <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Structure Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> defaultValue As Object = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyStruct <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.X = <span class="hljs-number"><span class="hljs-number">3</span></span>, .Y = <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> e = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.Value = defaultValue} RaiseEvent DoSomething(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, e) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> e.Value <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> defaultValue <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-comment"><span class="hljs-comment">' No handlers have changed anything. Console.WriteLine("Unchanged.") End If End Sub Event DoSomething(sender As Object, e As MyEventArgs) End Module</span></span></code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/422ac4574af92d9bbbf59f0fbc40b74d">gist.github.com/AnthonyDGreen/422ac4574af92d9bbbf59f0fbc40b74d#file-get-object-value-vb</a> <br><br>      ,     WPF,               .    ,     . ,                     ,        .    ,    .   ,    -   ,  , ,              . <br><br> ,    ,   ¬´ ¬ª         .    IronRuby/Python,    <code>dynamic</code>  C# (  C#): C#    <code>GetObjectValue</code>     .         <code>object.ReferenceEquals</code> ,  ,    ,   <i></i>    -    <code>dynamic</code> C# (     ).       <code>==</code> ,    .   C#,    ,          . <br><br><a name="section26"></a><h3> 26. Select Case   ¬´¬ª (fall-through);   break </h3><br>     Friday    ,  Sunday ‚Äî  ,  5   . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Tuesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Wednesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Thursday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Friday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekday"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Sunday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekend"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/7b7e136c71dd11b2417a6c7267bb3546">gist.github.com/AnthonyDGreen/7b7e136c71dd11b2417a6c7267bb3546#file-select-case-no-fallthrough-vb</a> <br><br>     Roslyn C#  ,  -      : <i>¬´,    ?   !¬ª</i>   <i>¬´,  ¬ª</i> .   . VS    ,    ,   ,    ,      ,     .    ! <br><br>       . C# ,        C,       C.       .  , C#     ,    case   .   -  ,     <code>goto</code> ,  <code>break</code> .     VB   <code>break</code> , <code>Exit Select</code> ,       ,    VB   . <br><br><a name="section27"></a><h3> 27.   Case     </h3><br>      ,      .           C#,   : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday, DayOfWeek.Tuesday, DayOfWeek.Wednesday, DayOfWeek.Thursday, DayOfWeek.Friday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Get to work!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday, DayOfWeek.Sunday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Funtime!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/bd642061896246c9336255881fb78546">gist.github.com/AnthonyDGreen/bd642061896246c9336255881fb78546#file-select-case-scopes-vb</a> <br><br>   ,  <code>message</code>        ,    C#   <code>switch</code>         <code>case</code> ‚Äî   .     . ,  ,  -    (  ,  C):        , , ,  ,     . <br><br><a name="section28to30"></a><h3> 28, 29, 30. Select Case    ,             = </h3><br> ,  ,     ,            ,     <code>Select Case</code>             . <br><br>             ,       ,     .    : <br><br><ul><li> <code>Select Case</code> ‚Äî  ,           , ‚Ä¶ <br></li><li> <code>switch</code> ‚Äî   / ,   ¬´ <a href="https://en.wikipedia.org/wiki/Branch_table"></a>   ¬ª. <br></li></ul><br>  ,    26-30. <code>switch</code>    ,    ,  , ,     <code>if</code> .  IL   <code>switch</code> ,   ,   <code>If</code> ,   VB        ,   .    switch       , ,    C   .  VB    . <br><br><a name="section31"></a><h3> 31. ,   ,         </h3><br>       <code>x</code>    ,      ,      -1, -2, -3: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> Console.WriteLine(x) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/cbc3a9c70677354973d64f1d993a3c5d">gist.github.com/AnthonyDGreen/cbc3a9c70677354973d64f1d993a3c5d#file-loop-variables-retain-their-values-vb</a> <br><br>    <i>¬´     ,    ,    ¬ª</i> ( ).   ,      VB2008  ,    -: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lambdas = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Action) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> lambdas.Add(<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>() Console.WriteLine(x)) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> lambda <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> lambdas lambda() <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/2ef9ba3dfcf9a1abe0e94b0cde12faf1">gist.github.com/AnthonyDGreen/2ef9ba3dfcf9a1abe0e94b0cde12faf1#file-loop-variables-captured-per-iteration-vb</a> <br><br>     -1, -2, -3.     <code>x</code> ‚Äî ¬´ ¬ª, -   <code>x</code>    ,      .          ,        <code>x</code>     .     flow analysis API ‚Äî ! ( <i>¬´‚Ä¶ ‚Ä¶  ?¬ª</i> ) <br><br>  <b>Why?</b>   ,  ,      ,    ,      ,        #22.         ,        ,       -,         . <br><br> ,   VB  C#      ( <i>control variables</i> )  <code>For Each</code>  VS2012 (?),  -   ¬´ ¬ª.   10000%    ,    (  , VB      ,      ).  ,    VB         <code>For</code> ,        .            ,      .      ,   VB  <code>For</code>      <code>For Each</code> ,  <code>for</code>  <code>foreach</code>  C#.          ,   <code>For</code>  VB -  ,    ,      . <br><br><a name="section32"></a><h3> 32.    For        </h3><br>         <code>For</code> .        ,   ,       1,3,5,7,9,          ,     . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lower = <span class="hljs-number"><span class="hljs-number">1</span></span>, upper = <span class="hljs-number"><span class="hljs-number">9</span></span>, increment = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = lower <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> upper <span class="hljs-keyword"><span class="hljs-keyword">Step</span></span> increment Console.WriteLine(i) upper += <span class="hljs-number"><span class="hljs-number">1</span></span> increment -= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/1e48113be204f515c51e221858666ac7">gist.github.com/AnthonyDGreen/1e48113be204f515c51e221858666ac7#file-for-loop-bounds-cached-vb</a> <br><br>    ,          (       ),   ,     ,    ,          <code>IndexOutOfRangeExceptions</code> ,    . <br><br>   ,   ,      , , ,       C,    VB .  - ,  VB ,  <code>For i = a To b Step c</code>   (  ,  <code>i&gt; b</code> )   (  ,  <code>i &lt;b</code> ),   <code>c</code>    ?    ,    ,      ,   <code>b</code>   ,   ‚Äî .    ,     , , ,       . <br><br><a name="section33"></a><h3> 33. For Each   VB     GetEnumerator </h3><br>       <code>For Each</code> ,     <code>IEnumerable</code> ,       <code>GetEnumerator</code>  ,    <code>For Each</code> . <br> ,   ,     <code>For Each</code>  <code>IEnumerator</code>  ,          , : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> list = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Integer) From {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> info = list.FirstAndRest() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> info.First IsNot <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.Write(info.First.GetValueOrDefault()) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> other <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> info.Additional Console.Write(<span class="hljs-string"><span class="hljs-string">", "</span></span>) Console.Write(other) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> Console.WriteLine() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> FirstAndRest(Of T As Structure)(sequence As IEnumerable(Of T)) As (First As T?, Additional As IEnumerator(Of T)) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> enumerator = sequence.GetEnumerator() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> enumerator.MoveNext() <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return (enumerator.Current, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Return (<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetEnumerator(Of T)(enumerator As IEnumerator(Of T)) As IEnumerator(Of T) Return enumerator <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/d7dbb7a5b98a940765c4adc33e3eaeee">gist.github.com/AnthonyDGreen/d7dbb7a5b98a940765c4adc33e3eaeee#file-for-each-extension-get-enumerator-vb</a> <br><br>           F#        ,    <code>IEnumerator</code> ,     <code>For Each</code>    ,   . <br><br>  VB   ,            ( <i>well-known name</i> ),      .   , ,   Add,   . C#     ,          (. <code>async</code> / <code>await</code> ).      ,    C# Roslyn ()     ,     . <br><blockquote>  . 15-16   -    .NET- <a href="https://dotnext-piter.ru/%3Futm_source%3Dhabr%26utm_medium%3D443684">DotNext 2019 Piter</a> .   ,       .       ,      .     <a href="https://dotnext-piter.ru/%3Futm_source%3Dhabr%26utm_medium%3D443684">  </a>  <a href="https://dotnext-piter.ru/registration/%3Futm_source%3Dhabr%26utm_medium%3D443684"> </a> . </blockquote></div><p>Source: <a href="https://habr.com/ru/post/443684/">https://habr.com/ru/post/443684/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../443674/index.html">Anonymous prepaid cards - how, to whom and why?</a></li>
<li><a href="../443676/index.html">Vinyl instead of a postage stamp: an unusual rarity</a></li>
<li><a href="../443678/index.html">Code readability</a></li>
<li><a href="../443680/index.html">Four-day work week. Russian experience</a></li>
<li><a href="../443682/index.html">Monetization of the cloud: how to attract customers and not go broke</a></li>
<li><a href="../443686/index.html">March 30 - 31, SIBUR CHALLENGE in Nizhny Novgorod</a></li>
<li><a href="../443690/index.html">Parallels RAS: what is it and what is it eaten with?</a></li>
<li><a href="../443692/index.html">Alchemy of the 21st Century: Conversion of Liquid Metallic Deuterium to Plasma</a></li>
<li><a href="../443694/index.html">How the browser helps fellow Major</a></li>
<li><a href="../443698/index.html">Google has stopped "strangling goose": DuckDuckGo is included in the list of standard Chrome search engines for 60 countries</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>