<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The Good, the Bad and the Ugly code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good code or bad? For me personally, good code has the following qualities: 


- The code is easily understood by developers of different qualificatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The Good, the Bad and the Ugly code</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage3/6e7/1c5/466/6e71c54665b0502d77d654b6c60d6175.png"><br>  Good code or bad?  For me personally, good code has the following qualities: <br><ul><li>  The code is easily understood by developers of different qualifications and well structured. </li><li>  Code is easy to change and maintain. </li><li>  The application performs its functions and has sufficient, for the range of tasks performed, fault tolerance </li></ul><br>  Despite a brief description of how to achieve the fulfillment of these three conditions, many thick books have been written. <br><br>  Why exactly these criteria?  Immediately make a reservation, we are now talking about the development of software for business <i>(enterprise application)</i> .  Code evaluation criteria for real-time systems, airplanes, life support systems and the ISS are different. <br><a name="habracut"></a><br><img src="https://habrastorage.org/storage3/194/12c/8a3/19412c8a30190997a9fe17057ef63a11.jpg"><br>  Surely everyone or almost everyone knows this triangle. <br>  At the same time from three conditions - quickly, efficiently, cheaply - only two can be fulfilled. <br>  When developing business applications, our goal is to develop fairly good software within a reasonable timeframe, within the budget.  In practice, this means that there may be errors in our application, but in places not critical to the system.  Let's look at a few examples to better understand what this means. <br><br><h2>  Case ‚Ññ1 </h2><br>  The form has a text entry field (textarea).  You can enter 100,500 characters there and our application will crash with the exception "The maximum request length has been exceeded." 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Is this our case?  Hardly.  If this is a public part, it is worthwhile to set up a Java-script validator and not to post such forms.  Setting up an additional server for those who disabled java-script is simply a waste of time, which means of a budget.  We will not do that.  Yes, there is a potential error in our application.  Does someone need to be corrected?  Not. <br><br><h2>  Case ‚Ññ2 </h2><br>  A request comes from a client: we need a partner page.  On this page there will be a brief information about each of them and a link to the page where we should embed the page from the partner‚Äôs site into the iframe. <br><br>  An interesting case.  Probably, we need to make a change to the database, add the partner entity, we don‚Äôt pass the db entity by design to the View, so we also need the DTO, the mapping function from the db entity to dto, and the database migration for auto deployment.  Hmm, I still need an admin page to add a partner.  Do not forget about the routing for the controller to be <i>/ Partner / &lt;PARTNER_NAME&gt;</i> Quite a lot of work ... <br><br>  Right for 10,000 partners.  Let's take an interest: <b>‚Äúhow many partners will there be‚Äù</b> ?  If the answer is "this year three."  We should reconsider our views.  This is again a waste of time and budget.  Only 3 partners? <br><br><img src="https://habrastorage.org/storage3/a08/d23/f11/a08d23f11c55519e120f03ca22a0ca74.png"><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Habrahabr.Models.Partner</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PartnerViewModel</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> WebSiteUrl { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ShortDescription { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> FullDescription { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Web.Mvc; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Habrahabr.Models.Partner; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Habrahabr.Controllers</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PartnerController</span></span> : <span class="hljs-title"><span class="hljs-title">Controller</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> PartnerViewModel[] partners = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PartnerViewModel() { Name = <span class="hljs-string"><span class="hljs-string">"Coca-Cola"</span></span>, WebSiteUrl = <span class="hljs-string"><span class="hljs-string">"http://coca-cola.com/partner"</span></span>, ShortDescription = <span class="hljs-string"><span class="hljs-string">"Coca-cola short description"</span></span>, FullDescription = <span class="hljs-string"><span class="hljs-string">"Coca-cola full description"</span></span> }, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PartnerViewModel() { Name = <span class="hljs-string"><span class="hljs-string">"Ikea"</span></span>, WebSiteUrl = <span class="hljs-string"><span class="hljs-string">"http://ikea.com/partner"</span></span>, ShortDescription = <span class="hljs-string"><span class="hljs-string">"Ikea short description"</span></span>, FullDescription = <span class="hljs-string"><span class="hljs-string">"Ikea full description"</span></span> }, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PartnerViewModel() { Name = <span class="hljs-string"><span class="hljs-string">"Yandex"</span></span>, WebSiteUrl = <span class="hljs-string"><span class="hljs-string">"http://yandex.ru/partner"</span></span>, ShortDescription = <span class="hljs-string"><span class="hljs-string">"Yandex short description"</span></span>, FullDescription = <span class="hljs-string"><span class="hljs-string">"Yandex full description"</span></span> } }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ActionResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Index</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> populate partners from database if a lot of partner required return View(partners); } // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> refactor this if a lot of partner required [ActionName("Coca-Cola")] public ActionResult CocaCola() { return View("_PartnerDetail", partners[0]); } public ActionResult Ikea() { return View("_PartnerDetail", partners[1]); } public ActionResult Yandex() { return View("_PartnerDetail", partners[2]); } } } @model IEnumerable&lt;Habrahabr.Models.Partner.PartnerViewModel&gt; &lt;ul&gt; @foreach (var p in @Model) { &lt;li&gt; &lt;h3&gt;@Html.ActionLink(p.Name, p.Name, "Partner")&lt;/h3&gt; &lt;div&gt;@p.ShortDescription&lt;/div&gt; &lt;p class="info"&gt;@Html.ActionLink("Partner page", p.Name, "Partner")&lt;/p&gt; &lt;/li&gt; } &lt;/ul&gt; @model Habrahabr.Models.Partner.PartnerViewModel &lt;h2&gt;@Model.Name&lt;/h2&gt; &lt;div&gt;@Model.FullDescription&lt;/div&gt; @if (!string.IsNullOrEmpty(Model.WebSiteUrl)) { &lt;iframe width="100%" height="500" src="@Model.WebSiteUrl"&gt;&lt;/iframe&gt; }</span></span></code> </pre> <br><img src="https://habrastorage.org/storage3/188/a0a/622/188a0a622795a53eec7ca89863f3df91.png"><br><img src="https://habrastorage.org/storage3/c6f/028/482/c6f028482c25a1f09746b2ec97e437b7.png"><br><br>  For everything about everything - the maximum hour of time, taking into account the input of texts.  We have developed a fairly good partner page.  Does he meet our criteria: <br><ul><li>  Understandable and structured - yes </li><li>  Easy to change - yes </li><li>  Reliable enough - yes </li></ul><br><h2>  Domain, data access and application architecture </h2><br>  Fowler correctly noted in his book <a href="http://martinfowler.com/books/eaa.html">Enterprise Patterns of Enterprise Application Architecture</a> that the term ‚Äúarchitecture‚Äù is incredibly blurred: <br><blockquote>  The term "architecture" is tried to be interpreted by all and sundry, and everyone in their own way.  However, there are two common options.  The first is related to the division of the system into the largest components;  in the second case, some constructive decisions are meant, which after their adoption are difficult to change.  There is also a growing understanding that there is more than one way to describe the architecture and the degree of importance of each of them changes during the life cycle of the system. <br></blockquote><br>  The above approach with partners has one significant limitation.  You can not constantly write application code in this style.  Sooner or later the system will grow.  In this case, we have ‚Äústitched‚Äù the application logic.  A couple more of these controllers and understand the operation of the system will be quite difficult, especially for new developers. <br>  At the moment when it turns out that the partners will be not 3, but 100,500, and not all should be shown, but only those who paid Friday to Saturday night from 13 to 14 and sacrificed 6 virgins, and the pages should be rotated to compliance with the position of Venus relative to Jupiter (in real life, cases, of course, are different, but for good reason they say that there is nothing illogical for a developer than "business logic", consisting entirely of exceptions and special cases).  We need to think about architecture in both senses of the word. <br><br>  We left the ‚Äústitches‚Äù in the app beforehand, we will begin to unpick them and sew the necessary pieces.  We will use <i>ORM</i> , rename <i>PartnerViewModel</i> to <i>Partner</i> and zapapim partner class in the database.  I have never used <i>Database-First</i> and have not taken the <i>Entity Framework</i> seriously until the version with the <i>Code-First</i> approach was released.  In this case, I do not see the need to <i>map</i> <i>Partner</i> in <i>PartnerViewModel</i> .  Yes, semantically, these entities perform different tasks and, in general, <i>PartnerViewModel</i> may be different, but for now there is no single reason to write exactly the same class.  Map <i>ViewModel</i> makes sense when you can't do without it without dragging logic into the view.  Usually, the need for <i>ViewModels</i> arises if the interface requires showing a complex form operating with several domain entities at once, or there is a need to use attributes from the <i>System.Web</i> assembly for model properties.  In the latter case, I am inclined to drag this dependency into an assembly with the subject area, if I am sure that in the next six months a new entry point will not appear in the application, except for the main web application. <br><br>  In one project in which I participated, to access the data, it was necessary to call a service that accessed the facade, which in turn addressed the <i>DAL layer</i> , which caused the <i>Entity Framework</i> .  <i>The facade</i> and <i>DAL</i> were in different assemblies, and <i>EF</i> used the <i>Database-First</i> approach.  All the logic was usually performed by <i>DAL</i> , and the remaining layers simply made up the results in 90% of cases in absolutely identical <i>DTO</i> .  At the same time, the system did not have any other clients and the service was objectively not needed.  When I asked ‚Äúwhy such an overhead projector,‚Äù the developer, who had worked on the project longer, said: ‚ÄúI don‚Äôt know, our other project was written this way, they decided to do it by analogy‚Äù.  Yes, this ‚Äúother project‚Äù consisted of 20 applications and only took 2 days to deploy it.  The API for this application has many clients.  Such a complex structure was a must.  In our case, it was the shooting of a gun on the sparrows. <br><br>  But back to our <s>sheep</s> partners.  It remains to understand where to write the code responsible for selecting the necessary partners for the show.  I remind you that now we have to take into account Venus and Jupiter.  The worst place is the controller.  Doing so, we will scatter the application logic in different parts of it and new developers will have to assemble it (logic), like Harry Potter, who has been collecting <a href="http://ru.harrypotter.wikia.com/wiki/%25D0%259A%25D1%2580%25D0%25B5%25D1%2581%25D1%2582%25D1%2580%25D0%25B0%25D0%25B6">talisers</a> . <br>  A good option to use the pattern <s><a href="http://design-pattern.ru/patterns/repository.html">repository</a></s> <a href="https://habrahabr.ru/post/325280/">specification</a> . <br><br><h2>  IOC / DI </h2><br>  As the application grows, there is a danger of making it too tightly bound, and this will make the system slow and will prevent the code from changing. <br><br>  I will not describe once again what IOC / DI is and what it is eaten with, I just need to make it a rule: <ul><li>  Do not explicitly create dependencies. </li><li>  Use IOC containers </li></ul><br>  It is not necessary to create an interface for each class in the project.  Often the interface is easier to allocate in the future.  R # does an excellent job with this task.  But keep this in mind when writing a class.  Think of it as an interface, not a concrete implementation.  Using <i>DI</i> you can flexibly manage implementations.  If necessary, you can throw out one implementation and replace it with another, for example, if for some reason the database ceases to suit you, you can replace it transparently, replacing the repository implementation.  In addition, using <i>IOC / DI is</i> much easier to write test code. <br><br><h2>  Tests </h2><br>  I am not a fan of 90-100% project coverage.  I think that more often than not, this slows down development and makes code support a much more dreary task.  I prefer to test the behavior of the system, i.e.  basic business rules of the application.  Thus, tests not only insure against errors, but also help new developers to quickly understand the logic of the system.  Such tests work better than any documentation.  Especially effective are tests using BDD notation. <br><br><h2>  Further development of the system </h2><br>  If the application continues to grow, it is difficult to give specific advice: too many factors to consider.  Too much depends on the specifics of the project.  A good solution might be <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D1%2580%25D0%25B2%25D0%25B8%25D1%2581-%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B0%25D1%2580%25D1%2585%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BA%25D1%2582%25D1%2583%25D1%2580%25D0%25B0">SOA</a> .  In general, the decomposition of any large system is a great idea.  You have ten projects uploaded to your IDE or one hundred - the difference is very big.  When developing software of such a scale, it is impossible to do without deploy-scripts, installers and release management, but that's another story ... <br><br><h2>  Lambda, aspects, functional and other holivor </h2><br>  Finally, I decided to leave the obviously controversial points.  I noticed that many developers tend to get used to the stack they work with.  If the programmer is ‚Äúused‚Äù to his stack, he is inclined to drag him into each new project, regardless of expediency.  So, I repeatedly heard criticism of C # for ‚Äúflirting‚Äù with a functional style, lambdas, which are compiled into ‚Äúdamn-knows what‚Äù and ‚Äúnot debugged‚Äù and for other extension-methods.  Objectively, we see that in php they added closures, in java8 there will be a <i>Stream</i> for stream processing of collections, which means that many developers like it. <br><br>  Do not be afraid to combine paradigms, if it is worth it.  Ask yourself the questions ‚Äúhow much platform / language / OS is suitable for the task?‚Äù And ‚Äúwhat technologies will help me to complete the task as efficiently as possible?‚Äù.  Best of all, my point of view is illustrated by the quotation <a href="https://habrahabr.ru/users/iliakan/" class="user_link">iliakan</a> : <br><blockquote>  I figured that it would be faster to learn Erlang or make Java run fast enough and decided to learn Erlang <br></blockquote><br><h2>  Books on the topic </h2><br><ul><li>  <a href="http://www.ozon.ru/context/detail/id/1616782/">Enterprise Software Architecture</a> </li><li>  <a href="http://www.ozon.ru/context/detail/id/5800704/">Principles, patterns and techniques of agile development in C #</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/195732/">https://habr.com/ru/post/195732/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../195718/index.html">How does Sberbank share your personal information?</a></li>
<li><a href="../195720/index.html">Welding of optical fibers. Part 2: welding machines and cleavers, mechanical and welded splicing, measuring and laying fibers</a></li>
<li><a href="../195722/index.html">Romo: pet</a></li>
<li><a href="../195724/index.html">RWpod. 28 release 01 of the season. Details about Ruby 2.1.0, HTTP 2.0 gem, Semantic UI, Framer.js, etc.</a></li>
<li><a href="../195730/index.html">Macro for balancing outgoing calls to GSM in Asterisk</a></li>
<li><a href="../195736/index.html">Java serialization: how to look inside the black box</a></li>
<li><a href="../195738/index.html">Create a private cloud using System Center Virtual Machine Manager 2012 R2</a></li>
<li><a href="../195740/index.html">Azul Zulu - JVM for the cloud or just the OpenJDK port on Windows?</a></li>
<li><a href="../195742/index.html">We give the project in good hands</a></li>
<li><a href="../195744/index.html">Review of the Apple MacBook Air mid 2013 laptop on the Haswell processor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>