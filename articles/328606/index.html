<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis of Wana Decrypt0r 2.0 cipher</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Specialists from T & T Security and Pentestit made an analysis of the coder Wana Decrypt0r 2.0 to identify the functionality, analyze the behavior and...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analysis of Wana Decrypt0r 2.0 cipher</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/ef3/c0e/f50/ef3c0ef50966494581f4c5d83760a036.png"><br><p><br>  Specialists from T &amp; T Security and Pentestit made an analysis of the coder Wana Decrypt0r 2.0 to identify the functionality, analyze the behavior and methods of spreading malware. </p><a name="habracut"></a><br><p>  Wanna Decrypt0r distributed via SMB is the second version of Wanna Cry that was distributed in more classical ways (phishing), so it has an index of 2.0.  At the moment there are at least three branches of the encrypter: phishing (first), killwitch (first wave), no kilwitcher (released just a few hours ago).  As of 22:00 05/14/2017 <a href="https://geektimes.ru/post/289153/">, the</a> second and third variants of the malware were found, including those without the killer switcher. </p><br><h2>  Statistics </h2><br><h3>  Infections: </h3><br><p>  At the moment (19:00 GMT + 3) 236,648 cars are infected (most likely tomorrow this figure will increase significantly).  Although the manager (or rather, the one responsible for the distribution) managed to tinker away, it‚Äôs wrong to judge the number of infections by ‚Äúbatch‚Äù to this domain.  Some infected machines may be behind NAT or disconnected from the global network. <br></p><br><img src="https://habrastorage.org/web/4f1/46e/514/4f146e514880492f9ad574ac04f403a3.png"><br><p></p><br><h3>  Payments: </h3><br><p>  Decryption redemption are listed on three Bitcoin wallet: </p><br><ul><li>  115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn: 4.33279223 BTC - $ 7799 </li><li>  13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94: 6.00472753 BTC - $ 10808 </li><li>  12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw: 8.78127705 BTC - $ 15806 </li></ul><br><h3>  Command centers: </h3><br><ul><li>  gx7ekbenv2riucmf.onion </li><li>  57g7spgrzlojinas.onion </li><li>  xxlvbrloxvriy2c5.onion </li><li>  76jdd2ir2embyv47.onion </li><li>  cwwnhwhlz52maqm7.onion </li></ul><br><h3>  Supported languages: </h3><br><pre><code>m_bulgarian, m_chinese (simplified), m_chinese (traditional), m_croatian, m_czech, m_danish, m_dutch, m_english, m_filipino, m_finnish, m_french, m_german, m_greek, m_indonesian, m_italian, m_japanese, m_korean, m_latvian, m_norwegian, m_polish, m_portuguese, m_romanian, m_russian, m_slovak, m_spanish, m_swedish, m_turkish, m_vietnamese</code></pre><br>
<h3>:</h3><br>
<p>    ,  ,   ,   ,   <a href="https://pastebin.com/0LrH05y2"> </a>:</p><br>
<pre><code>00:34 &lt; nulldot&gt; 0x1000ef48, 24, BAYEGANSRV\administrator
00:34 &lt; nulldot&gt; 0x1000ef7a, 13, Smile465666SA
00:34 &lt; nulldot&gt; 0x1000efc0, 19, wanna18@hotmail.com
00:34 &lt; nulldot&gt; 0x1000eff2, 34, 1QAc9S5EmycqjzzWDc1yiWzr9jJLC8sLiY
00:34 &lt; nulldot&gt; 0x1000f024, 22, sqjolphimrr7jqw6.onion
00:34 &lt; nulldot&gt; 0x1000f088, 52, https://www.dropbox.com/s/deh8s52zazlyy94/t.zip?dl=1
00:34 &lt; nulldot&gt; 0x1000f0ec, 67, https://dist.torproject.org/torbrowser/6.5.1/tor-win32-0.2.9.10.zip
00:34 &lt; nulldot&gt; 0x1000f150, 52, https://www.dropbox.com/s/c1gn29iy8erh1ks/m.rar?dl=1
00:34 &lt; nulldot&gt; 0x1000f1b4, 12, 00000000.eky
00:34 &lt; nulldot&gt; 0x1000f270, 12, 00000000.pky
00:34 &lt; nulldot&gt; 0x1000f2a4, 12, 00000000.res</code></pre><br>
<h3>Killswitch :</h3><br>
<p>iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com.       .</p><br>
<h3>   :</h3><br>
<pre><code>.doc, .docx, .xls, .xlsx, .ppt, .pptx, .pst, .ost, .msg, .eml, .vsd, .vsdx, .txt, .csv, .rtf, .123, .wks, .wk1, .pdf, .dwg, .onetoc2, .snt, .jpeg, .jpg, .docb, .docm, .dot, .dotm, .dotx, .xlsm, .xlsb, .xlw, .xlt, .xlm, .xlc, .xltx, .xltm, .pptm, .pot, .pps, .ppsm, .ppsx, .ppam, .potx, .potm, .edb, .hwp, .602, .sxi, .sti, .sldx, .sldm, .sldm, .vdi, .vmdk, .vmx, .gpg, .aes, .ARC, .PAQ, .bz2, .tbk, .bak, .tar, .tgz, .gz, .7z, .rar, .zip, .backup, .iso, .vcd, .bmp, .png, .gif, .raw, .cgm, .tif, .tiff, .nef, .psd, .ai, .svg, .djvu, .m4u, .m3u, .mid, .wma, .flv, .3g2, .mkv, .3gp, .mp4, .mov, .avi, .asf, .mpeg, .vob, .mpg, .wmv, .fla, .swf, .wav, .mp3, .sh, .class, .jar, .java, .rb, .asp, .php, .jsp, .brd, .sch, .dch, .dip, .pl, .vb, .vbs, .ps1, .bat, .cmd, .js, .asm, .h, .pas, .cpp, .c, .cs, .suo, .sln, .ldf, .mdf, .ibd, .myi, .myd, .frm, .odb, .dbf, .db, .mdb, .accdb, .sql, .sqlitedb, .sqlite3, .asc, .lay6, .lay, .mml, .sxm, .otg, .odg, .uop, .std, .sxd, .otp, .odp, .wb2, .slk, .dif, .stc, .sxc, .ots, .ods, .3dm, .max, .3ds, .uot, .stw, .sxw, .ott, .odt, .pem, .p12, .csr, .crt, .key, .pfx, .der</code></pre><br>
<h3>:</h3><br>
<p>   2048-  RSA.       .</p><br>
<h3>:</h3><br>
<p>       MS17-010   SMBv1. ,    ,     Windows,   Vista,     ,   Microsoft     ‚Äî         Windows XP.<br>
&nbsp;<br>
<img src="https://pbs.twimg.com/media/C_y-PvxWAAENNoh.jpg" alt="image"><br>
&nbsp;</p><br>
<p>  <a href="https://habrahabr.ru/company/pentestit/blog/327490/"> ETERNALBLUE</a>   , ""  ShadowBrokers.      :  <a href="https://github.com/countercept/doublepulsar-detection-script/blob/master/detect_doublepulsar_smb.py">DoublePulsar</a>          ,   ETERNALBLUE.<br>
&nbsp;</p><br>
<img src="https://habrastorage.org/getpro/habr/post_images/399/9c7/eaa/3999c7eaa1cba4d0703ca4b7bd0bfdc0.png" alt="image"><br>
<p>&nbsp;<br>
           ,       .<br>
&nbsp;</p><br>
<img src="https://habrastorage.org/getpro/habr/post_images/837/35f/aa9/83735faa954a6a6b7284ad1b6cb35c14.png" alt="image"><br>
<p>&nbsp;<br>
        445  ‚Äî 3 :</p><br>
<img src="https://habrastorage.org/getpro/habr/post_images/42b/589/30d/42b58930d565a29dbea7953181d1a808.jpg" alt="image"><br>
<p>&nbsp;</p><br>
<h2></h2><br>
<p>        tLab,            .               ,       .         ,      .   ‚Äî  ,     <a href="http://tntsecure.kz/">T&amp;T Security</a>.</p><br>
<p> T&amp;T Security    2013   , .      10        .       -  . </p><br>
<p> 2017  T&amp;T Security       <a href="http://tntsecure.kz/tlab.html/">tLab </a>,              . tLab                SOC-,              .</p><br>
<p>    :</p><br>
<p> ‚Ññ1<br>
SHA256: 24d004a104d4d54034dbcffc2a4b19a11f39008a575aa614ea04703480b1022c<br>
<br>
 ‚Ññ2<br>
SHA256: ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa </p><br>
<p>tLab     - (   100%),     (85%  ) ‚Äî   ( ).     tLab.       /     ,   , , -  ..                 . </p><br>
<p>        (),     ,   ,       -.           .    ,      ,     -    .</p><br>
<img src="https://habrastorage.org/getpro/habr/post_images/9eb/44a/d28/9eb44ad282739ce4c9a7700b76743d95.png" alt="image"><br>
<p>&nbsp;</p><br>
<img src="https://habrastorage.org/getpro/habr/post_images/ac5/cd3/43d/ac5cd343d33cb06f905931af007c2939.png" alt="image"><br>
<p>&nbsp;<br>
      ,   100 -.     ,       ,      .       IP-   .      90       . -            ( ),     .             . </p><br>
<p>         ‚Äî .<br>
&nbsp;</p><br>
<img src="https://habrastorage.org/getpro/habr/post_images/168/f35/1e5/168f351e51b8043399644a4076aaeb73.png" alt="image"><br>
<p>&nbsp;</p><br>
<h3> </h3><br>
<p>         .               SMBv1,      IP-        445 (SMB).  20          60 000 IP-   .  ,          ,         .<br>
&nbsp;</p><br>
<img src="https://habrastorage.org/getpro/habr/post_images/26b/845/723/26b845723ef74a8c2b1dfe644e9d756d.png" alt="image"><br>
<p>&nbsp;<br>
      Tor.         443, 9101, 9102   IP-,     Tor.            :</p><br>
<ul>
<li>85.248.227.164:9002</li>
<li>194.109.206.212:443</li>
<li>217.79.190.25:9090</li>
<li>204.11.50.131:9001</li>
<li>95.183.48.12:443</li>
<li>171.25.193.9:80</li>
<li>195.154.164.243:443</li>
<li>131.188.40.189:443</li>
<li>5.9.159.14:9001</li>
<li>199.254.238.52:443</li>
<li>178.16.208.57:443</li>
<li>128.31.0.39:9101</li>
<li>154.35.175.225:443</li>
<li>163.172.35.247:443</li>
</ul><br>
<p>        ,      Tor.  ,     ": "       .          Tor  <a href="https://www.dan.me.uk/tornodes"> 7 000</a>.</p><br>
<h3>    </h3><br>
<p>  ,       ,      ‚Äútasksche.exe‚Äù,      .     ,      (‚Äúreg.exe‚Äù)      ,    :</p><br>
<pre><code>cmd.exe /c reg add hklm\software\microsoft\windows\currentversion\run /v "abzyckxcqecwnu394" /t reg_sz /d "\"c:\intel\abzyckxcqecwnu394\tasksche.exe\""</code></pre><br>
<p>    -,         .<br>
&nbsp;<br>
<img src="http://tntsecure.kz/images/content/articles/1/report-6.png" alt="image"><br>
&nbsp;<br>
 ‚Ññ1      ""   :</p><br>
<pre><code>c:\documents and settings\48=8ab@0b@\desktop\mapkep.bin
c:\intel\abzyckxcqecwnu394\tasksche.exe</code></pre><br>
<p>        ,      .<br>
&nbsp;<br>
<img src="http://tntsecure.kz/images/content/articles/1/report-7.png" alt="image"><br>
&nbsp;<br>
    ‚Äútasksche.exe‚Äù          ‚Äú@wanadecryptor@.exe‚Äù         ,    ,   ,       .     WNcry@2ol7.</p><br>
<p> @wanadecryptor@.exe</p><br>
<pre><code>c:\intel\abzyckxcqecwnu394\@wanadecryptor@.exe
c:\@wanadecryptor@.exe
c:\docs\@wanadecryptor@.exe
c:\docs\docs\@wanadecryptor@.exe
c:\documents and settings\default user\(01;=k\@wanadecryptor@.exe
c:\documents and settings\48=8ab@0b@\cookies\@wanadecryptor@.exe
c:\documents and settings\48=8ab@0b@\(01;=k\@wanadecryptor@.exe
c:\documents and settings\;l720b5;l\(01;=k\@wanadecryptor@.exe
c:\programms\@wanadecryptor@.exe
c:\programms\totalcmd\@wanadecryptor@.exe
c:\system volume information\_restore{1a1e1895-7822-43e9-a55a-8d2dc8b2dc2d}\@wanadecryptor@.exe
c:\system volume information\_restore{1a1e1895-7822-43e9-a55a-8d2dc8b2dc2d}\rp1\@wanadecryptor@.exe
c:\system volume information\_restore{1a1e1895-7822-43e9-a55a-8d2dc8b2dc2d}\rp2\@wanadecryptor@.exe
c:\system volume information\_restore{1a1e1895-7822-43e9-a55a-8d2dc8b2dc2d}\rp3\@wanadecryptor@.exe
c:\system volume information\_restore{1a1e1895-7822-43e9-a55a-8d2dc8b2dc2d}\rp4\@wanadecryptor@.exe
c:\temp\screener\@wanadecryptor@.exe
c:\documents and settings\all users\ 01g89 ab;\@wanadecryptor@.exe
c:\documents and settings\48=8ab@0b@\ 01g89 ab;\@wanadecryptor@.exe
c:\documents and settings\;l720b5;l\ 01g89 ab;\@wanadecryptor@.exe</code></pre><br>
<p>     .<br>
&nbsp;<br>
<img src="http://tntsecure.kz/images/content/articles/1/report-9.png" alt="image"><br>
&nbsp;<br>
 ‚Äú@wanadecryptor@.exe‚Äù      Tor-     ‚Äúc:\intel\abzyckxcqecwnu394\taskdata\tor\taskhsvc.exe‚Äù. </p><br>
<pre><code>c:\intel\abzyckxcqecwnu394\taskdata\tor\libeay32.dll                    
c:\intel\abzyckxcqecwnu394\taskdata\tor\libevent-2-0-5.dll                  
c:\intel\abzyckxcqecwnu394\taskdata\tor\libevent_core-2-0-5.dll             
c:\intel\abzyckxcqecwnu394\taskdata\tor\libevent_extra-2-0-5.dll                
c:\intel\abzyckxcqecwnu394\taskdata\tor\libgcc_s_sjlj-1.dll                 
c:\intel\abzyckxcqecwnu394\taskdata\tor\libssp-0.dll                        
c:\intel\abzyckxcqecwnu394\taskdata\tor\ssleay32.dll                    
c:\intel\abzyckxcqecwnu394\taskdata\tor\tor.exe                     
c:\intel\abzyckxcqecwnu394\taskdata\tor\zlib1.dll                       
c:\intel\abzyckxcqecwnu394\\taskdata\tor\taskhsvc.exe                   
c:\temp\screener\newwindows\@wanadecryptor@.exe                                 </code></pre><br>
<p> ,           Windows:</p><br>
<pre><code>cmd.exe /c vssadmin delete shadows /all /quiet &amp; wmic shadowcopy delete &amp; bcdedit /set {default} bootstatuspolicy ignoreallfailures &amp; bcdedit /set {default} recoveryenabled no &amp; wbadmin delete catalog -quiet</code></pre><br>
<p>     ,             .</p><br>
<h3>  </h3><br>
<p>  ,      ,       ,     -.     , -          (),    TOR ,         .           , ,  ,           .<br>
&nbsp;<br>
<img src="http://tntsecure.kz/images/content/articles/1/report-13.png" alt="image"><br>
&nbsp;<br>
            .             IOC (index of compromise,  ). </p><br>
<p>,   ,             ,  , ,  . </p><br>
<h2></h2><br>
<p>             .    ,        ,    .  ,     ,              . </p><br>
<hr><br>
<p> <a href="https://2017.pentestit.ru/">Pentestit Secuirty Conference</a>        ,      .</p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/328606/">https://habr.com/ru/post/328606/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328596/index.html">Geolocation in the smartphone - a new way to search for witnesses to road incidents</a></li>
<li><a href="../328598/index.html">WannaCry: analysis, indicators of compromise and recommendations for prevention</a></li>
<li><a href="../328600/index.html">Unusual application of the bot for Telegram and Telegram security check</a></li>
<li><a href="../328602/index.html">Digest: IaaS provider operation, SSL certificates, data center and our ‚ÄúFriday format‚Äù</a></li>
<li><a href="../328604/index.html">Migrating users and their privileges to MySQL</a></li>
<li><a href="../328608/index.html">Python PID Controller Model</a></li>
<li><a href="../328610/index.html">Can Laravel be used for large enterprise solutions?</a></li>
<li><a href="../328612/index.html">Your bot for a few hours, or talk about beer with the machine</a></li>
<li><a href="../328616/index.html">Who needs calls when there are chats and bots?</a></li>
<li><a href="../328620/index.html">Soft Mocks for Go! (redefinition of functions and methods in runtime)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>