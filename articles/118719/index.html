<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The script to create shortcuts remote control</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagine that you have a table with the names and addresses of devices and services and you can easily get a lot of shortcuts from it to launch a brows...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The script to create shortcuts remote control</h1><div class="post__text post__text-html js-mediator-article">  Imagine that you have a table with the names and addresses of devices and services and you can easily get a lot of shortcuts from it to launch a browser, putty, remote desktop or telnet to manage these devices.  The picture below shows schematically: <br><br><img src="https://habrastorage.org/storage/72ec2fc4/24136402/ab4df004/0f9c9183.png" alt="Here is a beautiful picture of how dry lines of a spreadsheet become miraculous labels."><br>  Why is it even needed?  For example, a new system has come to you for operation or inspection, or you have been given some test environment for use.  In order not to drive addresses or copy from a file every time you connect to hosts, you can run the script once and create all the shortcuts at once. <br><a name="habracut"></a><br>  The powershell script processes the CSV file, finds the columns ‚Äúname‚Äù, ‚Äúaddress‚Äù, ‚Äúdescription‚Äù, ‚Äúaccess‚Äù, creates shortcuts.  The command for the shortcut is formed based on the value ‚Äúaccess‚Äù (http, https, rdp, telnet), the arguments are from the value ‚Äúaddress‚Äù.  By the way, the ‚Äúaddress‚Äù may not be an IP address, but a host name, for example.  The field ‚Äúdescription‚Äù is added to the label comment.  You can also use shortname, address, method, and desc as field names.  (I think it is clear what is what).  The following parameters are accepted: <br><ul><li>  <b>source <i>&lt;file_source&gt;</i></b> : path to CSV file </li><li>  <b>folder <i>&lt;folder&gt;</i></b> : the path to the folder in which you want to create shortcuts </li><li>  <b>noreplace</b> : the parameter must be specified if the shortcuts were changed manually and you want to save these changes the next time you run the script </li><li>  <b>namePolicy <i>shortname |</i></b>  <b><i>shortname_addr |</i></b>  <b><i>addr_shortname |</i></b>  <b><i>shortname_lastoct |</i></b>  <b><i>shortname_last2octs</i></b> : a way to generate a name for a label.  As you can see, this is one of the options: the value of the column ‚Äúname‚Äù from the source file, the value ‚Äúname‚Äù + ‚Äúaddress‚Äù, ‚Äúaddress‚Äù + ‚Äúname‚Äù or ‚Äúname‚Äù with the addition of one or two last octets ‚Äúaddress‚Äù. </li></ul><br>  For example, like this: <br><pre><code class="hljs tex">PS C:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">temp</span></span></span></span>&gt;.<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">create</span></span></span></span>-shortcuts.ps1 -source MyNewFriends.csv -folder d:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">job</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">new</span></span></span></span> ‚Äìnoreplace ‚ÄìnamePolicy shortname_addr</code> </pre> <br>  By default, data is taken from the source.csv file in the current directory, shortcuts are also created in the current directory. <br>  Paths to putty and Internet Explorer are specified at the beginning of the script.  Of course, for all methods of connection, you can use any other program.  The main thing is to consider the parameter transfer method.  For example, in mstsc, the host name for the connection is transmitted not simply through a space, but as <b>/ v: <i>&lt;address&gt;</i></b> . <br>  Also, by itself, you can add other methods of connection.  Here you have to edit the <i>createShct</i> function, section <i>#Shortcut command</i> . <br>  Yes, if you are running the powershell script for the first time, do not forget to run: <br><pre> <code class="hljs pgsql">PS C:\<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>&gt;<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>-executionpolicy -executionpolicy unrestricted -scope currentuser</code> </pre> <br>  Here is the script itself: <br><pre> <code class="hljs mel">#################################################### # Remote access shortcuts creation script # v0<span class="hljs-number"><span class="hljs-number">.9</span></span> # # Defaults: # # * Create shortcuts <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> current directory # * Overwrite all shortcuts # * Shortcut name is <span class="hljs-string"><span class="hljs-string">"shortname"</span></span> column value # * Shortcut comment is <span class="hljs-string"><span class="hljs-string">"desc"</span></span> column value #################################################### #      #  <span class="hljs-number"><span class="hljs-number">0.9</span></span> # #  : # # *      # *    # *   ‚Äì  <span class="hljs-string"><span class="hljs-string">""</span></span> # *   -  <span class="hljs-string"><span class="hljs-string">""</span></span> #################################################### # Arguments param ( [<span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>]$noreplace, # <span class="hljs-string"><span class="hljs-string">'Do not overwrite shortcuts on creation'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> is to overwrite $folder = <span class="hljs-string"><span class="hljs-string">''</span></span>, # <span class="hljs-string"><span class="hljs-string">'Target folder path'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> is current dir $source = <span class="hljs-string"><span class="hljs-string">'source.csv'</span></span>, # <span class="hljs-string"><span class="hljs-string">'Source data file path'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> $namePolicy = <span class="hljs-string"><span class="hljs-string">'shortname'</span></span> # <span class="hljs-string"><span class="hljs-string">'Shortcut naming policy'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> ) $csvPath = $source # Source data <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> path $shPath = $folder # Target folder path $shNoReplace = $noreplace # Do not overwrite shortcuts on creation $shHTTPcmd = <span class="hljs-string"><span class="hljs-string">'"C:\Program Files\Internet Explorer\iexplore.exe"'</span></span> $shRDPcmd = <span class="hljs-string"><span class="hljs-string">'mstsc.exe'</span></span> $shSSHcmd = <span class="hljs-string"><span class="hljs-string">'"C:\Program Files\PuTTY\putty.exe"'</span></span> $shTELNETcmd = <span class="hljs-string"><span class="hljs-string">'telnet.exe'</span></span> $shNamePolicy = $namepolicy # Shortcut naming policy function createShctFile($shText,$shCmd,$shArgs, $desc = <span class="hljs-string"><span class="hljs-string">''</span></span>) { # creating shortcut <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> $shPathSh = <span class="hljs-string"><span class="hljs-string">"$shPath\$shText.lnk"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (test-path -path $shPathSh) -and $shNoReplace ) {<span class="hljs-keyword"><span class="hljs-keyword">return</span></span>} $shct = $oshell.CreateShortcut($shPathSh) $shct.TargetPath = $shCmd $shct.Arguments = $shArgs $shct.Description = $desc $shct.Save() } function createShct($shortname,$desc=<span class="hljs-string"><span class="hljs-string">''</span></span>,$addr,$method) { # preparing shortcurt parameters # Shortcut name $shText = $shortname <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$shortname) { write-host <span class="hljs-string"><span class="hljs-string">'(i) No shortcut name defined'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> ($shNamePolicy) { <span class="hljs-string"><span class="hljs-string">'shortname'</span></span> { $shText = $shortname } <span class="hljs-string"><span class="hljs-string">'shortname_addr'</span></span> { $shText = <span class="hljs-string"><span class="hljs-string">"$shortname $addr"</span></span> } <span class="hljs-string"><span class="hljs-string">'addr_shortname'</span></span> { $shText = <span class="hljs-string"><span class="hljs-string">"$addr $shortname"</span></span> } <span class="hljs-string"><span class="hljs-string">'shortname_lastoct'</span></span> { $octs = ($addr -split <span class="hljs-string"><span class="hljs-string">'\.'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($octs[<span class="hljs-number"><span class="hljs-number">3</span></span>]) {$shText += <span class="hljs-string"><span class="hljs-string">' '</span></span> + $octs[<span class="hljs-number"><span class="hljs-number">3</span></span>]} } <span class="hljs-string"><span class="hljs-string">'shortname_last2octs'</span></span> { $octs = ($addr -split <span class="hljs-string"><span class="hljs-string">'\.'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($octs[<span class="hljs-number"><span class="hljs-number">3</span></span>]) {$shText += <span class="hljs-string"><span class="hljs-string">' '</span></span> + $octs[<span class="hljs-number"><span class="hljs-number">2</span></span>]+ <span class="hljs-string"><span class="hljs-string">'.'</span></span> + $octs[<span class="hljs-number"><span class="hljs-number">3</span></span>]} } } #Shortcut command $shArgs = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> ($method) { <span class="hljs-string"><span class="hljs-string">'http'</span></span> { $shCmd = $shHTTPCmd $shArgs = <span class="hljs-string"><span class="hljs-string">"http://$addr"</span></span> } <span class="hljs-string"><span class="hljs-string">'https'</span></span> { $shCmd = $shHTTPCmd $shArgs = <span class="hljs-string"><span class="hljs-string">"https://$addr"</span></span> } <span class="hljs-string"><span class="hljs-string">'rdp'</span></span> { $shCmd = $shRDPCmd $shArgs = <span class="hljs-string"><span class="hljs-string">"/v:$addr"</span></span> } <span class="hljs-string"><span class="hljs-string">'ssh'</span></span> { $shCmd = $shSSHcmd $shArgs = $addr } <span class="hljs-string"><span class="hljs-string">'telnet'</span></span> { $shCmd = $shTELNETcmd $shArgs = $addr } } createShctFile -shText $shText -shCmd $shCmd -shArgs $shArgs -desc $desc } ##### Main # Init $oshell = New-Object -comObject WScript.Shell $basePath = (get-location).path # Working dir [System.IO.Directory]::SetCurrentDirectory($basePath) # Set working dir to script working dir # Env check <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(test-path -pathtype leaf -path $csvPath)) { # Cheking <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">source</span></span> CSV path write-host <span class="hljs-string"><span class="hljs-string">"(!) Path to source CSV not found: $csvPath"</span></span> exit } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!($shPath)) {$shPath = $basePath } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(test-path -pathtype <span class="hljs-keyword"><span class="hljs-keyword">container</span></span> -path $shPath)) { # Cheking <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> target folder path write-host <span class="hljs-string"><span class="hljs-string">"(!) Path for shortcuts not found: $shPath"</span></span> exit } # Run $csv = get-content $csvPath | Convertfrom-CSV -UseCulture foreach ($str <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $csv) { $shrt = $str.shortname <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($str.) {$shrt = $str.} $addr = $str.addr <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($str.) {$addr = $str.} $accs = $str.method <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($str.) {$accs = $str.} $desc = $str.desc <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($str.) {$desc = $str.} createShct -shortname $shrt -desc $desc -addr $addr -method $accs }</code> </pre></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/118719/">https://habr.com/ru/post/118719/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../118710/index.html">Electronic textbooks are worse remembered</a></li>
<li><a href="../118711/index.html">Call order in the app store. Changing application rating mechanisms</a></li>
<li><a href="../118713/index.html">JQuery 1.6 Innovations</a></li>
<li><a href="../118715/index.html">Do you check your HTML validator?</a></li>
<li><a href="../118716/index.html">Who is faster: memset, bzero or std :: fill</a></li>
<li><a href="../118720/index.html">Google I / O Extended in the CIS</a></li>
<li><a href="../118721/index.html">CoffeeScript in Business - Five Things You Can Do with JavaScript</a></li>
<li><a href="../118723/index.html">Yandex.Money users to note</a></li>
<li><a href="../118725/index.html">Don't listen to them</a></li>
<li><a href="../118727/index.html">Magic gel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>