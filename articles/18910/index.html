<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Getting text from .doc. How to do it better?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I got a small task in front of me - to work with various files in which careless users send information about themselves. Having started, with collect...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Getting text from .doc. How to do it better?</h1><div class="post__text post__text-html js-mediator-article">  I got a small task in front of me - to work with various files in which careless users send information about themselves.  Having started, with collecting statistics, I saw a terrible picture - who erase what is in that much.  Send everything you can.  Starting from simple text files <i>(thank Gods, there are adequate people in the world)</i> and ending with PowerPoint or Flash presentations <i>(and I didn‚Äôt believe in such people until I saw it myself)</i> .  I, if not a fool, naturally decided to bring all this diversity to a single form, providing the possibility of human-machine processing.  Without hesitation, I chose the good old html. <br>  Various presentations and pictures were eliminated from the algorithm almost immediately - there is not much sense to make a garden, the benefit is not so often that these wonderful creations of creativeness come across.  Handling is not as problematic as the main thread.  Text, html, etc.  files, in connection with the choice of a single format, could not affect.  But with other common formats, of course, I had to tinker. <br><br><a name="habracut"></a>  As a result of a brief search, the <b>wv</b> package was found in the repositories - a set of utilities for converting from .doc <i>(the manual reports the possibility of converting from Word 2000, Word 97, Word 95, and Word 6. As well as limited support for earlier formats.) To</i> html , rtf, LaTeX.  The quality of its conversion, judging by the experiments, is not the best - the formatting was somewhat disturbed though.  Fortunately, the task of preserving the formatting did not work for me and I started using these utilities with a clear conscience - they pulled out the text itself completely and almost <i>(about this below)</i> without errors. <br><br>  Also, for several other common formats, the corresponding utilities were used (unrtf, unzip, unrar, etc.) I did not encounter difficulties with them, and therefore I don‚Äôt even have anything to tell about them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's go back to the doc files.  As I have already mentioned, the conversion is going on quite well, if not for one problem that spoiled my nerves a lot.  I will tell about it in more detail.  After conversion to html, other scripts are set on the text, which process the text, breaking it up into words, searching for code phrases and performing other useful work, using regular expressions.  Everything worked fine on other files, but the text obtained from .doc was stubbornly processed with errors ‚Äî it counts two words for one, it does not recognize the code phrase.  The initial error is insignificant, but to find it, I had to run up to a wall three times.  Its essence boils down to the fact that in the cp1251 encoding, in which I processed these files, there is one character that is hardly used in everyday life.  This is a space.  Code number 160 (A0 in hexadecimal codes).  It was about him that regular expressions were broken, considering him not to be a whitespace symbol, but the most printed one.  Fortunately, I understood what was the reason before the thought occurred to me to drown myself in an office coffee maker. <br><br>  On this I finish the story of my adventures.  If this topic is interesting, I will write about my further torment. <br><br>  <b>PS</b> Most importantly.  Being confident in my own incompetence, I want to find out from readers - perhaps there are more humane ways of getting text from Vord files that I don‚Äôt know about?  I would also be grateful if I would learn about the ways of converting from other formats that may contain text, but are not decoded from a bay.  For example, the same flash.  Surely there are ways. <br></div><p>Source: <a href="https://habr.com/ru/post/18910/">https://habr.com/ru/post/18910/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../189084/index.html">Promises in AngularJS</a></li>
<li><a href="../189086/index.html">Basics of IIS architecture, or query pipeline for ASP.NET</a></li>
<li><a href="../189090/index.html">Airconsole. Connecting to the Cisco Console port via WiFi</a></li>
<li><a href="../189094/index.html">About Bob Martin's Clean Code Book</a></li>
<li><a href="../189098/index.html">Meet Apache Mahout</a></li>
<li><a href="../189106/index.html">CoH2, learn from the mistakes of others</a></li>
<li><a href="../18911/index.html">Opera leads 3DNews</a></li>
<li><a href="../189110/index.html">ioTurbine: improving the performance of virtualization systems</a></li>
<li><a href="../189112/index.html">Studio gamification with the help of available tools</a></li>
<li><a href="../189118/index.html">CSS problems. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>