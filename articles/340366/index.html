<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What and why is Docker doing in Moby to integrate with Kubernetes?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yesterday‚Äôs official Docker official Kubernetes announcement in their products is an ideal reason to continue one of our latest publications on CRI-O ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What and why is Docker doing in Moby to integrate with Kubernetes?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/59/e6/df/59e6df096660c025635440.png"><br><br>  Yesterday‚Äôs official <b>Docker</b> official <b>Kubernetes</b> <a href="https://blog.docker.com/2017/10/kubernetes-docker-platform-and-moby-project/">announcement</a> in their products is an ideal reason to continue one of our latest publications on <a href="https://habrahabr.ru/company/flant/blog/340010/">CRI-O</a> as an alternative approach to launching containers in Kubernetes.  It has already touched on the topic of cri-containerd - a kind of ‚ÄúDocker response‚Äù to the attempts of the Open Source-community to get away from the sole supplier of technology for containers.  What caused the new turn in the life of Docker and how its pattern is confirmed in the recent history of Moby projects? <a name="habracut"></a><br><br><h2>  Freedom of choice: from Kubernetes and from Docker </h2><br>  Kubernetes as PaaS for working with containers was originally created with the idea of ‚Äã‚Äãgiving its users the freedom to choose the implementations of certain functions of the platform.  <i>(For more on this and why Kubernetes is more than PaaS, we wrote in a <a href="https://habrahabr.ru/company/flant/blog/327338/">separate article</a> .) The</i> technology used to launch containers is one example of such implementations.  Since the <b>Open Source-world of containers is not limited to Docker</b> , for a long time now Kubernetes has the <a href="https://kubernetes.io/docs/getting-started-guides/rkt/">ability to use rkt</a> as an executable environment for containers.  Yes, by and large such an opportunity appeared due to the efforts (and in the interests) of one particular company - CoreOS - but from this year rkt has been included in the number of projects supported by the non-profit organization CNCF, as well as its competitor from Docker - <a href="https://habrahabr.ru/company/flant/blog/325358/">containerd</a> <i>(and Kubernetes develops in the same fund)</i> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      However, by default Kubernetes is still not using rkt at all, but the de facto standard in the industry - Docker.  The very desire to provide users with flexibility, ‚Äúunited‚Äù with the interests of some companies, led the project to further expand the choice of executable media through the <b>creation of the <a href="">Container Runtime Interface (CRI)</a></b> - it appeared with the release of Kubernetes 1.5. <br><br>  With the help of CRI, the ‚Äúconnection‚Äù of new container technologies has become unified and simple, and for the first time this was demonstrated in the framework of the <a href="http://cri-o.io/">CRI-O</a> project, which we <a href="https://habrahabr.ru/company/flant/blog/340010/">wrote about</a> in more detail last week.  Formally, <b>CRI-O</b> allows you to use any executable environment for containers that is compatible with the OCI specification <i>( <a href="https://github.com/opencontainers/runtime-spec/">runtime-spec</a> )</i> , and in fact today supports the well-known runC <i>(the project separated from Docker in 2015 and which became the reference implementation of the OCI standard)</i> and Clear Containers <i>(from Intel)</i> . <br><br>  <a href="https://blog.docker.com/2017/10/kubernetes-docker-platform-and-moby-project/">In announcing the</a> support of Kubernetes, Docker emphasized that "the Docker architecture philosophy has always been about <b>providing choice and flexibility</b> ."  So they officially explained the appearance of the Kubernetes block in their platform, illustrated by 4 layers: <br><br><img src="https://habrastorage.org/webt/59/e6/da/59e6da1e8e30f685686004.png"><br><br>  The layers of the platform are explained as follows (from bottom to top): <br><br><ol><li>  <b>containerd</b> as an executable environment for containers that meets the industry standard; </li><li>  <b>Swarm orchestration</b> that turns a group of nodes into a distributed system; </li><li>  <b>Docker Community Edition</b> , offering developers a simple workflow for creating and delivering applications in containers; </li><li>  <b>Docker Enterprise Edition</b> to manage the full cycle of secure software delivery and container launch in production. </li></ol><br>  And the point ‚ÄúSwarm orchestration‚Äù is now formulated as ‚ÄúSwarm or Kubernetes orchestration‚Äù, and later (who knows?) Can be extended to other solutions. <br><br>  In the official announcement of the company, another reason for integrating Kubernetes support into the Docker platform, the <b>wishes of its customers,</b> was announced.  Docker users "either have already designed services to work on Kubernetes, or want Kubernetes because of the specific features they need."  If you look at the situation more objectively, it is obvious that Kubernetes, like Docker at one time, is becoming an ‚Äúindustry standard‚Äù.  And since end users choose the orchestration tool rather than the specific underlying container technology, the <b>only option to keep (and expand) the audience</b> for Docker is to meet the needs of the industry itself.  What are the market prospects for the direct competitor Kubernetes, which is being developed within Docker - Swarm, is a question that remains open and should be clarified in the near future by company policy. <br><br><h2>  Moby and Kubernetes </h2><br>  All layers of the Docker platform are collected using the special Open Source-project <a href="http://mobyproject.org/">Moby</a> , about which we <a href="https://habrahabr.ru/company/flant/blog/329136/">also wrote more</a> . <br><br><img src="https://habrastorage.org/webt/59/e6/de/59e6de458faf6018761907.png"><br><br>  In short, with his help, Docker seeks to maintain its leadership in the ecosystem of containers, promoting it in the community as a standard for "building systems based on containers."  Formally, <b>Moby also represents all upstream projects</b> used to build the Docker platform.  <i>(In total, they account for an average of 8800 pull requests per year.)</i> <br><br>  <a href="https://blog.mobyproject.org/moby-and-kubernetes-bf888ab31e38">Talking</a> about the participation of Moby in the announced support for Kubernetes for Docker, the authors begin by saying that these works did not begin yesterday, but <b>have been underway for about a year</b> .  And the main events are presented as follows: <br><br><img src="https://habrastorage.org/webt/59/e6/e0/59e6e0e04dcd1012157201.png"><br><br>  Details about the ‚Äúclose relationship‚Äù of Moby and Kubernetes <a href="http://mobyproject.org/kubernetes/">are given</a> on the example of some projects that form the Docker platform and not only. <br><br><h3>  containerd </h3><br>  In the past, <a href="https://github.com/containerd/containerd">containerd</a> is a Docker component that implements the runtime environment for running containers: <br><br><img src="https://habrastorage.org/files/0e4/f31/688/0e4f3168824a4e5fbceb6f5ce88ef024.png" alt="image"><br><br>  As in the case of runC, he suffered the fate of separation from Docker as an independent Open Source project (earlier this year he was transferred to the CNCF foundation).  Its current version is <a href="https://github.com/containerd/containerd/releases">1.0.0-beta.2</a> , and the final release 1.0.0 should happen very soon.  Being one of the basic components of Docker, the project seeks to gain wider recognition, and <a href="https://github.com/kubernetes-incubator/cri-containerd"><b>cri-containerd</b></a> <i>(initiated in April of this year) has</i> become one of the main initiatives aimed at its distribution. <br><br>  Being one of the first implementations of the already mentioned Kubernetes CRI interface, cri-containerd claims to become a popular solution for launching containers into Kubernetes in an era when the ‚Äúheavy‚Äù Docker will not be the default option for K8s users.  The current status is the alpha version, which has the full range of capabilities and is undergoing the ‚Äúfinal stabilization process‚Äù.  On September 14, Liu Lantao from Google <a href="https://www.slideshare.net/Docker/kubernetes-cri-containerd-integration-by-lantao-liu-google">told</a> the Moby Summit in Los Angeles about the state of cri-containerd, noting that the project "very well" meets the requirements of CRI and Kubernetes, and also promised to release a beta version by the end of the year. <br><br>  Here's how the participation pattern for containerd in Kubernetes will change with cri-containerd: <br><img src="https://habrastorage.org/webt/59/e6/f4/59e6f403b849b481773889.png"><br>  <i>Note to illustration: <a href="https://github.com/kubernetes/kubernetes/tree/master/pkg/kubelet/dockershim">dockershim</a> is the current implementation of runtime for Docker containers in K8s.</i> <br><br>  More detailed scheme of work cri-containerd: <br><img src="https://habrastorage.org/webt/59/e6/f4/59e6f4b78efd8120710203.png"><br>  You can try cri-containerd in action using various instructions: <br><br><ul><li>  <a href="">quick start with Ansible</a> ; </li><li>  <a href="">installation via kubeadm</a> ; </li><li>  <a href="https://github.com/linuxkit/linuxkit/tree/master/projects/kubernetes">Installing from LinuxKit on a local virtual machine</a> <i>(see below for more details)</i> . </li></ul><br><h3>  Linukit </h3><br>  <a href="https://github.com/linuxkit/linuxkit">LinuxKit</a> is a utility <a href="https://blog.docker.com/2017/04/introducing-linuxkit-container-os-toolkit/">announced</a> simultaneously with Moby for building compact Linux systems for containers.  As detailed in the project description, LinuxKit "is designed to build and run clustered applications using container orchestration tools, such as Docker or Kubernetes, but not limited to them." <br><br>  The project documentation contains the article ‚Äú <a href="https://github.com/linuxkit/linuxkit/tree/master/projects/kubernetes">Kubernetes and LinuxKit</a> ‚Äù, describing the creation of minimal OS images with Kubernetes.  By default, the Docker Engine installed in these K8s images is used, and to go to cri-containerd, it is enough to add one command during the build process. <br><br><h3>  InfraKit </h3><br>  <a href="https://github.com/docker/infrakit">InfraKit</a> is a set of utilities for infrastructure orchestration, designed to make it "self-managing and self-healing."  Technically, the project consists of a set of small controllers, called plug-ins and implementing various interfaces (Service Provider Interfaces, SPI ‚Äî see the <a href="">documentation</a> for details).  One of these interfaces, the Flavor SPI, is responsible for application-specific configurations and for checking its state.  Examples of plug-ins like Flavor are Swarm and Kubernetes, which are responsible for checking the presence of a node in the cluster, suspending the reception of tasks by the node from the scheduler, etc. <br><br>  The documentation for the Kubernetes plugin in InfraKit was recently summarized in <a href="">this README</a> .  Also available is a <a href="https://www.youtube.com/watch%3Fv%3DHdL4Wwrwcm8">17-minute video</a> from the lead developer of the project (David Chung) with a demonstration of the launch of the Kubernetes cluster on AWS using InfraKit and AWS CloudFormation.  The bootstrap node performs a long sequence of actions from installing the latest version of the Docker Engine to updating labels to mount and format volumes.  The download script is generated by the InfraKit plug-ins and templates. <br><br><h3>  libnetwork </h3><br>  <a href="https://github.com/docker/libnetwork">libnetwork</a> is the implementation of the Container Network Model (CNM) network interface for containers used in Docker.  CNM is essentially a direct competitor to the Container Networking Interface (CNI), as we wrote in <a href="https://habrahabr.ru/company/flant/blog/329830/">this article</a> .  Kubernetes has become one of the early users of CNI, inviting everyone who intends to develop their network interfaces to do this with plug-ins to CNI, which already connect to Kubernetes. <br><br><img src="https://habrastorage.org/webt/59/e7/0a/59e70a54cbb2c343527428.png"><br>  <i><a href="https://medium.com/cri-o/understanding-container-standards-1e1448cbb92c">Speaking</a> about container standards last month, Scott McCarty from Red Hat called CNM a ‚Äúde facto standard‚Äù because ‚Äúmany network solutions vendors create utilities that are suitable for both CNI and CNM‚Äù.</i> <br><br>  Once in Docker, they intend to stay with CNM instead of CNI, what option is left for them to integrate with Kubernetes?  That's right, <a href="https://github.com/docker/libnetwork/pull/1978">make</a> CNI <a href="https://github.com/docker/libnetwork/pull/1978">plugins</a> that implement libnetwork support.  The process has already been launched, but has not yet entered the master branch. <br><br>  It is gratifying to see Docker‚Äôs example of ‚Äúgoing in the opposite direction‚Äù - for the benefit of all users of the upstream version of Kubernetes: the alpha version of IPVS support for load balancing introduced in <a href="https://habrahabr.ru/company/flant/blog/338230/">K8s 1.8</a> was based on the code from libnetwork, originally written for Docker Swarm . <br><br><h3>  Notary </h3><br>  <a href="https://github.com/docker/notary">Notary</a> is a Docker project for signing and verifying containers, based on the developments of <a href="https://github.com/theupdateframework/tuf">The Update Framework (TUF)</a> and written in Go <i>(instead of Python with TUF)</i> .  Earlier this month, a <a href="https://lists.cncf.io/pipermail/cncf-toc/2017-October/001251.html">vote</a> was initiated on the inclusion of Notary and TUF in the incubator of the CNCF projects.  Many representatives of the committee from the fund have already supported him, but the final decision has not yet been made.  Notary still has no formal binding to K8s, but Docker expects that after its adoption at the CNCF, "direct integration with other CNCF projects such as Kubernetes will be implemented." <br><br>
<h3>  libentitlement </h3><br>  The <a href="https://github.com/docker/libentitlement">libentitlement</a> library <a href="https://github.com/docker/libentitlement">is</a> intended for high-level rights management in containers.  The so-called entitlements allow / prohibit various security functions in the configuration profile, and the library is designed to manage these profiles for containers.  A list of proposed for implementation of the entitlements can be found <a href="https://github.com/moby/moby/issues/32801">here</a> . <br><br>  The project is still young - the first commit in its repository took place in May.  According to Docker, the development of libentitlement is carried out with the participation of the Kubernetes community.  The project documentation contains the list of default entitlements for Kubernetes, however at the moment there is only the promising ‚ÄúTBD‚Äù. <br><br><h2>  Summarizing </h2><br>  The world of containers has become an interesting place for competition and simultaneous cooperation of Open Source-projects and the companies behind them. <br><br>  Even without having Kubernetes among the orchestration tools integrated into the Docker platform, the engineers of this company have for some time been working on projects specifically targeted at K8s or closely intertwined with its ecosystem. <br><br>  The formal announcement of Kubernetes support is a significant and pleasant event for the community, confirming the company's words about freedom of choice.  For Docker itself, this is largely a <a href="https://mesosphere.com/blog/kubernetes-dcos/">necessary</a> measure, similar to the recent similar <a href="https://mesosphere.com/blog/kubernetes-dcos/">case with the Mesosphere</a> . <br><br>  <i>Some details about what Kubernetes‚Äôs notorious end-user support for Docker products means can be found in the relevant company blog posts: <a href="https://blog.docker.com/2017/10/docker-for-mac-and-windows-with-kubernetes-beta/">Docker CE for Mac and Windows</a> , <a href="https://blog.docker.com/2017/10/docker-enterprise-edition-kubernetes/">Docker EE</a> .</i> <br><br><h2>  PS </h2><br>  Read also in our blog: <br><br><ul><li>  " <a href="https://habrahabr.ru/company/flant/blog/340010/">CRI-O - Docker alternative to launch containers in Kubernetes</a> "; </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/329136/">What is the essence of the Moby project and why did the main Docker repository suddenly become moby / moby?</a>  "; </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/325358/">Why do you need containerd and why it was separated from Docker</a> ‚Äù; </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/327338/">Why do you need Kubernetes and why is it more than PaaS?</a>  " </li></ul></div><p>Source: <a href="https://habr.com/ru/post/340366/">https://habr.com/ru/post/340366/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340356/index.html">The global consequences of a single mistake in Quagga</a></li>
<li><a href="../340358/index.html">Business correspondence in English: phrases and tips</a></li>
<li><a href="../340360/index.html">Non-Standard Clustering 5: Growing Neural Gas</a></li>
<li><a href="../340362/index.html">Adding records with OAuth 2: Laravel Passport + Unity. Part 2</a></li>
<li><a href="../340364/index.html">Character solution of nonlinear programming problems</a></li>
<li><a href="../340368/index.html">Russian laws on new spheres: entertaining facts, or why a dead end is crying</a></li>
<li><a href="../340370/index.html">You fired the most talented employee. I hope you are happy now</a></li>
<li><a href="../340372/index.html">Why SQL prevails over NoSQL, and where it will lead in the future</a></li>
<li><a href="../340374/index.html">Avoiding unnecessary meetings or for the hundredth time about meetings</a></li>
<li><a href="../340376/index.html">Killerphic in vim - these are the modes? Seriously?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>