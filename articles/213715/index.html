<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Computer control without hands (a gyro in my head!)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous article, I described how you can control a computer with your eyes. Despite the fact that in some cases tracking the position of the p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Computer control without hands (a gyro in my head!)</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d30/633/567/d30633567ab483908978318adb5e5789.gif"></div><br><br>  In the <a href="https://habr.com/post/208108/">previous article,</a> I described how you can control a computer with your eyes.  Despite the fact that in some cases tracking the position of the pupils (eye gaze tracking) is the only way to provide a sick person with the opportunity to communicate with the outside world, the system described earlier is not without flaws.  First of all, it is the need to use components that are difficult to purchase in Russia.  In addition, a person with glasses has to severely limit the position of the head in order to minimize the parasitic glare on the surface of the glasses and to achieve a stable system operation. <br>  Is it possible to use something simpler and more reliable if a person is able to move his head, but has difficulty working with his hands? <br><a name="habracut"></a><br>  <b>- = Update January 2019 = -</b> <br>  The <b>Upvel UM-510KB</b> remote control described in the article is no longer possible to buy, but instead you can use this scheme assembled from the <b>Arduino Leonardo</b> and the <b>GY-521</b> module with the <b>MPU-6050</b> gyroscope / accelerometer to track the head rotation. <br><br><img src="https://habrastorage.org/webt/sd/2p/je/sd2pjeiqyeumacgufns_zsqqs20.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Arduino Leonardo and GY-521 are connected by four wires.  If possible, solder them. <br>  I got this prototype.  Naturally, in an amicable way, all this should be ennobled / placed in the body. <br><br><table><tbody><tr><td><img src="https://habrastorage.org/webt/f_/pv/qe/f_pvqeczqnfe55fhckxctt6exai.jpeg"><br></td><td><img src="https://habrastorage.org/webt/44/k8/_n/44k8_n7oafhwmf76n0xrdyx13-q.jpeg"><br></td></tr></tbody></table><br><br>  The program (sketch) that needs to be loaded into the Arduino looks like this: <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"I2Cdev.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"MPU6050_6Axis_MotionApps20.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Wire.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Mouse.h&gt; MPU6050 mpu; uint16_t packetSize; // expected DMP packet size (default is 42 bytes) uint16_t fifoCount; // count of all bytes currently in FIFO uint8_t fifoBuffer[64]; // FIFO storage buffer // orientation/motion vars Quaternion q; // [w, x, y, z] quaternion container VectorFloat gravity; // [x, y, z] gravity vector float ypr[3]; // [yaw, pitch, roll] yaw/pitch/roll container and gravity vector //   float old_mx=-200; float old_my=-200; float dx,dy,mx,my; // ================================================================ // === INITIAL SETUP === // ================================================================ void setup() { Wire.begin(); Wire.setClock(400000); // 400kHz I2C clock. Comment this line if having compilation difficulties mpu.initialize(); mpu.dmpInitialize(); mpu.setDMPEnabled(true); packetSize = mpu.dmpGetFIFOPacketSize(); } // ================================================================ // === MAIN PROGRAM LOOP === // ================================================================ void loop() { // wait for MPU interrupt or extra packet(s) available while (fifoCount &lt; packetSize) { fifoCount = mpu.getFIFOCount(); } // check for overflow (this should never happen unless our code is too inefficient) if ( fifoCount &gt;= 1024) { // reset so we can continue cleanly mpu.resetFIFO(); fifoCount = mpu.getFIFOCount(); // otherwise, check for DMP data ready interrupt (this should happen frequently) } else { // wait for correct available data length, should be a VERY short wait while (fifoCount &lt; packetSize) fifoCount = mpu.getFIFOCount(); // read a packet from FIFO mpu.getFIFOBytes(fifoBuffer, packetSize); // track FIFO count here in case there is &gt; 1 packet available // (this lets us immediately read more without waiting for an interrupt) fifoCount -= packetSize; //   mpu.dmpGetQuaternion(&amp;q, fifoBuffer); mpu.dmpGetGravity(&amp;gravity, &amp;q); mpu.dmpGetYawPitchRoll(ypr, &amp;q, &amp;gravity); // ypr[0] -  X, ypr[1] -  Y, Y -  mx=ypr[0] * 180/M_PI; my=ypr[1] * 180/M_PI; if(old_mx&gt;-200) //     { if((old_mx&lt;-100)&amp;&amp;(mx&gt;100)) { dx=(-180-old_mx)+(mx-180); } else if((old_mx&gt;100)&amp;&amp;(mx&lt;-100)) { dx=(180-old_mx)+(180+mx); } else { dx=mx-old_mx; } dy=my-old_my; Mouse.move(2000/60*dx, -1000/30*dy); } old_mx=mx; old_my=my; } }</span></span></span></span></code> </pre> <br><br>  To compile the sketch you also need to download the libraries I2Cdev and MPU6050.  You can get them from here: <a href="https://github.com/jrowberg/i2cdevlib/tree/master/Arduino">github.com/jrowberg/i2cdevlib/tree/master/Arduino</a> <br>  After downloading the sketch, the assembled device acts in the same way as the console from the article.  That is, you change the orientation of the device in space, and the mouse cursor on the screen moves. <br><br>  <b>- = next - the original article = -</b> <br>  Is it possible to use something simpler and more reliable if a person is able to move his head, but has difficulty working with his hands? <br><br>  Of course, such funds exist.  First of all, these are programs that use a regular webcam to monitor head rotation and some other actions, such as blinking eyes and lip movements (read about them below, in the section " <b>Is the game worth the candle?</b> "). <br><br><img align="right" src="https://habrastorage.org/getpro/habr/post_images/267/129/263/267129263cdcf6962f5acfb9a5b10b4e.gif"><br>  In addition, specialized devices are also being produced, which are also <b>cameras that monitor markers that glow brightly in the infrared range</b> .  Markers are attached somewhere in the head area, for example, on the rim of glasses, cap, headset.  Sometimes they even recommend sticking a marker on the forehead. <br><br>  Various firms that previously manufactured this type of device gradually gathered under the wing of <a href="http://www.naturalpoint.com/">NaturalPoint</a> .  And now they have on the site you can find devices that previously competed, and now they just divide different market segments.  For example, the simpler version ( <a href="http://www.naturalpoint.com/trackir/">TrackIR</a> ) they offer for gamers, and more expensive ( <a href="http://www.naturalpoint.com/smartnav/">SmartNav</a> ) - for working at the computer. <br><br>  And without that, an expensive <a href="http://www.naturalpoint.com/smartnav/">SmartNav</a> ($ 500) becomes just gold when you try to buy it in Russia.  Therefore, an idea arose to create something that could position the cursor on a computer screen just as well, but it would be more accessible. <br><br><img align="right" src="https://habrastorage.org/getpro/habr/post_images/b22/3d0/80e/b223d080e6d33e8ad022b8c16b741920.gif"><br>  At first, I wanted to use the same principle of work: markers, lights, image processing.  But thoughts came about direct measurements.  Up to attaching an <b>electronic caliper</b> to the head (almost a joke). <br><br>  As it turned out later, such devices really exist! <br><br>  Look here at <a href="http://www.jouse.com/jouse3/home">this engineering marvel</a> - a lever that you need to keep your mouth, and control his head movements! <br><br>  Suddenly, the idea was to use a [electronic] gyroscope.  They have recently become available and very accurate.  Finished devices such as "air mouse", however, did not receive much distribution.  For example, the <b>Logitech MX Air</b> mouse is already out of production, apparently due to a lack of demand. <br><br>  There are programs for smartphones (both iPhone and Android) that allow you to use them as aerial masks, using the gyros built into them.  But I didn‚Äôt explore this question deeply, because, above all, I was interested in a cheap solution. <br><br>  Finally, multimedia consoles for TVs that also use the built-in gyroscope came into view.  Some of them work with a regular computer; you just need to insert the adapter into the USB-socket.  Data transmission occurs over the air, that is, the direct view of the console is not required, as is the case with infrared transceivers. <br><br>  The console is fixed on the head, and when it is turned, the mouse cursor on the screen moves (as in Cheburashka in the title of the article).  It remains only to deal with mouse clicks and a virtual keyboard.  For these purposes, I wrote <a href="https://github.com/MastaLomaster/bkb">my program</a> . <br><br>  The difficulty is the following: the consoles ‚Äúfall asleep‚Äù after a certain period of inactivity, and they need to be awakened by pressing a button, which can be difficult for the person using them. <br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/53d/0b5/d86/53d0b5d86313f9eac0a2eb5660eb40a1.jpg"><br><br>  I had to put on a series of experiments - to clamp one of the buttons on the keyboard and leave the remote control idle, hoping that the pressed button would not allow the remote to fall asleep.  Moreover, the button had to be clamped with a clothespin, and not with a hand, since the hand could transmit small movements to the console.  Buttons could be pressed only those that are not used in Windows. <br>  Some consoles could not be defeated, but in the end the <b>Upvel UM-510KB</b> was found, which is guaranteed not to fall asleep while holding a pair of buttons. <br><br><img align="right" src="https://habrastorage.org/getpro/habr/post_images/34e/dc4/e02/34edc4e02decfa5434c1e721e29d8784.jpg"><br><br>  If you open this remote, you can find the STM8L-151 microcontroller from STMicroelectronics (1), the Invensense MPU-3050c three-axis gyroscope (2), and some other nameless chip (3) for communicating with a 2.4 GHz USB adapter inside.  An infrared LED is also visible.  You need it if you want to use the remote control to switch programs and adjust the volume on the TV.  When communicating with a computer, the LED is not used, so you can safely block it. <br><br>  Of course, a beautiful solution would be to read, disassemble and modify the microcontroller's program, and then reflash it so that the console does not fall asleep and not short the buttons.  But I am not familiar with this area, I leave this opportunity to enthusiasts. <br><br>  The remote control with constantly pressed buttons consumes electricity voraciously.  Therefore it was necessary to solder the power supply unit to it in order not to change the batteries every day. <br><br><h3>  Rework step by step </h3><br>  <i>First of all, I note that the fact that everything has worked for me does not mean that it will work for you.</i>  <i>If the manufacturer, for example, changes the firmware, the closure of two buttons may be useless.</i>  <i>However, I hope that no one will change the firmware as superfluous.</i> <br><br>  So, open the remote.  We pick with a screwdriver until it opens, slightly damaging the case.  Then, take out the board and close it with two buttons (see photo).  You can use a soldering iron to clean the board, but I just glued the pieces of foil with candy to tape with reinforced scotch tape. <br><br>  Solder power from a three-volt stabilized power source. <br><br>  We pour glue to taste so that the wire stays firmly in the case. <br><br><table><tbody><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/1a8/a54/dac/1a8a54dacc8a9a25623c1a1322fa54df.jpg"><br></td><td><img src="https://habrastorage.org/getpro/habr/post_images/f31/131/d4c/f31131d4c74f6a33ef171a986ad6dd72.jpg"><br></td><td><img src="https://habrastorage.org/getpro/habr/post_images/e6e/7d5/50f/e6e7d550fbb259a0594703de809c7052.jpg"><br></td></tr><tr><td>  Close the TWO (!) Buttons in the indicated places.  <b>Attention!</b>  <b>Initially, the photo contained erroneously labeled buttons!</b>  <b>It is necessary to close the "Set" button and the button with four squares, located to the left of "OK"</b> </td><td>  Strengthen wire </td><td>  Assembly </td></tr></tbody></table><br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/cbd/2cf/23b/cbd2cf23bfc5ad16409859c1c4d410e8.jpg"><br>  How to hold the remote on your head?  You can simply put the remote on the head and put on a wool hat on top.  So I initially did.  But for long-term use, you can sew a pocket to some kind of headgear. <br><br><img align="right" src="https://habrastorage.org/getpro/habr/post_images/2a2/fb1/24d/2a2fb124d13ca2d2be3e6f6dd19b0333.jpg"><br>  The exact position of the console relative to the head is not required.  If the mouse cursor is not where you would like, just turn your head so that the cursor starts to rest on the edge of the screen.  This will move the cursor in the direction opposite to the rotation of the head.  In short, try and everything will become clear without explanation. <br><br><h3>  Is it worth it? </h3><br><br>  After everything was done, I decided to try programs that use a regular webcam to control the mouse without hands for comparison.  What was my surprise when they all earned great!  If there is nothing else at hand, I recommend using them. <br><br>  I tried such programs (all free): <br><ul><li>  <a href="http://sourceforge.net/projects/eviacam/">eViaCam</a> </li><li>  <a href="http://robotica.udl.cat/">Head mouse</a> </li><li>  <a href="http://www.cameramouse.org/">Camera mouse</a> </li></ul><br>  Personally, I liked the <b>eViaCam</b> program most of all, but this is a purely subjective, superficial opinion based on short use with default settings and with the webcam I have.  You might like a completely different program. <br><br><img align="right" src="https://habrastorage.org/getpro/habr/post_images/cb8/38a/805/cb838a8059c1ab43f12d18505f4e431a.png"><br>  To appreciate the advantages of using a gyroscope over purely software solutions, I wrote a program in which you need to move the cursor after the squares appearing on the screen.  At the same time, the mouse cursor should stop (lock) above the square for at least 0.2 seconds. <br><br>  Two small squares are shown: red - where you need to lead the mouse, and green - the place where red moves to the next step. <br>  The program and its source code are available at <a href="https://github.com/MastaLomaster/CStest">https://github.com/MastaLomaster/CStest</a> <br><br>  As a result, the following times for moving the cursor across 25 squares of 40x40 pixels were obtained (indirectly, a higher speed also indicates greater positioning accuracy): <br><br><table><tbody><tr><td>  ordinary mouse in hand </td><td>  28.3 seconds </td></tr><tr><td>  remote with a gyroscope on the head </td><td>  36.7 seconds </td></tr><tr><td>  eViaCam </td><td>  58.3 seconds </td></tr><tr><td>  Head mouse </td><td>  66.3 seconds </td></tr><tr><td>  Camera mouse </td><td>  48.4 seconds </td></tr></tbody></table><br><br>  The typing speed on the virtual keyboard is less revealing.  The fact is that the keyboard requires the mouse cursor to ‚Äúhover‚Äù above the key for a long time (about a second).  Otherwise, false clicks are possible.  Nevertheless, I cite data for typing.  I typed the text "Computer Management without hands" and it took me: <br><br><table><tbody><tr><td>  ordinary mouse in hand </td><td>  1 minute 15 seconds </td></tr><tr><td>  remote with a gyroscope on the head </td><td>  1 minute 23 seconds </td></tr><tr><td>  eViaCam </td><td>  1 minute 31 seconds </td></tr><tr><td>  Head mouse </td><td>  1 minute 44 seconds </td></tr><tr><td>  Camera mouse </td><td>  1 minute 28 seconds </td></tr></tbody></table><br>  Camera Mouse - I liked the least, due to the fact that the cursor does not stand still, but twitches.  But the typing speed in it turned out to be quite good. <br><br>  I used a program that I wrote to work with the Tobii REX eye tracking device, and later modified it to support any device that moves the cursor around the screen, including aerial mice. <br>  The program itself and its source code are available here: <a href="https://github.com/MastaLomaster/bkb">https://github.com/MastaLomaster/bkb</a> <br><br>  An illustration of how the program works with the eye tracking device is here: <a href="http://www.youtube.com/watch%3Fv%3DO68C4d2SNC8">http://www.youtube.com/watch?v=O68C4d2SNC8</a> <br><br>  With other devices, the program works in the same way, only the cursor moves not from eye movement, but, for example, from turning the head with a gyroscope. <br><br>  Is it worth it to throw out about a thousand rubles for the console, power supply, wires, and even lose time, if there are free programs that you can work with, and you don‚Äôt need to cling to your head? <br><br>  In my opinion, the use of the console gives the following advantages: <br><ul><li>  <b>Quick</b> cursor <b>response</b> .  to the point that you can play dynamic games </li><li>  <b>Predictability</b> .  That is, turning your head to the usual angle, you will see that the cursor has moved to the usual place </li><li>  <b>Independence from the lighting conditions</b> and in general from the fact that new faces / objects appeared in the frame. </li></ul><br><br>  Well, it's up to you to decide. <br><br><habracut></habracut></div><p>Source: <a href="https://habr.com/ru/post/213715/">https://habr.com/ru/post/213715/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213701/index.html">Django forms field - nested table</a></li>
<li><a href="../213705/index.html">Splitting an AngularJS application into isolated modules</a></li>
<li><a href="../213709/index.html">Ruby 2.1.1, happy birthday!</a></li>
<li><a href="../213711/index.html">Hello Ruby, or how to teach a child to program?</a></li>
<li><a href="../213713/index.html">Free PHP Basics course in Russian translation by LendWings</a></li>
<li><a href="../213717/index.html">Introducing the Nokia X family with support for Android apps.</a></li>
<li><a href="../213719/index.html">Another example of a penetration test from own practice</a></li>
<li><a href="../213721/index.html">500 words per minute without preparation</a></li>
<li><a href="../213727/index.html">The authors accuse the organizers of the Olympics in piracy, while the deputies change the law</a></li>
<li><a href="../213729/index.html">How I bought a wi-fi scale, quit my job and started living</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>