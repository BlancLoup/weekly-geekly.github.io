<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The experience of creating image loader</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 Hello. I want to talk about creating an image uploader for my first web project. I will try to explain what solutions I have seen, and what...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The experience of creating image loader</h1><div class="post__text post__text-html js-mediator-article"><h4>  Foreword </h4><br>  Hello.  I want to talk about creating an image uploader for my first web project.  I will try to explain what solutions I have seen, and what pitfalls met on my way.  Well, actually, how these stones can be circumvented.  I hope my experience will help someone. <br><br>  To begin, I will describe the main task: you need to create an image uploader (bmp, png, jpg), then save them on the server, as well as create copies of images of various sizes.  It is also desirable to ensure that the design of the loader matches the style of the site, and a convenient user interface.  And most importantly - the loader should be supported by browsers as much as possible. <br><a name="habracut"></a><br><h4>  Solution one.  HTML4 </h4><br>  Of course, this is the simplest and most obvious.  Create a form, put the input-file there, and process the php-script on the server: <br><br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(is_uploaded_file($_FILES[<span class="hljs-string"><span class="hljs-string">"filename"</span></span>][<span class="hljs-string"><span class="hljs-string">"tmp_name"</span></span>])) { move_uploaded_file($_FILES[<span class="hljs-string"><span class="hljs-string">"filename"</span></span>][<span class="hljs-string"><span class="hljs-string">"tmp_name"</span></span>], $_FILES[<span class="hljs-string"><span class="hljs-string">"filename"</span></span>][<span class="hljs-string"><span class="hljs-string">"name"</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span>(<span class="hljs-string"><span class="hljs-string">"  "</span></span>); }</code> </pre> <br>  Now you need to create copies of lower resolution.  Here you can use the various image processing libraries.  For example, Imagick.  That's what I did at first.  On the local host, everything worked fine.  Then I chose an inexpensive hosting, put the project there.  Began to test.  And here came the main bummer.  For images with good resolution (2500x1900), small copies were not created.  Many probably guessed why.  Having rummaged in logs, and also having put mental efforts, it dawned on me.  When you start to process images, and work with the entire matrix, a lot of RAM is required.  And my rather modest hosting tariff provided it not very much. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And this was already a problem.  You can, of course, take a better rate.  But fundamentally this situation will not change.  With the additional load the same thing happens.  The approach is wrong in essence.  It is necessary to perform image manipulations not on the server, but on the client.  And cross-browser html + javascript did not fit here. <br><br><h4>  Solution two.  Flash </h4><br>  Of course, the solution is also not cross-browser.  But 99% of flash users still stand, so it‚Äôs worth a try.  Moreover, there are obvious advantages: <br><ul><li>  asynchronous loading </li><li>  batch upload capability </li><li>  ability to display image previews </li><li>  design options are not limited </li></ul>  We will need a FileReferenceList in order to trigger a dialog and get a list of images from the local machine.  Then we load each one and perform the necessary actions with it: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> FileList:<span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> send_element; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> load_element; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> script_name = <span class="hljs-string"><span class="hljs-string">"../../ajax.php"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> type_filter:FileFilter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileFilter(<span class="hljs-string"><span class="hljs-string">" (*.jpg, *.jpeg, *.gif, *.png)"</span></span>,<span class="hljs-string"><span class="hljs-string">"*.jpg;*.jpeg;*.gif;*.png"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> OpenFileDialog:FileReferenceList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileReferenceList(); OpenFileDialog.addEventListener(Event.SELECT, onSelectList); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSelectList</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e:Event</span></span></span><span class="hljs-function">)</span></span>{ Select_check(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Select_check</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> element: FileReference = OpenFileDialog.fileList.shift(); load_element[<span class="hljs-string"><span class="hljs-string">"original"</span></span>] = element; FileList.push(load_element); element.addEventListener(Event.COMPLETE, onLocal_complete); element.load(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onLocal_complete</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e:Event</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     e.target.data load_element["original"].removeEventListener(Event.COMPLETE, onLocal_complete); if(OpenFileDialog.fileList.length &gt; 0) Select_check(); } function open(){ OpenFileDialog.browse([type_filter]); } function save(){ var send_element = FileList.shift(); send_element["original"].addEventListener(ProgressEvent.PROGRESS, onPOST_progress); send_element["original"].addEventListener(Event.COMPLETE, onPOST_complete); send_element["original"].addEventListener(IOErrorEvent.IO_ERROR, onPOST_error); var cookie = ExternalInterface.call("function(){ var name = 'PHPSESSID'; var prefix = name + '='; var cookieStartIndex = document.cookie.indexOf(prefix); if (cookieStartIndex == -1) return null; var cookieEndIndex = document.cookie.indexOf(';', cookieStartIndex + prefix.length); if (cookieEndIndex == -1) cookieEndIndex = document.cookie.length; return unescape(document.cookie.substring(cookieStartIndex + prefix.length, cookieEndIndex));}"); var DataVartibles:URLVariables = new URLVariables(); DataVartibles.PHPSESSID = cookie; var FileRequest = new URLRequest(script_name); FileRequest.data = DataVartibles; FileRequest.method = URLRequestMethod.POST; send_element["original"].upload(FileRequest, php_file); } function onPOST_progress(e:ProgressEvent){ //  ,   e.bytesLoaded } function onPOST_error(e:IOErrorEvent){ //      if(FileList.length &gt; 0) save(); } function onPOST_complete(e:Event){ if(FileList.length &gt; 0) save(); }</span></span></code> </pre> <br>  The browse method calls the file download dialog.  There is one subtlety: the method will be executed only if the code is called in the event listener of the EVENT.CLICK of some element. <br><br>  It is also worth looking at the description of the FileReference class.  It is needed to upload a local image and transfer it to the server.  The load method is needed for upload, upload for transfer to the server.  There is another subtle point here: when uploading to the server using FileReference, cookies are only transferred from IE (thanks for the <a href="http://habrahabr.ru/users/demetros/" class="user_link">Demetros</a> information).  Therefore, if you want, for example, to work within one session, you will have to get cookies from the browser by calling the javascript function.  Better to do it from the flash drive itself.  ExternalInterface is suitable for this.  Next, we write the cookies we need in URLVariables. <br><br>  So, basic functionality is.  But the question remains with the creation and sending of small copies of images.  And here FileReference will not help us anymore, since it is able to send only downloaded local files. <br><br>  I will not consider the issue of creating reduced copies; there are many libraries that can do this.  However, to be sent to the server, this data must be represented as a ByteArray. <br>  Now we will consider how we organize the sending of this data to the server.  Using the regular variable URLVariables with the subsequent addition to the URLRequest will not do this.  Therefore, you will have to create the request header yourself.  URLRequest allows you to do this.  As a result, we create a class that is engaged in sending data to the server: <br><br><pre> <code class="javascript hljs">package { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> flash.net.URLRequest; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> flash.net.URLLoader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> flash.net.URLRequestMethod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> flash.net.URLLoaderDataFormat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> flash.utils.ByteArray; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> flash.utils.Endian; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> flash.net.URLRequestHeader; public <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HTTPLoader</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">URLLoader</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> HTTPRequest; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> BOUND:<span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ENTER:<span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ADDB:<span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-string"><span class="hljs-string">"--"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> index_file = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> PostData:ByteArray; public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HTTPLoader</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">script_name: String</span></span></span><span class="hljs-function">)</span></span>{ BOUND = getBoundary(); PostData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ByteArray(); PostData.endian = Endian.BIG_ENDIAN; HTTPRequest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URLRequest(script_name); HTTPRequest.requestHeaders.push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URLRequestHeader(<span class="hljs-string"><span class="hljs-string">'Content-type'</span></span>,<span class="hljs-string"><span class="hljs-string">'multipart/form-data; boundary='</span></span> + BOUND)); HTTPRequest.method = URLRequestMethod.POST; } public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">param_name:String, param_value:String</span></span></span><span class="hljs-function">)</span></span>{ PostData.writeUTFBytes(ADDB + BOUND); PostData.writeUTFBytes(ENTER); PostData.writeUTFBytes(<span class="hljs-string"><span class="hljs-string">'Content-Disposition: form-data; name="'</span></span>+param_name+<span class="hljs-string"><span class="hljs-string">'"'</span></span>); PostData.writeUTFBytes(ENTER); PostData.writeUTFBytes(ENTER); PostData.writeUTFBytes(param_value); PostData.writeUTFBytes(ENTER); } public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">filename:String, filedata:ByteArray</span></span></span><span class="hljs-function">)</span></span>{ PostData.writeUTFBytes(ADDB + BOUND); PostData.writeUTFBytes(ENTER); PostData.writeUTFBytes(<span class="hljs-string"><span class="hljs-string">'Content-Disposition: form-data; name="Filedata'</span></span> + index_file + <span class="hljs-string"><span class="hljs-string">'"; filename="'</span></span> + filename + <span class="hljs-string"><span class="hljs-string">'"'</span></span>); PostData.writeUTFBytes(ENTER); PostData.writeUTFBytes(<span class="hljs-string"><span class="hljs-string">'Content-Type: application/octet-stream'</span></span>); PostData.writeUTFBytes(ENTER); PostData.writeUTFBytes(ENTER); PostData.writeBytes(filedata,<span class="hljs-number"><span class="hljs-number">0</span></span>,filedata.length); PostData.writeUTFBytes(ENTER); PostData.writeUTFBytes(ENTER); index_file++; } public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ PostData.writeUTFBytes(ADDB+BOUND+ADDB); HTTPRequest.data = PostData; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.load(HTTPRequest); } public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBoundary</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>):</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">String</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _boundary:<span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i:int = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">0x20</span></span>; i++) { _boundary += <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCharCode( int( <span class="hljs-number"><span class="hljs-number">97</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() * <span class="hljs-number"><span class="hljs-number">25</span></span> ) ); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _boundary; } } }</code> </pre> <br>  I quote the class completely, since the formation of the correct HTTP request header took me quite a lot of time.  I hope someone will help.  Using the class is very simple.  Here is an example: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> POSTLoader:HTTPLoader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HTTPLoader(<span class="hljs-string"><span class="hljs-string">"../../ajax.php"</span></span>); POSTLoader.addEventListener(Event.COMPLETE, POSTLoader_complete); POSTLoader.addVariable(<span class="hljs-string"><span class="hljs-string">"AJAX_module_name"</span></span>, <span class="hljs-string"><span class="hljs-string">"pic_loader.php"</span></span>); POSTLoader.addFile(<span class="hljs-string"><span class="hljs-string">"pic_100"</span></span>, send_element[<span class="hljs-string"><span class="hljs-string">"pic_100"</span></span>]); POSTLoader.send();</code> </pre> <br>  Well, in the Event.COMPLETE listener, do what you need.  The disadvantage of this method is that it is impossible to track the download process, so only two states are available - whether the file is loaded or not. <br>  In php, you can easily walk through the $ _FILES array and pick up each file named ‚ÄúFiledata‚Äù + index, and then just save it. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_FILES[<span class="hljs-string"><span class="hljs-string">"Filedata0"</span></span>])){ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($i = <span class="hljs-number"><span class="hljs-number">0</span></span>; $i &lt; $n; $i++){ $file_name = $_FILES[<span class="hljs-string"><span class="hljs-string">"Filedata"</span></span>.$i][<span class="hljs-string"><span class="hljs-string">"name"</span></span>]; move_uploaded_file($_FILES[<span class="hljs-string"><span class="hljs-string">"Filedata"</span></span>.$i][<span class="hljs-string"><span class="hljs-string">'tmp_name'</span></span>],$file_path.$file_name); } }</code> </pre> <br>  Here is a solution.  If desired, you can display preview images immediately, or transfer to javascript as base64.  Well, this is someone like it. <br><br><h4>  Solution three.  HTML5 </h4><br>  I‚Äôll say right away that I didn‚Äôt implement the loader using html5, but for relative completeness (I didn‚Äôt take java applets), this solution is worth mentioning.  Most likely, in the future this will be the best way to solve this problem.  However, old browsers are still running, and the new File API is not yet fully developed.  Also worth mentioning is the immutable input-file.  In modern browsers, you can call the click method programmatically and hide the input itself. <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"im"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"file"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"position:absolute; top:-999px; visibility:hidden"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"background-color: blue; width: 100px; height:40px;"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><pre> <code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">'text/javascript'</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> btn = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">"#button"</span></span>); btn.onclick = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> im = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">"#im"</span></span>); im.click(); } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt;</span></span></code> </pre><br>  This solution works in almost all modern browsers.  Except one.  Guess what ... <br>  Not guessed, Opera.  In versions prior to 11.52 inclusive, it is impossible to do so.  Therefore, the imposition of makeup on the input file still remains a problem. <br><br><h4>  Conclusion </h4><br>  Of course, in a real project it is better to use a combination of these methods so that the loader works for everyone.  For example, if the html5 functions in the user's browser are not supported, then you can try using flash.  If there is no flash, then we give a simple html solution.  Unlikely, but it works. <br>  I hope my article will help someone. </div><p>Source: <a href="https://habr.com/ru/post/132489/">https://habr.com/ru/post/132489/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132479/index.html">HTML5 console from Google</a></li>
<li><a href="../132482/index.html">Our nuggets 2</a></li>
<li><a href="../132483/index.html">Making a home radio field ‚Äúcleaner‚Äù on the example of Wi-Fi networks</a></li>
<li><a href="../132486/index.html">CPU</a></li>
<li><a href="../132487/index.html">Integrating MATLAB into C # .NET</a></li>
<li><a href="../132490/index.html">Video player from scrap materials</a></li>
<li><a href="../132491/index.html">Google refused to remove popular MP3 Music Download Pro from Android Market</a></li>
<li><a href="../132492/index.html">Photo and video files in the home collection - processing and storage</a></li>
<li><a href="../132493/index.html">Universal NMEA 0183 Parser / Formatter on C # (+ port on JAVA)</a></li>
<li><a href="../132494/index.html">Using drivers in CodeIgniter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>