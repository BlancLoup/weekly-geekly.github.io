<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Trojan Android app bypasses Google Bouncer checks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ESET analysts have discovered an interesting method of covert attacks on Android users, which contains an interesting feature. In the Google Play appl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Trojan Android app bypasses Google Bouncer checks</h1><div class="post__text post__text-html js-mediator-article">  ESET analysts have discovered an interesting method of covert attacks on Android users, which contains an interesting feature.  In the Google Play application store, we were able to detect several applications that were disguised as legitimate, but in fact contained another application with malicious functions.  This embedded application was called <i>systemdata</i> or <i>resourcea</i> . <br><br><img src="https://habrastorage.org/files/5ec/418/54a/5ec41854a3bf43809b707777ede87ff7.png"><br><br>  This second application is secretly reset to the device‚Äôs memory from the first, but asks the user for permission to install.  It is presented as a tool for managing the settings of the ‚ÄúManage Settings‚Äù device.  After its installation, the application runs as a service in the background. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  ESET anti-virus products detect applications that contain this additional application as <b>Android / TrojanDropper.Mapin</b> .  According to our data, India has the largest number of infections of Android devices with this malware. <br><br>  The malware is a backdoor, which gains control of the device and incorporates it into the botnet.  The backdoor uses a special internal timer for deferred execution of its payload.  Thus, authors can deceive various automatic systems for analyzing files that may rank a file as suspicious due to its behavior.  In some cases, the backdoor can wait three days before activating the payload.  Most likely, such a measure allows the authors to bypass the Google Bouncer file analysis tool verification mechanisms used by Google to verify applications downloaded to Play. <br><br>  After activating the payload, the Trojan requests administrator rights in the system and starts interacting with its C &amp; C server.  Android / Mapin contains various functions, for example, displaying various notifications to the user, downloading, installing and launching other applications, as well as receiving personal user information on the device.  At the same time, its main function is to display fullscreen advertising on an infected device. <br><br>  <b>Distribution vectors</b> <br><br>  Malicious apps were placed in the Google Play app store at the end of 2013 and in 2014. The names of the apps were different, including, ‚ÄúHill climb racing the game‚Äù, ‚ÄúPlants vs zombies 2‚Äù, ‚ÄúSubway suffers‚Äù, ‚ÄúTraffic Racer‚Äù , Temple Run 2 Zombies, Super Hero Adventure by TopGame24h, TopGameHit and SHSH.  Exact application download dates were November 24-30, 2013 and November 22, 2014. According to <a href="https://mixrank.com/">MIXRANK</a> resource <a href="https://mixrank.com/">statistics</a> , the <a href="https://mixrank.com/playstore/apps/com.plantzombie">Plants vs zombies 2</a> application was downloaded more than 10 thousand times before it was removed from the store.  At the same time, the System Optimizer, Zombie Tsunami, tom cat talk, Super Hero adventure, Classic brick game applications, as well as the aforementioned Google Play applications with malicious capabilities, were downloaded to alternative stores. Android applications by the same authors.  The same backdoor was found bundled with other applications that were uploaded to the store by the PRStudio developer (not to be confused with prStudio) in alternative app stores with links to Google Play.  This developer has downloaded at least five other Trojan apps into alternative app stores: Candy crush or Jewel crush, Racing rivals, Super maria journey, Zombie highway killer, Plants vs Zombies.  These applications are still available for download from these stores.  The listed applications have been downloaded by users hundreds of times. <br><br><img src="https://habrastorage.org/files/8ee/4f8/8e4/8ee4f88e4d9f4b57a1c11726ba0fbd54.png"><br>  Fig.  Malicious application icons. <br><br><img src="https://habrastorage.org/files/cc8/219/97b/cc821997b5ee43cb8a846f4ba232b9d8.png"><br>  Fig.  Malicious application that has received quite positive ratings. <br><br><img src="https://habrastorage.org/files/dbc/ac7/a37/dbcac7a37b624cef903a809c66a87d4a.png"><br>  Fig.  Another application that received positive ratings. <br><br>  <b>Analysis</b> <br><br>  There are various variants of the execution of a malicious program after a user has downloaded an illegitimate application.  One of the options assumes that the victim will be asked to launch the file with the malicious program 24 after the first execution of the downloaded application.  This method is less suspicious for the user, who believes that the launch request came from the OS.  Another method involves the issuance of an instant request to the user.  Both options are designed to trigger after a change in the network connection; for this, the malicious program registers a so-called.  broadcast receiver in the manifest. <br><br><img src="https://habrastorage.org/files/e1d/240/28c/e1d24028c6b840b3947241fe21954c83.png"><br>  Fig.  Registration t.  broadcast receiver. <br><br>  After changing the connection, the user will be prompted to install the ‚Äúsystem application‚Äù.  The malicious application itself, dropped onto the device, may be called ‚ÄúGoogle Play Update‚Äù or ‚ÄúManage Settings‚Äù. <br><br><img src="https://habrastorage.org/files/5b8/979/d4d/5b8979d4d937406eac7b88a72b4a71c2.png"><br>  Fig.  Malicious application disguised as a system. <br><br>  In that case, if the user chooses to cancel the installation, then the malicious program will show a request every time when the network connection is changed.  It can be assumed that a simple user will be sure of the seriousness of the displayed notification and at some point, most likely, will press the install button only to get rid of it.  Once launched, the trojan is executed as a service with its registered broadcast receiver, awaiting a connection change. <br><br>  When such a change occurs, the Trojan will attempt to register itself using the Google Cloud Messages (GCM) service to receive messages later.  After that, Android / Mapin will try to register the infected device on the attacker's server, sending information such as your username, Google account, IMEI, registration ID (ID) and the name of your application package there. <br><br><img src="https://habrastorage.org/files/fd5/275/a18/fd5275a185b24343becc424040ae17c5.png"><br>  Fig.  The process of registering a device on the attackers server. <br><br>  In order to exclude the possibility of its removal from the system, the Trojan requires the user to activate the device administrator mode. <br><br><img src="https://habrastorage.org/files/279/681/5d6/2796815d62014f87829cc531468e6a29.png"><br>  Fig.  Suggestion to the user to activate the device administrator mode. <br><br>  The trojan will report to the remote server about the successful activation of the device administrator mode.  Once such an operation occurs, the malware will show the user advertisements in full screen mode ( <a href="https://developers.google.com/mobile-ads-sdk/docs/dfp/android/interstitial">interstitial</a> ).  Such advertising (interstitial ad) will be displayed to the user again every time you change the connection.  Development of this type of advertising is possible using the legitimate AdMob SDK. <br><br><img src="https://habrastorage.org/files/b8a/9ed/83f/b8a9ed83f7f94a92a309153317bb8b78.png"><br>  Fig.  Full-screen advertising (interstitial ad). <br><br>  <b>Networking</b> <br><br>  A trojan interacts with its controlling server using the Google Cloud Messaging (GCM) service.  This service is increasingly used by modern malware for its own purposes, through which attackers can instruct the bot to perform the actions they need. <br><br><img src="https://habrastorage.org/files/518/235/c11/518235c1134f42829f50db6d368f6b79.png"><br>  Fig.  Processed by the bot command. <br><br>  Not all functions of a malicious program are fully implemented in its code, except for this, not all already implemented functions are used.  It is possible that the threat itself is still at the level of development and will be improved in the future.  As we have already mentioned, its main goal is to deliver aggressive full-screen advertising for displaying it to the user, disguised as a system application.  A bot can also be used by attackers to install other malware on a compromised device. <br><br>  In addition to displaying advertisements, the list of supporting functions performed by it is quite extensive: changing the publisher ID of the displayed advertisement, loading and launching other applications, displaying notifications to the user, disabling the device administrator mode, changing the address of the C &amp; C server managing to the URLs of the application download.  After each task received using GCM, the bot will inform the remote server using the HTTPS protocol. <br><br>  <b>Conclusion</b> <br><br>  The Trojan program was successfully uploaded to the Google Play store, because it contained a mechanism for delaying activation of malicious functions and, thus, did not arouse suspicion from the Bouncer tool.  An interesting question is why Bouncer does not specialize in static analysis of executable files inside downloaded applications.  For these reasons, the Trojan program was freely distributed to users through the official Google app store for Android.  The malicious game Super Hero adventure was uploaded to the Play Store by the SHSH developer.  It is possible that this developer has downloaded more applications in the Play Store.  Ultimately, they were all removed from the store, but went unnoticed there for a year and a half.  It is possible that such cases are the reason that in March 2015, Google announced that all applications and updates should be tested by a person. <br><br>  The best practice for keeping your device safe is to use only the official app store to download them.  In addition, it is necessary to pay attention to reviews and user comments to the applications hosted there.  When installing the application, you should closely monitor the rights requested by the application.  If you notice anything suspicious in the behavior of the application, you can send it as a sample to the anti-virus laboratory with appropriate comments about the reasons for sending. <br><br>  Below is information about malware samples we analyzed. <br><br><img src="https://habrastorage.org/files/91e/2c9/64a/91e2c964a93f4b02b849fa89603ada5c.png"><br><br><img src="https://habrastorage.org/files/3f2/b64/5b7/3f2b645b7ee441468916a4fa05eb787e.png"></div><p>Source: <a href="https://habr.com/ru/post/267577/">https://habr.com/ru/post/267577/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267567/index.html">Telegram check using PVS-Studio and vice versa</a></li>
<li><a href="../267569/index.html">Software design</a></li>
<li><a href="../267571/index.html">Impressions from the trainings Certified Scrum Master and Certified Scrum Product Owner</a></li>
<li><a href="../267573/index.html">As a result, I wrote a new RTOS, tested and stable</a></li>
<li><a href="../267575/index.html">Construction integration. Interview with CIO of the largest stock exchange in Russia and Eastern Europe</a></li>
<li><a href="../267579/index.html">Tehnokniga, part 3: literature on the design of highly loaded systems, on the security of web applications, on ensuring the quality of development and on mobile development</a></li>
<li><a href="../267583/index.html">Symantec voluntarily issued a certificate for google.com and www.google.com</a></li>
<li><a href="../267587/index.html">Deep Linking for Mobile Applications</a></li>
<li><a href="../267589/index.html">Notifications are available to everyone. Expansion of functions of integration with RSS + Push from Vkontakte groups</a></li>
<li><a href="../267591/index.html">Using DPDK to provide high performance application solutions (part 0)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>