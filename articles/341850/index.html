<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Megafon-Raiffeisenbank - Russia's first deal in securities on the blockchain</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the end of September 2017, gelbplaneten and I were able to participate in the preparation and conduct of the first Russian securities transaction u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Megafon-Raiffeisenbank - Russia's first deal in securities on the blockchain</h1><div class="post__text post__text-html js-mediator-article">  At the end of September 2017, <a href="https://habrahabr.ru/users/gelbplaneten/" class="user_link">gelbplaneten</a> and <a href="https://habrahabr.ru/users/gelbplaneten/" class="user_link">I were</a> able to participate in the preparation and conduct of the first Russian <a href="https://www.vedomosti.ru/technolo%2520gy/articles/2017/10/01/736030-megafon-obligatsii">securities transaction using blockchain technology</a> . <br><br>  The project was conducted by <abbr title="National Settlement Depository">NSD</abbr> under the direction of Alexander Yakovlev, the software implementation was developed by <a href="http://altoros.com/">Altoros</a> , the architect was <a href="https://www.altoros.com/training-team/oleg-abdrashitov.html">Oleg Abdrashitov</a> . <br><br>  Under the cut my story about the technical and some legal aspects of the preparation and conduct of the transaction. <br><a name="habracut"></a><br><h2>  Description of the blockchain network </h2><br>  For the pilot deal, we deployed a blockchain platform based on Hyperledger Fabric v.1.0.  The Hyperledger project under the auspices of The Linux Foundation is an initiative to create various blockchain platforms and open source support tools.  The project involves a whole scattering of companies from around the world: technology giants (IBM, Intel, and so on), consulting companies (Accenture, Altoros, and so on), representatives of various industries (Sberbank, Moscow Exchange, CME, DTCC, Deutche Burse, Daimler, Airbus and so on) and startup teams (Digital Asset Holding, Soramitsu and so on).  The project was launched in December 2015, and now five blockchain platforms and four tools for working with blockchain platforms are actively developing.  Hyperledger is open to all, its members are equal among themselves and adhere to the principles of "clean" open source. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Since Hyperledger Fabric v.1.0 is not as widely known as Bitcoin or Ethereum, in order to make it easier for you to understand the topology of this blockchain network and the processes occurring in it, I will briefly describe the features of the Hyperledger Fabric v.1.0 architecture. <br><br><h3>  Features of the Hyperledger Fabric architecture v.1.0 </h3><br>  Let's look at how transactions are performed on the Hyperledger Fabric v.1.0 blockchain platform (based on <a href="http://www.jpx.co.jp/english/corporate/research-study/working-paper/b5b4pj000000i468-att/E_JPX_working_paper_Vol20.pdf">‚ÄúThe Trend of the DLT in Capital Market‚Äù, Japan Exchange Group, September 14, 2017</a> ) <br><br>  Unlike public platforms like Bitcoin or Ethereum, there are two special roles in Hyperledger Fabric v.1.0: <br><br><ul><li>  Endorser (validator) - the node that checks and executes the transaction, and then returns it back to the client with the results and its signature. </li><li>  Orderer is a node that establishes a sequence of transactions and sends them to other nodes of the DLT network. </li></ul><br>  To achieve consensus when verifying transactions, endorsement <b>policies</b> are used - this is a set of rules that determine which of the nodes can be a validator and how many validator signatures are sufficient for the transaction to be considered confirmed.  At the same time, the validation policy is set separately for each smart contract created in the blockchain network.  For example, it can be stated in a policy that a transaction will be valid if it is confirmed by two of the three specified nodes. <br><br>  How a transaction is created and executed: <br><br><ol><li>  The client directs the transaction to validators (endorsers). </li><li>  The validators execute the transaction and return it to the client along with the results of the execution and their signature. </li><li>  The client collects the required number of validator signatures and sends a transaction with a set of validator responses to Orderer. </li><li>  Orderer combines transactions into a sequence of blocks and sends them. </li><li>  Each node checks if the transaction complies with the validation policy, and ‚Äúloses‚Äù it in its copy of the registry. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9c/gv/je/9cgvjeelk8umd_wlzywrnmyqkkm.jpeg"></div><br><h3>  Topology blockchain-network pilot deal </h3><br>  There were three participants in the blockchain network structure: <br><br><ul><li>  NSD is a transaction operator and platform administrator. </li><li>  Megaphone - party to the transaction. </li><li>  Raiffeisenbank - party to the transaction. </li></ul><br>  Each participant deployed its own network node, as well as additional components provided by the Hyperledger Fabric v.1.0 architecture: <br><br><ul><li>  NSD has deployed an Orderer to form an orderly transaction flow, and </li><li>  installed the client part with the UI, which provides the functionality of <b>the</b> transaction <b>operator</b> . </li><li>  Megafon and Raiffeisen installed client parts with UI, providing the functionality of <b>the</b> transaction <b>participant</b> . </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9q/a2/tf/9qa2tftzhu2atkpizbnjg6bmcdk.png"></div><br>  Registries were created on the network, access to which was delimited by the internal mechanism of Hyperledger channels: <br><br><ul><li>  <b>Register of securities</b> (available to all members of the network).  Here, the only <b>SecurityMaster</b> smart contract was created, in the context of which the list of securities was entered. </li><li>  <b>Consolidated register of balances of accounts of all participants</b> (only NSD is available).  Here was created the only smart contract <b>Book</b> , in the context of which were reflected the balances on the accounts of all participants. </li><li>  <b>Register of balance sheets of Raiffeisenbank</b> (available only to NSD and Raiffeisenbank). </li><li>  <b>Register of Megafon accounts balances</b> (only NSD and <b>Megafon are</b> available). </li><li>  <b>Register of transactions between Raiffeisenbank and Megaphone</b> (available only to NSD, Raiffeisenbank and Megafon).  Here, the only <b>Instruction</b> smart contract was created, in the context of which all transactions of a given pair of participants were recorded and processed. </li></ul><br>  Also in the balance sheets registers of Raiffeisenbank and Megaphone there was created one smart contract <b>Position</b> , in the context of which balances were recorded on the participant's accounts. <br><br>  If the transaction was carried out and legalized only through the blockchain, then everything would happen like this: <br><br><ol><li>  In the Transaction Register, both participants create purchase and sale instructions transactions, which are stored in the context of the <b>Instruction</b> smart contract. </li><li>  Upon receipt of the second instruction from the pair ‚Äúpurchase-sale‚Äù they are compared with each other in the <b>Instruction</b> smart contract and receive the status of ‚Äúmatched‚Äù. </li><li>  When a NSD client receives a comparison notice, it checks the balance on the accounts of participants in the transaction using the Consolidated Register of Balances. </li><li>  If the balance check was successful, the NSD client: <br><ul><li>  Creates transactions in the <b>Instruction</b> smart contract that change the status of the corresponding instructions to ‚Äúexecute‚Äù. </li><li>  And then creates transactions to change the balance of accounts for the smart contract <b>Position</b> . </li></ul></li></ol><br><h2>  Preparation and conduct of the transaction </h2><br>  There is an approved procedure for regulating the trading of securities, in which a transaction is considered legally significant if it is conducted through the standard securities accounting system of NSD Alameda.  In order to meet this condition, special stages of forming, signing and processing instructions of the current format were added to the process of conducting a transaction, using ‚Äúcombat‚Äù EDS participants in the transaction.  In addition, in order to transfer instructions via the blockchain as legitimate, NSD signed a license agreement with the parties to the transaction and an additional agreement to the Agreement on electronic document flow. <br><br>  As a result, the transaction process began to look like this: <br><br><ol><li>  Megafon and Raiffeisenbank, each at its own site, create counter-instructions for selling and buying, respectively, and transfer them to the Instruction smart contract. </li><li>  Instruction smart contract instructions are mapped to each other. </li><li>  If the mapping was successful, then: <br><ul><li>  NSD on its site creates and ‚Äúattaches‚Äù to the instructions of each of the participants a corresponding order file for subsequent upload to Alameda. </li><li>  The registers of participants' balance sheets (smart contract Position) are sent the corresponding transactions to change the accounting of securities in the accounts. </li></ul></li><li>  Participants of the transaction: <br><ul><li>  Extract from the blockchain order files for "Alameda". </li><li>  Sign them with their ‚Äúcombat‚Äù EDS at the respective workplaces. </li><li>  Put back on the blockchain. </li></ul></li><li>  NSD extracts the order files signed by the participants and uploads to Alameda. </li><li>  Alameda processes the transaction and creates the reporting files, which are then sent to the participants in the transaction. </li></ol><br><h3>  How was it </h3><br>  All project participants were primarily interested in the development of legal issues related to carrying out transactions through blockchains, and identifying technical and organizational difficulties that may arise when deploying a blockchain network in real conditions.  Moreover, the organizations are different, each with its own infrastructure and network policies, rules for the interaction of external and internal networks, and so on and so forth. <br><br>  We faced the first difficulties even before the launch of the platform: it turned out that Raiffeisenbank and Megafon are not ready to give direct access to their current EDS keys to ‚Äúalien mysterious‚Äù software.  So I had to develop a special utility for uploading / uploading order files so that they could be signed outside the platform software. <br><br>  Further difficulties were related to the fact that the platform was developed and debugged in Amazon Web Services, and now it had to work instead in a sterile-homogeneous cloud environment in a harsh heterogeneous world. <br><br>  Fortunately, the implementation of the platform involved the use of Docker containers, so the differences associated with the use of different operating systems by participants (RHEL and Ubuntu) did not affect the operation of network nodes. <br><br>  The main problems were related to the internal features of the Hyperledger Fabric and the fact that in both companies the network infrastructure is different: <br><br><ul><li>  Because of the peculiarities of the smart contracts, Hyperledger Fabric had to completely ‚Äúalign‚Äù the nodes both by release (because the commit hash was used by internal algorithms) and by the OS user, under which the platform components were launched (he also participated in identifying the smart contract). </li><li>  The Raiffeisenbank site did not see itself at its external address, so some stages of the installation and configuration scripts had to be skipped by &lt;Ctrl + C&gt;. </li><li>  There were mysterious "sticking" of the service, which was responsible for uploading / downloading files, which could only be got rid of by restarting the service. </li></ul><br>  The deployment and setup of the platform took about three days (September 27-29) and 20 hours in Webex.  As usual in the IT environment, it was not without the shaman tambourines - ‚Äú... now we are waiting for exactly seven minutes ...‚Äù <br><br>  But in the end, the first deal went without a single failure and freeze. <br><br>  Below are the historical screenshots - instructions from Raiffeisenbank for the purchase of MegaFon bonds and the final balance based on the transaction results. <br><br><img src="https://habrastorage.org/webt/vx/9w/wd/vx9wwdqfwmb8mbviegx0l-aedha.png"><br><br><img src="https://habrastorage.org/webt/bq/gt/sw/bqgtsw4ltw5i-g33tflnb26x6k8.png"></div><p>Source: <a href="https://habr.com/ru/post/341850/">https://habr.com/ru/post/341850/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341836/index.html">World to Mobile: Pagers</a></li>
<li><a href="../341840/index.html">Create a backup of a large remote database using YII2</a></li>
<li><a href="../341844/index.html">We implement address storage in a warehouse: what software is suitable and why</a></li>
<li><a href="../341846/index.html">How to talk for free about your startup in foreign media with a million audience: difficulties and ways to circumvent them</a></li>
<li><a href="../341848/index.html">Theater and IT: Shakespeare never dreamed of</a></li>
<li><a href="../341852/index.html">Looking for the best way to test a system</a></li>
<li><a href="../341854/index.html">Digital Transformation: The Beginning</a></li>
<li><a href="../341856/index.html">On the issue of statistics (in terms of SDR)</a></li>
<li><a href="../341858/index.html">Preparing for release in the App Store. Instructions for beginners and life hacking</a></li>
<li><a href="../341860/index.html">uSpeech - startup development (2). Run Android version and where to get the first customers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>