<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Add an arbitrary phone in the personal account of the mobile operator Kyivstar (Ukraine)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I am a client of the Ukrainian mobile operator Kyivstar and a user of their web service my.kyivstar.ua . Like many other operators, Kyivstar offers a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Add an arbitrary phone in the personal account of the mobile operator Kyivstar (Ukraine)</h1><div class="post__text post__text-html js-mediator-article">  I am a client of the Ukrainian mobile operator Kyivstar and a user of their web service <a href="https://my.kyivstar.ua/">my.kyivstar.ua</a> .  Like many other operators, Kyivstar offers a web version of a personal account in which you can view the account balance, call details, change the tariff, order or deactivate the service, etc. <br>  They also recently launched a new version of their personal <a href="https://new.kyivstar.ua/">account, new.kyivstar.ua</a> .  An interesting feature appeared in it - adding another Kyivstar phone via SMS verification.  I took her to check for the presence of vulnerabilities, as she actually gave the same access to the phone being added, as well as to her, which I was not particularly pleased with as a client. <br>  The new site has the following phone addition interface: <br><img src="https://habrastorage.org/files/b32/aa7/012/b32aa701271b4198800fe270a7a33b8e.png"><br><a name="habracut"></a><br><br>  Adding is done in 4 steps: <br>  Enter the phone number <br><img src="https://habrastorage.org/files/40b/f6a/0e8/40bf6a0e8092490eb1449cd72e23dda3.png"><br><br>  The choice of option through the accession by SMS (it happens even through a static password, but I do not see it) <br><img src="https://habrastorage.org/files/1e5/38b/3e3/1e538b3e343d4b92bf42759ea1a150e5.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Enter received SMS. <br><img src="https://habrastorage.org/files/86f/054/429/86f05442948547a39562f968e509dcfa.png"><br><br>  The confirmation. <br><br>  These 4 steps are converted into a series of POST and GET requests.  The last three requests from this series are responsible for adding the number after the completed OTP verification. <br>  And I decided to check: what if to repeat these requests without those responsible for SMS verification. <br>  Consider in more detail these last 3 requests. <br>  They have the following appearance in the Google Chrome developer tool (Shift + Ctrl + I): <br><img src="https://habrastorage.org/files/7a2/8c9/89b/7a28c989bdb948f3858115da8a7a9ed3.png"><br><br>  Requests for merge.rpc are sent to <a href="">account.kyivstar.ua/cas/merge/merge.rpc</a> . <br>  Content of the first request: <br><img src="https://habrastorage.org/files/a0f/86e/a36/a0f86ea36d2f4d1dbb344cab40fe6780.png"><br><br>  The request contains the number of the phone to be added (097 ...) <br>  Content of the second query: <br><img src="https://habrastorage.org/files/c1f/811/deb/c1f811deb9b84d50a403743b8a89ead6.png"><br><br>  The third request to the address <a href="https://new.kyivstar.ua/ecare/addOrMerge">new.kyivstar.ua/ecare/addOrMerge</a> is a GET request without parameters, confirming the previous two operations. <br><br>  Next, I decided to replay these 3 requests, after removing the newly added phone from my personal account. <br>  For playback, I used the Postman application. <br><img src="https://habrastorage.org/files/1f4/cae/27a/1f4cae27a8604e60994c3a663c964d48.png"><br><br>  As expected, after updating the page, the phone was successfully added to your personal account. <br><img src="https://habrastorage.org/files/677/b3a/6ea/677b3a6ea6fe4e8481f3eb6f2588ea0a.png"><br><br>  What we have. <br>  We can add any phone number to our personal account without SMS verification and manage it as ours, namely: <br><ul><li>  view balance and call details </li><li>  view the PUK1 code and serial number of the SIM card, which allows you to replace the SIM card yourself </li><li>  add new services and change the tariff plan </li><li>  and most importantly - transfer money from phone to phone </li></ul><br>  The best gift scammers can not imagine. <br><br>  As it should be, I immediately contacted Kyivstar customer support and asked to provide me with contact details of the security service or the responsible development department employee in order to describe in detail the essence of the vulnerability and the way it was played.  As expected, I was denied my request and offered to send a description of the vulnerability either to chat or through the universal form on the site. <br>  Understanding what risks are possible if the detailed description of the vulnerability is available to any customer support employee, I still insisted on my request, but again without success.  Understanding that there is no other way out, I issued a detailed instruction on how to reproduce the vulnerability in the Google Docs file, wrapped it in a link through the clickmeter.com tracking service and sent it to the chat. <br>  As I expected, my application caused a stir and increased interest among the company's employees, which is reflected in analytics of the clickmeter.com service: <br><img src="https://habrastorage.org/files/99b/6d8/c95/99b6d8c959d1461983e75c8e8f198c9e.png"><br><br>  The application for 2 days was viewed by 22 unique users. <br><img src="https://habrastorage.org/files/ad7/7f5/77d/ad77f577dbad48ccafc9b57d07017342.png"><br><br>  According to statistics, it is clear that the link was viewed both from computers and from mobile devices.  The geography of views was also not limited to the Kiev office, in the list Kiev, Lvov, Dnepropetrovsk, Tbilisi. <br>  Analyzing the statistics, it becomes clear that the existing communication channel with the company is not intended for filing applications of this kind and may lead to information leakage and operation by third parties until the vulnerability is closed. <br><br>  It is worth paying tribute to the company, the responsible officer contacted me on the second day, thanked and asked to remove the link from the public.  Over the next few weeks, the vulnerability was closed, and I was again contacted and informed that the application was completed. <br><br>  This story reminds us that we need to be more attentive to information security issues in companies of such magnitude as Kyivstar, to create separate communication channels for this, access to which only authorized employees will have access to.  Well, as well as the company's participation in bug-bounty programs or creating your own, also has a positive effect on strengthening security services. </div><p>Source: <a href="https://habr.com/ru/post/305706/">https://habr.com/ru/post/305706/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../305696/index.html">Host an Azure cloud service on regular vds</a></li>
<li><a href="../305698/index.html">Password Change Notification System [Windows]</a></li>
<li><a href="../305700/index.html">Waiting for advertising: about future innovations on the App Store</a></li>
<li><a href="../305702/index.html">React in browsers and mobile platforms</a></li>
<li><a href="../305704/index.html">Why break even secure CMS on a secure hosting</a></li>
<li><a href="../305708/index.html">Impressions from the best reports at the International PHP Conference</a></li>
<li><a href="../305710/index.html">GIMP 2.9.4 released</a></li>
<li><a href="../305712/index.html">ViaLatM and social functions</a></li>
<li><a href="../305714/index.html">Introducing Iron: Melt Ore on Rust</a></li>
<li><a href="../305716/index.html">Opening API for working with services from Russian low-cost host (part 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>