<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>GitLab Container Registry</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In May of this year, the release of GuitLab 8.8 was released. Part of this release was the launch of the integrated Docker Container Registry. Below i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>GitLab Container Registry</h1><div class="post__text post__text-html js-mediator-article"><p>  <i>In May of this year, the release of <a href="https://habrahabr.ru/company/softmart/blog/302884/">GuitLab 8.8</a> was released.</i>  <i>Part of this release was the launch of the integrated Docker Container Registry.</i>  <i>Below is a translation of a May article devoted to this.</i> </p><br><p>  We recently released <a href="https://habrahabr.ru/company/softmart/blog/302884/">GitLab version 8.8</a> , in which CI support has become even better.  Now in GitLab, you can build pipelines for visualizing builds, tests, deployments, and any other steps in the life cycle of your software.  Today we present you the next step: GitLab Container Registry. </p><br><p>  GitLab Container Registry is a secure, private registry for Docker images (images) developed using <a href="https://github.com/docker/distribution">open source software</a> .  GitLab Container Registry is <em>fully</em> integrated into GitLab. </p><br><p>  Key features of GitLab are the continuity of the development process and the mutual integration of various elements;  these principles are also maintained when working with our registry.  Now with the help of the GitLab Container Registry you can use your Docker images for GitLab CI, create special images for individual tags and branches, and much more. </p><br><p>  It is worth noting that the GitLab Container Registry is the first Docker registry fully integrated into the Git repository management system.  In addition, the GitLab Container Registry does not require a separate installation, as it is part of GitLab 8.8;  With it, you can easily download and upload images to GitLab CI.  And it's free. </p><br><p>  To learn how to enable the use of the GitLab Container Registry, refer to the <a href="http://docs.gitlab.com/ce/administration/container_registry.html">administrator's documentation</a> . </p><br><a name="habracut"></a><br><h2 id="osnovy-docker">  Docker Basics </h2><br><p>  The basic unit of work with Docker is an image that contains everything you need to start and run an application.  Often, images are created automatically as part of a continuous integration process ‚Äî that is, they are updated every time the code changes.  In cases where images are created for sharing, they need to be stored somewhere.  Just for this and apply the registry of images. </p><br><p>  The registry allows you to store images for further reuse and categorize them using tags.  It is a good idea to create a registry to store private images that are used only within the company, or, for example, images for running and running tests.  When using the GitLab Container Registry, you do not need to configure and maintain additional services or use public registries. </p><br><h2 id="tesnaya-integraciya-s-gitlab">  Tight integration with GitLab </h2><br><p>  GitLab Container Registry is fully integrated into GitLab, which allows developers to easily create, test, and run Docker images using GitLab CI or other Docker compatible tools. </p><br><ul><li>  For authentication and access restriction, users and groups from your GitLab instance are used. </li><li>  There is no need to create additional repositories for working with the registry - the registry is part of your project in GitLab. </li><li>  A new tab Container Registry appears in the project, which lists all the images related to this project. </li><li>  Each project can have its own registry of images (optionally, it can be disabled for any single project). </li><li>  You can easily download and upload images on GitLab CI. </li><li>  No need to download and install additional software. </li></ul><br><h2 id="uprostite-vash-rabochiy-process">  Simplify your workflow </h2><br><p>  Working with the GitLab Container Registry is simple and secure.  Here are some examples of how using the GitLab Container Registry can simplify the process of developing and deploying software: </p><br><ul><li>  Build Docker images using GitLab CI and then storing them in the GitLab Container Registry. </li><li>  Snap images to branches, source code tags, or use any other method appropriate for your development process.  Created images can be quickly and easily saved to GitLab. </li><li>  Use your own build images stored in your registry to test applications. </li><li>  Let the rest of the team members also participate in the design of images.  This will not require additional efforts from them, since the same workflow to which they are used is used.  GitLab CI allows you to automatically build images that are inherited from yours, which in turn makes it easy to add fixes and new features to the base image used by your team. </li><li>  Configure CaaS to use images directly from the GitLab Container Registry, thus obtaining a continuous code deployment process.  This will allow you to automatically deploy applications to the cloud (Docker Cloud, Docker Swarm, Kubernetes, etc.) each time you build or test an image. </li></ul><br><h2 id="s-chego-nachat">  Where to begin? </h2><br><p>  First of all, ask your system administrator to connect the GitLab Container Registry as described in the <a href="http://docs.gitlab.com/ce/administration/container_registry.html">administrator documentation</a> . </p><br><p>  After that, you can enable the <strong>Container Registry</strong> option in your project. </p><br><p><img src="https://about.gitlab.com/images/container-registry/project_feature.png"></p><br><p>  In order to start using the registry, you first need to log in: </p><br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">docker</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">login</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">registry</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.example</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.com</span></span></code> </pre> <br><p>  After that, you can simply collect and push images on GitLab: </p><br><pre> <code class="hljs cs">docker build -t registry.example.com/<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>/project . docker push registry.example.com/<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>/project</code> </pre> <br><p>  GitLab also provides a simple interface for managing containers.  Click on the <strong>Container Registry</strong> in your project - in the opened window you will see all the tags in your repository and you can easily remove any of them. </p><br><p><img src="https://about.gitlab.com/images/container-registry/container_registry.png"></p><br><blockquote>  For more information, see the <a href="http://docs.gitlab.com/ce/container_registry/README.html">GitLab Container Registry user guide</a> . </blockquote><br><h2 id="ispolzuyte-sovmestno-s-gitlab-ci">  Use with GitLab CI </h2><br><p>  The built-in interface for managing GitLab's CI can be used to assemble, push, and deploy created images. </p><br><blockquote>  <strong>Warning:</strong> this requires GitLab Runner 1.2. <br><br>  <strong>Warning:</strong> In order to use Docker in Docker images, you need to set <a href="">the privileged flag</a> in the Runner configuration.  <s>So far, this <strong>cannot be</strong> done in shared runners on GitLab.com.</s>  <s>We plan to add this flag in the near future, but for now you should use your own Runners.</s> </blockquote><p>  Here is an example of a GitLab CI configuration file ( <code>.gitlab-ci.yml</code> ) that <code>.gitlab-ci.yml</code> image, runs tests and, if passed successfully, assigns a build tag and loads the build into the image registry: </p><br><pre> <code class="hljs perl">build_image: image: docker:git services: - docker:dind script: - docker login -u gitlab-ci-token -p $CI_BUILD_TOKEN registry.example.com - docker build -t registry.example.com/<span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-group/<span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-project . - docker run registry.example.com/<span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-group/<span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-project /script/to/run/tests - docker <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> registry.example.com/<span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-group/<span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-project:latest only: - master</code> </pre> <br><p>  An example of a more complex image that divides tasks into 4 stages, within which two tests are performed in parallel.  The build is stored in the registry of images and is used in subsequent stages, automatically downloading the image if necessary.  Changes to the master branch are assigned the <code>latest</code> tag, after which these changes are deployed using an application-specific script: </p><br><pre> <code class="hljs sql">image: docker:git services: - docker:dind stages: - build - test - <span class="hljs-keyword"><span class="hljs-keyword">release</span></span> - deploy <span class="hljs-keyword"><span class="hljs-keyword">variables</span></span>: CONTAINER_TEST_IMAGE: registry.example.com/my-<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>/my-<span class="hljs-keyword"><span class="hljs-keyword">project</span></span>:$CI_BUILD_REF_NAME CONTAINER_RELEASE_IMAGE: registry.example.com/my-<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>/my-<span class="hljs-keyword"><span class="hljs-keyword">project</span></span>:latest before_script: - docker login -u gitlab-ci-token -p $CI_BUILD_TOKEN registry.example.com <span class="hljs-keyword"><span class="hljs-keyword">build</span></span>: stage: <span class="hljs-keyword"><span class="hljs-keyword">build</span></span> script: - docker <span class="hljs-keyword"><span class="hljs-keyword">build</span></span> -t $CONTAINER_TEST_IMAGE . - docker push $CONTAINER_TEST_IMAGE test1: stage: <span class="hljs-keyword"><span class="hljs-keyword">test</span></span> script: - docker run $CONTAINER_TEST_IMAGE /script/<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>/run/tests test2: stage: <span class="hljs-keyword"><span class="hljs-keyword">test</span></span> script: - docker run $CONTAINER_TEST_IMAGE /script/<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>/run/another/<span class="hljs-keyword"><span class="hljs-keyword">test</span></span> <span class="hljs-keyword"><span class="hljs-keyword">release</span></span>-image: stage: <span class="hljs-keyword"><span class="hljs-keyword">release</span></span> script: - docker pull $CONTAINER_TEST_IMAGE - docker tag $CONTAINER_TEST_IMAGE $CONTAINER_RELEASE_IMAGE - docker push $CONTAINER_RELEASE_IMAGE <span class="hljs-keyword"><span class="hljs-keyword">only</span></span>: - <span class="hljs-keyword"><span class="hljs-keyword">master</span></span> deploy: stage: deploy script: - ./deploy.sh <span class="hljs-keyword"><span class="hljs-keyword">only</span></span>: - <span class="hljs-keyword"><span class="hljs-keyword">master</span></span></code> </pre> <br><h2 id="podvodya-itogi">  Summing up </h2><br><p>  GitLab Container Registry is the latest addition to the integrated toolkit for the GitLab software development cycle.  This add-on is available from version <a href="https://habrahabr.ru/company/softmart/blog/302884/">GitLab 8.8</a> .  Using this functionality, testing and deploying Docker images has become much easier.  The GitLab Container Registry comes bundled with GitLab CE and GitLab EE at no extra charge and is installed on top of the same infrastructure that you have configured for GitLab. </p><br><p>  The Container Registry is available at GitLab.com, it is absolutely free, and you can start using it right now! </p><br><blockquote>  <strong>Important</strong> : In order to use Docker in Docker images you need to set <a href="">the privileged flag</a> in the Runner settings.  <s>So far, <strong>this cannot be</strong> done in general Runners on GitLab.com.</s>  <s>We are planning to add this flag in the near future.</s>  Everything is already ok. </blockquote><p>  PS It would be great if you share your experience in the comments. </p><br><p>  <i>Translation from English is made by translational artel "Nadmozg and partners", <a href="http://nadmosq.ru/">http://nadmosq.ru</a> .</i>  <i>Over translation worked <a href="https://habrahabr.ru/users/sgnl_05/" class="user_link">sgnl_05</a> .</i> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/309102/">https://habr.com/ru/post/309102/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309092/index.html">Visualization of the photo portfolio. Part 1: Unusual deep learning</a></li>
<li><a href="../309094/index.html">Samsung has created a ‚Äúdigital eye‚Äù based on the IBM Truenorth chip</a></li>
<li><a href="../309096/index.html">Dagaz: In the wilds of notations</a></li>
<li><a href="../309098/index.html">[St. Petersburg, Announcement] CodeFreeze meeting with PHP developer Dmitry Stogov about the internal structure of the PHP virtual machine</a></li>
<li><a href="../309100/index.html">How technology companies affect the media business</a></li>
<li><a href="../309104/index.html">Grouping Android phone models by Docker containers</a></li>
<li><a href="../309106/index.html">Book on intensive data processing</a></li>
<li><a href="../309110/index.html">Logic hoster: not caught - not a thief. How to prove the opposite. Service Overview HostTracker Part 3</a></li>
<li><a href="../309112/index.html">Huawei Connect 2016 Shanghai</a></li>
<li><a href="../309114/index.html">Visualization of the photo portfolio. Part 2: Word embedding</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>