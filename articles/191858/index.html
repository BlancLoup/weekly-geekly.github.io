<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Another JavaScript preprocessor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Are you interested in the possibility of writing such things in JavaScript? 



$ ('.btn-toogle').onclick (lambda $ (this).toggleClass ('active'));  
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Another JavaScript preprocessor</h1><div class="post__text post__text-html js-mediator-article">  Are you interested in the possibility of writing such things in JavaScript? <br><br><pre><code class="javascript hljs">$ (<span class="hljs-string"><span class="hljs-string">'.btn-toogle'</span></span>).onclick (lambda $ (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).toggleClass (<span class="hljs-string"><span class="hljs-string">'active'</span></span>));</code> </pre> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> chars = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.prototype.forEach.call (<span class="hljs-string"><span class="hljs-string">'0123456789abcdef'</span></span>, lambda arg.charCodeAt (<span class="hljs-number"><span class="hljs-number">0</span></span>));</code> </pre> <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fn</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arg1 = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">100</span></span></span></span><span class="hljs-function"><span class="hljs-params">, arg2 = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'test'</span></span></span></span></span><span class="hljs-function">)</span></span>{ ... }</code> </pre> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> html = h<span class="hljs-string"><span class="hljs-string">` &lt;div&gt; &lt;a href="..."&gt;link&lt;/a&gt; &lt;/div&gt;`</span></span>;</code> </pre> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key, value <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> object) <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log (key + <span class="hljs-string"><span class="hljs-string">' = '</span></span> + value);</code> </pre> <br><br>  Then perhaps this article will interest you. <br><a name="habracut"></a><br>  I will not paint any boring things like stories or why I did this thing.  Better try to briefly tell how it works and what it can do. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The preprocessor is written in Node.JS, and the <a href="http://pegjs.majda.cz/">PEG.js</a> parser generator is used to parse JavaScript.  By the way, one of the strengths of the preprocessor (well, for me personally) is that regular JavaScript code parses perfectly.  Well, if, of course, there are no keywords in the code like lambda, module, import or export. <br><br>  Of course, the JavaScript parser does not differ in performance, but, fortunately, caching quite compensates for this. <br><br>  Most of the features already described above, but now I will try to talk about them in more detail. <br><br><h4>  1. Abbreviated recording of functions. </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> way0 = lambda arg.charCodeAt (<span class="hljs-number"><span class="hljs-number">0</span></span>), way1 = lambda (arg) arg.charCodeAt (<span class="hljs-number"><span class="hljs-number">0</span></span>), way2 = lambda { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> arg.charCodeAt (<span class="hljs-number"><span class="hljs-number">0</span></span>) }, way3 = lambda (arg){ arg.charCodeAt (<span class="hljs-number"><span class="hljs-number">0</span></span>) }, result = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arg</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> arg.charCodeAt (<span class="hljs-number"><span class="hljs-number">0</span></span>) };</code> </pre> <br>  All four recording methods give the same result.  The arg argument is added to functions that lack the usual arguments.  If the whole body of the function consists of a single operation (statement; to be honest, I don‚Äôt know how to correctly speak Russian), the function will return the result of this operation. <br><br>  Here are a couple of examples: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-comment"><span class="hljs-comment">//     example0 = lambda (a, b, c, d) a + b + c + d, //   forEach example1 = lambda (a, fn) for (var i = 0; i &lt; a.length; i ++) fn (a [i]), //     a  b. example2 = lambda { a: arg * 2, b: arg };</span></span></code> </pre> <br><br><h4>  2. Arguments of functions by default. </h4><br>  Nothing particularly, the headline already speaks for itself. <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fn</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arg1 = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">100</span></span></span></span><span class="hljs-function"><span class="hljs-params">, arg2 = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'test'</span></span></span></span></span><span class="hljs-function">)</span></span>{ ... }</code> </pre> <br>  Arguments will be compared (without type casting) with undefined.  If suddenly they are equal, they will be set to default values. <br><br><h4>  3. Multi-line strings (I apologize for such an ugly expression). </h4><br>  For starters, this is just a way to write strings using the ‚Äú` ‚Äùcharacter as quotes.  You can finally stop placing "\" at the ends of lines (although, I confess, no one usually writes so that multi-line strings are needed).  But that is not all.  Depending on the character before the opening quote, the preprocessor can somehow process the text inside in a special way.  Write ‚Äúh‚Äù and the preprocessor will compress the string as html-code, ‚Äúc‚Äù - as css-code, ‚Äús‚Äù - remove consecutive spaces, ‚Äúl‚Äù - convert LESS inside the string into CSS (well, also compress), and lp ‚Äùis my favorite :) - not only will convert LESS to CSS, but also leave the possibility to further define properties through JavaScript.  Pretty comfortable. <br><br><h4>  4. Modules. </h4><br>  In short, it is in some sense an analogue of classes from the same Java.  But by no means ordinary classes.  JavaScript already has prototypes, right? <br><br>  Modules replace what is commonly called static classes in other languages ‚Äã‚Äã(I hope this term exists). <br><br><h6>  An example of a simple module: </h6><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span> Example { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... } }</span></span></code> </pre> <br>  The "init" function will be called when the script starts (well, more on that later). <br><br><h6>  And two modules look like this, if one of them is used by the other: </h6><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span> First { <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log (<span class="hljs-string"><span class="hljs-string">'    .'</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log (<span class="hljs-string"><span class="hljs-string">' ‚Äî .'</span></span>); } } <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> Second { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> First; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log (<span class="hljs-string"><span class="hljs-string">'   ‚Äî ,       ,   .'</span></span>); First.test (); } }</code> </pre> <br><br>  If you put in front of the name of the imported class "@", the imported class can be initialized and later imported.  It helps if each of the two classes suddenly needs to import another, although, of course, architecturally this structure looks repulsive. <br><br>  Well, there are also exported variables available only for reading: <br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span> First { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> @Second; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log (<span class="hljs-string"><span class="hljs-string">'    ¬´1024¬ª: '</span></span> + Second.value); } } <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> Second { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> First; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value = <span class="hljs-number"><span class="hljs-number">1024</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ First.test (); } }</code> </pre> <br><br>  By the way, it is not necessary to use modules by other modules.  Although desirable.  :) <br><br><h4>  5. Preprocessor options. </h4><br>  To customize the build code, you can use tricky comments at the beginning of the file: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ==Jsx== // @target web:onload // @build-to build/ // @define __VERSION__ 1.00 // @import utils/string.format // @include jquery.min.js // ==/Jsx==</span></span></code> </pre> <br>  (Approximately in the same style comments for UserScript are written.) <br><br><ul><li>  <b>target</b> - indicates where the script will be executed.  The code that initializes the modules depends on this argument.  Valid values ‚Äã‚Äãare ‚Äúweb‚Äù (the window variable will be used), ‚Äúweb: onload‚Äù (the modules will begin to initialize when the page is finished loading), ‚Äúnode‚Äù (for Node.JS, GLOBAL will be used), ‚Äúlocal‚Äù. </li><li>  <b>build-to</b> - indicates where to save the result.  By default, the script saves it to the same folder, replacing the ‚Äújsx‚Äù extension with ‚Äújs‚Äù (or adding the ‚Äújs‚Äù extension if the original file has a different extension from ‚Äújsx‚Äù. </li><li>  <b>define</b> - replaces all occurrences of the first argument with the second in the <i>resulting</i> file.  Sometimes it comes in handy. </li><li>  <b>import</b> - will include the file with the extension ‚Äújsxi‚Äù (which is not necessary to write in the parameter), beforehand.  If the file is not found in the folder next to it, the search will continue in the folder with the included preprocessor files.  (Well, there is a rather cunning algorithm; perhaps you should not write such trifles here.) </li><li>  <b>include</b> - will include the file in the result without analyzing in any way and do not worry. </li></ul><br><br>  These are not all parameters, as well as not all features, but, in my opinion, the article has already turned out to be too big for a brief description. <br><br>  Download the current version <a href="https://github.com/gro-ove/js-ext">from here</a> .  I apologize in advance for all possible errors and thank you for your attention.  :) </div><p>Source: <a href="https://habr.com/ru/post/191858/">https://habr.com/ru/post/191858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../191848/index.html">Bur. Module for mass registration of users</a></li>
<li><a href="../191850/index.html">Make a "mindmap" on Javascript with local storage in the browser database</a></li>
<li><a href="../191852/index.html">Using the Aastra 6725ip and Aastra 6721ip IP terminals in the MS Lync 2013 Server infrastructure</a></li>
<li><a href="../191854/index.html">Raspberry Pi in the hands of an amateur or home rocking torrent</a></li>
<li><a href="../191856/index.html">Is cloudy IP PBX suitable for small companies?</a></li>
<li><a href="../191860/index.html">The attacker got caught selling root accesses to supercomputers</a></li>
<li><a href="../191862/index.html">A little bit about how we wrote a photo mosaic generator for Android</a></li>
<li><a href="../191864/index.html">The use of IT in the search for new drugs: an overview of areas</a></li>
<li><a href="../191866/index.html">Electronic signature formats</a></li>
<li><a href="../191868/index.html">File Monitoring with GCD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>