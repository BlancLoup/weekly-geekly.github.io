<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Wiring Alternative for Arduino - BASCOM-AVR</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Well, I do not like this your wiring. And for some reason, he also compiles me very slowly, and then he thinks for a long time before the firmware. 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Wiring Alternative for Arduino - BASCOM-AVR</h1><div class="post__text post__text-html js-mediator-article">  Well, I do not like this your wiring.  And for some reason, he also compiles me very slowly, and then he thinks for a long time before the firmware. <br>  I will try to talk about an alternative environment for programming AVR controllers, which combines a code editor, compiler, and debugger simulator.  In addition, in the latest versions, the environment without unnecessary gestures can be used with the Arduino bootloader (that is, without reworking the board, flashing the bootloader, etc.) <br><img src="https://habrastorage.org/storage2/f33/2ad/a97/f332ada97de9dec2f46f29ed87adcc2d.jpg"><br><a name="habracut"></a><br><br><h4>  Installation <br></h4>  We go to <a href="http://www.mcselec.com/">Offsite</a> , or simply follow the second link at the end of the topic - the demo version of the environment will immediately start loading (30Mb).  The demo only means that it will allow you to collect projects whose compiled weight does not exceed 4K.  For most projects, this is enough (yeah, especially for <a href="http://www.atmel.com/Images/doc2543.pdf">Attiny2313</a> ), and if not - the <s>crack for the latest version on the rutreker</s> will have to be bought, since it costs not so much - <a href="http://www.mcselec.com/index.php%3Fpage%3Dshop.product_details%26flypage%3Dshop.flypage%26product_id%3D86%26category_id%3D5%26option%3Dcom_phpshop%26Itemid%3D1">89 euros</a> . <br>  The installation is completely normal, if someone does not run in Win7 and above - set the compatibility mode with XP.  Vain works perfectly fine.  Actually, you can not install - just copy the folder, quite a portable version. <br><br><h4>  Using <br></h4>  Main window: <br><img src="https://habrastorage.org/storage2/654/630/58a/65463058a618688cbe6de50683a65289.jpg"><br>  All buttons are prompted, and I think there is no need to explain what and where is located. <br>  In the latest versions, she was very decently translated into Russian, which can be included in Options - Environment - IDE - Language - Russian. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Here I have a copy of the Arduino Nano board, which I used for a long time when debugging, flashing directly through the connector of the programmer, because of dislike for the Arduino IDE. <br><img src="https://habrastorage.org/storage2/f72/ac4/421/f72ac4421179afb2c76cd58a578db6ca.png"><br>  Let's try to write something for her.  First you need to set the type of MK - Atmega168, this is done here with this line: <br><pre><code class="vbscript hljs">$regfile = <span class="hljs-string"><span class="hljs-string">"m168def.dat"</span></span></code> </pre> <br>  Why such a line, thinking it is clear.  Of course, you can set the type of controller in Settings - Compiler - MK, but in the text it is more convenient.  You can see how the files for different controllers are called in the program folder (c: \ Program Files \ MCS Electronics \ BASCOM-AVR \ *. Dat). <br>  Set the clock frequency: <br><pre> <code class="vbscript hljs">$crystal = <span class="hljs-number"><span class="hljs-number">16000000</span></span></code> </pre> <br>  16MHz  Does not affect anything, except for counting time intervals (waitms).  Does not set the frequency for the controller.  You still have to expose it yourself, I program the Fuse block.  However, for Arduino this can not bother. <br>  Configuring ports: <br><pre> <code class="vbscript hljs">Config Portb<span class="hljs-number"><span class="hljs-number">.5</span></span> = Output</code> </pre> <br>  No number pins, only hardcore.  We look at the specific controller, and see the names of the ports: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/9f2/92c/5b6/9f292c5b6626539ea2c9ede1fa75cc14.gif" alt="image"><br>  PD1 = portd.1, pb4 = portb.4 <br>  You can set each port separately, but simply write: Config Portb = Output <br><br>  We start an unconditional cycle (it can be done without it, then the program will be executed only once when the controller is started) <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span></code> </pre><br><br>  And inside it, for example, we blink an LED: <br><pre> <code class="vbscript hljs"> Toggle Portb<span class="hljs-number"><span class="hljs-number">.5</span></span></code> </pre> <br>  Portb.5 is the same as pin 13 in arduine.  Compliance (if you are used to the name of the port) can be found here: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/36b/159/da5/36b159da57b542bdda427e610acc80e7.png" alt="image"><br><br>  The syntax is very simple and resembles basic.  7 types of variables: <b>Bit, Byte, Integer, Word, Long, Single, String.</b> <br>  Which are announced at the beginning of the program like this: <b>Dim A as Single</b> <br>  A very simple connection to the screens on the HD44780 controller: <br><pre> <code class="vbscript hljs">Config lcd = <span class="hljs-number"><span class="hljs-number">16</span></span>*<span class="hljs-number"><span class="hljs-number">2</span></span> Config lcdpin = PIN, DB4 = PORTB<span class="hljs-number"><span class="hljs-number">.1</span></span>,DB5=PORTB<span class="hljs-number"><span class="hljs-number">.2</span></span>,DB6=PORTB<span class="hljs-number"><span class="hljs-number">.3</span></span>,DB7=PORTB<span class="hljs-number"><span class="hljs-number">.4</span></span>,E=PORTB<span class="hljs-number"><span class="hljs-number">.5</span></span>,RS=PORTB<span class="hljs-number"><span class="hljs-number">.6</span></span> Config lcdmode = PORT</code> </pre><br>  And the same simple text output to them: <br><pre> <code class="vbscript hljs">Lcd <span class="hljs-string"><span class="hljs-string">"Hello, habr! "</span></span> ; <span class="hljs-built_in"><span class="hljs-built_in">time</span></span></code> </pre> <br>  But despite the simplicity, there is a cursor control, built-in character editor, support for the Cyrillic alphabet. <br>  Simple sound generation: <br><pre> <code class="vbscript hljs">Sound, Portb<span class="hljs-number"><span class="hljs-number">.0</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span></code> </pre> <br>  That means, to issue on PB0 a meander with a frequency of 500 Hz and a duration of 100 ms. <br>  DTMF tone generation: <br><pre> <code class="vbscript hljs">Dtmfout, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span></code> </pre> <br>  15th tone for 100ms. <br>  Work with UART (both with hardware and software): <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> Name as <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> * <span class="hljs-number"><span class="hljs-number">10</span></span> $Baud = <span class="hljs-number"><span class="hljs-number">9600</span></span> Input <span class="hljs-string"><span class="hljs-string">"Hello, print you name"</span></span>, Name Print <span class="hljs-string"><span class="hljs-string">"Name: "</span></span> ; Name</code> </pre><br>  Interrupt handling: <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">On</span></span> Int0 Button -   Config Int0 = Low Level -     Enable Interrupts -   Enable Int0 Button: Incr Cntr Return</code> </pre> <br>  With timers: <br><pre> <code class="vbscript hljs">Config Timer0 = <span class="hljs-built_in"><span class="hljs-built_in">Timer</span></span> , Prescale = <span class="hljs-number"><span class="hljs-number">64</span></span> -     <span class="hljs-keyword"><span class="hljs-keyword">On</span></span> Timer0 Pulse: -   Enable Interrupts -   Enable Timer0 Pulse: Incr Cntr Return</code> </pre> <br><br><h4>  Arduino firmware <br></h4>  In the latest version, developers have added support for the Arduine bootloader, and we only need to make a few settings. <br>  <b>Options - Programmer - ARDUINO</b> .  After that, specify the com-port, and speed. <br><img src="https://habrastorage.org/storage2/eab/2c9/4a1/eab2c94a1f9cef363ca92540f184161f.jpg"><br>  In my case, the speed had to be sure to specify exactly 19200, otherwise the board was not flashing.  You can view the parameters of all the boards in the file at <b>arduino-1.0.1 \ hardware \ arduino \ boards.txt</b> <br>  By the way, there is also the size of the memory, and the frequency of the crystal: <br><br><pre> <code class="vbscript hljs">nano.name=Arduino Nano w/ ATmega168 nano.upload.maximum_size=<span class="hljs-number"><span class="hljs-number">14336</span></span> nano.upload.speed=<span class="hljs-number"><span class="hljs-number">19200</span></span> nano.bootloader.low_fuses=<span class="hljs-number"><span class="hljs-number">0xff</span></span> nano.bootloader.high_fuses=<span class="hljs-number"><span class="hljs-number">0xdd</span></span> nano.bootloader.extended_fuses=<span class="hljs-number"><span class="hljs-number">0x00</span></span> nano.build.mcu=atmega168 nano.build.f_cpu=<span class="hljs-number"><span class="hljs-number">16000000</span></span>L</code> </pre><br><br>  An alternative way to boot (I do not like the built-in flash driver with its slowness) - using AVRDUDE, the most powerful console programmer. <br>  Download the latest version <a href="http://download.savannah.gnu.org/releases/avrdude/">from here</a> , for example <a href="">avrdude-5.11.tar.gz</a> .  We unpack in a folder with the program. <br>  Go to <b>Options - Programmer - External Programmer</b> , and specify the path to the executable file after <b>Programm</b> : <br>  <b>"C: \ Program Files \ MCS Electronics \ BASCOM-AVR \ ARVDUDE \ avrdude.exe"</b> <br>  And in the following, the parameters are as follows: <br>  <b>-C "C: \ Program Files \ MCS Electronics \ BASCOM-AVR \ ARVDUDE \ avrdude.conf" -p atmega168 -P com2 -c arduino -b 19200 -U flash: w: {FILE}: i</b> <br>  Everything is clear from the names, we show where the config lies, indicate the type of controller, port, protocol, speed, work with flash, record, and file.  Put a tick <b>Use HEX file.</b> <br>  For greater joy, you can also mention the item <b>Program after compile</b> - to compile and flash with one button. <br>  When assembling, the program shows the consumption of available flash: <br><img src="https://habrastorage.org/storage2/a55/79d/5b1/a5579d5b12f98d025012c87ffcb073fd.jpg"><br>  And then ARVDUDE starts up: <br><img src="https://habrastorage.org/storage2/4c4/fc9/dc7/4c4fc9dc72ba19aeb359c47d06221e10.jpg"><br><br>  You can also turn on the help on the pins of the selected controller (there is a default, and if not, then <b>View - Pin Layout is</b> enabled): <br><img src="https://habrastorage.org/storage2/a62/c59/405/a62c5940570f8f8a54e54b53d07acaef.jpg"><br>  When you hover over the pin, shows its name and description. <br>  If this is not enough, then you can download the datasheet and enable <b>View - PDF Viewer</b> : <br><img src="https://habrastorage.org/storage2/d91/43e/c56/d9143ec56cfce5b23f260cd74ef3080a.jpg"><br><br>  Another cool thing is the built-in debugger with iron simulation, break-points and step-by-step execution. <br><img src="https://habrastorage.org/storage2/743/be0/a16/743be0a163d6758c7fce36053afcfd20.jpg"><br>  It is activated by pressing a button with a red microcircuit, of course, you must first compile the program. <br><br>  And for sweetness, the code compiled in bascom is much smaller in size and is often executed faster than the code from the Arduino IDE. <br>  For example, the standard blink (flashing LED): <br>  For Arduino: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ pinMode(<span class="hljs-number"><span class="hljs-number">13</span></span>, OUTPUT); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ digitalWrite(<span class="hljs-number"><span class="hljs-number">13</span></span>, HIGH); digitalWrite(<span class="hljs-number"><span class="hljs-number">13</span></span>, LOW); }</code> </pre><br>  It is compiled into a hex with the size of 3078 (!!!) bytes, and it pulls the pin with a frequency of 210kHz: <br><img src="https://habrastorage.org/storage2/390/9a7/8c9/3909a78c9d51edf7506df834f7a317fc.gif"><br><br>  And in Bascom, written like this: <br><pre> <code class="vbscript hljs">$regfile = <span class="hljs-string"><span class="hljs-string">"m168def.dat"</span></span> $crystal = <span class="hljs-number"><span class="hljs-number">16000000</span></span> Config Portb<span class="hljs-number"><span class="hljs-number">.5</span></span> = Output <span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> Toggle Portb<span class="hljs-number"><span class="hljs-number">.5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span></code> </pre><br>  It takes 553 bytes (five times less) hex, and already flashes at 1.6 MHz: <br><img src="https://habrastorage.org/storage2/b7f/446/ec0/b7f446ec0d5aceb1640781a06e97487f.gif"><br><br><h4>  References: <br></h4><ul><li>  <a href="http://www.mcselec.com/">Offsite</a> </li><li>  <a href="http://www.mcselec.com/index.php%3Foption%3Dcom_docman%26task%3Ddoc_download%26gid%3D139%26Itemid%3D54">The latest version of Bascom-AVR</a> </li><li>  <a href="http://www.mcselec.com/index.php%3Foption%3Dcom_content%26task%3Dcategory%26sectionid%3D7%26id%3D79%26Itemid%3D57%26limit%3D50%26limitstart%3D0">About 100 examples with detailed diagrams and code listings</a> </li><li>  <a href="http://decada.org.ru/project/lessons/bascom_avr/">Wonderful Russian textbook from WildCat</a> (you should follow the link even just for the sake of reading the introduction) </li><li>  <a href="http://avr.ru/beginer/bascom">Another textbook in Russian</a> .  And there is also <a href="http://avr.ru/beginer/c_and_pascal">a microC and microPascal textbook</a> written by a respected <a href="http://geektimes.ru/users/moriam/" class="user_link">moriam</a> that does not have an invite (yes, this is a hint) </li><li>  <a href="http://bascom.at.ua/">Russian site with projects</a> </li><li>  <a href="http://bascomavr.3bb.ru/">Active Russian forum</a> </li><li>  <a href="http://avrproject.ru/search/bascom-avr/">Another bunch of articles, books and projects</a> </li><li>  <a href="http://radiokot.ru/forum/viewtopic.php%3Ff%3D20%26t%3D6408">The topic of discussion on radiokot</a> </li><li>  <a href="http://www.cqham.ru/forum/showthread.php%3Ft%3D15569%26page%3D1">Cqham discussion thread</a> </li><li>  Do not go <a href="http://bascom-avr.narod.ru/">here</a> , much less read.  Site "for search engines", which in the examples a bunch of errors.  And all in order to resell a couple of modules. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/151544/">https://habr.com/ru/post/151544/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151538/index.html">Gif sockets. Real-time communication via animated GIF</a></li>
<li><a href="../151539/index.html">Software Freedom Day in the province: Saratov</a></li>
<li><a href="../151540/index.html">A bunch of MODx Revolution + LiveStreet</a></li>
<li><a href="../151542/index.html">Copyright vs file sharing. The main issue of information philosophy</a></li>
<li><a href="../151543/index.html">All stocks of the iPhone 5 sold out in less than an hour</a></li>
<li><a href="../151548/index.html">There is something magical in Firefox OS</a></li>
<li><a href="../151549/index.html">Crash tests of mobile phones marked "moisture protection". Part 1</a></li>
<li><a href="../151550/index.html">Meet the free and free font "Stalin"</a></li>
<li><a href="../151551/index.html">We make a moisture resistant device</a></li>
<li><a href="../151552/index.html">Conference Report ‚ÄúLooking to the Electronic Future‚Äù - #eFuture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>