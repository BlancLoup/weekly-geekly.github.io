<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We try Orchard CMS for a corporate site</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 We have a corporate website on Liferay, and it requires a rather painstaking work at the stage of creating the layout. We decided to see how...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We try Orchard CMS for a corporate site</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br><br>  We have a <a href="http://eastbanctech.ru/">corporate website</a> on Liferay, and it requires a rather painstaking work at the stage of creating the layout.  We decided to see how the creation of a custom section in Liferay differs from the same process in Orchard CMS in such a small task as creating corporate news. <br><br><img src="https://habrastorage.org/storage2/fb3/376/288/fb3376288cf5a1aa2b13c3e9d594d1b8.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What we got out of this: <br><br><a name="habracut"></a><h4>  Orchard setup: </h4><br><br>  The implementation of the ‚ÄúNews‚Äù section consists of the following parts: <br><ol><li>  Content type. </li><li>  Content type settings. </li><li>  The content itself. </li><li>  Request. </li><li>  Projection - how everything will look on the site.  Customization of external elements. </li></ol><br><br><h5>  Creating a type of "News" and request (for display on the main page): </h5><br><br>  1. Create ContentType: <br><br><img src="https://habrastorage.org/storage2/0a4/3a4/fbc/0a43a4fbc2bd205493d135ab95f327a9.png"><br><br><img src="https://habrastorage.org/storage2/659/471/22e/65947122e10f3f6940f143a412d1c83f.png"><br><br><img src="https://habrastorage.org/storage2/2f4/ff7/550/2f4ff75508c7f3310d4f65cfdd156bbd.png"><br><br><img src="https://habrastorage.org/storage2/d65/86e/9cf/d6586e9cf13b7c5347c0498704291289.png"><br><br><br>  2. Add a picture to the news: <br><br><img src="https://habrastorage.org/storage2/950/18e/3d8/95018e3d80b04eafcc4475b60b915f1a.png"><br><br>  3. Create a request <br>  3.1. <br><br><img src="https://habrastorage.org/storage2/dd3/514/efd/dd3514efdb2f61ea0530d7682e70f72f.png"><br><br>  3.2.  Now you need to configure filters for the query: <br><br><img src="https://habrastorage.org/storage2/5de/336/261/5de3362613f4b89a3ab6a54a95c54b10.png"><br><br>  3.3.  Determine the sort order: <br><br><img src="https://habrastorage.org/storage2/ac8/af3/86e/ac8af386e2fc244da735295fc61acb77.png"><br><br>  3.4.  Since  the result of the request must be shown somewhere, we create Projection: <br><br><img src="https://habrastorage.org/storage2/222/d15/36e/222d1536edcafb6e00eb0c28624e3409.png"><br><br>  Now on the main page will be a projection.  You can create several news items in the dashboard. <br><br><h4>  Customization of appearance </h4><br><h5>  Create a topic </h5><br>  You must download and enable the Code generation module: <a href="http://docs.orchardproject.net/Documentation/Command-line-scaffolding">http://docs.orchardproject.net/Documentation/Command-line-scaffolding</a> <br><br>  Next, open the folder with the installed Orchard -&gt; bin -&gt; orchard.exe, wait until it is initialized, we write: codegen theme &lt;theme-name&gt; / BasedOn: TheTheMachine / CreateProject: true <br><br>  We open the project with the topic: <br><br><img src="https://habrastorage.org/storage2/047/e3d/ca5/047e3dca50890b8422392b29cd70b2db.png"><br><br>  And we cannot create the Razor template ... In order for us to create .cshtml files from the studio interface, you need to unload the project, open the project file with any text editor and modify the ProjectTypeGuids, adding {E53F8FEA-EAE0-44A6-8774-FFD645390401 to it }.  Our result is: {E53F8FEA-EAE0-44A6-8774-FFD645390401}; {349c5851-65df-11da-9384-00065b846f21}; {fae04ec0-301f-11d3-bf4b-00c04f79efbc}.  Now you can save the project file and upload it to the studio. <br><br><img src="https://habrastorage.org/storage2/507/dc9/e60/507dc9e60a371f9ae624e5e285a61f6e.png"><br><br>  All theme files not found in the current one are taken from the base one, if defined, or from the SafeMode theme.  We need to change the favicon and connect the scripts, the favicon is connected only in the template ‚ÄúDocument.cshtml‚Äù, the scripts associated with the theme are usually connected here. <br><br>  Now we can create Document.cshtml in the Views folder. <br>  Inside this file, we add links to scripts, register favicon, and the rest of the code is taken from a similar file in the SafeMode topic. <br>  Views \ Document.cshtml: <br><br><pre><code class="cs hljs">@<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Mvc.Html; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.UI.Resources; @{ RegisterLink(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LinkEntry { Type = <span class="hljs-string"><span class="hljs-string">"image/x-icon"</span></span>, Rel = <span class="hljs-string"><span class="hljs-string">"shortcut icon"</span></span>, Href = Url.Content(<span class="hljs-string"><span class="hljs-string">"~/Themes/ETRTheme/Content/images/favicon-201209261628.ico"</span></span>) }); Script.Include(<span class="hljs-string"><span class="hljs-string">"html5.js"</span></span>).UseCondition(<span class="hljs-string"><span class="hljs-string">"lt IE 9"</span></span>).AtHead(); Script.Include(<span class="hljs-string"><span class="hljs-string">"jquery.min.js"</span></span>).AtHead(); Script.Include(<span class="hljs-string"><span class="hljs-string">"jquery-ui.min.js"</span></span>).AtHead(); Script.Include(<span class="hljs-string"><span class="hljs-string">"knockout-2.2.1.js"</span></span>).AtHead(); Script.Include(<span class="hljs-string"><span class="hljs-string">"jquery.lightbox.js"</span></span>).AtHead(); Script.Include(<span class="hljs-string"><span class="hljs-string">"jquery.cycle.all.js"</span></span>).AtHead(); Script.Include(<span class="hljs-string"><span class="hljs-string">"date.format.js"</span></span>).AtHead(); Script.Include(<span class="hljs-string"><span class="hljs-string">"script.js"</span></span>).AtHead(); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> title = Convert.ToString(Model.Title); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> siteName = Convert.ToString(WorkContext.CurrentSite.SiteName); } &lt;!DOCTYPE html&gt; &lt;html lang=<span class="hljs-string"><span class="hljs-string">"@WorkContext.CurrentCulture"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"static @Html.ClassForPage()"</span></span>&gt; &lt;head&gt; &lt;meta charset=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span> /&gt; &lt;title&gt;@Html.Title(title, siteName)&lt;/title&gt; @Display(Model.Head) &lt;script&gt; (function (d) { d.className = <span class="hljs-string"><span class="hljs-string">"dyn"</span></span> + d.className.substring(<span class="hljs-number"><span class="hljs-number">6</span></span>, d.className.length); })(document.documentElement);&lt;/script&gt; &lt;/head&gt; &lt;body&gt; @Display(Model.Body) @Display(Model.Tail) &lt;/body&gt; &lt;/html&gt;</code> </pre> <br><br>  This file is responsible for rendering the page, in the line "@Display (Model.Body)" it calls Layout.cshtml. <br><br>  Layout contains page layout, connects css and "shows" different zones. <br><br><h5>  Changing shapes for customizing UI </h5><br>  In order to customize the appearance of elements, it is necessary to create several templates with specific names (one for each customization, Orchard will select by what template it will render what element). <br><br>  <a href="http://docs.orchardproject.net/Documentation/Accessing-and-rendering-shapes">http://docs.orchardproject.net/Documentation/Accessing-and-rendering-shapes#NamingShapesandTemplates</a> <br><br>  In our case there will be, for example, such templates: <br><ul><li>  Content-News.Summary.cshtml - is responsible for displaying an abbreviated version of the news. </li><li>  SliderGrid-ProjectionPage.cshtml - is responsible for the projection mapping. </li></ul><br>  Template to display abbreviated news: <br>  Views \ Content-News.Summary.cshtml: <br><br><pre> <code class="cs hljs">@<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Utility.Extensions; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Fields.Fields; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Core.Common.Models; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.ContentManagement; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text.RegularExpressions; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Tags.Models; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.MediaLibrary.Fields; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.ContentManagement @{ ContentItem contentItem = Model.ContentItem; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> contentTypeClassName = ((<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)contentItem.ContentType).HtmlClassify(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> news = ((<span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span>)contentItem).News; IEnumerable&lt;ContentField&gt; fields = news.Fields; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> common = contentItem.As&lt;CommonPart&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> publishedDate = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (common.PublishedUtc.HasValue) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> date = common.PublishedUtc.Value; publishedDate = date.ToString(<span class="hljs-string"><span class="hljs-string">"d MMMM yyyy"</span></span>); } MediaLibraryPickerField newsMainImage = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> newsHasImage = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> imageUrl = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> imageAlternateText = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { newsMainImage = (MediaLibraryPickerField)fields.First(f =&gt; f.Name == <span class="hljs-string"><span class="hljs-string">"NewsMainImage"</span></span>); imageUrl = newsMainImage.MediaParts.First().MediaUrl; imageAlternateText = newsMainImage.MediaParts.First().AlternateText; newsHasImage = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidOperationException e) { newsHasImage = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body = contentItem.As&lt;BodyPart&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> summaryBodyText = body.Text.RemoveTags().Trim().Replace(Environment.NewLine, <span class="hljs-string"><span class="hljs-string">" "</span></span>); summaryBodyText = Regex.Replace(summaryBodyText, <span class="hljs-string"><span class="hljs-string">@"\s+"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> textLength = newsHasImage ? <span class="hljs-number"><span class="hljs-number">400</span></span> : <span class="hljs-number"><span class="hljs-number">500</span></span>; textLength = textLength &gt; summaryBodyText.Length ? summaryBodyText.Length : textLength; summaryBodyText = summaryBodyText.Substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, textLength); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tags = contentItem.As&lt;TagsPart&gt;().CurrentTags; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tagsHtml = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;IHtmlString&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tags) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tagsHtml.Any()) { tagsHtml.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HtmlString(<span class="hljs-string"><span class="hljs-string">", "</span></span>)); } tagsHtml.Add(Html.ActionLink((<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)t.TagName, <span class="hljs-string"><span class="hljs-string">"Search"</span></span>, <span class="hljs-string"><span class="hljs-string">"Home"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { area = <span class="hljs-string"><span class="hljs-string">"Orchard.Tags"</span></span>, tagName = (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)t.TagName }, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { })); } &lt;div @<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newsHasImage) { &lt;text&gt;<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"b-newsroll-item-inner"</span></span>&lt;/text&gt; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { &lt;text&gt;<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"b-newsroll-item-inner-no-image"</span></span>&lt;/text&gt; }&gt; @<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (common.PublishedUtc.HasValue) { &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"b-newsroll-date"</span></span>&gt; @publishedDate &lt;/div&gt; } @<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newsHasImage) { &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"b-newsroll-image-wrapper"</span></span>&gt; &lt;img <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"b-newsroll-image"</span></span> src=<span class="hljs-string"><span class="hljs-string">"@Url.Content(@imageUrl)"</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!String.IsNullOrWhiteSpace(imageAlternateText)) { &lt;text&gt;alt=<span class="hljs-string"><span class="hljs-string">"@imageAlternateText"</span></span>&lt;/text&gt; }/&gt; &lt;/div&gt; } &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"b-newsroll-content"</span></span>&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"b-newsroll-text"</span></span>&gt; &lt;p&gt;@Html.Raw(summaryBodyText)&lt;/p&gt; &lt;/div&gt; &lt;span <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"b-newsroll-content-crop"</span></span>&gt;&lt;/span&gt; &lt;/div&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"b-newsroll-more"</span></span>&gt; @Html.ItemDisplayLink(T(<span class="hljs-string"><span class="hljs-string">"Read more"</span></span>).ToString(), contentItem) &lt;/div&gt; @<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tagsHtml.Any()) { &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"b-newsroll-tags"</span></span>&gt; &lt;span&gt; @T(<span class="hljs-string"><span class="hljs-string">"Tags:"</span></span>) &lt;/span&gt; @<span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> htmlString <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tagsHtml) { @htmlString } &lt;/div&gt; } &lt;/div&gt; }</code> </pre><br><br><h5>  Creating a grid for positioning news. </h5><br>  Now we need to make a normal grid for news, for this we create the SliderGrid module: the codegen module SliderGrid and describe the shapes in it: <br><br>  Layouts \ SliderGridLayoutForms.cs: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.DisplayManagement; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Forms.Services; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Localization; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">SliderGrid.Layouts</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SliderGridLayoutForms</span></span> : <span class="hljs-title"><span class="hljs-title">IFormProvider</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span> Shape { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Localizer T { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SliderGridLayoutForms</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IShapeFactory shapeFactory</span></span></span><span class="hljs-function">)</span></span> { Shape = shapeFactory; T = NullLocalizer.Instance; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Describe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DescribeContext context</span></span></span><span class="hljs-function">)</span></span> { Func&lt;IShapeFactory, <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt; form = shape =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = Shape.Form( Id: <span class="hljs-string"><span class="hljs-string">"SliderGridLayout"</span></span>, _HtmlProperties: Shape.Fieldset() ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> f; }; context.Form(<span class="hljs-string"><span class="hljs-string">"SliderGridLayout"</span></span>, form); } } } Layouts\SliderGridLayout.cs: <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.ContentManagement; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.DisplayManagement; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Localization; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Projections.Descriptors.Layout; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Projections.Models; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Orchard.Projections.Services; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">SliderGrid.Layouts</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SliderGridLayout</span></span> : <span class="hljs-title"><span class="hljs-title">ILayoutProvider</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Localizer T { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IContentManager _contentManager; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span> Shape { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SliderGridLayout</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IShapeFactory shapeFactory, IContentManager contentManager</span></span></span><span class="hljs-function">)</span></span> { _contentManager = contentManager; Shape = shapeFactory; T = NullLocalizer.Instance; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Describe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DescribeLayoutContext describe</span></span></span><span class="hljs-function">)</span></span> { describe.For(<span class="hljs-string"><span class="hljs-string">"Html"</span></span>, T(<span class="hljs-string"><span class="hljs-string">"Html"</span></span>), T(<span class="hljs-string"><span class="hljs-string">"Html Layouts"</span></span>)) .Element(<span class="hljs-string"><span class="hljs-string">"SliderGrid"</span></span>, T(<span class="hljs-string"><span class="hljs-string">"SliderGrid"</span></span>), T(<span class="hljs-string"><span class="hljs-string">"Renders multiPageGrid of elements + slider."</span></span>), DisplayLayout, RenderLayout, <span class="hljs-string"><span class="hljs-string">"SliderGridLayout"</span></span> ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> LocalizedString </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DisplayLayout</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LayoutContext context</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> T(<span class="hljs-string"><span class="hljs-string">"Renders multiPageGrid + slider."</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">dynamic</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RenderLayout</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LayoutContext context, IEnumerable&lt;LayoutComponentResult&gt; layoutComponentResults</span></span></span><span class="hljs-function">)</span></span> { IEnumerable&lt;<span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span>&gt; shapes = context.LayoutRecord.Display == (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)LayoutRecord.Displays.Content ? layoutComponentResults.Select(x =&gt; _contentManager.BuildDisplay(x.ContentItem, context.LayoutRecord.DisplayType)) : layoutComponentResults.Select(x =&gt; x.Properties); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Shape.SliderGrid(Items: shapes); } } }</code> </pre><br><br><h5>  Turn on grid </h5><br>  We connect the SliderGrid feature in the "modules", change the layout of the LastNews query to SliderGrid: <br><br><img src="https://habrastorage.org/storage2/ee7/841/2d8/ee78412d8363ae21fdc44795ea0bfe7a.png"><br><br>  We change in the projection the request for the just corrected. <br><br><img src="https://habrastorage.org/storage2/f11/8dc/65f/f118dc65f39793996e4247a8e2889b78.png"><br><br><h4>  findings </h4><br>  In order to be able to write news through the admin area, we need to implement ContentType, in our case - News.  To show the news list on the main page, we need Projection, and for it - Query.  In order for us to customize the appearance of the elements, we need in the current theme in the Views folder to put templates with specific names, according to which Orchard can figure out which shape this template should be applied to.  How to get ContentPart and ContentTypeField from ContentType is clear from the example with short news. <br><br>  Based on the experiment, we concluded that Orchard and Liferay at the stage of preparing a tool for publishing news ... are about the same.  Both there and there is customization of topics, the production of necessary entities, the possibility of customization of these entities, but there is a nuance: at the stage when it is necessary to make a block conclusion (for example, a list of news or articles) problems begin with Liferay - the problem falls on the programmer who needs pull entities on their own to display them.  It requires a fairly high qualification in java and in the development of Liferay. <br><br>  Orchard has a convenient query mechanism - Query, - to cope with which everything is possible. </div><p>Source: <a href="https://habr.com/ru/post/189314/">https://habr.com/ru/post/189314/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../189300/index.html">The chain of effective online sales: marketing</a></li>
<li><a href="../189302/index.html">The first results of the championship developer Devcup 2013: the winners in nominations</a></li>
<li><a href="../189304/index.html">Mobile version 2GIS - a fresh portion of updates</a></li>
<li><a href="../189308/index.html">Potentially dangerous asteroids</a></li>
<li><a href="../189310/index.html">Access to Netflix over IPv6 from outside the States</a></li>
<li><a href="../189320/index.html">How GIL works in Ruby. Part 1</a></li>
<li><a href="../189328/index.html">Voronezh entered into a contract with the bank, making their changes, and is going to sue 24 million rubles</a></li>
<li><a href="../189330/index.html">BitByte Festival is a meeting place for the IT community</a></li>
<li><a href="../189332/index.html">SIP client interaction. Part 2</a></li>
<li><a href="../189334/index.html">ICFPC 2013 coming soon</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>