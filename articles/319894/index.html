<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pure javascript. Objects and data structures. Asynchrony. Error processing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translation of the book by Ryan McDermott clean-code-javascript 

 Table of contents: 


- Introduction 
- Variables 
- Functions 
- Classes 
- Object...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pure javascript. Objects and data structures. Asynchrony. Error processing</h1><div class="post__text post__text-html js-mediator-article">  Translation of the book by Ryan McDermott <a href="https://github.com/ryanmcdermott/clean-code-javascript">clean-code-javascript</a> <br><br><h3>  Table of contents: </h3><br><ul><li>  <a href="https://habrahabr.ru/post/319472/">Introduction</a> </li><li>  <a href="https://habrahabr.ru/post/319476/">Variables</a> </li><li>  <a href="https://habrahabr.ru/post/319480/">Functions</a> </li><li>  <a href="https://habrahabr.ru/post/319804/">Classes</a> </li><li>  <a href="https://habrahabr.ru/post/319894/">Objects and data structures.</a>  <a href="https://habrahabr.ru/post/319894/">Asynchrony.</a>  <a href="https://habrahabr.ru/post/319894/">Error processing.</a> </li><li>  <a href="https://habrahabr.ru/post/320084/">Testing.</a>  <a href="https://habrahabr.ru/post/320084/">Formatting</a>  <a href="https://habrahabr.ru/post/320084/">Comments</a> </li></ul><br><img src="https://habrastorage.org/files/6bc/452/416/6bc4524160284f4290794957ff2430bd.jpg"><br><a name="habracut"></a><br><a name="dataStructuresAndClasses"></a><br><h3>  Objects and data structures </h3><br><h4>  Use getters and setters </h4><br>  In javascript, the keywords private and public are missing, which complicates the implementation of classes.  It is better to use getters and setters to access the properties of an object than directly access them.  You ask "Why?".  Here are some reasons: <br><br><ul><li>  If you want to implement more than just access to a property, you need to change the implementation in one place, and not throughout the code. </li><li>  Validation is easy to implement at the setter implementation level. </li><li>  Encapsulation of the internal state of the object </li><li>  Easy to add logging and error handling at the getters and setters level. </li><li>  By inheriting this class, you can override the default functionality. </li><li>  You can lazily load the properties of your object, for example, from the server. </li></ul><br>  Poorly: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BankAccount</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.balance = <span class="hljs-number"><span class="hljs-number">1000</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> bankAccount = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BankAccount(); <span class="hljs-comment"><span class="hljs-comment">// , , ... bankAccount.balance -= 100;</span></span></code> </pre> <br>  Good: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BankAccount</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(balance = 1000) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._balance = balance; } <span class="hljs-comment"><span class="hljs-comment">// It doesn't have to be prefixed with `get` or `set` to be a getter/setter set balance(amount) { if (this.verifyIfAmountCanBeSetted(amount)) { this._balance = amount; } } get balance() { return this._balance; } verifyIfAmountCanBeSetted(val) { // ... } } const bankAccount = new BankAccount(); // , , ... bankAccount.balance -= shoesPrice; //   let balance = bankAccount.balance;</span></span></code> </pre><br><h4>  Implement the private properties of your objects. </h4><br>  This is possible through closures. <br><br>  Poorly: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Employee = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; }; Employee.prototype.getName = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name; }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> employee = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Employee(<span class="hljs-string"><span class="hljs-string">'John Doe'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Employee name: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${employee.getName()}</span></span></span><span class="hljs-string">`</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Employee name: John Doe delete employee.name; console.log(`Employee name: ${employee.getName()}`); // Employee name: undefined</span></span></code> </pre><br>  Good: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Employee = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getName = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; }; }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> employee = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Employee(<span class="hljs-string"><span class="hljs-string">'John Doe'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Employee name: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${employee.getName()}</span></span></span><span class="hljs-string">`</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Employee name: John Doe delete employee.name; console.log(`Employee name: ${employee.getName()}`); // Employee name: John Doe</span></span></code> </pre><br><a name="asyncronyus"></a><br><h3>  Asynchrony </h3><br><h4>  Use promises instead of callbacks </h4><br>  Kolbeki lead to excessive nesting and poor readability of the code. <br><br>  Poorly: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> request = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'request'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fs = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fs'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> url = <span class="hljs-string"><span class="hljs-string">'https://en.wikipedia.org/wiki/Robert_Cecil_Martin'</span></span>; request.get(url, (requestErr, response) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (requestErr) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(requestErr); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { fs.writeFile(<span class="hljs-string"><span class="hljs-string">'article.html'</span></span>, response.body, (writeErr) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (writeErr) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(writeErr); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'File written'</span></span>); } }); } });</code> </pre><br>  Good: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> requestPromise = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'request-promise'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fsPromise = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fs-promise'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> url = <span class="hljs-string"><span class="hljs-string">'https://en.wikipedia.org/wiki/Robert_Cecil_Martin'</span></span>; requestPromise.get(url) .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fsPromise.writeFile(<span class="hljs-string"><span class="hljs-string">'article.html'</span></span>, response); }) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'File written'</span></span>); }) .catch(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err); });</code> </pre><br><h4>  Async / Await makes code cleaner than promises </h4><br>  Promises are a very good alternative to callbacks, but in the ES2017 / ES8 specification, async / await has appeared, which offers an even better solution.  All you need is to write a function with the async prefix, inside which you can write your asynchronous logic imperatively.  Async / await can be used right now with the help of babel. <br><br>  Poorly: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> requestPromise = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'request-promise'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fsPromise = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fs-promise'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> url = <span class="hljs-string"><span class="hljs-string">'https://en.wikipedia.org/wiki/Robert_Cecil_Martin'</span></span>; requestPromise.get(url) .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fsPromise.writeFile(<span class="hljs-string"><span class="hljs-string">'article.html'</span></span>, response); }) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'File written'</span></span>); }) .catch(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err); });</code> </pre><br>  Good: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> requestPromise = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'request-promise'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fsPromise = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fs-promise'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCleanCodeArticle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> url = <span class="hljs-string"><span class="hljs-string">'https://en.wikipedia.org/wiki/Robert_Cecil_Martin'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> requestPromise.get(url); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fsPromise.writeFile(<span class="hljs-string"><span class="hljs-string">'article.html'</span></span>, response); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'File written'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(err) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err); } }</code> </pre><br><a name="erorrHeandling"></a><br><h3>  Error processing </h3><br>  Throwing mistakes is a good solution!  This means that at runtime you will know if something went wrong.  You can stop the execution of your application at the right time and see the location of the error using the stack of the trace in the console. <br><br><h4>  Do not ignore caught errors </h4><br>  Doing nothing with the caught error, you lose the opportunity to correct the error or to respond to it ever.  The error output in the console (console.log (error)) does not give the best result, because the error can be lost among the displayed entries in the console.  If you wrap a piece of code in try / catch, then you are assuming an error has occurred.  In this case, you must have a backup plan. <br><br>  Poorly: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { functionThatMightThrow(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(error); }</code> </pre><br>  Good: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { functionThatMightThrow(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { <span class="hljs-comment"><span class="hljs-comment">//    ( ,  console.log): console.error(error); //   -    : notifyUserOfError(error); //    -     : reportErrorToService(error); //     ! }</span></span></code> </pre><br><h4>  Do not ignore errors in promises. </h4><br>  You should not ignore errors that occurred in the promis, for the same reason as trapped errors in try / catch. <br><br>  Poorly: <br><br><pre> <code class="javascript hljs">getdata() .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> { functionThatMightThrow(data); }) .catch(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(error); });</code> </pre><br>  Good: <br><br><pre> <code class="javascript hljs">getdata() .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> { functionThatMightThrow(data); }) .catch(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//    ( ,  console.log): console.error(error); //   -    : notifyUserOfError(error); //    -     : reportErrorToService(error); //     ! });</span></span></code> </pre></div><p>Source: <a href="https://habr.com/ru/post/319894/">https://habr.com/ru/post/319894/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319880/index.html">Generating dummy data with Mimesis: Part II</a></li>
<li><a href="../319884/index.html">Optimization of the portal design team using Sketch and the cloud</a></li>
<li><a href="../319886/index.html">Control your mind</a></li>
<li><a href="../319888/index.html">How to make a cross-platform desktop application based on web technologies</a></li>
<li><a href="../319890/index.html">Custom game research</a></li>
<li><a href="../319896/index.html">Amazon Web Services User Group Russia First MEP</a></li>
<li><a href="../319898/index.html">Pure Python Architecture: A Walkthrough. Part 3</a></li>
<li><a href="../319900/index.html">How to "correctly" go to Early Access on Steam</a></li>
<li><a href="../319902/index.html">Performance comparison of analytical HPE Vertica and Exasol DBMS using TPC-H Benchmark</a></li>
<li><a href="../319904/index.html">Under and over the water: two almost fantastic projects of data centers from Microsoft and Google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>