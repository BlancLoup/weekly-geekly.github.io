<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>So you still don't understand Hindley-Milner? Part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In Part 2, we ended up with the definitions of all formal terms and symbols that you can see in the StackOverflow question about the Hindley-Milner al...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>So you still don't understand Hindley-Milner? Part 3</h1><div class="post__text post__text-html js-mediator-article">  In <a href="http://habrahabr.ru/post/185686/">Part 2,</a> we ended up with the definitions of all formal terms and symbols that you can see in <a href="http://stackoverflow.com/questions/12532552/what-part-of-milner-hindley-do-you-not-understand">the StackOverflow question</a> about the Hindley-Milner algorithm.  So now we are ready to translate what is being asked about there, namely, the rules for deriving assertions about type inference.  Let's get started! <br><a name="habracut"></a><br><h4>  Rules for deriving type inference statements </h4><br>  <b>[Var]</b> <br><br><img src="https://habrastorage.org/storage2/713/89c/882/71389c8824ad4171d273d1dd18e3e86a.jpeg"><br><br>  This translates as follows: if " <code>x</code> has type σ" is a position from our collection of Γ positions, then from Γ you can infer that <code>x</code> has type σ.  Here <code>x</code> is a variable (hence the name of the rule).  Yes, it sounds painfully obvious, but it contains deep and complex facts in a concise and concise form that the machine can understand.  This allows you to automate type inference. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>[App]</b> <br><br><img src="https://habrastorage.org/storage2/f1e/cb4/f20/f1ecb4f20650eb9ac687af4dac67cb16.jpeg"><br><br>  This translates as: if we can infer that <code>e</code> <sub>0</sub> is an expression with the type <i>τ</i> → <i>τ ′</i> (i.e., <code>e</code> <sub>0</sub> can be an anonymous function that, according to Γ, accepts a value of the type <i>τ</i> and returns the value of <i>τ ′</i> ), and that <code>e</code> <sub>1</sub> is of type <i>τ</i> , then we can conclude that <code>e</code> <sub>0</sub> ( <code>e</code> <sub>1</sub> ), an expression obtained by applying <code>e</code> <sub>0</sub> to <code>e</code> <sub>1</sub> , is of type <i>τ ′</i> .  Intuitively clear: if we can infer the type of input and output function, as well as the fact that some expression has the same type as the input, then when we apply the function to this expression, we can safely conclude that the resultant the expression will have a function exit type.  Nothing confusing here. <br><br>  <b>[Abs]</b> <br><br><img src="https://habrastorage.org/storage2/aba/f97/3b6/abaf973b68b98fdd19240fa0d4d34480.jpeg"><br><br>  This translates as follows: if we can assume that <code>x</code> is of type <i>τ</i> , and <code>e</code> is of type <i>τ ′</i> , then we can conclude that we are also able to deduce the type of abstraction / anonymization <code>e</code> with respect to the variable <code>x</code> - <code>λx.e</code>  It will be <i>τ</i> → <i>τ ′</i> .  That is, for example, if we know that the type <code>x</code> is a <code>String</code> , then the expression <code>x[0]</code> will be of type <code>Char</code> .  Now [Abs] allows us to conclude that: <br><pre> <code class="java hljs">function(x) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x[<span class="hljs-number"><span class="hljs-number">0</span></span>]; }</code> </pre><br>  is of type <code>String</code> → <code>Char</code> . <br><br>  To the side.  I have already mentioned the polytypes.  Let's return to them in this example, just to make this concept better in our head.  So, you have already noticed that the function above is of type <code>Array[Int]</code> → <code>Int</code> .  In fact, for any type <code>t</code> function is of type <code>Array[t]</code> → <code>t</code> .  So actually it has many different types, and <code>String</code> → <code>Char</code> is just one of them.  <i>Each</i> of the types of the form <code>Array[t]</code> → <code>t</code> is a monotype.  We can infer that a given function has <i>all</i> these monotypes, simply saying that it has a polytype ∀ <code>t(Array[t]</code> → <code>t)</code> .  It reads: “for any <code>t</code> - the type of <code>Array[t]</code> → <code>t</code> ”, and we denote a bunch of everything with a single type (but more abstract).  So note that when we infer the type of an expression, this does not mean that it is unique to this expression.  It can have many different types, some of which will be more specialized, while others will be more abstract.  The simplest types of types are monotypes: <code>Int</code> , <code>String</code> , <code>String</code> → <code>Char</code> and the like, but if we want, we can have more abstract / common types - polytypes. <br><br>  <b>[Let]</b> <br><br><img src="https://habrastorage.org/storage2/bff/094/1bd/bff0941bd728d0f6a19b976698986388.jpeg"><br><br>  Generally easy: <br>  If we can infer that <code>e</code> <sub>0</sub> is of type σ <br>  and <br>  If we assume that <code>x</code> also has type σ and from this we can infer that <code>e</code> <sub>1</sub> has type <i>τ</i> <br>  that <br>  We can conclude that the result of setting <code>x</code> to <code>e</code> <sub>0</sub> and substituting it into <code>e</code> <sub>1</sub> will be of type <i>τ</i> . <br><br>  The last four rules are nothing more than a formal display of our intuitive knowledge of what type of result we can get if we have variables with which we create anonymous functions, or to which we use ordinary functions, or substitute expressions inside expressions.  This is what we, as programmers, do intuitively.  Here we are just talking about how to describe all this formally.  In the end, not everything that happens in our brains is unknown magic.  It is also worth noting that the last four rules correspond exactly to the four rules that determine what is a valid expression in lambda calculus.  And this is no coincidence. <br><br>  <b>[Inst]</b> <br><br><img src="https://habrastorage.org/storage2/fa1/349/7a8/fa13497a82ad52f4886227fb6339fe9f.jpeg"><br><br>  This is a rule about instances.  You can think of the <code>Array[Int]</code> → <code>Int</code> monotype as an instance of the polytype ∀ <code>t.Array[t]</code> → <code>t</code> .  In other words, this is “specialization”: <code>Array[Int]</code> → <code>Int</code> more specialized than ∀ <code>t.Array[t]</code> → <code>t</code> .  We denote “more specialized than” with ⊑.  Those. <br><br><img src="https://habrastorage.org/storage2/593/2ed/a33/5932eda33126d6d882ae07ec5441149d.jpeg"><br><br>  Thus, the direct translation of [Inst] is as follows: if we can deduce that <code>e</code> is of type σ ′ and σ is an instance / specialization of σ ′, then we can conclude that <code>e</code> is of type σ.  You can think of σ and σ ′ as <code>Array[t]</code> → <code>t</code> and ∀ <code>t.Array[t]</code> → <code>t</code> respectively. <br><br>  <b>[Gen]</b> <br><br><img src="https://habrastorage.org/storage2/de3/2fd/59f/de32fd59fcf0ac90d7896f8ac46ebf81.jpeg"><br><br>  This is the most difficult part to understand.  Truly, only it matters in the context of the type inference process using the narrow set of rules outlined above.  It does not have a clear analogue, since it largely depends on the concept of a type variable - something that is never found in real programming languages, but is indispensable when we try to work with a meta-language to talk about types in any arbitrary programming language.  In general, the idea can be shown in the following "example": <br><br>  Suppose you have two variables <code>x</code> and <code>y</code> , and in the beginning you assume that both of them are of type α, where α is a variable denoting type.  Later you come across an expression for which you somehow deduced that its type is α → α in <i>this</i> context (in the context of the assumption that <code>x</code> and <code>y</code> are of type α).  And now attention is the question: will this function have a polytype ∀α.α → α?  Those.  Does this function generally associate objects with the same type, or does it only seem so because you assumed that <code>x</code> and <code>y</code> have the same type α? <br><br>  Since α is a type variable, i.e.  can denote any type, then we would like to think that since we deduced that <code>e</code> is of type α → α, then it also has a polytype ∀α.α → α.  But we cannot say that this generalization is obligatory, without a more complete understanding of how <code>e</code> is related to <code>x</code> and <code>y</code> .  In particular, if our conclusion that it is of type α → α is strongly related to our previous assumptions associated with this type, then we generally cannot conclude that <code>e</code> has a polytype ∀α.α → α. <br><br>  And now (finally!) Translation of the rule: <br><br>  If some variable of type α is not “loosely” mentioned in our current context / knowledge set / assumptions, and we can infer that some expression <code>e</code> has some type σ, then we can conclude that <code>e</code> has type σ regardless of than ultimately turn α.  Slightly more technical: <code>e</code> has the polytype ∀α.σ. <br><br>  Okay, but what does "loosely mentioned" mean?  In the polytype ∀α.α → α, α is not mentioned "for real".  This type is completely analogous, for example, ∀β.β → β.  An expression with any of these types is a regular function that has the same input and output types.  On the other hand, <code>x:</code> α is the “real” mention of α. <br><br><img src="https://habrastorage.org/storage2/6ee/b66/8ed/6eeb668edc36a44600f5dfe2ecd8136b.jpeg"><br><br>  and <br><br><img src="https://habrastorage.org/storage2/3c7/273/299/3c7273299ffb53b1e8f442055a7861e9.jpeg"><br><br>  mean different things.  The latter suggests that <code>x</code> and <code>y</code> definitely of the same type (even if this type has not yet been defined).  The first one does not report about the connection of types <code>x</code> and <code>y</code> absolutely nothing.  The difference is that when α is mentioned inside the region ∀ (as in the case of ∀α.α → α), it is just a fiction that can be replaced with any other type variable, regardless of the rest of the context.  Thus, we can interpret the position “α is not freely mentioned in the context of Γ” as “α either not mentioned at all, or considered fiction and in principle can be replaced by something completely different without changing the semantics of knowledge / assumptions in our context”. <br><br>  That's all. <br><br>  <i>Translator's note: I would be very grateful for any comments in PM about the translation.</i> </div><p>Source: <a href="https://habr.com/ru/post/189446/">https://habr.com/ru/post/189446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../189432/index.html">Understanding OOP in Java Script (ES5), Part 2</a></li>
<li><a href="../189434/index.html">SAP Backdoor</a></li>
<li><a href="../189436/index.html">Delegation of new gTLDs will be delayed due to conflict with the local network domains</a></li>
<li><a href="../189440/index.html">LinkedIn got into a scandalous story</a></li>
<li><a href="../189442/index.html">NVIDIA SHIELD</a></li>
<li><a href="../189458/index.html">Jean-Baptiste Kieru leaves the post of head of the AOSP project</a></li>
<li><a href="../189462/index.html">We turn Raspberry Pi into a router (for now only for Corbin and Beeline)</a></li>
<li><a href="../189464/index.html">Real Pixels - Dropbox gallery for designers that do not scale images.</a></li>
<li><a href="../189466/index.html">Canonical lowers the price of Ubuntu Edge to $ 695 for the rest of the campaign.</a></li>
<li><a href="../189470/index.html">Special effects in “Matrix” style for sports TV broadcasts</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>