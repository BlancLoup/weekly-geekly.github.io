<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Learning to count in hex, or reverse engineering of an alarm clock</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Recently, I had the idea to learn how to count in hexadecimal number system. Since I am a lazy person, such methods as learning the mul...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Learning to count in hex, or reverse engineering of an alarm clock</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  Recently, I had the idea to learn how to count in hexadecimal number system.  Since I am a lazy person, such methods as learning the multiplication table did not suit me.  After some thought, I remembered that every morning I decided (sometimes several times) a simple example to turn off the alarm clock.  It helps poorly, over time I began to solve almost without waking up.  So why not combine the useful with the useful? <br>  It remains to choose the method of implementation.  Since I have not the slightest idea of ‚Äã‚Äãthe development for android (and in general with Java is not very familiar), and to write my application for such trifles - it is shooting from a cannon on sparrows, it was decided to modify the existing alarm clock. <br><img src="https://habrastorage.org/storage1/7da8ab24/5f11a081/2db2147a/404a7dc9.png"><br>  Under the cat you will find a description of the tools, the process and the result of translating the example into hex.  As well as an explanation of the smali code syntax (the opcode language for the dalvik virtual machine).  Almost no pictures, a lot of beeches. <br><a name="habracut"></a><br><br><h4>  A bit about the structure. Apk </h4><br>  A .apk application is a zipped file.  Inside there are resource files, AndroidManifest.xml and classes.dex.  The second is a file that contains basic information about the application, such as: information about the main Activity, a list of rights requested during installation, and other information that is not important for our purposes.  classes.dex - the byte code compiled for the dalvik virtual machine.  We can translate it into a jar and get more or less readable Java code.  What we now do. <br><br><h4>  Getting a readable code </h4><br>  So, take the file of our application (in my case it is <a href="https://market.android.com/details%3Fid%3Dcom.splunchy.android.alarmclock">AlarmDroid</a> ) and unzip it.  There are many ways to do this, I used the <a href="http://forum.xda-developers.com/showthread.php%3Ft%3D695701">Apk Manager</a> , which I will write about below.  Next you need to convert classes.dex to jar.  For this there is a <a href="http://code.google.com/p/dex2jar/">dex2jar</a> .  Drag the file to dex2jar.bat.  Now you need to learn to read the resulting jar file.  We use for this the <a href="http://java.decompiler.free.fr/">jd-gui</a> program (by the way, there is a plugin with the same name for Eclipse). <br>  So, we've got almost readable code, although in some places the decompiler is clearly flattering. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Decompiling and reading .smali files </h4><br>  Since the java code is read-only, you will have to fix it in the opcodes of the virtual machine.  There are only a little less than <a href="http://pallergabor.uw.hu/androidblog/dalvik_opcodes.html">256 pieces</a> .  For decompiling, you can use the <a href="http://forum.xda-developers.com/showthread.php%3Ft%3D695701">Apk Manager</a> mentioned above or the more console <a href="http://code.google.com/p/android-apktool/">apktool</a> .  But the first is only a beautiful wrapper of the second, with the addition of some additional features (for example, unzipping and the choice of compression level).  After decompiling, we get a folder with files with the extension .smali.  These are the very same opcodes.  They can already be read by any text editor.  But it would be nice to get some backlight.  I used the backlight for <a href="http://androidcracking.blogspot.com/2011/02/smali-syntax-highlighting-for-notepad.html">Notepad ++</a> , but there is also for <a href="http://androidcracking.blogspot.com/2011/03/smali-syntax-highlighting-for-vim.html">vim</a> . <br>  Well, with the tools, finally figured out, it's time to analyze the code. <br><br><h4>  First blood </h4><br>  To begin with, it would be nice to do the generation of numbers not up to 10, but up to 15. We study the code, and find the method of generating an example.  You will have to look for it, there are a lot of classes in the trees.  But since the names of the methods are preserved, it is not very difficult. <br>  We find the desired method in the class RingerActivity. <br><img src="https://habrastorage.org/storage1/b181a816/4e98393d/9d8a5545/2dd8d2e5.png"><br>  Well, everything seems to be simple: we generate 3 numbers and 2 characters, and put the result in this.x (this, by the way, will be useful to us). <br>  Now we find the same method in the smali-code (unfortunately there are no smali-code highlighters online, and it‚Äôs lazy to write, so the code will be screenshots). <br><img src="https://habrastorage.org/storage1/bc0fd673/e07d6ead/592a392a/cf88be4d.png"><br>  (Method code continues) <br>  The code is incomprehensible, but it is clearly visible that the constants are set once at the beginning.  Therefore, we change 0xa to 0xf and try to see the changes in order to know that we are on the right track.  With the help of Apk Manager, we collect, sign, transfer to the phone (can be tested on the emulator if the Android SDK is installed), set, set the alarm for a minute ahead, wait, look.  This procedure will have to be repeated a large number of times.  The numbers on the screen have increased, no errors occur.  Fine!  Now it's time to get a little understanding of incomprehensible smali code. <br><br><h4>  We understand smali code </h4><br>  In general, everything is pretty well described <a href="http://code.google.com/p/smali/w/list">here</a> , I will only briefly retell it in Russian. <br><br><h5>  Types, methods, fields </h5><br>  In dalvik opcodes there are two types of types: primitive (primitive) and reference (reference).  Primitive types are denoted by a single letter (for example, I is int, V is void), the full list is <a href="http://code.google.com/p/smali/wiki/TypesMethodsAndFields">here</a> . <br>  Reference types are objects and arrays, or, in other words, all but primitive types.  In the code they are denoted as <blockquote>  Lpackage <font color="#339933">/</font> name <font color="#339933">/</font> ObjectName <font color="#339933">;</font> </blockquote>  where L at the beginning means that it is an object, a;  - the end of the name.  This entry will be equivalent to <blockquote>  <font color="#000000">package</font> .  <font color="#006633">name</font> .  <font color="#006633">ObjectName</font> </blockquote>  in java. <br>  Arrays have the form [I is a one-dimensional array of ints (in Java, there will be an int []).  For more measurements, simply add square brackets at the beginning.  [[[I == int [] [] [] (the maximum number of dimensions is 255).  Of course, you can create arrays of reference types, an array of strings, for example, will look like this: <blockquote>  <font color="#009900">[</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> </blockquote><br>  Methods are defined in a long way, which includes the object containing the method, the name of the method, the types of all parameters passed, and the type of the return value. <blockquote>  Lpackage <font color="#339933">/</font> name <font color="#339933">/</font> ObjectName <font color="#339933">; -&gt;</font> MethodName <font color="#009900">(</font> III <font color="#009900">)</font> Z </blockquote>  In this example, Lpackage / name / ObjectName;  - this is the object containing the method, MethodName is the name of the method, (III) are the types of the parameters to be passed (in this case, 3 inta), and Z is the type of the return value (in this case, bool). <br>  Here is another more complex example. <br><blockquote>  method <font color="#009900">(</font> I <font color="#009900">[</font> <font color="#009900">[</font> IILjava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <font color="#009900">[</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">Object</font> <font color="#339933">;</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> </blockquote><br>  In Java, this code will look like this: <br><blockquote>  <font color="#003399">String</font> method <font color="#009900">(</font> <font color="#000066">int</font> , <font color="#000066">int</font> <font color="#009900">[</font> <font color="#009900">]</font> <font color="#009900">[</font> <font color="#009900">]</font> , <font color="#000066">int</font> , <font color="#003399">String</font> , <font color="#003399">Object</font> <font color="#009900">[</font> <font color="#009900">]</font> <font color="#009900">)</font> </blockquote><br>  Class fields are set as follows: <br><blockquote>  Lpackage <font color="#339933">/</font> name <font color="#339933">/</font> ObjectName <font color="#339933">; -&gt;</font> FieldName <font color="#339933">:</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> </blockquote><br>  Here, in general, everything is so clear. <br><br><h5>  Registers </h5><br>  In smali code, all registers are 32 bit and can contain any type of values.  For 64 bit values, 2 registers are used. <br><br><h6>  Determining the number of registers in a method </h6><br>  There are two ways to determine the number of registers.  The .registers directive defines the total number of registers, while .locals defines the number of registers that are not method parameters. <br><br><h6>  Parameter passing </h6><br>  When the method is called, the arguments fall into the last registers.  Those.  if the method is called with 2 arguments and 5 registers (v0-v4), the arguments fall into the registers v3 and v4. <br>  The first parameter in non-static methods is always the object from which the method was called.  So, if you call a non-static method <br><blockquote>  LMyObject <font color="#339933">; -&gt;</font> callMe <font color="#009900">(</font> II <font color="#009900">)</font> V </blockquote><br>  in addition to two ints, LMyObject is passed to it;  Before both, and it turns out that in a method 3 parameters.  And if you set the total number of registers in method 5 (or local number 2), then an object will fall into v2, the first int will fall into v3, and the second int v4. <br><br><h6>  Register Naming </h6><br>  There are 2 register naming schemes: a general v-scheme, and a p-scheme for parameter registers.  In the above example, we will have 5 general registers v0-v4, and 3 registers of parameters p0-p2, and as mentioned above p0 and v2 (as well as p1 and v3, p2 and v4) denote the same register. <br><br>  In general, there are still some subtleties, but for us to change the alarm they are not important. <br><br><h4>  Translation of an example into hex </h4><br>  Now that everything became clear with the smali code, it would be nice to translate the example into hex.  I really didn't want to write my function, so I turned to google.  And I found the Integer.toHexString () method. <br>  So we find the right method. <blockquote>  <font color="#000000">private</font> <font color="#000066">void</font> updateProblemView <font color="#009900">(</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  TextView localTextView <font color="#339933">=</font> <font color="#000000">this</font> .  <font color="#006633">problem</font> <font color="#339933">;</font> <br>  <font color="#003399">String</font> str1 <font color="#339933">=</font> <font color="#003399">String</font> .  <font color="#006633">valueOf</font> <font color="#009900">(</font> <font color="#000000">this</font> . <font color="#006633">a</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  StringBuilder localStringBuilder1 <font color="#339933">=</font> <font color="#000000">new</font> StringBuilder <font color="#009900">(</font> str1 <font color="#009900">)</font> .  <font color="#006633">append</font> <font color="#009900">(</font> <font color="#0000ff">""</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">int</font> i <font color="#339933">=</font> <font color="#000000">this</font> .  <font color="#006633">p</font> <font color="#339933">;</font> <br>  <font color="#003399">String</font> str2 <font color="#339933">=</font> op2text <font color="#009900">(</font> i <font color="#009900">)</font> <font color="#339933">;</font> <br>  StringBuilder localStringBuilder2 <font color="#339933">=</font> localStringBuilder1.  <font color="#006633">append</font> <font color="#009900">(</font> str2 <font color="#009900">)</font> .  <font color="#006633">append</font> <font color="#009900">(</font> <font color="#0000ff">""</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">int</font> j <font color="#339933">=</font> <font color="#000000">this</font> .  <font color="#006633">b</font> <font color="#339933">;</font> <br>  StringBuilder localStringBuilder3 <font color="#339933">=</font> localStringBuilder2.  <font color="#006633">append</font> <font color="#009900">(</font> j <font color="#009900">)</font> .  <font color="#006633">append</font> <font color="#009900">(</font> <font color="#0000ff">""</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">int</font> k <font color="#339933">=</font> <font color="#000000">this</font> .  <font color="#006633">q</font> <font color="#339933">;</font> <br>  <font color="#003399">String</font> str3 <font color="#339933">=</font> op2text <font color="#009900">(</font> k <font color="#009900">)</font> <font color="#339933">;</font> <br>  StringBuilder localStringBuilder4 <font color="#339933">=</font> localStringBuilder3.  <font color="#006633">append</font> <font color="#009900">(</font> str3 <font color="#009900">)</font> .  <font color="#006633">append</font> <font color="#009900">(</font> <font color="#0000ff">""</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">int</font> m <font color="#339933">=</font> <font color="#000000">this</font> .  <font color="#006633">c</font> <font color="#339933">;</font> <br>  <font color="#003399">String</font> str4 <font color="#339933">=</font> m <font color="#339933">+</font> <font color="#0000ff">"="</font> <font color="#339933">;</font> <br>  localTextView.  <font color="#006633">setText</font> <font color="#009900">(</font> str4 <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> </blockquote>  and his smali code <blockquote> .  <font color="#006633">method</font> <font color="#000000">private</font> updateProblemView <font color="#009900">(</font> <font color="#009900">)</font> V <br>  .  <font color="#006633">locals</font> <font color="#cc66cc">3</font> <br>  .  <font color="#006633">prologue</font> <br>  .  <font color="#006633">line</font> <font color="#cc66cc">520</font> <br>  iget <font color="#339933">-</font> object v0, p0, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> problem <font color="#339933">:</font> Landroid <font color="#339933">/</font> widget <font color="#339933">/</font> TextView <font color="#339933">;</font> <br>  new <font color="#339933">-</font> instance v1, Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  iget v2, p0, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> a <font color="#339933">:</font> I <br>  invoke <font color="#339933">-</font> <font color="#000000">static</font> <font color="#009900">{</font> v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">; -&gt;</font> valueOf <font color="#009900">(</font> I <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v2 <br>  invoke <font color="#339933">-</font> direct <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt; &lt;</font> init <font color="#339933">&gt;</font> <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <font color="#009900">)</font> V <br>  const <font color="#339933">-</font> string v2, <font color="#0000ff">""</font> <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  iget v2, p0, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> p <font color="#339933">:</font> I <br>  invoke <font color="#339933">-</font> direct <font color="#009900">{</font> p0, v2 <font color="#009900">}</font> , Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> op2text <font color="#009900">(</font> I <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v2 <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  const <font color="#339933">-</font> string v2, <font color="#0000ff">""</font> <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  iget v2, p0, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> b <font color="#339933">:</font> I <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> I <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  const <font color="#339933">-</font> string v2, <font color="#0000ff">""</font> <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  iget v2, p0, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> q <font color="#339933">:</font> I <br>  invoke <font color="#339933">-</font> direct <font color="#009900">{</font> p0, v2 <font color="#009900">}</font> , Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> op2text <font color="#009900">(</font> I <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v2 <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  const <font color="#339933">-</font> string v2, <font color="#0000ff">""</font> <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  iget v2, p0, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> c <font color="#339933">:</font> I <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> I <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  const <font color="#339933">-</font> string v2, <font color="#0000ff">"="</font> <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> toString <font color="#009900">(</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v0, v1 <font color="#009900">}</font> , Landroid <font color="#339933">/</font> widget <font color="#339933">/</font> TextView <font color="#339933">; -&gt;</font> setText <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> CharSequence <font color="#339933">;</font> <font color="#009900">)</font> V <br>  .  <font color="#006633">line</font> <font color="#cc66cc">521</font> <br>  return <font color="#339933">-</font> <font color="#000066">void</font> <br>  .  <font color="#006633">end</font> method </blockquote><br>  For the first number in the example, everything is simple.  Replace <blockquote>  invoke <font color="#339933">-</font> <font color="#000000">static</font> <font color="#009900">{</font> v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">; -&gt;</font> valueOf <font color="#009900">(</font> I <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> </blockquote>  on <blockquote>  invoke <font color="#339933">-</font> <font color="#000000">static</font> <font color="#009900">{</font> v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">Integer</font> <font color="#339933">; -&gt;</font> toHexString <font color="#009900">(</font> I <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> </blockquote>  and deal with the end.  With the other two a little more complicated, they are not translated into String added to the result.  Therefore, we replace <blockquote>  iget v2, p0, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> b <font color="#339933">:</font> I <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> I <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 </blockquote>  on <blockquote>  iget v2, p0, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> b <font color="#339933">:</font> I <br>  invoke <font color="#339933">-</font> <font color="#000000">static</font> <font color="#009900">{</font> v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">Integer</font> <font color="#339933">; -&gt;</font> toHexString <font color="#009900">(</font> I <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v2 <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">; -&gt;</font> append <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> StringBuilder <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 </blockquote>  (note that the type of value being transferred has changed).  Similarly, we do with the third number. <br>  We start - we see small letters.  And you want something big!  Not a problem, append before adding to the line <blockquote>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">; -&gt;</font> toUpperCase <font color="#009900">(</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v2 </blockquote>  for all three numbers. <br><br><h4>  Change input field </h4><br>  In general, this could be stopped, it became much more difficult to count.  But now the translation from hex to dec is being trained, and we continue to count in decimal.  This is not what we wanted.  Therefore it is necessary to convert the input field. <br>  First of all, to finish with the update method, add ‚Äú0x‚Äù in front of the input field.  Well, it's very simple, change <blockquote>  const <font color="#339933">-</font> string v2, <font color="#0000ff">"="</font> </blockquote>  on <blockquote>  const <font color="#339933">-</font> string v2, <font color="#0000ff">"= 0x"</font> </blockquote>  Next, you need to change the type of the input field from numeric to text (numeric hex, unfortunately, does not provide).  Similar properties are stored in xml files.  Here I was helped by searching the files by the keywords ‚Äúarithmetic‚Äù, ‚Äúmath‚Äù and the like.  In the file res / layout / ringer.xml we find the line <blockquote><pre>  &lt;EditText android: textSize = "36.0dip" android: gravity = "left" android: id = "@ id / math_solution" android: visibility = "invisible" android: layout_width = "wrap_content" android: layout_height = "wrap_content" android: text = "@ null" android: inputType = "phone" /&gt; </pre></blockquote>  we google, we find the list of values ‚Äã‚ÄãinputType, we change on "text". <br>  Now it remains to learn how to transform the input so that it coincides with the result calculated during the generation (RingerActivity.x, remember?).  We search and find the following code <blockquote>  ... <br>  <font color="#006633">label1621</font> <font color="#339933">:</font> label1912 <font color="#339933">:</font> <font color="#000000">for</font> <font color="#009900">(</font> <font color="#000066">boolean</font> bool15 <font color="#339933">=</font> <font color="#000066">false</font> ;; bool15 <font color="#339933">=</font> <font color="#000066">true</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  <font color="#000066">boolean</font> bool16 <font color="#339933">=</font> bool15 <font color="#339933">;</font> <br>  <font color="#000000">this</font> .  <font color="#006633">arithmeticProblemSolved</font> <font color="#339933">=</font> bool16 <font color="#339933">;</font> <br>  RingerActivity localRingerActivity14 <font color="#339933">=</font> <font color="#000000">this</font> <font color="#339933">;</font> <br>  <font color="#000066">int</font> i9 <font color="#339933">=</font> <font color="#cc66cc">2131099787</font> <font color="#339933">;</font> <br>  TextView localTextView4 <font color="#339933">=</font> <font color="#009900">(</font> TextView <font color="#009900">)</font> localRingerActivity14.  <font color="#006633">findViewById</font> <font color="#009900">(</font> i9 <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000000">this</font> .  <font color="#006633">problem</font> <font color="#339933">=</font> localTextView4 <font color="#339933">;</font> <br>  RingerActivity localRingerActivity15 <font color="#339933">=</font> <font color="#000000">this</font> <font color="#339933">;</font> <br>  <font color="#000066">int</font> i10 <font color="#339933">=</font> <font color="#cc66cc">2131099788</font> <font color="#339933">;</font> <br>  EditText localEditText1 <font color="#339933">=</font> <font color="#009900">(</font> EditText <font color="#009900">)</font> localRingerActivity15.  <font color="#006633">findViewById</font> <font color="#009900">(</font> i10 <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000000">this</font> .  <font color="#006633">solution</font> <font color="#339933">=</font> localEditText1 <font color="#339933">;</font> <br>  RingerActivity localRingerActivity16 <font color="#339933">=</font> <font color="#000000">this</font> <font color="#339933">;</font> <br>  <font color="#003399">String</font> str7 <font color="#339933">=</font> <font color="#0000ff">"input_method"</font> <font color="#339933">;</font> <br>  InputMethodManager localInputMethodManager <font color="#339933">=</font> <font color="#009900">(</font> InputMethodManager <font color="#009900">)</font> localRingerActivity16.  <font color="#006633">getSystemService</font> <font color="#009900">(</font> str7 <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000000">this</font> .  <font color="#006633">imm</font> <font color="#339933">=</font> localInputMethodManager <font color="#339933">;</font> <br>  EditText localEditText2 <font color="#339933">=</font> <font color="#000000">this</font> .  <font color="#006633">solution</font> <font color="#339933">;</font> <br>  <font color="#cc66cc">9</font> local91 <font color="#339933">=</font> <font color="#000000">new</font> com <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity $ <font color="#cc66cc">9</font> <font color="#339933">;</font> <br>  <font color="#cc66cc">9</font> local92 <font color="#339933">=</font> local91 <font color="#339933">;</font> <br>  RingerActivity localRingerActivity17 <font color="#339933">=</font> <font color="#000000">this</font> <font color="#339933">;</font> <br>  ImageButton localImageButton5 <font color="#339933">=</font> localImageButton3 <font color="#339933">;</font> <br>  ImageButton localImageButton6 <font color="#339933">=</font> localImageButton1 <font color="#339933">;</font> <br>  local92.  <font color="#339933">&lt;</font> init <font color="#339933">&gt;</font> <font color="#009900">(</font> localRingerActivity17, localImageButton5, localImageButton6 <font color="#009900">)</font> <font color="#339933">;</font> <br>  localEditText2.  <font color="#006633">setOnEditorActionListener</font> <font color="#009900">(</font> local91 <font color="#009900">)</font> <font color="#339933">;</font> <br>  ... </blockquote>  It is rather difficult to understand anything, but we see some connection between the solution and com / splunchy / android / alarmclock / RingerActivity $ 9.  It turns out the last - this is a smali file, which, apparently, jd-gui could not adequately display.  We go there and find the comparison method we need! <br><blockquote>  ... <br>  <font color="#006633">iget</font> <font color="#339933">-</font> object v1, p0, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity $ <font color="#cc66cc">9</font> <font color="#339933">; -&gt;</font> this $ <font color="#cc66cc">0</font> <font color="#339933">:</font> Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">;</font> <br>  invoke <font color="#339933">-</font> <font color="#000000">static</font> <font color="#009900">{</font> v1 <font color="#009900">}</font> , Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> access $ <font color="#cc66cc">10</font> <font color="#009900">(</font> Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">;</font> <font color="#009900">)</font> Landroid <font color="#339933">/</font> widget <font color="#339933">/</font> EditText <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1 <font color="#009900">}</font> , Landroid <font color="#339933">/</font> widget <font color="#339933">/</font> EditText <font color="#339933">; -&gt;</font> getText <font color="#009900">(</font> <font color="#009900">)</font> Landroid <font color="#339933">/</font> text <font color="#339933">/</font> Editable <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  invoke <font color="#339933">-</font> <font color="#000000">interface</font> <font color="#009900">{</font> v1 <font color="#009900">}</font> , Landroid <font color="#339933">/</font> text <font color="#339933">/</font> Editable <font color="#339933">; -&gt;</font> toString <font color="#009900">(</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v1 <br>  new <font color="#339933">-</font> instance v2, Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">Integer</font> <font color="#339933">;</font> <br>  iget <font color="#339933">-</font> object v3, p0, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity $ <font color="#cc66cc">9</font> <font color="#339933">; -&gt;</font> this $ <font color="#cc66cc">0</font> <font color="#339933">:</font> Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">;</font> <br>  iget v3, v3, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> x <font color="#339933">:</font> I <br>  invoke <font color="#339933">-</font> direct <font color="#009900">{</font> v2, v3 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">Integer</font> <font color="#339933">; -&gt; &lt;</font> init <font color="#339933">&gt;</font> <font color="#009900">(</font> I <font color="#009900">)</font> V <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">Integer</font> <font color="#339933">; -&gt;</font> toString <font color="#009900">(</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v2 <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v1, v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">; -&gt;</font> equals <font color="#009900">(</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">Object</font> <font color="#339933">;</font> <font color="#009900">)</font> Z <br>  move <font color="#339933">-</font> result v1 <br>  ... </blockquote>  Well, we add the translation in the upper case to the line read from the input field, since we have already learned this.  After that we replace <blockquote>  iget v3, v3, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> x <font color="#339933">:</font> I <br>  invoke <font color="#339933">-</font> direct <font color="#009900">{</font> v2, v3 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">Integer</font> <font color="#339933">; -&gt; &lt;</font> init <font color="#339933">&gt;</font> <font color="#009900">(</font> I <font color="#009900">)</font> V <br>  invoke <font color="#339933">-</font> virtual <font color="#009900">{</font> v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">Integer</font> <font color="#339933">; -&gt;</font> toString <font color="#009900">(</font> <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v2 </blockquote>  on <blockquote>  iget v2, v3, Lcom <font color="#339933">/</font> splunchy <font color="#339933">/</font> android <font color="#339933">/</font> alarmclock <font color="#339933">/</font> RingerActivity <font color="#339933">; -&gt;</font> x <font color="#339933">:</font> I <br>  invoke <font color="#339933">-</font> <font color="#000000">static</font> <font color="#009900">{</font> v2 <font color="#009900">}</font> , Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">Integer</font> <font color="#339933">; -&gt;</font> toHexString <font color="#009900">(</font> I <font color="#009900">)</font> Ljava <font color="#339933">/</font> lang <font color="#339933">/</font> <font color="#003399">String</font> <font color="#339933">;</font> <br>  move <font color="#339933">-</font> result <font color="#339933">-</font> object v2 </blockquote>  and here we also add the translation to the upper case.  We collect, we look.  Hooray!  Everything is working. <br><br><h4>  Conclusion </h4><br>  Soon the tale is affected, but it is not done soon.  Due to the lack of a debugger, testing is very difficult, in order to start the application and test its performance it takes a couple of minutes and a lot of annoying actions. <br>  I also really wanted to remake the digital layout of my favorite <a href="http://beta.swype.com/">Swype</a> keyboard for input in hex.  But their encrypted layout files have become an insurmountable obstacle for me.  = ( <br><br>  Here is the final version of the <a href="http://zalil.ru/31643288">alarm</a> .  Unfortunately, it has stopped updating after modification.  Well, yes, I have enough of the current functionality. <br><br>  Thank you for your attention, I will be glad to any criticism! <br><br>  PS <a href="http://alchutoff.livejournal.com/87755.html">Hex multiplication table</a> </div><p>Source: <a href="https://habr.com/ru/post/127637/">https://habr.com/ru/post/127637/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127624/index.html">A social network has opened for the dead</a></li>
<li><a href="../127630/index.html">Stakeholders: special attention zone</a></li>
<li><a href="../127631/index.html">Samsung will not acquire webOS</a></li>
<li><a href="../127634/index.html">Samsung N100 MeeGo Netbook Review</a></li>
<li><a href="../127635/index.html">Portrait of noob</a></li>
<li><a href="../127639/index.html">Using Dummynet to emulate a narrow channel under Windows</a></li>
<li><a href="../127640/index.html">IFA 2011, day 3: Acer Aspire 3951</a></li>
<li><a href="../127641/index.html">Game Prototyping with JavaScript and CSS3</a></li>
<li><a href="../127642/index.html">We build DSL on C # using parser combinators</a></li>
<li><a href="../127643/index.html">We get a free SSL certificate</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>