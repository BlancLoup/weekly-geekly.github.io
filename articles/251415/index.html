<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Flask. Fill the "flask" functionality</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 Last year I decided to get acquainted closely with Python, and later move to it with PHP. At the moment, my path is web development, and th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Flask. Fill the "flask" functionality</h1><div class="post__text post__text-html js-mediator-article"><h4>  Foreword </h4><br>  Last year I decided to get acquainted closely with Python, and later move to it with PHP.  At the moment, my path is web development, and therefore I started to learn a new language from the web side, in particular, with an overview of the available frameworks and projects for them.  Acquainted with the possibilities of TurboGears, web2py, Django, I still succumbed to the "trend" and plunged into the world of Django. <br><br>  For almost a year, I honestly tried to make friends with him.  I wrote some unpretentious projects, but the framework's monstrosity was scary, the abundance of ‚Äúbatteries‚Äù confused the choice, and did not want to put up with some restrictions.  The soul required conciseness and unambiguity, which ultimately led me to get acquainted with Flask.  Having studied the documentation on the framework and related projects (Jinja2, Werkzeug), I imbued with the ideology and began to closely study the framework. <br><br>  Flask is positioned as an expandable microframe.  This means that only the necessary minimum of functionality is present, but at the same time it is possible to add it through extensions to the level required by the project. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This epic is my experience under using Flask and extensions for it, or rather, an attempt to bring together and in Russian something that can be useful when creating projects of almost any level. <br><a name="habracut"></a><br><h3>  Structure and configuration </h3><br>  For each project, I follow the typical structure described below.  Everything is rather trivial and familiar to Django programmers: <br><br><pre><code class="plaintext hljs">app/ --commands/ --migrations/ --static/ --templtaes/ --app.py --config.py --forms.py --manage.py --models.py --views.py</code> </pre> <br><ul><li>  The <i>commands</i> directory contains commands for servicing the application, connected in the manage.py module. </li><li>  <i>Migrations</i> directory - files and configurations of migrations.  Usually created automatically when migrations are initialized. </li><li>  Catalog <i>static</i> - project resources: js, css, scss and pictures. </li><li>  Catalog <i>templates</i> - templates. </li><li>  The <i>app.py</i> file is the head module of the application, where the main settings are defined and extensions are registered, it also implements the web server. </li><li>  The <i>manage.py</i> file is used to manage and maintain the project. </li><li>  The <i>config.py file</i> contains the application configuration object.  I note that Flask can be configured in various ways, but the most convenient method seemed to me based on objects.  In simplified form, the contents of the file looks like this: <br><br><div class="spoiler">  <b class="spoiler_title">config.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os basedir = os.path.abspath(os.path.dirname(__file__)) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Config</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> DEBUG = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> CSRF_ENABLED = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> WTF_CSRF_SECRET_KEY = <span class="hljs-string"><span class="hljs-string">'dsofpkoasodksap'</span></span> SECRET_KEY = <span class="hljs-string"><span class="hljs-string">'zxczxasdsad'</span></span> SQLALCHEMY_DATABASE_URI = <span class="hljs-string"><span class="hljs-string">'mysql+mysqlconnector://webuser:web_password@localhost/webuser_db'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductionConfig</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Config)</span></span></span><span class="hljs-class">:</span></span> DEBUG = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DevelopConfig</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Config)</span></span></span><span class="hljs-class">:</span></span> DEBUG = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> ASSETS_DEBUG = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre></div></div><br>  And its use is as follows: <br><br><div class="spoiler">  <b class="spoiler_title">app.py</b> <div class="spoiler_text"><pre> <code class="python hljs">app.config.from_object(<span class="hljs-string"><span class="hljs-string">'config.DevelopConfig'</span></span>)</code> </pre></div></div></li></ul><br>  For large projects, official documentation recommends splitting up the functionality into so-called <i>blueprints</i> ‚Äî modules that are structurally similar to the Flask application, and organize the project itself into a python package.  But today is not about that. <br><br><h2>  Extensions </h2><br><h3>  Flask-SQLAlchemy </h3><br>  Any serious application uses databases.  This extension makes Flask friends with the most popular Python ORM library, SQLAlchemy, allowing you to use any DBMS supported by it, as well as mapping tables to Python objects, similar to Django.  However, SQLAlchemy allows you to do without ORM. <br><br><div class="spoiler">  <b class="spoiler_title">Using</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># config.py class Config(object): ... #  DSN   SQLALCHEMY_DATABASE_URI = 'mysql+mysqlconnector://webuser:web_password@localhost/webuser_db' # app.py #   from flask.ext.sqlalchemy import SQLAlchemy #    db = SQLAlchemy(app) # models.py from app import db #  User -   users   class User(db.Model): __tablename__ = 'users' id = db.Column(db.Integer, primary_key=True) email = db.Column(db.String(120), unique=True, nullable=False) password = db.Column(db.String(255))</span></span></code> </pre></div></div><br>  Documentation: <a href="http://pythonhosted.org/Flask-SQLAlchemy/">pythonhosted.org/Flask-SQLAlchemy</a> <br><br><h3>  Flask-script </h3><br>  Adds support for project serving scripts: starting a dev server, migrating databases, cron tasks and the like.  Following the recommendations, I create for each project a file <i>manage.py</i> , where all the necessary maintenance teams are added.  By default, the <i>runserver</i> command is <i>available</i> .  Commands are executed as follows: <br><br><pre> <code class="bash hljs">$ python manage.py <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> &lt;action&gt; $ python manage.py runserver $ python manage.py db migate</code> </pre><br>  You can add a command, for example, by implementing a child of the <i>Command</i> class included in the package, and registering it with the manager.  A command may contain actions (subcommands), command line parameters may be passed to it. <br><br><div class="spoiler">  <b class="spoiler_title">manage.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask.ext.script <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Manager <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask.ext.migrate <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Migrate, MigrateCommand <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> app, db <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * migrate = Migrate(app, db) <span class="hljs-comment"><span class="hljs-comment">#   manager = Manager(app) #  ,      Command manager.add_command('db', MigrateCommand) if __name__ == '__main__': manager.run()</span></span></code> </pre></div></div><br>  Documentation: <a href="http://flask-script.readthedocs.org/en/latest/">flask-script.readthedocs.org/en/latest</a> <br><br><h3>  Flask-migrate </h3><br>  Allows you to configure the migration for ORM SQLAlchemy.  The package provides the MigrateCommand class, which can be used in conjunction with the above-described Flask-Script extension.  To use migrations, you need to connect a command (example above), perform initial initialization, <i>run manage.py db init</i> , then use the migrate, upgrade, and downgrade actions of this command to manage migrations.  It is worth noting that the list of actions for the team and their brief description can be obtained by running <i>manage.py db help</i> . <br><br>  Documentation: <a href="https://flask-migrate.readthedocs.org/en/latest/">flask-migrate.readthedocs.org/en/latest</a> <br><br><h3>  Flask-wtf </h3><br>  Implements binding to WTForms - a great library for working with forms.  Again, there is an analogy with Django.  In the box: a solid set of classes of fields and validators for them, inheritance, nested forms, and more. <br><br><div class="spoiler">  <b class="spoiler_title">forms.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask_wtf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Form <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> wtforms <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StringField, PasswordField, TextAreaField, SelectField <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> wtforms.validators <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Email, DataRequired, EqualTo <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoginForm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Form)</span></span></span><span class="hljs-class">:</span></span> email = StringField(<span class="hljs-string"><span class="hljs-string">'E-mail'</span></span>, validators=[Email(), DataRequired()]) password = PasswordField(<span class="hljs-string"><span class="hljs-string">''</span></span>, validators=[DataRequired()]) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RegistrationForm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(LoginForm)</span></span></span><span class="hljs-class">:</span></span> password_repeat = PasswordField(<span class="hljs-string"><span class="hljs-string">' '</span></span>, validators=[DataRequired(), EqualTo(<span class="hljs-string"><span class="hljs-string">'password'</span></span>)])</code> </pre></div></div><br>  There is also a wtforms-alchemy extension for creating forms based on SQLAlchemy models.  I stumbled upon it quite recently, therefore there is no work experience yet.  However, I think, the analogy with Django is applicable here. <br><br>  Documentation: <a href="https://flask-wtf.readthedocs.org/en/latest/">flask-wtf.readthedocs.org/en/latest</a> <br><br><h3>  Flask-Login </h3><br>  Adds basic support for authorization and user sessions.  Connecting this extension requires a lot of actions, so I will try to be as concise as possible and skip the implementation of user logins and logouts. <br><br><div class="spoiler">  <b class="spoiler_title">Using Flask-Login</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># app.py #   from flask.ext.login import LoginManager, current_user #      "" login_manager = LoginManager() login_manager.init_app(app) login_manager.login_view = 'login' #  ,    Id,  None.     . @login_manager.user_loader def load_user(userid): from models import User return User.query.get(int(userid)) #   before_request,     -    @app.before_request def before_request(): g.user = current_user # models.py class User(db.Model): __tablename__ = 'users' id = db.Column(db.Integer, primary_key=True) email = db.Column(db.String(120), unique=True, nullable=False) password = db.Column(db.String(255)) #       User,      def is_authenticated(): return True def is_active(): return True def is_anonymous(): return False def get_id(self): return str(self.id)</span></span></code> </pre></div></div><br>  Documentation: <a href="https://flask-login.readthedocs.org/en/latest/">flask-login.readthedocs.org/en/latest</a> <br><br><h3>  Flask-bcrypt </h3><br>  Adds functionality for hashing and checking passwords. <br><br><div class="spoiler">  <b class="spoiler_title">models.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask.ext.bcrypt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> generate_password_hash, check_password_hash <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(db.Model)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_password</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, password)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> check_password_hash(self.password, password) @staticmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hash_password</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(password)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> generate_password_hash(password)</code> </pre></div></div><br><h3>  Flask-assets </h3><br>  Flask is friends with the webassets library, allowing you to work with project resources incredibly elegantly.  It knows how to combine resources into packages, compile scss (sass) and less, minify js and css and conveniently connect them in templates. <br><br><div class="spoiler">  <b class="spoiler_title">Using</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># app.py #  from flask.ext.assets import Environment, Bundle assets = Environment(app) #     js = Bundle('jquery.js', 'jquery.file-upload.js', filters='jsmin', output='assets/jquery-min.js') css = Bundle('main.css', 'form.css', 'flashes.css', filters='cssmin', output='assets/all-min.css') assets.register('js_all', js) assets.register('css_all', css) # templates/index.html {% assets "js_all" %} &lt;script type="text/javascript" src="{{ ASSET_URL }}"&gt;&lt;/script&gt; {% endassets %} {% assets "css_all" %} &lt;link rel="stylesheet" href="{{ ASSET_URL }}"&gt; {% endassets %}</span></span></code> </pre></div></div><br>  By specifying the <i>filters</i> parameter in the package (Bundle), we will force the package files to pass through the specified filter (s).  In our case, files are minified and merged into one.  Some filters will require the installation of additional python-modules. <br><br>  If the parameter ASSETS_DEBUG = True is set in the configuration, then the package files will not be passed through the filters and glued together, and a separate url will be generated for each file in the template. <br><br>  PS With a sufficiently large number of resources, you should take out the functionality for forming packages (Bundle) and register them in a separate file - for example, assets.py. <br><br>  Documentation: <a href="http://flask-assets.readthedocs.org/en/latest/">flask-assets.readthedocs.org/en/latest</a> <br><br><h3>  Flask-debugtoolbar </h3><br>  What development will do without a convenient debugger?  The extension adds a debug-panel ported from Django, with comprehensive information about the request.  The panel is displayed when the parameter DEBUG = True is set in the configuration. <br><br><div class="spoiler">  <b class="spoiler_title">app.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># config.py class Config(object): ... #     cookie SECRET_KEY = 'xv3gavkxc04n3mzx7oksd6q' # app.py #  from flask_debugtoolbar import DebugToolbarExtension #  dtb = DebugToolbarExtension(app)</span></span></code> </pre></div></div><br>  Documentation: <a href="http://flask-debugtoolbar.readthedocs.org/en/latest/">flask-debugtoolbar.readthedocs.org/en/latest</a> <br><br><h3>  Instead of conclusion </h3><br>  The article presents the extensions that I used to use in my projects, but this is not a complete list of what already exists for Flask.  A more comprehensive list of current extensions is presented on the framework's official website by the link <a href="http://flask.pocoo.org/extensions">flask.pocoo.org/extensions</a> . <br><br><h4>  Additions </h4><br>  The user <a href="https://habr.com/ru/users/dansamara/" class="user_link">danSamara</a> <a href="http://habrahabr.ru/post/251415/">pointed</a> to the skeleton project of the application on Flask, which included many of the extensions described, as well as caching of Flask-Cache, the theme on bootstrap3, and the skeleton itself is designed as a python package and uses blueprints.  Very useful thing.  ;-) </div><p>Source: <a href="https://habr.com/ru/post/251415/">https://habr.com/ru/post/251415/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251403/index.html">WEB Server based on ENC28j60 + Arduino - it can't be easier</a></li>
<li><a href="../251407/index.html">How to create a subdomain in VestaCP</a></li>
<li><a href="../251409/index.html">How to set up a LibGDX project with Gradle, Google Play Services</a></li>
<li><a href="../251411/index.html">Why learn programming so damn hard?</a></li>
<li><a href="../251413/index.html">How to make a game for iOS from an empty plastic bottle, pictures and shader</a></li>
<li><a href="../251417/index.html">Lossy image compression</a></li>
<li><a href="../251419/index.html">Generating textures of planets using the Fault Formation algorithm</a></li>
<li><a href="../251421/index.html">We increase the stability of the front-end</a></li>
<li><a href="../251423/index.html">Intel IoT Meet-up in Nizhny Novgorod</a></li>
<li><a href="../251425/index.html">Patterns Don't Stop at Design - Be a Pattern-Driven Team</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>