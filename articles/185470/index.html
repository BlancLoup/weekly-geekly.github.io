<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Workflow in the workflow balloon: standard and not very</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear habrovchane! 

 Quite a large number of organizations, state and commercial, if you didn‚Äôt set up a Sharepoint, then at least you heard...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Workflow in the workflow balloon: standard and not very</h1><div class="post__text post__text-html js-mediator-article">  Good day, dear habrovchane! <br><br>  Quite a large number of organizations, state and commercial, if you didn‚Äôt set up a Sharepoint, then at least you heard and imagine what you can do with it (thanks to Microsoft marketers). <br><br>  In this article I want to briefly describe the main ways I know how to create workflows in Sharepoint, and, as an additional topic, how this can be done in one of the application solutions - EOS for Sharepoint.  Subject workflow - document management. <br><a name="habracut"></a><br>  Imagine a business process of approving a document, application or other entity, which can be schematically depicted as in Figure 1 (sequential agreement on a linear route) and in turn consider the approaches: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1. Use Sharepoint's embedded approval business process (three steps) <br>  2. Process Modeling in Sharepoint Designer <br>  3. Creating a workflow in Visual Studio <br>  4. Creating a workflow in an EOS for Sharepoint solution <br><br>  Consciously omit here such methods as writing Custom Activities + Sharepoint Designer, creating a workflow designer in Visual Studio, using logic in Infopath forms.  The first does not significantly increase the logical flexibility compared to the Sharepoint Designer, the second is difficult to develop, which will be justified except when developing your own boxed solutions.  But InfoPath forms are only in the Enterprise version, not everyone has a desire to buy Enterprise. <br><br><img src="https://habrastorage.org/storage2/6d1/d73/ec8/6d1d73ec8f822d55e7c7226402d1a04b.png"><br>  <i>Figure 1 - Linear matching scheme</i> <br><br>  Obviously, if an automated business process looks like in Figure 1, then, with some reservations, any method will do - it is only a matter of expediency.  I would use the built-in workflow + convenient design of pages and list views. <br><br>  But what if the reconciliation process looks like in Figure 2?  Here, the negotiation process is non-linear, and the route depends on several conditions. <br><img src="https://habrastorage.org/storage2/34d/ad1/6bd/34dad16bd9388b5b49cda53a311e355d.png"><br>  <i>Figure 2 - Non-linear matching scheme</i> <br><br>  In the documentation support department (2nd step), upon receiving a draft document, they may decide that additional coordinators should be added to the process.  In addition, the project should be sent for approval to the financial director only under the condition that the amount of the project agreement is more than 900,000 rubles. <br><br>  As for the possible means, the situation here is different: <br><h5>  1. Use Sharepoint's embedded approval business process </h5><br>  The embedded process does not support branching, which means it will not work for solving the problem. <br><br><h5>  2. Process Modeling in Sharepoint Designer </h5><br>  If I were given a condition to model the process in the Sharepoint Designer, I would, somewhat cursing, write something similar to what is shown in Figure 3. <br><img src="https://habrastorage.org/storage2/d89/040/5be/d890405bea7241738e7f663f12b85346.png"><br>  <i>Figure 3 - Workflow in Sharepoint Designer</i> <br><br>  With a set of conditional operators, and custom forms of tasks, such as shown in Figure 4, the process can be implemented. <br><img src="https://habrastorage.org/storage2/4e2/ec8/de2/4e2ec8de2f660ff64cc9f383632f1dcc.png"><br>  <i>Figure 4 - Custom Task in Sharepoint Designer</i> <br><br>  <b>Advantages of the approach:</b> <br>  1. With some training, perseverance and free time, a competent manager or an adequate administrator will cope with this task. <br>  2. The process can be reconfigured. <br>  3. The ability to limit the rights of the user creating the workflow. <br><br>  <b>Cons of the approach:</b> <br>  1. looks cumbersome and opaque. <br>  2. With more branches, you will have to draw a workflow diagram on a piece of paper separately - by how it looks in the Sharepoint Designer, it is difficult to understand something. <br>  3. In Sharepoint Designer 2010, cycles in workflows have not yet been invented, so restarting the process in case of failure will fail, at least by obvious methods. <br>  4. A large number of additional actions that do not relate to the logic of the process. <br><br><h5>  3. Creating a workflow in Visual Studio </h5><br>  Visual Studio allows you to create arbitrarily flexible and complex business processes.  For example, part of the process described above might look something like this (Figure 5): <br><img src="https://habrastorage.org/storage2/6c6/4f7/617/6c64f76178228b06c849a3d55907190d.png"><br>  <i>Figure 5 - Fragment of the Visual Studio workflow</i> <br><br>  Logic can be controlled using While loops, If-Else and ConditionalActivity branches ( <a href="http://msdn.microsoft.com/ru-ru/library/hh824675(v%3Doffice.14).aspx">http://msdn.microsoft.com/ru-ru/library/hh824675</a> (v = office 14 ).aspx for more details). <br><br>  <b>Advantages of the approach:</b> <br>  1. High logical flexibility <br>  2. Features .NET <br><br>  <b>Cons of the approach:</b> <br>  1. the complexity of implementation, making changes. <br>  2. Programming and farm administrator rights are required. <br>  3. Transparency only during the writing process and with serious documentation. <br><br><h5>  4. EOS for Sharepoint </h5><br>  Eos for Sharepoint is a complete electronic document management system.  The visual process editor is not here, but there is a built-in constructor, which, upon closer inspection, turns out to be quite powerful and easy to use.  Thus, the process described above consists of the sequential adjustment of all stages (Figures 6,7,8). <br><img src="https://habrastorage.org/storage2/364/aa6/e23/364aa6e2304625cda3ef4cac3e7fda79.png"><br>  <i>Figure 6 - Selection of participants of the stage</i> <br><br><img src="https://habrastorage.org/storage2/1a5/ac4/a29/1a5ac4a295059407ac6226f32105909a.png"><br>  <i>Figure 7 - Startup conditions for the workflow</i> <br><br>  For each stage, you can select participants, automatically set permissions, determine the method of maintaining the workflow history (Figure 6), configure launch conditions and query the fields for the value of the user (Figure 7).  For the stage where additional approvals are required, you can run a separate customized reconciliation workflow. <br><br>  After completing the configuration of each stage, you can configure the parameters of the workflow as a whole: for example, restarting the workflow in case of a failure of one of the coordinators (in this workflow will start from the first stage, Figure 8). <br><img src="https://habrastorage.org/storage2/5a8/030/42b/5a803042be88b16f4f118396459e474a.png"><br>  <i>Figure 8 - Setting the parameters of the workflow</i> <br><br>  Using the consistent configuration of each stage in EOS for Sharepoint, you can simulate the business process of reconciling any complexity in a fairly short time.  No additional actions, checks and validations - any more or less competent IT specialist will cope with the creation of the process. <br><br><h4>  Conclusion </h4><br>  The choice of how to automate Sharepoint business processes depends, for the most part, on its complexity.  If the process is very simple - it is enough to use standard tools.  If the process is complex and ramified, the implementation of its logic in SPD or Visual Studio can be lengthy and complex, in this case, it will be more efficient to use third-party tools that allow you to focus on the logic of the process without going into implementation details. </div><p>Source: <a href="https://habr.com/ru/post/185470/">https://habr.com/ru/post/185470/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../185446/index.html">EFF stood up for the hacker who found the vulnerability on the AT & T site and got behind the bars</a></li>
<li><a href="../185448/index.html">Intel applications for Android. Informational resources</a></li>
<li><a href="../185450/index.html">TV spy, or the dangers of using rice cookers: reports and contests at NeoQUEST-2013</a></li>
<li><a href="../185460/index.html">Automatic recognition of emotions will improve distance learning</a></li>
<li><a href="../185468/index.html">Digium G400 and G800 Gateways (E1 PRI)</a></li>
<li><a href="../185472/index.html">GlobalsDB is a universal NoSQL database. Part 2</a></li>
<li><a href="../185474/index.html">Ubisoft account leakage</a></li>
<li><a href="../185478/index.html">Students of SPbNIU ITMO became winners of the 37th Student World Programming Championship</a></li>
<li><a href="../185482/index.html">Realistic Canvas Smoke</a></li>
<li><a href="../185484/index.html">Gibson Cache Server</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>