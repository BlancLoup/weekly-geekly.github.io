<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Moving XenForo Forum to the modern platform</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Why was it necessary 
 The platform for the community of our product has long been based on the XenForo forum engine. Until recently, the forum worked...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Moving XenForo Forum to the modern platform</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/1c9/40e/717/1c940e7179c34223af540d8bb363b7e3.png"><br><br><h3>  Why was it necessary </h3><br>  The platform for the community of our product has long been based on the <a href="https://xenforo.com/">XenForo</a> forum engine.  Until recently, the forum worked as a VPS based on CentOS 6.8 with vendor's Apache 2.2.15, MySQL 5.1 and PHP 5.6. <br><br>  In connection with the upcoming release of XenForo 2.0, which has increased requirements for components, and the general desire to speed up the forum on a modern component base, it was decided to move to VPS with nginx, the latest version of PHP and the database running on Percona Server 5.7. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The instructions below do not claim to be the ideal solution with the perfect configuration and can be considered as a general plan for using XenForo on nginx hosting.  The instruction is primarily intended for those XenForo administrators who are not too strong in the intricacies of Linux administration and would like to have some kind of common basic instruction. <br><a name="habracut"></a><br><h3>  VPS preparation </h3><br>  CentOS 7.3 was chosen as the operating system simply because the rpm-based OSes administrator is closer than deb-based :) <br><br>  VPS has 25Gb of disk space, 4Gb of RAM, and the command: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># cat /proc/cpuinfo | grep processor | wc -l</span></span></code> </pre> <br>  shows number 8. <br><br>  First, remove all unnecessary packages, such as Samba, httpd, and everything that you consider unnecessary.  Then we install all available updates from the official repository using: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># yum update</span></span></code> </pre> <br>  Next you need to connect all the necessary third-party repositories and install the components we need.  First install the <a href="https://www.percona.com/">Percona</a> database <a href="https://www.percona.com/">server</a> .  We connect the repository and install the necessary packages: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># yum install http://www.percona.com/downloads/percona-release/redhat/0.1-4/percona-release-0.1-4.noarch.rpm # yum install Percona-Server-server-57</span></span></code> </pre> <br>  Here the subtlety is that during the installation a temporary admin password is generated, which must be found with the help of the command: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># grep 'temporary password' /var/log/mysqld.log</span></span></code> </pre> <br>  We will need it to further configure Percona Server with the command: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># /usr/bin/mysql_secure_installation</span></span></code> </pre> <br>  After that you will receive a permanent password for your database server. <br><br>  Next, install the nginx repository and the nginx package itself: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># yum install epel-release # yum install nginx</span></span></code> </pre> <br>  After that, install the latest version of PHP with all the necessary components: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># cd /tmp # curl 'https://setup.ius.io/' -o setup-ius.sh # bash setup-ius.sh # yum install php71u-fpm-nginx php71u-cli php71u-mysqlnd php71u-pecl-memcached php71u-opcache php71u-gd memcached</span></span></code> </pre> <br>  We include all necessary services with the help <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># systemctl enable nginx # systemctl enable memcached # systemctl enable mysql # systemctl enable php-fpm</span></span></code> </pre> <br>  so that after restarting the server, they all start automatically.  This completes the preparation and proceeds to the most difficult - setting up the entire economy for the optimal operation of our XenForo forum. <br><br><h3>  Setting up services </h3><br>  In this section, you should not take everything as the ultimate truth.  Experienced administrators can specify much better tweaks.  Inexperienced are offered some general recommendations that they can use one-on-one, as a real working configuration, or use them as a template for their own individual configuration. <br><br>  So, first, in the /etc/php.ini file, set the value of the cgi.fix_pathinfo = 0 parameter.  Then we go to the /etc/php-fpm.d/www.conf file, comment on the line listen = 127.0.0.1:9000 and uncomment listen = /run/php-fpm/www.sock.  Additionally, we enable listen.acl_users = nginx.  It must be something like: <br><br><pre> <code class="php hljs">;listen = <span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>:<span class="hljs-number"><span class="hljs-number">9000</span></span> listen = /run/php-fpm/www.sock listen.acl_users = nginx</code> </pre> <br>  In the /etc/nginx/conf.d/php-fpm.conf file we also enable the work through the socket: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">#server 127.0.0.1:9000; server unix:/run/php-fpm/www.sock;</span></span></code> </pre> <br>  Restart php-fpm: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># systemctl restart php-fpm</span></span></code> </pre> <br>  For security reasons, the memcached service is bound only to the address 127.0.0.1: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># cat /etc/sysconfig/memcached PORT="11211" USER="memcached" MAXCONN="2048" CACHESIZE="1024" OPTIONS="-l 127.0.0.1"</span></span></code> </pre> <br>  Run it with: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># systemctl start memcached</span></span></code> </pre> <br>  make sure that port 11211 is open for connections and configure it in the XenForo config to use it to cache the backend in accordance with the <a href="https://xenforo.com/help/cache/">official documentation of XenForo.</a>  But there is a subtlety, instead of a line: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$config</span></span>[<span class="hljs-string"><span class="hljs-string">'cache'</span></span>][<span class="hljs-string"><span class="hljs-string">'backend'</span></span>] = <span class="hljs-string"><span class="hljs-string">'Memcached'</span></span>;</code> </pre> <br>  I earned a line: <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$config</span></span>[<span class="hljs-string"><span class="hljs-string">'cache'</span></span>][<span class="hljs-string"><span class="hljs-string">'backend'</span></span>]=<span class="hljs-string"><span class="hljs-string">'Libmemcached'</span></span>;</code> </pre> <br>  Percona Server can be optimized using their <a href="https://tools.percona.com/wizard">wizard</a> , or the well-known script mysqltuner.pl Everything is at your discretion and in accordance with the resources of your hardware. <br><br>  Just keep in mind that the configuration file is in /etc/percona-server.conf.d/mysqld.cnf <br><br>  The most difficult part in this story is the nginx configuration.  In the basic settings, nothing special.  Only correctly set the values ‚Äã‚Äãof worker_processes (the number of processors is determined by the cat / proc / cpuinfo | grep processor | wc -l command) and worker_connections (worker_processes * 1024): <br><br><pre> <code class="bash hljs">user nginx; worker_processes 8; error_log /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/nginx/error.log; pid /run/nginx.pid; include /usr/share/nginx/modules/*.conf; events { worker_connections 8192; use epoll; multi_accept on; }</code> </pre> <br>  Next is the httpd block.  Here, too, there are no particular subtleties, except for one, very important.  The fact is that we use FastCGI caching, and this will require additional settings.  This caching requires the inclusion of two configuration blocks in different nginx.conf blocks.  First, what it looks like in the httpd block: <br><br><pre> <code class="bash hljs">http { access_log off; server_tokens off; charset utf-8; reset_timedout_connection on; send_timeout 15; client_max_body_size 5m; client_header_buffer_size 1k; client_header_timeout 15; client_body_timeout 30; large_client_header_buffers 2 1k; open_file_cache max=2000 inactive=20s; open_file_cache_min_uses 5; open_file_cache_valid 30s; open_file_cache_errors off; output_buffers 1 32k; postpone_output 1460; sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; keepalive_requests 100000; types_hash_max_size 2048; include /etc/nginx/mime.types; default_type application/octet-stream; <span class="hljs-comment"><span class="hljs-comment">### FastCGI Cache ################ map $http_cookie $nocachecookie { default 0; ~xf_fbUid 1; ~xf_user 1; ~xf_logged_in 1; } map $request_uri $nocacheuri { default 0; ~^/register 1; ~^/login 1; ~^/validate-field 1; ~^/captcha 1; ~^/lost-password 1; ~^/two-step 1; } fastcgi_cache_path /tmp/nginx_fastcgi_cache levels=1:2 keys_zone=fastcgicache:200m inactive=30m; fastcgi_cache_key $scheme$request_method$host$request_uri; fastcgi_cache_lock on; fastcgi_cache_use_stale error timeout invalid_header updating http_500; fastcgi_ignore_headers Cache-Control Expires Set-Cookie; ### FastCGI Cache ################</span></span></code> </pre> <br>  Then we will return to the features of enabling FastCGI caching in another block, but for now let's look at the following block, server: <br><br><pre> <code class="bash hljs">server { listen 80 reuseport; server_name domain.com; <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> 301 https://domain.com<span class="hljs-variable"><span class="hljs-variable">$request_uri</span></span>; } server { listen 443 ssl reuseport http2; server_name domain.com; root /var/www/html; ssl_certificate <span class="hljs-string"><span class="hljs-string">"/etc/nginx/ssls/ssl-bundle.crt"</span></span>; ssl_certificate_key <span class="hljs-string"><span class="hljs-string">"/etc/nginx/ssls/domain_com.key"</span></span>; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_prefer_server_ciphers on; ssl_dhparam /etc/ssl/certs/dhparam.pem; ssl_ciphers <span class="hljs-string"><span class="hljs-string">"EECDH:+AES256:-3DES:RSA+AES:RSA+3DES:!NULL:!RC4"</span></span>; ssl_session_timeout 1d; ssl_session_cache shared:SSL:10m; ssl_session_tickets off; ssl_stapling on; ssl_stapling_verify on; resolver 8.8.8.8 8.8.4.4 77.88.8.8 valid=300s; resolver_timeout 5s; add_header X-Frame-Options DENY; add_header X-Content-Type-Options nosniff; add_header Strict-Transport-Security max-age=31536000;</code> </pre><br>  It is important to configure the SSL certificate.  In our case, a certificate from Comodo is used.  Instructions for connecting it can be found on their <a href="https://support.comodo.com/index.php%3F/Knowledgebase/Article/View/1091/37/certificate-installation--nginx">website</a> , and to generate /etc/ssl/certs/dhparam.pem we use the command: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048</span></span></code> </pre> <br>  Further verification of the SSL certificate settings can be done <a href="https://www.ssllabs.com/ssltest/">here</a> . <br><br>  And finally, the last important nginx config blocks: <br><br><pre> <code class="bash hljs">location / { index index.php index.html; try_files <span class="hljs-variable"><span class="hljs-variable">$uri</span></span> /index.php?<span class="hljs-variable"><span class="hljs-variable">$uri</span></span>&amp;<span class="hljs-variable"><span class="hljs-variable">$args</span></span>; } location ~ /(internal_data|library) { internal; } location ~ /wp-content/ { <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> 444; } location ~ /wp-includes/ { <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> 444; } <span class="hljs-comment"><span class="hljs-comment"># define error page error_page 404 = @notfound; # error page location redirect 301 location @notfound { return 301 /; } error_page 500 502 503 504 /50x.html; location = /50x.html { } location ~ \.php$ { fastcgi_max_temp_file_size 1M; fastcgi_cache_use_stale updating; fastcgi_pass_header Set-Cookie; fastcgi_pass_header Cookie; fastcgi_pass unix:/run/php-fpm/www.sock; fastcgi_index index.php; fastcgi_intercept_errors on; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; fastcgi_buffer_size 128k; fastcgi_buffers 256 16k; fastcgi_busy_buffers_size 256k; fastcgi_temp_file_write_size 256k; fastcgi_ignore_headers Cache-Control Expires Set-Cookie; proxy_buffer_size 8k; include fastcgi_params; ### fastcgi_cache ### fastcgi_cache fastcgicache; fastcgi_cache_bypass $nocachecookie $nocacheuri; fastcgi_no_cache $nocachecookie $nocacheuri; fastcgi_cache_valid 200 202 302 404 403 5m; fastcgi_cache_valid 301 1h; fastcgi_cache_valid any 1m; add_header X-Cache $upstream_cache_status; ### fastcgi_cache end ### } gzip on; gzip_http_version 1.1; gzip_vary on; gzip_min_length 1100; gzip_buffers 64 8k; gzip_comp_level 6; gzip_proxied any; gzip_types image/png image/gif image/svg+xml image/jpeg image/jpg text/xml text/javascript text/plain text/css application/json application/javascript application/x-javascript application/vnd.ms-fontobject gzip_disable "MSIE [1-6]\.(?!.*SV1)"; location ~* \.(ico|css|js|gif|jpeg|jpg|png|woff|ttf|svg)$ { add_header "Access-Control-Allow-Origin" "*"; root /var/www/html; expires 30d; add_header Pragma public; add_header Cache-Control "public"; } } }</span></span></code> </pre><br>  The location parameters are very important here for correct operation of the NC references, PHP scripts and closing access to important internal directories internal_data and library.  In addition, gzip compression and static media file caching are enabled here.  Well, the second part of setting up FastCGI caching. <br><br>  Actually, the forum content transfer itself consisted in transferring the database dump and tar.gz archive of the contents of the root directory and deploying them on the new server. <br><br><h3>  Additional information about caching in nginx </h3><br>  In the beginning, I tried using nginx microcaching.  First, create a directory to store the cache: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># mkdir /var/cache/nginx2</span></span></code> </pre> <br>  Created the /etc/nginx/conf.d/microcache.conf file with the contents: <br><br><pre> <code class="bash hljs">fastcgi_cache_path /var/cache/nginx2 levels=1:2 keys_zone=microcache:5m max_size=1000m; map <span class="hljs-variable"><span class="hljs-variable">$http_cookie</span></span> <span class="hljs-variable"><span class="hljs-variable">$cache_uid</span></span> { default nil; <span class="hljs-comment"><span class="hljs-comment"># hommage to Lisp ~SESS[[:alnum:]]+=(?&lt;session_id&gt;[[:alnum:]]+) $session_id; } map $request_method $no_cache { default 1; HEAD 0; GET 0; }</span></span></code> </pre> <br>  and in the nginx config for php location did this: <br><br><pre> <code class="bash hljs">location ~ \.php$ { fastcgi_cache microcache; fastcgi_cache_key <span class="hljs-variable"><span class="hljs-variable">$server_name</span></span>|<span class="hljs-variable"><span class="hljs-variable">$request_uri</span></span>; fastcgi_cache_valid 404 30m; fastcgi_cache_valid 200 10s;</code> </pre> <br>  In principle, everything worked perfectly, the forum began to work very quickly, except for one problem - sessions of registered and logged in users began to work strangely.  Suddenly, you discovered that you were logged out and you had to log in again. <br><br>  It turned out that the problem lies in the depths of the XenForo engine and is solved by installing the <a href="https://xenforo.com/community/resources/logged-in-cookie.4961/">Logged In Cookie</a> plugin and editing the XenForo helper_login_form and login_bar_form templates by replacing the line: <br><br><pre> <code class="php hljs">&lt;label <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rememberPassword</span></span></span><span class="hljs-class">"&gt;&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">input</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">checkbox</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">remember</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">="1" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ctrl_pageLogin_remember</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tabindex</span></span></span><span class="hljs-class">="3" /&gt; </span></span>{xen:phrase stay_logged_in}&lt;/label&gt;</code> </pre> <br>  per line: <br><br><pre> <code class="php hljs">&lt;input type=<span class="hljs-string"><span class="hljs-string">"hidden"</span></span> name=<span class="hljs-string"><span class="hljs-string">"remember"</span></span> checked=<span class="hljs-string"><span class="hljs-string">"checked"</span></span> value=<span class="hljs-string"><span class="hljs-string">"1"</span></span> /&gt;</code> </pre> <br>  But I learned all this later when I configured the FastCGI caching described above, with which everything now works fine.  Therefore, I think the problem with sessions would be solved for nginx microcaching, but I did not check.  You can try this caching option. <br><br><h3>  Conclusion </h3><br>  After testing the forum on <a href="https://developers.google.com/speed/pagespeed/insights/">Google Pagespeed</a> and the corresponding additional optimization, the substantial acceleration of the forum‚Äôs work could not be overlooked.  Now the forum is gaining 86 points out of 100. Previously, Apache had 78 points.  There is still something to work on in terms of code optimization, especially for the mobile version. <br><br>  In addition, I compared the old forum on Apache and the new one on nginx with load testing for a php script with a total of 1000 requests and the number of simultaneous connections 300. The results are obvious, as they say: <br><br><h4>  Apache: </h4><br>  # ab -n 1000 -c 300 <a href="https://talk6.plesk.com/admin.php">talk6.plesk.com/admin.php</a> <br>  This is ApacheBench, Version 2.3 &lt;$ Revision: 655654 $&gt; <br>  Copyright 1996 Adam Twiss, Zeus Technology Ltd, <a href="http://www.zeustech.net/">www.zeustech.net</a> <br>  Licensed to The Apache Software Foundation, <a href="http://www.apache.org/">www.apache.org</a> <br><br>  Benchmarking talk6.plesk.com (be patient) <br>  Completed 100 requests <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  Completed 200 requests <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  SSL handshake failed (5). <br>  Completed 300 requests <br>  Completed 400 requests <br>  Completed 500 requests <br>  Completed 600 requests <br>  Completed 700 requests <br>  Completed 800 requests <br>  Completed 900 requests <br>  Completed 1000 requests <br>  Finished 1000 requests <br><br><br>  Server Software: Apache / 2.2.15 <br>  Server Hostname: talk6.plesk.com <br>  Server Port: 443 <br>  SSL / TLS Protocol: TLSv1 / SSLv3, ECDHE-RSA-AES256-GCM-SHA384,2048,256 <br><br>  Document Path: /admin.php <br>  Document Length: 3438 bytes <br><br>  Concurrency Level: 300 <br>  <b>Time taken for tests: 9.056 seconds</b> <br>  Complete requests: 1000 <br>  <b>Failed requests: 44</b> <b><br></b>  <b>(Connect: 0, Receive: 0, Length: 44, Exceptions: 0)</b> <br>  Write errors: 0 <br>  Total transferred: 3734136 bytes <br>  HTML transferred: 3286728 bytes <br>  Requests per second: 110.43 [# / sec] (mean) <br>  <b>Time per request: 2716.714 [ms] (mean)</b> <br>  Time per request: 9.056 [ms] (mean, across all concurrent requests) <br>  Transfer rate: 402.69 [Kbytes / sec] received <br><br>  Connection Times (ms) <br>  min mean [¬± sd] median max <br>  Connect: 0 1987 1940.1 1223 8748 <br>  Processing: 59,257,800.3 76 4254 <br>  Waiting: 0 79 31.4 72 211 <br>  Total: 234 2244 1926.3 1472 8811 <br><br>  Percentage of the requests served within a certain time (ms) <br>  50% 1472 <br>  66% 2019 <br>  75% 2683 <br>  80% 3068 <br>  90% 4278 <br>  95% 8313 <br>  98% 8625 <br>  99% 8787 <br>  <b>100% 8811 (longest request)</b> <br><br><h4>  nginx: </h4><br>  # ab -n 1000 -c 300 <a href="https://talk.plesk.com/admin.php">talk.plesk.com/admin.php</a> <br>  This is ApacheBench, Version 2.3 &lt;$ Revision: 655654 $&gt; <br>  Copyright 1996 Adam Twiss, Zeus Technology Ltd, <a href="http://www.zeustech.net/">www.zeustech.net</a> <br>  Licensed to The Apache Software Foundation, <a href="http://www.apache.org/">www.apache.org</a> <br><br>  Benchmarking talk.plesk.com (be patient) <br>  Completed 100 requests <br>  Completed 200 requests <br>  Completed 300 requests <br>  Completed 400 requests <br>  Completed 500 requests <br>  Completed 600 requests <br>  Completed 700 requests <br>  Completed 800 requests <br>  Completed 900 requests <br>  Completed 1000 requests <br>  Finished 1000 requests <br><br><br>  Server Software: nginx <br>  Server Hostname: talk.plesk.com <br>  Server Port: 443 <br>  SSL / TLS Protocol: TLSv1 / SSLv3, ECDHE-RSA-AES128-GCM-SHA256,2048,128 <br><br>  Document Path: /admin.php <br>  Document Length: 3437 bytes <br><br>  Concurrency Level: 300 <br>  <b>Time taken for tests: 5.585 seconds</b> <br>  Complete requests: 1000 <br>  <b>Failed requests: 0</b> <br>  Write errors: 0 <br>  Total transferred: 3932790 bytes <br>  HTML transferred: 3474807 bytes <br>  Requests per second: 179.05 [# / sec] (mean) <br>  <b>Time per request: 1675.541 [ms] (mean)</b> <br>  Time per request: 5.585 [ms] (mean, across all concurrent requests) <br>  Transfer rate: 687.65 [Kbytes / sec] received <br><br>  Connection Times (ms) <br>  min mean [¬± sd] median max <br>  Connect: 182 1089 298.9 1185 1450 <br>  Processing: 55,261,279.5,159,1092 <br>  Waiting: 55 243 267.6 139 943 <br>  Total: 253 1350 81.5 1323 1510 <br><br>  Percentage of the requests served within a certain time (ms) <br>  50% 1323 <br>  66% 1347 <br>  75% 1422 <br>  80% 1451 <br>  90% 1467 <br>  95% 1477 <br>  98% 1486 <br>  99% 1498 <br>  <b>100% 1510 (longest request)</b> <br><br>  Monitoring the consumed VPS resources at the highest load of the forum also makes it possible to judge about their very small consumption.  The forum interface has recently been completely redesigned in accordance with the new corporate standard, and in combination with reactive responsiveness has become an additional advantage to attract new members of our community. <br><br>  PS I would be very grateful to the experts and experts of nginx in pointing out errors and tips on additional configuration optimization. </div><p>Source: <a href="https://habr.com/ru/post/326636/">https://habr.com/ru/post/326636/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326624/index.html">Financial mechanics startups. Startup School from Y Combinator 2017 (Part One)</a></li>
<li><a href="../326626/index.html">Own cryptocurrency on ethereum</a></li>
<li><a href="../326628/index.html">SDAccel - first acquaintance</a></li>
<li><a href="../326632/index.html">Under the hood of the development environment. Basic models</a></li>
<li><a href="../326634/index.html">Bash on Windows: Practical Experiments in Crossing Hedgehogs and Snacks</a></li>
<li><a href="../326640/index.html">How to cram your sensor in Android OS</a></li>
<li><a href="../326642/index.html">Recipe interface</a></li>
<li><a href="../326644/index.html">Scientists from ITMO University have proposed a new system for the transmission of energy over a distance</a></li>
<li><a href="../326646/index.html">Simplify converters for WPF</a></li>
<li><a href="../326648/index.html">St. Petersburg homeless - in Prague. Continuing the history of self-taught developer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>