<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We are writing the viewer of the MS Exchange mail database (part 1)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In one big, pre-Bolshoy country, there lived small, very small people. And everything was fine until a deep, deep hole appeared right in the center of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We are writing the viewer of the MS Exchange mail database (part 1)</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/bafc0a44/cfc9dfa2/7c32cd1f/9ca18694.png"><br>  <i>In one big, pre-Bolshoy country, there lived small, very small people.</i>  <i>And everything was fine until a deep, deep hole appeared right in the center of this big, or rather, very big country.</i>  <i>Well, I must say, she appeared not alone and, of course, not immediately, but no one will remember about it anymore and it does not matter to anyone.</i> <br><a name="habracut"></a><br>  <i>The main thing was a hole and it was big, even very large, or rather infinite, and more precisely nobody knows.</i>  <i>But the government of the very big country knew that it was necessary to do something with the pit and it was decided to study it and fall asleep.</i>  <i>To this were caused the most presamy, dexterous and courageous, intelligent and the most intelligent men and women from those who were in this beautiful state.</i> <i><br><br></i>  <i>And the most presses started.</i>  <i>Studied and fell asleep, fell asleep and studied, studied, fell asleep, fell asleep, studied, and it was repeated not so much, but many times.</i> <i><br><br></i>  <i>It so happened that our little best-selling heroes left, or rather, they had to leave, but the pit remained.</i>  <i>But new heroes came, the same small ones, but the very same ones, and they began to do the same.</i> <i>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </i>  <i>In general, it lasted as long as it was, until one remained the most.</i>  <i>And one day, the pit disappeared, really, and appeared somewhere in a completely different place, where they began to study and bury her again ...</i> <i><br></i> <br>  <b>All coincidences are random, everything is fictional and nothing like this has ever existed and could not exist!</b>  <b>True, true, well, or almost true.</b> <br><br>  One such ‚Äúpit‚Äù will be discussed further.  But since  Privacy Policy we will affect only a small piece of it, which can be reached using only <b>open</b> sources and the <b>documented</b> API. <br><br>  The material will be almost exclusive.  information on the grain. <br><br>  Have you ever wondered where MS Exchange Server stores all your mail, or how it works with it at the lowest level?  Here I am going to write a little about it here. <br><br>  <b>Warning:</b> Do not try to go deep into this topic, and your whole life is not enough.  I warned. <br><br><h4>  Introduction </h4><br>  MS Exchange Server (hereinafter simply Exchange) is one of the flagships in the Microsoft product line.  You can read about its main functions in the <a href="http://ru.wikipedia.org/wiki/Microsoft_Exchange_Server">wiki</a> or on the official <a href="http://www.microsoft.com/exchange/en-us/default.aspx">website</a> .  In short, this is a kind of "combine" for working with mail, calendars and other user data, which has extensive integration capabilities with various MS products (SharePoint, TFS, etc.). <br><br>  But within the framework of this article, we will not be interested in what it provides to the end user, but from where it takes this data and which API it uses for this.  We will try to independently read the mailbox database on the Exchange 2010 <a href="http://technet.microsoft.com/en-us/library/bb124699.aspx">Mailbox</a> role ( <a href="http://technet.microsoft.com/en-us/library/bb124699.aspx">Mailbox Server</a> ). <br><br>  Exchange has several entry points ( <a href="http://technet.microsoft.com/en-us/library/bb125134(EXCHG.140).aspx">CAS Server</a> ) through which the user can access his data and several protocols that he can use for this, for example, OWA, RPC (Outlook), POP3 / IMAP4. <br><br>  Regardless of how access is obtained, Exchange sends all requests for the Mailbox <a href="http://technet.microsoft.com/en-us/magazine/ff381422.aspx">role</a> (up to Exchange 2007, this was the only role), which, among other things, contains databases of user mailboxes that will interest us today.  Physically, these databases are located on the hard disk inside the <a href="http://www.msexchange.org/articles/Exchange-Databases-Disk-Consumption.html">* .edb</a> files.  They can be found in the Mailbox \ &lt;base name&gt; folder in the directory where Exchange was installed.  In addition, transaction logs and other files related to the database life cycle are placed there, but we will not need them, the most basic thing for us is * .edb. <br><br>  If you dig a little bit, you can find out that Exchange uses the <b>Extensible Storage Engine (ESE)</b> to access the contents of the databases!  And if you dig further, it becomes clear that the implementation of ESE functions is in the ese.dll library (or esent.dll).  This is the <b>core of all operations</b> performed by Exchange.  ESE provides an extensive set of tools for working with the database.  Description of functions, constants, structures and everything you might need can be found <a href="http://msdn.microsoft.com/en-us/library/gg269245(v%3DEXCHG.10).aspx">here</a> .  Unfortunately, this documentation has not been updated for a long time, so there are not a number of functions that appeared in Exchange 2010, but as part of this topic, we will not need them.  You can find ese.dll in the Bin folder inside the main Exchange directory. <br><br>  After reading the description of ESE it becomes clear that the data is stored in a <b>tabular</b> form, i.e.  a set of tables with columns and rows.  Table cells can be of different types, well, plus all the features of the databases: indexes, search, etc. <br><br>  In total, we know that Exchange stores its databases on the Mailbox role, in the form of files with the .edb extension, and accesses them thanks to ESE (ese.dll).  This is enough for us and we can start coding. <br><br>  We will list the tables in the database, as well as all the columns and columns.  Of course, we <s>will</s> never know what they mean.  only MS knows about this, well, and a few more people.  In these columns there should be <b>almost all the</b> information related to the mailboxes, starting with the user‚Äôs folder names, ending with letters, but to understand where that is already the task of reverse engineering will not be considered here. <br><br><h4>  Programming </h4><br><h5>  Training </h5><br>  First we need: <br><ul><li>  Visual Studio 2008-2010 </li><li>  MS Exchange Server 2010 (any other will do, but in this topic we‚Äôll talk about 2010) </li><li>  Knowledge of C / C ++ </li></ul>  In Exchange, create a database, which we will try to read.  To do this, you can use the <b>Exchange Management Console</b> ( <a href="http://technet.microsoft.com/en-us/library/bb123762.aspx">EMC</a> ).  I will not describe the procedure because  There is a lot of information on the Internet on this topic.  We will create a single user in this database (through the same EMC), so that it will contain some content and log in to this user in his mailbox to check that everything has been done correctly, for example, through OWA.  After that, go to the Mailbox directory and look for the folder with the name of our database, and in it the EDB file.  Before copying the base, unmount it through EMC.  That's all, we have a base for experiments.  Copy it somewhere, for example, in the directory of the future project. <br><br>  From the Bin folder, copy ese.dll, thanks to which we will work with the database. <br><br>  In Visual Studio, we create a console C ++ project.  Here is an important nuance, because  Exchange 2010 (unlike all previous versions) has <b>only</b> 64 bit version, then we will have to create a project with x64 support, since  otherwise, we simply cannot load ese.dll into our address space.  Therefore, to test the application, you need a 64-bit version of the OS, you can of course test it on Exchange itself, but I use my workstation with Windows 7 for this purpose. Also, we will use the unicode version of the API, so the project should be better to make unicode the default encoding. <br><br>  And so, in the newly created project we are convinced that there are support for x64 and Unicode (General - Use Unicode Character Set).  Now we include the main header file for ESE: <br><blockquote>  <font color="#339900">#include &lt;esent.h&gt;</font> </blockquote>  This file comes with the SDK along with the studio since VS 2008. <br>  In <b>stdafx.h we</b> add 2 defaines, with the JET (ESE) version, and indicate that we want to use the unicode version of the API: <br><blockquote>  <font color="#339900">#define JET_UNICODE</font> <br>  <font color="#339900">#define JET_VERSION 0x0600</font> </blockquote><br>  Well, now we need to decide what we want to get from the database.  ESE is a database with tables, columns, and rows; this is what we will try to extract from it: tables, columns, and rows.  To do this, we prepare the following structures: <br><blockquote>  <font color="#0000ff">typedef</font> <font color="#0000ff">struct</font> tagDBColumnsInfo <br>  <font color="#008000">{</font> <br>  std <font color="#008080">::</font> <font color="#007788">wstring</font> sColumnName <font color="#008080">;</font> <br>  std <font color="#008080">::</font> <font color="#007788">vector</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">wstring</font> <font color="#000080">&gt;</font> sColumnValues <font color="#008080">;</font> <br>  <font color="#008000">}</font> SDBColumnInfo <font color="#008080">;</font> <br><br>  <font color="#0000ff">typedef</font> <font color="#0000ff">struct</font> tagDBTableInfo <br>  <font color="#008000">{</font> <br>  std <font color="#008080">::</font> <font color="#007788">wstring</font> sTableName <font color="#008080">;</font> <br>  std <font color="#008080">::</font> <font color="#007788">vector</font> <font color="#000080">&lt;</font> SDBColumnInfo <font color="#000080">&gt;</font> sColumnInfo <font color="#008080">;</font> <br>  <font color="#008000">}</font> SDBTableInfo <font color="#008080">;</font> <br><br>  <font color="#0000ff">typedef</font> <font color="#0000ff">struct</font> tagDBTablesInfo <br>  <font color="#008000">{</font> <br>  std <font color="#008080">::</font> <font color="#007788">wstring</font> sDBName <font color="#008080">;</font> <br>  std <font color="#008080">::</font> <font color="#007788">vector</font> <font color="#000080">&lt;</font> SDBTableInfo <font color="#000080">&gt;</font> sTablesInfo <font color="#008080">;</font> <br>  <font color="#008000">}</font> SDBTablesInfo <font color="#008080">;</font> </blockquote><br>  First of all, you need to load the DLL itself, do it, as always, via :: LoadLibrary (...). <br>  We will load the function from ese.dll dynamically and we will need the following <a href="http://msdn.microsoft.com/en-us/library/gg294078(v%3DEXCHG.10).aspx">functions</a> : <br><ul><li>  JetInit </li><li>  JetCreateInstanceW </li><li>  JetBeginSessionW </li><li>  JetAttachDatabaseW </li><li>  JetOpenDatabaseW </li><li>  JetCloseDatabase </li><li>  JetDetachDatabaseW </li><li>  JetTerm </li><li>  JetSetSystemParameterW </li><li>  JetOpenTableW </li><li>  JetGetColumnInfoW </li><li>  JetRetrieveColumns </li><li>  JetMove </li><li>  JetGetTableColumnInfoW </li><li>  JetCloseTable </li><li>  JetGetSystemParameter </li></ul><br><h5>  Opening the base </h5><br>  After we have successfully loaded the functions we need, we begin to read the database directly.  According to MSDN, you must specify the <b>database page size</b> , through the setting of the parameter <b>JET_paramDatabasePageSize</b> (esent.h).  This is where the complexity appears.  it is impossible to find out this value having only an EDB file, and you need to specify exactly the otherwise the database will not open.  This can be done through eseutils (comes bundled with Exchange), but I went a little different way, and found out that this value is constant for identical versions of Exchange and is always a multiple of 4096. So, experimentally it turned out that for Exchange 2010 it is equal to <b>32768</b> . <br><br>  Ok, first of all we set the page size value: <br><blockquote>  JET_ERR jRes <font color="#000080">=</font> _JetSetSystemParameter <font color="#008000">(</font> <font color="#0000ff">NULL</font> , <font color="#0000ff">NULL</font> , JET_paramDatabasePageSize, <font color="#0000dd">32768</font> , <font color="#0000ff">NULL</font> <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br><br>  JET_ERR is just a long that contains an error code.  You can turn this code into a text description using the JetGetSystemParameter function (ala :: FormatMessage (...)): <br><blockquote> JetGetSystemParameter <font color="#008000">(</font> m_instance, m_sesid, JET_paramErrorToString, <br>  <font color="#0000ff">reinterpret_cast</font> <font color="#000080">&lt;</font> JET_API_PTR <font color="#000040">*</font> <font color="#000080">&gt;</font> <font color="#008000">(</font> <font color="#000040">&amp;</font> jeterror, cBuff, MAX_BUFFER_SIZE <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br>  For the convenience of parsing the error code, I use the following macro (m_cLog is my internal logging class): <br><blockquote>  <font color="#339900">#define WRITE_TO_LOG_AND_RETURN_IF_ERROR (jeterror) \</font> <font color="#339900"><br></font>  <font color="#339900">if (jeterror) {\</font> <font color="#339900"><br></font>  <font color="#339900">char cBuff [MAX_BUFFER_SIZE] = {0};</font>  <font color="#339900">\</font> <font color="#339900"><br></font>  <font color="#339900">if (m_instance) _JetGetSystemParameter (m_instance, m_sesid, \</font> <font color="#339900"><br></font>  <font color="#339900">JET_paramErrorToString, reinterpret_cast &lt;JET_API_PTR *&gt; (&amp; jeterror), cBuff, MAX_BUFFER_SIZE);</font>  <font color="#339900">\</font> <font color="#339900"><br></font>  <font color="#339900">m_cLog.write (m_sEDBPath, cBuff, jeterror, __FILE__, __LINE__);</font>  <font color="#339900">\</font> <font color="#339900"><br></font>  <font color="#339900">return jeterror;</font>  <font color="#339900">}</font> </blockquote><br><br>  Now you need to disable <a href="http://msdn.microsoft.com/en-us/library/gg269310(v%3Dexchg.10).aspx">callbacks</a> and Exchange-specific, because  we know nothing about them: <br><blockquote>  jRes <font color="#000080">=</font> _JetSetSystemParameter <font color="#008000">(</font> <font color="#0000ff">NULL</font> , <font color="#0000ff">NULL</font> , JET_paramDisableCallbacks, <font color="#0000ff">true</font> , <font color="#0000ff">NULL</font> <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br><br>  Next, create a new <a href="http://msdn.microsoft.com/en-us/library/gg294048(v%3Dexchg.10).aspx">instance</a> (JET_INSTANCE m_instance) to work with the database: <br><blockquote>  jRes <font color="#000080">=</font> _JetCreateInstance <font color="#008000">(</font> <font color="#000040">&amp;</font> m_instance, <font color="#0000ff">NULL</font> <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br><br>  We initialize the created instance to start working with the database: <br><blockquote>  jRes <font color="#000080">=</font> _JetInit <font color="#008000">(</font> <font color="#000040">&amp;</font> m_instance <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br><br>  Starting a new session (JET_SESID m_sesid): <br><blockquote>  jRes <font color="#000080">=</font> _JetBeginSession <font color="#008000">(</font> m_instance, <font color="#000040">&amp;</font> m_sesid, <font color="#0000ff">NULL</font> , <font color="#0000ff">NULL</font> <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br><br>  Connect our EDB file: <br><blockquote>  jRes <font color="#000080">=</font> _JetAttachDatabase <font color="#008000">(</font> m_sesid, L <font color="#FF0000">"demo.edb"</font> , JET_bitDbReadOnly <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br><br>  And open it: <br><blockquote>  jRes <font color="#000080">=</font> _JetOpenDatabase <font color="#008000">(</font> m_sesid, L <font color="#FF0000">"demo.edb"</font> , <font color="#0000ff">NULL</font> , <font color="#000040">&amp;</font> m_dbid, JET_bitDbReadOnly <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br><br>  Total, if all functions returned JET_errSuccess, then the base is open, which means you can start reading the contents. <br><br>  <i><b>Next is a bit of code.</b></i>  <i><b>I will bring it because</b></i>  <i><b>on this subject you will not find him in the afternoon with fire.</b></i> <br><br><h5>  We list the tables </h5><br>  For listing, we will write the following function: <br><blockquote>  JET_ERR CJetDBReaderCore <font color="#008080">::</font> <font color="#007788">EnumRootTables</font> <font color="#008000">(</font> SDBTablesInfo <font color="#000040">&amp;</font> sDBTablesInfo <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  sDBTablesInfo.  <font color="#007788">sDBName</font> <font color="#000080">=</font> m_sEDBPath <font color="#008080">;</font> <br>  JET_ERR jRes <font color="#000080">=</font> OpenTable <font color="#008000">(</font> ROOT_TABLE <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> jRes <font color="#000080">==</font> JET_errSuccess <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  JET_COLUMNBASE sNameInfo, <br>  sTypeInfo <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> <font color="#000040">!</font> ReadFromTable <font color="#008000">(</font> ROOT_TABLE, NAME_COLUMN, sNameInfo <font color="#008000">)</font> <font color="#000040">&amp;&amp;</font> <br>  <font color="#000040">!</font>  ReadFromTable <font color="#008000">(</font> ROOT_TABLE, TYPE_COLUMN, sTypeInfo <font color="#008000">)</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  JET_RETRIEVECOLUMN sJetRC <font color="#008000">[</font> <font color="#0000dd">2</font> <font color="#008000">]</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">columnid</font> <font color="#000080">=</font> sNameInfo.  <font color="#007788">columnid</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">cbData</font> <font color="#000080">=</font> sNameInfo.  <font color="#007788">cbMax</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">itagSequence</font> <font color="#000080">=</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">grbit</font> <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  CHAR szName <font color="#008000">[</font> MAX_BUFFER_SIZE <font color="#008000">]</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">pvData</font> <font color="#000080">=</font> szName <font color="#008080">;</font> <br><br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">1</font> <font color="#008000">]</font> .  <font color="#007788">columnid</font> <font color="#000080">=</font> sTypeInfo.  <font color="#007788">columnid</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">1</font> <font color="#008000">]</font> .  <font color="#007788">cbData</font> <font color="#000080">=</font> sTypeInfo.  <font color="#007788">cbMax</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">1</font> <font color="#008000">]</font> .  <font color="#007788">itagSequence</font> <font color="#000080">=</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">1</font> <font color="#008000">]</font> .  <font color="#007788">grbit</font> <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  WORD wType <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">1</font> <font color="#008000">]</font> .  <font color="#007788">pvData</font> <font color="#000080">=</font> <font color="#000040">&amp;</font> wType <font color="#008080">;</font> <br><br>  <font color="#0000ff">do</font> <br>  <font color="#008000">{</font> <br>  jRes <font color="#000080">=</font> GetColumns <font color="#008000">(</font> ROOT_TABLE, sJetRC, <font color="#0000dd">2</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> jRes <font color="#000040">!</font> <font color="#000080">=</font> JET_errSuccess <font color="#008000">)</font> <font color="#0000ff">return</font> jRes <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> wType <font color="#000080">==</font> <font color="#0000dd">1</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  szName <font color="#008000">[</font> sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">cbActual</font> <font color="#008000">]</font> <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br><br>  SDBTableInfo sTableInfo <font color="#008080">;</font> <br>  std <font color="#008080">::</font> <font color="#007788">string</font> tmp <font color="#008000">(</font> szName <font color="#008000">)</font> <font color="#008080">;</font> <br>  sTableInfo.  <font color="#007788">sTableName</font> .  <font color="#007788">assign</font> <font color="#008000">(</font> tmp. <font color="#007788">begin</font> <font color="#008000">(</font> <font color="#008000">)</font> , tmp. <font color="#007788">end</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br><br>  sDBTablesInfo.  <font color="#007788">sTablesInfo</font> .  <font color="#007788">push_back</font> <font color="#008000">(</font> sTableInfo <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#008000">}</font> <font color="#0000ff">while</font> <font color="#008000">(</font> <font color="#000040">!</font> TableEnd <font color="#008000">(</font> ROOT_TABLE <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  jRes <font color="#000080">=</font> CloseTable <font color="#008000">(</font> ROOT_TABLE <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">return</font> jRes <font color="#008080">;</font> <br>  <font color="#008000">}</font> </blockquote><br>  Where: <br><ul><li>  <b>ROOT_TABLE</b> - ‚ÄúMSysObjects‚Äù, let's call this table root, because  it contains a list of all other tables in the database. </li><li>  <b>NAME_COLUMN</b> - ‚ÄúName‚Äù, a column containing the names of all the tables. </li><li>  <b>TYPE_COLUMN</b> - ‚ÄúType‚Äù, a column containing the type of the table. </li></ul><br>  As can be seen in the code, first we open the root table, this is done through the function <a href="http://msdn.microsoft.com/en-us/library/gg294118(v%3DEXCHG.10).aspx">JetOpenTable</a> : <br><blockquote>  JET_ERR CJetDBReaderCore <font color="#008080">::</font> <font color="#007788">OpenTable</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">wstring</font> sTableName <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  std <font color="#008080">::</font> <font color="#007788">map</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">wstring</font> , JET_TABLEID <font color="#000080">&gt;</font> <font color="#008080">::</font> <font color="#007788">const_iterator</font> iter <font color="#000080">=</font> m_tables.  <font color="#007788">find</font> <font color="#008000">(</font> sTableName <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> iter <font color="#000080">==</font> m_tables. <font color="#007788">end</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  JET_TABLEID tableid <font color="#008000">(</font> <font color="#0000dd">0</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  JET_ERR jRes <font color="#000080">=</font> _JetOpenTable <font color="#008000">(</font> m_sesid, m_dbid, sTableName. <font color="#007788">C_str</font> <font color="#008000">(</font> <font color="#008000">)</font> , <font color="#0000ff">NULL</font> , <br>  <font color="#0000dd">0</font> , JET_bitTableReadOnly, <font color="#000040">&amp;</font> tableid <font color="#008000">)</font> <font color="#008080">;</font> <br>  WRITE_TO_LOG_AND_RETURN_IF_ERROR_2 <font color="#008000">(</font> jRes <font color="#008000">)</font> <br><br>  m_tables <font color="#008000">[</font> sTableName <font color="#008000">]</font> <font color="#000080">=</font> tableid <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">return</font> JET_errSuccess <font color="#008080">;</font> <br>  <font color="#008000">}</font> </blockquote><br>  Next, we get information about the columns inside the ReadFromTable, since  we need its Id to get the contents: <br><blockquote>  JET_ERR CJetDBReaderCore <font color="#008080">::</font> <font color="#007788">ReadFromTable</font> <font color="#008000">(</font> <br>  std <font color="#008080">::</font> <font color="#007788">wstring</font> sTableName, <br>  std <font color="#008080">::</font> <font color="#007788">wstring</font> sColumnName, <br>  JET_COLUMNBASE <font color="#000040">&amp;</font> sColumnBase <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  std <font color="#008080">::</font> <font color="#007788">map</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">wstring</font> , JET_TABLEID <font color="#000080">&gt;</font> <font color="#008080">::</font> <font color="#007788">const_iterator</font> iter <font color="#000080">=</font> m_tables.  <font color="#007788">find</font> <font color="#008000">(</font> sTableName <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> iter <font color="#000040">!</font> <font color="#000080">=</font> m_tables. <font color="#007788">end</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  JET_ERR jRes <font color="#000080">=</font> _JetGetColumnInfo <font color="#008000">(</font> m_sesid, m_dbid, sTableName. <font color="#007788">C_str</font> <font color="#008000">(</font> <font color="#008000">)</font> , <br>  sColumnName.  <font color="#007788">c_str</font> <font color="#008000">(</font> <font color="#008000">)</font> , <font color="#000040">&amp;</font> sColumnBase ( <font color="#0000dd">sizeof</font> <font color="#008000">(</font> JET_COLUMNBASE <font color="#008000">)</font> , JET_ColInfoBase <font color="#008000">)</font> <font color="#008080">;</font> <br>  WRITE_TO_LOG_AND_RETURN_IF_ERROR_2 <font color="#008000">(</font> jRes <font color="#008000">)</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">return</font> JET_errSuccess <font color="#008080">;</font> <br>  <font color="#008000">}</font> </blockquote><br>  Having an Id, we fill in the <a href="http://msdn.microsoft.com/en-us/library/gg269334(v%3Dexchg.10).aspx">JET_RETRIEVECOLUMN</a> structure, which we have <a href="http://msdn.microsoft.com/en-us/library/gg294135(v%3DEXCHG.10).aspx">JetRetrieveColumns</a> inside GetColumns, to get the name of the table: <br><blockquote>  JET_ERR CJetDBReaderCore <font color="#008080">::</font> <font color="#007788">GetColumns</font> <font color="#008000">(</font> <br>  std <font color="#008080">::</font> <font color="#007788">wstring</font> sTableName, <br>  JET_RETRIEVECOLUMN <font color="#000040">*</font> sJetRC, <br>  Int ncount <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  std <font color="#008080">::</font> <font color="#007788">map</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">wstring</font> , JET_TABLEID <font color="#000080">&gt;</font> <font color="#008080">::</font> <font color="#007788">const_iterator</font> iter <font color="#000080">=</font> m_tables.  <font color="#007788">find</font> <font color="#008000">(</font> sTableName <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> iter <font color="#000040">!</font> <font color="#000080">=</font> m_tables. <font color="#007788">end</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  JET_ERR jRes <font color="#000080">=</font> _JetRetrieveColumns <font color="#008000">(</font> m_sesid, iter <font color="#000040">-</font> <font color="#000080">&gt;</font> second, sJetRC, nCount <font color="#008000">)</font> <font color="#008080">;</font> <br>  WRITE_TO_LOG_AND_RETURN_IF_ERROR_2 <font color="#008000">(</font> jRes <font color="#008000">)</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">return</font> JET_errSuccess <font color="#008080">;</font> <br>  <font color="#008000">}</font> </blockquote><br>  All the list of tables received, go to get the contents of the columns.  For each table, we will receive a list of columns in it, and as we receive, we will store this information in our structures. <br><br><h5>  Enumerate columns </h5><br>  We write the following function: <br><blockquote>  JET_ERR CJetDBReaderCore <font color="#008080">::</font> <font color="#007788">EnumColumns</font> <font color="#008000">(</font> <br>  SDBTableInfo <font color="#000040">&amp;</font> sTableInfo, <br>  std <font color="#008080">::</font> <font color="#007788">list</font> <font color="#000080">&lt;</font> SColumnInfo <font color="#000080">&gt;</font> <font color="#000040">&amp;</font> sColumnsInfo <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> <font color="#000040">!</font> OpenTable <font color="#008000">(</font> sTableInfo. <font color="#007788">sTableName</font> <font color="#008000">)</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  JET_COLUMNLIST sColumnInfo <font color="#008080">;</font> <br>  GetTableColumnInfo <font color="#008000">(</font> sTableInfo. <font color="#007788">STableName</font> , <font color="#000040">&amp;</font> sColumnInfo <font color="#008000">)</font> <font color="#008080">;</font> <br>  MoveToFirst <font color="#008000">(</font> sTableInfo. <font color="#007788">STableName</font> <font color="#008000">)</font> <font color="#008080">;</font> <br><br>  <font color="#0000ff">char</font> szNameBuff <font color="#008000">[</font> MAX_BUFFER_SIZE <font color="#008000">]</font> <font color="#008080">;</font> <br>  <font color="#0000ff">do</font> <br>  <font color="#008000">{</font> <br>  SColumnInfo ci <font color="#008080">;</font> <br>  JET_RETRIEVECOLUMN sJetRC <font color="#008000">[</font> <font color="#0000dd">4</font> <font color="#008000">]</font> <font color="#008080">;</font> <br><br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">columnid</font> <font color="#000080">=</font> sColumnInfo.  <font color="#007788">columnidcolumnname</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">cbData</font> <font color="#000080">=</font> <font color="#0000dd">sizeof</font> <font color="#008000">(</font> szNameBuff <font color="#008000">)</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">itagSequence</font> <font color="#000080">=</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">grbit</font> <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> .  <font color="#007788">pvData</font> <font color="#000080">=</font> szNameBuff <font color="#008080">;</font> <br><br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">1</font> <font color="#008000">]</font> .  <font color="#007788">columnid</font> <font color="#000080">=</font> sColumnInfo.  <font color="#007788">columnidcolumnid</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">1</font> <font color="#008000">]</font> .  <font color="#007788">cbData</font> <font color="#000080">=</font> <font color="#0000dd">sizeof</font> <font color="#008000">(</font> DWORD <font color="#008000">)</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">1</font> <font color="#008000">]</font> .  <font color="#007788">itagSequence</font> <font color="#000080">=</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">1</font> <font color="#008000">]</font> .  <font color="#007788">grbit</font> <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">1</font> <font color="#008000">]</font> .  <font color="#007788">pvData</font> <font color="#000080">=</font> <font color="#000040">&amp;</font> ci.  <font color="#007788">dwId</font> <font color="#008080">;</font> <br><br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">2</font> <font color="#008000">]</font> .  <font color="#007788">columnid</font> <font color="#000080">=</font> sColumnInfo.  <font color="#007788">columnidcoltyp</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">2</font> <font color="#008000">]</font> .  <font color="#007788">cbData</font> <font color="#000080">=</font> <font color="#0000dd">sizeof</font> <font color="#008000">(</font> DWORD <font color="#008000">)</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">2</font> <font color="#008000">]</font> .  <font color="#007788">itagSequence</font> <font color="#000080">=</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">2</font> <font color="#008000">]</font> .  <font color="#007788">grbit</font> <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">2</font> <font color="#008000">]</font> .  <font color="#007788">pvData</font> <font color="#000080">=</font> <font color="#000040">&amp;</font> ci.  <font color="#007788">dwType</font> <font color="#008080">;</font> <br><br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">3</font> <font color="#008000">]</font> .  <font color="#007788">columnid</font> <font color="#000080">=</font> sColumnInfo.  <font color="#007788">columnidcbMax</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">3</font> <font color="#008000">]</font> .  <font color="#007788">cbData</font> <font color="#000080">=</font> <font color="#0000dd">sizeof</font> <font color="#008000">(</font> DWORD <font color="#008000">)</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">3</font> <font color="#008000">]</font> .  <font color="#007788">itagSequence</font> <font color="#000080">=</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">3</font> <font color="#008000">]</font> .  <font color="#007788">grbit</font> <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  sJetRC <font color="#008000">[</font> <font color="#0000dd">3</font> <font color="#008000">]</font> .  <font color="#007788">pvData</font> <font color="#000080">=</font> <font color="#000040">&amp;</font> ci.  <font color="#007788">dwMaxSize</font> <font color="#008080">;</font> <br><br>  GetColumns <font color="#008000">(</font> sTableInfo. <font color="#007788">STableName</font> , sJetRC, <font color="#0000dd">4</font> <font color="#008000">)</font> <font color="#008080">;</font> <br><br>  ci.  <font color="#007788">sName</font> .  <font color="#007788">assign</font> <font color="#008000">(</font> <font color="#0000ff">reinterpret_cast</font> <font color="#000080">&lt;</font> <font color="#0000ff">wchar_t</font> <font color="#000040">*</font> <font color="#000080">&gt;</font> <font color="#008000">(</font> sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> . <font color="#007788">pvData</font> <font color="#008000">)</font> , sJetRC <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> . <font color="#007788">cbActual</font> <font color="#000040">/</font> <font color="#0000dd">2</font> <font color="#008000">)</font> <font color="#008080">;</font> <br><br>  SDBColumnInfo sDBColumnInfo <font color="#008080">;</font> <br>  sDBColumnInfo.  <font color="#007788">sColumnName</font> <font color="#000080">=</font> ci.  <font color="#007788">sName</font> <font color="#008080">;</font> <br><br>  sColumnsInfo.  <font color="#007788">push_back</font> <font color="#008000">(</font> ci <font color="#008000">)</font> <font color="#008080">;</font> <br>  sTableInfo.  <font color="#007788">sColumnInfo</font> .  <font color="#007788">push_back</font> <font color="#008000">(</font> sDBColumnInfo <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">while</font> <font color="#008000">(</font> <font color="#000040">!</font> TableEnd <font color="#008000">(</font> sTableInfo. <font color="#007788">sTableName</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008080">;</font> <br><br>  CloseTable <font color="#008000">(</font> sTableInfo. <font color="#007788">STableName</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">return</font> JET_errSuccess <font color="#008080">;</font> <br>  <font color="#008000">}</font> </blockquote><br>  Here we again open the table, but not the root, but the one that we found in the previous step. <br><br>  Next you need to get information about all the columns, for this we get a pointer to the first one and go to the last one going through one after the other: <br><blockquote>  JET_ERR CJetDBReaderCore <font color="#008080">::</font> <font color="#007788">MoveToFirst</font> <font color="#008000">(</font> std <font color="#008080">::</font> <font color="#007788">wstring</font> sTableName <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  std <font color="#008080">::</font> <font color="#007788">map</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">wstring</font> , JET_TABLEID <font color="#000080">&gt;</font> <font color="#008080">::</font> <font color="#007788">const_iterator</font> iter <font color="#000080">=</font> m_tables.  <font color="#007788">find</font> <font color="#008000">(</font> sTableName <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> iter <font color="#000040">!</font> <font color="#000080">=</font> m_tables. <font color="#007788">end</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#666666">// if already open</font> <br>  <font color="#008000">{</font> <br>  JET_ERR jRes <font color="#000080">=</font> _JetMove <font color="#008000">(</font> m_sesid, iter <font color="#000040">-</font> <font color="#000080">&gt;</font> second, JET_MoveFirst, <font color="#0000dd">0</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  BOOL bIsEmpty <font color="#000080">=</font> <font color="#008000">(</font> jRes <font color="#000080">==</font> JET_errNoCurrentRecord <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> bIsEmpty <font color="#008000">)</font> <font color="#0000ff">return</font> jRes <font color="#008080">;</font>  <font color="#666666">// Ingnore if empty</font> <br>  WRITE_TO_LOG_AND_RETURN_IF_ERROR_2 <font color="#008000">(</font> jRes <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">return</font> NO_ERROR <font color="#008080">;</font> <br>  <font color="#008000">}</font> </blockquote><br><blockquote>  JET_ERR CJetDBReaderCore <font color="#008080">::</font> <font color="#007788">GetTableColumnInfo</font> <font color="#008000">(</font> <br>  std <font color="#008080">::</font> <font color="#007788">wstring</font> sTableName, <br>  JET_COLUMNLIST <font color="#000040">*</font> pCl, <br>  BOOL bReplaceOld <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  JET_ERR jRes <font color="#000080">=</font> JET_errSuccess <font color="#008080">;</font> <br>  std <font color="#008080">::</font> <font color="#007788">map</font> <font color="#000080">&lt;</font> std <font color="#008080">::</font> <font color="#007788">wstring</font> , JET_TABLEID <font color="#000080">&gt;</font> <font color="#008080">::</font> <font color="#007788">iterator</font> iter <font color="#000080">=</font> m_tables.  <font color="#007788">find</font> <font color="#008000">(</font> sTableName <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> iter <font color="#000040">!</font> <font color="#000080">=</font> m_tables. <font color="#007788">end</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  jRes <font color="#000080">=</font> _JetGetTableColumnInfo <font color="#008000">(</font> m_sesid, iter <font color="#000040">-</font> <font color="#000080">&gt;</font> second, <font color="#0000ff">NULL</font> , pCl, <br>  <font color="#0000dd">sizeof</font> <font color="#008000">(</font> JET_COLUMNLIST <font color="#008000">)</font> , JET_ColInfoList <font color="#008000">)</font> <font color="#008080">;</font> <br>  WRITE_TO_LOG_AND_RETURN_IF_ERROR_2 <font color="#008000">(</font> jRes <font color="#008000">)</font> <br><br>  <font color="#0000ff">if</font> <font color="#008000">(</font> bReplaceOld <font color="#008000">)</font> <font color="#666666">// if you need last time open table</font> <br>  <font color="#008000">{</font> <br>  jRes <font color="#000080">=</font> CloseTable <font color="#008000">(</font> sTableName <font color="#008000">)</font> <font color="#008080">;</font> <br>  m_tables <font color="#008000">[</font> sTableName <font color="#008000">]</font> <font color="#000080">=</font> pCl <font color="#000040">-</font> <font color="#000080">&gt;</font> tableid <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">else</font> <br>  <font color="#008000">{</font> <br>  jRes <font color="#000080">=</font> _JetCloseTable <font color="#008000">(</font> m_sesid, pCl <font color="#000040">-</font> <font color="#000080">&gt;</font> tableid <font color="#008000">)</font> <font color="#008080">;</font> <br>  WRITE_TO_LOG_AND_RETURN_IF_ERROR_2 <font color="#008000">(</font> jRes <font color="#008000">)</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">return</font> jRes <font color="#008080">;</font> <br>  <font color="#008000">}</font> </blockquote><br>  <b><i>Sorry, the first version of the post was cut off, and I did not have time to respond, apparently there is some limit on the size of the article, so it will be divided into two parts.</i></b> <b><i><br></i></b>  <b><i>To <a href="http://habrahabr.ru/blogs/system_programming/116511/">be</a> continued ...</i></b> <br><br>  In the next part, we finish reading the base, draw conclusions, and look at an example of data that can be ‚Äúripped out‚Äù from the base. <br><br>  PS This code is an <b>adapted</b> and reduced version for the post.  Therefore, there are some flaws in the code, or rather gags in the field of reduced functionality.  Please do not pay attention to them this is not production, but I wanted to show <b>working</b> examples.  The code is fully working and written so that it can be placed on the Internet and at the same time not ‚Äúeat‚Äù all the space on the page.  Thank you for understanding. <br><br>  PPS I understand that in view of the specificity of this information is unlikely to be useful for a wide range of people, but if it helps, even to one person, I will be glad, and the time spent on this post will pay off. <br><br><h5>  Related Links </h5><ol><li>  <a href="http://msdn.microsoft.com/en-us/library/gg269259(v%3DEXCHG.10).aspx">Extensible Storage Engine on MSDN</a> </li><li>  <a href="">Article</a> in Russian (almost the only <a href="">article</a> in the Russian Internet about the use of ESE API) </li><li>  <a href="http://www.news2news.com/vfp/%3Fgroup%3D119%26%3D0">Examples of</a> using ESE features </li></ol></div><p>Source: <a href="https://habr.com/ru/post/116308/">https://habr.com/ru/post/116308/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116298/index.html">We organize view models in ASP.NET MVC</a></li>
<li><a href="../116299/index.html">Google Launches AdWords Video Player</a></li>
<li><a href="../116300/index.html">Where do NaNs come from?</a></li>
<li><a href="../116301/index.html">Interpreter from gateways</a></li>
<li><a href="../116305/index.html">As I watched Formula 1 on the BBC live via the Internet</a></li>
<li><a href="../116309/index.html">Feature of work of class AsyncTask</a></li>
<li><a href="../116311/index.html">Watching video without leaving the site</a></li>
<li><a href="../116313/index.html">Yandex with taste of Intel</a></li>
<li><a href="../116314/index.html">Unladen Swallow is everything ...</a></li>
<li><a href="../116316/index.html">Greetings GCC 4.6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>