<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 52-53: Juniper backdoor with a thick layer of cryptography, vintage Java, gopo-bug bounty</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At that moment, when the tree is already standing, but the salads have not yet been cut, it's time for the last time this year to talk about security ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 52-53: Juniper backdoor with a thick layer of cryptography, vintage Java, gopo-bug bounty</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/242/dbe/a3c/242dbea3cc8d4c17acc470d323defcbb.jpg" align="right">  At that moment, when the tree is already standing, but the salads have not yet been cut, it's time for the last time this year to talk about security news.  Last week, I <a href="http://habrahabr.ru/company/kaspersky/blog/273919/">reported</a> on the ‚Äúnon-standard‚Äù best news of the year, and in general, nothing much happened during the remaining time.  Although no, there is one news that is worthy of a separate story.  The two backdoors found on December 17th in the Juniper network device software could fill up a long but unreleased list of bugs, exploits, and incorrect configurations in routers and home routers.  But later it turned out that there are a lot of nuances in this story, it affects not only the topic of secure coding, but also encryption, and even hints of the involvement of special services. <br><br>  In general, the interesting was the end of the year.  In addition to Juniper, two more popular news more go to the topic of near-security policy.  Traditional rules: Every week, the editors of the news site <a href="https://threatpost.ru/">Threatpost</a> selects the three most significant news, to which I add an extended and merciless comment.  All episodes of the series can be found <a href="http://habrahabr.ru/search/%3Ftarget_type%3Dposts%26q%3D%255Bklsw%255D%2520%26order_by%3Ddate">by tag</a> .  The first episode of the new year will be released on the screens of the country on January 8! <br><a name="habracut"></a><br>  <b>Two backdoors were discovered in Juniper devices: non-trivial and completely non-trivial</b> <br>  <a href="https://threatpost.ru/juniper-finds-backdoor-that-decrypts-vpn-traffic/13901/">News</a>  Shocking <a href="https://threatpost.ru/juniper-backdoor-password-goes-public/13940/">details</a> .  The newly discovered <a href="https://threatpost.ru/juniper-backdoor-picture-getting-clearer/13976/">circumstances</a> .  <a href="http://kb.juniper.net/InfoCenter/index%3Fpage%3Dcontent%26id%3DJSA10713%26actp%3Dsearch">An article</a> in the Knowledge Base Juniper. <br><br>  On December 17, a message appears on Juniper's website about the successful closure of two serious vulnerabilities in the ScreenOS operating system - a proprietary OS that runs the network firewalls of the enterprise class <a href="http://www.juniper.net/us/en/products-services/security/netscreen/">Netscreen</a> .  These are such high-performance hardware that provides traffic filtering, VPN, protection from DDoS on channels with a capacity of 10 gigabits per second and higher.  Both vulnerabilities are very dangerous, but each individually threatens the security of transmitted data in its own way.  Therefore, they can be divided into "simply non-trivial" and "completely non-trivial." 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>Just a nontrivial vulnerability.</i> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/5ef/436/264/5ef436264d394ccd91fa1eb8413e9291.png"></div><br>  <i>Healthy person log and smoker log</i> <br><br>  Find ten differences.  The only difference between a normal login and an unauthorized username is that in the second case, an entry appears on the login on behalf of the user system.  Not the best indicator of hacking, especially as the Juniper correctly notes, the attacker will rub these two lines first.  That is, we are talking about a tab in the code that allows you to log in to a user that the device administrator did not create - this is a fairly typical situation.  In fact, everything is somewhat more complicated, or easier - this is how to look.  Actually, there were no details in the Juniper message: ‚Äúwe found two holes, here are the patches, thank you‚Äù.  Given the risk of vulnerabilities, they cannot be blamed for trying to hide some information.  The problem is that comparing the code of the two versions ‚Äúbefore and after the patch‚Äù and finding out exactly how the backdoor works is not a particular problem. <br><br>  This analysis was done by many, including the company Rapid7.  <a href="https://community.rapid7.com/community/infosec/blog/2015/12/20/cve-2015-7755-juniper-screenos-authentication-backdoor">It turned out</a> that we are not talking about a secret pair ‚Äúuser-password-password‚Äù, but only about a password, and it is coded so that when viewing the source code, it looks either as a comment, or as a debugging code.  In general, if a vulnerable network screen is visible ‚Äúoutside‚Äù, then connecting to it with full access rights is easy.  The data from the specialized search engine Shodan are cited: at the time of the publication of the study, he saw 26,000 NetScreen devices (but not necessarily vulnerable) to which you can connect via SSH from the outside.  The backdoor is available presumably from 2013 - it was then that the version in which this tab appeared appeared. <br><br>  <i>Totally nontrivial vulnerability</i> <br>  The second vulnerability is present in ScreenOS a little longer - since 2012, and it allows you to decrypt VPN traffic.  What this means for companies using NetScreen complexes for secure communication between units across open networks, I think it is not necessary to explain.  As rightly noted in the initial communication of the company, it is not possible to determine whether this vulnerability was exploited.  How did it happen?  To understand, it is necessary to plunge into a jungle of questions of enciphering again.  A normal person in these wilds looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a0c/b82/9f0/a0cb829f074145ffaede74f4080cf3d1.jpg"></div><br><br>  But I still try, relying on the <a href="http://blog.cryptographyengineering.com/2015/12/on-juniper-backdoor.html">post of</a> Matthew Green, the famous cryptographer.  The article begins positively: ‚Äúwe will not go into much detail‚Äù.  Yeah, we will not.  The bottom line is that ScreenOS uses the <a href="https://en.wikipedia.org/wiki/Dual_EC_DRBG">Dual_EC_DRBG</a> pseudo-random generation algorithm.  The fact that this algorithm is unreliable with a certain implementation, I <a href="http://habrahabr.ru/company/kaspersky/blog/269815/">wrote</a> earlier in the story about the communique (ui!) NSA regarding encryption algorithms that are resistant to quantum computing.  I will quote: <br><br>  <i>‚ÄúThere is a backdoor in it or not, it is not fully known, but in the early 2000s the NSA actively campaigned for the standardization of the algorithm, in 2007 there were suspicions of a backdoor, and in 2013 Snowden‚Äôs leaks confirmed that some program the introduction of bookmarks, or by propaganda of deliberately weakened algorithms, existed.</i>  <i>Whether this applied to a specific code is not clear, but the sediment remained. ‚Äù</i> <br><br>  In response to many years already expressed doubts about the robustness of the algorithm, Juniper once issued a <a href="https://kb.juniper.net/InfoCenter/index%3Fpage%3Dcontent%26id%3DKB28205%26pmv%3Dprint%26actp%3DLIST">statement</a> : even so, ScreenOS is not affected, because it uses its own implementation of the algorithm, in which the Dual_EC_DRBG output is transmitted for further processing to another algorithm - FIPS / ANSI X.9.31 PRNG.  According to Matthew Green, such a pipeline really removes all questions about vulnerability, but with one condition: if the attacker does not have access to the original sequence of numbers generated using Dual_EC_DRBG.  And the whole sequence is not required - just the first 30 bytes or so.  So, the information obtained through the analysis and reverse engineering of patches indicates that this is exactly the (raw output of the first 32 bytes of the algorithm)!  Having received 32 bytes of output, it becomes possible to predict what will happen next with this data, and finally to get the key to encrypted traffic. <br><br>  Matthew Green does not draw conclusions about the ‚Äúcustomer‚Äù of backdoors, but once again raises the topic of the danger of intentionally weakening cryptography.  The one who leaves (introduces without the vendor‚Äôs knowledge, or with his help, it doesn‚Äôt matter) a loophole only for himself cannot guarantee that others cannot use it.  I will add that in the documents received from Edward Snowden, the Dual_EC_DRBG algorithm, and specifically the Juniper devices with some kind of backdoor, are mentioned more than once. <br><br>  So it goes. <br><br>  <b>Oracle agreed with the US Trade Commission that Java‚Äôs security is so-so</b> <br>  <a href="https://threatpost.ru/oracle-settles-with-ftc-over-deceptive-java-security-updates/13966/">News</a> <br><br>  Oracle has entered into a settlement agreement with the US Federal Trade Commission on the Java platform security dispute.  It would seem, where is Java, and where is FTC, and why does the local Ministry of Trade worry about software vulnerabilities?  Although yes, there is something to worry about, this is the traditional selection of news for the year: <a href="https://threatpost.ru/oracle-patches-java-zero-day/9945/">one</a> , <a href="https://threatpost.ru/obnaruzhen-eksplojt-nulevogo-dnya-dlya-java/9818/">two</a> , <a href="https://threatpost.ru/custom-google-app-engine-tweak-still-leads-to-java-sandbox-escapes/12934/">three</a> , and so on.  Java regularly competes with Adobe Flash for the title of the software itself being exploited by hackers, and recently Flash wins (that is, loses) - it is most often attacked.  According to our <a href="https://securelist.ru/analysis/ksb/27543/kaspersky-security-bulletin-2015-osnovnaya-statistika-za-2015-god/">statistics</a> , in 2015, Java vulnerabilities were used in 13% of attacks using exploits, although a year earlier there were 45%.  Virtually all Java exploit packs are no longer used at all.  In general, everything seems to be not so bad? <br><br>  Well, the news is not about it :) The FTC is still a state structure, and it is ... not quickly responding to the rapidly changing landscape of threats.  The trial dealt with older versions of Java, and Oracle statements: well, when the company calls on users to be updated in order to protect themselves.  At least until August 2014, the Java update worked in such a way that it didn‚Äôt completely ‚Äúsecure‚Äù users: in some cases, old versions of Java remained somewhere in the system‚Äôs depths and could still be attacked.  The problem was solved only by completely removing the old version before installing the new one.  Many people know how ‚Äúconvenient‚Äù and ‚Äútransparent‚Äù updates have been implemented until recently.  In general, we agreed that the company will notify users "more better." <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fab/325/7f6/fab3257f617441368b19fad66a08cc53.png"></div><br><br>  An important nuance of the news is the sending of some internal Oracle correspondence, analyzed during the investigation.  From it became known that the problems with the updates were not a secret for the employees, but the company could not do something useful for them for a long time.  In this connection, I cannot help reminding about the August PR failure of Oracle, when CSO recommended them to independent researchers and customers <a href="http://habrahabr.ru/company/kaspersky/blog/264727/">to keep their disassembler with them</a> - they say that the vendor will cope with security audit. <br><br>  <b>Facebook accuses researcher of immoral bag-hunting</b> <br>  <a href="https://threatpost.ru/facebook-researcher-spar-over-instagram-vulnerabilities/13920/">News</a>  <a href="http://exfiltrated.com/research-Instagram-RCE.php">Researcher's</a> blog. <br><br>  Nothing foreshadowed trouble when security expert Wesley Weinberg posted to Facebook information about vulnerabilities in the Instagram server infrastructure.  They responded to his message, thanked him and said that he was qualified to receive $ 2500 under the bug bounty program.  Further events evolved outside the box: Weinberg continued research, managed to break almost the entire Instagram - in the sense of getting to the servers with the source code and user data - and Facebook accused him of unethical behavior. <br><br>  The testimony of the participants contradict each other.  According to Weinberg, he dug up a whole series of vulnerabilities, thanks to which he was able to get access to Instagram virtual servers in Amazon S3.  According <a href="https://www.facebook.com/notes/alex-stamos/bug-bounty-ethics/10153799951452929">to</a> Alex Stamos, CSO Facebook, the entry point was one, thanks to Weinberg for the report, but it was unethical to go on: it‚Äôs impossible to break down servers and steal employee and user data, and call it security.  Outraged Stamos called Weinberg's employer, Synack, and thus added new players and dramas to the story.  Weinberg himself in response hinted that Facebook was trying to delay the publication of information about vulnerabilities, which is the sacred right of the researcher. <br><br>  In general, it is difficult to make out who is right in this story and who is not.  It is only clear that there were no specific rules for interaction between researchers and vendors, let alone such non-algorithmic tasks as ethical code.  And it would be nice to come up with these rules.  First, it will benefit the industry as a whole - after all, Instagram eventually closed the hole before the attackers could take advantage of it.  Secondly, it is better for the industry to come up with these rules on its own, while professional lawmakers have not taken it up for them - in this situation, you understand, anything can happen. <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right">  <b>Antiquities:</b> <br>  "Stone-a, -b, -c, -d" <br><br>  When booting from an infected floppy disk with a probability of 1/8, the message ‚ÄúYour PC is now Stoned!‚Äù Appears on the screen.  In addition to this, contain the string "LEGALISE MARIJUANA!".  The Stone-c virus destroys the partition table (Disk Partition Table) when infecting the MBR of the hard drive, after which the computer can only be booted from a floppy disk.  "Stone-d" October 1 destroys information on the hard drive. <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 97.</i> <br><br>  <i>Disclaimer: This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/274211/">https://habr.com/ru/post/274211/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274197/index.html">Computational chemistry is a modern way to obtain the necessary chemical compounds from IBM</a></li>
<li><a href="../274203/index.html">The quickest start with Angular 2 (beta) and Dart</a></li>
<li><a href="../274205/index.html">Data Festival at the Moscow Museum, as it were</a></li>
<li><a href="../274207/index.html">Manage Vscale Servers via Ansible</a></li>
<li><a href="../274209/index.html">Domain sharding: Ruby on Rails implementation and results</a></li>
<li><a href="../274213/index.html">HIVE: the future of cloud PBX or where are we going next year</a></li>
<li><a href="../274215/index.html">VKontakte not only does not pay users for the found vulnerabilities, but also does not consider them</a></li>
<li><a href="../274219/index.html">Why Habrahabr turned into a tape of corporate blog posts</a></li>
<li><a href="../274221/index.html">WEB-Olivier: a small mix of the dangers and mistakes of the developer</a></li>
<li><a href="../274225/index.html">Framework for procedural macros in Rust</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>