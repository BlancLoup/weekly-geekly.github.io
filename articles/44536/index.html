<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Backup to Time Machine using a home server for Ubuntu as iSCSI target</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good evening, dear habroskoobschestvo! 

 For a long time, due to the lack of TimeCapsule or an external USB hard drive, I used Time Machine to backup...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Backup to Time Machine using a home server for Ubuntu as iSCSI target</h1><div class="post__text post__text-html js-mediator-article">  Good evening, dear habroskoobschestvo! <br><br>  For a long time, due to the lack of TimeCapsule or an external USB hard drive, I used Time Machine to backup to the home server using the SMB protocol (for details on how to do this, <a href="http://blog.smartweb.com.ua/2008/05/mac-os-1052-leopard.html">for example</a> , see <a href="http://blog.smartweb.com.ua/2008/05/mac-os-1052-leopard.html">here</a> ) However, it is not for nothing that in my opinion this method is not officially supported by Apple, the method is bad unfit  Twice the image for backups turned out to be corrupted for no apparent reason, but the data was saved, for the third time the cup of my patience overflowed and I began to look for an alternative option.  I present my solution to the backup problem to the community by providing access to a separate home server disk using the iSCSI protocol.  What it is, what it is for, as well as advantages and disadvantages compared to SMB / nfs can be found, for example, <a href="http://ru.wikipedia.org/wiki/ISCSI">here</a> . <br><br>  So, given: <br>  1. Server running Ubuntu 9.04 server (made dist-upgrade from 8.10).  Acts as an iSCSI target.  For backup we will use a separate hard drive. <br>  2. iMac running MacOS 10.5.7 Acting as iSCSI-initiator <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Server Tuning. <br><br>  1. We put the iscsitarget daemon.  In the console, we write "sudo apt-get install iscsitarget" <br>  2. Edit the file "/ etc / default / iscsitarget", the only line in it should be "ISCSITARGET_ENABLE = true". <br>  3. Edit the file "/etc/ietd.conf", add 2 lines, "Target iqn.2001-04.com.example: storage.disk2.sys1.xyz" - the name of our new iSCSI target and "Lun 0 Path = / dev / sda, Type = fileio "where" / dev / sda "is the address of the disk block device. <br>  <b>NB</b> <i>Also in this file you can configure many other useful things, such as authorization.</i> <br>  4. Restart the daemon "/etc/init.d/iscsitarget restart". <br><br>  Client setup <br><br>  1. We install a free iSCSI-initiator globalSAN iSCSI Initiator for OS X, download it <a href="http://www.studionetworksolutions.com/products/product_detail.php%3Fpi%3D11">from here</a> .  The installation process will require a reboot. <br>  2. Open System Preferences-&gt; GlobalSAN iSCSI. <br>  3. On the Portals tab, add the server address. <br>  4. If everything went well then on the Targets tab you will see our newly created target.  Put a tick in the positions Persistent and Connected. <br>  5. A window should immediately appear with a warning that the disk is not initialized and a proposal to do so immediately.  The proposal should agree.  If no warning appears, open Disk Utility with your hands. <br>  6. Using Disk Utility, format the new disk in the Mac OS Extended (Journaled) file system. <br>  7. Open the Time Machine settings and specify a newly-formatted iSCSI disk as a backup disk. <br>  8. Turn on Time Machine. <br><br>  Enjoying perfectly working backups! <br><br>  PS I apologize for some confusion, wrote in a hurry.  I will be glad to answer questions in comments if any arise. <br><br><br>  UPD: At the request of readers transferred to the blog "Mac OS X" <br><br>  UPD: According to the respected user <a href="http://geektimes.ru/users/pingme/" class="user_link">PingMe,</a> to restore the user when you reinstall the system, you must do the following: "Install the OS, create the user after installation, log into the system, climb into the Utilities -&gt; Migration, and from there you already take away the desired user." </div><p>Source: <a href="https://habr.com/ru/post/44536/">https://habr.com/ru/post/44536/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445350/index.html">Sonata - SIP provisioning server</a></li>
<li><a href="../445352/index.html">Spark Structured Streaming Applications on Kubernetes. Experience FASTEN RUS</a></li>
<li><a href="../445354/index.html">Finding objects in the pictures</a></li>
<li><a href="../445356/index.html">Overview of the Mobile section on the DUMP-2019: maximum application and useful in everyday work</a></li>
<li><a href="../445358/index.html">Organization of the event system in Unity - through the eyes of game designer</a></li>
<li><a href="../445360/index.html">5 typical tasks for interviews on JavaScript: analysis and solutions</a></li>
<li><a href="../445362/index.html">The book "Distributed Systems. Design Patterns ¬ª</a></li>
<li><a href="../445366/index.html">How to speed up encryption in accordance with GOST 28147-89 on a Baikal-T1 processor due to a SIMD unit</a></li>
<li><a href="../445368/index.html">Load testing games with a couple of hundreds of thousands of virtual users</a></li>
<li><a href="../445370/index.html">TSDB Analysis in Prometheus 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>