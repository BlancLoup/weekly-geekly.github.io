<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dirty tricks video game developers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Previous parts: one , two , three . 

 Thank you for the game! 
 In the first part of Wing Commander, when we got out of the game, we received an exce...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dirty tricks video game developers</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/g1/3f/zl/g13fzlhsdxdjdd3kqtncp-cshe4.png"></div><br>  Previous parts: <a href="https://habr.com/post/328552/">one</a> , <a href="https://habr.com/post/343516/">two</a> , <a href="https://habr.com/post/344822/">three</a> . <br><br><h2>  Thank you for the game! </h2><br>  In the first part of <em>Wing Commander,</em> when we got out of the game, we received an exception from our EMM386 memory manager.  The screen was cleared and a single line was displayed on it, something like ‚ÄúError of EMM386 memory manager.  Blah blah blah". <br><br>  We needed to release the game as quickly as possible, so I edited the memory manager‚Äôs error in the hex editor to make it look like ‚ÄúThank you for playing <em>Wing Commander</em> ‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <em>- Ken Demarest</em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4_/7i/e5/4_7ie5aernweybt6eiampt-xxfe.png"></div><a name="habracut"></a><br><h2>  100% pure fruit juices </h2><br>  When I first started working in the gaming industry, most of the time I worked in various small, sparingly funded startups.  Here is a horror story from those times when men were men and used DirectX 7. I worked for a company that the publisher forced to use a specific 3D engine.  I will not call him, but the publisher claimed that he had bought a bunch of licenses for him in a major licensing deal, so he insisted on using it. <br><br>  Let's face it - the engine did not work, and most of the time working at the company I was engaged in teaching the 3D engine how to do obvious things correctly, such as implementing a single pass overlay of lightmaps from several textures. <br><br>  One of the most interesting things that didn't work was the BSP compiler.  Level designers created the geometry of the levels with the correct visibility, after which minor changes in the geometry violated the areas of visibility in a completely different part of the map.  I still don‚Äôt know why this happened, but I suppose that the BSP engine compiler added brushes to the BSP tree in random order and certain combinations ... just broke everything in an arbitrary way. <br><br>  At that time I did not hear about the randomized algorithm, but nevertheless I invented it - we added a preprocessing stage to the BSP compiler, which mixed the order of the brushes before transferring them to the BSP compiler.  If the level geometry broke in the BSP compiler, we simply tried to shuffle the brushes with other random numbers until we found a working combination and stuck to it until the BSP compiler broke again. <br><br>  The game itself was a disaster - and the engine, and the game fell into the comic Penny Arcade, in which <a href="https://www.penny-arcade.com/comic/2002/02/11">Fruitf * cker 2000</a> first appeared.  This remains an important part of my career. <br><br>  <em>- Nicholas Vining</em> <br><br><h2>  Flash forward </h2><br>  I worked on <em>NBA JAM TE</em> for the Sega Genesis, which used a flash chip to save game data.  The game was tested for several months, and everything was ready for release, so the publisher ordered 250,000 copies of the cartridges.  But it soon became obvious that no one had dropped flash chips on test cartridges for many months in order to check the correctness of the flash memory initialization procedures.  And no one ordered the cartridges for testing. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a3/3c9/975/8a33c99750e3d796c5db4e2525d83ce0.png" alt="image"></div><br>  Only after ordering all the cartridges, we found that the flash initialization code had died, and the cartridges could not save the games correctly!  The whole studio went mad, trying to figure out how to release 250 thousand broken cartridges.  We tried to implement the recommendations of the manufacturers, adding additional resistors and other hacks, but nothing helped. <br><br>  When everything seemed lost, someone found out that if you play games in a very strange and well-defined order, then the flash memory seems to start working.  Therefore, a leaflet with a description of how to use this feature has been attached to each box with a cartridge. <br><br>  <em>- Chris Kirby</em> <br><br><h2>  Smoke </h2><br>  My favorite "last minute hack" was used in the four-player mode of the game <em>Nitrobike</em> for PS2.  As usual, level designers and artists did their work, not realizing in the least how real it is in the real world, and, as usual, they completely left me to complete the game. <br><br>  After a lot of disputes and collisions, I made them simplify the level graphics, create visually hidden areas and remove unnecessary dynamic objects.  But this could not save one particular level with cinematic themes.  The design of the level itself resisted the concealment of excess - it consisted of two huge rooms (according to the plot - recording pavilions), which did not overlap and were connected by two open doors. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c5/f16/1d0/1c5f161d0e1956ac1e060c42b74d742a.jpg" alt="image"></div><br>  One door was in the middle of the wall.  There was no way to build overlapping polygons to block one room so that it could not be seen from another, as there were no ways to remove any level graphics without destroying its style.  I needed to find a way to substitute one large polygon overlying the middle wall onto the wall.  And then it dawned on me - the ‚Äúwall of smoke‚Äù from particles, closing the middle door, will be well combined with the level in film themes and will completely solve my problem. <br><br>  A wall of smoke can be passed through, but not seen through it, and it will hide the existence of my overlapping polygon!  I had the opportunity to take one artist myself to create such an emitter and one level designer in order to position the emitters on both sides of the door. <br><br>  Finally, in the middle, I inserted one very large overlapping polygon.  It looked good and fixed the last problem with speed levels. <br><br>  <em>- Stephen Boswell II</em> <br><br><h2>  ... maybe here? </h2><br>  I have been writing games for more than 20 years, and recently worked as a technical manager at THQ, so I saw enough of all sorts of terrible hacks.  But there is one that I still laugh at.  It happened with Beam Software in the early 1990s. <br><br>  In that era, when there were no convenient IDEs and smart compilers, we wrote all the games in assembly language.  All .s files contained the corresponding assembly code for individual parts of the game: creature1.s, collision.s, controls.s, and so on.  In addition, we used a makefile ‚Äî the programmer created a new .s file and placed it after everything else in the makefile. <br><br>  The idea was that you enter make on the command line, and the assembler assembles each file into a new .o file, after which the linker joins them all together to build the finished executable file.  We had one programmer, notorious for writing code with bugs, that interfered with some random areas of memory.  These were usually buffer overflows. <br><br>  He spent some time finding these bugs, but if he did not succeed, then he ... changed the order of the files in the makefile so that the files were statically linked into memory in a different order!  This meant that the accidentally recorded fragment of memory was now in some other place, but due to sheer luck, for some reason the game stopped falling out.  He did this until practically any changes in the makefile began to lead to failures. <br><br>  At the last moment, when the game had to be released, he solved this problem.  He simply continued to create new .s files filled with small pieces of data that he inserted into arbitrary places in the makefile until they somehow ceased to crumble, and then released it!  At that time there were at least two games (for the Game Boy) released using such a ‚Äútechnique‚Äù. <br><br>  <em>- Shane Stevens</em> <br><br><h2>  Substandard </h2><br>  We sought to release the game <em>World Series of Poker 2008</em> , which was our first project on the PlayStation 3. PS3 supported several different screen resolutions and two aspect ratios.  We created a 2D shell for a wide screen, but we didn‚Äôt have enough time and resources for a 2D shell with standard resolution.  I have carefully studied the requirements of the developer and have not found any reasons why letterboxing would be prohibited. <br><br>  Therefore, our standard ratio mode was just widescreen mode with black bars above and below the picture.  The publisher desperately tried to adjust the requirements that would make us fix it, but then gave up and we released the game as it is.  In addition, a few hours after buying my own PS3, playing on a TV with a standard aspect ratio, I went and bought a widescreen TV.  I doubt that many have connected this miracle of technology (PS3) to the old tube TVs! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ed/17f/76f/2ed17f76fdd109dbc4fefceae8fbb9cd.jpg" alt="image"></div><br><br>  <em>- Stephen Boswell II</em> <br><br><h2>  Striving for constants </h2><br>  For some reason, we have a huge incompatibility between the existing codebase and the new billions of lines of code written to use old code libraries.  The first code was written by people who were close to the idea of ‚Äã‚Äã"safe" programming, as strict and restrictive as possible to avoid errors.  Therefore, they used a C / C ++ language feature called CONST. <br><br>  CONST means "constant";  it ensures that read-only variables cannot be changed inside functions.  The code with and without CONST was incompatible with each other, which is why the compiler cursed.  The development team decided to insert a hack into the code and performed a cunning little trick: #define const, so that the constant was ... nothing, an empty space.  Therefore, the <code>const int x;</code>  when preprocessing before compilation, became <code>int x;</code>  .  This is similar to the fact that you bought a car, took off two wheels and use it as a motorcycle. <br><br>  Personally, I really hate CONST, so I liked this trick.  But some thought such an approach was analogous to cutting a safety belt with scissors. <br><br>  <em>- Anonymous</em> <br><br><h2>  Reality bites </h2><br>  We had a bug in the game on the Unreal Engine 3 for PlayStation 3 (this was the first project released on UE3 for PS3): in debug mode, the game inexplicably fell out during printf () when connected to a multiplayer game. <br><br>  The client in debug mode would display all the hashes of each content pack that ordered it to load the server, and obviously, one of the hashes (in this assembly) contained%.  We could not come up with a good solution to the problem, but #ifndef PS3 worked quite fine until the next data assembly, in which the bug disappeared. <br><br>  About a year later, in the next project, I came across the same bug and took advantage of the exact same fix.  The disaster occurred after the release of the game, when we were working on the content patch.  Creating a DLC / patch was done in such a way that we could not patch the compiled UnrealScript, but we had a bug in which two remote procedure calls were not marked as reliable;  this meant that the packets to call them would be re-transmitted until confirmation was received.  Therefore, in conditions of poor connection, the functions of enabling readiness and the state of voice transmission in the lobby were sometimes not called.  However, only remote UnrealScript can mark remote procedure calls as reliable, and we could not patch UnrealScript. <br><br>  Therefore, when loading, we loop around all the loaded UFunction objects (which are representations of the script function in C ++), performed a string comparison of names and assigned the two flags to the two calls.  Everything worked great. <br><br>  <em>- Anonymous</em> <br><br><h2>  Your data is ready </h2><br>  The Xbox Live Arcade games on the first Xbox should have been fully packaged in an .xex file.  To accomplish this, we stored all the data in a .zip file, embedded as a data section in the executable file.  Gradually, the file grew so much that we could no longer load the data section into memory, allocate enough memory to decompress it, and pull out the necessary file. <br><br>  To fix the problem, I wrote code that, after loading the game, reads the PE header of the executable file and writes offsets to the data sections.  Thanks to this, the file stream that read the executable file could simply move to the offsets of different zip files and output them directly from the executable file without loading data partitions into memory. <br><br>  <em>- Pat Wilson</em> <br><br><h2>  Pinhole camera </h2><br>  I will talk about the old case: <em>Force 21</em> was one of the first three-dimensional RTS, which used a floating camera to monitor the current squad.  By the end of the project, we had a strange bug in which the camera stopped following the squad - it just stopped while the squad continued to move, and nothing could move it.  This happened at random times and we could not reproduce the error. <br><br>  This continued until one of the testers noticed that this happens more often when an airstrike occurs next to the player‚Äôs equipment.  Thanks to this information I managed to find the source of the error.  Since the camera used speed and acceleration, and could also participate in collisions, I made it inheritable from the PhysicalObject class, which possessed such characteristics.  But he had one more characteristic: PhysicalObject could take damage.  Air strikes inflicted high damage in a fairly large radius, so they literally "killed" the camera. <br><br>  I corrected this error by making sure that the cameras did not take damage, but to make sure I increased the values ‚Äã‚Äãof their armor and energy to huge values.  I think we can confidently say that our game was the most powerful camera in the world. <br><br>  <em>- Jim Van Werth</em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a2a/85e/e09/a2a85ee0945b6a1d16cc43ed215daf9c.jpg" alt="image"></div><br><h2>  Hexapility </h2><br>  I was testing <em>The New Tetris</em> for N64.  We had a failure, which I could reproduce at any time: a dump of registers was displayed on the screen, after which the game hung.  To get rid of the hangup, you had to turn off and turn on the power of the N64: even the reset key did not respond. <br><br>  Version by version, the developer said that the bug was fixed, and version by version I reproduced it.  The release deadline was approaching, and in order to release the game, the developer needed to eliminate all crashes that lead to crashes.  (Nintendo independently tested even the games of other companies, and Nintendo had to approve it for the release of the game.) But they couldn‚Äôt get rid of this bug. <br><br>  Also in the game there were no secret codes related to the bug that could be entered to unlock various features.  Once I joked that a developer should replace the hex dump screen with the words ‚ÄúCongratulations!  You have discovered the secret code!  Turn the console off and on again, and then enter the username HALUCI. ‚Äù  And he did.  It is because of this that the game was released. <br><br>  <em>- Anonymous</em> <br><br><h2>  Short stack </h2><br>  In 1982‚Äì83 I was one of several interns at IMAGIC, and at that time we all made cartridges for Intellivision.  One of the programmers had to go back to school, so they chose me to fix a bug with a hang in his game.  This turned out to be a stack overflow in the timer interrupt handler. <br><br>  Since the only task for the handler was to update the display of the on-screen timer, I added code to test the stack depth at the beginning of the interrupt procedure.  If there was a danger of stack overflow, the procedure performed a return without doing anything.  Since the handler was called many times a second, the player did not notice anything, and the error was corrected. <br><br>  <em>- Anonymous</em> <br><br><h2>  Back to basics </h2><br>  My colleague Mike Mick and I ported the game about collecting <em>Klax</em> tiles from arcade machines to Game Boy Color.  It was an interesting, stressful six-week project to transfer one of our favorite games to the system. <br><br>  We had the C source code (actually <em>Escape from the Planet of the Robot Monsters</em> , only most of the robot monsters were commented out and replaced with the <em>Klax</em> code), and we often spoke with the original arcade programmer Dave Eckers, who wrote Weekend prototype on Amiga BASIC and ported it to C in about a day. <br><br>  We coded the game in Z80 assembly language.  There were many interesting things, for example, we copied the code onto a whiteboard and mentally traversed line by line, updating the contents of the memory on another whiteboard, because we did not have a real debugger.  These were good times. <br><br>  The deadlines were already running out, but everything worked fine.  I played the arcade version, tested the GBC version and found a strange scoring bug.  I don‚Äôt remember the problem itself, but there was something like a situation where a large cross broke into several diagonals.  Be that as it may, points on the GBC compared to the arcade machine were added incorrectly. <br><br>  Needless to say, I discovered this at about 11:30 pm (right before the end of the term).  We ran the code a million times, compared our assembly code with the C code of the arcade machine, and the bug was impossible.  We counted the points correctly, and our code performed exactly the same and in the same order as the C program, which was just a line-by-line transfer of what Dave originally did on Amiga BASIC.  (I suspect that Dave was a bit like Mike - he was very good at assembly language and BASIC, but he didn‚Äôt like C twenty years ago when <em>Klax</em> was made.) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/23c/ae2/759/23cae2759f8adf6e1c95f42594d52260.png" alt="image"></div><br>  Finally, at about five in the morning, after spending all night on it, we came to an idea that could not have earned, but it was worth a try.  Mike wrote a scoring system on Quick BASIC, and the points began to be counted exactly the same as on the arcade machine.  Then we transferred BASIC line by line to the Z80 assembler. <br><br>  It worked.  God knows why, but the program behaved exactly like an arcade machine (perhaps this is somehow related to the fact that the original was written in BASIC).  We sent the Atari assembly, printed out both versions of the code, and went to the cafe.  At breakfast, we spent an hour looking at the code and still did not understand why it works differently.  Even today we can both swear that the code should have given identical results!  But sometimes, when it gets too late, it is time to start doing voodoo programming! <br><br>  <em>- Chris Charla</em> <br><br>  <em>Games are not the only area in which hacks can save the day.</em>  <em>Here are two non-game examples that are too curious to not include as a bonus.</em> <br><br><h2>  Window washers </h2><br>  Five years ago, I worked as a software developer in the field of video surveillance software development.  We wrote very sensitive and complex security software.  We had a wonderful, well-working product.  The most difficult part of the software was the simultaneous display on the screen of 50 video streams.  The software required a huge amount of memory, and it had to function 24/7. <br><br>  A few weeks before the release, we handed over a beta version to customers.  A week later, we noticed a huge memory leak - about 4 KB per minute.  I spent a couple of days studying the leak, but it did not give any results, and we didn‚Äôt have time to fix it before the release.  Memory was an essential part of the software, and a leak of this size would completely kill the application.  Conducting testing (in Windows), I had to minimize the software window in order to return to the window with the code, and during this I noticed a serious decrease in the occupied memory. <br><br>  Then I remembered that when I moved a window to the notification area or to the Start menu, Windows instantly recovers unused / freed memory.  This was our chance!  I added a timer to the application, which every couple of minutes moved the window to the Start menu panel, and then immediately opened it in full screen.  On the screen, it looked like a flicker, but it worked!  After that, we were able to release the application, which gave us a little more time to fix the bug (which we discovered a few days later - some window handle did not properly clean the window). <br><br>  <em>- Johan Launi</em> <br><br><h2>  Results may vary. </h2><br>  In the 1970s, I worked with the team on the banking system.  We wrote in the long-forgotten programming language MPL2.  In this language, there was a limit of 256 global variables, and since they were all used, in order to add a new function to the system, it was often necessary to look for a variable that can be released or used for two different purposes in different parts of the code. <br><br>  It was a risky and long process.  Inside the program, each function could have 256 of its own variables, limited by the function's scope.  Once, when I was at home, an insight descended on me.  The next morning, I suggested to the boss to wrap all the code in a function.  Then we would have 256 global variables for the program, because the 256 used so far will be safely stored in the ‚Äúinternal‚Äù function. <br><br>  The program itself would simply declare a few more variables, and then call a function containing the entire source program.  But now she could ‚Äúsee‚Äù not only her own 256 variables, but also the new 256 global variables.  My boss was skeptical, but gave me a two-hour compile-time window and was stunned that it worked.  We were able to circumvent the problem that the team had been facing for a couple of years. </div><p>Source: <a href="https://habr.com/ru/post/358704/">https://habr.com/ru/post/358704/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358694/index.html">UPD Broadcast. We invite you to the New PostgreSQL 11 features mitap</a></li>
<li><a href="../358696/index.html">We update Angular to the 6th version in the project without use of CLI</a></li>
<li><a href="../358698/index.html">13 interesting points from the javascript style guide from google</a></li>
<li><a href="../358700/index.html">GraalVM: mixed in a bunch of C and Scala</a></li>
<li><a href="../358702/index.html">How to run dynamic retargeting effectively in a mobile application</a></li>
<li><a href="../358706/index.html">Applications for Tarantool. Part 3. Testing and launch</a></li>
<li><a href="../358708/index.html">Frontend 2018: the variety of frameworks and the lack of middles</a></li>
<li><a href="../358710/index.html">Q & A Explorer. April feature for Power BI Desktop</a></li>
<li><a href="../358712/index.html">7 common mistakes in English that we make when communicating with foreigners</a></li>
<li><a href="../358714/index.html">Two types of PHP extensions. Zend extension VS PHP module</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>