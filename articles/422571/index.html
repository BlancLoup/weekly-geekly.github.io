<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parallelization of tasks with dependencies - example on .NET</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello colleagues! 

 This week we have given to the translation the book Manning publishing house " Concurrency in .NET ", which is ambitious in its c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parallelization of tasks with dependencies - example on .NET</h1><div class="post__text post__text-html js-mediator-article"> Hello colleagues! <br><br>  This week we have given to the translation the book Manning publishing house " <a href="https://www.manning.com/books/concurrency-in-dot-net">Concurrency in .NET</a> ", which is ambitious in its complexity: <br><br><img src="https://habrastorage.org/webt/d2/wo/xw/d2woxw94fdzsysmnbw2ippieyas.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The author kindly posted on the site Medium an excerpt from the 13th chapter, which we propose to evaluate long before the premiere. <br>  Enjoy reading! <br><a name="habracut"></a><br>  Suppose you need to write a tool that allows you to perform a series of asynchronous tasks, each of which has its own set of dependencies that affect the order of operations.  Such problems can be solved with the help of consistent and imperative execution, but if you want to achieve maximum performance, then successive operations will not work for you.  Instead, you need to organize parallel execution of tasks.  Many competitive problems can be interpreted as static collections of atomic operations with dependencies between their input and output data.  When the operation is completed, its output is used as input for other, dependent operations.  To optimize performance, tasks need to be assigned based on their dependencies, and the algorithm must be configured so that dependent tasks are performed as consistently as necessary, and as parallel as possible. <br><br>  You want to make a reusable component that executes a series of tasks in parallel, and ensure that all dependencies that could affect the order of operations are taken into account.  How to build such a programming model that would provide the basic parallelism of a collection of operations performed effectively, either in parallel or sequentially, depending on what dependencies arise between this operation and others? <br><br>  <b>Solution: Implement the dependency graph using the MailboxProcessor class from F # and provide methods as standard tasks (Task) so that they can be consumed from C #</b> <br><br>  Such a solution is called Oriented Acyclic Graph (DAG) and is intended to form a graph, splitting operations into sequences of atomic tasks with well-defined dependencies.  In this case, the acyclic essence of the graph is important, since it eliminates the possibility of interlocking between tasks, provided that the tasks are in fact completely atomic.  When setting the graph, it is important to understand all the dependencies between the tasks, especially implicit dependencies that can lead to interlocks or race conditions.  Below is a typical example of a graph-like data structure, with which you can imagine the limitations that arise when planning interactions between operations in a given column. <br><br>  A graph is an extremely powerful data structure, and you can write strong algorithms based on it. <br><br><img src="https://habrastorage.org/webt/a7/d3/8o/a7d38oxfbvek6koh8cto3d6lxlc.png"><br><br>  <i>Fig.</i>  <i>1 A graph is a collection of vertices connected by edges.</i>  <i>In this representation of a directed graph, node 1 depends on nodes 4 and 5, node 2 depends on node 5, node 3 depends on nodes 5 and 6, and so on.</i> <br><br>  The DAG structure is applicable as a strategy for parallel execution of tasks, taking into account the order of dependencies, which improves performance.  The structure of such a graph can be defined using the <code>MailboxProcessor</code> class from the F # language;  In this class, the internal state is preserved for tasks registered for execution in the form of edge dependencies. <br><br>  <b>Validation of an oriented acyclic graph</b> <br><br>  When working with any graph data structure, such as DAG, you have to take care of the correct registration of edges.  For example, going back to Figure 1: what happens if we have node 2 registered with dependencies on node 5, and node 5 does not exist?  It may also happen that some edges are dependent on each other, which is why an oriented cycle occurs.  With an oriented cycle, it is critical to perform some tasks in parallel;  otherwise, some tasks can always wait for others to complete, and a deadlock will occur. <br><br>  The problem is solved using topological sorting: this means that we can order all the vertices of the graph in such a way that any edge leads from the vertex with a smaller number to the vertex with a larger number.  So, if task A should complete before task B, and task B should complete task C, which, in turn, should complete before task A, then a circular reference occurs, and the system will notify you of this error by throwing an exception.  If an oriented cycle occurs during sequence management, then there is no solution.  This type of verification is called ‚Äúdetection of a cycle in a directed graph‚Äù.  If a directed graph satisfies the described rules, then it is a directed acyclic graph, perfectly suitable for running several tasks in parallel, between which there are dependencies. <br><br>  The full version of Listing 2, which contains the DAG validation code, is in the source code posted online. <br><br>  In the following listing, the F # <code>MailboxProccessor</code> class is used as an ideal candidate for implementing a DAG that provides concurrent dependency-related operations.  First, let's define the marked union, with which we will manage the tasks and perform their dependencies. <br><br>  Listing 1 Message type and data structure for coordinating tasks according to their dependencies <br><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TaskMessage</span></span></span><span class="hljs-class"> = // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">A</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AddTask</span></span></span><span class="hljs-class"> of int * </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TaskInfo</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">QueueTask</span></span></span><span class="hljs-class"> of </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TaskInfo</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExecuteTasks</span></span></span><span class="hljs-class"> and </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TaskInfo</span></span></span><span class="hljs-class"> = // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">B</span></span></span><span class="hljs-class"> { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Context</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">System</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Threading</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExecutionContext</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Edges</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Id</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Func</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EdgesLeft</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">option</span></span></span><span class="hljs-class">; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Start</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DateTimeOffset</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">option</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">End</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DateTimeOffset</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">option</span></span></span><span class="hljs-class"> }</span></span></code> </pre> <br><br>  #A sends the base <code>dagAgent</code> agent to <code>ParallelTasksDAG</code> , responsible for coordinating the execution of tasks <br><br>  #B Wraps the details of each task to complete. <br><br>  The <code>TaskMessage</code> type represents wrappers for messages sent to the base agent of type <code>ParallelTasksDAG</code> .  These messages are used to coordinate tasks and synchronize dependencies.  The <code>TaskInfo</code> type contains and tracks the details of registered tasks during the execution of a DAG, including dependency edges.  The execution context (https://msdn.microsoft.com/en-us/library/system.threading.executioncontext(v=vs.110).aspx) is captured for the purpose of accessing information during deferred execution, for example, of such information: current user, any state associated with a logical flow of execution, information about safe access to code, etc.  After the event is triggered, the start and end time is published. <br><br>  Listing 2 DAG agent on F # for parallelizing dependencies related operations <br><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ParallelTasksDAG</span></span></span><span class="hljs-class">() = let onTaskCompleted = new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Event</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TaskInfo</span></span></span><span class="hljs-class">&gt;() // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">A</span></span></span><span class="hljs-class"> let dagAgent = new </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MailboxProcessor</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TaskMessage</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fun</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inbox</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">let</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rec</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loop</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tasks</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dictionary</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TaskInfo</span></span></span><span class="hljs-class">&gt;) // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">B</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">edges</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dictionary</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class">&gt;) = async { // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">B</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">let</span></span></span><span class="hljs-class">! </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inbox</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Receive</span></span></span><span class="hljs-class">() // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">match</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">msg</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExecuteTasks</span></span></span><span class="hljs-class"> -&gt; // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">D</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">let</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fromTo</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dictionary</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class">&gt;() </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">let</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ops</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dictionary</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TaskInfo</span></span></span><span class="hljs-class">&gt;() // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">E</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">KeyValue</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">in</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tasks</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">F</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">let</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">operation</span></span></span><span class="hljs-class"> = { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EdgesLeft</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Some</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Edges</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Length</span></span></span><span class="hljs-class">) } for from in operation.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Edges</span></span></span><span class="hljs-class"> do let exists, lstDependencies = fromTo.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TryGetValue</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class">) if not &lt;| exists then fromTo.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Add</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">from</span></span></span><span class="hljs-class">, [ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">operation</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Id</span></span></span><span class="hljs-class"> ]) else fromTo.[from] &lt;- (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">operation</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Id</span></span></span><span class="hljs-class"> :: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lstDependencies</span></span></span><span class="hljs-class">) ops.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Add</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">operation</span></span></span><span class="hljs-class">) ops |&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Seq</span></span></span><span class="hljs-class">.iter (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fun</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">kv</span></span></span><span class="hljs-class"> -&gt; // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">F</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">match</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">kv</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Value</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EdgesLeft</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Some(n)</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">when</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class"> = 0 -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inbox</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Post</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">QueueTask</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">kv</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Value</span></span></span><span class="hljs-class">)) | _ -&gt; ()) return! loop ops fromTo | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">QueueTask</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">op</span></span></span><span class="hljs-class">) -&gt; // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">G</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Async</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Start</span></span></span><span class="hljs-class"> &lt;| async { // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">G</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">let</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">start</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DateTimeOffset</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Now</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">match</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">op</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Context</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class"> // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">H</span></span></span><span class="hljs-class"> | </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">null</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">op</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Invoke</span></span></span><span class="hljs-class">() |&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Async</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AwaitATsk</span></span></span><span class="hljs-class"> | </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ctx</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExecutionContext</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Run</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ctx</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CreateCopy</span></span></span><span class="hljs-class">(), // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">I</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fun</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">op</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">let</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">opCtx</span></span></span><span class="hljs-class"> = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">op</span></span></span><span class="hljs-class"> :?&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TaskInfo</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">opCtx</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Invoke</span></span></span><span class="hljs-class">().</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ConfigureAwait(false)</span></span></span><span class="hljs-class">), </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">taskInfo</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">let</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end'</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DateTimeOffset</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Now</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">onTaskCompleted</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Trigger</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">op</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Start</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Some(start)</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">End</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Some</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end'</span></span></span><span class="hljs-class">) } // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class"> let exists, deps = edges.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TryGetValue</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">op</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Id</span></span></span><span class="hljs-class">) if exists &amp;&amp; deps.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Length</span></span></span><span class="hljs-class"> &gt; 0 then let depOps = getDependentOperation deps tasks [] edges.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Remove</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">op</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Id</span></span></span><span class="hljs-class">) |&gt; ignore depOps |&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Seq</span></span></span><span class="hljs-class">.iter (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fun</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nestedOp</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inbox</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Post</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">QueueTask(nestedOp)</span></span></span><span class="hljs-class">)) } return! loop tasks edges | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AddTask</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">op</span></span></span><span class="hljs-class">) -&gt; tasks.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Add</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">op</span></span></span><span class="hljs-class">) // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">M</span></span></span><span class="hljs-class"> return! loop tasks edges } loop (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dictionary</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TaskInfo</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">HashIdentity</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Structural</span></span></span><span class="hljs-class">)) (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Dictionary</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class">&gt;(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">HashIdentity</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Structural</span></span></span><span class="hljs-class">))) [&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CLIEventAttribute</span></span></span><span class="hljs-class">&gt;] member this.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OnTaskCompleted</span></span></span><span class="hljs-class"> = onTaskCompleted.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Publish</span></span></span><span class="hljs-class"> // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class"> member this.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExecuteTasks</span></span></span><span class="hljs-class">() = dagAgent.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Post</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExecuteTasks</span></span></span><span class="hljs-class"> // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">N</span></span></span><span class="hljs-class"> member this.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AddTask</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">task</span></span></span><span class="hljs-class">, [&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ParamArray</span></span></span><span class="hljs-class">&gt;] </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">edges</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">) = let </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> = { </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Context</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExecutionContext</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Capture</span></span></span><span class="hljs-class">() </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Edges</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">edges</span></span></span><span class="hljs-class">; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Id</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">task</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">NumRemainingEdges</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">None</span></span></span><span class="hljs-class">; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Start</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">None</span></span></span><span class="hljs-class">; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">End</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">None</span></span></span><span class="hljs-class"> } dagAgent.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Post</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AddTask</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">)) // #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">O</span></span></span></span></code> </pre> <br><br>  #A An instance of the <code>onTaskCompletedEvent</code> class, used to notify when a task is completed. <br><br>  #B Internal agent state for tracking task registers and their dependencies.  Collections are mutable, because during the execution of <code>ParallelTasksDAG</code> state changes, and because they inherit thread safety because they are in Agent <br><br>  #C Asynchronously awaiting execution <br><br>  #D The shell of the message that launches <code>ParallelTasksDAG</code> <br><br>  #E Collection displayed on a monotonously increasing index with a task to launch <br><br>  #F Process enumerates the task list, analyzing dependencies with other tasks to create a topological structure that presents the order in which tasks are performed <br><br>  #G The message envelope for queuing the task, its execution and, ultimately, for deleting this task from the agent state as an active dependency after the task is completed <br><br>  #H If the picked-up <code>ExecutionContext</code> is <code>null</code> , then we start the task in the current context, otherwise we go to #I <br><br>  #I Run the task in the intercepted <code>ExecutionContext</code> <br><br>  #L Initiate and publish the <code>onTaskCompleted</code> event to give notification of the completion of the task.  The event contains information about the task. <br><br>  #M Message shell to add a task for execution in accordance with its dependencies, if any <br><br>  #N Starts the execution of registered tasks. <br><br>  #O Add a task, its dependencies and the current <code>ExecutionContext</code> to execute the DAG. <br><br>  The purpose of the <code>AddTask</code> function is to register a task with arbitrary dependency edges.  This function accepts a unique ID, a task that must be completed, and a set of edges representing the IDs of all other registered tasks that must be completed before the task can be performed.  If the array is empty, it means that there are no dependencies.  An instance of <code>MailboxProcessor</code> called <code>dagAgent</code> keeps registered tasks up to date with the ‚Äútasks‚Äù, which is a dictionary ( <code>tasks : Dictionary&lt;int, TaskInfo&gt;</code> ), correlating the ID of each task and its details.  Moreover, the Agent also stores the state of edge dependencies by the ID of each task ( <code>edges : Dictionary&lt;int, int list&gt;</code> ).  When an agent receives a notification about the need to start execution, this process checks that all edge dependencies are registered and that there are no cycles in the graph.  This verification phase is available in the full implementation of ParallelTasksDAG, provided in the online code.  Next, I offer an example in C #, where I refer to the library that F # to launch <code>ParallelTasksDAG</code> (and consume it).  The registered tasks reflect the dependencies shown above in fig.  one. <br><br><pre> <code class="cs hljs">Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, Func&lt;Task&gt;&gt; action = (id, delay) =&gt; <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { Console.WriteLine($‚ÄùStarting operation{id} <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id {Thread.CurrentThread.ManagedThreadId}‚Ä¶‚Äù); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> Task.Delay(delay); }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dagAsync = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DAG.ParallelTasksDAG(); dagAsync.OnTaskCompleted.Subscribe(op =&gt; Console.WriteLine($‚ÄùOperation {op.Id} completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id { Thread.CurrentThread.ManagedThreadId}‚Äù)); dagAsync.AddTask(<span class="hljs-number"><span class="hljs-number">1</span></span>, action(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">600</span></span>), <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>); dagAsync.AddTask(<span class="hljs-number"><span class="hljs-number">2</span></span>, action(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>), <span class="hljs-number"><span class="hljs-number">5</span></span>); dagAsync.AddTask(<span class="hljs-number"><span class="hljs-number">3</span></span>, action(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">800</span></span>), <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>); dagAsync.AddTask(<span class="hljs-number"><span class="hljs-number">4</span></span>, action(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>), <span class="hljs-number"><span class="hljs-number">6</span></span>); dagAsync.AddTask(<span class="hljs-number"><span class="hljs-number">5</span></span>, action(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">450</span></span>), <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>); dagAsync.AddTask(<span class="hljs-number"><span class="hljs-number">6</span></span>, action(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>), <span class="hljs-number"><span class="hljs-number">7</span></span>); dagAsync.AddTask(<span class="hljs-number"><span class="hljs-number">7</span></span>, action(<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>)); dagAsync.AddTask(<span class="hljs-number"><span class="hljs-number">8</span></span>, action(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">700</span></span>)); dagAsync.ExecuteTasks();</code> </pre> <br>  The purpose of the auxiliary function is to display a message that the task has started, referring to the <code>Id</code> current thread to confirm the multithreading.  On the other hand, the <code>OnTaskCompleted</code> event <code>OnTaskCompleted</code> registered to issue a notification of the completion of each task with the output of the task <code>ID</code> and the <code>Id</code> current flow to the console.  Here is the output that we get when calling the <code>ExecuteTasks</code> method. <br><br><pre> <code class="hljs objectivec">Starting operation <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">23</span></span>‚Ä¶ Starting operation <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">24</span></span>‚Ä¶ Operation <span class="hljs-number"><span class="hljs-number">8</span></span> Completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">23</span></span> Operation <span class="hljs-number"><span class="hljs-number">7</span></span> Completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">24</span></span> Starting operation <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">23</span></span>‚Ä¶ Starting operation <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">25</span></span>‚Ä¶ Operation <span class="hljs-number"><span class="hljs-number">6</span></span> Completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">25</span></span> Starting operation <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">24</span></span>‚Ä¶ Operation <span class="hljs-number"><span class="hljs-number">5</span></span> Completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">23</span></span> Starting operation <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">27</span></span>‚Ä¶ Starting operation <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">30</span></span>‚Ä¶ Operation <span class="hljs-number"><span class="hljs-number">4</span></span> Completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">24</span></span> Starting operation <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">28</span></span>‚Ä¶ Operation <span class="hljs-number"><span class="hljs-number">2</span></span> Completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">27</span></span> Operation <span class="hljs-number"><span class="hljs-number">1</span></span> Completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">28</span></span> Operation <span class="hljs-number"><span class="hljs-number">3</span></span> Completed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Thread Id <span class="hljs-number"><span class="hljs-number">30</span></span></code> </pre> <br>  As you can see, tasks are performed in parallel in different threads (their thread <code>ID</code> are different), and the order of dependencies is preserved. <br><br>  In essence, this is how tasks that have dependencies are parallelized.  Read more in the book Concurrency in .NET. </div><p>Source: <a href="https://habr.com/ru/post/422571/">https://habr.com/ru/post/422571/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../422553/index.html">Official browser extension Mega stole data and cryptocurrency of file sharing users</a></li>
<li><a href="../422555/index.html">Multi-modality in Android in terms of architecture. From A to Z</a></li>
<li><a href="../422561/index.html">How Yandex used computer vision to improve the quality of video broadcasts. DeepHD technology</a></li>
<li><a href="../422565/index.html">Friday's Skillbox webinars: everything for programmers and designers</a></li>
<li><a href="../422569/index.html">Hourly, time tracking app</a></li>
<li><a href="../422573/index.html">Reverse engineering rendering "The Witcher 3"</a></li>
<li><a href="../422575/index.html">Rare intercom</a></li>
<li><a href="../422577/index.html">Copies and copyrights: how patent and copyright influence the development of 3D printing</a></li>
<li><a href="../422581/index.html">Schr√∂dinger's Quantum Switch</a></li>
<li><a href="../422583/index.html">Strong middling: Snom D735 IP Phone Review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>