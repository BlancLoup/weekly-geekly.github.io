<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The book "Elasticsearch, Kibana, Logstash and the new generation of search engines"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habrozhiteli! We published a book on Elastic Stack, designed for professionals working with large amounts of data and wanting to reliably extract ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The book "Elasticsearch, Kibana, Logstash and the new generation of search engines"</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habr.com/ru/company/piter/blog/451750/"><img src="https://habrastorage.org/webt/8k/tg/_2/8ktg_2verqqbx9jltq2fodz8weu.jpeg" align="left" alt="image"></a>  Hi, Habrozhiteli!  We published a book on Elastic Stack, designed for professionals working with large amounts of data and wanting to reliably extract them from any source in any format, as well as to search, analyze and visualize data in real time.  This book is for you if you need a fundamental understanding of how the Elastic Stack works in the realms of distributed computing and data processing. <br><br>  Below will be given the structure of the book about an excerpt about aggregation. <br><a name="habracut"></a><br><h3>  Book structure </h3><br>  Chapter 1, ‚ÄúIntroduction to Elastic Stack,‚Äù introduces the main components of the Elastic Stack, explains their role in the overall structure, describes the purpose of each component.  This chapter also discusses the need for distributed, scalable search and analysis, which are achieved using Elasticsearch.  At the end, a guide to downloading and installing Elasticsearch and Kibana is provided so that you can start working with these tools. <br><br>  Chapter 2, Getting Started with Elasticsearch, introduces the key principles behind the Elasticsearch search engine, which is the foundation of the Elastic Stack.  You will be introduced to concepts such as indexes, types, nodes, and clusters.  You will also learn how to use the REST API to perform basic operations. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Chapter 3, ‚ÄúSearch is what's important‚Äù focuses on the search methods provided by Elasticsearch.  You will learn about the basics of text analysis, tokenizers, analyzers, features of the relevant search.  This chapter also provides practical examples of relevant searches. <br><br>  Chapter 4, ‚ÄúAnalyzing Data with Elasticsearch,‚Äù discusses the different types of aggregation.  It includes examples that will allow you to better understand the principles of data analysis.  You will learn how to use various types of aggregations - from the simplest to the most complex, in order to navigate through huge amounts of data.  After reading this chapter, you will know when and which variant of aggregation is better to use. <br><br>  Chapter 5, ‚ÄúAnalyzing Log Data,‚Äù contains information about the need to use Logstash, its architecture, installation and configuration.  Elastic 5 provides the Ingest Node tool that can replace the Logstash configuration.  After reading this chapter, you will learn how to create containers using Elastic Ingest Node. <br><br>  Chapter 6, ‚ÄúDeveloping Containers with Logstash,‚Äù provides fundamental knowledge about Logstash, which allows you to dynamically identify data from various sources and normalize it using selected filters.  You will learn how having a wide range of filters puts Logstash on a par with other frameworks for streaming processing in real and near real time without writing code.  You will also learn about the Beats platform and the FileBeat component used to transport log files (log files) from remote machines. <br><br>  Chapter 7, ‚ÄúVisualizing Data in Kibana,‚Äù shows the effectiveness of using Kibana for visualizing and impressively presenting your data.  The example of a simple data set describes the creation of visualizations in a couple of clicks. <br><br>  Chapter 8, "Elastic X-Pack" talks about the expansion of Elasticsearch.  By this time, you will have already studied Elasticsearch and its key components for creating data containers and will be able to connect extensions to solve specific problems.  In this chapter, you will read how to install and configure X-Pack components in the Elastic Stack, learn the basics of security and monitoring, and learn how to add various notifications. <br><br>  Chapter 9, ‚ÄúLaunching the Elatic Stack into Work,‚Äù gives recommendations for launching the Elastic Stack complex into commercial operation.  You will receive recommendations on how to implement your application and change the standard settings according to the requirements of operation.  You will also learn how to use Elastic Cloud cloud services. <br><br>  Chapter 10, Creating an Application for Analyzing Data from Sensors, describes the creation of an application for analyzing and processing data from various sources.  You will learn how to model data in Elasticsearch, create data containers and visualize them in Kibana.  You will also learn how to effectively use the X-Pack components to ensure the security and monitoring of your containers, and to receive notifications about various events. <br><br>  Chapter 11, Monitoring Server Infrastructure, demonstrates how Elastic Stack can be used to configure real-time monitoring for servers and applications that are created entirely on the Elastic Stack.  You will be introduced to another component of the Beats platform - Metricbeat, which is used to monitor servers / applications. <br><br><h3>  Sum aggregation, average, maximum and minimum values </h3><br>  Finding the sum of a field, a minimum or maximum value, or an average number are fairly common operations.  In SQL, the query to calculate the sum is as follows: <br><br><pre><code class="plaintext hljs">SELECT sum(downloadTotal) FROM usageReport;</code> </pre> <br>  This will calculate the sum of the downloadTotal field for all entries in the table.  To do this, go through all the records in the table or all the records in the selected context and add the values ‚Äã‚Äãof the selected fields. <br><br>  In Elasticsearch, you can write a similar query using sum aggregation. <br><br><h3>  Sum aggregation </h3><br>  Here is how to write a simple amount aggregation: <br><br><pre> <code class="plaintext hljs">GET bigginsight/_search { "aggregations": { 1 "download_sum": { 2 "sum": { 3 "field": "downloadTotal" 4 } } }, "size": 0 5 }</code> </pre> <br><ol><li>  The elements of aggs or aggregations at the top level should serve as an aggregation wrapper. </li><li>  Give the aggregation a name.  In this case, we aggregate the amount in the downloadTotal field and choose the corresponding name download_sum.  You can call her whatever you like.  This field is useful when we need to find this particular aggregation in the response results. </li><li>  We do sum aggregation, therefore, the element sum is used. </li><li>  We want to make an aggregation of terms across the downloadTotal field. </li><li>  Specify size = 0 to prevent unprocessed results from returning.  We only need aggregation results, not search results.  Since we did not specify any high-level query elements, the query will work with all documents.  We do not need to answer the raw documents (or the results of search results). </li></ol><br>  The answer should look like this: <br><br><pre> <code class="plaintext hljs">{ "took": 92, ... "hits": { "total": 242836, 1 "max_score": 0, "hits": [] }, "aggregations": { 2 "download_sum": { 3 "value": 2197438700 4 } } }</code> </pre> <br>  We will understand the basic parameters of the answer. <br><br><ol><li>  The hits.total element shows the number of documents corresponding to the request context.  If no additional query or filter is specified, all documents in a type or index will be included. </li><li>  By analogy with the request, this response is placed inside the aggregation for presentation in this form. </li><li>  The response of the aggregation we requested is called download_sum, therefore, we get our answer from the aggregation of the amount within the element with the same name. </li><li>  The actual value is displayed after applying the aggregation amount. </li></ol><br>  Aggregations of average, maximum, minimum values ‚Äã‚Äãare very similar.  Briefly consider them. <br><br><h3>  Average aggregation </h3><br>  Average aggregation finds the average of all documents in the context of the query: <br><br><pre> <code class="plaintext hljs">GET bigginsight/_search { "aggregations": { "download_average": { 1 "avg": { 2 "field": "downloadTotal" } } }, "size": 0 }</code> </pre> <br>  Noticeable differences from the aggregation amount are as follows. <br><br><ol><li>  We chose another name, download_average, to make it clear that this aggregation is designed to calculate the average value. </li><li>  The type of aggregation performed is avg instead of sum, as in the previous example. </li></ol><br>  The structure of the answer is identical to the answer from the previous subsection, but in the value field we will see the average value of the requested fields. <br><br>  Aggregations of minimum and maximum values ‚Äã‚Äãare similar. <br><br><h3>  Minimum value aggregation </h3><br>  Find the minimum value of the downloadTotal field in the entire index / type: <br><br><pre> <code class="plaintext hljs">GET bigginsight/_search { "aggregations": { "download_min": { "min": { "field": "downloadTotal" } } }, "size": 0 }</code> </pre> <br><h3>  Maximum value aggregation </h3><br>  Find the maximum value of the downloadTotal field in the entire index / type: <br><br><pre> <code class="plaintext hljs">GET bigginsight/_search { "aggregations": { "download_max": { "max": { "field": "downloadTotal" } } }, "size": 0 }</code> </pre> <br>  These are very simple aggregations.  Now we will consider more complicated aggregations of statistics and extended statistics. <br><br><h3>  Aggregation of statistics and extended statistics </h3><br>  These aggregations compute some common statistical values ‚Äã‚Äãwithin a single query and without performing additional queries.  Due to the fact that the statistics are calculated in one run, and are not requested several times, Elasticsearch resources are saved.  Client code is also made easier if you are interested in several types of such data.  Take a look at an example of aggregation statistics. <br><br><h3>  Aggregation of statistics </h3><br>  Aggregation statistics calculates the sum, average, maximum, minimum value and the total number of documents in one run: <br><br><pre> <code class="plaintext hljs">GET bigginsight/_search { "aggregations": { "download_stats": { "stats": { "field": "downloadTotal" } } }, "size": 0 }</code> </pre> <br>  The request for statistics on the structure is similar to other metric aggregations that you already know about;  nothing much happens here. <br><br>  The answer should look like this: <br><br><pre> <code class="plaintext hljs">{ "took": 4, ..., "hits": { "total": 242836, "max_score": 0, "hits": [] }, "aggregations": { "download_stats": { "count": 242835, "min": 0, "max": 241213, "avg": 9049.102065188297, "sum": 2197438700 } } }</code> </pre> <br>  As you can see, the answer with the download_stats element contains the total, minimum, maximum, average, and total.  Such a conclusion is very convenient, as it reduces the number of requests and simplifies client code. <br><br>  Take a look at the aggregation of extended statistics. <br><br><h3>  Aggregation of extended statistics </h3><br>  The extended stats aggregation returns slightly more statistics in addition to the previous version: <br><br><pre> <code class="plaintext hljs">GET bigginsight/_search { "aggregations": { "download_estats": { "extended_stats": { "field": "downloadTotal" } } }, "size": 0 }</code> </pre> <br>  The answer will be as follows: <br><br><pre> <code class="plaintext hljs">{ "took": 15, "timed_out": false, ..., "hits": { "total": 242836, "max_score": 0, "hits": [] }, "aggregations": { "download_estats": { "count": 242835, "min": 0, "max": 241213, "avg": 9049.102065188297, "sum": 2197438700, "sum_of_squares": 133545882701698, "variance": 468058704.9782911, "std_deviation": 21634.664429528162, "std_deviation_bounds": { "upper": 52318.43092424462, "lower": -34220.22679386803 } } } }</code> </pre> <br>  In response, you also get the sum of squares, the discrepancy, the standard deviation and its boundaries. <br><br><h3>  Power aggregation </h3><br>  Counting unique items can be performed using power aggregation.  This is similar to searching for a query result, as shown below: <br><br><pre> <code class="plaintext hljs">select count(*) from (select distinct username from usageReport) u;</code> </pre> <br>  Determining the power or number of unique values ‚Äã‚Äãfor a particular field is a fairly common task.  For example, if you have a stream of clicks1 (click-stream) from different visitors to your site, you may want to know how many unique visitors are on a site on a selected day, week, or month. <br><br>  We will understand how to find the number of unique visitors using the available network traffic data: <br><br><pre> <code class="plaintext hljs">GET bigginsight/_search { "aggregations": { "unique_visitors": { "cardinality": { "field": "username" } } }, "size": 0 }</code> </pre> <br>  The power aggregation response looks the same as in other metric aggregations: <br><br><pre> <code class="plaintext hljs">{ "took": 110, ..., "hits": { "total": 242836, "max_score": 0, "hits": [] }, "aggregations": { "unique_visitors": { "value": 79 } } }</code> </pre> <br>  Now that we understand the simplest types of aggregations, we can consider some segmental aggregations. <br><br><h3>  About the authors </h3><br>  <b>Pranav Shukla</b> is the founder and head of Valens DataLabs, an engineer, husband and father of two children.  A big data architect and professional programmer using JVM-based programming languages.  Pranav has been developing corporate applications for Fortune 500 companies and startups for more than 14 years. His main focus is creating scalable, data-driven applications based on JVM, Java / Scala, the Hadoop ecosystem, Apache Spark, and NoSQL databases.  Actively developing in areas related to the organization of big data, analytics and machine learning. <br><br>  Pranav founded Valens DataLabs to help other companies use data to increase their competitiveness.  Valens DataLabs specializes in creating new generation cloud applications for working with big data and web technologies.  The company's work is based on the use of flexible practices, principles of lean manufacturing, development based on tests and behavior, continuous and integration and continuous deployment of sustainable software systems. <br><br>  <b>Sharat Kumar M.N.</b> received a master‚Äôs degree in computer science from the University of Texas, Dallas, USA.  He has been working in the IT industry for more than ten years, currently holds the position of Oracle solution developer for Elasticsearch, is a supporter of Elastic Stack.  An avid speaker, he spoke at several science and technology conferences, including the Oracle Code Event.  Sharath is a certified Elastic teacher (Elastic Certified Instructor) - one of several technical experts in the world to whom Elastic Inc.  granted the official right to conduct trainings "from the creators of Elastic".  He is also an enthusiast in machine learning and data science. <br><br><h3>  About science editor </h3><br>  <b>Marcelo Ochoa</b> works in the laboratory of the Faculty of Science at the National University of Central Buenos Aires (Universidad Nacional del Centro de la Provincia de Buenos Aires), Argentina.  He is the Technical Director of Scotas (www.scotas.com), which specializes in pseudo-real-time solutions using Apache Solr and Oracle technologies.  Marcelo has time to work at the university and deal with projects related to Oracle and big data technologies.  He previously worked with databases, web and Java technologies.  In the XML world, Marcelo is known as a DB Generator developer for the Apache Cocoon project.  He was involved in creating open source projects such as DBPrism, DBPrism CMS, and Restlet.org, where he worked on the Oracle XDB Restlet Adapter, which is an alternative for writing native REST web services within the JVM database. <br><br>  Since 2006, he has been participating in the Oracle ACE program, and recently joined the work on the Docker Mentor project. <br><br>  ¬ªMore information about the book can be found on <a href="https://www.piter.com/collection/new/product/elasticsearch-kibana-logstash-i-poiskovye-sistemy-novogo-pokoleniya">the publisher's website.</a> <br>  ¬ª <a href="https://storage.piter.com/upload/contents/978544611024/978544611024_X.pdf">Table of Contents</a> <br>  ¬ª <a href="https://storage.piter.com/upload/contents/978544611024/978544611024_p.pdf">Excerpt</a> <br><br>  For Habrozhiteley 25% coupon discount - <b>Elasticsearch</b> <br><br>  Upon payment of the paper version of the book, an electronic version of the book is sent to the e-mail. </div><p>Source: <a href="https://habr.com/ru/post/451750/">https://habr.com/ru/post/451750/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451726/index.html">Looking for a job abroad: 7 simple tips for IT specialists</a></li>
<li><a href="../451738/index.html">A brief review of the article "DeViSE: A Deep Visual-Semantic Embedding Model"</a></li>
<li><a href="../451742/index.html">One day to DotNext 2019 Piter. Announcement of free broadcast</a></li>
<li><a href="../451746/index.html">MegaSlerm for Kubernetes engineers and architects</a></li>
<li><a href="../451748/index.html">SSD state monitoring in Qsan arrays</a></li>
<li><a href="../451752/index.html">30th anniversary of rampant insecurity</a></li>
<li><a href="../451758/index.html">Additional Uplinks in the Intel C620 system logic architecture</a></li>
<li><a href="../451760/index.html">Using Golang to create microservices in The Economist: a retrospective</a></li>
<li><a href="../451766/index.html">Heisenbug 2019 Piter: what will be in the free broadcast, and that only at the event itself</a></li>
<li><a href="../451768/index.html">Improving the work of Wi-Fi. General principles and useful things</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>