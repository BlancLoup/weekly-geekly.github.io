<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to find a smoker by cardiogram using artificial neural networks (and why it is needed)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On Habr√© already wrote about the scientific competition for mathematicians and developers, which launched the creators of the mobile cardiograph Cardi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to find a smoker by cardiogram using artificial neural networks (and why it is needed)</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://geektimes.ru/post/273564/"><img src="https://habrastorage.org/files/d2f/197/73c/d2f19773cfe84d009985431836b5a33e.jpg"></a> <br><br>  On Habr√© already wrote about the <a href="https://habrahabr.ru/post/277287/">scientific competition</a> for mathematicians and developers, which <a href="http://cardioqvark.ru/challenge/">launched the</a> creators of the mobile cardiograph CardioQVARK.  In short, the essence of the competition is to create an algorithm that could detect a smoker among non-smokers based on their cardiograms. <br><br>  One of the competition leaders was Ph.D.  Roman Isakov, Associate Professor of the Department of Biomedical and Electronic Means and Technologies of the Institute of Innovative Technologies, Vladimir AG State University, Vladimir  and N.G.  Stoletovs.  He developed a method for determining a smoker based on RR-intervalograms and artificial neural networks - we'll talk about him today. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Why look for a smoker </h4><br>  There are studies of specialists in machine learning, which show that the ECG signal carries information about the functioning of all body systems, not just the heart.  In addition, each disease in its own way ‚Äúmodulates‚Äù the ECG signal, and therefore the signs of increments of intervals and amplitudes of successive cardiocycles can be used to diagnose information about possible health problems in humans, including in the early stages of their occurrence. <br><br><img src="https://habrastorage.org/files/d90/7ca/347/d907ca34710944068c87530e3dbc33d6.png" alt="image"><br><br>  <i>The <a href="http://www.machinelearning.ru/wiki/images/9/9a/Voron-2014-10-20-ecg.pdf">report</a> at the V International Conference "Mathematical Biology and Bioinformatics" Konstantin Vorontsov from the Computer Center to them.</i>  <i>A. A. Dorodnitsyna RAS showed differences in the signs of the increment intervals (dRn), amplitudes (dTn) and angles (dŒ±n) of cardiocycles in healthy and suffering from various diseases of people</i> <br><br>  The search for a smoker by cardiogram will help to achieve the main goal of the competition - to obtain a result that would demonstrate the possibility or impossibility of implementing high-quality diagnostics using an ECG and detection algorithms for a cardiogram signal of disease markers of various organs. <br><br><h4>  The essence of the proposed method </h4><br>  The solution of the problem was based on the hypothesis about the dependence of heart rate variability (HRV) on the functional state of the body [R.M.Baevsky and others.] This model includes feedback through the brain through the peripheral nervous system, allowing to control blood flow, including including by dynamically controlling the heart rate. <br><br>  On this basis, the RR intervalogram was chosen as the main signal for analysis.  This signal contains all the information about the processes of controlling the rhythm of the heart in its final manifestation. <br><br>  The problem in extracting information about the effects of nicotine and other substances on the human body comes down to finding the parameters of HRV, which have the greatest separating ability of the classes of smokers and non-smokers.  Considering that the nature of the interrelation of parameters can be non-linear, the classifier was based on the technology of artificial neural networks. <br><br>  The training cardiogram sample for the competition included 100 records of smokers and non-smokers with a ratio of 50/50%.  A control choice was also presented, which included 250 cardiograms - no annotations were presented in it, so it was impossible to use it for research. <br><br>  Therefore, the researcher needed to divide the training set into two equal ‚Äúsubsamples‚Äù: training and test. <br><br>  The selection of records in the test and training subsamples was carried out in an arbitrary manner, but with the observance of the condition of an equal ratio of smokers and non-smokers in each of them.  Since the number of records in the training subsample turned out to be too small, then at the final stage after choosing the best model, we also had to take it by ‚Äúcompleting training‚Äù on the records of the test subsample. <br><br><h4>  Not so simple </h4><br>  To minimize the phenomenon of retraining from the data set used to <br>  learning, allocated local validation set (20%) in random order.  He did not participate in the adjustment of the model parameters and served to monitor the model error.  As the error on the validation kit increased, the training stopped. <br><br>  There is a likelihood that people who have hidden this fact or passive smokers fall into the class ‚Äúdo not smoke‚Äù, and people who have little ‚Äúexperience‚Äù of smoking are in the ‚Äúsmoke‚Äù class.  Therefore, one of the studies was made with a modification of the training database based on neural network analysis of the sample using the best of the obtained models.  As a result, those records were modified whose discrepancy with the model was the largest.  This approach showed a slight increase in efficiency on an independent (validation) sample.  However, it can be assumed that it also contains erroneous labels, which is a limiting factor. <br><br><h4>  Data processing and analysis </h4><br>  In order to form the feature space for a smoking person recognition model, the researcher studied various known statistical parameters, special parameters for assessing heart rate variability, as well as the spectrum and histogram of heart rhythm. <br><br>  The parameters were divided into the following groups: <br><br><ol><li>  Entropy; </li><li>  Parameters of the time domain; </li><li>  Frequency domain parameters; </li><li>  The parameters of the form of the histogram. </li></ol><br><br>  The study consisted in calculating the entire set of parameters for classes of smokers and non-smokers in the records of the training base and the subsequent joint analysis of their distributions.  Only those parameters were selected, the distribution density of which had significant differences in any area. <br><br>  Additionally, the heart rhythm spectra were studied, the frequency ranges in which the greatest separation of the two classes was observed was selected.  Then, a cross-correlation analysis of the selected parameters was performed to exclude strong linear connections in the feature space. <br><br>  In the description of the competitive decision, the researcher notes that parallel studies of a set of parameters were carried out without optimization by correlation analysis and using readings of the heart rhythm spectrum.  The results of the data in the solution are not given, because they did not show the best results. <br><br>  As a result, the following set of parameters was obtained: <br><br>  1) EnLog - Entropy of "logarithmic energy" (Log Energy Entropy); <br>  2) EnTrs - Threshold Entropy; <br>  3,4) EnSamp - Two sample entropies (Sample Entropy) with parameter 1 and 5; <br>  5) NN22 - The number of consecutive RR-intervals, differing by more than 22 ms; <br>  6) HRVTi - Triangular index of the heart rate histogram; <br>  7) LF / HF - The ratio of the power of the low-frequency to the high-frequency part of the spectrum (the standard parameter for estimating HRV); <br>  8) LFn - The ratio of the power of the low-frequency part of the spectrum to the sum of the powers of the low-frequency and high-frequency parts of the spectrum; <br>  9) SBxn (4) - The ratio of the power of the spectrum in the range from 0.093 Hz to 0.125 Hz to the total power of the spectrum (TR).  This parameter was obtained as a result of a special spectral analysis; <br>  10) SB1n - Spectrum power in the range from 0.0039 Hz to 0.0391 Hz.  This parameter was obtained as a result of a special spectral analysis. <br><br>  The data processing algorithm can be described step by step as follows: <br><br>  In the first step, the cardiointervalogram (CIG) is loaded.  Then, using cut-off at level 1 of the MSE, emissions are determined.  Further, they are eliminated using median interpolation; TIG spline interpolation is performed to obtain an equidistant quantized rhythmogram (RG) signal. <br><br>  To remove the constant component, an average value was subtracted from the rhythmogram, after which it was processed by the T√ºrks window to suppress the Gibbs effect.  Subsequently, a fast Fourier transform was performed for the processed rhythmogram, and by calculating the absolute value of the complex values ‚Äã‚Äãof this transformation, it was possible to obtain a spectrum of the heart rhythm. <br><br>  The above parameters were calculated using CIG (except spectral parameters), and then they were normalized to obtain a dynamic range from 0 to 1. <br><br>  The model was obtained as follows: <br><br>  At first, perceptron neural networks (NS) were trained with a successively increasing number of neurons in hidden layers (according to the previously described method).  The result is a set of neural network models of different sizes, allowing you to select the optimal size of the neural network. <br><br>  Next, we analyzed the set of NA on the test subsample and from it by the parameter AUC you <br>  The best were taken. <br><br>  The third step was to adjust the cut-off threshold of the selected models using ROC analysis by balancing the Sensitivity and Specificity to obtain their minimum difference.  Sensitivity or Specificity values ‚Äã‚Äãof less than 50% were discarded. <br><br>  According to this method, the following NA structures were investigated: <br><br><ol><li>  bilayer, with one hidden sigmoid layer and sigmoidal exit (SS); </li><li>  three-layer with two hidden tapering sigmoidal layers and sigmoidal output (SSdS); </li><li>  three-layer with two hidden tapering sigmoidal layers and linear output (SSdP). </li></ol><br><h4>  results </h4><br>  From the test results it can be seen that, on average, the efficiency indicators of the classifier are in the region of 60-70%. <br><br>  At the same time, the researcher notes that the training and test samples provided for the competition contained erroneous labels.  This reduces the efficiency of the models proposed by him, which means that using ‚Äúpure‚Äù data one can expect an increase in the efficiency of the created classifier. <br><br>  In addition, according to the author of the study, an increase in the size of the training database can also play a positive role. <br><br>  On an independent sample of data, the researcher managed to achieve Sensitivity indicators at the level of 63% and Specificity at the level of 71%. <br><br>  The result of the work carried out in the framework of a scientific competition demonstrates the presence of a theoretical and experimentally confirmed connection between heart rate variability and functional changes in the body associated with smoking. </div><p>Source: <a href="https://habr.com/ru/post/392425/">https://habr.com/ru/post/392425/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../392415/index.html">Apple has filed a patent application for smart straps for Apple Watch</a></li>
<li><a href="../392417/index.html">Uganda criminalizes non-vaccination of children</a></li>
<li><a href="../392419/index.html">Implementation of robotic tasks on the KUKA youBot platform, part 1</a></li>
<li><a href="../392421/index.html">DJI quadcopters from AliExpress on April 1 - a joke?</a></li>
<li><a href="../392423/index.html">Space photos of the week</a></li>
<li><a href="../392427/index.html">Radio communication with robots improves closer to full moon</a></li>
<li><a href="../392429/index.html">MSI Nightblade MI bully night</a></li>
<li><a href="../392431/index.html">Almost the whole truth about the battery DJI Phantom 3</a></li>
<li><a href="../392433/index.html">Invisible Hand: How Mysterious Traders Arrange the Ups and Downs of Stock Markets</a></li>
<li><a href="../392435/index.html">Division by zero or a clear example of why internal interrupts in the kernel are needed</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>