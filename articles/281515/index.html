<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to determine the best time for a transaction in the stock market: Trend following algorithms</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Over the years, stock market participants have been trying to develop ways to predict future price movements. To do this, use special algorithms and s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to determine the best time for a transaction in the stock market: Trend following algorithms</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/itinvest/blog/281515/"><img src="https://habrastorage.org/files/dc8/ba1/05b/dc8ba105b7d94da485037960ed6f85af.png"></a> <br><br>  Over the years, stock market participants have been trying to develop ways to predict future price movements.  To do this, use special <a href="https://habrahabr.ru/company/itinvest/blog/274821/">algorithms</a> and <a href="http://www.itinvest.ru/software/download/">software</a> , <a href="https://habrahabr.ru/company/itinvest/blog/275825/">machine learning,</a> or even external services like <a href="https://habrahabr.ru/company/itinvest/blog/279021/">Google Trends</a> .  To date, there is no technology to create forecasts, which would be 100% effective. <br><br>  Researchers from the University of Macau a few years ago published a <a href="http://www.jetwi.us/uploadfile/2014/1223/20141223120018209.pdf">paper</a> on the analysis of the effectiveness of trend-following algorithms, which do not attempt to predict price changes, but rather react to its changes in real time.  We bring to your attention the main thoughts of this study. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Introduction </h4><br>  In general, there are two main approaches to estimating the probability of making such forecasts.  The followers of the first of them believe that the market can be predicted by analyzing patterns of price behavior, and the accuracy of the forecast depends on the correct method of detecting these patterns, as well as using the correct set of parameters.  The second approach assumes that the stock market is completely random, and it cannot be predicted using mathematical formulas (there is also <a href="https://habrahabr.ru/company/itinvest/blog/280954/">mathematical evidence</a> that this is not the case). <br><br>  At the junction of these two "schools" was born the method of following the trend.  He suggests that market trends are some random variables.  Accordingly, one should not even try to make any forecasts, one only needs to generate buy and sell signals using the analysis of price movements in the long term.  This method is widely used in financial markets, where traders use them to determine the moment of opening or closing positions for currency pairs, but it is not widely used in the stock market. <br><br>  In today's article we will discuss two types of trend following algorithms.  The researchers aimed to analyze the effectiveness of the application of these algorithms. <br><br><h4>  Two ways to analyze the market </h4><br><br>  There are two methods for predicting stock prices: <br><br><ul><li>  <b>Fundamental analysis</b> - in this case, analysts evaluate information that is more relevant to the company, whose shares are traded on the stock exchange, rather than to the shares themselves.  Decisions on certain actions on the market are made based on an analysis of the company's previous activities, revenue and profit forecasts, and so on. </li><li>  <b>Technical analysis</b> - in this case, the behavior of the stock price is examined and its various patterns are identified (time series analysis is used). </li></ul><br>  Many of the methods for predicting prices on the stock market that we considered earlier are in the field of technical analysis.  Among the financiers and scientists, there are heated debates about whether it is possible, using the analysis of past prices, to predict their future movement. <br><br>  The method of following the trend here is an alternative - it does not mean creating forecasts and only responds only to events that happened quite recently or are happening right now, without thinking about the future.  At the same time, trade is subject to certain statistical rules - and the main task is to formulate them. <br><br><h4>  Trend following: basic principles </h4><br>  The success or failure of the trend following algorithm depends on what assumptions lie at its core.  First of all, this assumption is the regular occurrence of price trends, which are the result of many factors.  The second important point is the ability of the algorithm to benefit from price movements that form trends. <br><br>  All traders tend to "limit loss" and "maximize profits" - most of all you can earn, synchronized with a powerful trend.  And in order to do this, the trader needs to throw aside the emotional part of the trade (‚Äúintuition‚Äù) - the method of following the trend does not imply guessing the moment of its completion.  On the contrary, it is necessary to act immediately after the onset of this moment. <br><br>  Based on this, the Model Performance Probability Score (PPS) was developed - it combines the analysis of price behavior to create an assessment of risk and possible profit.  The core of the model forms a binary separation of price behavior into negative and positive.  The basic rule for trading according to this method sounds like holding a positive or negative rating until the moment when a definite change occurs - again, no predictions, just a reaction to change. <br><br><img src="https://habrastorage.org/files/cfd/cae/282/cfdcae2820f74fd3841ec000aa26fee7.png"><br><br>  <i>The distribution of price power by trend</i> <br><br><h4>  How to determine the right time for the transaction </h4><br>  Price changes in the stock market represent an opportunity to increase profits from a transaction or reduce losses in the event of a failed set of circumstances.  When a price change is detected that goes against the established trend, a choice arises between immediately closing the position or waiting for confirmation of the current trend reversal and re-entering the position in accordance with the new trend.  To automate the process of making such decisions, several important aspects need to be considered. <br><br><ul><li>  <b>Managing transactions</b> - the decision on how much financial asset to buy or sell, must be made on the basis of certain rules.  To minimize risks, for example, the volume of transactions may decrease in a period of high volatility or a falling market.  The purpose of this is simple - to reduce losses in unsuccessful periods in anticipation of the emergence of more positive trends. </li><li>  <b>Market price</b> - the system can use only the market price as input.  Some data can be gleaned from the history of trading, but they cannot be used to predict the direction of price changes.  To create a trading system using the trend following algorithm, you only need to get the most recent data from the latest quotes.  Time and price are the main elements. </li><li>  <b>Rules</b> - as mentioned above, you need to limit losses and maximize profits.  To do this, within the framework of a trend following system, rules are needed that will not take into account fundamental indicators.  They should only automate trading by making decisions about the moment of entry into the market, the time it takes to hold a position, and the moment it exits the position when it stops being profitable. </li></ul><br>  Based on the PPS model, researchers have developed a new approach to the implementation of such a trading system.  It operates on the basis of two signals extracted from the price trend - on the basis of this information, decisions are made on opening and closing positions. <br><br><h4>  P and Q rules </h4><br>  The rules described above for limiting losses and maximizing profit in this case are based on two variables - P and Q. The first one is used to determine when to open a position, and the second one - to exit it.  If we denote the market trend as T, which is a function of time t - Price (t). <br><br>  In this case, the system could open a position when the current Price price turns out to be on a trend above point P, and on the contrary, when it drops below Q level, the position will be closed: <br><br><img src="https://habrastorage.org/files/14a/315/1ad/14a3151ad77a432f894e3ed84f181e83.png"><br><br>  In real life, however, trends do not develop along such clear lines, they are much more volatile, and the price can be briefly raised and lowered below the general trend line.  Therefore, the rules P and Q cannot be applied directly to the trend T - frequent price fluctuations will lead to the emergence of a huge number of trading signals to buy and sell.  In order to avoid this, an exponential moving average (EMA) is used, which is calculated by the formula: <br><br><img src="https://habrastorage.org/files/983/a74/a9d/983a74a9d82249219d4c2152634ff2b5.png"><br><br>  Where price (t) is the current price at time t, n is the number of periods in minutes for intraday trading or in days for off-market trading, and t is the time point in the market.  The logic of using P and Q rules and EMA is described by the following pseudocode: <br><br><img src="https://habrastorage.org/files/326/c7d/1c3/326c7d1c375f45ed8d82e6cbe343e422.png"><br><br>  In this case, the values ‚Äã‚Äãof P and Q are calculated on the basis of historical data.  There are several ways to define them.  The first of these is the bruteforce method, which involves testing a variety of P and Q combinations. An alternative method is to use neural networks. <br><br><img src="https://habrastorage.org/files/f66/34f/fc1/f6634ffc169145a2aea3cef95632bbde.png"><br><br>  <i>The ranges of P and Q values ‚Äã‚Äãobtained using heuristic measurements</i> <br><br><img src="https://habrastorage.org/files/ccb/790/3fb/ccb7903fb8284d3fbcfbebd3981c31c6.png"><br><br>  <i>You can choose different values ‚Äã‚Äãof P and Q, which will generate positive results.</i> <br><br><h4>  Adaptive rules P and Q </h4><br>  In the previous section, the values ‚Äã‚Äãof P and Q were obtained by analyzing the values ‚Äã‚Äãthat give the best results over a relatively long time interval.  However, it is obvious that the rules that worked well on a certain part of the trend may not be so good on another.  This means that the process of choosing P and Q must be modified so that they can be selected dynamically. <br><br>  The new rules are called P 'and Q' - their values ‚Äã‚Äãcan change dynamically, and do not remain unchanged, as it was before.  To determine the moments of entry and exit from the position in this case, you can use some technical analysis tools, such as <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BD%25D0%25B4%25D0%25B5%25D0%25BA%25D1%2581_%25D0%25BE%25D1%2582%25D0%25BD%25D0%25BE%25D1%2581%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B9_%25D1%2581%25D0%25B8%25D0%25BB%25D1%258B">the relative strength index</a> (RSI).  It is calculated by the following formula: <br><br><img src="https://habrastorage.org/files/0d7/df0/166/0d7df0166a21475baa3f98035cc9b237.png"><br><br>  Where AU is the average price increase for n periods, AD is the average price decrease for n periods, n is the number of RSI periods (usually set to 14). <br><br>  A simple example of use.  In the figure below, the RSI has a range from 0 to 100. An asset is considered ‚Äúoverbought‚Äù above level 70 - this means that it can be overvalued and is a good candidate for a price drop.  Similarly, if the RSI reaches level 30, then this is a sure sign of an undervalued asset. <br><br><img src="https://habrastorage.org/files/9e4/7b9/229/9e47b922930043358493a97f4be8f0d0.png"><br><br>  As a result, using RSI and P &amp; Q adaptive strategy, we can formulate the following rules for opening positions: <br><br>  To open a long position in P ': <br><br><ol><li>  The price is rising </li><li>  RSI (t) is greater than EMA (RSI (t)) </li><li>  EMA (RSI (t)) less than 40 or above 60 </li></ol><br>  For a short Q position: <br><br><ol><li>  The price is going down </li><li>  RSI (t) is less than EMA (RSI (t)) </li><li>  EMA (RSI (t)) is less than 40 or above 60 </li></ol><br>  The figure below shows an example of opening a long position: at 10:35 it was opened after the relevant conditions were met.  At 13:36, the criterion for opening a short position worked, and the long position was closed. <br><br><img src="https://habrastorage.org/files/ab5/bf3/78c/ab5bf378cf824411b622b101095fa8d3.png"><br><br>  The values ‚Äã‚Äãof P 'and Q' adaptively and dynamically change according to RSI readings.  In the course of trading, the strategy evaluates the fluctuations of the trends and in accordance with them generates signals to buy or sell. <br><br>  The pseudocode for such a strategy is as follows: <br><br><img src="https://habrastorage.org/files/f5a/451/e99/f5a451e99bc84aa6a7d530cea06051c8.png"><br><br><h4>  Simulation and results </h4><br>  During the experiment, designed to confirm or deny the performance of the proposed strategy, the researchers launched a simulation to analyze the futures contract on the Hong Kong Stock Exchange index (Hang Seng).  Analyzed historical data for 2008, only 355 days.  The challenge was to calculate the ROI (return on investment) for trading specific stocks. <br><br>  The figure below shows the performance of a static and dynamic P &amp; Q strategy: <br><br><img src="https://habrastorage.org/files/a49/989/0bf/a499890bf7fd47bd8bed7c233863abbb.png"><br><br>  According to the data obtained, the adaptive strategy shows the best results - in the course of the simulation, the average monthly ROI in this case was 75.63%, and for the static strategy - 67.67%. <br><br><img src="https://habrastorage.org/files/ab0/c80/5d6/ab0c805d6cb1474db4a0bd451ff9fd79.png"><br><br>  In addition, the researchers wanted to know how to minimize losses in case of their occurrence.  According to the experiment, the probability of losses when using strategies to follow a trend increases with high market volatility.  In order to confirm this hypothesis, a simulation of the occurrence of random fluctuations in the market was organized. <br><br>  According to the results, automated trend following strategies began to work at a loss when the fluctuation rate reached 45%.  This means that it is possible to reduce the probability of losses by programming a certain fluctuation threshold into the system, upon reaching which the trade must be stopped. </div><p>Source: <a href="https://habr.com/ru/post/281515/">https://habr.com/ru/post/281515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../281503/index.html">Interfaces: How not to do the option of unsubscribing from the email-list</a></li>
<li><a href="../281505/index.html">How we implemented DevOps: infrastructure-as-code using Microsoft Azure and Azure Resource Manager</a></li>
<li><a href="../281509/index.html">5G core networks: flexibility opens up new business opportunities</a></li>
<li><a href="../281511/index.html">// BUILD / 2016: how it was</a></li>
<li><a href="../281513/index.html">What we lack in java</a></li>
<li><a href="../281517/index.html">How to write a bloom filter in C ++</a></li>
<li><a href="../281519/index.html">More than 80 Linux system monitoring tools</a></li>
<li><a href="../281521/index.html">What's new in Vim 8</a></li>
<li><a href="../281523/index.html">Develop HTML5 games in Intel XDK. Part 3. Meet the Snake</a></li>
<li><a href="../281525/index.html">Junior FPGA Design Engineer: how to become?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>