<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hacker found a way to track visitors to competitor sites</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A simple script changes the behavior of the Back button in the browser and replaces the original search results, directing users to hacker-controlled ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hacker found a way to track visitors to competitor sites</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ow/qx/vl/owqxvl_k9g6gcoakh3edd3duvoo.png"><br><br>  <i><font color="gray">A simple script changes the behavior of the Back button in the browser and replaces the original search results, directing users to hacker-controlled copies of competitors' sites.</font></i> <br><br>  Common pattern: open the Google search page and click on different results to find the necessary information.  You can open dozens of individual tabs or go to each site in turn, then return to the search results (the <i>Back</i> button in the browser).  Dan Petrovich, a specialist in search engine optimization from Australian company Dejan Marketing, <a href="https://dejanseo.com.au/competitor-hack/">figured</a> out how to exploit this pattern to his advantage and to get extensive statistics on visits to competitors' sites, depriving them of traffic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The diagram is shown in the illustration above.  Intercepting the traffic of competitors, the specialist can: <br><br><ul><li>  generate heat maps of other sites (clicks, transitions, scroll depth) </li><li>  record real sessions (mouse movements, keystrokes) </li><li>  receive all the text from the filled-in forms, including the forms for ordering goods </li></ul><a name="habracut"></a><br>  Of course, Dan Petrovich did not do any of the above, because it is a clear violation of the law.  Probably, an alternative way of studying competitors' sites, without faking search results, and using the usual cloning of someone else's site - and buying traffic through social media, etc., will be against the law. <br><br>  The bug in browsers is still not closed, so other attackers can use this method: JavaScript code to exploit the vulnerability is published in the public domain.  Actually, it is easy to write such a script yourself, knowing the functionality of the <code>history.pushState()</code> method for changing the browser history taking into account the referrer. <br><br>  Dan Petrovich notes that he first used this trick <a href="https://dejanseo.com.au/hijack/">in November 2012</a> .  Then, instead of closing the vulnerability, Google manually <a href="https://dejanseo.com.au/google-against-content-scrapers/">lowered its page in search results</a> (the page from which it was redirected to fake search results using the <i>Back</i> button).  Now, when he re-demonstrated this method, Google acted even harder.  Without any notification in the Search Console, his <b>site was removed from the search index entirely</b> . <br><br>  The hacker admits that in the information security community it is customary to handle the vulnerabilities found differently.  They are first reported to the developers and are awaiting bug fixes, and only after the fact they tell about it.  Professional pentesters <a href="https://news.ycombinator.com/item%3Fid%3D17826106">explained in detail to the author</a> how he was supposed to demonstrate this vulnerability in a safe way.  But Petrovich acted differently - he showed the scheme on real sites and immediately told everyone.  In addition, there are big doubts about the legality of such a hack, even without real surveillance of users, that is, the legality of creating fake copies of other sites and redirecting users there.  But over the years, none of the competitors have filed lawsuits, like Google (which is also affected by the fake search results).  This is a full-fledged phishing, albeit for demonstration purposes and without malicious intent.  That is, the ethical actions of the SEO specialist are questionable. <br><br>  But the fact remains: over the years, the <i>Back</i> button in the browser is still vulnerable to manipulation.  According to Petrovich, other sites also use this technique to spy on visitors on competitors' sites.  He thinks that Google shouldn‚Äôt exclude his site from the search index, but rather hold a series of events for this old trick to stop working: <br><br><ol><li>  Eliminate the ability to manipulate the <i>Back</i> button in Chrome. </li><li>  Automatically downgrading sites that use this trick (and not manually fining him alone).  At the moment, Google does not notice these scripts: Petrovich‚Äôs experiment went unnoticed for <b>five years</b> and his website ranked high in search results. </li><li>  Mark pages with <code>history.pushState()</code> and search results as ‚Äúdangerous‚Äù. </li></ol><br>  <a href="http://www.globalsign.com/ru-ru/ssl/%3Futm_source%3Dhabrahabr%26utm_medium%3Darticle%26utm_campaign%3DSSL">SSL phrases</a> that are linked to the organization (OV) and with extended verification (EV) partially protect against such phishing, but this is still not a panacea for users inattention. <br><br>  The experiment of Dan Petrovich showed that now about 50% of users do not find anything suspicious when they are redirected to a fake search results, and then to a copy of another site in the local domain.  Many users do not check who owns the certificate and do not read the URL - they are just happy that the browser has a secure connection icon, although it is issued for someone else‚Äôs domain.  Attackers have long figured out that a <a href="https://habr.com/post/357308/">secure connection icon increases confidence in a phishing site</a> . <br><br>  To solve this problem, you can take a number of measures, for example: <br><br><ul><li>  Require user to confirm that <code>history.pushState</code> and <code>History#replaceState</code> . </li><li>  Highlight the most important part of the URL in the Chrome address bar, as Firefox does. </li><li>  <a href="https://habr.com/company/globalsign/blog/349428/">Do not mark HTTPS sites as ‚Äúsecure‚Äù</a> because it misleads the user and gives a false sense of security. </li><li>  Change the icon of the <i>Back</i> button if it leads to a different address from the previous page. </li></ul><br><br><hr><br> <a href="https://clck.ru/EFgck"><img src="https://habrastorage.org/webt/yd/bw/sj/ydbwsjh6ghvlmwdbmxb9rks53bq.jpeg"></a> </div><p>Source: <a href="https://habr.com/ru/post/421501/">https://habr.com/ru/post/421501/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../421491/index.html">How to write a game for a computer that has no input and output devices</a></li>
<li><a href="../421493/index.html">Analysis of the network traffic of a mobile application on iOS. Part 1 - Proxy</a></li>
<li><a href="../421495/index.html">Welcome to the era of privacy nihilism</a></li>
<li><a href="../421497/index.html">When it is not necessary to use algorithms from STL</a></li>
<li><a href="../421499/index.html">Investigation of the statistical probability of a bit in non-bitcoin</a></li>
<li><a href="../421503/index.html">How to write instructions so that you understand</a></li>
<li><a href="../421505/index.html">Mini-life hacking on working with Yandex.Direct</a></li>
<li><a href="../421507/index.html">What were the welders for optics</a></li>
<li><a href="../421513/index.html">Smooth introduction of scram by the developers themselves (resolving contradictions, setting up a team, avoiding conflicts)</a></li>
<li><a href="../421515/index.html">Yandex has three days to remove pirated links, otherwise Roskomnadzor will block Yandex.Video service.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>