<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Error in Delone condition test formula</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 On an early Sunday morning, I was already at my third day debugging a program to triangulate the result of a laser scan. A laser scan i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Error in Delone condition test formula</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  On an early Sunday morning, I was already at my third day debugging a program to triangulate the result of a laser scan.  A laser scan is a collection of three-dimensional points.  As a result of the program, you need to merge points into disjoint polygons, thus creating a surface model.  I recounted the function after function on a piece of paper and finally reached the function of checking the fulfillment of <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D1%2580%25D0%25B8%25D0%25B0%25D0%25BD%25D0%25B3%25D1%2583%25D0%25BB%25D1%258F%25D1%2586%25D0%25B8%25D1%258F_%25D0%2594%25D0%25B5%25D0%25BB%25D0%25BE%25D0%25BD%25D0%25B5">the Delaunay condition</a> .  Apparently, the error lurked somewhere in it.  A detailed analysis turned out that the formula, indicated in a huge number of books about Delone's triangulation, does not always give the correct result.  Details under the cut. <br><br><img src="https://habrastorage.org/files/3f4/1ff/31f/3f41ff31f11b44ad9871373512a6eb80.jpg"><br><a name="habracut"></a><br><h4>  Delone condition </h4><br>  I'll tell you briefly about the Delone condition itself.  By the way, I drew all the information from the wonderful book AV  Skvortsova <a href="http://e-maxx.ru/bookz/files/skvortsov.pdf">"Delone Triangulation and its application</a> . <a href="http://e-maxx.ru/bookz/files/skvortsov.pdf">"</a>  It is said that triangulation satisfies the Delone condition if not one of the given triangulation points falls inside the circle described around any triangle constructed.  The fulfillment of this condition is necessary in order to maximize the sum of the minimum angles of all triangles of the triangulation.  Simply put, the triangles are not oblate. <br><br>  The author offers 2 ways to check the condition of Delone with the possibility of optimization for each of them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first method is the most obvious.  He proposes to calculate the center and radius of the circumscribed circle and directly check the belonging of the vertices of the neighboring triangles.  As an optimization, it is proposed to store the calculated circumscribed circles in the class of a triangle.  Non-optimized verification requires 29 multiplication and division operations and 24 addition and subtraction operations.  The complexity of the optimized verification depends on the triangulation algorithm. <br><br>  The second way is more interesting.  He argues that to test the condition, it is enough that for any neighboring triangle, the sum of the opposite angles does not exceed PI ( <img src="https://habrastorage.org/files/939/49e/3a7/93949e3a7718418baeb03d5968094052.gif">  ), which is equivalent to the condition: <img src="https://habrastorage.org/files/79c/758/9ad/79c7589ad4f04970bc6b1fbf0b276195.gif">  . <br><img src="https://habrastorage.org/files/5b5/a44/387/5b5a4438721c43449f1b9bfa24218a90.png"><br>  Further, after coercions and transformations, a rather scary formula is obtained: <img src="https://habrastorage.org/files/90c/586/343/90c5863433f34c46a0fcd8274f89ef25.gif"><br>  The formula corresponds to the sine of the sum: <img src="https://habrastorage.org/files/c44/5a0/7a1/c445a07a1c814d85a688840c2cc651d7.gif">  where cosines and sines are expressed in terms of scalar and pseudoscalar products, respectively.  In the formulas, the product of vector lengths is omitted (apparently because it does not affect the sign of the expression). <br><br>  As an optimization, it is proposed to first calculate the cosine signs.  If a <img src="https://habrastorage.org/files/b13/acc/788/b13acc7882634b07b4ea4f931d1b0255.gif">  and <img src="https://habrastorage.org/files/abd/9af/59c/abd9af59c70e47c5a031768738a050a7.gif">  means <img src="https://habrastorage.org/files/7ef/1f9/6f8/7ef1f96f835849ffbb631542f2162901.gif">  and <img src="https://habrastorage.org/files/5cb/701/852/5cb701852d2042a196d321361a7f1b5a.gif">  those.  Delone condition is satisfied.  If a <img src="https://habrastorage.org/files/255/f10/f16/255f10f16e0b4b1d8ea50dbd936fc365.gif">  and <img src="https://habrastorage.org/files/79e/8b6/e81/79e8b6e8146c492d8500072956be5e95.gif">  means <img src="https://habrastorage.org/files/30d/436/986/30d43698649540b0b3de8d97f90d77e3.gif">  and <img src="https://habrastorage.org/files/2f8/1ef/925/2f81ef9252ae4c998f68ee02ae2e8c1f.gif">  condition is not satisfied.  Otherwise, you should perform a check on the full formula. <br><br>  Checks on the full condition requires 10 multiplication / division operations and 13 addition / subtraction operations.  The optimized check, according to the author of the book, requires approximately 7 multiplication / division operations and 9 addition / subtraction operations. <br><br>  After reading this information, I made a logical conclusion that the latter method is more optimal than the others and began to use it.  As they say, nothing foreshadowed trouble. <br><br><h4>  Underwater rocks </h4><br>  During debugging, I began to notice the inadequate behavior of the function checking condition Delaunay.  The problem turned out to be that the sine sign depends on the order of enumeration of the vertices.  Thus, due to the sine sign, the sign of the whole expression changes.  Maybe I do not understand something, I will be glad if someone corrects me. <br><br>  The first and only way to correct the situation that occurred to me is to take the expression of a sine modulo.  Thus, the sine shows only the magnitude of the angle, and not the direction of the sweep, which is our advantage. <br><br><h4>  Conclusion </h4><br>  It is very surprising for me that this formula is indicated in a huge number of books.  What does this mean not only Russian-language literature, but <a href="http://www.researchgate.net/publication/222469607_A_fast_algorithm_for_constructing_Delaunay_triangulations_in_the_plane">here is a</a> publication in which the same information is indicated. <br><br>  I am not a great expert in mathematics, so I expect from the community adequate criticism and suggestions.  Ready for discussion. <br><br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/252925/">https://habr.com/ru/post/252925/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../252915/index.html">Convenient monitoring of Syslog messages from network glands in Zabbix</a></li>
<li><a href="../252917/index.html">Mikrotik: configuring IPsec to automatically update the VPN server address</a></li>
<li><a href="../252919/index.html">Connect to Intel Edison via Android with Bluetooth LE (BLE)</a></li>
<li><a href="../252921/index.html">How it works: the architecture of the tile backing of Sputnik maps</a></li>
<li><a href="../252923/index.html">In search of a solution: how to become Mr. Wolfe?</a></li>
<li><a href="../252927/index.html">Device driver and what it eats</a></li>
<li><a href="../252929/index.html">Practical aspects of using DHCP relay + option82</a></li>
<li><a href="../252931/index.html">Network Management Basics in Microsoft Azure</a></li>
<li><a href="../252933/index.html">Blocking of forbidden resources of RKN by url including https</a></li>
<li><a href="../252937/index.html">Sound prints: radio advertising recognition</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>