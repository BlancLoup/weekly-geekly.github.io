<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The dream program of a novice pit driver</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Virtually any novice Python programmer is pathologically trying to write his own chat. And if also with the GUI, then this program is just the ultimat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The dream program of a novice pit driver</h1><div class="post__text post__text-html js-mediator-article">  Virtually any novice Python programmer is pathologically trying to write his own chat.  And if also with the GUI, then this program is just the ultimate dream. <br><a name="habracut"></a><br><h4>  Something like an introduction </h4><br>  To begin with, we will introduce in our task how much conventions - we are writing a chat for a local network with allowed UDP broadcast packets.  For the simplicity of solving the problem, we also decide that we will use the Tkinter library as a GUI ( <i>usually</i> in Linux distributions it comes out of the box, and it is standard in the official Python build for Windows). <br><br><h4>  Power up the network </h4><br>  Working with sockets in python does not depend on the platform (by and large, even under PyS60 we get a working network code, according to this example). <br><br>  For our chat, we decided to use UDP broadcast packets.  One of the reasons for their use was the ability to opt out of using the server.  It is necessary to accept one more convention in our program - the port number, and let it be equal to 11,719, firstly, this is a prime number (and this is already a lot).  And secondly, this port, according to official IANA information, is not busy. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's create a listening socket that will please the console with messages coming to it: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> socket s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="hljs-number"><span class="hljs-number">1</span></span>) s.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, <span class="hljs-number"><span class="hljs-number">1</span></span>) s.bind((<span class="hljs-string"><span class="hljs-string">'0.0.0.0'</span></span>,<span class="hljs-number"><span class="hljs-number">11719</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: message = s.recv(<span class="hljs-number"><span class="hljs-number">128</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (message)</code> </pre> <br><br>  At the socket, we set the properties of SO_REUSEADDR (allows several applications to ‚Äúlisten‚Äù to the socket) and SO_BROADCAST (indicates that the packets will be broadcast) in meaningful truths.  In fact, on some systems, the script can work without these lines, but it is still better to explicitly specify these properties. <br>  To wiretap, we connect to the address '0.0.0.0' - this means that in general all interfaces are heard.  You can specify in the field of the address and just empty quotes, but still it is better to explicitly specify the address. <br><br>  We will also create a broadcast messy network (to test the first program): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> socket sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) sock.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: sock.sendto(<span class="hljs-string"><span class="hljs-string">'broadcast!'</span></span>,(<span class="hljs-string"><span class="hljs-string">'255.255.255.255'</span></span>,<span class="hljs-number"><span class="hljs-number">11719</span></span>))</code> </pre><br><br>  With regard to the transmitting part, only the option SO_BROADCAST is necessary (but now it is mandatory on all platforms) and using the sendto () method we send our packets all over the network.  Stopping network flooding with CTRL + C, we‚Äôll proceed to the interface description. <br><br><h4>  Windows, windows, windows </h4><br>  Tkinter is probably one of the simplest libraries for organizing a window interface on python (and, according to the creator of python, it is one of the most reliable and stable).  But for a beginner pit-runner the main point is that this library is simple. <br><br>  And in order to get just the window of the size we need and with the specified header, we need only a few lines of code: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Tkinter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * tk=Tk() tk.title(<span class="hljs-string"><span class="hljs-string">'MegaChat'</span></span>) tk.geometry(<span class="hljs-string"><span class="hljs-string">'400x300'</span></span>) tk.mainloop()</code> </pre><br><br>  Everything would be fine, but we create, not a gallery of windows of different sizes, but a chat.  So, we also need elements on the window - a chat log, a field where we indicate our nickname and the text of the message that we enter.  You can do without the send button if our field for the message will automatically respond to pressing the Enter key. <br><br>  Solving a problem is easier than it seems.  For the chat log, you can use the Text widget, and for the other two Entry.  In order to place the elements on the form we use the automatic packer pack, which will be known only to him to arrange the elements, adhering only to the explicitly indicated instructions.  However, it can specify the side to which to attach the widgets, whether to expand them and in which direction, and some other layout parameters. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Tkinter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * tk=Tk() tk.title(<span class="hljs-string"><span class="hljs-string">'MegaChat'</span></span>) tk.geometry(<span class="hljs-string"><span class="hljs-string">'400x300'</span></span>) log = Text(tk) nick = Entry(tk) msg = Entry(tk) msg.pack(side=<span class="hljs-string"><span class="hljs-string">'bottom'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) nick.pack(side=<span class="hljs-string"><span class="hljs-string">'bottom'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) log.pack(side=<span class="hljs-string"><span class="hljs-string">'top'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'both'</span></span>,expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) tk.mainloop()</code> </pre><br><br>  And what about the interface connection with the program data?  Or how to make a procedure run in the background?  Well, Entry can be associated with StingVars (by specifying the textvariable property in the widget constructor).  and to run the background procedure, Tkinter has a after method (&lt;time in ms&gt;, &lt;function&gt;).  If at the end of the execution of this procedure specify its re-initialization, then the procedure will be performed continuously while the program is running. <br>  A few keystrokes and we get: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Tkinter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * tk=Tk() text=StringVar() name=StringVar() name.set(<span class="hljs-string"><span class="hljs-string">'HabrUser'</span></span>) text.set(<span class="hljs-string"><span class="hljs-string">''</span></span>) tk.title(<span class="hljs-string"><span class="hljs-string">'MegaChat'</span></span>) tk.geometry(<span class="hljs-string"><span class="hljs-string">'400x300'</span></span>) log = Text(tk) nick = Entry(tk, textvariable=name) msg = Entry(tk, textvariable=text) msg.pack(side=<span class="hljs-string"><span class="hljs-string">'bottom'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) nick.pack(side=<span class="hljs-string"><span class="hljs-string">'bottom'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) log.pack(side=<span class="hljs-string"><span class="hljs-string">'top'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'both'</span></span>,expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loopproc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">'Hello '</span></span>+ name.get() + <span class="hljs-string"><span class="hljs-string">'!'</span></span>) tk.after(<span class="hljs-number"><span class="hljs-number">1000</span></span>,loopproc) tk.after(<span class="hljs-number"><span class="hljs-number">1000</span></span>,loopproc) tk.mainloop()</code> </pre><br><br>  A greeting came running in the console.  Changing the nickname, we can make sure that the relationship between the Entry field and our variable works perfectly.  It's time to implement the ability of the user to send his message to the program by pressing Enter.  This is implemented even easier, using the bind method (&lt;action&gt;, &lt;function&gt;) of widgets.  The only thing we need to consider is that the function must accept the event parameter.  For one move from the console action in the log field.  We get: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Tkinter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * tk=Tk() text=StringVar() name=StringVar() name.set(<span class="hljs-string"><span class="hljs-string">'HabrUser'</span></span>) text.set(<span class="hljs-string"><span class="hljs-string">''</span></span>) tk.title(<span class="hljs-string"><span class="hljs-string">'MegaChat'</span></span>) tk.geometry(<span class="hljs-string"><span class="hljs-string">'400x300'</span></span>) log = Text(tk) nick = Entry(tk, textvariable=name) msg = Entry(tk, textvariable=text) msg.pack(side=<span class="hljs-string"><span class="hljs-string">'bottom'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) nick.pack(side=<span class="hljs-string"><span class="hljs-string">'bottom'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) log.pack(side=<span class="hljs-string"><span class="hljs-string">'top'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'both'</span></span>,expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loopproc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> log.insert (END,<span class="hljs-string"><span class="hljs-string">'Hello '</span></span>+ name.get() + <span class="hljs-string"><span class="hljs-string">'!\n'</span></span>) tk.after(<span class="hljs-number"><span class="hljs-number">1000</span></span>,loopproc) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendproc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span><span class="hljs-function">:</span></span> log.insert (END,name.get()+<span class="hljs-string"><span class="hljs-string">':'</span></span>+text.get()+<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) text.set(<span class="hljs-string"><span class="hljs-string">''</span></span>) msg.bind(<span class="hljs-string"><span class="hljs-string">'&lt;Return&gt;'</span></span>,sendproc) tk.after(<span class="hljs-number"><span class="hljs-number">1000</span></span>,loopproc) tk.mainloop()</code> </pre><br><br><h4>  Almost done... </h4><br>  And it seems that it remains to combine the programs from the first and second parts of the article and we will get a ready-made chat.  Well, let's try.  However, I will immediately say that we will not specifically display messages that we send - because when we listen to broadcast traffic, we will receive them anyway. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> socket <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Tkinter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * tk=Tk() s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="hljs-number"><span class="hljs-number">1</span></span>) s.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, <span class="hljs-number"><span class="hljs-number">1</span></span>) s.bind((<span class="hljs-string"><span class="hljs-string">'0.0.0.0'</span></span>,<span class="hljs-number"><span class="hljs-number">11719</span></span>)) sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) sock.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST,<span class="hljs-number"><span class="hljs-number">1</span></span>) text=StringVar() name=StringVar() name.set(<span class="hljs-string"><span class="hljs-string">'HabrUser'</span></span>) text.set(<span class="hljs-string"><span class="hljs-string">''</span></span>) tk.title(<span class="hljs-string"><span class="hljs-string">'MegaChat'</span></span>) tk.geometry(<span class="hljs-string"><span class="hljs-string">'400x300'</span></span>) log = Text(tk) nick = Entry(tk, textvariable=name) msg = Entry(tk, textvariable=text) msg.pack(side=<span class="hljs-string"><span class="hljs-string">'bottom'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) nick.pack(side=<span class="hljs-string"><span class="hljs-string">'bottom'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) log.pack(side=<span class="hljs-string"><span class="hljs-string">'top'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'both'</span></span>,expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loopproc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> message = s.recv(<span class="hljs-number"><span class="hljs-number">128</span></span>) log.insert(END,message) tk.after(<span class="hljs-number"><span class="hljs-number">1</span></span>,loopproc) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendproc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span><span class="hljs-function">:</span></span> sock.sendto (name.get()+<span class="hljs-string"><span class="hljs-string">':'</span></span>+text.get(),(<span class="hljs-string"><span class="hljs-string">'255.255.255.255'</span></span>,<span class="hljs-number"><span class="hljs-number">11719</span></span>)) text.set(<span class="hljs-string"><span class="hljs-string">''</span></span>) msg.bind(<span class="hljs-string"><span class="hljs-string">'&lt;Return&gt;'</span></span>,sendproc) tk.after(<span class="hljs-number"><span class="hljs-number">1</span></span>,loopproc) tk.mainloop()</code> </pre><br><br>  However, the miracle did not happen.  The program tightly stood in anticipation of the incoming package.  The background thread was not so background and to continue the rest of the program, it must sometimes be terminated.  In order for this to occur, the listening socket must be transferred to the non-blocking mode and so that we do not receive an error message when the socket is empty, we will protect this piece of code with try. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> socket <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Tkinter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * tk=Tk() s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="hljs-number"><span class="hljs-number">1</span></span>) s.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, <span class="hljs-number"><span class="hljs-number">1</span></span>) s.bind((<span class="hljs-string"><span class="hljs-string">'0.0.0.0'</span></span>,<span class="hljs-number"><span class="hljs-number">11719</span></span>)) sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) sock.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST,<span class="hljs-number"><span class="hljs-number">1</span></span>) text=StringVar() name=StringVar() name.set(<span class="hljs-string"><span class="hljs-string">'HabrUser'</span></span>) text.set(<span class="hljs-string"><span class="hljs-string">''</span></span>) tk.title(<span class="hljs-string"><span class="hljs-string">'MegaChat'</span></span>) tk.geometry(<span class="hljs-string"><span class="hljs-string">'400x300'</span></span>) log = Text(tk) nick = Entry(tk, textvariable=name) msg = Entry(tk, textvariable=text) msg.pack(side=<span class="hljs-string"><span class="hljs-string">'bottom'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) nick.pack(side=<span class="hljs-string"><span class="hljs-string">'bottom'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) log.pack(side=<span class="hljs-string"><span class="hljs-string">'top'</span></span>, fill=<span class="hljs-string"><span class="hljs-string">'both'</span></span>,expand=<span class="hljs-string"><span class="hljs-string">'true'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loopproc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> s.setblocking(<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: message = s.recv(<span class="hljs-number"><span class="hljs-number">128</span></span>) log.insert(END,message+<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: tk.after(<span class="hljs-number"><span class="hljs-number">1</span></span>,loopproc) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tk.after(<span class="hljs-number"><span class="hljs-number">1</span></span>,loopproc) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendproc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span><span class="hljs-function">:</span></span> sock.sendto (name.get()+<span class="hljs-string"><span class="hljs-string">':'</span></span>+text.get(),(<span class="hljs-string"><span class="hljs-string">'255.255.255.255'</span></span>,<span class="hljs-number"><span class="hljs-number">11719</span></span>)) text.set(<span class="hljs-string"><span class="hljs-string">''</span></span>) msg.bind(<span class="hljs-string"><span class="hljs-string">'&lt;Return&gt;'</span></span>,sendproc) tk.after(<span class="hljs-number"><span class="hljs-number">1</span></span>,loopproc) tk.mainloop()</code> </pre><br><br><h4>  ‚ÄúAnd after finishing with a file ...‚Äù </h4><br>  Purely theoretically, the code is operational, but it has significant enough flaws - the message input field is not immediately selected by default, problems with Cyrillic are possible and the log does not scroll down.  The solution to all these problems can be seen from the following listing (the place where the Cyrillic question is being addressed is highlighted, I hope the rest is obvious): <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- import socket from Tkinter import * #    reload(sys) sys.setdefaultencoding('utf-8') #----------------------------- tk=Tk() s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) s.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1) s.bind(('0.0.0.0',11719)) sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) sock.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST,1) text=StringVar() name=StringVar() name.set('HabrUser') text.set('') tk.title('MegaChat') tk.geometry('400x300') log = Text(tk) nick = Entry(tk, textvariable=name) msg = Entry(tk, textvariable=text) msg.pack(side='bottom', fill='x', expand='true') nick.pack(side='bottom', fill='x', expand='true') log.pack(side='top', fill='both',expand='true') def loopproc(): log.see(END) s.setblocking(False) try: message = s.recv(128) log.insert(END,message+'\n') except: tk.after(1,loopproc) return tk.after(1,loopproc) return def sendproc(event): sock.sendto (name.get()+':'+text.get(),('255.255.255.255',11719)) text.set('') msg.bind('&lt;Return&gt;',sendproc) msg.focus_set() tk.after(1,loopproc) tk.mainloop()</span></span></code> </pre><br><br>  <b>PS</b> And do not forget - the length of the python can reach 9-10 meters. </div><p>Source: <a href="https://habr.com/ru/post/151623/">https://habr.com/ru/post/151623/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151615/index.html">Publish applications in the Windows Store. Part One - Register in the Windows Store</a></li>
<li><a href="../151616/index.html">How I picked up the firmware of the F500 DVR</a></li>
<li><a href="../151619/index.html">About some features of Windows 8 and WinRT (Metro) applications</a></li>
<li><a href="../151621/index.html">Gray Hat Python - DLL and Code Injection</a></li>
<li><a href="../151622/index.html">Asus PadFone video review</a></li>
<li><a href="../151624/index.html">Human colony on Mars. Detailed study of the Mars One project</a></li>
<li><a href="../151626/index.html">Design Patterns (Head First Design Patterns)</a></li>
<li><a href="../151628/index.html">Neurobiology and artificial intelligence: part one - educational program</a></li>
<li><a href="../151629/index.html">We glue several pdf files into one using Mac OS</a></li>
<li><a href="../151631/index.html">Common Event Format inside</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>