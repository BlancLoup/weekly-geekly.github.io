<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Making a repository for Evo on Ditto</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! Today I would like to talk about a painful problem - the organization of repositories (they are the same: file storages, file galleries, file a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Making a repository for Evo on Ditto</h1><div class="post__text post__text-html js-mediator-article"> Hello!  Today I would like to talk about a painful problem - the organization of repositories (they are the same: file storages, file galleries, file archives). <br><br>  I have already talked about the FileDownload snippet, which is quite acceptable for some tasks, but also for people who understand.  As practice has shown, even the plugin that I did under FileDownload does not save people who are not dedicated and they have serious difficulties. <br><a name="habracut"></a><br>  Well, on reflection, I thought that the easiest way to organize a file archive in the way almost everything is implemented on MODx is through the resource tree. <br><br>  For this, it was decided to use Ditto. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, the version of MODx Evo 1.0.4, Ditto standard, from the distribution kit. <br><br>  <u><b>Task:</b></u> <br><br>  To enable simple staff to easily and easily add files, write descriptions to them, make folders. <br><br>  <u><b>Going:</b></u> <br><br>  In that, to use Ditto is about the same as, for example, with the output of news, only instead of pages - files. <br><br>  <u><b>Implementation:</b></u> <br><br>  In general, I think, you need to skip thinking and dead-end attempts and go directly to the final version. <br><br>  <u>File archive structure:</u> <br><br>  --Start archive page <br>  | --- Folder 1 <br>  |  | ------ File 1 <br>  |  | ------ File 2 <br>  | --- File 1 <br>  | --- File 2 <br>  | --- File 3 <br><br>  Those.  like that: <br><img src="https://habrastorage.org/storage/9b05fe49/0025c1e8/896089a4/c7f1bd03.jpg"><br><br>  So, in order to distinguish documents-files from documents-folders, it was decided to make two additional templates: one for files, the other for folders. <br><br>  The file template is empty (do not be surprised, you will later understand what it is for) <br>  Template for a folder - contains a call to Ditto. <br><br>  In the start page, <i>File Archive</i> , add the Ditto call: <br><pre> <code class="hljs ruby"><code class="html">&lt;h2&gt; <span class="hljs-symbol"><span class="hljs-symbol">:&lt;/h2&gt;</span></span> [!Ditto? &amp;id=<span class="hljs-string"><span class="hljs-string">`archiv`</span></span> &amp;parents=<span class="hljs-string"><span class="hljs-string">`[*id*]`</span></span> &amp;noResults=<span class="hljs-string"><span class="hljs-string">` `</span></span> &amp;filter=<span class="hljs-string"><span class="hljs-string">`template,15,8`</span></span> &amp;tpl=<span class="hljs-string"><span class="hljs-string">`repository`</span></span> &amp;sortBy=<span class="hljs-string"><span class="hljs-string">`createdon`</span></span> &amp;summarize=<span class="hljs-string"><span class="hljs-string">`30`</span></span> &amp;dateFormat=<span class="hljs-string"><span class="hljs-string">`%d.%m.%Y`</span></span> &amp;paginate=<span class="hljs-number"><span class="hljs-number">1</span></span> !] [!Ditto? &amp;id=<span class="hljs-string"><span class="hljs-string">`archiv`</span></span> &amp;parents=<span class="hljs-string"><span class="hljs-string">`[*id*]`</span></span> &amp;filter=<span class="hljs-string"><span class="hljs-string">`template,16,8`</span></span> &amp;tpl=<span class="hljs-string"><span class="hljs-string">`repository`</span></span> &amp;sortBy=<span class="hljs-string"><span class="hljs-string">`createdon`</span></span> &amp;summarize=<span class="hljs-string"><span class="hljs-string">`30`</span></span> &amp;dateFormat=<span class="hljs-string"><span class="hljs-string">`%d.%m.%Y`</span></span> &amp;paginate=<span class="hljs-number"><span class="hljs-number">1</span></span> !] &lt;<span class="hljs-regexp"><span class="hljs-regexp">/div&gt; &lt;div id="pagination"&gt; [+archiv_previous+] - .: [+archiv_pages+] - [+archiv_next+] &lt;/div</span></span>&gt;</code></code> </pre><br><br>  <b>Explanations:</b> <br>  1. Why two calls? <br>  There are two calls here because with the help of one call it‚Äôs impossible to sort the folders and files separately (and we want the folders to always be first in the list). <br>  2. Why &amp; id = `archiv`? <br>  This is done just in case, because there may be other Diito calls on the page, for example, News. <br>  3. Why &amp; noResults = ``? <br>  And this is to ensure that instead of the message ‚ÄúRecords are not found.‚Äù Nothing is displayed.  Why in one call?  We just don‚Äôt want this page to be missing on this page if there are no folders in the subdirectory, but if there are no files, this is quite appropriate. <br>  4. &amp; filter = `template, 15.8` and &amp; filter =` template, 16.8` <br>  Here we display only what we need: in the first file, we output only those documents that are with the id = 15 template (Folder template), in the second one only with the id = 16 template (File template). <br><br>  Everything else, I think, is understandable. <br><br>  <b>Now those templates</b> : as I said, the template files can be completely empty, but the folder template should contain a call to Ditto: <br><pre> <code class="hljs markdown"><code class="html"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> :<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"fd-example4"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">img</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"assets/images/filetype/arrow_up.png"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"javascript:history.back()"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> [!Ditto? &amp;id=<span class="hljs-code"><span class="hljs-code">`archiv`</span></span> &amp;parents=<span class="hljs-code"><span class="hljs-code">`[*id*]`</span></span> &amp;noResults=<span class="hljs-code"><span class="hljs-code">` `</span></span> &amp;filter=<span class="hljs-code"><span class="hljs-code">`template,15,8`</span></span> &amp;tpl=<span class="hljs-code"><span class="hljs-code">`repository`</span></span> &amp;sortBy=<span class="hljs-code"><span class="hljs-code">`createdon`</span></span> &amp;summarize=<span class="hljs-code"><span class="hljs-code">`30`</span></span> &amp;dateFormat=<span class="hljs-code"><span class="hljs-code">`%d.%m.%Y`</span></span> &amp;paginate=1 !] [!Ditto? &amp;id=<span class="hljs-code"><span class="hljs-code">`archiv`</span></span> &amp;parents=<span class="hljs-code"><span class="hljs-code">`[*id*]`</span></span> &amp;filter=<span class="hljs-code"><span class="hljs-code">`template,16,8`</span></span> &amp;tpl=<span class="hljs-code"><span class="hljs-code">`repository`</span></span> &amp;sortBy=<span class="hljs-code"><span class="hljs-code">`createdon`</span></span> &amp;summarize=<span class="hljs-code"><span class="hljs-code">`30`</span></span> &amp;dateFormat=<span class="hljs-code"><span class="hljs-code">`%d.%m.%Y`</span></span> &amp;paginate=1 !] <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"pagination"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> [+archiv<span class="hljs-emphasis"><span class="hljs-emphasis">_previous+] - .: [+archiv_</span></span>pages+] - [+archiv_next+] <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code></code> </pre><br><br>  As you can see, the only difference is that we added the Back link.  And another thing: the Folder template needs to make a TV parameter, I called it <i>tvfile</i> , and the input type was <i>File</i> . <br><br>  Next, what we have contains the chunk <b>&amp; tpl = `repository`:</b> <br><pre> <code class="hljs json"><code class="html">[[repome? &amp;docId=`[+id+]` ]]</code></code> </pre> <br><br>  Those.  in the chunk, we only have a call to a simple handwritten snippet <i>repome</i> . <br>  What the snippet does: <br>  1. Associates various file extensions with their icons. <br>  2. The file size is calculated, the file name is highlighted. <br>  3. Pattern recognition and output generation <br><br>  <b>Snippet RepoMe</b> <br>  I will explain the main parameters: <br><pre> <code class="hljs perl"><code class="php">$idTemplateFolder - ID    $folderTitle -         $folderDescription -       $idTemplateFile - ID    $fileTitle -         $fileDescription -       $fileFile -        $fileDate -         $imgset -      $imgPath -   </code></code> </pre><br><br>  I will not give the snippet code itself, I tried to comment on it as much as possible and put it in the archive at the end of the article. <br><br>  And, finally, by styles: those who use FileDowload, probably noticed that I used his example styles here - it was too lazy to redo it (I attached them in the archive). <br><br>  <u><b>What should happen:</b></u> <br><br><img src="https://habrastorage.org/storage/7d7e81b5/d54d717b/75254b1f/06d79121.jpg"><br>  And if you enter the Vortex Generators folder: <br><img src="https://habrastorage.org/storage/3fb6bf6e/cc6cc9d7/a96efe06/d71aecab.jpg"><br><br>  Oh, and I almost forgot: you can use the ManagerManager.  By removing the extra fields (remember, this is done by adding the mm_hideFields instruction ('field_list_of_section_frame', 'user_id_roli', 'template_id') into the mm_rules chunk if you keep the rules there or in the same file in the managermanager directory). <br><br>  Then, for the manager, the administrative part will look like this: <br><br><img src="https://habrastorage.org/storage/1c781dc1/e01e3fd9/f5858220/9b19e9c0.jpg"><br><br>  <b><u>Evaluate:</u></b> <br><br>  + Colossal ease of use, you can once explain the principle of adding news - and then use it when explaining how to work with a file archive <br>  + Implemented on Ditto, which means, theoretically, you can fasten all sorts of ditto gadgets, such as rating <br>  + Implemented in the form of documents - which means you can, having a fantasy, make a bunch of bells and whistles <br>  + Independence of file and folder names from their names <br>  + Independence from the physical location of files <br>  + Icon support <br>  + Basically, versatility <br>  + Simple code: the ability to finish as you like <br><br>  - Inconvenient output setting (no templates and placeholders for them) <br>  - For maximum adaptation for your resource, you may have to finish a lot <br>  - Still, far from a professional tool <br><br>  <i>What you need to pay attention to:</i> <br>  Do not forget about <pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">base</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'[(site_url)]'</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Do not forget to allow managers to use FCKeditor and download various types of files. <br><br>  <i><b>Download:</b></i> <br>  <a href="http://narod.ru/disk/26134503000/repome.rar.html">Archive with snippet and everything you need</a> <br><br>  That's all.  Perhaps, if this version is in progress, we will improve it by adding templates and other usefulness. </div><p>Source: <a href="https://habr.com/ru/post/106185/">https://habr.com/ru/post/106185/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../106177/index.html">Two more tablets based on Windows 7</a></li>
<li><a href="../106178/index.html">Skype 5.0 for Windows</a></li>
<li><a href="../106179/index.html">Skype + Facebook = Skype 5.0 for Windows</a></li>
<li><a href="../106180/index.html">Backup Virtual Machines in Citrix XenServer</a></li>
<li><a href="../106181/index.html">Divorce is not where it seems</a></li>
<li><a href="../106186/index.html">Synaptics and Microsoft Introduce New Technologies for Windows Phone 7</a></li>
<li><a href="../106187/index.html">AOL going to buy yahoo?</a></li>
<li><a href="../106189/index.html">Introduction to Ruby on Rails 3.0</a></li>
<li><a href="../106190/index.html">Japanese robots have learned ... to sing</a></li>
<li><a href="../106191/index.html">Conference "Back to the Mac" will be held on October 20</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>