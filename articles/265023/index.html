<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Configure D-Link DIR-320 / NRU + 3G Rostelecom R41 (Sense R41)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article describes the configuration of the D-Link DIR-320 / NRU router and the 3G + Rostelecom R41 modem. 

 The router support page lists the com...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Configure D-Link DIR-320 / NRU + 3G Rostelecom R41 (Sense R41)</h1><div class="post__text post__text-html js-mediator-article">  The article describes the configuration of the D-Link DIR-320 / NRU router and the 3G + Rostelecom R41 modem. <br><br>  The router support page lists the compatible models of modems, and ‚Äú3G + Rostelecom R41‚Äù, also known as ‚ÄúSense R41‚Äù, is not included in their number.  When connected to the router, the modem is not defined in the configuration interface, it is displayed in the logs as a SCSI device, and no <i>/ dev / ttyUSB *</i> devices are created.  That is, without options, an alternative router firmware is required. <br><br>  An Internet search revealed that this router can be flashed with some versions of ZyXEL Keenetic and OpenWRT firmware.  The choice fell on OpenWRT.  Along with the custom builds of OpenWRT, which include everything needed to connect a 3G modem, support for the DIR-320 / NRU router has been added to the main OpenWRT branch, starting with revision 38040. Therefore, the latest stable version of OpenWRT, Barrier Breaker 14.07, is selected for the firmware. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <font color="#777">1. Description of devices</font> </h4><br><h5>  D-Link DIR-320 / NRU router </h5><table><tbody><tr><td>  Off.  site: </td><td>  <a href="http://www.dlink.ru/ru/products/5/1466_b.html">www.dlink.ru/ru/products/5/1466_b.html</a> </td></tr><tr><td>  OpenWRT site: </td><td>  <a href="http://wiki.openwrt.org/toh/d-link/dir-320_revb1">wiki.openwrt.org/toh/d-link/dir-320_revb1</a> </td></tr><tr><td>  H / W Ver .: <br>  (iron version) </td><td>  B1 </td></tr><tr><td>  F / W Ver .: <br>  (firmware version) </td><td>  1.2.94 </td></tr><tr><td>  SoC: <br>  (chipset) </td><td>  RaLink RT5350 </td></tr></tbody></table>  All subsequent actions concern routers with hardware version B *. <br><br><h5>  Modem 3G + Rostelecom R41 </h5><br>  He is "Sense R41", he is "Network Connect R41" <br><table><tbody><tr><td></td><td><img src="https://habrastorage.org/files/2a9/a4e/715/2a9a4e7154734ed9910485bc12aab917.jpg"></td></tr><tr><td>  SoC: </td><td>  MediaTek MT6225 </td></tr></tbody></table><h4>  <font color="#777">2. Preparation</font> </h4><br>  You will need the <i>curl</i> and <i>ssh</i> utilities.  On Windows it is convenient to install <a href="https://msys2.github.io/">MSYS2</a> and install the <i>curl</i> and <i>ssh</i> packages. <br><br>  Download <a href="">side OpenWRT</a> for DIR-320 / NRU.  At the moment it is the latest stable build.  Or you can search for other releases / builds with the <i>ramips / rt305x / openwrt-ramips-rt305x-dir-320-b1- prefix</i> .  Copy the firmware in the folder <i>Dir320</i> . <br><br>  <i>Comment:</i> <br><blockquote>  To configure the router, you need additional OpenWRT packages.  The easiest way is to set up a WAN on the router (Internet through an ISP cable) and install packages via the Internet.  It is possible to download packages in advance, as well as build packages into an assembly or build firmware from source codes with added packages.  But I did not study this question.  Details on the <a href="http://wiki.openwrt.org/doc/howto/obtain.firmware">OpenWRT howto</a> page. </blockquote><br>  Create a script in the <i>Dir320</i> folder: <br><br><div class="spoiler">  <b class="spoiler_title">update_flash.cmd</b> <div class="spoiler_text"><pre><code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> firmware=openwrt-ramips-rt305x-<span class="hljs-built_in"><span class="hljs-built_in">dir</span></span>-<span class="hljs-number"><span class="hljs-number">320</span></span>-b1-squashfs-sysupgrade.bin <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> router=<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> =========================================================================== <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> This batch file will upload <span class="hljs-variable"><span class="hljs-variable">%firmware%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the current directory to <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%router%</span></span> during the router's bootup. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">Set</span></span> your ethernet card's settings to: <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> IP: <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Mask: <span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">255</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Gateway: <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> * Unplug the router's power cable. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> * Press and hold reset button. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> * Re-plug the router's power cable. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> * Wait <span class="hljs-number"><span class="hljs-number">10</span></span>-<span class="hljs-number"><span class="hljs-number">15</span></span> seconds, then release reset button. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> =============================================================================== <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Waiting <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the router... Press Ctrl+C to abort. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. :<span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> -n <span class="hljs-number"><span class="hljs-number">1</span></span> -w <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-variable"><span class="hljs-variable">%router%</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> "TTL=" <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">errorlevel</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> curl -v -<span class="hljs-number"><span class="hljs-number">0</span></span> --retry <span class="hljs-number"><span class="hljs-number">100</span></span> --form firmware=@<span class="hljs-variable"><span class="hljs-variable">%firmware%</span></span> -o <span class="hljs-variable"><span class="hljs-variable">%temp%</span></span>\curl_out.tmp --progress-bar http://<span class="hljs-variable"><span class="hljs-variable">%router%</span></span> curl -v -<span class="hljs-number"><span class="hljs-number">0</span></span> --retry <span class="hljs-number"><span class="hljs-number">100</span></span> --form firmware=@<span class="hljs-variable"><span class="hljs-variable">%firmware%</span></span> -o <span class="hljs-variable"><span class="hljs-variable">%temp%</span></span>\curl_out.tmp --progress-bar http://<span class="hljs-variable"><span class="hljs-variable">%router%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">errorlevel</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> =============================================================================== <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> * WAIT <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> about <span class="hljs-number"><span class="hljs-number">2</span></span> minutes while the firmware is being flashed. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> * The default router address will be <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> <span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b</code> </pre> <br>  <i>Comment:</i> <br><blockquote>  Change the line <i>set firmware = ...</i> - set the name of the firmware file, if you called it differently. </blockquote></div></div><br>  We configure the network interface on the computer: <br><br><pre> IP: 192.168.0.10
 Mask: 255.255.255.0
 Gateway: 192.168.0.1
</pre><br>  Turn off the power of the router.  We connect the network port 1 (or 2, 3, 4, but not the INTERNET) of the router with an Ethernet cable to the configured network card (192.168.0.10). <br><br><h4>  <font color="#777">3. Firmware</font> </h4><br>  Run the script <i>Dir320 / update_flash.cmd</i> and execute the instructions it <i>displays</i> .  Namely: <br><br><ol><li>  Clamp the Reset button on the router with a match / paperclip / pencil. </li><li>  We connect power to the router. </li><li>  We are waiting for 10-15 seconds. </li><li>  Release the reset button. </li><li>  We are waiting for 2-3 minutes. </li></ol><br><h4>  <font color="#777">4. Configure the router</font> </h4><br><ul><li>  Open the address <a href="http://192.168.1.1/">192.168.1.1</a> in the browser <br>  Enter login - root, password - empty, click the Login button. </li><li>  Configure access to the router: <br><ul><li>  System ‚Üí Administration menu </li><li>  Set a new password </li><li>  Configure SSH (fields: Interface = lan, Password authentication = enable, Allow root logins with password = enable) </li><li>  <i>Save &amp; Apply</i> Button </li></ul></li><li>  Configure WAN (Internet access): <br><ul><li>  Network menu ‚Üí Interfaces </li><li>  WAN Icon ‚Üí Edit Button </li><li>  We configure the connection to the provider (fields: Protocol, etc.) </li><li>  <i>Save &amp; Apply</i> Button </li></ul>  Internet access should appear. </li><li>  Configuring 3G <br><ul><li>  Open the console MSYS2 </li><li>  Connect to the router via SSH: <br><pre> <code class="bash hljs">ssh root@192.168.1.1</code> </pre></li><li>  Enter the password </li><li>  Install the packages: <br><pre> <code class="bash hljs">opkg update opkg install comgt kmod-usb2 kmod-usb-ohci kmod-usb-serial kmod-usb-serial-option kmod-usb-serial-ipw kmod-usb-serial-wwan kmod-usb-acm luci-proto-3g usb-modeswitch usb-modeswitch-data usbutils</code> </pre><div class="spoiler">  <b class="spoiler_title">Comment:</b> <div class="spoiler_text"><blockquote>  1. The opkg update command must be re-executed in each SSH session (and possibly before each opkg install).  In any case, if the opkg install command does not find a package, you need to run opkg update. <br>  2. It is possible that only one of the kmod-usb-serial-wwan, kmod-usb-acm packages is available (this is indicated on the <a href="http://wiki.openwrt.org/doc/recipes/3gdongle">wiki.openwrt.org/doc/recipes/3gdongle</a> page), but I didn‚Äôt really understand both. <br>  3. Usb-modeswitch, usb-modeswitch-data, usbutils packages are kind of not needed - usb-modeswitch * are needed if the modem is defined as a disk (I did not have one), usbutils is needed only to recognize VendorID and ProductID. </blockquote></div></div></li><li>  Create a script with USB device settings (correct VendorID and ProductID): <br><div class="spoiler">  <b class="spoiler_title">/etc/hotplug.d/usb/22-3g_dongle</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'#!/bin/sh idvendor="2020" idproduct="4000" bcddevice="300" if [ "${PRODUCT}" = "${idvendor}/${idproduct}/${bcddevice}" ]; then if [ "${ACTION}" = "add" ]; then echo '</span></span><span class="hljs-variable"><span class="hljs-variable">${idvendor}</span></span> <span class="hljs-variable"><span class="hljs-variable">${idproduct}</span></span> ff<span class="hljs-string"><span class="hljs-string">' &gt; /sys/bus/usb-serial/drivers/option1/new_id fi fi '</span></span> &gt; /etc/hotplug.d/usb/22-3g_dongle</code> </pre><br>  <i>Comment:</i> <br><blockquote>  1. You can copy the command, starting with echo <br>  2. The end of the EOL line should be a UNIX format (LF, not CRLF), that is, copy the command into a text editor (for example, Notepad ++) and replace the line ends, and then copy it to the console. <br>  3. idvendor, idproduct, bcddevice can be viewed with the lsusb -v command (usbutils package), if these values ‚Äã‚Äãsuddenly fail. </blockquote></div></div></li><li>  Create a script with modem settings: <br><div class="spoiler">  <b class="spoiler_title">/etc/chatscripts/3g.chat</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'ABORT BUSY ABORT VOICE ABORT "NO CARRIER" ABORT "NO DIALTONE" ABORT "NO DIAL TONE" ABORT "NO ANSWER" ABORT "DELAYED" ABORT "ERROR" ABORT "+CGATT: 0" "" AT TIMEOUT 30 OK ATH OK ATE1 OK AT+CFUN=1 OK AT+CGATT? OK AT+CGDCONT=1,"IP","\T" OK ATD*99# TIMEOUT 22 CONNECT "" '</span></span> &gt; /etc/chatscripts/3g.chat</code> </pre><br>  <i>Comment:</i> <br><blockquote>  1. The end of the EOL line must be UNIX format. <br>  2. The file name /etc/chatscripts/3g.chat can be different: run the command ls -n / etc / chatscripts / and see which files are created after setting up the 3G connection (via the web interface or console) </blockquote></div></div></li><li>  Reboot the router: reboot command in the console or via the web interface </li><li>  Go to <a href="http://192.168.1.1/">192.168.1.1</a> </li><li>  Add a new network interface for a 3G modem: <br><ul><li>  Network menu ‚Üí Interfaces </li><li>  Add new interface button </li><li>  Open the General setup tab, fill in the fields: Name = WAN3G, Protocol = UMTS / GPRS / EV-DO </li><li>  Submit button </li><li>  Fill in the fields: Modem device = / dev / ttyUSB0, Service type = UMTS / GPRS, APN = internet.rt.ru, username = ncc, password = ncc </li><li>  Open the tab Firewall settings, set the switch Assign firewall-zone = wan </li><li>  Save &amp; Apply Button </li></ul></li><li>  Turn off the power of the router, unplug the WAN cable of the ISP. </li><li>  Turn on the power, after downloading the router, the modem should work and the Internet should appear. </li></ul></li></ul><br><h4>  <font color="#777">If not earned</font> </h4><br>  1. Watch logs - Kernel Log <br><br>  Via web-interface: Status menu ‚Üí Kernel Log <br>  Via console (ssh): <br><br><pre> <code class="bash hljs">dmesg | grep usb</code> </pre><br>  There should be entries like this: <br><div class="spoiler">  <b class="spoiler_title">Kernel log</b> <div class="spoiler_text"><pre> [0.680000] rt3xxx-usbphy usbphy.3: loaded
 [6.690000] usbcore: registered new interface driver usbfs
 [6.700000] usbcore: registered new interface driver hub
 [6.710000] usbcore: registered new device driver usb
 [18.000000] rt3xxx-usbphy usbphy.3: remote usb device wakeup disabled
 [18.020000] rt3xxx-usbphy usbphy.3: UTMI 16bit 30MHz
 [18.120000] usb usb1: no of_node;  not parsing pinctrl DT
 [18.430000] usb usb2: no of_node;  not parsing pinctrl DT
 [18.460000] usbcore: cdc_acm registered new interface driver
 [18.480000] usb 1-1: new high-speed USB device number 2 using ehci-platform
 [18.710000] usb 1-1: no of_node;  not parsing pinctrl DT
 [18.730000] usbcore: registered new interface driver usbserial
 [18.770000] usbcore: registered new interface driver usbserial_generic
 [18.810000] usbserial: USB Serial support registered for generic
 [19.400000] usbcore: registered new interface driver ipw
 [19.440000] usbserial: USB Serial support registered for IPWireless converter
 [19.510000] usbcore: registered new interface driver option
 [19.570000] usbserial: USB Serial support registered for GSM modem (1-port)
 [20.380000] usb 1-1: USB disconnect, device number 2
 [21.620000] usb 1-1: new high-speed USB device number 3 using ehci-platform
 [01.220000] usb 1-1: no of_node;  not parsing pinctrl DT
 [23.410000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB0
 [23.490000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB1
 [23.590000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB2
 [23.670000] usb 1-1: GSM modem (1-port) converter now attached to ttyUSB3
</pre></div></div><br>  Keywords - <i>usbserial</i> , <i>ttyUSB *</i> . <br>  If they are not there, then make sure that all packages are delivered: System ‚Üí Software menu or a command in the console. <br><br><pre> <code class="bash hljs">opkg list-installed</code> </pre><br>  Make sure that in <i>/etc/hotplug.d/usb/22-3g_dongle</i> the <i>idvendor</i> , <i>idproduct</i> , <i>bcddevice parameters</i> match the USB device.  This can be viewed in the console with the command <br><br><pre> <code class="bash hljs">lsusb -v | grep -e idVendor -e idProduct -e bcdDevice.</code> </pre><br>  Something should be displayed. <br><pre>   idVendor 0x2020
   idProduct 0x4000
   bcdDevice 3.00
   idVendor 0x1d6b Linux Foundation
   idProduct 0x0002 2.0 root hub
   bcdDevice 3.10
   idVendor 0x1d6b Linux Foundation
   idProduct 0x0001 1.1 root hub
   bcdDevice 3.10
</pre><br>  The first three lines correspond to the modem. <br><br>  2. Next - System Log <br><br>  Via web-interface: Status menu ‚Üí System Log. <br>  Via console (ssh): <br><br><pre> <code class="bash hljs">logread</code> </pre><br>  There should be entries like this: <br><div class="spoiler">  <b class="spoiler_title">System log</b> <div class="spoiler_text"><pre> Tue Aug 18 00:36:25 2015 daemon.notice netifd: Interface 'WAN3G' is setting up now
 Tue Aug 18 00:36:27 2015 kern.err kernel: [10387.270000] option1 ttyUSB0: option_instat_callback: error -2
 Tue Aug 18 00:36:27 2015 daemon.notice pppd [22188]: pppd 2.4.7 started by root, uid 0
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: abort on (BUSY)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: abort on (VOICE)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: abort on (NO CARRIER)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: abort on (NO DIALTONE)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: abort on (NO DIAL TONE)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: abort on (NO ANSWER)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: abort on (DELAYED)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: abort on (ERROR)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: abort on (+ CGATT: 0)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: send (AT ^ M)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: timeout set to 30 seconds
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: expect (OK)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: AT ^ M ^ M
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: OK
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: - got it
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: send (ATH ^ M)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: expect (OK)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: ^ M
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: ATH ^ M ^ M
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: OK
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: - got it
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: send (ATE1 ^ M)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: expect (OK)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: ^ M
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: ATE1 ^ M ^ M
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: OK
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: - got it
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: send (AT + CFUN = 1 ^ M)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: expect (OK)
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: ^ M
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: AT + CFUN = 1 ^ M ^ M
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: OK
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: - got it
 Tue Aug 18 00:36:28 2015 local2.info chat [22191]: send (AT + CGATT? ^ M)
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: expect (OK)
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: ^ M
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: AT + CGATT? ^ M ^ M
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: + CGATT: 1 ^ M
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: ^ M
 Tue Aug 18 00:36:29 2015 local2.info chat: [22191]: OK
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: - got it
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: send (AT + CGDCONT = 1, "IP", "\ T" ^ M)
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: expect (OK)
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: ^ M
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: AT + CGDCONT = 1, "IP", "T" ^ M ^ M
 Tue Aug 18 00:36:29 2015 local2.info chat: [22191]: OK
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: - got it
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: send (ATD * 99 # ^ M)
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: timeout set to 22 seconds
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: expect (CONNECT)
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: ^ M
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: ATD * 99 # ^ M ^ M
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: CONNECT
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: - got it
 Tue Aug 18 00:36:29 2015 local2.info chat [22191]: send (^ M)
 Tue Aug 18 00:36:29 2015 daemon.info pppd [22188]: Serial connection established.
 Tue Aug 18 00:36:29 2015 daemon.info pppd [22188]: Using interface 3g-WAN3G
 Tue Aug 18 00:36:29 2015 daemon.notice pppd [22188]: Connect: 3g-WAN3G &lt;-&gt; / dev / ttyUSB0
 Tue Aug 18 00:36:30 2015 daemon.notice pppd [22188]: PAP authentication succeeded
 Tue Aug 18 00:36:32 2015 daemon.warn pppd [22188]: Could not determine the remote IP address: defaulting to 10.64.64.64
 Tue Aug 18 00:36:32 2015 daemon.notice pppd [22188]: local IP address 10.175.68.213
 Tue Aug 18 00:36:32 2015 daemon.notice pppd [22188]: remote IP address 10.64.64.64
 Tue Aug 18 00:36:32 2015 daemon.notice pppd [22188]: primary DNS address 176.59.127.150
 Tue Aug 18 00:36:32 2015 daemon.notice pppd [22188]: secondary DNS address 176.59.127.146
 Tue Aug 18 00:36:32 2015 daemon.notice netifd: Network device '3g-WAN3G' link is up
 Tue Aug 18 00:36:32 2015 daemon.notice netifd: Interface 'WAN3G' is now up
 Tue Aug 18 00:36:32 2015 user.notice firewall: Reloading firewall due to ifup of WAN3G (3g-WAN3G)
</pre></div></div><br>  If the connection fails, you need to look at the error code.  Without this, more specifically, nothing can be said. <br><br><h4>  <font color="#777">Links</font> </h4><br>  <a href="http://www.dlink.ru/ru/products/5/1466_b.html">Product page DIR-320 / NRU on D-Link</a> <br>  <a href="http://wiki.openwrt.org/toh/d-link/dir-320_revb1">OpenWRT DIR-320 / NRU device page</a> <br>  <a href="http://wiki.openwrt.org/ru/doc/howto/basic.config">OpenWRT Basic Setup</a> <br>  <a href="http://wiki.openwrt.org/ru/doc/recipes/3gdongle">Setting up a 3G modem in OpenWRT</a> <br>  <a href="http://v1ron.ru/2013/06/stavim-openwrt-na-dir320nru/">We put OpenWRT on DIR320 / NRU</a> <br>  <a href="https://www.ylsoftware.com/news/673">Using the Sense R41 modem in Linux</a> </div><p>Source: <a href="https://habr.com/ru/post/265023/">https://habr.com/ru/post/265023/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265013/index.html">Client side CORS emulation: cross-browser solution of some user tasks without extensions</a></li>
<li><a href="../265015/index.html">Materials from the free on-site seminar "Kerio Control: Everything you wanted to know, but did not know who to ask"</a></li>
<li><a href="../265017/index.html">Optimization of data center operation at no extra cost</a></li>
<li><a href="../265019/index.html">Digest of the game industry: July</a></li>
<li><a href="../265021/index.html">SCADA and mobile phones: an assessment of the safety of applications that turn a smartphone into a plant control panel</a></li>
<li><a href="../265025/index.html">We document errors in Doxygen</a></li>
<li><a href="../265027/index.html">DATA CENTER EXPEDITION 2015: Asia Tour</a></li>
<li><a href="../265029/index.html">Statistical problems of identification of network structures</a></li>
<li><a href="../265031/index.html">QIWI launched Visa payWave on Android devices</a></li>
<li><a href="../265037/index.html">7 tips on how to improve the performance of your site in Microsoft Edge and other modern browsers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>