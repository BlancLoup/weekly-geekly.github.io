<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Application, tips and features of knockout.js</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so much is written about the knockout.js library, but there is some (and of course there is an official tutorial and other materials on the offici...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Application, tips and features of knockout.js</h1><div class="post__text post__text-html js-mediator-article">  Not so much is written about the <a href="http://knockoutjs.com/">knockout.js</a> library, but there is <a href="http://habrahabr.ru/post/154003/">some</a> (and of course there is an <a href="http://learn.knockoutjs.com/">official tutorial</a> and other materials on the <a href="http://learn.knockoutjs.com/">official</a> website and a good resource in English <a href="http://www.knockmeout.net/">knockmeout.net</a> , which articles I can translate if there is demand) .  This article may turn into a cycle of articles on javascript and knockout if ufo does not kidnap me. <br><br>  Initially I was preparing material for people already familiar with knockout and mvvm, but in the comments to other articles I was asked to tell how to prepare a knockout for dummies.  I assume that you have already read previous articles on knockout on Habr√©.  Go! <br><a name="habracut"></a><br><h4>  Why do I need Knockout.js? </h4><br><ol><li>  To be able to easily fill the interface with data from a json-like object (model): <br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ViewModel = { <span class="hljs-attr"><span class="hljs-attr">attribute1</span></span>: ‚ÄùHello‚Äù, <span class="hljs-attr"><span class="hljs-attr">attribute2</span></span>: ‚Äùworld!‚Äù, };</code> </pre> <br>  Layout: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtext:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">attribute1</span></span></span><span class="hljs-tag">‚Äù&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtext:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">attribute2</span></span></span><span class="hljs-tag">‚Äù&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Binding: <br><pre> <code class="javascript hljs">ko.applyBindings( ViewModel );</code> </pre><br>  Result: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtext:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">attribute1</span></span></span><span class="hljs-tag">‚Äù&gt;</span></span>Hello<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtext:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">attribute2</span></span></span><span class="hljs-tag">‚Äù&gt;</span></span>world!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  But such a binding is often not used, because when the model changes, the DOM does not change and vice versa. <br></li><li>  Create a two-way observable interface and model binding, i.e.  the interface will be updated in real time when the model changes, and the model when the interface changes (a <a href="http://knockoutjs.com/examples/helloWorld.html">working example</a> when entering text in forms).  There is one caveat, the update of the model in the input fields will occur only on the onblur event (remove the focus from the element), this situation can be corrected by subscribing to the <code>input</code> event, and the model must be updated manually.  An example on <a href="http://jsfiddle.net/archangel_irk/eJAXv/1/">jsfiddle</a> .  User <a href="https://habrahabr.ru/users/m_z/" class="user_link">m_z</a> suggested a more convenient version of updating the model using <code>valueUpdate: 'input'</code> ( <a href="http://jsfiddle.net/archangel_irk/8JKJ6/1/">Example</a> ). </li><li>  Additionally subscribe to model changes.  Code from the documentation: <br><pre> <code class="javascript hljs">myViewModel.personName.subscribe(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newValue</span></span></span><span class="hljs-function">) </span></span>{ alert(<span class="hljs-string"><span class="hljs-string">" : "</span></span> + newValue); });</code> </pre><br>  Unsubscribe from changes: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> subscription = myViewModel.personName.subscribe(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newValue</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* -  */</span></span> }); <span class="hljs-comment"><span class="hljs-comment">// ... ... subscription.dispose(); //  .</span></span></code> </pre><br></li></ol><br><h4>  What is the data-bind and bindings attribute? </h4><br>  This attribute is very similar to the json object, it allows us to bind data and event handlers to the current DOM node.  Knockout.js parses this attribute and executes JavaScript expressions (described in detail in the <a href="http://knockoutjs.com/documentation/binding-syntax.html">docks</a> ).  This construct runs in the context of the transferred data model.  Accordingly, the syntax of the attribute must be correct in terms of javascript code. <br><br>  Knockout.js offers a set of standard bindings that allow you to edit styles, content, handlers, etc., creating magical things.  In addition, you can write your bindings, about this is perfectly told again in the <a href="http://knockoutjs.com/documentation/custom-bindings.html">docks</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This concludes the description of why you need a knockout, everything else you yourself know on which site to find and move on to some not obvious newcomer things. <br><br><h4>  Work with observableArray </h4><br>  Suppose you need to dynamically change an array to which some handlers are subscribed (or an interface).  For example, you received a new batch of data from the server and in a loop add it to the array. <br>  If you do everything in the forehead, then the change handler will work as many times as you add elements.  And it will affect performance.  An example is taken from <a href="http://www.knockmeout.net/2012/04/knockoutjs-performance-gotcha.html">knockmeout.net</a> <br><br>  So do not: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> items = ko.observableArray([]); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, j = newData.length; i &lt; j; i++) { items.push( newData[i] ); }</code> </pre><br>  Much better like this: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> items = ko.observableArray([]); <span class="hljs-comment"><span class="hljs-comment">//    . var underlyingArray = items(); for (var i = 0, j = newData.length; i &lt; j; i++) { //     . underlyingArray.push( newData[i] ); } // ,           . self.items.valueHasMutated();</span></span></code> </pre><br>  Full <a href="http://jsfiddle.net/rniemeyer/NCpxm/">jsfiddle</a> example. <br><br>  In the comments on <a href="http://stackoverflow.com/questions/9967976/update-knockout-js-observable-from-json">stackoverflow, they</a> even recommend this function: <br><pre> <code class="javascript hljs">ko.observableArray.fn.pushAll = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">valuesToPush</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> underlyingArray = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.valueWillMutate(); ko.utils.arrayPushAll(underlyingArray, valuesToPush); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.valueHasMutated(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }; <span class="hljs-comment"><span class="hljs-comment">//  this.users.pushAll(dataFromServer);</span></span></code> </pre><br><br><h4>  Templates </h4><br>  Knockout.js is needed in the project primarily for filling the interface with data.  The most common scenario for this is getting an AJAX request for JSON data from the server and rendering, i.e.  update content without reloading the page. <br>  To do this, we need fragments of the page, which we can replace in the interface and fill with data - that is,  we need templates for different data.  Knockout.js can work with various types of templates (jQuery.tmpl, underscore, native) - let's stop on the latter (although we can even write our own). <br><br>  Non-native template engines do not support the use of some bindings inside it (in particular, very pleasant <a href="http://knockoutjs.com/documentation/with-binding.html">with</a> , which replaces the context of the model for the template). <br><br>  Therefore, in some cases, I want to use the native template from knockout.  To do this, in the options you need to pass the <code>templateEngine: ko.nativeTemplateEngine.instance</code> .  What is interesting (and not stated in the documentation) is that this parameter can be passed in the template binding. <br><br>  For software rendering templates use the command: <br><pre> <code class="javascript hljs">ko.renderTemplate(templateName, viewModel, options, domNodeToRender);</code> </pre><br>  It is convenient to call this command, for example, in the _create () method when creating jquery widgets that use templates, and this is done like this: <br><pre> <code class="javascript hljs">ko.renderTemplate(<span class="hljs-string"><span class="hljs-string">'templateName'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, { <span class="hljs-attr"><span class="hljs-attr">templateEngine</span></span>: ko.nativeTemplateEngine.instance }, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.element.get(<span class="hljs-number"><span class="hljs-number">0</span></span>) );</code> </pre><br>  To call a template from another template, use the standard <a href="http://knockoutjs.com/documentation/template-binding.html">template</a> binding: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"template: { name: templateName, data: viewModel, templateEngine: ko.nativeTemplateEngine.instance }"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <code>templateName</code> is the name of the template, in practice it is the <code>id</code> block containing the layout with the template: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"templateName"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text: name"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Credits: </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text: credits"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In this case, the template engine is not ‚Äúinherited‚Äù when invoking nested templates ‚Äî if we call a template from a template processed by the native template engine, then the internal template (if you do not specify the template engine forcibly) still uses the default template engine (for example, jQuery.tmpl, if one was connected in project). <br>  Therefore, if other template engines are used in the project, and you want to use the native, the engine must be specified each time.  But this feature allows us to simultaneously use different template engines for nested templates. <br><br><h4>  Templates without root element </h4><br>  Sometimes you do not want to create an extra container for the contents of the template, so that it does not work out that only one element is embedded into it.  In the template itself, the element may be necessary due to bindings or styles. <br>  In this case, the standard option for knockout is suitable (virtual elements): <br><br><pre> <code class="html hljs xml"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- ko template: { name: 'viewReportTemplate', templateEngine: ko.nativeTemplateEngine.instance, data: $root } --&gt;</span></span><span class="hljs-comment"><span class="hljs-comment">&lt;!-- /ko --&gt;</span></span></code> </pre><br>  Although the documentation he is not described. <br><br><h4>  Debugging in templates </h4><br>  The most common operation in programming is debugging (although some may argue).  The method below will allow you to display messages in the console using a comma operator and a grouping operator ( <a href="http://habrahabr.ru/post/116827/">more about these operators</a> ). <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"html: ( console.log( details ), details )"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h4>  Context change with with and foreach - pitfall </h4><br>  Suppose we have an array in which the strings that we want to track are stored. <br>  The array initialization looks like this: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obArray = ko.observableArray([ ko.observable(‚ÄúTask One‚Äù), ko.observable(‚ÄúTask Two‚Äù), ko.observable(‚ÄúTask Three‚Äù) ]);</code> </pre><br>  And we want to display a form consisting of input for editing it like this: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùforeach:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">obArray</span></span></span><span class="hljs-tag">‚Äù&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtext‚Äù</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùvalue:</span></span></span><span class="hljs-tag"> $</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag">‚Äù/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In such a record, text fields will not work in two directions - changes to the text in the field will not affect the elements of the array, but changing the elements of the array will affect the contents of the text fields.  An example on <a href="http://jsfiddle.net/archangel_irk/BGBma/">jsfiddle</a> . <br><br>  The reason is that the template above is essentially equivalent to the following: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùforeach:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">obArray</span></span></span><span class="hljs-tag">‚Äù&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ko with: $data --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtext‚Äù</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùvalue:</span></span></span><span class="hljs-tag"> $</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag">‚Äù/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- /ko --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <code>with: $data</code> - here is the ‚Äúunpacking‚Äù of <code>$data: unwrapObservable( $data )</code> in order for the calls like <code>$data.somefield</code> inside the template.  But this unpacking substitutes <code>$data</code> instead of <code>$data</code> - its value.  How to get around this problem - I did not invent it without thinking.  But the user <a href="https://habrahabr.ru/users/lega/" class="user_link">lega</a> <a href="http://habrahabr.ru/post/164937/">suggested</a> using the option with creating a wrapper object ( <a href="http://jsfiddle.net/RJ7sr/1/">example</a> ), if you have several fields, then this method is justified and will work. <br><br><h4>  Work with text editors </h4><br>  We have already learned how to get the value from input using the event of the same name in real time, but what about the editors where the content is html elements?  We use <a href="https://developer.mozilla.org/en-US/docs/DOM/MutationObserver">MutationObserver</a> and  This api does not work everywhere, we support ourselves with other DOM events and write not quite cross-browser (modern browsers work fine) code that you can embed in your favorite editor: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     . var $editor = $( '#editor_wrapper' ); //     . function initActivityObserver( callback ){ //    Mutation    . var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver, //    . timeoutId, delay = 1000; //       . function handler( mutations ){ //    -   if ( timeoutId ) clearTimeout( timeoutId ); //      . timeoutId = setTimeout( callback.bind( window ), delay ); } if ( MutationObserver ){ //  Mutation Observers var observer = new MutationObserver( handler ); //         observer.observe( $editor.get(0), { attributes: true, childList: true, characterData: true, subtree: true }); //    ( ie9+) } else { $editor.on('DOMAttrModified DOMCharacterDataModified DOMNodeInserted DOMNodeRemoved DOMSubtreeModified', function(e){ //    -   if ( timeoutId ) clearTimeout( timeoutId ); //       timeoutId = setTimeout( callback.bind( window ), delay ); }); } }</span></span></code> </pre><br>  This is the function I use to update the model in one project, which uses a good <a href="http://www.redactorjs.com/">editor from imperavi</a> , if anyone needs this code as a plug-in, I can write and put it on a github. <br><br><h4>  Conclusion </h4><br>  The article turned out to be of normal size, but the material still remained - working with trees, writing your own bindings, jQuery knockout widgets and some other tricks and examples.  Vote in charge, comment, point out errors. <br><br>  For errors in spelling and punctuation, I ask in a personal. </div><p>Source: <a href="https://habr.com/ru/post/164937/">https://habr.com/ru/post/164937/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../164917/index.html">When someone says "this is impossible," it means - as real as it is!</a></li>
<li><a href="../164923/index.html">Cfengine3 - a little about policy hub</a></li>
<li><a href="../164925/index.html">French provider blocks Internet advertising for all users.</a></li>
<li><a href="../164929/index.html">How much did you donate when downloading Ubuntu 12.10?</a></li>
<li><a href="../164935/index.html">Django: Generating secure error reports on the site</a></li>
<li><a href="../164939/index.html">HyTAQ Robot - a bird in a cage</a></li>
<li><a href="../164943/index.html">diFireplace: New Year's Habrakamin</a></li>
<li><a href="../164949/index.html">Hardware cheating or ‚ÄúThere is no reception against scrap, okromya other scrap‚Äù</a></li>
<li><a href="../164951/index.html">Samsung NP355V4C + Linux Review</a></li>
<li><a href="../164957/index.html">The amazing story of John McCafie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>