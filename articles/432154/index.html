<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Conditional Access as an access control mechanism</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous article, I mentioned the transition to Intune Standalone, which allowed us to make more use of the capabilities of Azure Active Direct...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Conditional Access as an access control mechanism</h1><div class="post__text post__text-html js-mediator-article">  In the previous <a href="https://habr.com/company/marsis/blog/413423/">article,</a> I mentioned the transition to Intune Standalone, which allowed us to make more use of the capabilities of Azure Active Directory, namely, to work with Conditional Access.  In this I will tell you more about how this can be done. <br><a name="habracut"></a><br>  <b>What it is?</b> <br><br><img src="https://habrastorage.org/webt/8d/ed/xz/8dedxzzzwnjok_d52iczjtssvwm.png"><br><br>  <b>Conditional Access (CA)</b> is the mechanism for checking each connection process to the system based on the configured script and the decision that sets what to do with this connection.  And it can be disabled, allowed without conditions, or allowed with conditions.  It is a component of Azure AD. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This script is described by the following settings: <br><br>  <b>Assignments</b> - in which cases the script should work. <br>  <b>Access controls</b> - what to do. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/8x/hl/cf8xhl2ynnfwls8r-owwsapfs5k.png"></div><br>  The <b>Assignments</b> section contains: <br><br>  - <b>Users and groups</b> - which users are subject to the policy.  This can be all users in Azure AD or specific groups / users.  Separately, you can specify exceptions.  You can apply the policy to all users except for a specific group. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5k/lo/pc/5klopc4lukzek4de5raxcjvm-mi.png"></div><br>  - <b>Cloud apps</b> - scripts can be applied to any application registered in Azure AD.  That is, you are not limited to working only with Office 365 applications. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ge/8g/gb/ge8ggbckzgpzxy0ul8kddnesv2w.png"></div><br>  - <b>Conditions</b> - additional conditions. <br>  - <b>Sign-in risk</b> - the possibility of using the authorization risk assessment mechanism.  Estimated from where, at what time, with which client, how much this behavior is usually, etc.  Azure AD Premium 2 license required. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kp/uh/rq/kpuhrqy04kfnwwao0ak7nveoqis.png"></div><br>  - <b>Device platforms</b> - it is possible to specify to which platform the policy will be applied.  For example, creating a policy for mobile clients only or for Windows machines only. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ju/nu/c9/junuc91ng6tmtuyqsnx3qdxurp0.png"></div><br>  - <b>Locations</b> - imply network locations.  You can use the list of trusted IP addresses. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mh/jf/k1/mhjfk1j31va5iug0gypukd6bny8.png"></div><br>  - <b>Client apps (preview)</b> - evaluates the type of client.  It is possible to use to create a policy only for the browser or EAS (Exchange Active Sync).  For those who want to close the use of OWA on mobile devices, but leave the option for desktop computers. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yz/qb/em/yzqbemst5fehz3itfrnwyuvc0rm.png"></div><br>  - <b>Device state (preview)</b> - allows you to exclude devices in a certain status. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/ic/4t/zgic4tas1bme_kokpzu_t43jyw4.png"></div><br>  Next, you need to configure what exactly the policy will do or require. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gn/sf/kx/gnsfkxg5klfaauys-ma38sxry4s.png"></div><br>  There are two sections for this: <br><br>  <b>Grant</b> - this is where the script is configured: block access or require additional security measures. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qt/0g/qw/qt0gqwnkqiebpmmn3dvmdb9yoam.png"></div><br>  <b>Session</b> - control in the session itself.  While it is possible to use only with Exchange Online and Sharepoint Online.  More information <a href="https://techcommunity.microsoft.com/t5/Azure-Active-Directory-Identity/Conditional-Access-8220-limited-access-8221-policies-for/ba-p/245228">here</a> . <br><br>  Now let's look at some usage scenarios. <br><br>  <b><b>Scenario 1:</b> Access Azure AD apps only on Intune-managed mobile devices.</b> <br><br>  Suppose we need to restrict access to applications registered in Azure AD and give it only to devices that are controlled by Intune.  And it should be applicable for all devices. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hr/mc/fq/hrmcfqdhjgpshocykz0ibyneddu.png"></div><br>  We choose to apply the policy to all users. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bo/va/yy/bovayy7uqicjxdxxxnmlinzch4c.png"></div><br>  Next, select all applications. <br><br>  <b>IMPORTANT:</b> The Azure Management Portal (portal.azure.com) is also regarded as an application, so be careful.  There is a bike - if you create a policy for all users and all applications that will block any connections, then no one will ever fall into your tenant and even Microsoft support will not help you. <br><br>  Now we need to configure the policy to apply only to mobile devices.  To do this, go to Device Platforms and select mobile OS (iOS, Android, Windows Phone). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mg/tz/vw/mgtzvwen_ydefgjmkuucscknnju.png"></div><br>  We have selected all the necessary conditions to apply the policy, now we choose the condition for allowing the connection.  In this case, the necessary option is the requirement for the device to comply with the security policies in Intune (Compliance Policy).  The device status is taken from Intune. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/aq/3h/st/aq3hstd_xxe8dryjqrmb639a55s.png"></div><br>  After creating and applying a policy, users with Intune-managed devices will continue to use applications.  Those who have used devices not connected to Intune will see a message prompting them to register the device. <br><br>  <b><b>Scenario 2.</b> Access to the corporate portal only from corporate computers.</b> <br><br>  You must configure synchronization between Active Directory and Azure Active Directory.  Thus, computers from AD will exist as Hybrid Azure AD joined.  The internal portal must be registered with Azure AD.  You can even configure SSO. <br><br>  Now it's up to the policy that will be applied to the right users and require connecting only with Hybrid Joined devices when connected to the specified portal / application.  It only works out of the box with IE and Edge.  Chrome will require an extension. <br><br>  <b>And if something breaks?</b> <br><br>  At some point in time, you can detect situations where the user cannot log in to the application and you don‚Äôt quite understand which policy is to blame. <br><br>  In this case, the Sign-in logs in Azure AD will help with filtering by the status of policy application. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/v1/_u/yd/v1_uydwmtwyv7hryj-gwg3zgixm.png"></div><br>  In the details of each event, you can see what policy worked and why. <br><br>  <b>findings</b> <br><br>  Conditional Access allows the flexibility to differentiate access to applications and services.  The conditions and usage scenarios can be infinite.  Best of all, this service is revealed with Microsoft services.  For example, it can be integrated with the Azure Application Proxy to limit access to internal resources or integrate with endpoint protection when closing access to a corporate network. </div><p>Source: <a href="https://habr.com/ru/post/432154/">https://habr.com/ru/post/432154/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../432144/index.html">How we integrated for SAP stores in Europe with cash registers in Russia through 1C</a></li>
<li><a href="../432146/index.html">Zimbra Collaboration Suite as a worthy replacement for Microsoft Exchange</a></li>
<li><a href="../432148/index.html">Features of testing credits: how one bug affects thousands of dollars in revenue</a></li>
<li><a href="../432150/index.html">Retrospective of automation and changes in the development processes of Timeweb</a></li>
<li><a href="../432152/index.html">Conclusions about the future of retail after the ‚ÄúBlack Friday‚Äù</a></li>
<li><a href="../432156/index.html">New 2GIS - connect to public testing</a></li>
<li><a href="../432158/index.html">Using JIRA and Confluence in a large project</a></li>
<li><a href="../432160/index.html">Android Kolesa Mobile video: modular development, backend driven UI and continuous integration</a></li>
<li><a href="../432162/index.html">‚ÄúWe try to give real life stories‚Äù: about the Heisenbug 2018 Moscow program</a></li>
<li><a href="../432166/index.html">Apache NiFi: what it is and a brief overview of the features</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>