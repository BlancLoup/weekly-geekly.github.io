<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Testing installers in Windows when you need to quickly and cheaply</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Happy web testers, take Selenium and you will not go wrong. Happy java-testers, for them there are test frameworks, in especially difficult cases, sic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Testing installers in Windows when you need to quickly and cheaply</h1><div class="post__text post__text-html js-mediator-article">  Happy web testers, take Selenium and you will not go wrong.  Happy java-testers, for them there are test frameworks, in especially difficult cases, siculi.  Console applications were brought to the tests - python, perl are nice here.  What about the desktop?  Testing of blackbox applications in windows, in particular, installers (for example, msi packages) led me to the autoit camp, inasmuch as my automation every time runs on the same rake, which I highlighted in the following <br><a name="habracut"></a><br><h2>  What you need from the installer autotest: </h2><br><ol><li>  Click, instead of me, where necessary - in the Russian and English versions of the interface and so that without editing the source code.  There are many different ways to do this, but I liked the <a href="http://www.autoitscript.com/site/autoit/downloads/">Autoit</a> way <a href="http://www.autoitscript.com/site/autoit/downloads/">more</a> - it‚Äôs enough to know the name of the object instance and you can send a push message to it, the only minus is you need to know the name of the window where our button is located, both in Russian and English. </li><li>  Do not float with a bunch of the same code, for example, if I need to go through windows 1, 2 and 3 to press button 2 or button 3, I would like to combine pressing buttons in windows 1, 2, 3 into some kind of abstraction ‚Äúpath to buttons 2 and 3 "and call it as needed. </li><li>  Reports about the debris, how far I had time to report, in general, what I did.  Maybe even make screenshots before pressing the buttons? <div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  Somehow then implement </div></div></li><li>  Report on the result, if everything is done, Smok test that all the actions actually performed, and not that the buttons were pressed.  For the installer - whether the files have appeared, whether the services are active, whether the interface is running. </li><li>  I do not want to recompile and scatter new exe.  I want to edit a crashed autotest right on the machine where it fell, the writing environment of the autotest should not change the environment - JAVA, .net, etc.  Hundreds of cases - my tests went off with a bang, the client does not have - they forgot to attach any .net.  Basically, for this reason, the options for using siculi- have fallen off, it is very expensive to roll back java, to check that everything did not work without it either. </li><li>  A tester in an ordinary world full of pain and despair is not what is shown in the marketing smooth movie about tfs if it‚Äôs very lucky - you and the girl who carefully follow the test plan (I‚Äôm not lucky and the girl is absent).  She doesn't need python, thousands of thousands of features from cpan.  It is necessary - to remove the routine.  Even as a bonus in perishable reality, testers will be half-betting students, cool, but as soon as a student masters perl, python, he will run away to coders and be lucky if he has time to complete the testing task that he has been given.  So I came to the idea of ‚Äã‚Äãa minimum of opportunities for programming during testing. </li><li>  The execution path is not the same on all operating systems, somewhere uac window appears, somewhere not, I do not want to bother with it every time.  There must be some branching method when performing a test path. </li></ol><br><br>  Putting everything in the list, I came to the next idea - I need my clicker windows <i>with settings in ini-files and reports</i> . <br>  Ok, we take into account the experience of generations, we will use the unix-way: we divide the task into two parts - the clicker and the report generator. <br>  A clicker clicks on the objects specified in the simplest, preferably self-documented, text file - buttons, simulates keystrokes. <br><br>  The report builder is a separate prog, written for each specific case, it can check services, create files in the right place, compare the output for the dir command, for example, with the standard and so on, if necessary.  In most cases, it is not even necessary, because experience shows that it is constantly required to check the new functionality and have to watch it yourself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      An example of settings for a clicker: the ways.ini file, which contains unique test execution paths: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  [PathToButtonSetup] <br>  LogMessage = Take First Window, push button1 <br>  WindowsNameEnglish = System Setup <br>  WindowsTextEnglish = Welcome to <br>  Element = [CLASS: Button;  INSTANCE: 1] <br>  WindowsNameRussian = System Installation <br>  WindowsTextRussian = to exit the wizard <br>  SendKeyText = <br>  LogMessage = Take second Window, push button2 <br>  WindowsNameEnglish = System Setup <br>  WindowsTextEnglish = Welcome to <br>  Element = [CLASS: Button;  INSTANCE: 2] <br>  WindowsNameRussian = System Installation <br>  WindowsTextRussian = You install <br>  SendKeyText = <br>  [Clicksetup] <br>  LogMessage = Take Therth Window, push button1 <br>  WindowsNameEnglish = System Setup <br>  WindowsTextEnglish = Complete <br>  Element = [CLASS: Button;  INSTANCE: 1] <br>  WindowsNameRussian = System Installation <br>  WindowsTextRussian = Everything is ready <br>  SendKeyText = <br>  [ClickCancel] <br>  LogMessage = Take Therth Window, push button2 <br>  WindowsNameEnglish = System Setup <br>  WindowsTextEnglish = Complete <br>  Element = [CLASS: Button;  INSTANCE: 2] <br>  WindowsNameRussian = System Installation <br>  WindowsTextRussian = Everything is ready <br>  SendKeyText = <br></div></div><br>  Actually now, having a description of what can be done with the installer, we will assemble a test path, describing it in another ini-file, testway1.ini. <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  [initials] <br>  countOps = 7 <br>  ClickerIniPath = "ways.ini" <br>  sLogPath = "logs.txt" <br><br>  [testWay] <br>  case1 = PathToButtonSetup <br>  case2 = Clicksetup </div></div><br>  If we need to check the button, we make another ini file, testway2.ini <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  [initials] <br>  countOps = 7 <br>  ClickerIniPath = "ways.ini" <br>  sLogPath = "logs2.txt" <br><br>  [testWay] <br>  case1 = PathToButtonSetup <br>  case2 = ClickCancel </div></div><br>  countOps - the number of readable settings from the ways.ini - now there are 7 of them: LogMessage, WindowsNameEnglish, WindowsTextEnglish, Element, WindowsNameRussian, WindowsTextRussian, SendKeyText.  sLogPath is the file name for messages, LogMessage.  The rest is probably clear from the names.  The Element property will have to be defined through the Au3Info.exe program. <br><br>  Sample code that can work with such ini-files, clickAndType.au3: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"> #include &lt;file.au3&gt; <br>  $ sLogMsg = "" <br>  $ TestWayIniPath = "clickandtype.ini" <br>  if $ CmdLine [0] &lt;&gt; 0 Then $ TestWayIniPath = $ CmdLine [1] <br>  $ countOps = IniRead ($ TestWayIniPath, 'initials', "countOps", "7") <br>  $ ClickerIniPath = IniRead ($ TestWayIniPath, 'initials', 'ClickerIniPath', "clicker.ini") <br>  $ sLogPath = IniRead ($ TestWayIniPath, 'initials', 'sLogPath', "logs.txt") <br><br>  $ TestWay = IniReadSection ($ TestWayIniPath, 'testWay') <br>  If <code>@error</code> Then <br>  MsgBox (4096, "", "Error occured, probably no INI file.") <br>  Exit <br>  Endif <br><br>  ;  We will read the chosen execution path. <br>  For $ TestWayElement = 1 to $ testWay [0] [0] <br>  $ ControlsActivities = IniReadSection ($ ClickerIniPath, $ TestWay [$ TestWayElement] [1]) <br>  If <code>@error</code> Then <br>  MsgBox (4096, "", "Error occured, probably no INI file.‚Äû &amp; $ ClickerIniPath &amp; '' &amp; $ TestWay [$ TestWayElement] [1]) <br>  Endif <br><br>  $ stopCycle = abs ($ ControlsActivities [0] [0] / $ countOps) <br>  For $ Elements = 0 to $ StopCycle-1 <br>  $ win = $ ControlsActivities [$ Elements * $ countOps + 2] [1] <br>  $ wintex = $ ControlsActivities [$ Elements * $ countOps + 3] [1] <br>  $ ControlToPress = $ ControlsActivities [$ Elements * $ countOps + 4] [1] <br>  $ winEng = $ ControlsActivities [$ Elements * $ countOps + 5] [1] <br>  $ wintexEng = $ ControlsActivities [$ Elements * $ countOps + 6] [1] <br>  $ SendString = $ ControlsActivities [$ Elements * $ countOps + 7] [1] <br>  $ sLogMsg = $ ControlsActivities [$ Elements * $ countOps + 1] [1] <br>  _FileWriteLog ($ sLogPath, 'Window:' &amp; $ win &amp; '' &amp; $ wintex &amp; 'Action:' &amp; $ sLogMsg) <br><br>  While 1 <br>  if WinActive ($ win, $ wintex) Then <br>  $ winEng = $ win <br>  $ wintexEng = $ wintex <br>  Exitloop <br>  ElseIf WinActive ($ winEng, $ wintexEng) then <br>  $ win = $ winEng <br>  $ wintex = $ wintexEng <br>  Exitloop <br>  Endif <br><br>  sleep (3) <br>  WinActivate ($ win, $ wintex) <br>  WinActivate ($ winEng, $ wintexEng) <br>  Wend <br>  if $ controlToPress &lt;&gt; "" then <br>  ControlClick ($ win, $ wintex, $ ControlToPress) <br>  Endif <br><br>  if $ SendString &lt;&gt; "" Then <br>  Send ($ SendString) <br>  Endif <br>  _FileWriteLog ($ sLogPath, 'Done') <br>  Next <br>  Next </div></div><br>  The launch run requires a parameter ‚Äî the name of the file to get the settings (testway2.ini, for example, which indicates what to execute from the ways.ini file). <br><br>  How can all this economy achieve branching from point 7?  It's very simple, when starting, the test hangs in the tray and waits for the specified window to appear, you can run several autotest programs in parallel, one of which, for example, will respond to the window requiring you to enter a password, enter it and the initial test will continue its execution as if nothing happened. <br>  About the second prog - report generator, I probably will not write, it‚Äôs all very individual there. <br><br>  Ok, it can click for me, what's next, Brain?  It is necessary to get rid of the vicious practice of launching an autotest with your own hands, a good idea is to prepare special virtuals, make a BeforeInstallXXX snapshot that will contain a batch file of the form, runme.bat, in autorun: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  msiexec / i "\\ fileshare \ install \ installer.msi" <br>  start "testway1" / wait clickAndType.exe \\ fileshare \ install \ testway1.ini </div></div><br>  It remains only to place the installer under test in the file sphere and reboot the virtual machines.  If you are lucky enough, you can also place the autotest on the file balloon, then all changes will be centralized and you will save time on copying testway.ini, ways.ini configuration files to each virtual machine. <br><br>  As your requests grow, most likely you will come to the conclusion that the runme.bat functionality needs to be complicated, as far as I can tell, soon there will be a third program to run, which will replace runme.bat, and, apparently, will know how Some conditions choose the option to start clickAndType.exe <br><br>  9 out of 10 I put on the fact that everything described above is a bicycle that was invented 1000 times already 1000 different people and in fact everything rested on the fact that they all had a fatal flaw ‚Äî they were not written by me, the bonus was written by programmers who, in spurts maximum versatility often spawned monsters, and I, being the main customer, and the user was interested in the simplicity of the tool and implemented it.  At the same time I will say that I was not lucky to find any information on testing installers in windows with simple googling.  Now she will be here. </div><p>Source: <a href="https://habr.com/ru/post/197586/">https://habr.com/ru/post/197586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197574/index.html">October 23 - Virtual Conference "All about Windows 8.1" for developers</a></li>
<li><a href="../197578/index.html">Paradoxes of set theory and their philosophical interpretation</a></li>
<li><a href="../197580/index.html">How we work with the iPhone camera in QCamplr</a></li>
<li><a href="../197582/index.html">KiCad and GOST. HBO Library</a></li>
<li><a href="../197584/index.html">Yandex bought Film Search</a></li>
<li><a href="../197588/index.html">Collected Website Psd Layout Requirements</a></li>
<li><a href="../197590/index.html">MonoDB vs PostgreSQL performance comparison. Part I: No index</a></li>
<li><a href="../197592/index.html">Digging into SAP data</a></li>
<li><a href="../197594/index.html">System.exit (). What exit code to use?</a></li>
<li><a href="../197596/index.html">Brainbench: 600 free certificates till 10.25.2013</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>