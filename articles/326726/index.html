<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Conjuring technical interview</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I offer the readers of "Habrakhabr" a translation of the (possibly better) article by Kyle Kingsbury, aka "Aphyr". 


 A long time ago, in Svalbard, w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Conjuring technical interview</h1><div class="post__text post__text-html js-mediator-article"><p>  I offer the readers of "Habrakhabr" a translation of the (possibly better) <a href="https://aphyr.com/posts/341-hexing-the-technical-interview">article by</a> Kyle Kingsbury, aka "Aphyr". </p><br><p>  A long time ago, in Svalbard, when you were a young witch only forty-three years old, your mother took your not yet scarred hands in your palms and said: </p><br><blockquote>  Vidrun, conceived from the sea winds in the tops of the firs, <br>  Vidrun, the green of my branches, the joy and burden of my days, <br>  Vidrun, all inspired and cleverer, may the wisdom of our clan be yours: <br>  Never read Hacker News </blockquote><a name="habracut"></a><br><p>  But Hacker News read about you, and rumors spread through their mysterious nests filled with indispensable giggles.  That‚Äôs why a young man offering you gifts of a buffet from a micro-kitchen already looks a little doubtful.  He quickly takes you to the glass box of the conference room.  For some reason, it causes claustrophobia, despite full transparency.  You mentally note to avoid this room in the future, but you are sure that there was nothing personal in inviting you here. </p><br><p>  "So, my name is Tim, and I will be your first interviewer ..." - Tim tries his best to seem joyful.  His ears protrude slightly, and because of a dark brown sweater and cream t-shirt, he, anxiously leaning over the table, somewhat resembles a marten.  You like martens, and therefore like Tim. </p><br><p>  "Before we begin, can I ... answer your questions about the company?" </p><br><p>  You would like to ask where Tim would hide his nest of nuts and bird eggs from other martens - but in return you just giggle about yourself, lean against a tree-like camp against the wall and settle comfortably on the floor.  Tim arches to see more clearly where you have gone.  "Definitely," you think to yourself. </p><br><p>  "So, uh ... Could you, say, say a little about yourself?" </p><br><p>  He did not read your resume.  No one can. </p><br><p>  "In winter, above the ice-covered fjords," you begin, "there is a rock, like an ashen hat covered with ghosts of glaciers--" </p><br><p>  "You know!".  He interrupts you.  This is a beautiful story, but it may be possible to tell it later.  "How about programming a little together? Just a few basic exercises, so that I understand what you think ?!" </p><br><p>  "Nice offer, Tim." </p><br><p>  "Okay, great."  Tim seems to be confident that he was back in the rut of the interview.  "Let's open the editor. Um ... would you like to sit down?" </p><br><p>  "Sit down!"  - You slap on the floor next to him, "So much safer."  Tim stares in disbelief at the brackets of spilled salt, shakes his head, but carefully sits down beside him. </p><br><p>  Tim retells an ancient riddle, he does not know its origin, and therefore he confuses words.  Several travelers get lost in the woods, on a winding mountain path, and are worried that they may be walking in circles.  They need to know - does the path to freedom lead?  Or make them wander through the forest forever? </p><br><p>  As the tradition goes, the group has to split up: the fastest foot rushes forward, while the others go slowly.  If the runner is catching up with them, then the path goes in a loop. </p><br><p>  "Let's start with the linked list?"  - you smile assuredly. </p><br><p>  "Yes," Tim says, "but ... um ... just a normal linked list, please. I know that you are, well, doing functional programming, but we have a more pragmatic office here. We are creating a real software. We need something more practical ". </p><br><p>  "Yes, of course," you agree, "Practical. Understood."  One of your spiders - you don‚Äôt see which one - gently sneak over Tim‚Äôs sweater, and you put the spider in your palm before you start. </p><br><pre><code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">ns</span></span> cycle-detector.core (<span class="hljs-symbol"><span class="hljs-symbol">:require</span></span> [clojure.java.io <span class="hljs-symbol"><span class="hljs-symbol">:as</span></span> io]) (<span class="hljs-symbol"><span class="hljs-symbol">:import</span></span> (<span class="hljs-name"><span class="hljs-name">java</span></span>.io DataOutputStream ByteArrayOutputStream)))</code> </pre> <br><p>  "We, uh, don't need an IO here. Just a list in memory." </p><br><p>  Politely agree, but do not delete anything.  Never apologize for who you are. </p><br><pre> <code class="hljs perl">; A simple mutable linked list (deftype MutableLinkedList [value <span class="hljs-keyword"><span class="hljs-keyword">next</span></span>] clojure.lang.Seqable (se<span class="hljs-string"><span class="hljs-string">q [_]</span></span> (lazy-se<span class="hljs-string"><span class="hljs-string">q (cons value (seq @next)</span></span>)))) (defn node [value] (MutableLinkedList. value (atom nil))) (defn <span class="hljs-keyword"><span class="hljs-keyword">link</span></span>! [node <span class="hljs-keyword"><span class="hljs-keyword">next</span></span>] (<span class="hljs-keyword"><span class="hljs-keyword">reset</span></span>! (.next node) <span class="hljs-keyword"><span class="hljs-keyword">next</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">next</span></span>)</code> </pre> <br><p>  "This is ... a bit not what I expected," says Tim.  "No, no, good! Straight and simple. I just, you know, on the Internet they say that you ...".  He subsides, and looks apologetically at you. </p><br><p>  You disarm and smile and shake free hands from your woolen sleeves.  Then you clap your palms, firmly put them on top of the disk and open the portal to the Lower World. </p><br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">gen-class</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:name</span></span> cycle_detector.core.ArbClassLoader <span class="hljs-symbol"><span class="hljs-symbol">:extends</span></span> ClassLoader <span class="hljs-symbol"><span class="hljs-symbol">:state</span></span> state <span class="hljs-symbol"><span class="hljs-symbol">:init</span></span> class-loader-init <span class="hljs-symbol"><span class="hljs-symbol">:constructors</span></span> {[ClassLoader String bytes] [ClassLoader]} <span class="hljs-symbol"><span class="hljs-symbol">:exposes-methods</span></span> {defineClass superDefineClass resolveClass superResolveClass} <span class="hljs-symbol"><span class="hljs-symbol">:prefix</span></span> <span class="hljs-string"><span class="hljs-string">"-"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:main</span></span> false)</code> </pre> <br><p>  ‚ÄúExcuse me,‚Äù says Tim from over his shoulder, ‚ÄúI'm not an expert at Clojure. Why is that?‚Äù </p><br><p>  "Just a boilerplate. Don't worry."  Tim looks even more concerned.  "We do that all the time." </p><br><pre> <code class="hljs kotlin">(defn -<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loader</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">init</span></span></span><span class="hljs-class"> [^</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ClassLoader</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loader</span></span></span><span class="hljs-class"> ^</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> ^</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytes</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytecode</span></span></span><span class="hljs-class">] [[</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loader</span></span></span><span class="hljs-class">] </span></span>{:<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> :</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">bytecode bytecode}]) </span></span></span></span>(defn -loadClass ([<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> ^String <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">] </span></span>(-loadClass <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">)) </span></span>([<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> ^String <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">resolve</span></span></span><span class="hljs-class">?] </span></span>(<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (= <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span></span>(:<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span></span>(.state <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>))) (let [bytecode (:bytecode (.state <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)) c (.superDefineClass <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytecode</span></span></span><span class="hljs-class"> </span></span>(int <span class="hljs-number"><span class="hljs-number">0</span></span>) (int (alength bytecode)))] (<span class="hljs-keyword"><span class="hljs-keyword">when</span></span> resolve? (.superResolveClass <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> c)) c) (.loadClass (.getParent <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">)))) </span></span>(defn <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loader</span></span></span><span class="hljs-class"> [^</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> ^</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytes</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytecode</span></span></span><span class="hljs-class">] </span></span>(cycle_detector.core.ArbClassLoader. (.getClassLoader MutableLinkedList) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytecode</span></span></span><span class="hljs-class">))</span></span></code> </pre> <br><p>  The colors start to run away from Tim's face.  Looks like winter has come and he decided to fade. </p><br><pre> <code class="hljs pgsql">(defn run-bytecode [bytecode <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-<span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">method</span></span>-<span class="hljs-type"><span class="hljs-type">name</span></span> signature &amp; args] (-&gt; <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-<span class="hljs-type"><span class="hljs-type">name</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-loader bytecode) (.loadClass <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-<span class="hljs-type"><span class="hljs-type">name</span></span>) (.getMethod <span class="hljs-keyword"><span class="hljs-keyword">method</span></span>-<span class="hljs-type"><span class="hljs-type">name</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">into</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> signature)) (.invoke nil (<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">array</span></span> args))))</code> </pre> <br><p>  "Clojure is a dynamic language," you readily explain, "So when we push Java classes back and forth, some reflection usually happens." </p><br><p>  "It seems that you ... wrote a classloader solely to return an array of single bytes for a particular class? Is it ... is this normal?" </p><br><p>  "Yes," you insist, eyes flashing menacingly. </p><br><p>  "Why not just write an algorithm on Clojure?" </p><br><p>  "Productivity" - you quite honestly explain.  "Since constant checks will be carried out in a close inner loop, we absolutely do not want to write them in such a high-level language." </p><br><p>  "X-well" - Tim stutters "So you write a java loop test? Will you call it from Clojure?" </p><br><p>  "Something like that". </p><br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">def</span></span> racer (<span class="hljs-name"><span class="hljs-name">-&gt;&gt;</span></span> [<span class="hljs-number"><span class="hljs-number">0</span></span>xca <span class="hljs-number"><span class="hljs-number">0</span></span>xfe <span class="hljs-number"><span class="hljs-number">0</span></span>xba <span class="hljs-number"><span class="hljs-number">0</span></span>xbe</code> </pre> <br><p>  "What is it?" </p><br><p>  "Magic numbers".  You're a witch, after all.  "Every class starts with a girl in a cafe" <br>  [original - babe in a cafe, cm 0x <strong>ca</strong> 0x <strong>fe</strong> 0x <strong>ba</strong> 0x <strong>be</strong> ] </p><br><p>  "What?" </p><br><p>  "You know, a handsome man - like those who go to the movies - relaxes in the afternoon after a walk. In his hands a cup of coffee, orange glasses sparkle in the sun, and beautiful girls jog past him. If one is lucky, his gaze may be will meet her eyes, and they will smile at each other, and together they will find a brick-lined alley. Her lips will meet his skin, and she will feel the heat of the sun under her ... " </p><br><p>  "Sorry what?" </p><br><p>  To be honest, you never understood the concept of Sun in this story, or why the Java Virtual Machine specification, usually so prosaic, is thrown into sensory rhapsody on many stanzas in section 4.1. </p><br><pre> <code class="hljs"> 0x00 0x00 ; Minor 0x00 0x31 ; Major</code> </pre> <br><p>  "We are using version 49 because it does not require stack maps, which simplifies the task. Now we need a number of constants" </p><br><p>  Remember the future.  This is a common trick for spellcasters, many of whom lived like Merlin, writing down the constants and the size of the buffers even before (after) how they wrote (did not write) the buffers themselves. </p><br><p>  Remember that 22 is enough.  Write it down. </p><br><pre> <code class="hljs"> 0x00 0x17 ; 22 constants</code> </pre> <br><p>  ‚ÄúI apologize‚Äù - Tim blinks ‚ÄúBut after all, 0x17 is 23, not 22 decimal?‚Äù </p><br><p>  ‚ÄúOg √©n,‚Äù you chant after me - ‚ÄúTil javanissen!‚Äù </p><br><p>  "I apologize?" </p><br><p>  "Javanis. You probably heard about them! They are small magical people - like gnomes - who live in each JVM. If you don‚Äôt give them one extra constant, they‚Äôll spoil them with segfolts. But please javanisk and your mutexes will work like a butter." </p><br><p>  This is a story from childhood.  You remember the mother mumbling offsets and stirring the brew in the cauldron.  ‚ÄúBy byter for bufferen anvise / og ekstra √©n til javanisse.‚Äù This is a joyful memory, and you forget a little about it until Tim reminds you of your cough. </p><br><p>  "Oh yes. Constants. We need our superclass. Object, of course. I would usually use the existing class to reduce the size, but here we work only with interfaces, so there will be an Object. And I think we need a class for ourselves." </p><br><pre> <code class="hljs javascript"> <span class="hljs-number"><span class="hljs-number">0x01</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x10</span></span> ; <span class="hljs-number"><span class="hljs-number">1</span></span>: A UTF<span class="hljs-number"><span class="hljs-number">-8</span></span> string <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"java/lang/Object"</span></span>) <span class="hljs-number"><span class="hljs-number">0x07</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x01</span></span> ; <span class="hljs-number"><span class="hljs-number">2</span></span>: The <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> 0</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x01</span></span></span><span class="hljs-class"> 0</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x00</span></span></span><span class="hljs-class"> 0</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x19</span></span></span><span class="hljs-class"> </span></span>; <span class="hljs-number"><span class="hljs-number">3</span></span>: UTF<span class="hljs-number"><span class="hljs-number">-8</span></span> string <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">25</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"cycle_detector/core/Racer"</span></span>) <span class="hljs-number"><span class="hljs-number">0x07</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x03</span></span> ; <span class="hljs-number"><span class="hljs-number">4</span></span>: Our <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></code> </pre> <br><p>  We take Iterable and call .iterator (), which means we will need: </p><br><pre> <code class="hljs vhdl"> <span class="hljs-number"><span class="hljs-number">0</span></span>x01 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x12 ; <span class="hljs-number"><span class="hljs-number">5</span></span>: UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"java/lang/Iterable"</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>x07 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x05 ; <span class="hljs-number"><span class="hljs-number">6</span></span>: Iterable <span class="hljs-number"><span class="hljs-number">0</span></span>x01 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x08 ; <span class="hljs-number"><span class="hljs-number">7</span></span>: UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"iterator"</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>x01 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x16 ; <span class="hljs-number"><span class="hljs-number">8</span></span>: UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"()Ljava/util/Iterator;"</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>x0c <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x07 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x08 ; <span class="hljs-number"><span class="hljs-number">9</span></span>: Name <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> info (<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>x0b <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x06 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x09 ; <span class="hljs-number"><span class="hljs-number">10</span></span>: Interface methodref <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Iterable.iterator()</code> </pre> <br><p>  "And for this iterator we will need hasNext and Next () ...".  Now the bytes will go faster.  This is much better than the Old Norse hexography, where even and odd numbers had the same rune. </p><br><pre> <code class="hljs vhdl"> <span class="hljs-number"><span class="hljs-number">0</span></span>x01 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x12 ; <span class="hljs-number"><span class="hljs-number">11</span></span>: UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"java/util/Iterator"</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>x07 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x0b ; <span class="hljs-number"><span class="hljs-number">12</span></span>: Iterator <span class="hljs-number"><span class="hljs-number">0</span></span>x01 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x07 ; <span class="hljs-number"><span class="hljs-number">13</span></span>: UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"hasNext"</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>x01 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x03 ; <span class="hljs-number"><span class="hljs-number">14</span></span>: UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"()Z"</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>x0c <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x0d <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x0e ; <span class="hljs-number"><span class="hljs-number">15</span></span>: Name <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> info <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> .hasNext() <span class="hljs-number"><span class="hljs-number">0</span></span>x0b <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x0c <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x0f ; <span class="hljs-number"><span class="hljs-number">16</span></span>: Interface methodref: Iterator.hasNext() <span class="hljs-number"><span class="hljs-number">0</span></span>x01 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x04 ; <span class="hljs-number"><span class="hljs-number">17</span></span>: UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"next"</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>x01 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x14 ; <span class="hljs-number"><span class="hljs-number">18</span></span>: UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"()Ljava/lang/Object;"</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>x0c <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x11 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x12 ; <span class="hljs-number"><span class="hljs-number">19</span></span>: Name <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> info <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">next</span></span>() <span class="hljs-number"><span class="hljs-number">0</span></span>x0b <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x0c <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x13 ; <span class="hljs-number"><span class="hljs-number">20</span></span>: Iterator.<span class="hljs-keyword"><span class="hljs-keyword">next</span></span>()</code> </pre> <br><p>  Tim was numb. </p><br><p>  "Now you can think," you mutter, "that usually the code is hidden in a class, and therefore we should assign it a separate byte label - but instead, we would be good at sticking the word" Code "into each class and using it to identify our code attributes ". </p><br><pre> <code class="hljs vhdl"> <span class="hljs-number"><span class="hljs-number">0</span></span>x01 <span class="hljs-number"><span class="hljs-number">0</span></span>x00 <span class="hljs-number"><span class="hljs-number">0</span></span>x04 ; <span class="hljs-number"><span class="hljs-number">21</span></span>: UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"Code"</span></span>) ; <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> code attributes</code> </pre> <br><p>  Finally, our signature.  Take Iterable and return a boolean value. </p><br><pre> <code class="hljs lua"> <span class="hljs-number"><span class="hljs-number">0x01</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x17</span></span> ; <span class="hljs-number"><span class="hljs-number">22</span></span>: UTF<span class="hljs-number"><span class="hljs-number">-8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> of <span class="hljs-number"><span class="hljs-number">23</span></span> bytes (.getBytes <span class="hljs-string"><span class="hljs-string">"(Ljava/lang/Iterable;)Z"</span></span>) ; Our <span class="hljs-built_in"><span class="hljs-built_in">arg</span></span> signature</code> </pre> <br><p>  "Well".  It is necessary to crunch knuckles and apply the ancient seal. </p><br><pre> <code class="hljs pgsql"> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x21</span></span> ; Flags: <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> &amp; super <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x04</span></span> ; Our <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x02</span></span> ; Our superclass (<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>) <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">No</span></span> interfaces <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">No</span></span> fields <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x01</span></span> ; One <span class="hljs-keyword"><span class="hljs-keyword">method</span></span></code> </pre> <br><p>  Every young witch of your clan had to learn these bytes.  What pride you felt when you first made a class without javac training supports!  So, the beginning of the method: </p><br><pre> <code class="hljs pgsql"> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x09</span></span> ; Flags: <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> &amp; static <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x15</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">Method</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> (<span class="hljs-number"><span class="hljs-number">21</span></span>, "Code")</code> </pre> <br><p>  "Method names must begin in lower case," says Tim.  But his voice sounds like it was a question. </p><br><p>  "Only by agreement. Almost any string will do, and we already have one in the pool of constants." </p><br><pre> <code class="hljs pgsql"> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x16</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">Method</span></span> signature (<span class="hljs-number"><span class="hljs-number">22</span></span>) <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x01</span></span> ; One <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">Method</span></span> attributes <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x15</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> (<span class="hljs-number"><span class="hljs-number">21</span></span>, "Code") <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x48</span></span> ; + <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> bytecode-length <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span>-len <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x02</span></span> ; Maximum stack <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x04</span></span> ; Number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> variables</code> </pre> <br><p>  ‚ÄúWait, wait, wait,‚Äù Tim grabs a sliver during a storm.  "Just four slots for variables? For arguments plus local ones?" </p><br><p>  ‚ÄúOg to til javanissen!‚Äù - you remind him.  Tim gasps the air while you remember how many instructions she wrote. </p><br><pre> <code class="hljs pgsql"> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x3c</span></span> ; Size <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> bytecode</code> </pre> <br><p>  Your method begins by creating a pair of iterators from a single argument, Iterable. </p><br><pre> <code class="hljs lua"> <span class="hljs-number"><span class="hljs-number">0x2a</span></span> ; aload_0 (take <span class="hljs-built_in"><span class="hljs-built_in">arg</span></span>) <span class="hljs-number"><span class="hljs-number">0xb9</span></span> ; invokeinterface <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x0a</span></span> ; .iterator() <span class="hljs-number"><span class="hljs-number">0x01</span></span> ; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">arg</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> ; unused <span class="hljs-number"><span class="hljs-number">0x4d</span></span> ; astore_1 (store iterator) <span class="hljs-number"><span class="hljs-number">0x2a</span></span> ; aload_0 (take <span class="hljs-built_in"><span class="hljs-built_in">arg</span></span>) <span class="hljs-number"><span class="hljs-number">0xb9</span></span> ; invokeinterface <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x0a</span></span> ; .iterator() <span class="hljs-number"><span class="hljs-number">0x01</span></span> ; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">arg</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> ; unused <span class="hljs-number"><span class="hljs-number">0x4e</span></span> ; astore_0 (store iterator)</code> </pre> <br><p>  ‚ÄúProbably astore_2 is needed here?‚Äù Tim asks, trying to help.  ‚ÄúThe zero variable contains our first argument, right?‚Äù </p><br><p>  "So it was," you agree, "But we don‚Äôt need it anymore." </p><br><p>  "But ... they are not even of the same type. This is ... it is illegal." </p><br><p>  "If it was illegal," you patiently remind him, "then Sun Microsystems would make it impossible." </p><br><p>  The first will be a fast iterator.  Her name will be Yorun, her legs will be strong from many years of skiing.  She flies forward with powerful shocks. </p><br><pre> <code class="hljs lua"> <span class="hljs-number"><span class="hljs-number">0x2d</span></span> ; aload_1 take fast iterator <span class="hljs-number"><span class="hljs-number">0xb9</span></span> ; invokeinterface <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x10</span></span> ; hasnext <span class="hljs-number"><span class="hljs-number">0x01</span></span> ; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">arg</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> ; unused <span class="hljs-number"><span class="hljs-number">0x9a</span></span> ; ifne <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x05</span></span> ; jump ahead <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> we have a <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> element <span class="hljs-number"><span class="hljs-number">0x03</span></span> ; iconst_0 <span class="hljs-number"><span class="hljs-number">0xac</span></span> ; ireturn (<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>) ; Move fast iterator forward by <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0x2d</span></span> ; aload_1 (take fast iterator) <span class="hljs-number"><span class="hljs-number">0xb9</span></span> ; invokeinterface <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x14</span></span> ; .<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>() <span class="hljs-number"><span class="hljs-number">0x01</span></span> ; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">arg</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> ; unused <span class="hljs-number"><span class="hljs-number">0x57</span></span> ; discard element ; Ensure fast iterator has <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> <span class="hljs-number"><span class="hljs-number">0x2d</span></span> ; aload_1 (take fast iterator) <span class="hljs-number"><span class="hljs-number">0xb9</span></span> ; invokeinterface <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x10</span></span> ; hasNext() <span class="hljs-number"><span class="hljs-number">0x01</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x9a</span></span> ; ifne <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x05</span></span> ; jump forward by <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> we have a <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> element <span class="hljs-number"><span class="hljs-number">0x03</span></span> ; iconst_0 <span class="hljs-number"><span class="hljs-number">0xac</span></span> ; ireturn</code> </pre> <br><p>  Bjorn in the zero register will be fat and lazy.  He slowly treads ahead like his namesake.  [Bj√∏rn - bear]. </p><br><pre> <code class="hljs vbscript"> <span class="hljs-number"><span class="hljs-number">0x2c</span></span> ; aload_0 (take slow iterator) <span class="hljs-number"><span class="hljs-number">0xb9</span></span> ; invokeinterface <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x14</span></span> ; .<span class="hljs-keyword"><span class="hljs-keyword">next</span></span>() <span class="hljs-number"><span class="hljs-number">0x01</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span></code> </pre> <br><p>  Yorunn, so that she was not caught up, makes another breakthrough.  Her gait is hard. </p><br><pre> <code class="hljs vbscript"> <span class="hljs-number"><span class="hljs-number">0x2d</span></span> ; aload_1 (take fast iterator) <span class="hljs-number"><span class="hljs-number">0xb9</span></span> ; invokeinterface <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x14</span></span> ; .<span class="hljs-keyword"><span class="hljs-keyword">next</span></span>() <span class="hljs-number"><span class="hljs-number">0x01</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span></code> </pre> <br><p>  Knowing their position on the path, you check to see if they will collide with each other;  and if not, repeat the process again: </p><br><pre> <code class="hljs go"> <span class="hljs-number"><span class="hljs-number">0xa6</span></span> ; if_acmpne <span class="hljs-number"><span class="hljs-number">0xff</span></span> <span class="hljs-number"><span class="hljs-number">0xd7</span></span> ; <span class="hljs-number"><span class="hljs-number">0xffff</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-number"><span class="hljs-number">41</span></span> instructions ; Return <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-number"><span class="hljs-number">0x04</span></span> ; iconst_1 <span class="hljs-number"><span class="hljs-number">0xac</span></span> ; ireturn</code> </pre> <br><p>  Your sixty bytes are over, you quite sigh and put sealing runes on your spell before you convert each number into a single clever byte. </p><br><pre> <code class="hljs pgsql"> ; <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> bytecode <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">No</span></span> exceptions <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">No</span></span> attributes ; <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">method</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> <span class="hljs-number"><span class="hljs-number">0x00</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">No</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> attributes ] (map (fn [x] (<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (instance? Long x) (unchecked-byte x) x)))))</code> </pre> <br><p>  Tim politely tries to get the interview back to normal.  Bless him, but not too much, or else he will be dragging you on Twitter for years, begging spells against every computational malady that will hit him.  A conspiracy against minor file system damage will do. </p><br><p>  Now you shake off the frost from your fingers, enter the torus deeply into the virtual machine and unwind a strong serialization loop. </p><br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">defn</span></span> write-class! [^DataOutputStream ds class-data] (<span class="hljs-name"><span class="hljs-name">doseq</span></span> [x class-data] (<span class="hljs-name"><span class="hljs-name">condp</span></span> = (<span class="hljs-name"><span class="hljs-name">class</span></span> x) <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> Long (.writeLong ds x) Integer (.writeInt ds x) Short (.writeShort ds x) Byte (.writeByte ds x) (.write ds ^bytes x)))) (<span class="hljs-name"><span class="hljs-name">defn</span></span> class-bytes [class-data] (<span class="hljs-name"><span class="hljs-name">let</span></span> [baos (<span class="hljs-name"><span class="hljs-name">ByteArrayOutputStream</span></span>.)] (<span class="hljs-name"><span class="hljs-name">with-open</span></span> [ds (<span class="hljs-name"><span class="hljs-name">DataOutputStream</span></span>. baos)] (<span class="hljs-name"><span class="hljs-name">write-class!</span></span> ds class-data)) (.toByteArray baos)))</code> </pre> <br><p>  "Baos rhymes with chaos" - you politely inform Tim.  He confusedly asks about the unit tests.  In the preparations you weave a story about a path in the forest, which closes in with itself. </p><br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">deftest</span></span> cycle-test (<span class="hljs-name"><span class="hljs-name">let</span></span> [nodes (<span class="hljs-name"><span class="hljs-name">mapv</span></span> node (<span class="hljs-name"><span class="hljs-name">range</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>)) list (<span class="hljs-name"><span class="hljs-name">first</span></span> nodes)] (<span class="hljs-name"><span class="hljs-name">reduce</span></span> link! nodes) (<span class="hljs-name"><span class="hljs-name">link!</span></span> (<span class="hljs-name"><span class="hljs-name">nth</span></span> nodes <span class="hljs-number"><span class="hljs-number">3</span></span>) (<span class="hljs-name"><span class="hljs-name">nth</span></span> nodes <span class="hljs-number"><span class="hljs-number">1</span></span>))</code> </pre> <br><p>  Before you cast the spell, you turn to the sides of the world marked with scars on your wrist: H, J, K, L. Only J gives answers like you, but being polite never hurts. </p><br><pre> <code class="hljs pgsql">(deftest <span class="hljs-keyword"><span class="hljs-keyword">cycle</span></span>-test (let [<span class="hljs-keyword"><span class="hljs-keyword">cycle</span></span>? (partial run-bytecode (<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>-bytes racer) "cycle_detector.core.Racer" "Code" [Iterable])] (<span class="hljs-keyword"><span class="hljs-keyword">is</span></span> (<span class="hljs-type"><span class="hljs-type">boolean</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cycle</span></span>? (seq list)))) (<span class="hljs-keyword"><span class="hljs-keyword">is</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> (<span class="hljs-type"><span class="hljs-type">boolean</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cycle</span></span>? [])))) (<span class="hljs-keyword"><span class="hljs-keyword">is</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> (<span class="hljs-type"><span class="hljs-type">boolean</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">cycle</span></span>? [<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>])))))))) Ran <span class="hljs-number"><span class="hljs-number">1</span></span> tests containing <span class="hljs-number"><span class="hljs-number">3</span></span> assertions. <span class="hljs-number"><span class="hljs-number">0</span></span> failures, <span class="hljs-number"><span class="hljs-number">0</span></span> errors.</code> </pre> <br><p>  "Three hundred and fifty-six bytes" - you declare, and with pleasure you have to stretch.  "Javac would have made about five hundred and eighty. Of course, we saved by skipping stackmap and line mapping, but additionally we reduced the number of variables, and also threw out four unnecessary astore / aload operations. Of course, since the class is never instantiated, we don‚Äôt need to generate the &lt;init&gt; method, or call the superclass ". </p><br><p>  Tim stares at you with silent interest.  His jacket shines from fast-melting frost.  Most likely you are hired. </p><br><p>  You reach into the pocket of your mantle, and gently, with slow movements, so as not to frighten him back into the burrow, stretch your hand, unclench your fingers, and offer him a nut. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/326726/">https://habr.com/ru/post/326726/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326716/index.html">Native ECMAScript Modules - First Review</a></li>
<li><a href="../326718/index.html">Go to your personal account on zakupki.gov.ru without Internet Explorer and other useful tips when working with CryptoPro</a></li>
<li><a href="../326720/index.html">Record a WebRTC video stream from a webcam browser towed to Amazon S3</a></li>
<li><a href="../326722/index.html">Methods for circumventing web application security tools when operating XSS vectors</a></li>
<li><a href="../326724/index.html">Corporate portal. What is it? What for? Who and when?</a></li>
<li><a href="../326728/index.html">Visualizing Interface Animation Requirements</a></li>
<li><a href="../326732/index.html">Lync SDK 2013. Rethinking the experience of developing your own Lync-based instant messenger (Skype for Business)</a></li>
<li><a href="../326734/index.html">‚ÄúNow Required‚Äù: Issuing SSL Certificates with DNS Records</a></li>
<li><a href="../326736/index.html">The desktop is not dead yet, but the mobile already dominates the entire market. Interview with Dmitry Navosha, CEO Sports.ru</a></li>
<li><a href="../326738/index.html">[Peter, April 19] JUG.ru meeting with Gleb Smirnov - How to spoil everything with your Java agent</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>