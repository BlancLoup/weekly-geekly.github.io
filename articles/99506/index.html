<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New 0-day or feature from Microsoft?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started with the fact that on July 9, specialists of the Belarusian antivirus company VirusBlokad discovered an interesting malware whose drive...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New 0-day or feature from Microsoft?</h1><div class="post__text post__text-html js-mediator-article">  It all started with the fact that on July 9, specialists of the Belarusian antivirus company VirusBlokad <a href="">discovered an</a> interesting malware whose drivers had a legal digital signature from Realtek.  The surprises did not end there, since this malware used a previously unknown vulnerability in the processing of LNK files (Shell Link) for unauthorized distribution from various USB-drives.  Having seen this informational message, we also paid attention to this threat, and noticed a rather interesting landscape of its distribution (data obtained through our system of early detection of threats <a href="http://www.eset.com/threat-center/threatsense-net">ThreatSense.Net</a> ). <br><img src="https://habrastorage.org/getpro/habr/post_images/8f2/df4/924/8f2df4924d3189c8e7602c63a7fd19fa.png" alt="image"><br><br><a name="habracut"></a><br><br><table><tbody><tr><td>  United States </td><td width="100">  57.71% </td></tr><tr><td>  Iran </td><td width="100">  30.00% </td></tr><tr><td>  Russia </td><td width="100">  4.09% </td></tr><tr><td>  Indonesia </td><td width="100">  3.04% </td></tr><tr><td>  Faore islands </td><td width="100">  1.22% </td></tr><tr><td>  United kingdom </td><td width="100">  0.77% </td></tr><tr><td>  Turkey </td><td width="100">  0.49% </td></tr><tr><td>  Spain </td><td width="100">  0.44% </td></tr><tr><td>  India </td><td width="100">  0.29% </td></tr><tr><td>  Rest of the world </td><td width="100">  1.73% </td></tr></tbody></table>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      According to the statistics we obtained, it is clear that the United States is clearly the leading region in the number of infections.  Further, with a double separation comes Iran, followed by Russia. <br>  In part, this distribution of data is confirmed by <a href="http://blogs.technet.com/b/mmpc/archive/2010/07/16/the-stuxnet-sting.aspx">statistics</a> from Microsoft, but it is possible that it deliberately omitted data for the United States, since an active investigation is under way related to the appearance of this threat.  MS only on Saturday July 16th MS released <a href="http://www.microsoft.com/technet/security/advisory/2286198.mspx">Security Advisory</a> , which officially confirmed the presence of this vulnerability.  So let's talk now about the technical details of this threat. <br><br>  <b>Method of distribution: 0-day or feature?</b> <br><br>  The only way to spread this malicious program is to infect USB drives.  Interestingly, the way to launch a malicious program uses a previously unknown vulnerability in the processing of LNK files contained on a USB drive.  Malicious code execution occurs due to a Windows Shell vulnerability related to the display of specially prepared LNK files.  The contents of the infected drive look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/77c/548/0e8/77c5480e85620b6eb2767c05b4e6e48f.png" alt="image"><br><br>  You can see that in the root directory there are two hidden files that are installed during the system infection.  The LNK files themselves contain the following: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/41d/825/667/41d825667a4802b241df4750eb3ebf58.png" alt="image"><br><br>  The figure shows the part that actually contains the data that allow <br>  unauthorized executable file.  When viewing the contents of a USB drive in Windows Explorer or any other file manager, LNK files are automatically loaded into memory.  Vulnerability allows to execute arbitrary dynamic library, in our case it is ~ WTR4141.tmp. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b6/e8c/9a3/0b6e8c9a318266afc6072e0de8e11c89.png" alt="image"><br><br>  All operating systems ranging from Windows XP and including Windows 7 are vulnerable. We detect LNK files that exploit this vulnerability as LNK / Autostart.  And now let's talk about the actual malicious components that are installed in the system. <br><br>  <b>Win32 / Stuxnet</b> <br><br>  The most insidious and unexpected for the antivirus industry turned out that some components of this malicious program have a legitimate digital signature (at the moment this certificate has already been <a href="http://threatpost.com/en_us/blogs/verisign-revokes-certificate-used-sign-stuxnet-malware-071710">revoked</a> ).  And even more interesting was the fact that the certificate was issued to Realtek. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/554/491/aac/554491aacacf15196972b38470758f43.png" alt="image"><br><br>  In particular, he signed the library that runs in connection with the vulnerability of processing LNK files.  Also, the two drivers have signatures installed in the system.  All this makes it possible to bypass most HIPS systems, since the presence of a digital signature on many systems is considered a sign of a legal program. <br>  In the process of analyzing this malware, no obvious ways of cybercriminal monetization were identified.  But the possibilities of collecting information from SCADA systems were found, which, as a rule, are used at large industrial enterprises.  And the hidden possibilities of network interaction, give every reason to believe that Win32 / Stuxnet is aimed at industrial espionage.  While the investigation is underway, we were forbidden to make public some of the details associated with this malware, so for now we will limit ourselves to this information only. <br>  In the meantime, we recommend that you familiarize yourself with <a href="http://blog.didierstevens.com/2010/07/18/mitigating-lnk-exploitation-with-ariad/">information</a> on infection prevention using this 0-day, published by independent researcher Didier Stevens. </div><p>Source: <a href="https://habr.com/ru/post/99506/">https://habr.com/ru/post/99506/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../99499/index.html">Apple: "And we have few complaints about the quality of reception." HTC: ‚ÄúAnd we don‚Äôt have them at all!‚Äù</a></li>
<li><a href="../99500/index.html">Testing with the help of aitraker to perform tasks on the website alget.ru</a></li>
<li><a href="../99501/index.html">How Microsoft DevDiv uses TFS - part 1</a></li>
<li><a href="../99502/index.html">Agiledays in St. Petersburg, September 17, 2010</a></li>
<li><a href="../99505/index.html">We make links in the flash-banner, not having the source</a></li>
<li><a href="../99508/index.html">Online monitoring of transport with their own hands</a></li>
<li><a href="../99510/index.html">Sony Vaio Z - almost a year together</a></li>
<li><a href="../99513/index.html">NetCraft's July report on http server popularity</a></li>
<li><a href="../99514/index.html">Curious Reef - site for online students</a></li>
<li><a href="../99515/index.html">Parallel technology</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>