<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we built vulnerability management</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction to the issue 
 In our practice of working with different types of customers - from large international companies to small firms or even i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we built vulnerability management</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/oi/ob/0k/oiob0kho5_4dtjj3tssc_j-5cdq.jpeg"><br><br><h2>  Introduction to the issue </h2><br>  In our practice of working with different types of customers - from large international companies to small firms or even individual entrepreneurs - we see similar problems when trying to systematically work with vulnerabilities. <br><br>  While the company is relatively small, it is enough to have one or more vulnerability scanners and one specialist who will periodically check the entire infrastructure, closing the most obvious or simple problems to fix. <br><a name="habracut"></a><br>  In practice, when a company grows, the number of devices in the network grows, new information systems are used, including non-standard ones, there is not enough simple approach, because business wants to get answers to the questions: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  And with what vulnerabilities from the scanner report (there may be thousands and tens of thousands) need to work and why? </li><li>  How much does fixing these vulnerabilities cost? </li><li>  But can anyone really use them to launch an attack? </li><li>  And what do I risk if I do not fix anything? </li><li>  And how to make sure that everything is fixed? </li></ul><br>  Not every security specialist and system administrator will immediately have a clear answer to all these questions.  Also, do not forget that in itself the management of vulnerabilities is a rather complicated process, and there are many factors that influence decision making: <br><br><ul><li>  high risks of falling victim to a massive or targeted attack, if vulnerabilities are not eliminated in time (especially for the external perimeter); </li><li>  the high cost of eliminating for many vulnerabilities, especially if there is no ready-made patch or a large number of distributed devices are vulnerable (this is often a stop factor, and as a result, problems persist); </li><li>  if different people or even companies are responsible for different types of equipment, they do not always have the necessary qualifications to correctly assess the vulnerabilities found, the elimination process may be extremely time-consuming or not begin at all; </li><li>  if specialized equipment or SCADA systems are used, then the probability of missing the necessary patches from the manufacturer or the impossibility of updating the system in principle is high. </li></ul><br>  Because of all this, the vulnerability management process, implemented haphazardly, does not look effective and understandable in the eyes of the business. <br><br>  Taking into account the needs of the business and understanding the specifics of working with information security vulnerabilities, we invented a separate service in Acribia. <br><br><h2>  What did we come up with? </h2><br>  We felt that the management of vulnerabilities should be approached systematically, as with any process.  And this is precisely the process, and continuous and iterative, consisting of several stages. <br><br><h4>  Client connection </h4><br>  We take care of providing, configuring and supporting all the necessary tools.  The client is only required to allocate a virtual or physical server (perhaps several if the network is large and distributed).  We ourselves will install everything you need and configure it to work correctly. <br><br><h3>  Inventory and asset profiling </h3><br>  In short, the point is to identify all the devices on the network, divide them into groups of the same type (the level of detail of such a partition may vary depending on the size of the client‚Äôs network or the presence of a large number of specific devices), select the groups for which the service is provided, find out persons responsible for selected groups. <br><br><img src="https://habrastorage.org/webt/fi/og/fy/fiogfy6ej8io-eg2zz-1epokbwa.png"><br><br>  It is important not just to carry out this procedure one-time, but to highlight the patterns in order to at any time understand what is happening on the network, find new devices, find old devices that have moved, find new subtypes within groups, and so on.  It is important.  Inventory occurs constantly with a predetermined frequency.  In our practice, we came to the conclusion that without an understanding of the structure of assets, effective management of vulnerabilities is not feasible. <br><br>  We have been working on the asset profiling algorithm for a long time, each time adding new conditions or altering it altogether.  We will not disclose all the technical details and cite the lines of code implementing our algorithm, we give only a general sequence of actions: <br><br><ol><li>  The client provides an IP network plan. </li><li>  Using a network scanner, a fingerprint is formed for each device based on open network ports and OS. </li><li>  Profiles are combined by device and type (for example, Cisco Catalyst 2960 \ Network equipment). </li><li>  When a new device appears, the most similar profile is searched. </li><li>  If the accuracy is insufficient, then the type of device is specified at the client. </li><li>  A repeated network scan is periodically carried out to update the data and search for new devices and types. </li></ol><br>  In the absence of an accurate IP network plan (for example, using DHCP or the ‚Äúhuman factor‚Äù), an online profiling option is possible based on several well-known IP addresses.  Next, similar devices are identified within the type, and the profile is upgraded. <br><br>  This approach allows us to determine the type of device with an accuracy of about 95%, but you always want more.  We are open to new ideas, comments and comments.  If there is something that we did not consider, we are ready to discuss in the comments. <br><br><h4>  Scan schedule </h4><br>  When we already have all the necessary information about the client's network, we make a schedule of scanning for vulnerabilities, taking into account the required frequency of checks for each type of device.  Periodicity can be any - from 1 day to 1 year.  Frequency on the one hand depends on how quickly and how often the client is ready to work with the vulnerabilities of this or that equipment, on the other hand it influences the price of the service. <br><br>  For example, a plan might look like this: <br><br><img src="https://habrastorage.org/webt/ct/_l/np/ct_lnpuc2vbkyyp_rwzsfa44qa4.png"><br><br>  It is important to note that we strongly recommend checking the outer perimeter of the network daily to minimize the risk of exploiting 1-day (just published) vulnerabilities.  The same recommendation applies to public client Web resources. <br><br><h4>  Actually, scanning </h4><br>  A week before the scheduled start date of scanning groups of devices, we contact the person in charge of the group, inform him about the scan dates and send a full list of devices that we will check.  At this stage, you can adjust (if necessary) the scope of the check.  This is done in order to minimize the risks of incorrect recognition of devices on the network. <br><br>  After the scan is completed, the person in charge is also informed.  Those.  interested parties are ALWAYS aware of what is happening. <br><br>  We use several different scanners, including separate tools for finding vulnerabilities in web systems.  So we get more information for analysis and can find more potential problems. <br><br>  To optimize costs, we may not scan the entire group of devices of the same type, but restrict ourselves to a representative sample, for example, 30-50% of randomly selected devices from the group or 30-50% of devices from each geographically distributed office.  When critical vulnerabilities are found on selected devices, a search is started for specific vulnerabilities already on all devices of the group.  So we get the most complete coverage in less time. <br><br>  It is important to note that there are separate vulnerabilities that are not detected by standard tools.  When we start to scan a certain type of device, we check all public vulnerabilities and make sure that our scanners are able to find them.  If we understand that the standard tool is not enough, then we look for individual vulnerabilities manually or develop our own tools for testing. <br><br>  And most importantly, when information about a new dangerous vulnerability appears in the public space, we will not wait for a scheduled scan.  All customers who are potentially affected by the vulnerability they have just found will be promptly notified of the problem, and we will perform an unscheduled check. <br><br>  In general, a detailed description of the vulnerability search technology used by us is somewhat beyond the scope of this article, but you can familiarize yourself with it with the <a href="https://acribia.ru/events/soc-forum_2017">presentation</a> that we did at the SOC-Forum in 2017. <br><br><h4>  Analysis of scan results </h4><br>  If you have ever run a vulnerability scanner on a corporate network of 100+ hosts, then you probably remember the very feeling that arises when you see a kilometer list of similar entries, from the contents of which, at first glance, little is clear.  Without special knowledge it is difficult to adequately assess what is left as it is, and what needs to be corrected, and in what order to act. <br><br>  We undertake this step, we look at the results, we choose really critical problems that can cause real damage to the client‚Äôs business. <br><br>  We estimate such parameters as: <br><br><ul><li>  availability of a vulnerable device / service for a potential intruder; </li><li>  the presence of a public exploit; </li><li>  operational complexity; </li><li>  potential business risk; </li><li>  Is it a false positive? </li><li>  difficulty of elimination; </li><li>  And so on. </li></ul><br>  After processing, the ‚Äútested and approved‚Äù vulnerabilities are published by us in the incident management system (we will talk about it separately), where the client‚Äôs staff can see them, ask questions, take them to work or reject them if they take risks. <br><br>  If necessary, we also assign a consultation with the person responsible for vulnerable devices and tell in detail what is found, what it threatens and what options to minimize the risks are. <br><br>  After the transfer of the vulnerability to work, the ball goes to the client, and we proceed to scanning the next group of devices. <br><br>  But the process for the first group does not end there. <br><br><h4>  Vulnerability Control </h4><br>  In the system for each published vulnerability, you can put the status and deadline for elimination.  We track status changes as well as the approaching deadline. <br><br>  If the vulnerability is closed by the client, we see it and run a scan to make sure that the vulnerability is really no more.  Because  the scan runs only on one vulnerability, it does not take much time, the result can be obtained in a day for hundreds of thousands of hosts or even in seconds for a small group of devices. <br><br>  If the vulnerability is really closed, we confirm it.  If the vulnerability on all or part of the devices from the group is preserved, then we return for revision. <br><br>  The cycle of work with each vulnerability ends only when we have confirmed that it is no longer on all vulnerable devices. <br><br>  The general scheme looks something like this: <br><br><img src="https://habrastorage.org/webt/c6/z2/e1/c6z2e1tsgwkyek_nqkpasm1vfuo.png"><br><br>  In the process of controlling the elimination of vulnerabilities, we can distinguish 2 auxiliary subprocesses: monitoring the timing and working with those responsible for closing the vulnerability on the part of the client. <br><br>  <i>Timing control</i> <br><br>  Again, for each vulnerability a deadline should be assigned to eliminate it.  This parameter is set by the client independently, i.e.  we do not dictate how fast the responsible employees of the client should work, but we monitor the achievement of goals.  If the tasks are overdue, the client‚Äôs vulnerability management process holder is notified of this.  Information about vulnerabilities that are closed on time or overdue is reflected in our periodic reports with the names of, so to speak, ‚Äúhonors‚Äù and ‚Äúlosers‚Äù.  We also consider such an indicator as the average speed of eliminating vulnerabilities.  So, the client collects the necessary information for scheduling, loading responsibles, as well as their achievements or omissions. <br><br>  <i>Work with responsible</i> <br><br>  Sometimes, for individual vulnerabilities, there is a need to assign several people in charge, transfer all or part of the work on a task to another person, or simply change the person in charge, because the first one failed, went on leave, went on sick leave, etc. All this allows our system to implement. <br><br>  The picture below shows the scheme of the service in the context of a single vulnerability. <br> <a href=""><img src="https://habrastorage.org/webt/2p/aw/mg/2pawmgs2qrtbpdj8g0ap6j2bely.png"></a> <br><br><h2>  Efficiency </h2><br>  This is how we built the work process and see in our approach a number of advantages and opportunities that will help to work more effectively with vulnerabilities and at the same time solve the problems identified in the first part of the article: <br><br><ol><li>  We undertake not only the task of launching scanners to search for vulnerabilities in the network, but also to analyze the results of their work.  We eliminate too much and the output is the final list of vulnerabilities with which you can and should work. </li><li>  Making out this list and presenting it to the responsible specialists of the customer, we always write 2 things: a detailed description of the meaning of vulnerability and the negative impact on the business that it carries, and recommendations for eliminating or minimizing risks.  Thus, you can always understand what will happen if you do nothing, and you can estimate the time and cost of implementing the recommended activities. </li><li>  If there are still doubts or arguments in favor of eliminating a certain vulnerability is not enough, we can additionally check the possibility of exploiting this vulnerability in real conditions or close to real ones.  After such a ‚Äúmini pentest‚Äù, it will be seen how possible and difficult the potential attacker will be to attack. </li><li>  Finally, when the work on fixing the vulnerability is completed, we always check it.  Thus, you can eliminate the risk of errors or omissions. </li></ol><br>  And the client, in turn, receives in our opinion valuable opportunities and can: <br><br><ul><li>  focus on really important groups of devices and monitor their status more often; </li><li>  focus on really dangerous vulnerabilities that can cause real damage; </li><li>  monitor the work on each vulnerability, track status changes and deadlines; </li><li>  receive individual advice on the closure of vulnerabilities; </li><li>  free up the time of your employees, which is necessary for launching and processing the results of scans, as well as for setting up and supporting all the necessary tools; </li><li>  Well, and as a bonus for the financial director - to transfer capital expenditures on the purchase of own instruments for scanning into operating rooms for the payment of expert services. </li></ul><br>  Interesting?  In the <a href="https://acribia.ru/services/soc">services</a> section on our website you can see the prices, as well as order testing services on special conditions. </div><p>Source: <a href="https://habr.com/ru/post/460048/">https://habr.com/ru/post/460048/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460036/index.html">Alice's B2B skill: from prototype to the first ruble saved</a></li>
<li><a href="../460038/index.html">Generation of dungeons in Diablo 1</a></li>
<li><a href="../460040/index.html">We get USRN extracts from Rosreestr, bypassing api. Expectations in python, square millimeters in Rosreestr</a></li>
<li><a href="../460044/index.html">Oven heater temperature control, with timer on Arduino</a></li>
<li><a href="../460046/index.html">BDD Python Framework Comparison: Pros and Cons</a></li>
<li><a href="../460052/index.html">Interoperability of Cisco Solutions at GosSOPKOY and FinCERT</a></li>
<li><a href="../460054/index.html">Tips for freelancers: how to catch zen while working</a></li>
<li><a href="../460058/index.html">Incredibly true stories from the life of tech support</a></li>
<li><a href="../460060/index.html">Creating Amazon Prime, the most successful and destructive membership program in Internet history</a></li>
<li><a href="../46007/index.html">Functional python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>