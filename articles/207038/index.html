<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Are there any more Telegram bookmarks?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As already mentioned in a recent post ‚Äú Is Telegram Safe? Or, as I was looking for a bookmark in MTProto, ‚Äù Telegram is a super secure messenger for s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Are there any more Telegram bookmarks?</h1><div class="post__text post__text-html js-mediator-article">  As already mentioned in a recent post ‚Äú <a href="http://habrahabr.ru/post/206900/">Is Telegram Safe? Or, as I was looking for a bookmark in MTProto,</a> ‚Äù <a href="http://telegram.org/">Telegram</a> is a super secure messenger for smartphones that is so secure that a contest with an impressive prize was announced for its breaking.  In that post, an effective attack on its protocol ( <a href="https://github.com/ex3ndr/telegram-mt">MTProto</a> ) was described, the brief essence of which is that "the <i>Telegram server can pick up a nonce in which the keys of users coincide even during a MITM attack and no one will know that they are listening to it</i> " where <i>nonce</i> meant ‚Äúrandom‚Äù data sequence involved in setting the key, it would seem, simply to increase entropy, but in reality it enabled the administrators of Telegram servers to easily and, most importantly, <i>not detectable for users</i> to perform <i>Man-in-middle</i> (MITM) attack on pr  tocol to exchange keys.  Some even found the code section responsible for the vulnerability - bookmark. <br><a name="habracut"></a><br>  To the credit of Telegram, quite quickly it was recognized that the vulnerability is present and its correction was announced in the next version of the messenger, and the author is <a href="http://vk.com/wall-52630202_7858">promised a</a> reward - <a href="http://habrahabr.ru/users/ibeatle/" class="user_link">ibeatle</a> writes: " <i>from now on, zero will always come to zero, and in the next layer we will definitely remove this field from the scheme and explain in the documentation</i> . "  Meanwhile, in the <a href="http://core.telegram.org/api/end-to-end">description of protocol</a> <sup>1,</sup> we already see that the ill-fated ' <i>xor nonce</i> ' has disappeared, and the code has <a href="https://github.com/DrKLO/Telegram/commit/5aee72ee33fd960df9173ab17942dd1a2ce912b5">changed</a> for the better.  Pavel Durov said: " <i>Just in case, I will explain to mass users: there was no data leakage, the vulnerability is closed, there is no danger</i> ."  All is well that ends well. <br><br>  But has the vulnerability disappeared and has Telegram become protected from an <i>undetectable</i> MITM?  There is an opinion that the administrators of Telegram servers <i>still could not</i> listen to users so that the verification of the keys will show that they match. <br><br>  To do this, it suffices to use a degenerate key attack on the <i><a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25BE%25D1%2582%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25BB_%25D0%2594%25D0%25B8%25D1%2584%25D1%2584%25D0%25B8_%25E2%2580%2594_%25D0%25A5%25D0%25B5%25D0%25BB%25D0%25BB%25D0%25BC%25D0%25B0%25D0%25BD%25D0%25B0">Diffie-Hellman</a></i> (DH) protocol.  The previous attack was on a part of the key establishment protocol algorithm that occurs immediately <i>after</i> DH, but there is also DH itself.  In the documentation, there is an attempt to protect against some attacks on DH - it is prescribed to check the public parameters of p and g: "it <i>‚Äôs a safe 2048-bit prime, and that g generates a cyclic subgroup of order (p-1) / 2.</i> "  But nothing is said about checking the public keys g_a and g_b. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To carry out an attack, it is enough for the server to replace both parameters <i>g_a</i> and <i>g_b</i> by <i>one</i> (1) sent from clients A and <i>B.</i>  In this case, both users as a result of the calculation of the private key will also have units.  The server (and any other observing attacked session) knowing this property of the DH protocol will be able to calmly decrypt and read their messages.  Although outwardly, everything will look "encrypted."  Moreover, the <i>key_fingerprint of</i> this degenerate key will not be visually distinguishable from a normal complex key, since the fingerprint is not the key itself, but the sha1 cryptohash from the key. <br><br>  To fix this vulnerability, a messenger would be enough to check that the <i>g_a</i> and <i>g_b sent are</i> not equal to one. <br><br>  _________ <br>  <sup>1</sup> Copy of the protocol description dated December 22: <a href="http://archive.is/Z8Keu">archive.is/Z8Keu</a> </div><p>Source: <a href="https://habr.com/ru/post/207038/">https://habr.com/ru/post/207038/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../207026/index.html">6 errors reduce the conversion of your store</a></li>
<li><a href="../207030/index.html">Dive into Litecoin, or how to start mining scrypt currency</a></li>
<li><a href="../207032/index.html">Installing the lightweight Jabber Prosody server (v0.9 and v0.10beta)</a></li>
<li><a href="../207034/index.html">Effective mental arithmetic or brain warm-up</a></li>
<li><a href="../207036/index.html">Little bit about fragment</a></li>
<li><a href="../207042/index.html">0day Wednesday - research on the latest malware</a></li>
<li><a href="../207044/index.html">Master in Finland - the experience of the year</a></li>
<li><a href="../207048/index.html">Sort using HTML5 Drag'n'Drop API</a></li>
<li><a href="../207050/index.html">Templates for creating services and services for Virtual Machine Manager 2012 R2</a></li>
<li><a href="../207052/index.html">‚ÄúEarth Rising‚Äù - reconstruction of the Apollo 8 flight to the Moon from NASA in honor of the 45th anniversary of the event</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>