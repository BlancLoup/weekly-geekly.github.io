<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As I was called paranoid and what came of it</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When did the leaks of the password / hash databases start from different forums and social services? networks, I began to think about how and where to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As I was called paranoid and what came of it</h1><div class="post__text post__text-html js-mediator-article">  When did the leaks of the password / hash databases start from different forums and social services?  networks, I began to think about how and where to store my passwords so that they can be quickly changed and not forgotten.  So I came across the program <a href="http://keepass.info/">KeePass Password Safe</a> , I will not <a href="http://keepass.info/">write</a> about its capabilities as there are <a href="http://habrahabr.ru/search/%3Fq%3DKeePass">plenty of</a> articles on Habr√© and the topic of this article is not about its capabilities.  As KeePass exploited, plug-ins overlaid, especially for browsing with browsers, <a href="https://lastpass.com/">LastPass</a> was discarded because I didn‚Äôt want to store passwords (especially to working systems) somewhere near my uncle, and it‚Äôs not a fact that they will not be merged from there either. <br><br>  At first, Firefox had the <a href="http://keefox.org/">KeeFox</a> extension, but since <a href="http://keefox.org/2010/03/24/keepassrpc-plugin/">KeePassRPC</a> (the KeePass plugin) only works, then this extension has long been disabled and not used.  Then the <a href="https://addons.mozilla.org/en-US/firefox/addon/passifox/">PassIFox</a> extension was found (it works through the KeePass plugin - <a href="http/">KeePassHttp</a> ) with <a href="http/">ChromeIPass</a> right <a href="http://chrome.google.com/webstore/detail/chromeipass/ompiailgknfdndiefoaoiligalphfdae%3Fhl%3Den">away</a> - but for Opera 11, Opera 12 (here and hereinafter implied on the Presto engine and this is my main browser) there was no good integration, it was only The UserJS script that adds the page address to the window title, even an <a href="https://addons.opera.com/en/extensions/details/keepass-auto-type/">extension</a> was created <a href="https://addons.opera.com/en/extensions/details/keepass-auto-type/">that</a> does the same thing - so that KeePass can determine the address for which you need to find a login and password for the substitution by Ctrl + Alt + A (standard KeePass auto-fill hot key) .  Since <u>I don‚Äôt have modern JavaScript skills</u> , I tried my luck on <a href="http://operafan.net/forum/index.php%3Ftopic%3D18474.msg184329">OperaFan</a> with a request to write / remake an extension for Opera - where I was called paranoid.  Continuing the story of porting Chrome IPass in Opera 12 (without much technical details) under the cut. <br><a name="habracut"></a><br><h4>  Important </h4>  Immediately, I‚Äôll make a reservation that not everything I managed to port, but for me it turned out quite workable, given the lack of an alternative.  Please do not kick for mistakes and implementation errors.  If someone tells me something, I will be grateful. <br>  I understand that Opera on the Presto engine is already a corpse, but as I wrote above, this is my main browser and so far I don‚Äôt see a replacement for it in terms of memory consumption, speed and the ability to finish the functionality.  I use the latest build of Opera AC with the buns drilled under it. <br><br><h4>  The first approach to the projectile </h4><br>  For porting to Opera, the ChromeIPass extension was chosen because looking inside it and LastPass, <a href="https://addons.opera.com/en/extensions/details/roboform-lite/">RoboForm Lite</a> and seeing approximately similar calls for Opera and Chrome - I made an assumption that they are closest (over time I realized that I was very wrong). <br>  The first patient was selected at that time version of ChromeIPass 1.0.7.  There was no password memorization functionality, poorly small knowledge about writing extensions and their interaction with the browser, little free time, the LastPass extension, like RoboForm, was written universal under Opera, Chrome and Safari and had huge dimensions.  There was a simple replacement of chrome.extension.sendMessage with opera.extension.postMessage with natural ‚Äúepic fail‚Äù.  In general, having made several attempts, I abandoned porting, although there were few scripts and I was ready to accept the addition of passwords through KeePass itself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  The second approach to the projectile </h4><br>  Two months ago, I discovered that the version of ChromeIPass is already 2.6.6 and there appeared a password memorization function and a number of other goodies.  And it even works without any changes in Opera (on the blink engine), slipping it in developer mode, and then it can be converted to NEX. <br>  This time it was decided to unambiguously achieve a working result.  Thoroughly reading about the interaction of the Injected script, Background script and Popup script in Opera, googling, looking at other extensions, having climbed the already closed forum and blogs on My Opera (I even had to dig into the Web Archive and google cache) - I started to work. <br><br>  The config.xml was created, the files were <u>placed</u> in the necessary directories, the <u>chrome.extension.sendMessage was</u> replaced with <u>opera.extension.postMessage</u> (in some places on <u>e.source.postMessage</u> where it was necessary to respond to the event - and not just send, <u>e - this event</u> , because in Chrome IPass there is an event object defined in event.js). <br><br>  All calls using Chuck's callback mechanism have been reworked to simply send events and add responses to these events in event handlers, where these callback functions are defined. <br><br>  Redone <u>chrome.tabs. *. AddListener</u> on <u>opera.extension.tabs. *</u> (For Opera, events <u>must be in lower case</u> otherwise it does not work) in init.js. <br>  <u>Opera.extension.tabs.onupdate</u> in Opera (chrome.tabs.onUpdated.addListener in Chrome) <u>does not work</u> . <br><br>  Debugging is enabled (displaying messages in the console) where it was, adding its own debugging messages to understand what and how it interacts with. <br><br>  Added a new extension in developer mode to a separately installed opera and launched Dragonfly. <br><br>  A lot of useful information was taken from the posts and blog of <b>Joel Spadin</b> aka <b>spadija</b> on my.opera.com and its <a href="https://addons.opera.com/en/extensions/details/tab-vault/">tab vault</a> and <a href="https://addons.opera.com/en/extensions/details/autostack/">autostack extensions</a> . <br><br>  For a start, I checked how the extension works with KeePass, in this part I didn‚Äôt alter almost anything.  works "with a bang." <br><br>  The introduction of CSS was done ( <a href="">it was here</a> ), as it later discovered the same method used in the <a href="http://dev.opera.com/articles/view/opera-extensions-prototypes-modifying-css">documentation</a> <br><br>  Then there was a struggle for the boot sequence of the Injected scripts (there are three of them in ChromeIPass: the main one and two converted jQuery and jQuery UI).  In Chrome, this is easier than in the Opera. <br>  The solution was found on the my.opera forum (no longer available) and for jQuery (in ChromeIPass, jQuery was renamed cIPJQ, so that there would be no conflict with the loaded jQuery from sites), the code for its initialization in init.js was added, so that errors would not fall out and have worked <br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cIPJQ; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> cIPJQ === <span class="hljs-string"><span class="hljs-string">'undefined'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.cIPJQ !== <span class="hljs-string"><span class="hljs-string">'undefined'</span></span>) { cIPJQ = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.cIPJQ.noConflict(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { opera.postError([<span class="hljs-string"><span class="hljs-string">'Error: could not load jQuery'</span></span>]); } }</code> </pre> <br>  I came up with a rake that opera.extension.bgProcess is a window object - not the background script itself. <br><br>  Replaced work with the replacement of addresses for the popup, the solution was taken <a href="http://webcache.googleusercontent.com/search%3Fq%3Dcache:Ih5WL38BdAgJ:my.opera.com/community/forums/findpost.pl%253Fid%253D13297612%2B%26cd%3D1%26hl%3Dru%26ct%3Dclnk%26gl%3Dsk%26client%3Dopera">from here</a> , while it is still in the Google cache. <br><br>  But with the ports had to tinker the longest.  So if you make the transfer of the port from the popup script to the injected script and back ( <a href="http://dev.opera.com/articles/view/opera-extensions-messaging/">as indicated in the documentation</a> ), the <u>e.source.postMessage</u> stops working on the events from the popup script in the background script.  I had to create another <u>MessageChannel</u> for the popup script to work with the background script.  And "poking" the closure of these all MessageChannel, because  There are problems that when creating tabs, the function <u>opera.extension.tabs.getSelected ()</u> returns a tab with port = null. <br><br>  In order to embed images, I first tried <a href="http://dev.opera.com/articles/view/extensions-api-resourceloader-getfile/">opera.extension.getFile ()</a> , but it turned out to be asynchronous, so it implemented the loading of images as well as loading CSS (via XMLHttpRequest) and when introducing styles, it replaced base64-encoded images. <br><br>  Actually the expansion itself: <br>  <a href="http://rghost.ru/53154991">rghost</a> , <a href="http://www.sendspace.com/file/765qq3">sendspace</a> <br>  with not commented out postError <br>  <a href="http://rghost.ru/53155054">rghost</a> , <a href="http://www.sendspace.com/file/9pgccc">sendspace</a> <br><br><h4>  Restrictions </h4><br><ul><li>  If you change the port for connecting to KeePassHttp, then you need to edit <code>/&gt;</code> in config.xml due to limitations in the <a href="http://www.w3.org/TR/widgets-access/">specification</a> for which the network access control of extensions is implemented in Opera. </li><li>  HTTP authorization interception does not work, because  in Opera, there is simply no such mechanism for interception. </li><li>  There are a lot of ‚ÄúUnknown pseudo class‚Äù errors in the console with the indication of the ": first" CSS attribute  At least in Dragonfly there were just a lot of them. </li><li>  Sometimes I have to refresh the page because of problems with the ports, I never managed to figure out why when creating new tabs the value port = null. </li><li>  It does not work out alert () in the background script, and there are no errors at all. </li><li>  Copying of the password to the clipboard from the password generator does not work, I haven‚Äôt been digging hard yet.  need to smoke <a href="http://dev.w3.org/2006/webapi/clipops/clipops.html">specification</a> </li></ul><br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/216239/">https://habr.com/ru/post/216239/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../216229/index.html">How is the infrastructure of data processing Sports.ru and Tribuna.com?</a></li>
<li><a href="../216231/index.html">Dorian / Satoshi Nakamoto made an official statement: ‚ÄúI have no relation to Bitcoin‚Äù</a></li>
<li><a href="../216233/index.html">The defeat of robots: the ups and downs of high-frequency trading (Part 1)</a></li>
<li><a href="../216235/index.html">The sacred cow, karma and mustache: how and why the Indians are not indifferent to IB</a></li>
<li><a href="../216237/index.html">Windows Pocket Concept</a></li>
<li><a href="../216241/index.html">Facebook vs. Google: the battle of technology giants has moved to the sky</a></li>
<li><a href="../216243/index.html">The second meeting of the Kiev Android developers in Ciklum March 22</a></li>
<li><a href="../216247/index.html">"Supersonic" upload photos to the Cloud using your own NSInputStream</a></li>
<li><a href="../216251/index.html">Create an application on Doophp 1.5</a></li>
<li><a href="../216253/index.html">Urban Jungle Street View: Plants Beat the Cities</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>