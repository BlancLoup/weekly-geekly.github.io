<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Diablo 3 - Resource Bubbles</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is a translation of the article by Diablo 3 - Resource Bubbles by Simon Schreibt. 



 There are three things in the world that I can loo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Diablo 3 - Resource Bubbles</h1><div class="post__text post__text-html js-mediator-article">  <i>This article is a translation of the article by Diablo 3 - Resource Bubbles by Simon Schreibt.</i> <br><br><img src="https://habrastorage.org/files/853/7e7/4f9/8537e74f9cd04d82aeab132e941032e4.jpg"><br><br>  There are three things in the world that I can look at forever: The fire, how others work and the resource areas in <a href="http://diablo3.com/">Diablo3</a> .  I already loved Blizzard, as you might have noticed in <a href="http://simonschreibt.de/gat/diablo-3-resource-bubbles/simonschreibt.de/gat/diablo-3-trees/">my article on their 2.5D trees</a> .  Today we are talking about something else.  Today we look deep into the crystal spheres of Diablo in search of truth. <br>  <i>(there are a lot of pictures inside)</i> <br><a name="habracut"></a><br><img src="https://habrastorage.org/files/c67/76a/262/c6776a2622fd40c98791b493eb89da2f.gif">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/626/148/575/62614857536748e1be0aab46cc4f9e45.gif"><br><br><img src="https://habrastorage.org/files/d47/191/cac/d47191cac17f4002a1014cfb5cf3c8ed.gif"><br><br>  They seem so deep.  So round.  Charming blend of blur and clarity.  Let me describe my first thoughts on how this could be achieved (if in a nutshell: they are both wrong. I'm on a false path (woodway), as we say in Germany): <br><br><h2>  First false trail </h2><br>  Take a polygonal sphere, cut off half and place textures on the surface.  Why is this wrong?  Because I checked the ‚Äúbubble‚Äù in-game grid.  And you know what?  This is NOT a bubble!  Look at my vision (red sphere) and the real mesh from Diablo3 (green), which, by the way, contains only 218 triangles against my 960. <br><br><img src="https://habrastorage.org/files/17a/68e/50a/17a68e50a95a419bbf39f70a632f9295.gif"><br><br><h2>  Second false path </h2><br>  I asked <a href="http://www.polyphobia.de/">Neox</a> what he thinks and he offered to take the sphere, bake it in the normal map and do everything else in the shader.  It was a good idea, but I could not find a similar texture in the Diablo files.  So why the hell do I waste your time on all this nonsense? <br>  Because <a href="http://www.polycount.com/forum/member.php%3Fu%3D75360">mikiex</a> posted a <a href="http://www.polycount.com/forum/showpost.php%3Fp%3D1802103%26postcount%3D176">great example</a> that is similar to the idea of ‚Äã‚ÄãNeox.  I think this will be <a href="http://simonschreibt.de/gat/007-legends-the-world/">my next article</a> .  And now just look at the image and notice how great the sphere of the Earth looks.  But we are not looking for easy ways. <br><br><img src="https://habrastorage.org/files/ac2/c95/997/ac2c95997e1c42e69aa1a7e61bf4ebb3.gif"><br><br>  Now let's talk about the right decision. <br><br><h2>  First hell trail - <i>‚ÄúUV scan‚Äù</i> </h2><br>  I managed to pull out the bubble grid and look at its texture pattern (UV).  And that's what it looks like: <br><br><img src="https://habrastorage.org/files/974/3f0/dac/9743f0daca2342e1b4b687485434ca77.jpg"><br><br>  UV modified (stretched at the edges and compressed in the center).  Let's see what happens when we apply the checkerboard pattern on the bubble and let the UV move from left to right: <br><br><img src="https://habrastorage.org/files/03f/b2b/85f/03fb2b85f8d1477391314fedfe48ae7f.gif"><br><br>  It may not look like an ideal sphere (more like a round hat), but since the edges of the bubble are mostly covered with painted reflections or this sad stone angel, it works very well in my opinion.  Actually, I think she looks cool. <br><img src="https://habrastorage.org/files/c67/76a/262/c6776a2622fd40c98791b493eb89da2f.gif"><br><br><h2>  The second hell trail - <i>"Geometry"</i> </h2><br><br>  However, the movement of only one texture will not create this beautiful tandem of movement and depth.  Thanks to the <s><a href="http://www.cainsarchive.com/">D3 model viewer,</a></s> we can see that there is more than one plane. <br><br><img src="https://habrastorage.org/files/44b/1d1/759/44b1d175933547b8ada0042d402be725.gif"><br><br>  You earned 666 points if you noticed that these textures contain a completely wrong color and pattern.  As an experienced player in the old Diablo2, I searched for the term ‚Äúmana‚Äù in files, but in the magician‚Äôs Diablo3 resources it is called Arcane Energy.  Mana is used by a sorcerer. <br>  Although it seems to me that they use a mana-bubble grid for this, since I could not find any special geometry under the arcane sphere. <br><br>  <a href="http://www.bb0x.com/">Bb0x had</a> a great question about the line, which appears when the resource is not 100% complete.  This line is not bent (not susceptible to UV distortion), and he mentioned that they may use a second layer of UV sweep for this. <br><br><img src="https://habrastorage.org/files/47e/134/c73/47e134c73d1b402ea5e8d23a2e6b9e20.jpg"><br><br>  Fortunately for us, Julian Love told how it was done and I added it below. <br><br><h2>  Third Hell Trail - <i>‚ÄúTextures‚Äù</i> </h2><br>  Textures for the resource of the sorcerer look like this: <br><br><img src="https://habrastorage.org/files/549/9be/768/5499be76802441fd90339bc581b02535.jpg"><br><br>  To be honest, I can't say exactly how it all blends together.  But I want to take a couple of notes (guesses): <br>  <b>#one</b> <br>  03 is the alpha channel from 02. In addition to 04, no other texture has its own alpha channel. <br>  <b># 2</b> <br>  I seriously began to dig, how did they make the texture of the liquid rise just above the current fill level.  04 and the three other small textures are used to draw the level. <br><br><img src="https://habrastorage.org/files/678/c92/1d0/678c921d0615496e8ce3c7a56ce6b922.gif"><br><br>  <b># 3</b> <br>  If you look frame by frame, you will see a transparent sphere and I think that 01 is used as an alpha channel for it. <br>  I do not understand why everything else is rendered later, but it seems to me that the game handles it anyway.  (I think it is about the fact that the first layer is completely overlapped by further drawing and seems to be drawn in vain. Maybe it is drawn into the buffer to be used later, but it‚Äôs first in order. The animation from the bottom shows that the first frame is completely closed by the second. <i>Approx. per.</i> ) <br><br><img src="https://habrastorage.org/files/b13/f31/fe0/b13f31fe0af14f6ca45b734036e1c0d9.gif"><br><br>  You have read almost to the end of the article.  Simon is too sad.  to write more, because he doesn‚Äôt like that he couldn‚Äôt find more information about blending textures.  He hopes that Blizzard will hire him for the position of a sad angel sitting on the left side of the bubble.  Then he can collect more cool chips right from the heart of art. <br><br><h2>  Addition # 1 </h2><br>  I had the honor to get more details about the bubbles from <a href="http://www.diablowiki.net/Julian_Love">Julian Love</a> : <br><br>  Textures are multiplied with each other.  Do not mix.  From here comes the whole complexity in the movement of color.  Here's how the movement of the water line is handled.  [...] Here is the formula for the alpha mask line of water: <br><br>  a = tex1.a * tex2.a * 4 <br><br>  Also, the water line is deformed by UV, but it is very difficult to notice this distortion if you look at the sphere exactly from the front. ‚Äù <br>  Since I do not have a lot of knowledge about shader code, I asked him what if ‚Äú* 4‚Äù is used to brighten the texture, since multiplication darkens it very much.  His answer was: <br>  Yes, * 4 at the end brightens it back very significantly.  We do the same with color, only use * 2.  The color formula is as follows: <br><br>  rgb = ((tex1.rgb * text2.rgb * 2) * text3.rgb * 2) <br><br>  Each texture is actually an instance of the same texture, only each stage has a different offset, speed and scale of UV. <br><br>  Thanks to these holy programs: <a href="http://forum.xentax.com/viewtopic.php%3Ff%3D10%26t%3D7320%26start%3D45">D3TexConv v0.9b</a> &amp; <a href="http://www.zezula.net/en/mpq/download.html">MPQ Extractor</a> &amp; <a href="http://blender.org/">Blender</a> .  Without them, writing this article would be impossible. <br>  <a href="http://www.polycount.com/forum/member.php%3Fu%3D75360">MikieX</a> mentioned some really <a href="http://www.polycount.com/forum/member.php%3Fu%3D75360">nice</a> <a href="http://www.voofoostudios.com/%3Fp%3D33">shiny balls</a> .  I can not believe that this is just a sprite with heavy magic pixel shader.  How cool is that?  <a href="https://twitter.com/ApexJPN">Apex has</a> restored a bubble and it even has a slider for manipulating the fill level!  <a href="https://ssl-account.com/data.simonschreibt.de/gat027/apex/d3bubble.unity3d">He did it on Unity and you can see it here</a> .  Check it out! </div><p>Source: <a href="https://habr.com/ru/post/249641/">https://habr.com/ru/post/249641/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../249631/index.html">The first development and publication of the game in social networks</a></li>
<li><a href="../249633/index.html">What is CRM-systems and how to choose them correctly?</a></li>
<li><a href="../249635/index.html">Yandex killed service Subscriptions</a></li>
<li><a href="../249637/index.html">Twitter-based bot Markov and phrases from the series</a></li>
<li><a href="../249639/index.html">KISS - the design principle, containing all other design principles</a></li>
<li><a href="../249643/index.html">New Year star with Wi-Fi based on ESP8266</a></li>
<li><a href="../249645/index.html">Kernel .Net (GC, JIT, interop, ...) in Open Source</a></li>
<li><a href="../249647/index.html">Making a queue of incoming calls with the callback function</a></li>
<li><a href="../249649/index.html">Configuring Kerio Control Firewall for 3CX Phone System</a></li>
<li><a href="../249651/index.html">1987 - Exhibition "Computer Science in the Life of the United States"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>