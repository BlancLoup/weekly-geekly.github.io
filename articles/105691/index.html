<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>node.js reference abbreviation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! In this article, I will step by step consider creating a simple web application - abbreviation of links to node.js, using mysql-libmysqlclie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>node.js reference abbreviation</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/habraeffect/7e/ac/7eac478ac23bf9a8cc35c38203b898b2.png" align="left"><br>  Hi, Habr!  In this article, I will step by step consider creating a simple web application - abbreviation of links to node.js, using mysql-libmysqlclient, MooTools on the server and jQuery on the client.  The article assumes that the reader has already passed the ‚ÄúHello world‚Äù exercise and figured out the very basics of node.js. <br><a name="habracut"></a><br>  Immediately warn you - I do not consider myself an expert in node.js.  I propose to discuss the code and get closer to the ideal together.  Perhaps together we will make a great example for newbies.  Therefore - constructive criticism is welcomed. <br><br><h2>  Server MooTools </h2><br>  I do not want to holivarit on the topic-need-unnecessary, I chose to use, you can decide otherwise. <br>  It was not possible to connect MooTools right away - you can‚Äôt just take, download the server file and make require ('./ MooTools'). <br>  I was helped by <a href="http://twitter.com/">MooTools tweet from July 12th</a> and the link <a href="http://davidwalsh.name/mootools-nodejs">davidwalsh.name/mootools-nodejs</a> .  As a result, the library was connected as follows: <br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./Lib/MooTools'</span></span>).apply(GLOBAL);</code> </pre> <br><br><h2>  Mysql </h2><br>  Any NoSQL database is more suitable for this application, but my goal was to learn how to work with MySQL in node.js. <br>  I took out a <a href="http://habrahabr.ru/blogs/javascript/105089/">topic about Node-mysql-libmysqlclient</a> from the bookmarks, took all the necessary information and gathered the client into the manuals without problems. <br>  I threw the script itself into the <code>Lib</code> folder in the project, so it is easily initiated like this: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> conn = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./Lib/mysql/mysql-libmysqlclient'</span></span>).createConnectionSync(); conn.connectSync(<span class="hljs-string"><span class="hljs-string">'localhost'</span></span>, <span class="hljs-string"><span class="hljs-string">'NAME'</span></span>, <span class="hljs-string"><span class="hljs-string">'PASS'</span></span>, <span class="hljs-string"><span class="hljs-string">'nodejs'</span></span>);</code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Extending the ServerResponse </h2><br>  To make it easier to set headers in the application and redirect, I decided to extend the ServerResponse prototype (I think this approach is in line with the JavaScript ideology) using the MooTools implements method: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> http = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'http'</span></span>); http.ServerResponse.implement({ <span class="hljs-comment"><span class="hljs-comment">// code -    .   ,  200 (Ok)  404 (Not Found) // plain -     true,  - html header : function (code, plain) { this.writeHead(code, { 'Content-Type': plain ? 'text/plain' : 'text/html' }); }, // response.redirect('http://example.com')      redirect : function (url, status) { this.writeHead(status || 302, { 'Content-Type' : 'text/plain', 'Location' : url }); this.write('Redirecting to ' + url); this.end(); } });</span></span></code> </pre><br><br><h2>  Application framework </h2><br><pre> <code class="javascript hljs">http.createServer(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// code will be here }).listen(8124, "127.0.0.1"); console.log('Server running at http://127.0.0.1:8124/');</span></span></code> </pre><br><br><h2>  Links, file <code>Link.js</code> </h2><br>  So, the link we have three properties - id in the database, the url to which it leads and the code that is shown in our abbreviation. <br>  We will not write code separately into the database, but will receive it on the basis of id, translating it into a 36-number system ([0-9a-z]). <br><pre> <code class="javascript hljs">Link.getCode = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> id ? id.toString(<span class="hljs-number"><span class="hljs-number">36</span></span>) : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }; Link.fromCode = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">code</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> code ? <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(code, <span class="hljs-number"><span class="hljs-number">36</span></span>) : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; };</code> </pre><br><br>  Based on this, we build the class reference itself, which we place in front of the static methods: <br><pre> <code class="javascript hljs">Link = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Class({ <span class="hljs-attr"><span class="hljs-attr">initialize</span></span> : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">obj</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      -      this.setId(obj.id).id || this.setCode(obj.code); this.setUrl(obj.url); }, setId : function (id) { // id    int this.id = (isNaN(id) || id &lt;= 0) ? null : parseInt(id); return this; }, getId : function () { return this.id; }, setUrl : function (url) { this.url = url || null; return this; }, getUrl : function () { return this.url; }, setCode : function (code) { this.id = Link.fromCode(code); return this; }, getCode : function () { return Link.getCode(this.id); } });</span></span></code> </pre><br><br>  In the database we will create a simple table and write a model for getting and inserting the link: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`shortLinks`</span></span> ( <span class="hljs-string"><span class="hljs-string">`id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> AUTO_INCREMENT, <span class="hljs-string"><span class="hljs-string">`url`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">512</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-string"><span class="hljs-string">`id`</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">InnoDB</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHARSET</span></span>=utf8;</code> </pre><br><br><pre> <code class="javascript hljs">Model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Class({ <span class="hljs-attr"><span class="hljs-attr">initialize</span></span> : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">conn</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//       this.conn = conn; }, create : function (args) { //     ,     return new Link(args); }, get : function (link, fn) { //     if (!link.getId()) throw 'EmptyId'; //  .  ,  link.id    int var q = 'SELECT * FROM `shortLinks` WHERE `id` = ' + link.getId(); //    .   . this.conn.query(q, function (err, res) { if (err) throw err; res.fetchAll(function (err, rows) { if (err) throw err; //     -,    fn(rows.length ? link.setUrl(rows[0].url) : null); res.freeSync(); }); }); }, put : function (link, fn) { // url - ,  !!    var q = 'INSERT INTO `shortLinks` (`id`, `url`) ' + 'VALUES (NULL , "' + this.conn.escapeSync(link.getUrl()) + '");' this.conn.query(q, function (err, res) { if (err) throw err; //       fn(link.setId( //       this.conn.lastInsertIdSync() )); }.bind(this)); } }); //     exports.Link = Link; exports.Model = Model;</span></span></code> </pre><br><br>  You can add the following line to initialization: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> linkModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./Link'</span></span>).Model)(conn);</code> </pre><br>  Note that the brackets around <code>require('./Link').Model</code> are required, otherwise it will try to create a <code>require</code> object. <br><br><h2>  Renderer, <code>Renderer.js</code> file </h2><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//        require('./Lib/MooTools').apply(GLOBAL); //     var url = require('url'); //      var fs = require('fs'); exports.Renderer = new Class({ initialize : function (linkModel) { this.link = linkModel; } });</span></span></code> </pre><br><br>  Renderer, like Link.Model, will be created only once during application initialization and each request is used the same, due to which we do not lose precious milliseconds. <br>  The basis will be the run method: <br><br><pre> <code class="javascript hljs">run : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> path = url.parse(req.url, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (path.query &amp;&amp; <span class="hljs-string"><span class="hljs-string">'add'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> path.query) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> addUrl = path.query.add; <span class="hljs-comment"><span class="hljs-comment">//      , , "example.com" //        ,   default- if (!url.parse(addUrl).protocol) { addUrl = 'http://' + addUrl; } //    this.add(res, addUrl); //     ( url/!abc12 ) } else if (path.pathname.test(/^\/![0-9a-z]+$/)) { //      (/!)    this.send(res, path.pathname.substr(2)); } else { //        this.index(res); } },</span></span></code> </pre><br><br>  Before we forget, we <b><code>./init.js</code></b> edit a little <b><code>./init.js</code></b> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> linkModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./Link'</span></span>).Model)(conn); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> renderer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./Renderer'</span></span>).Renderer)(linkModel); http.createServer(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) </span></span>{ renderer.run(req, res); }).listen(<span class="hljs-number"><span class="hljs-number">8124</span></span>, <span class="hljs-string"><span class="hljs-string">"127.0.0.1"</span></span>);</code> </pre><br><br>  Because  Links will be added by agiaks, all we need is to write the link to the database and return its code: <br><pre> <code class="javascript hljs">add : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res, url</span></span></span><span class="hljs-function">) </span></span>{ res.header(<span class="hljs-number"><span class="hljs-number">200</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.link.put( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.link.create({ <span class="hljs-attr"><span class="hljs-attr">url</span></span> : url }), <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">link</span></span></span><span class="hljs-function">) </span></span>{ res.end(link.getCode()); } ); },</code> </pre><br><br>  If the user wants to go through an abbreviated link - send it where necessary, or inform that there is no such link <br><pre> <code class="javascript hljs">send : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res, code</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.link.get( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.link.create({ <span class="hljs-attr"><span class="hljs-attr">code</span></span> : code }), <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">link</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (link) { res.redirect(link.getUrl()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { res.header(<span class="hljs-number"><span class="hljs-number">404</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); res.end(<span class="hljs-string"><span class="hljs-string">'There is not such url'</span></span>); } } ); },</code> </pre><br><br>  For the main page - just display the file index.html.  Please note, I recommend to always indicate the path with __dirname first, because  otherwise you might run into trouble <br><pre> <code class="javascript hljs">index : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function">) </span></span>{ fs.readFile(__dirname + <span class="hljs-string"><span class="hljs-string">'/index.html'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err, data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> err; res.header(<span class="hljs-number"><span class="hljs-number">200</span></span>); res.end(data); }) }</code> </pre><br><br><h2>  Home page </h2><br>  On the main page, we will proceed simply - we will connect google jikvery from the reps, add an input field and when the user wants to shorten the link - we have received the code for the new link with Ajax, we will nicely display it under the input field. <br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>   node.js<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="undefined"></span></code> </pre><br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'input[type=submit]'</span></span>).click(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input = $(<span class="hljs-string"><span class="hljs-string">'input[type=text]'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> url = input.val(); input.val(<span class="hljs-string"><span class="hljs-string">''</span></span>); url &amp;&amp; $.ajax({ <span class="hljs-attr"><span class="hljs-attr">url</span></span> : <span class="hljs-string"><span class="hljs-string">'./'</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: ({ <span class="hljs-attr"><span class="hljs-attr">add</span></span> : url }), <span class="hljs-attr"><span class="hljs-attr">success</span></span> : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = location.protocol + <span class="hljs-string"><span class="hljs-string">'//'</span></span> + location.host + <span class="hljs-string"><span class="hljs-string">'/!'</span></span> + data; $(<span class="hljs-string"><span class="hljs-string">'#url'</span></span>) .prepend( $(<span class="hljs-string"><span class="hljs-string">'&lt;dd&gt;'</span></span>).append( $(<span class="hljs-string"><span class="hljs-string">'&lt;a&gt;'</span></span>) .text(result) .attr(<span class="hljs-string"><span class="hljs-string">'href'</span></span>, result) ) .hide() .fadeIn() ) .prepend( $(<span class="hljs-string"><span class="hljs-string">'&lt;dt&gt;'</span></span>) .text(url) .hide() .fadeIn() ); } }); }) });</code> </pre><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dl</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"url"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Everything. <br><h2>  <b><a href="http://links.freecr.ru/">Result</a></b> </h2><br>  Immediately I will warn you - I do not guarantee the safety of your links, the service is exclusively demonstrative. <br><br>  <a href="http://pastebin.com/AYe93c7z">All code in one place on pastebin</a> </div><p>Source: <a href="https://habr.com/ru/post/105691/">https://habr.com/ru/post/105691/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../105683/index.html">Two strange updates from VKontakte</a></li>
<li><a href="../105685/index.html">Pick Up and Return - a new service from ASUS</a></li>
<li><a href="../105686/index.html">UnLogo, or how to avoid marketing</a></li>
<li><a href="../105688/index.html">Curse of websites and magical UX design</a></li>
<li><a href="../105690/index.html">Motorola sues Apple for patent infringement</a></li>
<li><a href="../105696/index.html">Unit testing and CodeCoverage for Javascript code</a></li>
<li><a href="../105699/index.html">Official survey: do you completely load the Habrahabr pages while surfing?</a></li>
<li><a href="../105701/index.html">New version of Mono 2.8 released</a></li>
<li><a href="../105702/index.html">Solar tree for contactless charging</a></li>
<li><a href="../105703/index.html">Bicycle Liquidator: Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>