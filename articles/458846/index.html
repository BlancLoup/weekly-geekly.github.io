<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to develop another platformer using Unity. Another tutorial</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 


 Under the cut you will find another article that tells you how I set myself the goal to program the game, based on the translation of th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to develop another platformer using Unity. Another tutorial</h1><div class="post__text post__text-html js-mediator-article"><p>  Hi, Habr! </p><br><p>  Under the cut you will find another article that tells you how I set myself the goal to program the game, based on the translation of the article into Habr called <a href="https://habr.com/ru/post/456152/">Level Design Patterns for 2D games</a> . </p><br><p>  The article has a lot of text (both normal and original) and a lot of pictures. </p><a name="habracut"></a><br><p>  Before I start my first article, let's get acquainted.  My name is Denis.  I work as a system administrator with a total experience of 9 years.  It‚Äôs not for me to tell you that a system administrator is a type of IT staff who once diligently deploy, and then contemplate the merchanting of various characters on the monitor.  Over time, I came to the conclusion that it was time to expand the boundaries of knowledge and switch to programming.  Not going into details, I tried to do any projects in C ++ and Python.  But over the course of a year of study, I came to the conclusion that programming application and system software is not mine.  For different reasons. </p><br><p>  Thinking deeper, I asked myself the question: what do I really like to do with computer equipment of different formats?  My question to myself threw me far back into childhood itself, namely, in the happy hours spent for PS1, PS2, Railroad Tycoon 3 for PC ..., Well, you understood.  Video games! </p><br><p>  By the number of various educational materials, the choice fell on Unity (not to reinvent the wheel?).  After a month of reading and viewing various materials, I decided to release the first very simple children's game in the play market.  To overcome fear so to speak.  After all, to release applications in the play market - it's not scary, right? </p><br><p>  After a couple of months I released the platformer already more complicated.  Then there was a break (after all, the work must work, after all). </p><br><p>  About two weeks ago, I saw a translation of an article in habr called Level Design Patterns for 2D games ( <a href="https://habr.com/ru/post/456152/">https://habr.com/ru/post/456152/</a> ) and thought to myself, why not?  The article has a simple and intuitive table with a list of what should be in the game so that it is interesting.  I kindly copied the table to myself in OneNote and marked each pattern with a Deal tag (which can be marked as completed). </p><br><p>  What do I want to get on the total?  Your criticism.  As I like to tell myself - you want to learn to swim, dive with your head.  If you think that I did something well - write me about it in the comments.  If you think that I did something bad - write about it twice. </p><br><p>  I will start my longrid on programming another platformer. </p><br><h3>  Avatar </h3><br><p>  <em>An entity controlled by players within the game.</em>  <em>For example, Mario and Luigi in Super Mario Bros (Nintendo, 1985).</em> </p><br><p>  There are several subtasks that need to be implemented to give the hero life.  Namely: </p><br><pre><code class="plaintext hljs">‚Ä¢   ( ) ‚Ä¢      ‚Ä¢      ‚Ä¢       ‚Ä¢       </code> </pre> <br><p>  To implement the animation, we need to convert a single sprite into a multi sprite.  This is done incredibly simple.  We fold the sprite into the project folder and find it in the Unity editor explorer.  Then, by clicking on the sprite, in the inspector window changes the value of the <strong>SptiteMode</strong> property from <strong>Single</strong> to <strong>Multiple</strong> . </p><br><p><img src="https://habrastorage.org/webt/xx/ot/ny/xxotnyobz6-0kunbcizdwwk-4zu.png" alt="image"></p><br><p>  Click <strong>Apply</strong> , then <strong>SpriteEditor</strong> . </p><br><p>  Inside the <strong>Sprite Editor</strong> window, you need to select each frame of the future animation with the mouse as shown in the figure below. </p><br><p>  Also, Unity provides the ability to automatically select the boundaries of objects inside the sprite.  For this, the <strong>Slice</strong> button must be pressed in the <strong>Sprite Editor</strong> window.  In the drop-down menu, you should have <strong>Type =&gt; Automatic, Pivot =&gt; Center</strong> .  All you have to do is click on the <strong>Slice</strong> button.  After that, all objects inside the sprite will be selected automatically. </p><br><img src="https://habrastorage.org/webt/bf/tb/kv/bftbkvncerh-ybaf6_nlgaxprdg.png"><br><p>  Let's do this operation for all other animations.  Next, you will need to configure the state of the animation and their switching.  This is done in two steps.  The first action, the program code. <br>  Create an empty game object.  To do this, right-click in the <strong>Hierarchy</strong> tab and select <strong>Create Empty</strong> in the drop-down menu. </p><br><img src="https://habrastorage.org/webt/l1/zb/ap/l1zbap5u09_kzb1mllj1tqwizgw.png"><br><p>  An empty game object that is created on the scene, by default, has only one component - <strong>Transform</strong> .  This component determines the position of the object on the stage, the angle of inclination and its scale. </p><br><p>  You can find the word <strong>transform</strong> in two different meanings: </p><br><blockquote><ul><li>  <strong>Transform</strong> is a class.  Since this is a class, Transform describes the <strong>software implementation</strong> of what coordinates this object will be located in and how large it will be. </li><li>  <strong>transform</strong> is an instance of a class.  That is, <strong>you can refer to a specific object</strong> and change its position or scale on the stage.  For example, the next line in the code will be: <br><pre> <code class="cs hljs">transform.position = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2 (transform.position.x + dirX, transform.position.y + dirY);.</code> </pre> <br><br>  This line will be responsible for moving Lucas on stage. </li></ul><br></blockquote><p>  To create your own component, you need to click the <strong>Add Component</strong> button in the object inspector tab.  Next, a search window appears harming standard components.  Simply start typing the name of the future script (or an already implemented component), if there are no suitable names, Unity will ask you to create a new component.  I called this component <strong>HeroScript.cs</strong> . </p><br><img src="https://habrastorage.org/webt/fi/hf/gn/fihfgnpyl-ndmnx23l8mbotdh4a.png"><br><p>  First, we describe the fields that will store information about the visual and physical component of Lucas: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Animator animator; <span class="hljs-comment"><span class="hljs-comment">//      . private Rigidbody2D rb2d; //rb    </span></span></code> </pre> </div></div><br><p>  Further, the fields that will respond to the movement of the character: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">/*  ,     */</span></span> Vector3 localScale; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> facingRight = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> dirX, dirY; <span class="hljs-comment"><span class="hljs-comment">//    [Range(1f, 20f)] [SerializeField] private float moveSpeed; //    private SpriteRenderer sprite; //   SpriteRenderer /*   ,     */</span></span></code> </pre> </div></div><br><p>  A start, great.  Next, the enumeration will be described and the property will be written, which will be responsible for switching the state of the animation.  This enumeration must be written outside the class: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">/* *      . *         *    . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> CharState { idle, <span class="hljs-comment"><span class="hljs-comment">//   0 Run, //   1 Walk, //   2 Die //   3 }</span></span></code> </pre> </div></div><br><p>  Implement the property that will receive and set the new animation state: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> CharState State { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> {<span class="hljs-comment"><span class="hljs-comment">//    CharState    animator       int return (CharState)animator.GetInteger("State"); } set { //    animator     int    State       ,      int. animator.SetInteger("State", (int)value); } }</span></span></code> </pre> </div></div><br><p>  With the software part is complete.  Now we have an enumeration and a property that will be associated with animation switching.  Next, the second step.  It is necessary in the Unity editor to link the state of the animation and specify which values ‚Äã‚Äãof int need to be changed. </p><br><p>  To do this, you need to associate the previously created multi sprites with an empty game object.  All you need is to select the frames in the Unity Explorer and drag them to an empty game object, to which we previously assigned the script. </p><br><p><img src="https://habrastorage.org/webt/zx/md/y8/zxmdy88fwc5gglpbjz3bkj0rjfq.png" alt="image"></p><br><p>  Do this with each of the following animations.  Also, in the explorer with animations, you will find the appearance of an object with a block diagram and a <strong>Play</strong> button.  Clicking on it twice will open the <strong>Animator</strong> tab.  Inside you will see several blocks with animations and initially, only <strong>Entry</strong> states and the first animation set that were connected are connected.  <strong>AnyState</strong> and other animations will be displayed in the form of ordinary gray squares.  In order to link everything, you need to click on the state of <strong>AnyState</strong> and select the single <strong>Make Transaction</strong> drop-down menu and link it to the gray box.  This operation must be done for each state.  In the end, it should get about what you see in the screenshot below. </p><br><p><img src="https://habrastorage.org/webt/-d/0d/7j/-d0d7j-y1okjqhr6wgywx2ht768.png" alt="image"></p><br><p>  Next, you must clearly indicate what exactly <strong>State</strong> should be equal to in order to start the necessary animation.  Pay attention to the screenshot, namely the left part of it.  <strong>Parameters</strong> tab.  It created a variable of type <strong>int State</strong> .  Next, pay attention to the right side.  First of all, from the transition of animation it is necessary to uncheck <strong>Can Transaction To Self</strong> .  This operation will save you from strange and sometimes completely incomprehensible transitions of animation into itself and the <strong>Conditions</strong> section, where we indicated that this transition of animation was assigned the value 3 to the <strong>State</strong> variable.  After which Unity will know which animation to run. <br>  For an animated movement of the character, everything is done.  Go ahead. </p><br><p>  The next step is to teach Lucas to move around the scene.  This is entirely programming.  To move a character around the scene, you will need buttons, clicking on which Lucas will go back and forth.  For this, in the <strong>Assets Store</strong> tab we need to import Standart Assets, but not all of it, only some additional components, namely: </p><br><p>  <strong>‚Ä¢ CrossPlatformInput</strong> <strong><br></strong>  <strong>‚Ä¢ Editor</strong> <strong><br></strong>  <strong>‚Ä¢ Environment</strong> </p><br><p>  After importing Asseset, the main Unity window should be modified and one additional tab <strong>Mobile Input will</strong> appear.  Activate it. </p><br><p>  Let's create new <strong>UI</strong> elements on the stage - control buttons.  Create 4 buttons in each direction.  Up, down, forward and back.  In the Image component we will assign an image to the buttons, which will correspond to the image, which means that it can be moved.  It should look like in the screenshot below: </p><br><img src="https://habrastorage.org/webt/c6/jv/kk/c6jvkketndj8sqq4vodxamn-oni.png"><br><p>  To each button we add the <strong>AxisTouchButton</strong> component.  This script has only 4 fields.  The <strong>axisName</strong> field indicates what name to respond to when calling.  The <strong>axisValue</strong> field <strong>is</strong> responsible for the direction in which Lucas will move.  The <strong>responseSpeed</strong> field is responsible for how fast Lucas will develop his speed.  The <strong>returnToCentreSpeed</strong> field <strong>is</strong> responsible for how fast the button will return to the center.  For the Next button, let's leave everything as it is.  For the back button, change the value of the <strong>axisValue</strong> to -1, so that Lucas moves back.  For the Up and Down buttons, change the <strong>axisName</strong> to <strong>Vertical</strong> .  For the Up button, the <strong>axisValue is</strong> set to 1, for Down -1. </p><br><p>  Next, we modify <strong>HeroScript.cs</strong> .  Add to the directive <strong>using</strong> the namespace </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityStandardAssets.CrossPlatformInput; <span class="hljs-comment"><span class="hljs-comment">//    .</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs">       : <span class="hljs-comment"><span class="hljs-comment">/*  ,     */</span></span> Vector3 localScale; <span class="hljs-comment"><span class="hljs-comment">//   bool facingRight = true; [SerializeField] private float dirX, dirY; //    [Range(1f, 20f)] [SerializeField] private float moveSpeed; //    private SpriteRenderer sprite; //   SpriteRenderer /*   ,     */</span></span></code> </pre> </div></div><br><p>  Add the following code to the standard Start method: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { localScale = transform.localScale; animator = GetComponent&lt;Animator&gt;(); <span class="hljs-comment"><span class="hljs-comment">//     . sprite = GetComponent&lt;SpriteRenderer&gt;(); //  SpriteRenderer rb = GetComponent&lt;Rigidbody2D&gt;(); State = CharState.idle; }</span></span></code> </pre> </div></div><br><p>  Create a method that will be responsible for moving the hero: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveHero</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { dirX = CrossPlatformInputManager.GetAxis (<span class="hljs-string"><span class="hljs-string">"Horizontal"</span></span>) * moveSpeed * Time.deltaTime; dirY = CrossPlatformInputManager.GetAxis (<span class="hljs-string"><span class="hljs-string">"Vertical"</span></span>) * moveSpeed * Time.deltaTime; transform.position = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2 (transform.position.x + dirX, transform.position.y + dirY); }</code> </pre> </div></div><br><p>  As you can see, everything is simple.  The <strong>dirX</strong> and <strong>DirY fields</strong> record information about what the Axis direction ( <strong>Horizontlal</strong> and <strong>Vertical</strong> ) was multiplied by the speed (which will need to be specified in the editor) and multiplied by the time from the last frame. <br>  <strong>transform.position</strong> writes a new position to the <strong>Transform</strong> component of our game object. </p><br><p>  On the practical side of the question, you can start the scene and see how Lucas falls into the abyss, since there are no objects under it that can prevent this, as the hero will move around the scene.  But, Lucas is always in the <strong>Idle</strong> animation and does not turn around when we send him back.  For this, the script must be modified yet.  Create a method that determines in which direction Lucas is looking: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckWhereToFace</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dirX &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { facingRight = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; State = CharState.Walk; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dirX &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { facingRight = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; State = CharState.Walk; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dirX == <span class="hljs-number"><span class="hljs-number">0</span></span>) { State = CharState.idle; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dirY &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { State = CharState.Walk; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dirY &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { State = CharState.Walk; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((facingRight) &amp;&amp; (localScale.x &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)) || ((!facingRight) &amp;&amp; (localScale.x &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>))) localScale.x *= <span class="hljs-number"><span class="hljs-number">-1</span></span>; transform.localScale = localScale;</code> </pre> </div></div><br><p>  This part of the code is also not difficult.  The method describes that if <strong>dirX</strong> &gt; 0 (if we go to the right), then turn the sprite in this direction and start the walk animation.  If less than 0, then unwrap Lucas 180 degrees and run the animation.  If <strong>dirX</strong> is zero, then Lucas is worth it and you need to start the wait animation. </p><br><p>  Why, in this case, use the operation with <strong>Scale is</strong> preferable to using <strong>flipX = true</strong> ?  In the future, I will describe the ability to take any objects in hand and naturally, Lucas can turn around holding something in his hands.  If I used the usual reflection, the object that I would hold in my hands would remain on the right side (for example) when Lucas is looking to the left and vice versa.  Changing the scale will move the object that keeps Lucas in the same direction that Lucas turned around. </p><br><p>  We place the <strong>CheckWhereToFace ()</strong> function into the <strong>Update ()</strong> function, for its frame-by-frame monitoring. </p><br><p>  Fine.  The first 2 points out of 5 are fulfilled.  We turn to the needs of Lucas.  Suppose Lucas has 3 types of needs that need to be met in order to stay alive.  This is the standard of living, the level of hunger and the level of thirst.  It is necessary to create for this a simple and clear panel with an indicator of each item.  To create such a panel, right-click and select <strong>UI =&gt; Panel</strong> . </p><br><p>  Mark it out like this: </p><br><p><img src="https://habrastorage.org/webt/yp/oz/fs/ypozfsb3q_vygo6usfn1t_btnyc.png" alt="image"></p><br><p>  The panel consists of three images (Image) of each need (left).  On the right is the panel itself.  On the first layer (we will say so), there is a color indicator (Image) that does not have transparency, and an Image object that is different in transparency is copied under it.  This Image is half transparent to the original.  Also Image, which has no transparency, has the property Image <strong>Type = Filled</strong> .  This feature will allow us to simulate a reduction in the fullness of the scale of needs. </p><br><p><img src="https://habrastorage.org/webt/ld/vo/qy/ldvoqyj2ioak7ufaycjjmjvbeta.png" alt="image"></p><br><p><img src="https://habrastorage.org/webt/l7/wu/ok/l7wuokjirtsp-p66wixm2zybfbu.png" alt="image"></p><br><p>  We define new static variables: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">/*  ,     */</span></span> [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> Health = <span class="hljs-number"><span class="hljs-number">100</span></span>, Eat = <span class="hljs-number"><span class="hljs-number">100</span></span>, Water = <span class="hljs-number"><span class="hljs-number">100</span></span>, _Eat = <span class="hljs-number"><span class="hljs-number">0.05f</span></span>, _Water = <span class="hljs-number"><span class="hljs-number">0.1f</span></span>; <span class="hljs-comment"><span class="hljs-comment">//        .    _  . /*   ,     */ /*  ,      */ [SerializeField] Image iHealt, iEat, iWater; //      /*   ,      */</span></span></code> </pre> </div></div><br><p>  In this case, I use static fields.  This is done to ensure that these fields are the only ones for the whole class.  Also, this will allow us to directly access these fields by class name.  We write some simple functions: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fEat</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x</span></span></span><span class="hljs-function">)</span></span> { Eat = Eat - x * Time.deltaTime; iEat.fillAmount = Eat / <span class="hljs-number"><span class="hljs-number">100f</span></span>; <span class="hljs-comment"><span class="hljs-comment">// ,        return Eat; } private float fWater(float x) { Water = Water - x * Time.deltaTime; iWater.fillAmount = Water / 100; return Water; }</span></span></code> </pre> </div></div><br><p>  Then, we write a method that collects information about the desire to eat and drink: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Needs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fEat(_Eat) &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { Debug.Log(Eat); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fEat(<span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) { StartCoroutine(ifDie()); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fWater(_Water) &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { Debug.Log(Water); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fWater(<span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) { StartCoroutine(ifDie()); }</code> </pre> </div></div><br><p>  The <strong>Needs ()</strong> function is placed in the <strong>Update ()</strong> function and every frame is called.  Accordingly, in the lines </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fEat(_Eat) &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><p>  a function is called that passes as a parameter how much to subtract from the variable <strong>Eat</strong> and <strong>Water</strong> .  If the result of the function does not return 0, then Lukas has not yet died of thirst or hunger.  If Lucas still dies from starvation or mortally wounded, then we perform Corutin </p><br><pre> <code class="cs hljs">StartCoroutine(ifDie());</code> </pre> <br><p>  which starts the death animation and restarts the level: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">IEnumerator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ifDie</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { State = CharState.Die; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">yield</span></span></span><span class="hljs-function"> return new </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WaitForSeconds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span></span><span class="hljs-function">)</span></span>; SceneManager.LoadScene(<span class="hljs-string"><span class="hljs-string">"WoodDay"</span></span>, LoadSceneMode.Single); }</code> </pre> </div></div><br><h3>  Hard tile </h3><br><p>  <em>A game object that does not allow a player to pass through it.</em>  <em>Example: Gender in Super Mario Bros (Nintendo, 1985).</em> </p><br><p>  In order to realize the earth and prevent Lukas from falling through it, it is necessary to connect the <strong>BoxCollider2D</strong> and <strong>Rigidbody2D</strong> components to Lucas.  Also, you will need a sprite of the earth, on which the <strong>BoxCollider2D</strong> component will be <strong>located</strong> .  The <strong>BoxCollider2D</strong> component implements collision colliders and their collision behavior.  At this stage, we do not need anything but to prevent the failures of Lucas underground.  All that we can edit at will is the borders of the collider.  In my case, the sprite of the ground has a grass surface and in order not to seem that the grass is able to withstand the weight of Lucas, I will edit the boundaries of the component. </p><br><img src="https://habrastorage.org/webt/ey/0n/hv/ey0nhvwblv9xamkiyesto7exsve.png"><br><p>  Now, an exciting leveling process.  For convenience, you can export this cube of land to the prefab.  A prefab is a container of a game object, when modified, you can automatically apply changes to all game objects created from this prefab.  Next, we clone this prefab with CTRL + D (after selecting it in the hierarchy tab) and stir it on the stage. </p><br><p><img src="https://habrastorage.org/webt/b6/dm/6t/b6dm6tbsz6mezi1upkenyd9sloa.png" alt="image"></p><br><h3>  Screen </h3><br><p>  <em>Part of the level / world of the game, currently visible to the player.</em> </p><br><p>  Set up a camera that will monitor the player to display part of the scene.  Further, the script will be very simple to implement: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject objectToFollow; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> speed = <span class="hljs-number"><span class="hljs-number">2.0f</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { CamFoll(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CamFoll</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> interpolation = speed * Time.deltaTime; Vector3 position = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.transform.position; position.y = Mathf.Lerp(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.transform.position.y, objectToFollow.transform.position.y, interpolation); position.x = Mathf.Lerp(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.transform.position.x, objectToFollow.transform.position.x, interpolation); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.transform.position = position; }</code> </pre> </div></div><br><p>  In the <strong>objectToFollow</strong> field of the <strong>GameObject</strong> type, an object will be assigned to which you want to monitor, and in the speed field, the speed with which you need to smoothly move beyond the assigned GameObject. </p><br><p>  The interpolation field records information about the movement speed since the last frame.  Further, the Lerp method will be used, which will ensure the camera moves smoothly behind Lucas as it moves along Axis X and Y. Unfortunately, I cannot explain the line </p><br><pre> <code class="cs hljs">position.y = Mathf.Lerp(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.transform.position.y, objectToFollow.transform.position.y, interpolation);</code> </pre> <br><p>  in terms of mathematics.  Therefore, I will say easier - this method will allow you to stretch the execution time of an action.  In our case, this is moving the camera behind the object. </p><br><h3>  Danger </h3><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><p>  Entities that prevent the player from performing his task.  Example: 1001 Spikes spikes (Nicalis and 8bits Fanatics, 2014). </p></div></div><br><p>  Let's start adding something that will not just prevent Lukas from going through the scene to the end, but will affect the number of his lives and the possibility of perishing (in one, realizing the fifth subtask for realizing the tradition of life to Lukas - the Hero may be killed or may perish). <br>  In this case, we will throw spikes on the stage, which will be hidden behind the vegetation and only the attentiveness of the player will help to pass by. </p><br><p>  Create an empty <strong>GameObject</strong> and connect the <strong>SpriteRenderer</strong> and <strong>PolygonCollider2D</strong> components to it.  In the <strong>SpriteRenderer</strong> component, <strong>we</strong> connect the sprite of the barbed button or any other object at will.  Also, assign spike <strong>tag = Thorn</strong> . </p><br><p>  Next, on Lucas's <strong>GameObject, we</strong> create a script that will be responsible for what happens to it if Lucas collides with other colliders.  In my case, I called it <strong>ColliderReaction.cs</strong> </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Rigidbody2D rb2d; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { rb2d = GetComponent&lt;Rigidbody2D&gt;(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTriggerEnter2D</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Collider2D collision</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (collision.gameObject.tag) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"Thorn"</span></span>: { rb2d.AddForce(transform.up * <span class="hljs-number"><span class="hljs-number">4</span></span>, ForceMode2D.Impulse); HeroScript.Health = HeroScript.Health - <span class="hljs-number"><span class="hljs-number">5</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre> </div></div><br><p>  The essence of the script is simple as 2x2.  When a collision occurs with a game object on the <strong>Thorn</strong> tag, the <strong>Switch</strong> operator compares with the candidates we specified.  In our case for now, this is <strong>Thorn</strong> .  First, Lucas throws up, and then we turn to a static variable and subtract 5 units of life from Lucas.  Looking ahead, I can say that it makes sense to describe the same thing for a collision with enemies: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"Enemy"</span></span>: { rb2d.AddForce(transform.up * <span class="hljs-number"><span class="hljs-number">2</span></span>, ForceMode2D.Impulse); HeroScript.Health = HeroScript.Health - <span class="hljs-number"><span class="hljs-number">10</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;</code> </pre> </div></div><br><p>  Further, I propose to kill two birds with one stone </p><br><h3>  Assembled item and Rule. </h3><br><p>  A game object that players can pick up. </p><br><p>  We propose a rule that if Lucas wants to go between the islands and go up, then you need to collect wood in order to build bridges and stairs. <br>  Already passed ways to create a tree and stairs. </p><br><p>  We will connect a script to the tree, which will be responsible for how much logs can be knocked out of it, if you start cutting it.  Since only attack animation was proposed in the set of sprites, we will use it when we cut down a tree (production costs). <br>  The script that is on the tree: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Transform inst; <span class="hljs-comment"><span class="hljs-comment">//     [SerializeField] private GameObject FireWoodPref; //   [SerializeField] private int fireWood; //       </span></span></code> </pre> </div></div><br><p>  When starting the level, write a random value to <strong>fireWood</strong> : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { fireWood = Random.Range(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>); }</code> </pre> </div></div><br><p>  Describes a method with a parameter that will be responsible for how many logs will fall out in one hit: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fireWoodCounter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; fireWood; i++) { fireWood = fireWood - x; InstantiateFireWood(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fireWood; }</code> </pre> </div></div><br><p>  A method that will create clones of logs on stage. <br>  private void InstantiateFireWood (): </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"> { Instantiate(FireWoodPref, inst.position, inst.rotation); }</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/g6/sb/di/g6sbdisre8fpoe58lkkr3bvyeha.png"><br><p>  Create a log and connect to it a script with the following code: </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTriggerEnter2D</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Collider2D collision</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (collision.gameObject.tag) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"Player"</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (InventoryOnHero.woodCount &gt; <span class="hljs-number"><span class="hljs-number">10</span></span>) { Debug.Log(<span class="hljs-string"><span class="hljs-string">"   !"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { InventoryOnHero.woodCount = InventoryOnHero.woodCount + <span class="hljs-number"><span class="hljs-number">1</span></span>; Destroy(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.gameObject); } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre> </div></div><br><p>  Next, we will also create a class that will be responsible for inventory. </p><br><p>  First check whether there is a place in the bag.  If not, then the error and the log remains to lie, if there is space, then replenish the inventory by one unit and destroy the log. <br>  Next, you need to do something with these resources.  As mentioned above, we will offer the player the opportunity to build bridges and stairs. </p><br><p>  To create a bridge, we need 2 prefabs with the left and right half of the bridge.  On each half, the <strong>BoxCollider2D</strong> component will be connected.  ,    ,      - ,  . </p><br><p>        : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Transform inst1, inst2; <span class="hljs-comment"><span class="hljs-comment">//        [SerializeField] private GameObject bridgePref1, bridgePref2; //   [SerializeField] private int BridgeCount; //   ,   .   </span></span></code> </pre> </div></div><br><p> : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BuildBridge</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (InventoryOnHero.woodCount == <span class="hljs-number"><span class="hljs-number">0</span></span>) { Debug.LogWarning (<span class="hljs-string"><span class="hljs-string">" !"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (InventoryOnHero.woodCount &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { BridgeCount = BridgeCount - <span class="hljs-number"><span class="hljs-number">1</span></span>; InventoryOnHero.woodCount = InventoryOnHero.woodCount - <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (BridgeCount) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: Inst1(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: Inst2(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: Debug.LogWarning(<span class="hljs-string"><span class="hljs-string">"-      "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre> </div></div><br><p>  ,    ,       . ,   10 ,  12  8. </p><br><p> , ,      ,  ,    .  ,   1  ,      1   .    ,      5,   ,        .  0,   .  ,   . </p><br><p>      . </p><br><p>    ,   <strong>ColliderReaction.cs</strong> : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTriggerStay2D</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Collider2D collision</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (collision.gameObject.tag) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"Ladder"</span></span>: { rb2d.gravityScale = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTriggerExit2D</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Collider2D collision</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (collision.gameObject.tag) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"Ladder"</span></span>: { rb2d.gravityScale = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre> </div></div><br><p>  <strong>OnTriggerStay2D</strong> ,          .  ,     0. ,        .  <strong>OnTriggerExit2D</strong>  ,              . </p><br><h3>  </h3><br><p> <em>,   .</em> </p><br><p>    19    ,           . ,       ,    ,  ,      ,   . </p><br><p>   GO,      <strong>SpriteRenderer</strong> , <strong>BoxCollider2D</strong> , <strong>Rigidbody2D</strong> . ,      ‚Äî ,        .       ,          ru.stackoverflow.com. </p><br><p><img src="https://habrastorage.org/webt/fu/uw/ri/fuuwriruf0zli9r6pwvprae_qba.png" alt="image"></p><br><p>         <strong>Trees</strong> . </p><br><p> ,        . ,    -,      ,          Raycast     2     (4   ).  ,  ,   ,      (   ).        (    ),      .      ,      .     ,      ,       .  ,      . ,     ,                 (     ,      ). </p><br><p>   ,     .   ,       - . </p><br><p>     : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GameObject area; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> m1 = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, m2; <span class="hljs-comment"><span class="hljs-comment">// m  move private void fGreenMonster() { float dist = Vector3.Distance(greenMonster.transform.position, area.transform.position); Debug.Log(dist); if (m1) { if (dist &lt; 3f) { transform.position += new Vector3(speed,0,0) * Time.deltaTime; SR.flipX = true; } else { m1 = false; m2 = true; } } if (m2) { if(dist &gt;= 1f) { transform.position += new Vector3(-speed,0,0) * Time.deltaTime; SR.flipX = false; } else { m2 = false; m1 = true; } } }</span></span></code> </pre> </div></div><br><p>      <strong>Update()</strong>    ,        .   ,  3 ,   .   3,        ,     . </p><br><p><img src="https://habrastorage.org/webt/nf/4y/6e/nf4y6edxsifi9_m3eq56d0xlbtw.png" alt="image"></p><br><p>  ,         . </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fSunFlower</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { canBullet = canBullet - minus * Time.deltaTime; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (canBullet &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; SR.flipX == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { GameObject newArrow = Instantiate(sunFlowerBullet) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GameObject; newArrow.transform.position = transform.position; Rigidbody2D rb = newArrow.GetComponent&lt;Rigidbody2D&gt;(); rb.velocity = sunFlowerTrans.transform.forward * -sunFlowerBulletSpeed; canBullet = <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (canBullet &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; SR.flipX == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { GameObject newArrow = Instantiate(sunFlowerBullet) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GameObject; newArrow.transform.position = transform.position; Rigidbody2D rb = newArrow.GetComponent&lt;Rigidbody2D&gt;(); rb.velocity = sunFlowerTrans.transform.forward * sunFlowerBulletSpeed; canBullet = <span class="hljs-number"><span class="hljs-number">2</span></span>; }</code> </pre> </div></div><br><pre> <code class="cs hljs">canBullet = canBullet - minus * Time.deltaTime;</code> </pre> <br><p>   ,      . </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (canBullet &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; SR.flipX == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { GameObject newArrow = Instantiate(sunFlowerBullet) }</code> </pre> </div></div><br><p>  ,  ,     ,   ,    : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Damage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x</span></span></span><span class="hljs-function">)</span></span> { Health = Health - x; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Health; }</code> </pre> </div></div><br><p> , ,     : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ifDie</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Damage(<span class="hljs-number"><span class="hljs-number">0</span></span>) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { Destroy(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.gameObject); } }</code> </pre> </div></div><br><p>   0,   . </p><br><p>  ,         : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bGreenMonster) { fGreenMonster(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bSunFlower) { fSunFlower(); }</code> </pre> </div></div><br><p>   ,         . </p><br><p><img src="https://habrastorage.org/webt/-1/1s/ki/-11skihlzc3vevw5zqiuxstlmre.png" alt="image"></p><br><p>   . </p><br><p>  ,      ? </p><br><p> ,       . </p><br><p>      : </p><br><img src="https://habrastorage.org/webt/7i/oe/3l/7ioe3lshbpcu-hkwa09wydzefbs.png"><br><p>  : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Transform Hero; <span class="hljs-comment"><span class="hljs-comment">//         [SerializeField] private float distWhatHeroSee; //   [SerializeField] private LayerMask Tree, BridgeBuild, LadderBuild ,drinkingWater, lEnemy; //  </span></span></code> </pre> </div></div><br><p>      ,         : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AttackBtn</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (CrossPlatformInputManager.GetButtonDown(<span class="hljs-string"><span class="hljs-string">"Attack"</span></span>)) { GameObject.Find(<span class="hljs-string"><span class="hljs-string">"Hero"</span></span>).GetComponent&lt;HeroScript&gt;().State = CharState.AttackA; Collider2D[] Trees = Physics2D.OverlapCircleAll(Hero.position, distWhatHeroSee, Tree); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; Trees.Length; i++) { Trees[i].GetComponent&lt;TreeControl&gt;().fireWoodCounter(<span class="hljs-number"><span class="hljs-number">1</span></span>); Debug.Log(<span class="hljs-string"><span class="hljs-string">"Trees Collider"</span></span>); HeroScript.Water = HeroScript.Water - <span class="hljs-number"><span class="hljs-number">0.7f</span></span>; } <span class="hljs-comment"><span class="hljs-comment">// BB  BridgeBuild Collider2D[] BB = Physics2D.OverlapCircleAll(Hero.position, distWhatHeroSee, BridgeBuild); for (int i = 0; i &lt; BB.Length; i++) { BB[i].GetComponent&lt;BridgeBuilding&gt;().BuildBridge(); HeroScript.Water = HeroScript.Water - 0.17f; }</span></span></code> </pre> </div></div><br><pre> <code class="cs hljs">GameObject.Find(<span class="hljs-string"><span class="hljs-string">"Hero"</span></span>).GetComponent&lt;HeroScript&gt;().State = CharState.AttackA;</code> </pre> <br><p>      ,          . <br> ,   : </p><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="cs hljs">Collider2D[] Trees = Physics2D.OverlapCircleAll(Hero.position, distWhatHeroSee, Tree); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; Trees.Length; i++) { Trees[i].GetComponent&lt;TreeControl&gt;().fireWoodCounter(<span class="hljs-number"><span class="hljs-number">1</span></span>); Debug.Log(<span class="hljs-string"><span class="hljs-string">"Trees Collider"</span></span>); HeroScript.Water = HeroScript.Water - <span class="hljs-number"><span class="hljs-number">0.7f</span></span>; }</code> </pre> </div></div><br><p>   <strong>Trees</strong> ,      .      ,        ,       ,    .         . <br>  ,            . Simple as that! </p><br><p>   , -    : </p><br><p><img src="https://habrastorage.org/webt/x6/cg/du/x6cgduvtlqneym3ulljopmfy2yo.png" alt="image"></p><br><p>      ,       ‚Äî  . <br>   ,      .  ,         ,    ,     . </p><br><p>   2        ,                     . </p><br><p>  Good luck! </p><br><p>  <a href="https://habr.com/ru/post/460561/"></a> . </p><br><p>        <a href="https://opengameart.org/">https://opengameart.org/</a> ,  : </p><br><ul><li> <a href="https://opengameart.org/content/platform-character">  </a> </li><li>  <a href="https://opengameart.org/content/tileset-platform-forest">Trees</a> </li><li>  <a href="https://opengameart.org/users/bevouliincom">Monsters</a> </li><li>   Unity  <a href="https://ru.stackoverflow.com/questions/603544/%25D0%259A%25D0%25B0%25D0%25BA-%25D0%25B8%25D1%2581%25D0%25BF%25D0%25BE%25D0%25BB%25D1%258C%25D0%25B7%25D0%25BE%25D0%25B2%25D0%25B0%25D1%2582%25D1%258C-%25D0%25BC%25D0%25B0%25D1%2581%25D0%25BA%25D0%25B8-%25D1%2581%25D0%25BB%25D0%25BE%25D0%25B5%25D0%25B2-layermask-%25D0%25B8-%25D0%25B4%25D0%25BB%25D1%258F-%25D1%2587%25D0%25B5%25D0%25B3%25D0%25BE-%25D0%25BF%25D0%25B8%25D1%2588%25D1%2583%25D1%2582-1-layer">ru.stackoverflow.com</a> </li><li>  Link to my application store on <a href="https://play.google.com/store/apps/developer%3Fid%3D%25D0%259C%25D0%25B8%25D1%2580%2B%25D0%25BE%25D0%25B4%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE%2B%25D0%2593%25D0%25B5%25D1%2580%25D0%25BE%25D1%258F">Google Play</a> </li><li>      <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.WorldOfOneHero.LucasJonesAdventure">Google Play</a> </li><li>      <a href="https://sourceforge.net/projects/lucas-lones-adventure/files/">sourceforge.net.</a> <br>  Feel free and write comments on Habr√© or me on the post worldofonehero@gmail.com. </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/458846/">https://habr.com/ru/post/458846/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../458836/index.html">Index borscht. A systematic approach to assessing, comparing, determining the price / quality ratio</a></li>
<li><a href="../45884/index.html">Symfony 1.2</a></li>
<li><a href="../458840/index.html">How we pierced the Great Chinese Firewall (Part 2)</a></li>
<li><a href="../458842/index.html">Patience and labor all text will extract</a></li>
<li><a href="../458844/index.html">Silo destruction through adaptation of the VeriSM ‚Ñ¢ approach</a></li>
<li><a href="../458848/index.html">Release Rust 1.36.0: Trey Future, stabilization alloc and MaybeUninit <T></a></li>
<li><a href="../45885/index.html">when will they collide?</a></li>
<li><a href="../458850/index.html">We learn English cheaply and effectively. Part 2</a></li>
<li><a href="../458854/index.html">MotionLayout: better animations, less code</a></li>
<li><a href="../458856/index.html">Cheap and expensive AAA batteries</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>