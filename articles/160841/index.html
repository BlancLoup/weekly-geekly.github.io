<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Native MVC for Silex PHP Framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After reading the article telling how to modify the Silex micro-framework under the MVC architecture, I had a dual impression. The method has the righ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Native MVC for Silex PHP Framework</h1><div class="post__text post__text-html js-mediator-article">  After reading the <a href="http://habrahabr.ru/post/160509/" title="How to turn Silex into a full-fledged PHP framework">article</a> telling how to modify the <a href="http://silex.sensiolabs.org/" title="Silex micro-framework">Silex micro-framework</a> under the MVC architecture, I had a dual impression.  The method has the right to life, however: <br><br><ol><li>  ORM is not always needed in the project, I want to have a simple implementation of the Model; </li><li>  in Silex there are already (although not quite explicit) native controllers; </li><li>  writing your autoloaders when you have the opportunity to add what you need to Composer is not good. </li></ol><br>  Let's see what can be done. <br><a name="habracut"></a><br>  We will adhere to the following structure of the application: <br><pre><code class="php hljs">+ project | + <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> | composer.json | composer.phar | composer.lock | + app | + Controllers | + Models | + Views | + vendor | + providers | + Providers | + <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> | .htaccess | index.php | + css | + img | + js</code> </pre> <br>  I set up a virtual host on the <code>project/public</code> folder, so <code>.htaccess</code> will be one <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment"># project/public/.htaccess &lt;IfModule mod_rewrite.c&gt; Options -MultiViews RewriteEngine On RewriteCond %{REQUEST_FILENAME} !-f RewriteRule ^ index.php [L] &lt;/IfModule&gt;</span></span></code> </pre><br><h3>  Install Silex using <a href="http://getcomposer.org/" title="Composer">Composer</a> package manager </h3><br>  Recently, Silex supports this installation method and that is why you need to use it: <br><ul><li>  possibility of one team to update all the libraries to the current or necessary versions; </li><li>  generation of one autoloader for all necessary. </li></ul><br>  Create a <code>project/protected/composer.json</code> file of approximately the same content (depending on what you need): <br><br><pre>  {
     "require": {
         "silex / silex": "1.0. *"
     },
     "minimum-stability": "dev",
     "autoload": {
         "psr-0": {
             "Providers": "",
             "Controllers": "app /"
         }
     }
 }
</pre><br>  Here we want to get Silex itself and indicate that we will load our Providers (about them a little further) from <code>project/protected/Providers</code> , and Controllers from <code>project/protected/app/Controllers</code> . <br>  A set of commands to install: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre>  cd / path / to / project / protected
 curl -s http://getcomposer.org/installer |  php
 php composer.phar install
</pre><br><br><h3>  Silex Providers </h3><br>  <a href="http://silex.sensiolabs.org/doc/providers.html" title="Silex Providers">Providers</a> is a great Silex feature that allows you to implement third-party functionality.  Providers are of two types: ControllerProviderInterface for controllers and ServiceProviderInterface for everything else (in our case - for the Model). <br><br><h3>  Model </h3><br>  Let's write a simple Service Provider and model loader. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">// project/protected/Providers/ModelsServiceProvider.php namespace Providers; use Silex\Application; use Silex\ServiceProviderInterface; class ModelsServiceProvider implements ServiceProviderInterface { public function register(Application $app) { $app['models.path'] = array(); $app['models'] = $app-&gt;share(function($app) { return new Models($app); }); } public function boot(Application $app) { } } class Models { private $app; public function __construct(Application $app) { $this-&gt;app = $app; } public function load($modelName, $modelMethod, $data = array()) { require_once $this-&gt;app['models.path'] . $modelName . '.php'; $Model = new $modelName($this-&gt;app); return $Model-&gt;$modelMethod($data); } }</span></span></code> </pre><br>  With the Model, in general, everything.  Now we can load any one located in the <code>project/protected/app/Models</code> directory using the <code>$app['models']-&gt;load('Class', 'Method', $data)</code> construction with the ability to transfer the required data to it <code>$data</code> .  It remains only to register our provider in Silex. <br><br><h3>  Controller </h3><br>  The only thing we need to take care of directly is about autoloading the controller classes, but Composer has already done this for us.  So now we can connect controllers using the standard Silex <code>mount</code> method.  Let's see how the index.php file, the simplest Controller and Model will look like. <br><br>  <em>index.php</em> <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">// project/public/index.php require_once __DIR__ . '/../protected/vendor/autoload.php'; $app = new Silex\Application(); $app-&gt;register(new Providers\ModelsServiceProvider(), array( 'models.path' =&gt; __DIR__ . '/../protected/app/models/' )); $app-&gt;mount('/', new Controllers\Index()); $app-&gt;run();</span></span></code> </pre><br><br>  <em>Controller</em> <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">// project/protected/Controllers/Index.php namespace Controllers; use Silex\Application; use Silex\Route; use Silex\ControllerProviderInterface; use Silex\ControllerCollection; class Index implements ControllerProviderInterface { public function connect(Application $app) { $index = new ControllerCollection(new Route()); $index-&gt;get('/', function() use ($app) { $label = $app['models']-&gt;load('Pages', 'index'); return $label; }); $index-&gt;get('/{name}', function($name) use ($app) { $name = $app['models']-&gt;load('Pages', 'hello', $name); return "Hello{$name}"; }); return $index; } }</span></span></code> </pre><br>  Briefly by code.  The <code>connect()</code> method tells Silex that the routes described inside must be processed as part of the controller that we indexed into index.php (in this case, the base URL for this controller is the application root - /).  Next, the <code>$index</code> variable is created, it represents something like a <code>$app</code> and has only routing functions.  The routes themselves are written as usual. <br><br>  <em>Model</em> <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">// project/protected/Models/Pages.php class Pages { public function index() { return "Index"; } public function hello($name) { return ", {$name}!"; } }</span></span></code> </pre><br><br>  What is the result?  The simplest implementation of MVC, with the ability to start writing at any time in the standard for Silex style.  In this context, the View was not considered, as there are already many ready-made solutions, from which I personally prefer to use <a href="http://twig.sensiolabs.org/" title="Twig - The Flexible, Fast, and Secure Template Engine for PHP">Twig</a> , since integration with Silex is 100%. <br>  The whole project is available on <a href="https://github.com/geakstr/Silex-MVC" title="GitHub - Silex-MVC">github</a> . </div><p>Source: <a href="https://habr.com/ru/post/160841/">https://habr.com/ru/post/160841/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../160831/index.html">MiniTV MK808 review with Android 4.1</a></li>
<li><a href="../160833/index.html">Google Drive now supports website publishing.</a></li>
<li><a href="../160835/index.html">Answers Minister of Communications to the questions of users</a></li>
<li><a href="../160837/index.html">10 Active Directory Administrative Tasks Solved With PowerShell</a></li>
<li><a href="../160839/index.html">Team Presentation NMSYS</a></li>
<li><a href="../160843/index.html">ImageResizer module for IIS</a></li>
<li><a href="../160845/index.html">Choosing an ORM Strategy (.NET)</a></li>
<li><a href="../160849/index.html">Yandex.Amnestia</a></li>
<li><a href="../160851/index.html">Convert menu to drop-down list on small screens</a></li>
<li><a href="../160853/index.html">Angry Citizen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>