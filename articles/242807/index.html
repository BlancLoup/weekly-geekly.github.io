<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Development of the program in Multimedia Builder on the example of a utility for remote work with cash register software</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As you all understand, I‚Äôm just an ordinary engineer, but I always strive to make my work and colleagues much more convenient. 

 I think every IT per...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Development of the program in Multimedia Builder on the example of a utility for remote work with cash register software</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/515/aa3/4fb/515aa34fbc9348f4b3bdba8861d72a0c.JPG"><br><br><br>  As you all understand, I‚Äôm just an ordinary engineer, but I always strive to make my work and colleagues much more convenient. <br><br>  I think every IT person knows such a task as automating process execution.  So, in the course of my work with cash register software, I had to face a lot of everyday procedures related to remote access and cash register management, as well as automation of many procedures. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I myself am not a programmer.  Although I studied VB, VBA, JavaScript and PHP, but it all remained on the student's bench. <br>  So, as an engineer, I got tired of doing the same thing every time and wasting time on it.  And I wondered, is it possible, with minimal programming knowledge, to create some means to automate the support of cash register software to perform everyday tasks? <br><br><a name="habracut"></a><br><br>  Turned to search ... <br><br>  So what was found? <br><br>  1. MediaChance Multimedia Builder - is a program for creating applications autorun CD.  Unfortunately, the release of its new versions stopped already in the distant 2007, but some enthusiasts continue to make various chips on it.  There are plenty of such programs, but what I liked about this environment is that it has its own scripting language, which in my opinion is quite simple to learn and there are also a lot of plug-ins. <br><br>  2. Batch-script is a Windows command-line scripting language; to put it simply, it allows you to automate actions into a bat-file.  I will also add on my own, I don‚Äôt know how for others, but it turned out that it was also not difficult for me to master it and combine it with MultimediaBuilder. <br><br>  3. Well, in addition PuTTy and PLink.  - I think everyone knows that these are utilities for remote access via SSH protocol to * nix-systems. <br><br>  So, in our company we have <a href="http://www.crystals.ru/avtomatizacija-torgovli/kassovyj-server">server software</a> and <a href="http://www.crystals.ru/avtomatizacija-torgovli">cash programs</a> for the store.  But as you all understand in the process of work there are situations when you need to connect remotely to the store. <br><br>  I decided to simplify my life a bit and developed a utility for solving this problem.  To my surprise, the utility was liked by my colleagues, and is now quite in demand among the engineers of our company. <br>  Once again I want to note that I am not a professional programmer, so the following criticism, which will fly to my address in terms of the correctness of optimization and writing code, is accepted and encouraged. <br><br>  Task: very often you need to remotely reboot the cash register, which works under Linux OS. <br><br>  Create a project in Multimedia Builder and embed the so-called embedded object in it: <br><br><img src="https://habrastorage.org/files/665/700/a90/665700a900b2446a85248ca0979cee15.png"><br><br><br>  And just hang the event on the button, which will run the bat-file, which will pull plink.exe with the parameters.  This is the simplest program: <br><br><img src="https://habrastorage.org/files/b21/676/5f5/b216765f5859469d9fca827ac3c8a36b.png"><br><br><br>  It is worth noting that when you do the Embedded Files in Multimedia Builder, when you open the program, all the embedded files are automatically unpacked into a temporary directory and from there they will be launched. <br><br><img src="https://habrastorage.org/files/9aa/280/7eb/9aa2807eb00347e09328765923a8debe.png"><br><br><br>  Clicking on the button, just a line appears, which from the bat-file executes the simplest code. <br><br><pre><code class="bash hljs">SET /p ipcash=Enter CashIP: plink.exe tc@%ipcash% -pw <span class="hljs-string"><span class="hljs-string">"12345"</span></span> <span class="hljs-string"><span class="hljs-string">"sudo /sbin/reboot"</span></span></code> </pre> <br><br><img src="https://habrastorage.org/files/b67/ce7/518/b67ce75185fa41fe9f25dcc77d405e6f.png"><br><br><br>  I know that it is possible for many people to tell things quite banal, but for me, as a person who learned the basics of automation, all this was and remains interesting to this day. <br><br>  What did you do next?  - A very simple, laid out on a corporate resource and sent a letter to colleagues, saying that there is such a thing. <br><br>  And what do you think?  - The people began to use, and, accordingly, Wishlist appeared. <br><br>  Once again, by creating such a piece, I comprehended everything from scratch on how to write batch scripts to bash scripts and so on. <br><br>  Well, then came the next version.  That is, two buttons have already appeared. <br><br><img src="https://habrastorage.org/files/6c5/e5e/c0e/6c5e5ec0eebe4834a641feb640cd428c.png"><br><br><br>  And then it went.  Moreover, it is worth noting, the further I went into the process of studying the automation of processes for working with remote connections, the more I myself had ideas on how to do something, the better it would be for our support to be more convenient. <br><br>  The next version appeared again: <br><br><img src="https://habrastorage.org/files/462/071/51f/46207151faec405981c87192982b583c.png"><br><br><br>  And the next version: <br><br><img src="https://habrastorage.org/files/1a3/ec0/888/1a3ec0888bc74da9a7faaf851db8ca66.png"><br><br><br>  And the next version: <br><br><img src="https://habrastorage.org/files/097/f46/d46/097f46d46e2a41f883b6473681ba36b0.png"><br><br><br>  And so the version for the version, the growth of interest and my knowledge. <br><br>  Then I learned how to do the installation packages and the program got my installer: <br><br><img src="https://habrastorage.org/files/196/e96/633/196e96633abd44f5ae811abdcd22b24b.png"><br><br><br>  Well, the functionality was added: <br><br><img src="https://habrastorage.org/files/cb3/423/5bd/cb34235bd6d6430db9b8f5a0ff2a8cd1.png"><br><br><br>  And now, two years later, it looks like this: <br><br><img src="https://habrastorage.org/files/96e/03c/c44/96e03cc446274059ad95fc731525dc41.png"><br><br><img src="https://habrastorage.org/files/ba9/dfe/a39/ba9dfea3955b4c3ba182d51dd48ec016.png"><br><br><img src="https://habrastorage.org/files/a3e/dbf/f87/a3edbff87fb24f39a76883ad3dc9cbd2.png"><br><br><br>  Now we can say that this is a good tool for managing servers and cash registers.  Even he would not have thought that he could write such a thing. <br><br>  To tell about it, unfortunately, the strength is not enough at the fingers, since it began only with my simple hobby or question to myself: And how can I restart the computer remotely on Linux (we have a cash register on Linux)? <br><br>  What it has become in 4 years you have seen above. <br><br>  But let us now share how, for example, I implement everything there. <br><br>  So, you saw the interface with the list of cash registers, now about the implementation of some functions.  Immediately I repeat that I can say an amateur, and comprehended everything from scratch, so any criticism and comments from the pros are welcome. <br><br>  1. Ping <br>  I immediately wanted in my fantasies that by clicking on a button, it would be possible to ping the cashier and at the same time, so that it is highlighted in a certain color. <br><br><img src="https://habrastorage.org/files/80f/12e/c43/80f12ec436664844ba80ba45ca4a3191.png"><br><br><br>  Nakodil just such a thing: <br><br><pre> <code class="bash hljs">srok1$=cs1$ File1$=<span class="hljs-string"><span class="hljs-string">'cashes/01c.txt'</span></span> Rv1=StrToFile(File1$,srok1$,FALSE,FALSE) clear$=<span class="hljs-string"><span class="hljs-string">''</span></span> srok1$=<span class="hljs-string"><span class="hljs-string">'For /F "Delims=" %%I In (01c.txt) Do Set c01=%%~I'</span></span> srok2$=<span class="hljs-string"><span class="hljs-string">'Ping -n 1 -w 1 %c01% &gt;nul'</span></span> srok3$=<span class="hljs-string"><span class="hljs-string">'If %ErrorLevel%==0 ('</span></span> srok4$=<span class="hljs-string"><span class="hljs-string">' &lt;nul set /p strTemp=a&gt;c01ping.txt'</span></span> srok5$=<span class="hljs-string"><span class="hljs-string">') Else ('</span></span> srok6$=<span class="hljs-string"><span class="hljs-string">' &lt;nul set /p strTemp=n&gt;c01ping.txt'</span></span> srok7$=<span class="hljs-string"><span class="hljs-string">')'</span></span> File3$=<span class="hljs-string"><span class="hljs-string">'cashes/c01ping_mmb.bat'</span></span> Rv=StrToFile(File3$,clear$,FALSE,FALSE) Rv=StrToFile(File3$,srok1$,TRUE,TRUE) Rv=StrToFile(File3$,srok2$,TRUE,TRUE) Rv=StrToFile(File3$,srok3$,TRUE,TRUE) Rv=StrToFile(File3$,srok4$,TRUE,TRUE) Rv=StrToFile(File3$,srok5$,TRUE,TRUE) Rv=StrToFile(File3$,srok6$,TRUE,TRUE) Rv=StrToFile(File3$,srok7$,TRUE,TRUE) Run(<span class="hljs-string"><span class="hljs-string">"&lt;SrcDir&gt;\cashes\c01ping_mmb.bat"</span></span>,<span class="hljs-string"><span class="hljs-string">"HIDE"</span></span>) Pause(<span class="hljs-string"><span class="hljs-string">"1000"</span></span>) path1$ = <span class="hljs-string"><span class="hljs-string">'cashes/c01ping.txt'</span></span> col1$=<span class="hljs-string"><span class="hljs-string">'0,255,0'</span></span> col2$=<span class="hljs-string"><span class="hljs-string">'255,0,0'</span></span> LoadText(<span class="hljs-string"><span class="hljs-string">"r1$"</span></span>,<span class="hljs-string"><span class="hljs-string">"FILE:path1$"</span></span>) If (r1$=<span class="hljs-string"><span class="hljs-string">'a'</span></span>) Then SetObjectParam(<span class="hljs-string"><span class="hljs-string">"bt1"</span></span>,<span class="hljs-string"><span class="hljs-string">"BGCOLOR=col1$"</span></span>) Else If (r1$=<span class="hljs-string"><span class="hljs-string">'n'</span></span>) Then SetObjectParam(<span class="hljs-string"><span class="hljs-string">"bt1"</span></span>,<span class="hljs-string"><span class="hljs-string">"BGCOLOR=col2$"</span></span>) End End</code> </pre><br><br>  The bottom line is that immediately when you click on the "ping" button, the ip-address is written to the file for this field where the address is.  Next, generate a code for the batch file that will read the ip-address from a text file and run it.  According to the result of the batch file, the answer file ‚Äún‚Äù or ‚Äúa‚Äù is generated, and depending on this, by reading the result we paint the button.  Yes, of course in an amateur way, but it works. <br><br>  2. Run putty.exe without entering a login and password. <br><br><img src="https://habrastorage.org/files/582/26b/b88/58226bb88f044109bea0f6bfe7a1dbb4.png"><br><br><br>  All of you know that if you connect PuTTy in a standard way, you need to enter your login and password.  Often in our service it is necessary to quickly connect to the checkout and, in principle, the login and password in most cases on them by default. <br><br>  If you run PuTTy, it will be something like this: <br><br><img src="https://habrastorage.org/files/ebd/a78/4ba/ebda784bae954f8fb178ffac43c4f5af.png"><br><br><br>  But I thought, why not do it like this: I clicked a button and you immediately opened the SSH command line. <br><br>  Born here is such an amateur code: <br><br><pre> <code class="bash hljs">srok1$=cs1$ File1$=<span class="hljs-string"><span class="hljs-string">'cashes/01c.txt'</span></span> Rv1=StrToFile(File1$,srok1$,FALSE,FALSE) clear$=<span class="hljs-string"><span class="hljs-string">''</span></span> srok01$=<span class="hljs-string"><span class="hljs-string">'For /F "Delims=" %%I In (cashes/01c.txt) Do Set c01=%%~I'</span></span> srok02$=<span class="hljs-string"><span class="hljs-string">'REG ADD HKCU\Software\SimonTatham\PuTTY\Sessions\%c01% /f'</span></span> srok03$=<span class="hljs-string"><span class="hljs-string">'REG ADD "HKCU\Software\SimonTatham\PuTTY\Sessions\%c01%" /f /v HostName /t REG_SZ /d %c01%'</span></span> srok04$=<span class="hljs-string"><span class="hljs-string">'REG ADD "HKCU\Software\SimonTatham\PuTTY\Sessions\%c01%" /f /v LineCodePage /t REG_SZ /d UTF-8'</span></span> srok05$=<span class="hljs-string"><span class="hljs-string">'echo y | plink.exe tc@%c01% -pw "12345" exit'</span></span> srok06$=<span class="hljs-string"><span class="hljs-string">'putty.exe -load %c01% tc@%c01% -pw "12345"'</span></span> File3$=<span class="hljs-string"><span class="hljs-string">'run_putty.bat'</span></span> Rv=StrToFile(File3$,clear$,FALSE,FALSE) Rv=StrToFile(File3$,srok01$,TRUE,TRUE) Rv=StrToFile(File3$,srok02$,TRUE,TRUE) Rv=StrToFile(File3$,srok03$,TRUE,TRUE) Rv=StrToFile(File3$,srok04$,TRUE,TRUE) Rv=StrToFile(File3$,srok05$,TRUE,TRUE) Rv=StrToFile(File3$,srok06$,TRUE,TRUE) Run(<span class="hljs-string"><span class="hljs-string">"run_putty.bat"</span></span>,<span class="hljs-string"><span class="hljs-string">"HIDE"</span></span>) RunScript(<span class="hljs-string"><span class="hljs-string">"ssh_log_1"</span></span>)</code> </pre><br><br>  Logics: <br><ol><li>  Write the ip-address to a text file. </li><li>  Next generic batch file. </li><li>  When running, ip-address is substituted in the variable batch file. </li><li>  The session is added to the registry. </li><li>  PuTTy.exe opens the session. </li></ol><br>  And voila: <br><br><img src="https://habrastorage.org/files/9fa/22c/bd5/9fa22cbd58024762b6975cf3a0c29c8b.png"><br><br><br>  3. Remote VNC server. <br>  We also have the ability to remotely connect via the VNC server protocol, so that you can see what the cashiers are doing there. <br><br>  For this, I took Real VNC Viewer. <br><br>  Next came the following code: <br><br><pre> <code class="bash hljs">srok1$=cs1$ File1$=<span class="hljs-string"><span class="hljs-string">'cashes/01c.txt'</span></span> Rv1=StrToFile(File1$,srok1$,FALSE,FALSE) clear$=<span class="hljs-string"><span class="hljs-string">''</span></span> srok01$=<span class="hljs-string"><span class="hljs-string">'For /F "Delims=" %%I In (cashes/01c.txt) Do Set c01=%%~I'</span></span> srok02$=<span class="hljs-string"><span class="hljs-string">'rem SET /p ipcash=Enter CashIP for run remote DeskTop:'</span></span> srok03$=<span class="hljs-string"><span class="hljs-string">'echo n | plink.exe -v -ssh tc@%c01% -pw "12345" -m rdp_vnc_cmd.txt'</span></span> srok04$=<span class="hljs-string"><span class="hljs-string">'vncviewer.exe %c01%'</span></span> File3$=<span class="hljs-string"><span class="hljs-string">'rn_vnc_mmb.bat'</span></span> Rv=StrToFile(File3$,clear$,FALSE,FALSE) Rv=StrToFile(File3$,srok01$,TRUE,TRUE) Rv=StrToFile(File3$,srok02$,TRUE,TRUE) Rv=StrToFile(File3$,srok03$,TRUE,TRUE) Rv=StrToFile(File3$,srok04$,TRUE,TRUE) Message(<span class="hljs-string"><span class="hljs-string">"     .      ."</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>) Run(<span class="hljs-string"><span class="hljs-string">"rn_vnc_mmb.bat"</span></span>,<span class="hljs-string"><span class="hljs-string">"HIDE"</span></span>) RunScript(<span class="hljs-string"><span class="hljs-string">"vnc_log_1"</span></span>)</code> </pre><br><br>  Logics: <br><ol><li>  Write the ip-address to a text file. </li><li>  Generate a batch file, which reads the ip-address from this text file. </li><li>  Next, run vncviewer.exe, which reads the session. </li></ol><br>  Well, the session actually opens: <br><br><img src="https://habrastorage.org/files/7cf/b5d/093/7cfb5d0933f7423198fe42f4a70b6584.png"><br><br><br>  Something like that. <br><br>  In fact, there are still a lot of lotions. <br><br><img src="https://habrastorage.org/files/361/9c1/98d/3619c198d525441ab39fb51b1aa6933c.png"><br><br><br>  And now all this looks like this after 2 years, as I began to study everything: <br><br><img src="https://habrastorage.org/files/ba3/f7e/753/ba3f7e75338d42dca70527e6f6c17a4a.png"><br><br><br>  And of course, not without paschalok.  I did one recently: if you accidentally click the mouse here and there, you will find yourself in the secret section, where there are a lot of chips, so that you can make your colleagues laugh! <br><br><img src="https://habrastorage.org/files/0b7/d26/f90/0b7d26f9035c45d28f164bbc7bf5051d.png"></div><p>Source: <a href="https://habr.com/ru/post/242807/">https://habr.com/ru/post/242807/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../242795/index.html">As in Yandex use PyTest and other frameworks for functional testing.</a></li>
<li><a href="../242797/index.html">Publisher List for Mobile Game Developer</a></li>
<li><a href="../242799/index.html">Reissue certificate with SHA-2 - if Webnames does not go to Mahomet ...</a></li>
<li><a href="../242801/index.html">Creating a universal UIAlertController for various versions of iOS</a></li>
<li><a href="../242803/index.html">Protection of automated process control systems in Russia: we investigate new requirements of FSTEC</a></li>
<li><a href="../242811/index.html">Creating a Wi-Fi teapot "for dummies": how we have not broken Kickstarter (for now)</a></li>
<li><a href="../242813/index.html">Once again about education in school</a></li>
<li><a href="../242815/index.html">#MBLTDev 2014 through the eyes of a simple iOS developer from Tinkoff Bank</a></li>
<li><a href="../242819/index.html">network manager + wifi http login automation</a></li>
<li><a href="../242821/index.html">Stack programming with a human face</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>