<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DrWeb Security Space 5 and Mozilla Thunderbird</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. 

 I am the administrator of the corporate mail system, in which, besides ours, some of our clients' mail is also stored. One disgusting day, s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DrWeb Security Space 5 and Mozilla Thunderbird</h1><div class="post__text post__text-html js-mediator-article">  Hello. <br><br>  I am the administrator of the corporate mail system, in which, besides ours, some of our clients' mail is also stored.  One disgusting day, some users began to complain to me that the attachments to them come broken. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  System </h5><br>  The system uses the Postfix SMTP server as the MTA, and Cyrus IMAPd as the MDA.  Postfix sends Cyrus mail using LMTP, users interact with Cyrus via IMAP and POP3.  Cyrus stores mail in the file system, each letter in a separate file, each IMAP folder corresponds to a directory in the system;  localized IMAP folder names are encoded using a special scheme with UTF-7.  In addition to the letters, there are stored a database with access rights to IMAP folders, a table with hashes of letters for suppressing dual delivery, indexes for a quick search for mail, Sieve scripts.  (This all allows you to receive the contents of letters without using the IMAP and POP3 protocols, for example, through scp.) <br><br>  For users, mail is configured via IMAP, i.e.  Sent letters, like all others, are stored on the server. <br><br><h5>  Customer </h5><br>  The first thing I discovered was that when users sent each other a letter with an attachment as an attachment, it came in a broken form.  It was the internal attachment that was corrupted. <br><br>  At the same time, what came (via SMTP + LMTP protocol) to the transfer recipient, and what went (via IMAP protocol) into the ‚Äúsent‚Äù folder of the forwarding user was corrupted in exactly the same way, and differed only in the Recieved headers at the beginning of the letter.  There were no headers in the "Sent", in that it came to me, there were headers added by Postfix and Cyrus when receiving mail.  These headers (the path of the letter Recieved, the results of the X-Spam-Status spam check and X-Virus-Scanned viruses) are due to the normal operation of the mail system. <br><br>  Therefore, I concluded that the email sent was spoiled once by the email client, before it was sent via SMTP and placed in the IMAP folder.  In all cases, the client was Thunberbird, but in different versions. <br><br><h5>  Or a server? </h5><br>  The second thing I discovered was that even in the same users' incoming mail, some attachments were displayed as broken (when they were received via IMAP), although on the disk in the Cyrus repository they were normal.  Pulling out mail without using IMAP and decoding base64 made it possible to get normal, non-broken attachments. <br><br>  Thus, some mail was spoiled even before it hit the mail client, when received via the IMAP protocol. <br><br><h5>  Solution </h5><br>  At the same time, there are no such problems in Linux.  The problem was noticeable only for those Thunderbird users who used Windows. <br><br>  We noticed that one of the users started this almost immediately after installing DrWeb.  The very first check - disabling DrWeb - confirmed the hunch: Thunderbird began to accept mail and forward it without any distortion.  Also, the problem disappeared if Thunderbird was added to DrWeb exceptions (there is a list of applications that it does not touch). <br><br>  A more detailed study showed that when disabling the heuristic analysis module DrWeb also the problem disappeared. <br><br><h5>  Drweb </h5><br>  Everything written above concerns the version of DrWeb Security Space 5. Checked on the most accessible - on the 30-day trial version just downloaded from their website: <br><blockquote>  SpIDer Agent for Windows <br>  spideragent.exe (5.0.1.06018) <br><br>  SpIDer Agent settings module for Windows <br>  spideragent_set.exe (5.0.1.06018) <br><br>  SpIDer Guard Service <br>  spidernt.exe (5.00.1.04160) <br><br>  SpIDer Guard UI Agent <br>  spiderui.exe (5.00.1.04160) <br><br>  SpIDer Guard Control Panel Applet <br>  spidercpl.exe (5.00.1.04160) <br><br>  SpIDer Guard File System Monitor <br>  spider.sys (5.00.1.04160) <br><br>  SpIDer Gate for Windows <br>  spidergate.exe (5.0.2.07030) <br><br>  SpIDer Gate for Windows settings module <br>  spidergate_set.exe (5.0.2.07030) <br><br>  SpIDer Mail for Windows Workstation <br>  spiderml.exe (5.0.1.06300) <br><br>  SpIDer Mail for Windows Workstation settings module <br>  spml_set.exe (5.0.1.06300) <br><br>  Dr.Web Winsock Provider Hook <br>  drwebsp.dll (5.0.1.06040) <br><br>  Dr.Web R Scanner for Windows <br>  drweb32w.exe (5, 00, 4, 6300) <br><br>  Dwz <br>  drwadins.exe (4.44) <br><br>  VadeRetro Antispam &amp; AV Filter <br>  vrcpp.dll (01.284.57) <br><br>  Dr.Web Update for Windows <br>  drwebupw.exe (5.00.4.06300) <br><br>  Dr.Web Shell Extension <br>  drwsxtn.dll (5, 00, 0, 11280) <br><br>  Dr.Web Helper <br>  drwreg.exe (5.00.3.04060) <br><br>  DrWeb Protection Library for Windows <br>  dwprot.dll (5.0.6.04070 built by: WinDDK) <br><br>  DrWeb Protection for Windows <br>  dwprot.sys (5.0.6.04070 built by: WinDDK) <br><br>  Dr.Web Scanning Engine <br>  dwengine.exe (5.0.2.01210 (Build 2133)) <br><br>  Dr.Web Virus-Finding Engine <br>  drweb32.dll (5, 00, 0, 12182) <br></blockquote><br><br>  Actually, the same bug report went to DrWeb. </div><p>Source: <a href="https://habr.com/ru/post/66980/">https://habr.com/ru/post/66980/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../66971/index.html">Y-Wing Fighter Bed</a></li>
<li><a href="../66973/index.html">What is govnokod and who are govkodery?</a></li>
<li><a href="../66974/index.html">Opera releases third beta version of Opera 10 browser</a></li>
<li><a href="../66975/index.html">Belarusian developers thrown from elance.com</a></li>
<li><a href="../66978/index.html">3D scanning in a flatbed scanner</a></li>
<li><a href="../66982/index.html">Making friends Citrix XenServer 5.5 and Openfiler 2.3</a></li>
<li><a href="../66983/index.html">Google will burn your home and move you to the village</a></li>
<li><a href="../66988/index.html">Mozilla is looking for testers for Firefox</a></li>
<li><a href="../66989/index.html">Copyright for multiplication in mind</a></li>
<li><a href="../66997/index.html">What do you expect from Google Chrome OS?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>