<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VaR as a way to assess risk. Historical method</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I want to introduce you to the popular VaR ( ValueAtRisk ) financial risk assessment tool . In this case, I will try to use a minimum ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VaR as a way to assess risk. Historical method</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/247/55c/bd2/24755cbd24a7489fab2f0a318b53a7e0.jpeg"><br><br>  In this article I want to introduce you to the popular <b>VaR</b> ( <b>ValueAtRisk</b> ) financial risk assessment <b>tool</b> .  In this case, I will try to use a minimum of economic, mathematical and statistical terms. <br><br>  The main VaR ideas were developed and applied at JP Morgan in the 80s.  VaR was widely applied in 1993 when it was approved by the <a href="http://">Group of Thirty (G-30)</a> as part of the ‚Äúbest practices‚Äù for working with derivatives (derivative financial instruments).  And later it became one of the bank‚Äôs risk indicators for the <a href="http://">Basel II</a> system (a set of international recommendations on banking regulation).  The idea used in VaR can be traced back to the early works of Nobel Prize winner in economics, <a href="http://">Garia Markowitz</a> in 1952. <br><a name="habracut"></a><br><h4>  Why do you need VaR? </h4><br>  VaR has many uses: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  banks determine the current risk by department and bank in general; </li><li>  traders use VaR in their trading strategies (for example, to determine when to exit a trade); </li><li>  private investors to choose less risky investments; </li></ul><br><h4>  <b>Management of risks</b> </h4><br>  First, let's understand what risk management is and why it is needed. <br><blockquote>  ‚ÄúRisk management is the process of detecting, analyzing and making or mitigating uncertainty in investment decisions.  In essence, risk management always happens when an investor or a fund manager analyzes and tries to assess potential losses and then take (or not take) the necessary measures, given his investment objectives and risk tolerance. ‚Äù </blockquote><br>  ‚Üí <a href="http://www.investopedia.com/terms/r/riskmanagement.asp">Source</a> <br><br>  Why is risk management relevant?  <a href="http://">Daniel Kaneman,</a> in his book ‚Äú <a href="http://">Think slowly ... decide quickly</a> ‚Äù, says that people do not like to lose more than they like to win.  That is, if a person is offered to win $ 50 with 50% and lose $ 100 from 50%, he will most likely refuse, although the potential gain is even greater.  The author calls this loss asymmetry. <br><br>  Predicting possible losses to which people are so sensitive, we will deal with you.  But before moving on to VaR, we need to talk about the concept of <b>volatility</b> , without which it is impossible to imagine <b>risk management</b> . <br><br><h4>  <b>Little about volatility</b> </h4><br>  First, consider two examples. <br><br>  <b>Example 1</b> - let the whole of last year's action <b>A</b> every day either grow by 3% or lose -1%.  At the same time, these two events were independent and equally probable.  If our investments are $ 100, then we can with high probability say that the trend will continue tomorrow and we will either receive $ 3 or lose $ -1 with the same probability.  In other words, the probability of getting + 3 $ is 50% and the probability of losing $ -1 is also 50%.  We can even say that the <b>expected profit</b> every day is $ 1 ($ 3 * 50% -1 $ * 50%).  But as we will see later, the <b>expected profit</b> is not what interests us in risk management.  Losses are important for us, and with possible losses everything is clear here - <b>with a probability of 50%, we can lose $ 1</b> . <br><br><img src="https://habrastorage.org/files/c69/0aa/c72/c690aac7292c44ec8241ad950c4afe3f.png"><br>  <font color="#999999"><i>Random income + 3% or -1%</i></font> <br><br>  Now let's look at <b>example 2</b> .  There is information about the daily income of share B in the past year.  Income properties: <br><br><ul><li>  took one of four values ‚Äã‚Äã-4%, -3%, + 5%, + 6%; </li><li>  the probability of each of the four events is the same - 25%; </li></ul><br><img src="https://habrastorage.org/files/39e/eb3/108/39eeb3108a3540f68ed27d453d2db693.png"><br>  <font color="#999999"><i>Random income -3%, -4%, 5% or 6%</i></font> <br><br>  I specially selected the values ‚Äã‚Äãso that the average value was +1% (- 4% * 25% -3% * 25% + 5% * 25% + 6% * 25%) as in the first example.  That is, if we have shares for $ 100, then the <b>expected value</b> tomorrow will also be <b>$ 1</b> . <br><br><img src="https://habrastorage.org/files/b24/d6c/5aa/b24d6c5aa6eb4c57bbdda5853e92e2e7.png"><br>  <font color="#999999"><i>Comparison of example 1 (-1%, + 3%) and example 2 (-3%, -4%, 5%, 6%)</i></font> <br><br>  Although the expected values ‚Äã‚Äãare the same in two cases (+ 1%), the level of risk is different, since the amount of losses may be higher in the second case.  This is <b><a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D0%25BE%25D0%25BB%25D0%25B0%25D1%2582%25D0%25B8%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D1%258C">volatility</a></b> . <br><br><blockquote>  Volatility, volatility (English volatility) - a statistical financial indicator characterizing price volatility.  It is the most important financial indicator and concept in financial risk management, where it is a measure of the risk of using a financial instrument for a given period of time. </blockquote><br>  Or in your own words, volatility is the strength of the spread of values.  The greater the spread, the higher the volatility and the harder it is for us to make a price assumption in the future.  The conclusion is: <b>the higher the volatility, the higher the risk</b> .  It would seem that volatility is the indicator that we need. <br><br>  But volatility has one major drawback for risk management.  It takes into account both the spread of profits and the spread of losses.  For example, if the share price rises sharply, then volatility will increase.  Although the risk, in terms of possible losses, will remain at the same level.  This problem will be solved by VaR, but before moving on to VaR, let's deal with the problem of estimating losses. <br><br>  <b>Problem 1</b> .  How to describe potential losses? <br><br>  If in the first example the loss forecast for tomorrow was <b>-1% with a probability of 50%</b> , then in the second example the situation is more complicated.  We can say that: <br><br><ul><li>  <b>with a probability of 25%, we will lose 3%;</b> </li><li>  <b>with a probability of 25%, we will lose 4%;</b> </li><li>  <b>With a probability of 50%, we will lose more than 3%;</b> </li></ul><br>  All these statements are true, and in fact we have <b>only 4 possible outcomes</b> .  In real life, the number of outcomes can be much greater.  Accordingly, the number of statements we can make about the probability of risk will increase.  This complicates the reporting and analysis of information. <br><br>  <b>Problem 2.</b> Extreme values. <br><br>  Let's imagine that last year the stock took values ‚Äã‚Äãfrom -5% to 5%, but in one day the loss was -10%.  If we take the number of days in a year for 364 (for simplicity, let's forget about weekends and holidays), then the probability of a repeat loss of -10% is 1/364 = 0.274%.  The probability of 0.274% is quite small, it is difficult to imagine, and someone may consider it not at all essential for consideration.  How to be in this case? <br><br>  In both of these cases, VaR comes to our rescue. <br><br><h4>  <b>VaR</b> </h4><br>  VaR allows you to estimate losses with a certain probability.  And this can be done quite briefly so that a person can relatively easily imagine the size of the risk.  VaR answers the following question: <br><blockquote>  ‚Äú <b>What is the maximum loss I can expect for a certain period of time with a given level of probability (confidence)‚Äù</b> </blockquote><br>  For example, <b>VaR $ 100 with a threshold of 99%</b> means: <br><br><ul><li>  with a probability of 1%, we can lose $ 100 or more during the day; </li><li>  with a probability of 99%, we will not lose more than $ 100 during the day; </li></ul><br>  Both of these statements are equivalent. <br><br>  VaR consists of three components: <br><br><ul><li>  forecast level / threshold (usually 95% or 99%); </li><li>  time interval of the forecast (day, month or year); </li><li>  possible losses (the amount of money (usually dollars) or interest); </li></ul><br>  The ability to choose a threshold (99% in our example) is a very convenient feature for many investors.  This property allows you to approach the answer to the question that many investors care about ‚Äú <b>how much can we lose during the day (month) in the worst case?</b>  ". <br><br>  There are three methods for obtaining VaR: <b>historical</b> , <b>covariance,</b> and <b>the Monte Carlo method</b> . <br><br>  In this article we will look at the <b>historical method</b> , since it requires the least knowledge of statistics and, in my opinion, the most intuitive of the three. <br><br><h4>  VaR Counting Steps: </h4><br><ol><li>  Collect historical income data for a specific period (month, year); </li><li>  Sort data ascending; </li><li>  Choose the threshold with which we want to make a forecast and ‚Äúcut off‚Äù the worst value knowing the threshold; </li></ol><br>  For greater clarity, let's perform this process of finding VaR for a real example.  As an example, we‚Äôll look at Apple stock prices in 2015. <br><br><h4>  Steps: </h4><br>  1. <b>Get data on stock returns as a percentage</b> .  You can download data for example from yahoo.finance.com.  Yahoo provides opening, closing and other prices.  We will consider closing prices (close *).  Notice that the yahoo dates are sorted in descending order, so you can sort them in ascending order.  We convert the closing prices to profit as a percentage from the previous day.  For example, if the price was $ 10 yesterday, and today is $ 15, then the percentage profit will be ($ 15 -10 $) / $ 10 = 50%; <br><br><img src="https://habrastorage.org/files/e5c/688/00e/e5c68800e1ed45f2bd7a1aa2aa101b9b.png">  <font color="#999999"><i>Yahoo data conversion and sorting</i></font> <br><br><img src="https://habrastorage.org/files/3fc/2c1/0f3/3fc2c10f374f48789d8eca57ec10dca1.png" alt="image" align="left" width="60%" height="60%"><br>  2. <b>Sort profits</b> in ascending order (for clarity, I built a histogram); <br><br>  3. <b>Select the threshold</b> with which we want to make a forecast, and <b>‚Äúcut off‚Äù the worst value</b> knowing the threshold.  We have 252 business days.  If we want to make an assessment covering 95% of cases, then we discard the <b>worst</b> 5%, the probability of which we consider low.  5% of 252 days is 13 days (rounded up 12.6 to 13).  If you look at the chart, it is clear that the income of the 13th ‚Äúworst day‚Äù was -2.71%.  Now we can say that with a 95% probability we will not lose more than 2.71%.  <b>If our investment is $ 100, then with a 95% probability we will not lose more than $ 2.71.</b>  <b>This does not mean that we can not lose more than $ 2.71</b> , we are talking about a probability of 95%.  If this is not enough, then you can increase the threshold, for example, up to 99%; <br><br>  <i>* We choose close price, not adj.</i>  <i>close since adj.</i>  <i>close is variable and may change over time.</i>  <i>For example, if split shares occur.</i>  <i>Our goal is for the numbers to match those who follow this example later.</i> <br><br><img src="https://habrastorage.org/files/0a2/6b8/08e/0a26b808ef964f9ba5a50398722e44f5.png" alt="image" align="left" width="60%" height="60%">  Concluding the example with data from Apple, here is another interesting graph.  On the chart, horizontally, we see the ranges of profits, and vertically - the number of days when the profit fell in the corresponding interval.  This graph is very similar to the <a href="http://">normal distribution</a> .  This fact will be useful to us in the following articles where we consider two other methods for calculating VaR. <br><br clear="left"><div class="spoiler">  <b class="spoiler_title">Code example</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Double </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculateHistoricalVar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Double&gt; prices, Double confidenceLevel, Double amount)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (prices.isEmpty()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>d; } List&lt;Double&gt; returns = getReturns(prices); Collections.sort(returns); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> threshold = (returns.size() * (<span class="hljs-number"><span class="hljs-number">1</span></span> - confidenceLevel)); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> intPart = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) threshold; Double decimalPart = threshold - intPart; Double rawVar = returns.get(intPart); Double interpolatedPart = decimalPart * (returns.get(intPart) - (returns.get(intPart + <span class="hljs-number"><span class="hljs-number">1</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rawVar + interpolatedPart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> List&lt;Double&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReturns</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Double&gt; prices)</span></span></span><span class="hljs-function"> </span></span>{ List&lt;Double&gt; result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(prices.size()); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; prices.size(); i++) { result.add(prices.get(i) / (prices.get(i - <span class="hljs-number"><span class="hljs-number">1</span></span>)) - <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br><br></div></div><br>  <b>A little about the shortcomings of the historical method and VaR in general:</b> <br><br><ul><li>  We predict the future using historical data.  This may be a fragile assumption.  As we make the assumption that events from the past will be repeated.  You can try to deal with this using different time intervals to calculate VaR (year, month, day).  We will discuss this below. <br><br></li><li>  VaR says nothing about values ‚Äã‚Äãoutside the threshold, for example 95%.  We can have two different A and B stocks with a VaR of $ 50 at a threshold of 95% and 100 observations.  Let the 95 best observations of A and B are the same and equal from -50 $ to 45 $ with a step of 1 $.  But the five worst profits are A = {-1000 $, -800 $, -700 $, -600 $, -500 $}, and B = {-100 $, -99 $, -98 $, -97 $, -96 $}.  Obviously, the risk for B is higher.  You can try to deal with this by increasing the threshold (up to 99%, 99.9%, 99.99%, etc.).  There are also methods specifically designed to remedy these shortcomings, for example, Conditional VAR, which estimates losses if losses exceed VaR.  But we will not consider them in this article. </li></ul><br>  Questions that may arise when working with VaR: <br><br><ul><li>  <b>How to choose a period?</b> </li><li>  There is no definite answer to this, it all depends on your investment horizon.  Banks usually consider VaR for days; pension funds, on the other hand, often consider VaR for months. </li><li>  <b>What if 95% is not a whole item number?</b> </li><li>  In our example, we used 252 days and a 95% threshold.  The element that we cut equals 252 * 0.05 = 12.6.  In our example, we just rounded and took the 13th element, but to be precise, our value should be somewhere in the middle.  Unfortunately, in our example, the 12th and 13th elements are -2.71%.  Therefore, let's imagine that the 12th element is -4%, and the 13th is -3%.  Then VaR will be between -4% and -3%, closer to -3%.  Or rather -3.6%.  Here interpolation comes to our rescue.  The formula looks like this: <br><blockquote>  b + (ab) * k, where a is the lower value, b is the upper value, and the k-fractional part (in our case, 0.6) </blockquote><br>  It turns out -3% + (-4% + 3%) * 0.6 = -3.6% </li></ul><br><h4>  <b>Conclusion</b> </h4><br>  The beauty of the VaR approach is that it works great for a collection of several stocks or a combination of different securities.  For example, VaR for a set of bonds and currencies gives us an estimate without much effort.  And the use of other methods, such as analyzing possible scenarios, is greatly complicated due to the correlation (connection) between securities. <br><br>  ‚Üí <a href="http://www.investopedia.com/">Source</a> </div><p>Source: <a href="https://habr.com/ru/post/315154/">https://habr.com/ru/post/315154/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315144/index.html">The digest of interesting materials for the mobile # 179 developer (November 7-13)</a></li>
<li><a href="../315146/index.html">Texel density. Why and how to use it</a></li>
<li><a href="../315148/index.html">Y. Schmidhuber: ‚ÄúIt's great to be part of the future of artificial intelligence‚Äù</a></li>
<li><a href="../315150/index.html">Overclocking the performance of iOS applications</a></li>
<li><a href="../315152/index.html">Your programming language sucks</a></li>
<li><a href="../315156/index.html">The correct polymorphic Java builder.</a></li>
<li><a href="../315160/index.html">Terminal Server Scan Free</a></li>
<li><a href="../315164/index.html">How else to use type safety to improve the API</a></li>
<li><a href="../315166/index.html">Log in or Log on? Front-end or Frontend? We continue to understand</a></li>
<li><a href="../315168/index.html">Comparing objects by value - 3, or Type-specific Equals & Equality operators</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>