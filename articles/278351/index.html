<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to create objects in PowerShell</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Found that runet search engines issue mostly outdated add-member methods. How to create objects, why this is the case and why it is necessary in trans...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to create objects in PowerShell</h1><div class="post__text post__text-html js-mediator-article">  Found that runet search engines issue mostly outdated <i>add-member</i> methods.  How to create objects, why this is the case and why it is necessary in translation from the gurus of PowerShell.  You will learn how to create an object from a hash table, and learn a few tricks to work with them. <br><br>  PowerShell in Depth <br><br>  <b>Chapter 21.1 Technique number 1. Using hash tables to create custom objects.</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's start the techniques that we usually use ourselves when we need to create our own object or merge information from different objects into one for subsequent output.  We call this path official, or recommended.  We use it because it makes it easy to write code, we read well and ultimately allows us to do our work faster. <br>  This method is shown in Listing 21.2 below. <br><a name="habracut"></a><br><pre><code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">#   ,         $os = Get-WmiObject ‚ÄìClass Win32_OperatingSystem ‚Äìcomp localhost $cs = Get-WmiObject ‚ÄìClass Win32_ComputerSystem ‚Äìcomp localhost $bios = Get-WmiObject ‚ÄìClass Win32_BIOS ‚Äìcomp localhost $proc = Get-WmiObject ‚ÄìClass Win32_Processor ‚Äìcomp localhost | Select ‚ÄìFirst 1 #  .     $props = @{OSVersion=$os.version Model=$cs.model Manufacturer=$cs.manufacturer BIOSSerial=$bios.serialnumber ComputerName=$os.CSName OSArchitecture=$os.osarchitecture ProcArchitecture=$proc.addresswidth} #        $obj = New-Object ‚ÄìTypeName PSObject ‚ÄìProperty $props Write-Output $obj</span></span></code> </pre> <br><br>  By executing this code, you will get a result similar to this: <br><br><pre> <code class="cs hljs">Manufacturer : Microsoft Corporation OSVersion : <span class="hljs-number"><span class="hljs-number">6.3</span></span><span class="hljs-number"><span class="hljs-number">.9600</span></span> OSArchitecture : <span class="hljs-number"><span class="hljs-number">64</span></span>-bit BIOSSerial : <span class="hljs-number"><span class="hljs-number">036685734653</span></span> ComputerName : RSSURFACEPRO2 Model : Surface Pro <span class="hljs-number"><span class="hljs-number">2</span></span> ProcArchitecture : <span class="hljs-number"><span class="hljs-number">64</span></span></code> </pre><br><br>  Since  at the output, you have an object with more than four properties. PowerShell made a list output on the screen.  You could perform <br><br><pre> <code class="cs hljs">Write-Output $obj | ft</code> </pre><br><br>  to get a table.  Note that the fact is that you created one object by combining information from four objects.  You did this by creating a hash table in which you entered the desired property names, the values ‚Äã‚Äãfor them became the property values ‚Äã‚Äãof other objects.  This is what you did in the hash table pointing: <br><br><pre> <code class="cs hljs">Manufacturer=$cs.manufacturer</code> </pre><br><br>  If you put the hash table entries on one line, you will need to separate each property with a semicolon.  If you put each property on a separate line, you do not need a semicolon, it is much easier for you to read and edit the code. <br>  The parentheses with the preceding @ sign say that the hash table begins next.  Since  the table is in the <i>$ props</i> variable <i>;</i> it is easy to transfer it in the <i>-property</i> parameters of the new object.  The <i>PSObject</i> object <i>is</i> specifically designed for this purpose. <br><br>  The advantage of this approach is that it is easy to build a hash table on the fly and create many user objects from it.  You may notice that in the output object the properties are not of the same order as they were defined in the table.  One of the possible solutions is to create formatting for a custom object (a special XML file describing how to display, in what order, etc.) or, if you use powershell 3 and higher, you can use the <i>ordered</i> property <br><br><pre> <code class="cs hljs">$props = [ordered]@{ OSVersion=$os.version Model=$cs.model Manufacturer=$cs.manufacturer BIOSSerial=$bios.serialnumber ComputerName=$os.CSName OSArchitecture=$os.osarchitecture ProcArchitecture=$proc.addresswidth}</code> </pre><br><br>  Everything else is the same.  Now the properties of the object will be displayed in the order in which they were written.  If you pass <i>$ obj</i> to <i>Get-Member</i> , you will see that this is a <i>PS-CustomObject</i> . <br><br>  Note By default, PowerShell does not track the order of elements in a hash table.  That's why when you see the final output, its properties go in the wrong order in which you created them.  Starting in PowerShell 3, you can fix this by using the <i>[ordered]</i> attribute.  This creates an ordered dictionary (another name for the hash tables) and maintains the order of the elements in it. <br><br>  I will add from myself. <br>  Indeed, this method is very convenient: easy to read, easy to edit.  This method is widely used in PowerShell - from creating parameters for sending email via SMTP, for combining information into a single object for output from a function or script. </div><p>Source: <a href="https://habr.com/ru/post/278351/">https://habr.com/ru/post/278351/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278341/index.html">Why Habr died. What to do and where to run</a></li>
<li><a href="../278343/index.html">Chapter 21. Part 1 - Creating objects and data output objects. PowerShell in depth - Don Jones, Richard Siddaway</a></li>
<li><a href="../278345/index.html">MSLibrary. Capture and verify phone numbers using regular expressions, for iOS and not only ... Part 1</a></li>
<li><a href="../278347/index.html">Oracle IaaS and PaaS - all for you</a></li>
<li><a href="../278349/index.html">Interesting ways to use Go channels (translation)</a></li>
<li><a href="../278353/index.html">No, "Habr" does not die</a></li>
<li><a href="../278359/index.html">MSLibrary. Capturing and verifying phone numbers using regular expressions, for iOS and not only ... Part 2</a></li>
<li><a href="../278361/index.html">Preparing for the CISA exam. Benefits of Business Continuity</a></li>
<li><a href="../278363/index.html">Alljoyn: embedded view of the developer. Part 3: Porting on MK SAMD21</a></li>
<li><a href="../278365/index.html">Study Jam courses for Android developers started in Kazan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>