<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Office as Platform: how was a Notegram project for OneNote created?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the first-person Notegram project success story - Dmitry Konev, a project developer who created an interesting project that extends the capabi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Office as Platform: how was a Notegram project for OneNote created?</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <i><a href="http://notegram.me/">This is</a> the first-person <a href="http://notegram.me/">Notegram</a> project success story - Dmitry Konev, a project developer who created an interesting project that extends the capabilities of the Office OneNote application.</i>  <i>All articles in the column ‚ÄúOffice as Platform‚Äù you can always find at the link <a href="http://habrahabr.ru/search/%3Fq%3D%255B%2523officeplatform%255D%26target_type%3Dposts">#officeplatform</a> - Vladimir Yunev.</i> </blockquote><br><div style="text-align:center;"><img width="650" src="https://habrastorage.org/files/458/a30/f64/458a30f643c84a73b1ed0770bdc71ab1.png"></div><br>  Hackathon LA Hacks was held from April 3 to 5, at the Pauley Pavilion Stadium at the University of Los Angeles.  With a huge bunch of participants and partners, it was an amazing sight, especially for a person who has never been to the hackathon. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  You can see the gif from the venue here: <a href="https://gfycat.com/UnhappyWholeHoverfly">gfycat.com/UnhappyWholeHoverfly</a> </div></div><br>  It so happened that I was not very interested in the projects of other participants, and I was left without a team.  Having passed the most important part of any hackathon - having collected all the good from companies - somewhere around 3 o'clock in the morning I ended up at the Microsoft stand, to my surprise, with still living engineers.  After talking with them (and armed with vouchers for Microsoft Azure), I got the idea to do something with the Microsoft API. <br><a name="habracut"></a><br><h3>  Project </h3><br>  Microsoft has its own repository of notes - OneNote.  A very convenient application, especially for a student, because there you can save not only text and pictures, but also export PDF files, mathematical formulas and record sound, and if you have a tablet like Microsoft Surface, then use handwriting input. <br><br>  In OneNote, I lacked templates.  There are add-ons for the desktop version of OneNote, but given the fact that I most often used OneNote on a tablet, I wanted to get rid of platform binding.  So the idea for Notegram appeared. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Before that, I wasn‚Äôt doing back-end development at all, so I went in reverse order. <br><br><h3>  Design </h3><br><div style="text-align:center;"><img width="450" src="https://habrastorage.org/files/ed4/860/82f/ed486082f4a345348ea88a99431cb614.png"></div><br>  I started with the logo.  The letter N on the OneNote logo has been replaced with the share icon. <br><br>  Then the layout of the application itself was made.  The design was based on the OneNote application for Windows 8.1. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fd8/692/ebb/fd8692ebbe7945d1bc865d5895010bf2.png"></div><br>  The interface was created from scratch, without using widgets like Bootstrap. <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"img/month.png"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Monthly Calendar<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>An essential for those who keep track of everything.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span>Save<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Each element was made quite simple, so that almost nothing had to change for the mobile version - just needed to add this code here: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width, initial-scale=1"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/0bd/671/6ec/0bd6716ec67b4b9faddd057d2de775c4.png"></div><br><h3>  Work with API </h3><br>  Since I was given many vouchers for Microsoft Azure, it was decided to place the project there.  It turned out to be very simple to create an application based on Node.js - you can simply use the Git repository.  Microsoft even has an example of the OneNote API application on Node.js, which can save pages to OneNote - just what I wanted to use. <br><br>  <a href="https://github.com/OneNoteDev/OneNoteAPISampleNodejs">github.com/OneNoteDev/OneNoteAPISampleNodejs</a> <br><br>  To begin with, it was necessary to get the Client ID from the <a href="http://go.microsoft.com/fwlink/p/%3FLinkId%3D193157">Live app management</a> portal and register it in the config.js file.  The application will work only from the URL that is registered in the portal, so it is recommended to register the application domain in the hosts file for testing. <br><br>  The example provided by Microsoft already contained the most important code for authorizing the user and sending examples - namely, there is a function that sends the text of the note; several things needed to be done to use it: <br><br>  On the page of the logged in user there were buttons for templates: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"month"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"disabled"</span></span></span><span class="hljs-tag">&gt;</span></span>Save<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The routes / index.js file already had a switch-statement processing requests, so I needed to add my templates to it: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'month'</span></span>: createExamples.createPageMonth(accessToken, createResultCallback); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;</code> </pre> <br>  Then, the query itself was created in the file lib / create-examples.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.createPageMonth = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">accessToken, callback</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> htmlPayload = fs.readFileSync(path.normalize(__dirname + <span class="hljs-string"><span class="hljs-string">'/../templates/month.html'</span></span>), <span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>); createPage(accessToken, htmlPayload, callback, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); };</code> </pre> <br>  The text of the file and the user's access token were passed to the sendPage function.  The function creates a request for the API: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createPage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">accessToken, payload, callback, multipart</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> options = { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: https:<span class="hljs-comment"><span class="hljs-comment">//www.onenote.com/api/v1.0/pages, headers: {'Authorization': 'Bearer ' + accessToken} }; options.headers['Content-Type'] = 'text/html'; options.body = payload; var r = request.post(options, callback); }</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/9b3/d07/24c/9b3d0724ccff4fa09bebeae11d096d9f.png"></div><br>  So, without having special knowledge in work with REST API and Node.js, I already had almost ready application.  The last remained ... <br><br><h3>  Templates </h3><br>  OneNote API has limited HTML support for creating pages: <a href="https://dev.onenote.com/docs">https://dev.onenote.com/docs#/introduction/meta-tag-details</a> <br><br>  I went a little different way: You can also get pages in the OneNote API, so I could just create all the templates in OneNote. <br><br>  Initially, I had 8 templates.  4 for organizing time: calendar, weekly, diary, task list in the style of GTD. <br><br>  4 to demonstrate the possibilities of Notegram: two templates for LA Hacks, a trip planner, a template for keeping a diary. <br><br>  After the hackathon I was asked to add a new template for accounting, so at the moment I already have 9 templates. <br><br><div style="text-align:center;"><img width="650" src="https://habrastorage.org/files/d4f/421/52d/d4f42152d094477ba8a3ed294c04e76d.png"></div><br>  After creating the templates, I used the <a href="https://apigee.com/onenote/embed/console/onenote">Apigee</a> service to get the HTML code.  After authorization in OneNote API, a request was sent to the page like <a href="https://www.onenote.com/api/v1.0/pages/%255BpageId%255D/content">https://www.onenote.com/api/v1.0/pages/[pageId_/content</a> . <br><br><h3>  Conclusion </h3><br><div style="text-align:center;"><img width="450" src="https://habrastorage.org/files/086/f54/146/086f54146b854305ac82731b7171a11c.png"></div><br>  After a sleepless night of work on the project, I got a working application that won first place from Microsoft.  It was an amazing experience, and I am very grateful to the Microsoft employees who helped participants with their projects and am very pleased that they were interested in my project. <br><br>  In connection with my studies, I did not have enough time to work on the project, but I have many ideas for Notegram: <br><br><ul><li>  Custom templates </li><li>  Russian localization </li><li>  Application for Windows 10 </li></ul><br>  Notegram is available right now at <a href="http://notegram.me/">http://notegram.me</a> <br><br><h3>  To authors </h3><br>  Friends, if you are interested in supporting the column with your own material, please write to me at <a href="">vyunev@microsoft.com</a> to discuss all the details.  We are looking for authors who can be interesting to tell about the development under Office and other topics. <br><img align="right" width="200" src="https://habrastorage.org/files/7fb/e8b/83b/7fbe8b83bfb44b27873f0ddb63c35ec5.png"><br><h3>  about the author </h3><br>  <b>Dmitry Konev</b> <br>  Student studying at De Anza College in California <br><br>  I am from Moscow.  Not so long ago, he moved to Silicon Valley, to comprehend the world of developers and technologies.  I was a user of Microsoft services for a long time, but only recently I found myself in the role of a developer.  Recently, I'm interested in web development, before that I mainly worked with C ++. </div><p>Source: <a href="https://habr.com/ru/post/270213/">https://habr.com/ru/post/270213/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270203/index.html">Snom C520 and C52 - space design and wide opportunities</a></li>
<li><a href="../270205/index.html">What is written with a pen, or how to check documents in MS Office formats</a></li>
<li><a href="../270207/index.html">Metronome IM and Jappix: a multi-functional Jabber, without difficulty in setting up</a></li>
<li><a href="../270209/index.html">Ansible 2.0 b2. Overview of innovations</a></li>
<li><a href="../270211/index.html">Monstrous frankenstek</a></li>
<li><a href="../270215/index.html">Event-oriented Python backtesting step by step. Part 5 (and last)</a></li>
<li><a href="../270217/index.html">Google Play Services Research: Place Picker & Autocomplete</a></li>
<li><a href="../270219/index.html">Unity Cloud Build or how to build an iOS build on Windows</a></li>
<li><a href="../270223/index.html">Download and convert video to Rutube: from crutches to meta-programming</a></li>
<li><a href="../270225/index.html">Double cycle KCS. Just about knowledge management.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>