<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Deliver voice to mobile network: step 2 - Analog Digital Conversion</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the first part of a series of articles, we looked at the conversion of the human voice into an electrical signal. Now, it would seem, it's time to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Deliver voice to mobile network: step 2 - Analog Digital Conversion</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/beeline/blog/248807/"><b>In the first part of a</b></a> series of articles, we looked at the conversion of the human voice into an electrical signal.  Now, it would seem, it's time to transmit this signal to the location of the interlocutor and start a conversation!  That is exactly what they did originally.  However, the more popular the service became and the longer it was necessary to transmit a signal, the clearer it became that the analog signal was not suitable for this. <br>  In order to ensure the transfer of information to any distance without loss of quality, we will need to perform a second conversion from Analog to Digital. <br><br><img src="https://habrastorage.org/files/ab2/a5c/6dd/ab2a5c6dd617415d98ae20f4355f9ae3.jpeg"><br><br>  This picture gives the most visual idea of ‚Äã‚Äãwhat happens during the Analog Digital Conversion (ADC), and then we look at why this is needed, how the technology has developed, and what requirements are imposed on such a transformation in mobile networks. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Those who missed or forgot, what was discussed in the first part, can remember <a href="http://habrahabr.ru/company/beeline/blog/248807/"><b>How we received an electrical signal from sound vibrations</b></a> , and we will continue the description of transformations by moving around the picture, which indicates a new area that interests us at the moment: <br><br><img src="https://habrastorage.org/files/669/e78/588/669e785883bb46b68b75a7900f3a9074.png"><br><br>  First, let's understand why it is generally necessary to convert an analog signal into some sequence of zeros and ones, which cannot be heard without special knowledge and mathematical transformations. <br><br>  After the microphone, we have an analog electrical signal, which can be easily ‚Äúvoiced‚Äù using a speaker, which, in fact, was done in the first experiments with telephones: the inverse ‚Äúelectrical signal - sound wave‚Äù transformation was performed in the same room or at a minimum distance. <br>  Just what is this phone for?  In the next room you can bring sound information without any transformations - just by raising your voice.  Therefore, the task appears - to hear the interlocutor at the maximum distance from the initiator of the conversation. <br>  And here inexorable laws of nature come into force: the greater the distance, the stronger the electrical signal in the wires fades, and after a certain number of meters / kilometers it will be impossible to recover the sound from it. <br>  Those who found fixed-line telephones working with decade-step PBXs (analog telephone exchanges) remember well what voice quality was sometimes provided with the help of these devices.  And someone can remember such forgotten exotic inclusions ‚Äúthrough a blocker‚Äù / ‚Äúparallel telephone‚Äù, when two telephones in one house were switched on to one telephone line, while, when one subscriber occupied the line, the second one was forced to wait for the end of his conversation .  Believe me - it was not easy! <br><br>  That is, to increase the number of simultaneous calls between two points, using analog lines, we need to lay more and more wires.  What this can lead to can be estimated from the urban landscapes of the beginning of the last century: <br><br><img src="https://habrastorage.org/files/0fb/489/ea9/0fb489ea967445089d0f096b7410db49.jpg"><img src="https://habrastorage.org/files/7e0/f4f/c71/7e0f4fc71f904a92aea3b857f00f52cf.jpg"><br><br>  Therefore, immediately after the invention of the telephone, the best engineers set about solving the problem: how to transmit the voice over long distances with maximum quality preservation and minimal equipment costs. <br><br>  What do we need in order for a continuous analog electric signal to become discrete, encoded with sequences of zeros and ones, and at the same time transmit information as close as possible to the original? <br><br>  A bit of theory. <br><br>  To convert any analog signal to digital, it is necessary at certain intervals (the sampling step in the picture below) to record the signal amplitude with a certain accuracy (quantization step). <br><br><img src="https://habrastorage.org/files/ec3/c7d/932/ec3c7d932faa47f08c25c61f1b17e71d.jpeg"><br><br>  After digitizing, you will get a stepped graph shown in the figure.  To get the digitized signal as close as possible to the analog one, the sampling step is necessary and the quantization step should be chosen as small as possible; for infinite values, we will get a perfectly digitized record. <br><br>  In practice, infinite digitization accuracy is not required, and you need to choose what accuracy can be considered sufficient for voice transmission with the required quality? <br>  Here we will come to the aid of knowledge about the sensitivity of human hearing organs: it is commonly assumed that a person can distinguish sounds with a frequency from 20 Hz to 22 000 Hz.  These are the boundary values ‚Äã‚Äãfor discretization that will allow to transmit any sound perceived by a person.  If we translate Hz into more familiar seconds, we get 0.000045 seconds, that is, measurements must be taken every 4.5 hundred thousandths of a second!  Moreover, this is not enough.  The reasons and the required values ‚Äã‚Äãof the sampling rate will be described below. <br><br>  Now we will determine the quantization step: the quantization step allows us to assign a certain amplitude value to the measured signal at each time instant. <br>  In the first approximation, you can simply check the presence or absence of a signal, to describe such a number of options, we only need two values: 0 and 1. In computer science, this corresponds to the amount of information: 1 bit and the recording bit will be 1. If you digitize any sound with such bit depth , at the output we get a discontinuous recording, consisting of pauses and the sound of one tone, it can hardly be called a voice recording. <br>  Therefore, it is necessary to increase the number of measured amplitude options, for example, to 4 (that is, up to 2 bits - 2 to the power of 2): 0 - 0.25 mA - 0.5 mA - 0.75 mA. <br>  With such values, it will be possible to distinguish some changes in the sound after digitization, and not just its presence or absence.  An illustration that perfectly shows what gives us an increase in bit depth (quantization) when digitizing sound is shown in this figure: <br><br><img src="https://habrastorage.org/files/409/657/fcb/409657fcbcbd4abfad3ef3c043e5d3ab.jpeg"><br><br>  Now, having seen the numbers 44 kHz / 16 bits in the properties of the music file, you can immediately understand that the Analog-Digital Conversion was done with a sampling of 1 / 44kHz = 0.000023 seconds and with a quantization depth of 2 to 16 degrees - 65,536 value choices. <br><br>  The first circuit solutions for performing ADC-DAC transformations were, as always, large and slow: <br><br><img src="https://habrastorage.org/files/9c1/482/015/9c148201564a45c6bd74a9435696b3e9.jpg"><br><br>  Now these tasks are performed in the main processor of the mobile phone, which simultaneously copes with a huge number of other tasks: <br><br><img src="https://habrastorage.org/files/dcf/d4e/ef5/dcfd4eef50dc4cfdaed6323580d93fec.jpg"><br><br>  If you digitize without additional optimization of the obtained digital model, the amount of data received will be very large, it is enough to remember how much space on your disc an audio file can take in uncompressed form.  A standard CD, for example, is 780 megabytes of information and only 74 minutes of sound! <br>  After processing such a file using optimization algorithms and data loss compression (for example, mp3), the file size can be reduced 10 or more times. <br><br>  For our purposes, the amount of data received is of fundamental importance, since it is still necessary to transmit them to your interlocutor, and the resource of the transport channel is very limited. <br>  Again, the challenge for engineers is to maximize the amount of data transferred while maintaining the required quality. <br><br>  In conversational speech, which sounds during a telephone dialogue, the frequency spectrum is significantly lower than that available for perception, therefore, to transmit a telephone conversation, you can limit yourself to a narrower spectrum: for example, 50..7000 Hz.  We wrote about this in sufficient detail in the article on <a href="http://habrahabr.ru/company/beeline/blog/228231/"><b>voice codecs in mobile networks.</b></a> <br><br>  Now we have the initial data for the start of the conversion - an electrical analog signal, in the range of 50-7000 Hz, and we need to carry out the A-CPU conversion so that the signal distortion during the conversion (those steps on the graph above) does not affect the recording quality .  To do this, select the values ‚Äã‚Äãof the sampling step and quantization step, sufficient for a complete description of the existing analog signal. <br>  Here we come to the aid of one of the fundamental theorems in the field of digital signal processing - the <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%259A%25D0%25BE%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25BE%25D0%25B2%25D0%25B0"><b>Kotelnikov Theorem</b></a> . <br>  In it, our compatriot mathematically justified the frequency with which it is necessary to measure the values ‚Äã‚Äãof a function for its exact numerical representation.  For us, the most important consequence of this theorem is as follows: measurements should be carried out twice as often as the highest frequency, which we need to translate into a digital form. <br>  Therefore, the discretization step for digitizing the conversation will be enough to take at the level of 14 kHz, and for high-quality digitization of music - 2 x 22 kHz, here we get the standard 44 kHz, with which now, as a rule, music files are created. <br><br>  There are a large number of a wide variety of voice codecs that can be used in wired and wireless networks, with codecs for wired networks, in general, encode voice with better quality, and codecs for wireless networks (networks of mobile operators) with slightly worse quality. <br>  But these codecs generate additional data to restore the received signal in case of unsuccessful delivery due to complex radio conditions.  This feature is called noise immunity, and the development of codecs for mobile networks occurs in the direction of improving the quality of the transmitted signal while increasing its noise immunity. <br><br>  Mobile networks use whole classes of voice codecs, which include a set of dynamically selectable encoding rates, depending on the current subscriber position and the quality of radio coverage at this point: <br><br><table><tbody><tr><th>  Codec </th><th>  Standard </th><th>  Year of creation </th><th>  Compressible frequency range </th><th>  Generated bitrate </th></tr><tr><td>  Full Rate - FR </td><td>  GSM 06.10 </td><td>  1990 </td><td>  200-3400 Hz </td><td>  FR 13 kbit / s </td></tr><tr><td>  Half Rate - HR </td><td>  GSM 06.20 </td><td>  1990 </td><td>  200-3400 Hz </td><td>  HR 5.6 kbit / s </td></tr><tr><td>  Enhanced Full Rate - EFR </td><td>  GSM 06.60 </td><td>  1995 </td><td>  200-3400 Hz </td><td>  FR 12.2 kbit / s </td></tr><tr><td>  Adaptive Multi Rate - AMR </td><td>  3GPP TS 26.071 </td><td>  1999 </td><td>  200-3400 Hz </td><td>  FR 12.20 </td></tr><tr><td>  Adaptive Multi Rate - AMR </td><td>  3GPP TS 26.071 </td><td>  1999 </td><td>  200-3400 Hz </td><td>  FR 10.20 </td></tr><tr><td>  Adaptive Multi Rate - AMR </td><td>  3GPP TS 26.071 </td><td>  1999 </td><td>  200-3400 Hz </td><td>  FR / HR 7.95 </td></tr><tr><td>  Adaptive Multi Rate - AMR </td><td>  3GPP TS 26.071 </td><td>  1999 </td><td>  200-3400 Hz </td><td>  FR / HR 7.40 </td></tr><tr><td>  Adaptive Multi Rate - AMR </td><td>  3GPP TS 26.071 </td><td>  1999 </td><td>  200-3400 Hz </td><td>  FR / HR 6.70 </td></tr><tr><td>  Adaptive Multi Rate - AMR </td><td>  3GPP TS 26.071 </td><td>  1999 </td><td>  200-3400 Hz </td><td>  FR / HR 5.90 </td></tr><tr><td>  Adaptive Multi Rate - AMR </td><td>  3GPP TS 26.071 </td><td>  1999 </td><td>  200-3400 Hz </td><td>  FR / HR 5.15 </td></tr><tr><td>  Adaptive Multi Rate - AMR </td><td>  3GPP TS 26.071 </td><td>  1999 </td><td>  200-3400 Hz </td><td>  FR / HR 4.75 </td></tr><tr><td>  Adaptive Multi Rate - WideBand, AMR-WB </td><td>  3GPP TS 26.190 </td><td>  2001 </td><td>  50-7000 Hz </td><td>  FR 23.85 </td></tr><tr><td>  Adaptive Multi Rate - WideBand, AMR-WB </td><td>  3GPP TS 26.190 </td><td>  2001 </td><td>  50-7000 Hz </td><td>  FR 23.05 </td></tr><tr><td>  Adaptive Multi Rate - WideBand, AMR-WB </td><td>  3GPP TS 26.190 </td><td>  2001 </td><td>  50-7000 Hz </td><td>  FR 19.85 </td></tr><tr><td>  Adaptive Multi Rate - WideBand, AMR-WB </td><td>  3GPP TS 26.190 </td><td>  2001 </td><td>  50-7000 Hz </td><td>  FR 18.25 </td></tr><tr><td>  Adaptive Multi Rate - WideBand, AMR-WB </td><td>  3GPP TS 26.190 </td><td>  2001 </td><td>  50-7000 Hz </td><td>  FR 15.85 </td></tr><tr><td>  Adaptive Multi Rate - WideBand, AMR-WB </td><td>  3GPP TS 26.190 </td><td>  2001 </td><td>  50-7000 Hz </td><td>  FR 14.25 </td></tr><tr><td>  Adaptive Multi Rate - WideBand, AMR-WB </td><td>  3GPP TS 26.190 </td><td>  2001 </td><td>  50-7000 Hz </td><td>  FR 12.65 </td></tr><tr><td>  Adaptive Multi Rate - WideBand, AMR-WB </td><td>  3GPP TS 26.190 </td><td>  2001 </td><td>  50-7000 Hz </td><td>  FR 8.85 </td></tr><tr><td>  Adaptive Multi Rate - WideBand, AMR-WB </td><td>  3GPP TS 26.190 </td><td>  2001 </td><td>  50-7000 Hz </td><td>  FR 6.60 </td></tr><tr><td>  Adaptive Multi Rate-WideBand +, AMR-WB + </td><td>  3GPP TS 26.290 </td><td>  2004 </td><td>  50-7000 Hz </td><td>  6 - 36 kbit / s (mono) </td></tr><tr><td>  Adaptive Multi Rate-WideBand +, AMR-WB + </td><td>  3GPP TS 26.290 </td><td>  2004 </td><td>  50-7000 Hz </td><td>  7 - 48 kbit / s (stereo) </td></tr></tbody></table><br>  The table lists all codecs used in modern mobile networks, of which codecs with dynamic bitrate (in which the ratio of useful data and redundant data for data recovery changes) are called AMR - Adaptive Multi Rate.  FR / HR / EFR codecs are used only in GSM networks. <br><br>  To visualize how much more data is encoded in high-speed codecs, take a look at the following picture: <br><br><img src="https://habrastorage.org/files/623/eba/e43/623ebae43b0e419cab1345fe2b6554cc.jpeg"><br><br>  The transition from AMR codecs to AMR-WB almost doubles the amount of data, and AMR-WB + requires another 40-50% more than the width of the transport channel! <br>  That is why in mobile networks, broadband codecs in mobile networks have not yet found wide application, but in the future it is possible to switch to the Super Wide Band (AMR-WB +) and even to the Full Band band, for example, for online broadcasts of concerts. <br><br>  So - after performing the second stage of voice conversion, instead of sound vibrations, we receive a stream of digital data ready for transmission via the transport network. <br>  Until the moment of the inverse conversion of numbers to an analog signal, this data remains almost unchanged (sometimes in the process of voice delivery transcoding from one codec to another may occur), and further transformations taking place with our voice will affect the physical medium through which the call is transmitted. <br><br>  In the next article, we will look at what happens between the phone and the base station, and how miraculously the data stream that we form is delivered wirelessly to the operator‚Äôs equipment. <br><br><img src="https://habrastorage.org/files/025/d8f/aa2/025d8faa22d34b0894d0073faa0d088c.png"><br><br>  PS To everyone who is interested in the topic of digital communication and the history of its development, I highly recommend the book ‚ÄúAnd the Mysterious World behind the Curtain of Numbers‚Äù authors B.I. Kruk, G.N.Popov.  From the point of view of modern standards and technologies, it is a bit outdated, but the authors describe the theoretical and historical part perfectly well, diluting the dry theory with living examples and illustrations. </div><p>Source: <a href="https://habr.com/ru/post/265841/">https://habr.com/ru/post/265841/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265825/index.html">RailsClub 2015: Interview with Andrey Deryabin</a></li>
<li><a href="../265831/index.html">Go to Basecamp (creators of RoR)</a></li>
<li><a href="../265833/index.html">GC in Go: priority on speed and simplicity</a></li>
<li><a href="../265835/index.html">IBM Cognos BI and QlikView, where to start curious?</a></li>
<li><a href="../265837/index.html">Urho3D Editor (Part 2)</a></li>
<li><a href="../265843/index.html">Dagaz: Kicks to common sense (part 10)</a></li>
<li><a href="../265845/index.html">RESTful API - big lie</a></li>
<li><a href="../265847/index.html">Using ES6 in AngularJs 1.x with Browserify + Babel build</a></li>
<li><a href="../265851/index.html">Cage with all amenities</a></li>
<li><a href="../265853/index.html">How to create forms for subscribing to email newsletter: Errors and solutions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>