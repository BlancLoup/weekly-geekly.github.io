<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Three helpful Rails console tips</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The topic is a free translation of the article on 37signals . 

 Yesterday, I delved into the Rails API documentation and noticed some useful features...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Three helpful Rails console tips</h1><div class="post__text post__text-html js-mediator-article"> <i>The topic is a free translation of the article on <a href="http://37signals.com/svn/posts/3176-three-quick-rails-console-tips">37signals</a> .</i> <br><br>  Yesterday, I delved into the Rails API documentation and noticed some useful features of the console rails, <a href="http://api.rubyonrails.org/classes/Rails/ConsoleMethods.html">which I had not seen before</a> .  There have <a href="http://slash7.com/2006/12/21/secrets-of-the-rails-console-ninjas/">been</a> <a href="http://railscasts.com/episodes/48-console-tricks">many</a> <a href="http://rors.org/2009/12/20/10-rails-console-tricks.html">publications</a> on irb and Rails before, but I hope that you will learn something new from this one.  The examples above are made using Basecamp Next on Rails version 3.2.3. <br><a name="habracut"></a><br>  <b>Immerse yourself in your app.</b> <br><br>  Using the app method in the console creates an instance of the session, as a result of which you can use the capabilities of the usual <a href="http://guides.rubyonrails.org/testing.html">integration test</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>&gt;&gt; app.class <br> =&gt; ActionDispatch::Integration::Session</code> <br> <br>  To form routes has always been stressful.  What module was there to connect?  Did you remember to specify default_url_options?  Stop google and just use the app: <br><br> <code>&gt;&gt; app.project_path(Project.first) <br> =&gt; "/projects/130349783-with-attachments"</code> <br> <br>  It can also create queries within the application: <br><br> <code>&gt;&gt; app.get "/735644780/projects/605816632-bcx.atom" <br> =&gt; 200 <br> <br> &gt;&gt; app.response.body <br> =&gt; "&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;feed xml:lang=\"en-US\" ...</code> <br> <br>  Look at <a href="http://api.rubyonrails.org/classes/ActionDispatch/Integration/Session.html">ActionDispatch :: Integration :: Session</a> and <a href="http://api.rubyonrails.org/classes/ActionDispatch/Integration/RequestHelpers.html">ActionDispatch :: Integration :: RequestHelpers</a> to find out how this object can be useful. <br><br>  <b>Try helper</b> <br><br>  Linking a console session with Rails helpers is also painful, but the helper can fix it!  You can also use it to play with the creation of HTML tags or any other Rails helper that ActionView knows about. <br><br> <code>&gt;&gt; helper.truncate("Testing", length: 4) <br> =&gt; "T..." <br> <br> &gt;&gt; helper.link_to "Home", app.root_path <br> =&gt; "Home"</code> <br> <br>  Another helper idea is to use instance variables inside the helper method.  Yes, I know that this is a Bad Idea ‚Ñ¢ for helpers as a whole, but none of my Rails applications have done without it.  Here is a small example of the method: <br><br> <code>def title_tag(title = nil) <br> if @project.present? &amp;&amp; title.nil? <br> content_tag :title, @project.name <br> elsif @project.present? <br> content_tag :title, "#{@project.name}: #{title}" <br> else <br> content_tag :title, title <br> end <br> end</code> <br> <br>  You can use the help of an old buddy of Object # instance_variable_set to break the basic principle of OOP, let‚Äôs try the helper in the console: <br><br> <code>&gt;&gt; helper.title_tag "Testing!" <br> =&gt; "Testing!" <br> <br> &gt;&gt; helper.instance_variable_set :@project, Project.first <br> =&gt; #&lt;Project id: 130349783, ... <br> <br> &gt;&gt; helper.title_tag <br> =&gt; "With attachments!" <br> <br> &gt;&gt; helper.title_tag "Posts" <br> =&gt; "With attachments!: Posts"</code> <br> <br>  Working with a helper using params is also not too easy.  However, with a tiny hack, we can make ActionView obey us.  This is the console, after all!  Suppose we have a helper method: <br><br> <code>def javascript_debugging_options <br> if params[:javascript_debugging] == "enabled" <br> { debug: true, digest: false } <br> else <br> {} <br> end <br> end</code> <br> <br>  Typically, ActionView requires the entire ActionDispatch :: Request from the controller to determine which parameters came from the user.  You can trick it using a small <a href="http://ruby-doc.org/stdlib-1.9.3/libdoc/ostruct/rdoc/OpenStruct.html">OpenStruct</a> : <br><br> <code>&gt;&gt; helper.controller = OpenStruct.new(params: {}) <br> =&gt; #&lt;OpenStruct params={}&gt;</code> <br> <br> <code>&gt;&gt; helper.javascript_debugging_options <br> =&gt; {} <br></code> <br> <code>&gt;&gt; helper.controller = OpenStruct.new(params: {javascript_debugging: "enabled"}) <br> =&gt; #&lt;OpenStruct params={:javascript_debugging=&gt;"enabled"}&gt;</code> <br> <br> <code>&gt;&gt; helper.javascript_debugging_options <br> =&gt; {:debug=&gt;true, :digest=&gt;false}</code> <br> <br>  <b>Where did this method come from?</b> <br><br>  Track the exact location of the desired method is not always easy.  Fortunately, Ruby can point in the right direction with Method # source_location: <br><br> <code>&gt;&gt; Project.instance_method(:trash).source_location <br> =&gt; ["/Users/qrush/37s/apps/bcx/app/models/project.rb", 90]</code> <br> <br>  Whoa!  You will get an array containing the full path to the method, along with the line number of this method in the file. <br><br>  I used it when I was looking for a code buried deep in gems.  Let's check on the app: <br><br> <code>&gt;&gt; app.method(:get).source_location <br> =&gt; ["/Users/qrush/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/bundler/gems/rails-7d95b814583b/actionpack/lib/action_dispatch/testing/integration.rb", 32]</code> <br> <br>  This method has saved me from the immense number of dives in the source.  Use! </div><p>Source: <a href="https://habr.com/ru/post/144498/">https://habr.com/ru/post/144498/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../144491/index.html">Who's there? - Identification of the person by voice</a></li>
<li><a href="../144492/index.html">Google Drive may lose its logo</a></li>
<li><a href="../144494/index.html">Facebook launches its photo sharing application. Instagram has nothing to do with it</a></li>
<li><a href="../144495/index.html">How I bought a 40W laser engraver in China + some theory of CO2 lasers</a></li>
<li><a href="../144497/index.html">No one reads the rules.</a></li>
<li><a href="../144500/index.html">NetBeans IDE 7.2 Beta Release</a></li>
<li><a href="../144501/index.html">Seagate buys a controlling stake in LaCie for $ 186 million</a></li>
<li><a href="../144503/index.html">Google adds recurring payments on Google Play</a></li>
<li><a href="../144504/index.html">Total sale of games for Android / iOS / Mac / Linux / Win</a></li>
<li><a href="../144505/index.html">Photo of Facebook office at Menlo Park</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>