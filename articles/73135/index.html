<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>When you go out, turn off the lights (and turn off the music). Computer lock and mixer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Probably, with all this was - you start to be interested in a particular topic, and when you search for the right material, you come across another in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>When you go out, turn off the lights (and turn off the music). Computer lock and mixer</h1><div class="post__text post__text-html js-mediator-article"> Probably, with all this was - you start to be interested in a particular topic, and when you search for the right material, you come across another interesting material, etc.  And you start to jump on the links from one site to another.  It happened recently with me - I was looking for examples for the WM_APPCOMMAND message, and in addition I learned that the .NET Framework has classes for working with user sessions. <br><a name="habracut"></a><br>  It all started with a simple.  I found in my archives an example with the Windows message <b>WM_APPCOMMAND</b> and decided to include it with my reference books on the Windows API functions for <a href="http://developer.alexanderklimov.ru/guide.php">C # / VB</a> and <a href="http://rusproject.narod.ru/guide.htm">Visual Basic 6.0</a> .  When processing the material for a new article, I decided to google what other examples there are on a given topic.  And I found an interesting example that caught my attention. <br><br>  On the well-known portal CodeProject found the article <a href="http://www.codeproject.com/KB/system/MuteAfterLock.aspx">CodeProject: How to mute the system volume after system lock.</a>  <a href="http://www.codeproject.com/KB/system/MuteAfterLock.aspx">Free source code and programming help</a> .  Here's what an article looks like in a free translation (further from the first person): <br><br>  I work, so I'm in one good company.  And I have a computer with large speakers.  It is easier for me to work when loud music is pouring from the speakers, so I cut the sound to full power.  And in front of me sits my colleague, who does not really like music.  And I occasionally go out for air (i.e. smoke, but it is between us).  And we have strict procedures in the company - if you leave the workplace for a while, then you must block the computer.  And it is right.  But there is one problem - when the computer is locked, the sound is not blocked and the music continues to play.  My colleague asked that at least for the time of my absence, I turned off the sound.  I'm not a beast, of course, turn off.  But manually doing it is lazy, and then I wrote a utility that automatically turns off the mixer when it is locked and turns it on again when unlocked. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The description of the utility ends here and the author of the article lists the application code.  It turns out that in the .NET Framework there is a <b>SystemEvents.SessionSwitch</b> event that allows you to track the lock and unlock of the computer.  The code is very simple. <br><br> <code>private void SystemEvents_SessionSwitch(object sender, SessionSwitchEventArgs e) <br> { <br> //If the reason for the session switch is lock or unlock <br> //send the message to mute or unmute the system volume <br> if (e.Reason == SessionSwitchReason. <b>SessionLock</b> ) <br> { <br> SendMessageW(this.Handle, WM_APPCOMMAND, this.Handle, <br> (IntPtr)APPCOMMAND_VOLUME_MUTE); <br> } <br> else if (e.Reason == SessionSwitchReason. <b>SessionUnlock</b> ) <br> { <br> SendMessageW(this.Handle, WM_APPCOMMAND, this.Handle, <br> (IntPtr)APPCOMMAND_VOLUME_MUTE); <br> } <br> }</code> <br> <br>  Honestly, I did not know about this event.  But I was surprised by the orders in the company.  In our office, those people who are accustomed to working to music, put on headphones and do not interfere with others.  I can hardly imagine a situation for someone to use the speakers.  And you? <br><br>  By the way, the idea of ‚Äã‚Äãturning off the mixer seemed to me to be wrong.  In the WM_APPCOMMAND message there is such a parameter as <b>APPCOMMAND_MEDIA_PLAY_PAUSE</b> , which allows you to pause the player.  True, it works for Windows Media Player and hardly for Winamp and similar players.  But if you listen to music in the universal player Windows, then take note. <br><br>  By the way, about the WM_APPCOMMAND message.  With the help of the constant <b>APPCOMMAND_DWM_FLIP3D,</b> you can call FLIP 3D mode from your program, which is used in Windows 7. By the way, sales of Windows 7 started today (calmly, I know that this news is pretty much borne by many of you). <br><br>  PS A brief description of the WM_APPCOMMAND message can also be read on <a href="http://rusnetframework.blogspot.com/2009/10/wmappcommand.html">my blog</a> . <br>  Good luck with programming! <br></div><p>Source: <a href="https://habr.com/ru/post/73135/">https://habr.com/ru/post/73135/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../73127/index.html">Serious talk about steering wheels</a></li>
<li><a href="../73128/index.html">Linus recommends Windows7</a></li>
<li><a href="../73129/index.html">How to protect the server from visitors from unwanted countries</a></li>
<li><a href="../73130/index.html">Free Panda Internet Security for a year</a></li>
<li><a href="../73133/index.html">Aladdin Presents New eToken Pro Anywhere Key</a></li>
<li><a href="../73137/index.html">‚ÄúCivilization‚Äù on Facebook</a></li>
<li><a href="../73138/index.html">35 fresh and useful jQuery plugins</a></li>
<li><a href="../73139/index.html">Contributed to the development of nanotechnology</a></li>
<li><a href="../73140/index.html">SUN vs IBM</a></li>
<li><a href="../73142/index.html">Questions that are NOT asked when buying SaaS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>