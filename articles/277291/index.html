<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing custom rules for the Kiuwan code analyzer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue our series of notes on the Kiuwan static code analyzer. 

 This class of tools examines the text of programs in order to identify any know...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing custom rules for the Kiuwan code analyzer</h1><div class="post__text post__text-html js-mediator-article">  We continue our series of notes on the Kiuwan static code analyzer. <br><br>  This class of tools examines the text of programs in order to identify any known patterns of vulnerabilities, errors, inaccuracies, ineffective actions and much more.  Where did these templates come from, we wrote <a href="https://habrahabr.ru/company/softmart/blog/275037/">last time</a> .  For each programming language, these templates will be their own due to clear differences in syntax, but there will be general rules for quality code, such as avoiding the use of duplicate blocks of code. <br><br>  However, these patterns and rules are not always enough to assess certain qualities of a written program.  In each case, you may need your own defining parameter.  For example, it is important for us to make sure that the written banking program does not contain hidden transactions for any of its money.  Or check that no invalid external libraries are used.  In this case, we just need to be able to force the analyzer to check not only the regular templates, but also our additional rules. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/5b4/9bc/d51/5b49bcd512234304b16f45a791de3158.png"><br><a name="habracut"></a><br><br>  In this article I would like to tell you how to create your own "custom" rules for analyzing the source code for Kiuwan. <br><br>  <b>Step 1. Kiuwan Rule Developer</b> <br>  Kiuwan proposes a tool for writing custom rules, called Kiuwan Rule Developer.  Let's skip the installation process, as it does not represent anything interesting.  And the appearance of the utility looks like this: <br><br><img src="https://habrastorage.org/files/dd9/4bb/b91/dd94bbb91e7d4e23a92eb4097dae5d83.png"><br><br>  Consider the interface in more detail.  It consists of 3 main areas: <br>  1. A window containing the source code on which the rule will be tested. <br>  2. AST (abstract syntax tree) - a tree describing parsed source code <br>  3. Execution panel - a panel in which we can create, open and edit rules, write XPath expressions and Groovy scripts, as well as watch the results of the rule execution <br><br><img src="https://habrastorage.org/files/6ea/d7e/81d/6ead7e81d03b40efaff62173b4809fd6.png"><br><br>  All rules are described using the Java programming language.  Therefore, we need to befriend our development environment (in our case it will be Eclipse) with the utility.  This process is simple - you just need to register the directories of the newly created rule project in Eclipse in the utility. <br><br>  <b>Step 2. Create a new rule</b> <br>  And now we will get down to the most interesting - the creation of the rule itself.  To do this, click the ‚ÄúNew‚Äù button on the ‚ÄúRule‚Äù tab.  A new window will open in which we need to register all the details of the rule being created.  An asterisk indicates a required field. <br><br><img src="https://habrastorage.org/files/9ef/0ba/b13/9ef0bab131a54d8b86285b168f7bc1a5.png"><br><br>  In our simplest example, the rule will look for using the System.out.print and System.out.println methods in the code.  Why?!  Because it is more correct to use a standardized library for logging, for example, log4j. <br><br>  Having filled in all the fields on the ‚ÄúDefinition‚Äù tab, we will go to the ‚ÄúCode examples‚Äù tab.  Here we show examples of the "wrong" code and the code of the corrected one.  Actually, in the future, the ‚Äúwrong‚Äù code may be useful to us for testing our rule. <br><br><img src="https://habrastorage.org/files/676/96a/91c/67696a91c93c42a38e536ecba303a6cb.png"><br><br>  After saving, 2 files will be created: <br>  ‚Ä¢ Rule Source Code Template <br>  ‚Ä¢ XML rule description file <br><br>  <b>Step 3. Compile Java code rules in Eclipse</b> <br>  Let's go to Eclipse.  Update the project files and see the added files CheckSystemOut.java and COM.MYCOMPANY.JAVA.CHECKSYSTEMOUT.rule.xml <br>  Having opened the first file, we will see the basic code template created by the utility. <br><br><img src="https://habrastorage.org/files/5f8/229/6d4/5f82296d4bba40c4bd9dacff4b0b190e.png"><br><br>  For our simple example, add some simple code.  For more information on writing rules, see the articles on the Kiuwan website. <br><br><img src="https://habrastorage.org/files/b9c/d24/6ee/b9cd246eed04428396e8d7392361bb83.png"><br><br>  We compile the rule (I have selected automatic compilation while saving in Eclipse), and everything is almost ready. <br><br>  <b>Step 4. We are testing the rule.</b> <br>  We return to the utility Kiuwan Rule Developer.  In it we can test what we have written.  To do this, we need to take a few simple steps: <br>  1. Insert the source code on which our rule will be tested (I will take it from the rule description) <br>  2. Click on the ‚ÄúGenerate AST‚Äù button.  In this case, the source code will be parsed, and the structure of the AST (Abstract Syntax Tree) code will be created. <br>  3. Click the ‚ÄúExecute‚Äù button and see the results of the rule execution. <br><br><img src="https://habrastorage.org/files/a21/f10/0ee/a21f100ee5c94a0d80ff6e6e0ee2df27.png"><br><br>  Everything, the rule is ready!  It remains to perform the installation and configuration of the rule on the system‚Äôs web portal and upload the exported jar file to the local analyzer folder.  I will not dwell on these details, since it is no longer so interesting. <br><br>  <b>Step 5. We look at the results of the analysis</b> <br>  Well, now it's worth seeing how it all works.  Launch Kiuwan Local Analyzer, set it on the code of the project we want to analyze, click on the ‚ÄúAnalyze‚Äù button, wait a while and see the results :) <br><br><img src="https://habrastorage.org/files/5bd/546/a26/5bd546a26b1f4787be50324d925df189.png"><br><br>  Going to the defects tab, we can see the result of our rule. <br><br><img src="https://habrastorage.org/files/51b/aee/049/51baee0494bd488083e8cc72bda0002e.png"><br><br>  It is worth noting that this method of expanding your quality model is universal for any programming language supported by Kiuwan (currently more than 20). </div><p>Source: <a href="https://habr.com/ru/post/277291/">https://habr.com/ru/post/277291/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277275/index.html">Finger Math: Least Squares</a></li>
<li><a href="../277279/index.html">Safety means of security: ACS</a></li>
<li><a href="../277283/index.html">Meeting report Moscow CocoaHeads January 29</a></li>
<li><a href="../277285/index.html">HPE Smart Cache: are you already speeding up?</a></li>
<li><a href="../277289/index.html">Arguments against the use of fragments in Android</a></li>
<li><a href="../277293/index.html">Excursion to the data center "Flower 2"</a></li>
<li><a href="../277295/index.html">Template Method</a></li>
<li><a href="../277297/index.html">VR and AR Digest: February</a></li>
<li><a href="../277301/index.html">Bagel, pixelart, space. ‚ÄúWow, another planet!‚Äù</a></li>
<li><a href="../277303/index.html">Questionnaire customers. Zoho Survey Description</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>