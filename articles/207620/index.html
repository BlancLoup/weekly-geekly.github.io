<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Porting contrib themes to Drupal 8: Getting Twig themes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my spare time over the past few months, I was very busy porting my Drupal theme, Gratis ( link given by me ), to Drupal 8. The process is going wel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Porting contrib themes to Drupal 8: Getting Twig themes</h1><div class="post__text post__text-html js-mediator-article">  In my spare time over the past few months, I was very busy porting my Drupal theme, <a href="https://drupal.org/project/gratis">Gratis</a> ( <i>link given by me</i> ), to Drupal 8. The process is going well, and most of the things are already working as they are in Drupal 7, but this process led to radical reworking of the theme architecture for two main reasons: <br><ol><li>  Twig is now the basis of the theme for Drupal 8, the PHP Template template handler being one of the main themes for Druapl for many years, is gone. </li><li>  As with most recent major versions of Drupal, the API for Drupal 8 has changed again and this directly affects how you do something in the context of the theme. </li></ol><br><a name="habracut"></a><br><h5>  Theme and Twig </h5><br>  What does all of this mean?  First, you can no longer use PHP code in themeization, this is all Twig.  Twig makes temization easier and easier to understand.  In Drupal 8, the old <i>template.php</i> file now becomes your theme's <i>.theme</i> file containing special PHP code that is rendered from Twig variables in a twig template.  Twig syntax is easy to understand. <br>  For example, in <i>page.tpl.php</i> Drupal 7 we have the base code that displays the block in the region: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($page[<span class="hljs-string"><span class="hljs-string">'preface_first'</span></span>])): <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> render($page[<span class="hljs-string"><span class="hljs-string">'preface_first'</span></span>]); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  With Twig and Drupal 8, in our <i>page.html.twig</i> template, we can do it like this: <br><br><pre> <code class="php hljs">{% <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> page.preface_first %} {{ page.preface_first }} {% <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span> %}</code> </pre><br>  So, as you can see, Twig is no longer ‚Äútipple fips‚Äù ( <i>.tpl.php</i> files).  The name <i>.html.twig is</i> now permanently for all theme templates.  In general, Twig greatly simplifies the way variables are handled.  So now where you used <pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">print</span></span> render($page[<span class="hljs-string"><span class="hljs-string">'some_var'</span></span>])</code> </pre>  or <pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">print</span></span> render($content[<span class="hljs-string"><span class="hljs-string">'some_var'</span></span>])</code> </pre>  now just use <pre> <code class="php hljs">{{ page.some_var }}</code> </pre>  or simply <pre> <code class="php hljs">{{ some_var }}</code> </pre>  depending on use and location. <br>  Here are the key file naming conventions that were changed in Drupal 8: <br>  <b>Drupal 7&gt; Drupal 8</b> <br><ul><li>  <i>MYTHEME.info&gt; MYTHEME.info.yml</i> </li><li>  <i>template.php&gt; MYTHEME.theme</i> </li><li>  <i>template_name.tpl.php&gt; template_name.html.twig</i> </li></ul><br>  I was surprised that <i>theme-settings.php was</i> not renamed and how it works hand-in-hand with what <i>template.php</i> used to be.  Also, not much has changed in <i>theme-settings.php</i> , it usually works from Drupal 7 without changes, although I could not find a page with a description of the API <i>function system_theme_settings</i> for Drupal 8. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Another big change in patterns is that attribute and class arrays were combined together in an attribute object.  Before rendering global classes and attributes for body, nodes and comments like: <br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">print</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">classes</span></span></span><span class="hljs-class">; ?&gt;"&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">print</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attributes</span></span></span><span class="hljs-class">; ?&gt;</span></span></code> </pre>  ... if you convert word to word for Twig, you get: <br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span></span>{{ classes }}<span class="hljs-string"><span class="hljs-string">"{{ attributes }}</span></span></code> </pre>  However, this is not a fully working version, in fact, in a new way it is announced as follows: <br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span></span>{{ attributes.class }}<span class="hljs-string"><span class="hljs-string">" {{ attributes }}</span></span></code> </pre>  For short, you can just do this: <br><pre> <code class="php hljs">{{ attributes }}</code> </pre><br>  ... without outputting specific classes, this one variable does everything.  I prefer the first method, as this allows the tag to set its own theme classes, if you want, such as <i>clearfix</i> or whatever. <br><br><h5>  <i>info</i> theme file </h5><br>  Another important change related to the theme in Drupal 8 is the design of the <i>info</i> file.  Now it is formatted in YAML style and analyzed by the symfony YAML component.  Converting the <i>info</i> file for Drupal 7 was pretty trivial.  I looked at the Bartik implementation and used it as a guide to learn enough to transform Gratis.  For example, what was before: <br><pre> <code class="php hljs">; Stylesheets stylesheets[all][] = css/style.css</code> </pre><br>  will now look like this: <br><pre> <code class="php hljs">stylesheets: all: - css/style.css</code> </pre><br>  Another problem I encountered when porting Gratis is that it seemed there were many conflicting class matches between the new Drupal 8 admin panel and Gratis.  It seems that the admin panel uses some very general classes for <i>themeization</i> , such as <i>ul.menu</i> .  In the end, I simply pointed out more specific classes in my topic to avoid conflicts. <br>  In general, I did not find full-fledged documentation on the theme in Drupal 8, I had to delve into the files of the main themes of Drupal 8 in order to understand how it all works. <br><br><h5>  API changes </h5><br>  Converting theme templates to Twig is pretty trivial, updating the user code <i>template.php</i> to <i>MYTHEME.theme is</i> not very.  The basis for the transformation of these functions is that some of them are not recommended, they still work, but in the end they will get rid of it.  Other functions simply will not work and will throw out errors, how the API has changed for them - completely or there are new functions that need to be replaced.  PhpStorm has a nice visual indicator of 8 functions obsolete in Drupal, it is really very convenient. <br><br>  For example, <i>drupal_add_js</i> and <i>drupal_add_css</i> are obsolete, so you will need to use the <i>#attached</i> method to add any custom JS for your theme.  Drupal 8 is now very thin, which means that by default it does not load a lot of Javascript for anonymous users, so now you will need to use <i>hook_library_info</i> to create dependencies to load things like jQuery.once or even drupal.js. <br><br>  PS <br>  <i>This is my free translation of the article <a href="http://highrockmedia.com/users/danny-englander">Danny Englander</a> - <a href="http://highrockmedia.com/blog/porting-contrib-theme-drupal-8-get-twiggy-with-it">Porting a Contrib Theme to Drupal 8: Get Twig-gy With It</a></i> </div><p>Source: <a href="https://habr.com/ru/post/207620/">https://habr.com/ru/post/207620/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../207606/index.html">Hello, my name is SiTLar, I am 30 years old and I am writing a self-documenting code</a></li>
<li><a href="../207608/index.html">New Year Testing Wiren Board</a></li>
<li><a href="../207612/index.html">Node.JS + taskset == a bit of weird humor</a></li>
<li><a href="../207614/index.html">Data transfer in the vehicle monitoring system - DDF technology</a></li>
<li><a href="../207616/index.html">Python-digest # 8. News, interesting projects, articles and interviews [December 20, 2013 - December 27, 2013]</a></li>
<li><a href="../207622/index.html">SIP / SIMPLE text messages in Asterisk</a></li>
<li><a href="../207624/index.html">White and black</a></li>
<li><a href="../207628/index.html">Protection against DoS / DDoS attacks using autonomous system number (ASN) filtering</a></li>
<li><a href="../207636/index.html">We start the mobile direction in the company: what to prepare for and how to live</a></li>
<li><a href="../207638/index.html">Hints: API for entering email addresses and full name in one line</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>