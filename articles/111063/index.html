<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implementing Haskell Integer Arithmetic</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For a long time it was believed that natural numbers, like numbers in general, are undetectable concepts, primary; they can be known only by intuition...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implementing Haskell Integer Arithmetic</h1><div class="post__text post__text-html js-mediator-article"> For a long time it was believed that natural numbers, like numbers in general, are undetectable concepts, primary;  they can be known only by intuition.  However, at present all numerical sets have been given a clear definition. <br><br>  The most convenient way is to determine by Peano.  However, it defines countable sets, but does not give a definite constructed set.  Another approach is to define a natural number as a special cardinal, namely the power of a finite set.  The third is the Church numerals. <br><a name="habracut"></a><br>  I suggest that you consider whether, with all the above definitions, numbers should be considered as predetermined concepts.  Let's imagine that suddenly at one moment the whole world will be turned upside down and no single computer will be able to store numerical data.  Then the programmers will be very bad.  But it is worth remembering all the above and immediately everything will fall into place.  We implement the type of a natural and an integer in Haskell, as an example of the definition "from scratch".  As a base, take the concept of a list and define nat.  the number as its length (assuming the limb of the latter). <br><br> <code>data [a] = [] | a:[a] --  , []  : ‚Äî , [] ‚Äî   <br> head x:_ = x; tail _:x = x; <br> data () = () --  ,        </code> <br> <br>  A bit of theory: <br>  final list :: = x: (x == []) ||  (tail x - final) <br>  Equality of lists is determined by <code>[]==[] = True; (a:as)==(b:bs) = (a==b) &amp;&amp; (as==bs)</code>  <code>[]==[] = True; (a:as)==(b:bs) = (a==b) &amp;&amp; (as==bs)</code> provided that the elements are comparable. <br>  Like the set-theoretic approach, we define the concept of ‚Äúequalness‚Äù of lists, namely: <br>  a ~ b :: = (a == [] &amp;&amp; b == []) ||  (tail a ~ tail b) <br>  This relation is equivalent (symmetric-transitive-reflexive), so you can build an equivalence class for each list.  Take the sequence of lists [], [()], [(), ()], [(), (), ()], ..., that is, the set [()] for the base. <br>  Between themselves, they are not equal in length, but for any finite list there is a list from the set [()] of the same length.  Therefore, we identify the equivalence class to its representative from [()]. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>type N = [](); --  [()] <br> data Natural = MkN N; -- ,   </code> <br> <br>  We describe several primitive operations for natural numbers: <br> <code>toList :: Natural -&gt; N; --    <br> toList (MkN x) = x; <br> incN :: Natural -&gt; Natural; -- ,   <br> incN = MkN.(():).toList; <br> <br> --       <br> sumN :: Natural -&gt; Natural -&gt; Natural; <br> sumN (MkN x) = MkN.(++x).toList; <br> <br> copy :: a-&gt;[a]; copy x = x: copy x; <br> concatAll :: [[a]] -&gt; [a]; <br> concatAll = foldl(++)[]; <br> table :: Natural -&gt; a -&gt; [a]; --        <br> table xy = map (\_-&gt;y) $ toList x; <br> <br> --   a*b   a   b (), <br> --        b  a (  ,  ) <br> --         concatAll <br> multN :: Natural -&gt; Natural -&gt; Natural; <br> multN xy = MkN $ concatAll $ table x (toList y); <br> decN :: Natural -&gt; Natural; <br> decN (MkN(_:xs)) = MkN xs; <br> decN (MkN []) = error "Cannot decrease 0 staying being Natural"; <br> zeroN :: Natural; <br> zeroN = MkN []; <br> oneN :: Natural; <br> oneN = MkN [()]; <br> equalN :: Natural -&gt; Natural -&gt; Bool; <br> equalN (MkN a) (MkN b) = a==b;</code> <br> <br>  There are still a few functions left: <br> <code>subN :: Natural -&gt; Natural -&gt; Natural; <br> subN xy | y==oneN = decN x -- x-1=decN(x) <br> | y/=zeroN = decN $ subN x $ decN y -- xy=(x-1)-(y-1) <br> | True = x; -- x-0=x <br> divmodN :: Natural -&gt; Natural -&gt; (Natural, Natural); <br> divmodN (MkN []) _ = error "cannot divide by zero"; <br> divmodN base x | moreThanN base x = (zeroN, x) <br> | True = let (d,m) = divmodN base (subN x base) in (incN d,m); <br> moreThanN :: Natural -&gt; Natural -&gt; Bool; <br> moreThanN (MkN []) _ = False; <br> moreThanN _ (MkN []) = True; <br> moreThanN xy = moreThanN (decN x) (decN y); <br> lengthN :: [a] -&gt; Natural; <br> lengthN = MkN . map (\_-&gt;());</code> <br> <br>  Now we generalize to the concept of an integer: <br> <code>data Integer = Positive Natural | Negative Natural;</code> <br>  Let us generalize some functions of the natural argument: <br> <code>absInt :: Integer -&gt; Natural; <br> absInt (Positive x) = x; <br> absInt (Negative x) = x; <br> equalInt :: Integer -&gt; Integer -&gt; Bool; <br> equalInt (Positive x) (Positive y) = x `equalN` y; <br> equalInt (Negative x) (Negative y) = x `equalN` y; <br> equalInt (Negative x) (Positive y) | x==zeroN &amp;&amp; y==zeroN = True; <br> equalInt (Positive x) (Negative y) | x==zeroN &amp;&amp; y==zeroN = True; <br> equalInt _ _ = False; <br> negate :: Integer -&gt; Integer; <br> negate (Positive x) = (Negative x); <br> negate (Negative x) = (Positive x); <br> sumInt :: Integer -&gt; Integer -&gt; Integer; <br> sumInt (Positive x) (Positive y) = Positive (sumN xy); <br> sumInt (Positive x) (Negative y) = if x `moreThanN` y then Positive (subN xy) else Negative (subN yx); <br> sumInt (Negative x) (Positive y) = if y `moreThanN` x then Positive (subN yx) else Negative (subN xy); <br> sumInt (Negative x) (Negative y) = Negative (sumN xy);</code> <br> <br>  I will not give further in order to save space. <br><br>  The final touch: conversion to string.  The example implements a ternary system (along the length of figures) <br> <code>figures = ['0', '1', '2']; <br> naturalseries = zeroInt : map incInt naturalseries; <br> figuretoInt = compare $ zip figures naturalseries where{compare ((a,b):c) x | a==x = b | True = compare cx;}; <br> inttoFigure = getElement figures where {getElement (h:t) n = if n==zeroInt then h else getElement t $ decInt n;}; <br> base :: Integer; <br> base = lengthInt figures; <br> showInt :: Integer -&gt; [Char]; <br> showInt x | x&lt;zeroInt = '-' : showInt (negate x) <br> | x==zeroInt = "0" <br> | x&lt;base = [inttoFigure x] <br> | True = let (d,m) = divmodInt base x <br> in (show d) ++ [inttoFigure m]; <br> readInt :: [Char] -&gt; (Integer, [Char]); <br> readInt "" = error "No integer to read on input"; <br> readInt str@(f:r) <br> | f=='-' = let (i,s) = readInt r in (negate i,s) <br> | f=='+' = readInt r <br> | True = let (num,rest) = split str in (parse $ map figuretoInt num, rest); <br> split :: [Char] -&gt; ([Char],[Char]); <br> split "" = ("",""); <br> split (x:y) | x~-&gt;figures = let (a,b)=split y in (x:a,b) <br> | True = ("", x:y); <br> parse :: [Integer] -&gt; Integer; <br> parse = foldl (\g h-&gt;sumInt h $ multInt base g) zeroInt;</code> <br> <br>  We used the function of belonging the element to the list <code>(~-&gt;) :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool; <br> a ~-&gt; [] = False; <br> a ~-&gt; (b:c) = (a==b) || (a ~-&gt; c);</code> <code>(~-&gt;) :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool; <br> a ~-&gt; [] = False; <br> a ~-&gt; (b:c) = (a==b) || (a ~-&gt; c);</code> <br> <br>  All peace saved! <br><br>  PS nothing serious.  I just wanted to show that those types that are basic almost everywhere, and in many languages ‚Äã‚Äãdo not allow redefinition, can be quietly defined as though from scratch. <br>  PPS, however, I used Bool, so it is always possible to say that this type is an analogue of a bit, then somehow group together 8, 16, 32, 64 elements, which will give analogs of the types Byte, Word, ... </div><p>Source: <a href="https://habr.com/ru/post/111063/">https://habr.com/ru/post/111063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111056/index.html">Failover iptables firewall</a></li>
<li><a href="../111057/index.html">IT in preschool and (partially) school education</a></li>
<li><a href="../111058/index.html">Features of the disks in the cloud</a></li>
<li><a href="../111059/index.html">The problem of the three layouts in Linux</a></li>
<li><a href="../111061/index.html">Why does my work environment eat so many resources and how to overcome it?</a></li>
<li><a href="../111065/index.html">Making a TV program as an extension for chrome</a></li>
<li><a href="../111068/index.html">On ‚Äúintellectual piracy‚Äù and copyright</a></li>
<li><a href="../111069/index.html">Caution: Your iPhone is also celebrating.</a></li>
<li><a href="../111070/index.html">Tips & tricks in building booklets</a></li>
<li><a href="../111071/index.html">Briefly and quickly deal with C ++ CLI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>