<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ukraine has undergone the largest virus in the history of cyber attack Petya</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This morning, my clients approached me with a panicked cry ‚ÄúNikita, everything is encrypted with us. How did this happen? ‚Äù It was a large company of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ukraine has undergone the largest virus in the history of cyber attack Petya</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/d2b/d51/938/d2bd51938cdb269a8cf5fd2599b78c65.jpg" alt="image"><br><br>  This morning, my clients approached me with a panicked cry ‚ÄúNikita, everything is encrypted with us.  How did this happen? ‚Äù  It was a large company of 1000+ machines, with the latest updates of the licensed Windows, a customized firewall, chopped rights for users and anti-phishing filters for mailers. <br><br>  An hour later, representatives of another large company called, everything was also encrypted, under 2000 machines.  The attack began with large business structures and an hour or two later I learned that Oschadbank, UkrPoshta, TASKOMERZBANK, and OTP Bank were under attack (the full list is in <b>UPD5</b> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What happened?  And about the development of the situation under the cut. <br><a name="habracut"></a><br>  What all cyber experts, including myself, have been saying day and night!  Ukraine is not protected from cyber attacks, but now is not about that. <br><br>  The Ukrainian cyber segment has been attacked again, this time by Ransomware encryptors Petya and Misha encrypting the computer of large Ukrainian enterprises, including critical infrastructure, such as Kyivvenergo and Ukrenergo, I think, in fact, there are thousands of times more, but officials as usual, they will be silent about it until the light goes out. <br><br>  At the moment, the rate of spread of the virus was so fast that the state fiscal service turned off all communications with the Internet, and in some important public institutions only closed government communications work.  According to my personal information, the relevant divisions of the SBU and Cyberpolice have already been transferred to emergency mode and are dealing with this problem.  I do not deny that <u>some sites and services can be disabled as a preventive measure against infection</u> .  The situation is developing dynamically and we will cover it.  Not only large companies are encrypted, but also ATMs along with entire branches of banks, television companies, and so on ... <br><br>  <b>Now about the technical details</b> <br><br>  The first versions of Petya <a href="http://www.pcworld.com/article/3180778/security/hackers-use-dangerous-petya-ransomware-in-targeted-attacks.html">were discovered</a> significantly earlier.  However, today the new modification of Petya is rampant in the network.  So far, it is known that ‚ÄúNew Petya‚Äù encrypts the MBR boot sector of the disk and replaces it with its own, which is a ‚Äúnovelty‚Äù in the world of Ransomware, he is a friend of #Misha (name from the Internet) who arrives a little later, already encrypts all files on the disk ( not always).  Petya and Misha are not new, but there has not been such a global distribution before.  Suffered and fairly well protected companies.  Everything is encrypted, including the boot sectors (original) and you just have to read the text of the extortionist, after turning on the computer.  This virus is spread using the latest, presumably, 0day vulnerabilities. <br><br>  On the Internet, there have already been attempts to <a href="https://github.com/leo-stone/hack-petya">write</a> codebreakers that only fit old versions of Petya. <br><br>  However, their performance has not been confirmed. <br><br>  The problem also lies in the fact that for rewriting MBR, Petya needs to restart the computer, which users panic successfully and do, ‚Äúpanic pressing the button off‚Äù I would call it that. <br><br>  Of the current recommendations as of 17 o'clock on June 27, I would advise NOT to turn off the computer if the encrypter was found, but to switch it to ACPI S3 Sleep (suspend to RAM) sleep mode (thanks to <a href="https://habrahabr.ru/users/4eyes/" class="user_link">4eyes</a> for the clarification), disconnecting from the Internet when any circumstances. <br><br>  <b>Personal assumptions:</b> <br><br>  The virus was named ‚ÄúPetya‚Äù in honor of the President of Ukraine, Petro Poroshenko, and the most massive surge of infection is observed, namely in Ukraine and precisely in large and important enterprises of Ukraine. <br><br>  <b>Instruments:</b> <b><br></b> <br>  On the site we will create a section Petya and Misha Decrypt, where we will lay out all the found tools for decryption, which we do not have time to check on our own.  We ask other experts and specialists in the field of information security to send information to private messages for effective communication.  <b>See also UPD ‚Ññ6 and UPD ‚Ññ7</b> <b><br></b> <br><br>  <b>UPD1: Decoder</b> yet, those that are posted on the Internet ( <a href="https://geektimes.ru/post/274104/">here</a> ), are suitable only for older versions.  <u>Attention descrambler at the moment does not exist!</u> <br><br>  <b>UPD2:</b> The website of the Ministry of Internal Affairs of Ukraine is disabled.  Siloviki go into emergency mode. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/65b/2ef/b14/65b2efb14106ca601fd08b62eae038a7.jpg" alt="image"><br>  <b>UPD3:</b> <i>I ask you not to count for advertising</i> , who suffered from the attack, send samples of encrypted files or the cryptographer himself to info@protectmaster.org for the development of the decoder.  We, in turn, are ready to provide information to any IB companies on this case. <br><br>  <b>UPD4:</b> Large supermarkets in Kharkiv were also subjected to encryption, the photo of the ‚ÄúGROWTH‚Äù supermarket is a queue at the checkout due to a cryptor.  (Photo from social networks): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c1c/76b/042/c1c76b04253bd31a09d6a1b23c8fe06e.jpg" alt="image"><br><br>  <b>UPD5:</b> List of sites and structures subjected to cyber attack: <br>  <b>State structures:</b> Cabinet of Ministers of Ukraine, Ministry of Internal Affairs, Ministry of Culture, Ministry of Finance, National Police (and regional sites), Cyber ‚Äã‚ÄãPolice, KSCA, Lviv City Council, Ministry of Energy, National Bank <br>  <b>Banks:</b> Oschadbank, Sberbank, TASKOMERZBANK, Ukrgasbank, Pivdenny, OTR Bank, Kredobank. <br>  <b>Transport:</b> Boryspil Airport, Kiev Metro, Ukrzaliznytsya <br>  <b>Media:</b> Radio Era-FM, Football.ua, STB, Inter, First National, Channel 24, Radio Lux, Radio Maximum, KP in Ukraine, ATP Channel, Korrespondent.net <br>  <b>Large companies:</b> Novaya Pochta, Kyivenergo, Naftogaz Ukrainy, DTEK, Dniproenergo, Kievvodokanal, Novus, Epicentra, Arcellor Mittal, Ukrtelecom, Ukrposhta <br>  <b>Mobile operators:</b> Lifecell, Kyivstar, Vodafone Ukraine, <br>  <b>Medicine:</b> Farmak, Boris Clinic, Feofania Hospital, Arterium Corporation, <br>  <b>Gas stations:</b> Shell, WOG, Klo, TNK <br><br>  <b>UPD 6:</b> <br><br>  To identify the file encryptor, you must complete all local tasks and check for the following file: <br><br>  C: \ Windows \ perfc.dat <br><br>  Depending on the version of the Windows OS, <a href="https://technet.microsoft.com/ru-ru/library/security/ms17-010.aspx">install the patch from the Microsoft resource</a> <i>(attention, this does not guarantee 100% security since the virus has many infection vectors)</i> , namely: <br><br>  - for <a href="">Windows XP</a> <br>  - for <a href="">Windows Vista 32 bit</a> <br>  - for <a href="">Windows Vista 64 bit</a> <br>  - for <a href="">Windows 7 32 bit</a> <br>  - for <a href="">Windows 7 64 bit</a> <br>  - for <a href="">Windows 8 32 bit</a> <br>  - for <a href="">Windows 8 64 bit</a> <br>  - for <a href="">Windows 10 32 bit</a> <br>  - for <a href="">Windows 10 64 bit</a> <br><br>  Find links to download the corresponding patches for other (less common and server versions) Windows OS can <a href="https://technet.microsoft.com/ru-ru/library/security/ms17-010.aspx">be here on the Microsoft website</a> . <br><br>  <b>UPD7:</b> It looks like the new subspecies Petya.A, which today attacked Ukraine, is a combination of vulnerabilities CVE-2017-0199 and MS17-010 (ETERNALBLUE, used in Wcry for leakage results through ShadowBrokers) <br><br>  You can download the <a href="https://technet.microsoft.com/en-us/library/security/ms17-010.aspx">latest patch from MicroSoft</a> and <a href="http://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199">one more</a> . <br><br>  <b>UPD8:</b> A <a href="https://twitter.com/petya_payments%3Fs%3D09">bot</a> has already <a href="https://twitter.com/petya_payments%3Fs%3D09">appeared on the</a> network that monitors bribes for decrypting files infected with Petya <br><br>  <b>UPD9:</b> According to information from Facebook Cyberpolice of Ukraine and a number of large information security companies, as well as MicroSoft, one of the vectors of attack on the business structure of Ukraine was the spread of the virus through the MEdoc program (electronic reporting and document management software) <br><br>  Most likely, the MEdoc developers were also hacked and this update was downloaded by hackers. <br><br>  <b>UPD10:</b> Positive Technologies specialists found a local ‚Äúkill switch‚Äù for Petya, you can stop the cryptographer by creating the file ‚ÄúC: \ Windows \ perfc (perfc - file without extension) <br><br>  There is also good news: if you saw the computer restart and the start of the ‚Äúdisk check‚Äù process, at that moment you should immediately turn off the computer and the files will remain unencrypted.  Booting from a LiveCD or USB disk will give access to files. <br><br>  <b>UPD11:</b> MicroSoft finally put all the details and analysis of the Petya virus <a href="https://blogs.technet.microsoft.com/mmpc/2017/06/27/new-ransomware-old-techniques-petya-adds-worm-capabilities/">on its website</a> with recommendations and patches. </div><p>Source: <a href="https://habr.com/ru/post/331762/">https://habr.com/ru/post/331762/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331750/index.html">Speed ‚Äã‚Äãreading: does it work or not? Part 3: simple tips</a></li>
<li><a href="../331752/index.html">Testing or parsing sites with a dynamic home and more. Nightmare.js - he doesn't care</a></li>
<li><a href="../331754/index.html">How we stalled and calibrated the coffee machine on the spectrophotometer</a></li>
<li><a href="../331758/index.html">Mark, Jack and Alisher! The world needs a new facebook - educational</a></li>
<li><a href="../331760/index.html">ArrayBuffer and SharedArrayBuffer in JavaScript, Part 2: Introduction to New Language Objects</a></li>
<li><a href="../331766/index.html">Building application management systems in a distributed cluster infrastructure based on MESOS technology</a></li>
<li><a href="../331768/index.html">MIPT launches Russia's first online magistracy in technology entrepreneurship</a></li>
<li><a href="../331770/index.html">JQuery plugin - jdDialog. The principle of "transit calls"</a></li>
<li><a href="../331772/index.html">Cash registers go online: Russia's tax has opened a new market for application developers</a></li>
<li><a href="../331774/index.html">What is RQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>