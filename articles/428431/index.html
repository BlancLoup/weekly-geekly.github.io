<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>More than concentric layers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is part of the Software Architecture Chronicle , a series of articles on software architecture. In them I write about what I learned abou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>More than concentric layers</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/lm/yh/jm/lmyhjmjqhejzhfwqvxvozhtjt3g.jpeg"><br><br>  <i>This article is part of the <a href="https://herbertograca.com/2017/07/03/the-software-architecture-chronicles/">Software Architecture Chronicle</a> , a series of articles on software architecture.</i>  <i>In them I write about what I learned about software architecture, what I think about it and how I use knowledge.</i>  <i>The content of this article may make more sense if you read the previous articles in the series.</i> <br><br>  In the <a href="https://habr.com/post/427739/">previous article in the</a> series, I published a concept map that shows the relationship between code types. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But it always seemed to me that not everything is very well reflected there, I just did not know how to do it better.  Speech about the common core. <br><br>  In addition, there are a few more thoughts that I will present in this short article. <br><a name="habracut"></a><br>  In the infographic of the last article in this series, in the very center of the diagram, we see a common core.  It appears that it is inside the domain layer and above the conical partitions, which are limited contexts. <br><br> <a href=""><img src="https://habrastorage.org/webt/mm/07/bx/mm07bx1u2dxlgab0prkzllunvf8.png"></a> <br><br>  Despite its location, I did not mean that the common core depended on the rest of the code, or that the common core was another layer inside the domain level. <br><br><h1>  What is a common core ?! </h1><br>  The common core, as defined by Eric Evans, the <i>father of</i> DDD, is code that the development team decides to share between several limited contexts: <br><br><blockquote>  [...] a subset of the domain model that the two teams agreed to use together.  Of course, along with this subset of the model, the common core includes a subset of the code or architecture of the database associated with this part of the model.  This clearly shared material has a special status and should not be changed without consulting with another team. <br><br>  - <a href="http://ddd.fed.wiki.org/view/shared-kernel">‚ÄúCommon Core‚Äù</a> , DDD wiki by Ward Cunningham </blockquote><br>  Thus, it can be any type of code: domain level code, application level code, libraries ... whatever. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/edc/a8f/2f5/edca8f2f5a6b1ff83123709b2b412e81.jpg"><br><br>  However, in the context of our concept map, I represent it as a subset, as a specific type of code.  In my concept map, the common core contains the code for the domain and application level, which is shared in limited contexts, so that communication between limited contexts is possible. <br><br>  For example, this means that events are triggered in one or more restricted contexts and listened in other restricted contexts.  Together with these events, we need to share all the data types that are used by these events, for example: entity identifiers, value objects, enumerations, etc. Complex objects, such as entities, should not be used directly by events, since they can be difficult serialize / deserialize to / from the queue, so the common code should not spread much. <br><br>  Of course, if we have a multilingual system of microservices, then the common core must be descriptive, in JSON, XML, YAML, etc., so that all microservices can understand it. <br><br>  As a result, this common core is completely separated from the rest of the code base, from the components.  This is great, because then the components, although connected with the common core, are separated from each other.  Generic code is clearly identified and easily retrieved into a separate library. <br><br>  It is also very convenient if we decide to retrieve one of the limited contexts in microservice separated from the monolith.  We know exactly what is common and we can simply extract the common core to the library, which will be installed both in the monolith and in microservice. <br><br>  So, to summarize, in my concept map, the core of an application depends on a common core, which contains code from domain levels and an application that is shared between limited contexts. <br><br><h1>  When language is not enough ... </h1><br>  So, we have application code with all concentric layers, and the application core depends on the common core, which is under all this code. <br><br>  We can also say that all this code depends on the programming language (s) used, but it is such an obvious fact that we tend to completely ignore it. <br><br>  However, the question arises: ‚ÄúWhat if the language constructs are not enough ?!‚Äù Well, obviously, we ourselves create these language constructs and thus compensate for the shortcomings of the language.  But I have important follow-up questions: ‚ÄúHow and where to substantiate the existence of this code?  How can you clearly indicate when and how to use it? ‚Äù. <br><br>  What I saw and did by myself is a package called Utils or Commons, where this code is located.  But in the end, we end up dropping all the code there that we don‚Äôt know where to put it!  All kinds of code for different purposes and usability (wrapped in an adapter that is used directly ...) are eventually dropped there.  The package has no conceptual meaning, no coherence, no coherence, no clarity, many ambiguities. <br><br>  I want to drop Utils and Commons! <br><br>  All packages must have conceptual cohesion!  It should be clear when and how to use the package!  No ambiguity! <br><br>  For example, if an application interacts with the command line interface in some special way, then instead of placing it in the Acme / Util / SpecialCli namespace, you can put it in Acme / App / Infrastructure / Cli / SpecialCli.  This says that this package is associated with the CLI, it is part of the Acme application infrastructure.  The App infrastructure membership also says that in the application core there is a port to which this packet corresponds. <br><br>  Alternatively, if we see this package as something that the language itself lacks, we can put it in the appropriate namespace, for example, 'Acme / PhpExtension / SpecialCli'.  This shows that this package should be considered as part of the language itself, and therefore its code should be used directly in the code base as any language construct.  Of course, if another company depends on this package, it may be reasonable for them not to depend directly on it, but it is safer to create a port / adapter so that they can change it for something else.  But if we own the package, we can consider it as part of the language, since the risk of having to replace it with another alternative is not so great.  It is always a matter of compromise. <br><br>  Another example of what can be considered as part of a language is unique UUIDs in PHP.  They can be imagined outside the language, because every time there is a new version and this is a nightmare with code support, but this is a completely general concept, a broad and consistent enough concept to be part of the language. <br><br>  So why not create a UUID implementation and not use it, as if part of PHP itself, how do we use a DateTime object ?!  While we are monitoring the implementation, I do not see any flaws. <br><br>  What about Doctrine Query Language (DQL)?  (Doctrine is a Hibernate port in PHP) Can we treat DQL as if it were SQL, Elasticsearch QL or Mongo QL? <br><br><h1>  Conclusion </h1><br>  So, at the macro level, I see four basic types of code and I think it is important to explicitly manifest them in the organization of the code base, in order not to end up with a lot of dirt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4c4/861/97e/4c486197ead0a3876b911e49627b8776.png"><br><br>  For me, the indisputable truth is that <b>architecture always exists, the only question is, do we control it or not ?!</b> <br><br>  So let's <b>clearly organize the code in accordance with the architecture</b> , fully or partially on the concept map - mine or another.  Most importantly, it is logical to organize the code so that the project explicitly communicates its architecture through the structure and organization of the code. </div><p>Source: <a href="https://habr.com/ru/post/428431/">https://habr.com/ru/post/428431/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../428417/index.html">MatLab / Octave machine learning: examples of algorithms supported by formulas</a></li>
<li><a href="../428419/index.html">Drag and Swipe in RecyclerView. Part 2: Drag and Drop Controllers, Grid, and Custom Animations</a></li>
<li><a href="../428421/index.html">A flexible system for testing and collecting metrics of programs on the example of LLVM test-suite</a></li>
<li><a href="../428423/index.html">How the IBM and Red Hat deal at $ 34 billion will change the IT market: expert and analyst opinions</a></li>
<li><a href="../428429/index.html">Electronic signature GOST R 34.10 PDF documents in the LibreOffice office suite</a></li>
<li><a href="../428433/index.html">Lawyers about testing when hiring in the private sector</a></li>
<li><a href="../428435/index.html">What to read in PHP in Russian?</a></li>
<li><a href="../428437/index.html">Apple Wallet. What is it and how to integrate your card into it</a></li>
<li><a href="../428439/index.html">Without ensemble</a></li>
<li><a href="../428441/index.html">GitHub purchase completed. What will happen next?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>