<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Origami and augmented reality (continued)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Everything written below has a little background . Here we decided to focus on technical details. So, our inquisitive mind has the following task: 


...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Origami and augmented reality (continued)</h1><div class="post__text post__text-html js-mediator-article">  Everything written below has a <a href="http://habrahabr.ru/blogs/ui/117051/">little background</a> .  Here we decided to focus on technical details.  So, our inquisitive mind has the following task: <br><ul><li>  there is a piece of paper that needs to be folded in a certain way; </li><li>  for tips, folding, it is desirable to use the technology of augmented reality and impose information about tips on top of the resulting images. </li></ul>  It was decided to place special barcodes and a drawing module to return information about their content and position on the image as markers on the sheet, while the module itself stores information about when and how to use this information. <br><a name="habracut"></a><br>  One of the unnamed, but supposed, conditions was the use of ‚Äúone‚Äôs own‚Äù recognition module and one‚Äôs ‚Äúown‚Äù bar codes (no, it‚Äôs not necessary to reinvent the wheel, it was possible to assemble it from the parts already available - the main thing is for it to go).  The developed barcodes are based on encryption with the <a href="http://ru.wikipedia.org/wiki/%25D0%25D1_%25EA%25EE%25E4">Reed-Solomon</a> algorithm and, perhaps, they should devote a separate article. <br><br>  Now we will lead the story about the module of recognition of these mysterious signs. <br><br>  The very first step is getting the input data.  We can receive them from several sources: static image, video or video from a webcam.  In any case, the work of augmented reality is reduced to processing a still image (in the case of video, this will be a frame; it also adds the ability to take into account data collected from previous frames, the introduction of ‚Äúinertia‚Äù data in the case of an unstable picture, etc.).  Without loss of generality, consider working with static pictures (in other words, photos): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/7b8/e6d/c24/7b8e6dc24d9bededa8f1df0f9bc3be92.jpg"><img src="https://habrastorage.org/getpro/habr/post_images/c93/f59/00b/c93f5900b18af3feb737e4c30caa816d.jpg"><br><br>  The photos differ in brightness (this will be important at one of the stages), but they are united by one - a sheet, with barcodes located on it.  Barcodes were developed specifically and have a number of features that are also taken into account in the recognition algorithm (we will talk about them later). <br><br>  First of all, you need to "discolor" the image.  Color for us does not carry any information, so remove this extra information: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a1c/b41/a3a/a1cb41a3adc6429e2167c3290c2c7f2f.png"><img src="https://habrastorage.org/getpro/habr/post_images/d7f/354/254/d7f35425487e50cfb09c2623c505554f.png"><br><br>  On the resulting images we find the boundaries of objects.  To do this, for each pixel, choose the maximum difference from the pairwise surrounding values: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5b9/9db/836/5b99db83648d550a4444064560b64631.png" alt="maximum difference of pairwise surrounding values"><br><br>  As a result, the value will be close to zero in ‚Äúmonotonous‚Äù areas (if there is noise in the image, the value will slightly differ from zero), but as soon as a pixel contrasts with the rest, the value will drastically increase.  The images obtained after this operation clearly show what information becomes insignificant for us (do not forget that we have black-and-white barcodes printed on white paper, which means they will always have high contrast): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7f/512/3b2/c7f5123b2017de45b45b3a61d91ab6c4.png"><img src="https://habrastorage.org/getpro/habr/post_images/47c/495/261/47c4952613b27cde38b70e1d6832cf69.png"><br><br>  On the resulting images, it would seem, you can already search for the boundaries of objects.  But do not forget that the borders here are not one color, but contain several shades of gray.  Therefore, we first conduct threshold binarization.  Remember, the brightness of the images was somehow important to us?  So, it is important at this stage.  If we set a strictly binarization threshold, the filter will work incorrectly (not in the way we would like) in very light and very dark photos.  Therefore, we will use the Otsu algorithm (Otsu Tresholding), which determines the binarization threshold depending on the image itself.  Therefore now important borders for us will not be erased: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a4/aa9/077/7a4aa9077df5d04e2fd24f3913c56980.png"><img src="https://habrastorage.org/getpro/habr/post_images/700/cc0/fa9/700cc0fa9ec14790719dcc03b43bcd7f.png"><br><br>  Now the image contains only black and white pixels, so you can start searching for objects. <br><br>  Border selection algorithms are very many.  We will use one of the most simple - ‚Äúsequential scanning algorithm‚Äù.  Line by line we will look at the image, skipping the background pixels, but combining the ‚Äúsignificant‚Äù pixels that go in a row (for each pixel, at the time of analysis, the left, left-top, top and right-top pixels are important).  After reindexing, combining borders and other necessary manipulations, about which you can read more in the relevant articles, we will finally get a list of related areas.  Only a little remains - choose the ones that are barcodes. <br><br>  To do this, we will carry out several checks (we will work again with the image in shades of gray): <br><ol><li>  We discard those of the found objects that are smaller than the size we specified: since we have barcodes containing 8 √ó 8 cells with information, then we take the minimum image size with them, for example, 16 by 16 pixels. </li><li>  Let us analyze the boundaries of each of the objects.  Replacing them with a set of segments, we leave only those whose borders consist of 4 segments (square barcodes, however, due to the fact that the sheet is not perpendicular to the camera, they can be distorted, but 4 sides will remain the same) </li><li>  One of the features of our barcodes is a continuous black border, therefore we leave only those objects whose inner border is darker than the outer one. </li><li>  Restore the square shape of the remaining objects.  To do this, we build the matrix for displaying the original (distorted) image on a square image, and conflicts (lack or excess of pixels) are resolved by interpolating the data.  For the images from the example, we obtain the following barcode images: <br><img src="https://habrastorage.org/getpro/habr/post_images/129/647/6e9/1296476e933b06b2f9f8f7ddebf73f32.png"><img src="https://habrastorage.org/getpro/habr/post_images/7bd/e8c/901/7bde8c901d0967356f345822139273de.png"><br></li><li>  Otsu filter is again applied to the received images: <br><img src="https://habrastorage.org/getpro/habr/post_images/869/40e/95f/86940e95f75fe73e6c696fecbebd7f70.png"><img src="https://habrastorage.org/getpro/habr/post_images/975/5b0/eb4/9755b0eb40755c43bf7e4e0393872725.png"><br></li><li><img src="https://habrastorage.org/getpro/habr/post_images/bb2/2ba/a13/bb22baa1308d46658d4c9249e28b695b.jpg" align="right">  We binarize the obtained images and transform them into a numerical matrix.  Barcodes consist of 64 cells (8 √ó 8), so we divide the images into 64 square areas.  For each cell, we calculate its ‚Äúexact‚Äù value: it is black or white (if ‚Äúaccuracy‚Äù is not enough, for example, 40% of pixels of the same color and 60% of the other, then the image is considered unsuitable for further analysis).  According to the results we build an 8 √ó 8 matrix, filled with 1 and 0. <br></li><li>  We analyze the resulting matrices: we look for angular markers, rotate the matrix in accordance with our concepts of top and bottom (the barcode images above are already rotated in the specified manner), extract useful information from it, decode it (the information is encoded using Reed-Solomon algorithm).  At this stage, as it was already possible to guess, the areas that passed all past checks are also eliminated, they are not barcodes.  But the information obtained can already be used. </li></ol><br>  ______________________ <br><h6>  The text was prepared in the <a href="http://www.softcoder.ru/habraeditor/">Habr Editor</a> from ¬© SoftCoder.ru </h6></div><p>Source: <a href="https://habr.com/ru/post/117070/">https://habr.com/ru/post/117070/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../117058/index.html">Positive Hack Days 2011: Intro</a></li>
<li><a href="../117063/index.html">Calculate editorial distance</a></li>
<li><a href="../117064/index.html">Connection of additional services from your provider</a></li>
<li><a href="../117065/index.html">The results of the research staff in the market for web development</a></li>
<li><a href="../117069/index.html">JavaScript modular approach</a></li>
<li><a href="../117071/index.html">IT-portfolio: we are in open beta!</a></li>
<li><a href="../117074/index.html">Custom Document Sizes</a></li>
<li><a href="../117076/index.html">BizSpark Camp for startups on Windows Phone 7 with secret themes</a></li>
<li><a href="../117079/index.html">The results of the auction for the sale of domains in the zone. RF revise</a></li>
<li><a href="../117081/index.html">Fixber: software test results in 30 minutes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>