<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pitfalls Service Workers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this short essay, I will describe those things about service workers that I would like to read a year or at least six months ago and thus avoid a v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pitfalls Service Workers</h1><div class="post__text post__text-html js-mediator-article">  In this short essay, I will describe those things about service workers that I would like to read a year or at least six months ago and thus avoid a very long and painful period of debugging the application. <br><br>  If you got here at the request of the type ‚Äúwhat the hell is my service worker not working on production?‚Äù, Welcome under cat. <br><a name="habracut"></a><br>  For those who are not at all aware of what they are talking about, then very briefly - the service worker is a script that is executed by the browser in the background, separate from the web page and able to perform functions for which interaction with the page or the user is not required. <br><br>  Full documentation is not difficult to find, but here is the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API">link</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I also found this <a href="https://developers.google.com/web/fundamentals/primers/service-workers/">material</a> very useful, and I am very sorry that I inadvertently familiarized myself with it when I first began to get acquainted with the ServiceWorker API. <br><br>  In practice, the Service Worker API allows you to do such a magical thing as caching online files of a web application to a user's local device and then work completely offline if needed. <br><br>  In the future, it is planned to add such cool things as cache synchronization in the background, that is, even if the user is not currently on your site, the service worker will still be able to start and download updates, for example.  And also access to PushApi from the background again (that is, when you receive the update, send you a push notification). <br><br>  How it works. <br><br><ul><li>  The webpage registers the service worker </li><li>  The service worker is installed, activated, and starts doing something in the background.  For example, ‚Äúlisten‚Äù to the 'fetch' events and, if necessary, modify or cancel them altogether </li></ul><br>  Using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Channel_Messaging_API">Channel Messaging API, a</a> web page can send service worker messages and receive responses from it (and vice versa). <br>  The Service Worker may NOT have access to the DOM and webpage data, except through messages. <br><br>  What I didn‚Äôt know until recently was the fact that even if a user is now on your site, this does not guarantee that the service worker will work all the time.  And in no case can not rely on the global scope of the worker. <br><br>  That is, such a scheme of work led me to very deplorable consequences and a long process of debugging the application ( <b>attention, bad code, DO NOT use in any case</b> ): <br><br>  registration / installation service worker <br>  Index.html <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> regSW = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"./register-worker.js"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sharedData = {<span class="hljs-attr"><span class="hljs-attr">filesDir</span></span>: localDir}; regSW.registerServiceWorker(sharedData);</code> </pre> <br>  register-worker.js <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> registerServiceWorker = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sharedData</span></span></span><span class="hljs-function">)</span></span>{ navigator.serviceWorker.register(<span class="hljs-string"><span class="hljs-string">'service-worker.js'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">scope</span></span>: <span class="hljs-string"><span class="hljs-string">'./'</span></span> }) .then(navigator.serviceWorker.ready) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'service worker registered'</span></span>); sendMessageToServiceWorker(sharedData).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'service worker respond with message:'</span></span>, data); }) .catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(<span class="hljs-string"><span class="hljs-string">'send message fails with error:'</span></span>, error); }); }) .catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(<span class="hljs-string"><span class="hljs-string">'error when registering service worker'</span></span>, error, <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>) }); }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sendMessageToServiceWorker = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> messageChannel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MessageChannel(); messageChannel.port1.onmessage = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (event.data.error) { reject(event.data.error); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { resolve(event.data); } }; navigator.serviceWorker.controller.postMessage(data, [messageChannel.port2]); }); };</code> </pre><br>  Worker code with fetch tapping and response spoofing <br>  service-worker.js <br><br><pre> <code class="javascript hljs">self.addEventListener(<span class="hljs-string"><span class="hljs-string">'message'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ self.filesDir = event.data.filesDir; event.ports[<span class="hljs-number"><span class="hljs-number">0</span></span>].postMessage({<span class="hljs-string"><span class="hljs-string">'received'</span></span>: event.data}); }); self.addEventListener(<span class="hljs-string"><span class="hljs-string">'fetch'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetcher</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> url = event.request.url; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (url.indexOf(<span class="hljs-string"><span class="hljs-string">"s3"</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//redirect to local stored file url = "file://" + self.filesDir + self.getPath(url); let responseInit = { status: 302, statusText: 'Found', headers: { Location: url } }; let redirectResponse = new Response('', responseInit); event.respondWith(redirectResponse); } });</span></span></code> </pre><br>  What happened here: <br><br><ul><li>  We registered the worker and sent him a message on which local path to look for previously cached files. </li><li>  In the service worker, we received a message and saved the path in the worker's global scope to the self.filesDir variable. </li><li>  A worker listens to the fetch event and everything that contains in the path ‚Äús3‚Äù responds with a redirect to the local file. </li></ul><br>  I will make a reservation that the code is very simplified (of course, I don‚Äôt replace everything that contains s3 on the way, I‚Äôm not so lazy), but it shows the main thing. <br><br>  And everything would be fine if it were not for the fact that after a random amount of time (3-10 minutes) of the application had expired, the service worker began to redirect requests ‚Äúto nowhere‚Äù, or rather to something like ‚Äúfile: // <b>undefined</b> / images /image1.png ¬ª <br>  That is, after some time, the self.filesDir variable is simply deleted and we get a ton of 404 file not found instead of pictures. <br><br>  Naturally, no self-respecting programmer will not test the application as much as 5 minutes.  Therefore, a bug is detected at best by a tester.  And usually even a client.  Because you know, these testers ... In general, nobody paid for the testing, say thank you for not crashing at the start. <br><br>  In general, in order not to delay for a long time, the problem is that if the service worker is not used [for a while], then the browser nails it (sorry, I didn‚Äôt think of a more appropriate translation for the word terminate) and then starts again at the next call.  Accordingly, the new copy of the worker does not know what his dead predecessor was talking about there with the web page and he does not have any information about where to get the files. <br><br>  Therefore, if you need to save something, do it in permanent storage, namely in IndexedDB. <br><br>  Another note - they say the worker cannot use synchronous APIs, so the localStorage API cannot be used.  But I personally did not try. <br><br>  By the way, debugging in my case was delayed also because even when I tested for a long, long time (minutes 7) hoping to reproduce the bug, I did not succeed, because with the Developer Tools window open, the treacherous chrome does not kill the worker.  Although it reports this with a concise message in the logs ‚ÄúService Worker Termination by a timeout was canceled because DevTools is attached‚Äù <br><br>  Actually here it came to me why my repeated attempts to find out why ServiceWorker works for me differently than the production client failed ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0e6/93d/f51/0e693df511c9f5c1c8342109f4400afe.jpg" alt="image"><br><br>  In general, after I removed the installation of the path in the variable and transferred it to indexedDB, my troubles were over and I started to like the ServiceWorker API again. <br><br>  And here is the actual working example of code that can be taken and used, unlike the previous one: <br><br>  registration / installation service worker <br>  index.html <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> regSW = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"./register-worker.js"</span></span>); idxDB.setObject(<span class="hljs-string"><span class="hljs-string">'filesDir'</span></span>, filesDir); regSW.registerServiceWorker();</code> </pre><br>  register-worker.js <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> registerServiceWorker = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ navigator.serviceWorker.register(<span class="hljs-string"><span class="hljs-string">'service-worker.js'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">scope</span></span>: <span class="hljs-string"><span class="hljs-string">'./'</span></span> }) .then(navigator.serviceWorker.ready) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'service worker registered'</span></span>); }) .catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(<span class="hljs-string"><span class="hljs-string">'error when registering service worker'</span></span>, error, <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>) }); };</code> </pre><br>  Worker code with fetch tapping and response spoofing <br>  service-worker.js <br><br><pre> <code class="javascript hljs">self.getLocalDir = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> DB_NAME = <span class="hljs-string"><span class="hljs-string">'localCache'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> DB_VERSION = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> STORE = <span class="hljs-string"><span class="hljs-string">'cache'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> KEY_NAME = <span class="hljs-string"><span class="hljs-string">'filesDir'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> open = indexedDB.open(DB_NAME, DB_VERSION); open.onerror = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ reject(<span class="hljs-string"><span class="hljs-string">'error while opening indexdb cache'</span></span>); }; open.onsuccess = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> db = event.target.result, result; result = db.transaction([STORE]) .objectStore(STORE) .get(KEY_NAME); result.onsuccess = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!event.target.result) { reject(<span class="hljs-string"><span class="hljs-string">'filesDir not set'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { resolve(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(event.target.result.value)); } }; result.onerror = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ reject(<span class="hljs-string"><span class="hljs-string">'error while getting playthroughDir'</span></span>); }; } }); }; self.addEventListener(<span class="hljs-string"><span class="hljs-string">'fetch'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetcher</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> url = event.request.url; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (url.indexOf(<span class="hljs-string"><span class="hljs-string">"s3"</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//redirect to local stored file event.respondWith(getLocalDir().then(function(filesDir){ url = "file://" + filesDir + self.getPath(url); var responseInit = { status: 302, statusText: 'Found', headers: { Location: url } }; return new Response('', responseInit); })); });</span></span></code> </pre><br>  PS The author does not claim originality, but believes that if this article is found, read and will help at least one unfortunate - it's worth it. </div><p>Source: <a href="https://habr.com/ru/post/351194/">https://habr.com/ru/post/351194/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351182/index.html">Hosting PCI DSS: what you need to know</a></li>
<li><a href="../351184/index.html">How to adapt the game on Unity for iPhone X to April</a></li>
<li><a href="../351188/index.html">What is the program between the lines</a></li>
<li><a href="../351190/index.html">CSS ScaleFlux, or how to speed up databases by two or three times by simply replacing NVMe</a></li>
<li><a href="../351192/index.html">We invite on March 17 to the meeting of the Moscow Testers Club</a></li>
<li><a href="../351196/index.html">Do I need to save data from employees</a></li>
<li><a href="../351198/index.html">Organization of information systems production processes. Part 4. Implementation of the information system</a></li>
<li><a href="../351200/index.html">SOC is people. Downloading expo or how to become a level 20 analyst</a></li>
<li><a href="../351204/index.html">CUBA Platform: Roadmap 2018</a></li>
<li><a href="../351206/index.html">Own game analytics for $ 300 per month</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>