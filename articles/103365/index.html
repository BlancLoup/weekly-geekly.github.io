<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Twitter with your own hands on C #. Part 1: OAuth authorization</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At one point, there was a desire to write a client program for Twitter microblogging networks, C # was chosen as the programming language. 
 Let me re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Twitter with your own hands on C #. Part 1: OAuth authorization</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/f0aa1e69/70ec84cf/630968b0/806153d8.png"><br>  At one point, there was a desire to write a client program for <a href="http://twitter.com/">Twitter</a> microblogging networks, C # was chosen as the programming language. <br>  Let me remind you that OAuth is an open authorization protocol that allows a third party to provide access to protected user resources, without the need to transfer her (third party) login and password.  The third person in this case, of course, we will be with our application. <br>  In principle, this guide is suitable for OAuth authorization, not only on Twitter, but also on any other portal that uses OAuth, for example, the well-known FriendFeed. <br><a name="habracut"></a><br>  The <a href="http://habrahabr.ru/blogs/development/86846/">OAuth authorization process</a> itself is described in some detail at Habr√©. <br>  In order to log in to the twitter account, we need to register our application in <a href="http://dev.twitter.com/apps/new">Twitter Developers</a> . <br>  We fill in the form and press the button Register application, then you will be transferred to the application page.  There we are interested in two lines, namely the <strong>Consumer key</strong> and the <strong>Consumer secret</strong> - we need to save them in some way because we will need them soon. <br>  And now a few theories.  In fact, the authorization process can be divided into three stages: <br>  <strong>1.</strong> Make a request to <a href="http://api.twitter.com/oauth/request_token">api.twitter.com/oauth/request_token</a> in order to get the initial values ‚Äã‚Äãof oauth_token and oauth_secret <br>  <strong>2.</strong> Having received these values, we make another request in the browser window, but already at api.twitter.com/oauth/authorize and the user will be prompted to enter their login / password from the twitter account, and then another form informing us that Wonderful application wants to use user account data and of course two buttons: for refusal and confirmation.  When you click on the confirmation button, a page will open on which the PIN code will be written.  The user must transfer the PIN code to our application. <br>  <strong>3.</strong> And after the user enters the PIN in our application, we will need to make a third request to api.twitter.com/oauth/access_token to get the oauth_token and oauth_secret to be used to identify the user in the system. <br>  We will do everything consistently and by the end of the article we should have an application that can pass OAuth authentication. <br>  Now go to the process of writing the program. <br>  Create a new console application. <br>  So, first we need to make some kind of request about this type <a href="http://api.twitter.com/oauth/request_token%3Foauth_consumer_key%3D">api.twitter.com/oauth/request_token?oauth_consumer_key=</a> &lt;?&gt; &amp; Oauth_signature_method = &lt;?&gt; &amp; Oauth_signature = &lt;?&gt; &amp; Oauth_timestamp = &lt;?&gt; &amp; Oauth_timestamp = &lt;?&gt; &amp; Oauth_timestamp = &lt;?&gt; &amp; Oauth_timestamp = &lt;?&gt; &amp; Oauth_timestamp = &lt;? &gt; <br>  Where &lt;?&gt; Must be your values.  For some values, I used the small but very successful <a href="">OAuthBase.cs</a> class <a href="">.</a> <br>  Download it and put it in the folder with the application. <br><br>  Since we will make requests and work with the class we just downloaded, we should have the following lines in the program header: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">using</font> System;&lt;br&gt; <font color="#0000ff">using</font> OAuth;&lt;br&gt; <font color="#0000ff">using</font> System.Net;&lt;br&gt; <font color="#0000ff">using</font> System.IO;&lt;br&gt; <font color="#0000ff">using</font> System.Text;</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now we need to form the query string, assign its value to the request_url variable of the type and execute the first query. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">//            :</font> &lt;br&gt; <font color="#2B91AF">Uri</font> uri = <font color="#0000ff">new</font> <font color="#2B91AF">Uri</font> ( <font color="#A31515">"http://api.twitter.com/oauth/request_token"</font> );&lt;br&gt; <font color="#0000ff">string</font> consumerKey = <font color="#A31515">"  consumerKey"</font> ;&lt;br&gt; <font color="#0000ff">string</font> consumerSecret = <font color="#A31515">"  consumerSecret"</font> ;&lt;br&gt; <font color="#008000">//                OAuthBase</font> &lt;br&gt;OAuthBase oAuth = <font color="#0000ff">new</font> OAuthBase();&lt;br&gt; <font color="#008000">//   </font> &lt;br&gt; <font color="#0000ff">string</font> timeStamp = oAuth.GenerateTimeStamp();&lt;br&gt; <font color="#0000ff">string</font> nonce = oAuth.GenerateNonce();&lt;br&gt; <font color="#0000ff">string</font> normUri;&lt;br&gt; <font color="#0000ff">string</font> normParams;&lt;br&gt; <font color="#0000ff">string</font> sig = oAuth.GenerateSignature(uri, consumerKey, consumerSecret, <font color="#0000ff">string</font> .Empty, <font color="#0000ff">string</font> .Empty, <font color="#A31515">"GET"</font> , timeStamp, nonce, OAuth.OAuthBase.SignatureTypes.HMACSHA1, <font color="#0000ff">out</font> normUri, <font color="#0000ff">out</font> normParams);&lt;br&gt; <font color="#008000">//     </font> &lt;br&gt; <font color="#0000ff">string</font> request_url = &lt;br&gt; <font color="#A31515">"http://api.twitter.com/oauth/request_token"</font> + <font color="#A31515">"?"</font> +&lt;br&gt; <font color="#A31515">"oauth_consumer_key="</font> + consumerKey + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_signature_method="</font> + <font color="#A31515">"HMAC-SHA1"</font> + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_signature="</font> + sig + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_timestamp="</font> + timeStamp + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_nonce="</font> + nonce + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_version="</font> + <font color="#A31515">"1.0"</font> ;&lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"Req: "</font> + request_url); <font color="#008000">//    </font> &lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"--------------------------------------------------------"</font> );&lt;br&gt; <font color="#008000">//   </font> &lt;br&gt;HttpWebRequest Request = (HttpWebRequest) HttpWebRequest.Create(request_url);&lt;br&gt;HttpWebResponse Response = (HttpWebResponse)Request.GetResponse();      &lt;br&gt;StreamReader Reader = <font color="#0000ff">new</font> StreamReader(Response.GetResponseStream(), <font color="#2B91AF">Encoding</font> .GetEncoding(1251));&lt;br&gt; <font color="#0000ff">string</font> outline = Reader.ReadToEnd();  &lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"Out: "</font> + outline);&lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"--------------------------------------------------------"</font> );&lt;br&gt; <font color="#008000">//   </font> &lt;br&gt; <font color="#0000ff">char</font> [] delimiterChars = { <font color="#A31515">'&amp;'</font> , <font color="#A31515">'='</font> };&lt;br&gt; <font color="#0000ff">string</font> [] words = outline.Split(delimiterChars);&lt;br&gt; <font color="#0000ff">string</font> oauth_token = words[1]; &lt;br&gt; <font color="#0000ff">string</font> oauth_token_secret = words[3];&lt;br&gt; <font color="#0000ff">string</font> oauth_callback_confirmed = words[5];&lt;br&gt; <font color="#008000">//   </font> &lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"oauth_token = "</font> + oauth_token);  &lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"oauth_token_secret = "</font> + oauth_token_secret);  &lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"oauth_callback_confirmed = "</font> + oauth_callback_confirmed);&lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"--------------------------------------------------------"</font> );</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now you can go to the second step, where the user will be prompted to enter a PIN code <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">//              </font> &lt;br&gt; <font color="#008000">//       PIN      </font> &lt;br&gt;request_url = <font color="#A31515">"http://api.twitter.com/oauth/authorize?oauth_token="</font> + oauth_token;&lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"Req: "</font> + request_url);&lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"--------------------------------------------------------"</font> );&lt;br&gt;System.Diagnostics.Process.Start(request_url); <font color="#008000">//             PIN-</font> &lt;br&gt; <font color="#2B91AF">Console</font> .Write( <font color="#A31515">"Enter PIN: "</font> );&lt;br&gt; <font color="#0000ff">string</font> oauth_verifier = <font color="#2B91AF">Console</font> .ReadLine(); <font color="#008000">// oauth_verifier ‚Äî    PIN-.</font> &lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"--------------------------------------------------------"</font> );</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  And the final request, the answer to which we will have to save and access the account data <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">//     </font> &lt;br&gt;request_url = &lt;br&gt; <font color="#A31515">"http://api.twitter.com/oauth/access_token"</font> + <font color="#A31515">"?"</font> +&lt;br&gt; <font color="#A31515">"oauth_consumer_key="</font> + consumerKey + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_token="</font> + oauth_token + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_signature_method="</font> + <font color="#A31515">"HMAC-SHA1"</font> + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_signature="</font> + sig + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_timestamp="</font> + timeStamp + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_nonce="</font> + nonce + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_version="</font> + <font color="#A31515">"1.0"</font> + <font color="#A31515">"&amp;"</font> +&lt;br&gt; <font color="#A31515">"oauth_verifier="</font> + oauth_verifier;&lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"Req: "</font> + request_url);&lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"--------------------------------------------------------"</font> ); &lt;br&gt; <font color="#008000">//   </font> &lt;br&gt;Request = (HttpWebRequest) HttpWebRequest.Create(request_url);&lt;br&gt;Response = (HttpWebResponse)Request.GetResponse();  &lt;br&gt;Reader = <font color="#0000ff">new</font> StreamReader(Response.GetResponseStream(), <font color="#2B91AF">Encoding</font> .GetEncoding(1251));&lt;br&gt;outline = Reader.ReadToEnd();  &lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"Out: "</font> + outline);&lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"--------------------------------------------------------"</font> );&lt;br&gt; <font color="#008000">//        </font> &lt;br&gt;words = outline.Split(delimiterChars);&lt;br&gt;oauth_token = words[1]; &lt;br&gt;oauth_token_secret = words[3];&lt;br&gt; <font color="#0000ff">string</font> user_id = words[5];&lt;br&gt; <font color="#0000ff">string</font> screen_name = words[7];&lt;br&gt; <font color="#008000">//   </font> &lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"oauth_token = "</font> + oauth_token);  &lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"oauth_token_secret = "</font> + oauth_token_secret);  &lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"user_id = "</font> + user_id);&lt;br&gt; <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"screen_name = "</font> + screen_name);</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  That's all all the necessary data obtained.  Communication with the Twitter API will be reviewed in the next article.  The output of lines with values ‚Äã‚Äãare made to improve the visibility of the authorization process and its understanding.  Lines with hyphens are inserted so that the displayed text does not merge into one continuous line in the eyes. <br><br>  UPD: the author did get an invite for a habr on his own.  Welcome <a href="https://habrahabr.ru/users/shpaker/" class="user_link">shpaker</a> ! </div><p>Source: <a href="https://habr.com/ru/post/103365/">https://habr.com/ru/post/103365/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../103355/index.html">Christopher Alexander</a></li>
<li><a href="../103356/index.html">Galaxy Tab was introduced to the public at IFA</a></li>
<li><a href="../103357/index.html">Incomprehensible website copying content from Habr, along with comments</a></li>
<li><a href="../103359/index.html">Startups, experts, business angels and Startup Weekend (explanation)</a></li>
<li><a href="../103363/index.html">Scribd.com has become greedy</a></li>
<li><a href="../103366/index.html">E-mail is an unreliable form of communication. Therefore, we send you the password in it</a></li>
<li><a href="../103367/index.html">About the reasons for unsuccessful ERP implementations</a></li>
<li><a href="../103369/index.html">Twitter plans to monitor user clicks on links</a></li>
<li><a href="../103372/index.html">Modern 3D stereo mixed reality system created in Russia</a></li>
<li><a href="../103373/index.html">Hunting for bugs. Warm up for web developers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>