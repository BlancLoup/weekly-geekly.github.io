<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Debugging Incomprehensible Errors in Magento</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Surely every developer of modules for Magento got into a situation where everything seems to be done correctly, but does not work. This is especially ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Debugging Incomprehensible Errors in Magento</h1><div class="post__text post__text-html js-mediator-article">  Surely every developer of modules for Magento got into a situation where everything seems to be done correctly, but does not work.  This is especially true of typical situations: he created a router, but issues a 404 starnitsa, created a layout, but the content is not displayed, created a template, and the page is still empty.  A distinctive feature of such a situation is that, as a rule, Magento does not react to them at all (no errors are issued, the logs remain empty).  It is about debugging such errors and will be discussed in this article. <br><br>  Having had enough of these situations, I gathered a small collection of design tips and module debugging methods that allow you to quickly deal with such troubles.  They will be especially useful for beginners, but experienced developers can find something new for themselves. <br><a name="habracut"></a><br>  So let's go! <br><br><h4>  I created a router and controller for it, but Magento shows 404 pages. </h4><br><h5>  Why it happens: </h5><br>  Most likely, the wrong file is named in which the controller class is located, the path does not match the class name, the wrong class name, and similar errors.  Perhaps this is just a typo due to inattention, but it may happen that you do not fully understand how Magento translates the request into frontName, controllerName and actionName.  In this case, I recommend reading the Alan Strom <a href="http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-3-magento-controller-dispatch">article</a> on determining the name of the controller. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The only clarification that should be made for beginners is how to enter the name of the controller in the address of the page, which lies not in the controllers folder, but in its subdirectories.  It's pretty simple, but sometimes problems arise. <br><br>  So, you need to take a piece of the controller name between ‚ÄúNamespace_ModuleName_‚Äù and the word ‚ÄúController‚Äù at the end and bring it to lower case.  For example, for the name Namespace_ModuleName_Subfolder1_Subfolder2_IndexController, the name of the controller in the address line will be the following subfolder1_subfolder2_index. <br><br><h5>  How to debug: </h5><br>  So, you have a good understanding of how the controller name is determined, but you still see 404 pages.  If this happens, then most likely you put the file with the controller in the wrong folder or incorrectly named the file itself.  The easiest way to check this is to bring the path to the controller that Magento is looking for.  To do this, go to the Mage_Core_Controller_Varien_Router_Standard class and look for the _validateControllerClassName () method there.  In this method, we get the full path to our controller, it remains only to withdraw it and check with ours. <br><br>  Here is the corresponding code: <br><br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_validateControllerClassName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($realModule, $controller)</span></span></span><span class="hljs-function"> </span></span>{ $controllerFileName = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getControllerFileName($realModule, $controller); var_dump($controllerFileName); <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(); <span class="hljs-comment"><span class="hljs-comment">// added line if (!$this-&gt;validateControllerFileName($controllerFileName)) { return false; } // ‚Ä¶ }</span></span></code> </pre> <br>  Now, instead of 404 pages Magento will give way to our controller.  We fix and rejoice. <br><br>  If the path contains Mage / Core / ... instead of your Namespace / ModuleName, then you did not define the router in config.xml or did it incorrectly.  How to do it correctly we read everything in the same <a href="http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-3-magento-controller-dispatch">article by</a> Alan Strom. <br><br>  Then we can expect several more displayed errors: namely, the Controller file was not loaded but it means that we typed the controller name incorrectly in the file or Fatal error: Call to undefined method NameSpace_TestModule_IndexController :: hasAction (), which says to us that we forgot to inherit the base controller Mage_Core_Controller_Front_Action for the frontend and Mage_Adminhtml_Controller_Action for the backend. <br><br><h4>  I created a router, controller and method, but I get a Whoops page, our bad ... </h4><br><h5>  Why it happens: </h5><br>  Very rare and easy to fix error.  It means that our controller does not contain the method you request. <br><br><h5>  How to debug: </h5><br>  Check the name of your method, most likely it is named incorrectly, maybe you forgot to add an Action after the method name. <br><br><h4>  It seems to me that one of the xml files is not loaded, or I want to see which files are being loaded. </h4><br><h5>  Why it happens: </h5><br>  The reasons why it can not load the xml-file a lot and it makes no sense to consider them in this topic.  The solution for all cases is the same, so we will go straight to it. <br><br><h5>  How to debug: </h5><br>  The simplest way to check if a particular xml file is being loaded is to make it invalid.  Let's say add an extra unit to the file: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">1?xml</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">?&gt;</span></span></code> </pre><br>  Now, when entering the page, you will see an error message about the loading of the xml file.  If this message does not exist, the file does not load.  What xml-files and why they can not be loaded is the topic of a separate article and will not be considered here. <br><br>  The second part of our question is to find out which xml files are loaded.  One way to do this is to add a few lines to the file lib / Varien / Simplexml / Config.php.  We are looking for the loadFile method, which is responsible for loading all xml files, and appending several lines there: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($filePath)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!is_readable($filePath)) { <span class="hljs-comment"><span class="hljs-comment">//throw new Exception('Can not read xml file '.$filePath); return false; } // added lines $log = fopen("***      magento***/var/log/xml.log", "a"); fwrite($log, "Loading XML file: $filePath\n"); fclose($log); // ... }</span></span></code> </pre><br>  Do not forget to enter your path from the root of the server to the directory with installed Magento.  And also create a file xml.log, at the specified path.  Now the list of all xml files uploaded when the page is requested will be written to the specified log file. <br><br>  You should not keep these lines enabled all the time, as the log will very quickly reach impressive sizes.  You can simply comment them out until they are needed again. <br><br><h4>  I connected the file with the layout, added the handle with the block, but the page is still empty </h4><br>  For starters, I'll give you some code: <br><br><pre> <code class="xml hljs">app/code/local/TestCompany/TestModule/etc/config.xml <span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">frontend</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">updates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">testmodule</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">file</span></span></span><span class="hljs-tag">&gt;</span></span>testmodule.xml<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">file</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">testmodule</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">updates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">frontend</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Here we connect the file with the layout.  Here is the file itself: <br><br><pre> <code class="xml hljs">app/design/base/default/layouts/testmodule.xml <span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">testmodale_index_index</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"root"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"setTemplate"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span>page/2columns-right.phtml<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">block</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"core/template"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"testmodule.mainpage"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"testmodule/page"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">testmodale_index_index</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  This file contains several common errors, but we will discuss them a little later.  In the meantime, suppose that everything is written correctly in this file.  Also create a file with a template: <br><br><pre> <code class="html hljs xml">app/design/base/default/templates/testmodule/page.phtml <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Test content.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  So now the reasons for this clean page and their solutions: <br><br><ol><li>  You forgot to specify in the controller method that you need to load the layout. <br>  The controller should contain the following lines of code: <br><br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;loadLayout(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;renderLayout();</code> </pre><br></li><li>  The file with the layout is not loaded. <br>  How to check this version you already know from the previous paragraph. <br><br></li><li>  Wrong name of the handle in the file with the layout. <br>  This is one of the mistakes that were made in our example.  In the example, this is just a typo, you need to fix testmodale to testmodule, but sometimes it happens that you incorrectly determined the handle for a page.  The simplest solution is to display all the handles whose contents Magento loads for the current page.  To do this, add the following line of code to the controller method: <br><br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;loadLayout(); var_dump(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getLayout()-&gt;getUpdate()-&gt;getHandles()); <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;renderLayout();</code> </pre><br>  For our example, one of their handles would be testmodule_index_index, which we specified. <br><br></li><li>  Incorrect title or template path. <br>  This is the second mistake made in our example.  The author of the code forgot to specify the .phtml extension for the file with the template.  To debug such problems, you should include the so-called Template Path Prompts.  This can be done in the administrative part of Magento.  Go to System -&gt; Configuration -&gt; Developer.  Select in the upper left corner of the Main Website.  Now two additional fields appear in the Debug tab.  We need to enable Template Path Hints.  Now, when entering the page, we see the path that the template is in, which Magento connects to the page. </li></ol><br>  Of course, these are not all the possible problems that may arise when developing a module for Magento, but at least the most frequent and incomprehensible for newbies now, I hope, will not be so incomprehensible.  Do not forget to share your tips in the comments. </div><p>Source: <a href="https://habr.com/ru/post/151647/">https://habr.com/ru/post/151647/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151639/index.html">A simple but illustrative example of using TDD</a></li>
<li><a href="../151640/index.html">Stencil Buffer Implementation Example with CUDA</a></li>
<li><a href="../151641/index.html">How I Invented the Bike, Learning Technology</a></li>
<li><a href="../151643/index.html">Admission to the magistracy in Germany</a></li>
<li><a href="../151646/index.html">We raise our own Git GitBlit server on Openshift hosting</a></li>
<li><a href="../151650/index.html">7 obvious rules for secure system administration of physical servers</a></li>
<li><a href="../151651/index.html">How to replace the headset? Stylish Headphones Review</a></li>
<li><a href="../151652/index.html">Using the eToken-EPGU plug-in to generate EDS</a></li>
<li><a href="../151653/index.html">Emacs and the correct work with someone else's code: indentation</a></li>
<li><a href="../151654/index.html">Mars rover Curiosity is theoretically capable of infecting Mars due to the negligence of NASA engineers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>