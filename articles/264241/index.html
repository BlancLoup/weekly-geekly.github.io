<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introduction to machine learning with scikit-learn (translation of documentation)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is a translation of the introduction to machine learning, presented on the official website scikit-learn . 

 In this part we will talk a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introduction to machine learning with scikit-learn (translation of documentation)</h1><div class="post__text post__text-html js-mediator-article">  <i>This article is a translation of the introduction to machine learning, presented on the official website <a href="http://scikit-learn.org/stable/tutorial/basic/tutorial.html">scikit-learn</a> .</i> <br><br>  In this part we will talk about the terms of <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D1%2588%25D0%25B8%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BE%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">machine learning</a> that we use to work with scikit-learn, and give a simple example of learning. <br><br><h4>  Machine learning: posing the question </h4><br>  In general, the problem of machine learning is reduced to obtaining a set of <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D1%258B%25D0%25B1%25D0%25BE%25D1%2580%25D0%25BA%25D0%25B0">data samples</a> and, subsequently, to attempts to predict the properties of unknown data.  If each data set is not a single number, but, for example, a multidimensional entity (multi-dimensional entry or <a href="http://en.wikipedia.org/wiki/Multivariate_random_variable">multivariate</a> data), then it should have several features or features. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Machine learning can be divided into several large categories: <br><ul><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D1%2581_%25D1%2583%25D1%2587%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BC">learning with a teacher</a> (or guided learning).  Here the data are presented along with additional features that we want to predict.  ( <a href="http://scikit-learn.org/stable/supervised_learning.html">Click here</a> to go to the Scikit-Learn Training with Teacher page).  This can be any of the following tasks: </li></ul><br><ol><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25B4%25D0%25B0%25D1%2587%25D0%25B0_%25D0%25BA%25D0%25BB%25D0%25B0%25D1%2581%25D1%2581%25D0%25B8%25D1%2584%25D0%25B8%25D0%25BA%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8">classification</a> : data samples belong to two or more classes and we want to learn from the already marked data to predict the class of unlabeled samples.  An example of a classification problem is handwriting recognition, the purpose of which is to assign each of the input data sets one of a finite number of discrete categories.  Another way to understand classification is to understand it as a discrete (as opposed to continuous) form of managed learning, where we have a limited number of categories provided for N samples;  and we try to mark them with the correct category or class. </li><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25B3%25D1%2580%25D0%25B5%25D1%2581%25D1%2581%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B0%25D0%25BD%25D0%25B0%25D0%25BB%25D0%25B8%25D0%25B7">regression analysis</a> : if the desired output consists of one or more continuous variables, then we are faced with a regression analysis.  An example of solving such a problem is the prediction of the length of a salmon as a result of a function of its age and weight. </li></ol><br><br><ul><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B1%25D0%25B5%25D0%25B7_%25D1%2583%25D1%2587%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258F">learning without a teacher</a> (or self-study).  In this case, the training sample consists of a set of input data X without any corresponding values.  The purpose of such tasks may be to determine groups of similar elements within the data.  This is called <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BB%25D0%25B0%25D1%2581%25D1%2582%25D0%25B5%25D1%2580%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B0%25D0%25BD%25D0%25B0%25D0%25BB%25D0%25B8%25D0%25B7">clustering</a> or cluster analysis.  Also, the task may be to establish the distribution of data within the input space, called density density ( <a href="http://en.wikipedia.org/wiki/Density_estimation">density estimation</a> ).  Or it could be the extraction of data from a high dimensional space into a two-dimensional or three-dimensional space in order to visualize the data.  ( <a href="http://scikit-learn.org/stable/unsupervised_learning.html">Click here</a> to go to the Scikit-Learn tuition without a teacher.) </li></ul><br><a name="habracut"></a><br><h4>  Training Sample and Control Sampling </h4><br>  Machine learning is learning how to isolate certain properties of a data sample and apply them to new data.  That is why the common practice of evaluating an algorithm in Machine Learning is to manually split the data into two data sets.  The first of these is the training sample, and the properties of the data are studied on it.  The second is a <b>control sample</b> , these properties are tested on it. <br><br><h4>  Sample load </h4><br>  Scikit-learn is set together with several standard data samples, for example, <a href="http://en.wikipedia.org/wiki/Iris_flower_data_set">iris</a> and <a href="http://archive.ics.uci.edu/ml/datasets/Pen-Based%2BRecognition%2Bof%2BHandwritten%2BDigits">digits</a> for classification, and <a href="http://archive.ics.uci.edu/ml/datasets/Housing">boston house prices</a> dataset for regression analysis. <br><br>  Next, we run the Python interpreter from the command line and load the iris and digits samples.  Let's set the following conventions: $ means starting the Python interpreter, and &gt;&gt;&gt; means starting the Python command line: <br><br><pre><code class="python hljs">$ python &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datasets &gt;&gt;&gt; iris = datasets.load_iris() &gt;&gt;&gt; digits = datasets.load_digits()</code> </pre> <br>  A data set is a dictionary object that contains all the data and some metadata about it.  This data is stored with a .data extension, for example, n_samples, n_features arrays.  In machine learning with a teacher, one or more dependent variables are stored with the .target extension.  For more information on datasets, go to the <a href="http://scikit-learn.org/stable/datasets/index.html">appropriate section</a> . <br><br>  For example, the digits.data dataset provides access to features that can be used to classify numeric samples: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>print(digits.data) [[ <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">5.</span></span> ..., <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>] [ <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> ..., <span class="hljs-number"><span class="hljs-number">10.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>] [ <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> ..., <span class="hljs-number"><span class="hljs-number">16.</span></span> <span class="hljs-number"><span class="hljs-number">9.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>] ..., [ <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">1.</span></span> ..., <span class="hljs-number"><span class="hljs-number">6.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>] [ <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">2.</span></span> ..., <span class="hljs-number"><span class="hljs-number">12.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>] [ <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">10.</span></span> ..., <span class="hljs-number"><span class="hljs-number">12.</span></span> <span class="hljs-number"><span class="hljs-number">1.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>]]</code> </pre> <br>  and digits.target makes it possible to determine in a numerical sample, which digit corresponds to each numerical representation, which we will study: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>digits.target array([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ..., <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>])</code> </pre> <br><h4>  Dataset form </h4><br>  Usually, the data is presented in the form of a two-dimensional array, n_samples, n_features have such a shape, although the source data may have a different shape.  In the case of numbers, each source sample is a representation of the form (8, 8), which can be accessed using: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>digits.images[<span class="hljs-number"><span class="hljs-number">0</span></span>] array([[ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">5.</span></span>, <span class="hljs-number"><span class="hljs-number">13.</span></span>, <span class="hljs-number"><span class="hljs-number">9.</span></span>, <span class="hljs-number"><span class="hljs-number">1.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>], [ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">13.</span></span>, <span class="hljs-number"><span class="hljs-number">15.</span></span>, <span class="hljs-number"><span class="hljs-number">10.</span></span>, <span class="hljs-number"><span class="hljs-number">15.</span></span>, <span class="hljs-number"><span class="hljs-number">5.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>], [ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">3.</span></span>, <span class="hljs-number"><span class="hljs-number">15.</span></span>, <span class="hljs-number"><span class="hljs-number">2.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">11.</span></span>, <span class="hljs-number"><span class="hljs-number">8.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>], [ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">4.</span></span>, <span class="hljs-number"><span class="hljs-number">12.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">8.</span></span>, <span class="hljs-number"><span class="hljs-number">8.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>], [ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">5.</span></span>, <span class="hljs-number"><span class="hljs-number">8.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">9.</span></span>, <span class="hljs-number"><span class="hljs-number">8.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>], [ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">4.</span></span>, <span class="hljs-number"><span class="hljs-number">11.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">1.</span></span>, <span class="hljs-number"><span class="hljs-number">12.</span></span>, <span class="hljs-number"><span class="hljs-number">7.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>], [ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">2.</span></span>, <span class="hljs-number"><span class="hljs-number">14.</span></span>, <span class="hljs-number"><span class="hljs-number">5.</span></span>, <span class="hljs-number"><span class="hljs-number">10.</span></span>, <span class="hljs-number"><span class="hljs-number">12.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>], [ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">6.</span></span>, <span class="hljs-number"><span class="hljs-number">13.</span></span>, <span class="hljs-number"><span class="hljs-number">10.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>]])</code> </pre> <br>  <a href="http://scikit-learn.org/stable/auto_examples/classification/plot_digits_classification.html">The following simple example with this data set</a> illustrates how, based on the task, you can generate data for use in scikit-learn. <br><br><h4>  Training and Forecasting </h4><br>  In the case of a numeric data set, the goal of learning is to predict, taking into account the data representation, which digit is shown.  We have samples of each of the ten possible classes (numbers from 0 to 9) in which we train the estimator (estimator) so that it can predict the class to which the unlabeled sample belongs. <br><br>  In scikit-learn, the estimation algorithm for a classifier is a Python object that executes the fit (X, y) and predict (T) methods.  An example of an estimation algorithm is the class sklearn.svm.SVC performs the classification <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25BE%25D0%25BF%25D0%25BE%25D1%2580%25D0%25BD%25D1%258B%25D1%2585_%25D0%25B2%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BE%25D1%2580%25D0%25BE%25D0%25B2">by the support vector</a> machine.  The designer of the estimation algorithm accepts model parameters as arguments, but to reduce the time, we will consider this algorithm as a black box: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> svm &gt;&gt;&gt; clf = svm.SVC(gamma=<span class="hljs-number"><span class="hljs-number">0.001</span></span>, C=<span class="hljs-number"><span class="hljs-number">100.</span></span>)</code> </pre> <br><br><h4>  Selection of parameters for the model </h4><br>  In this example, we set the value of gamma manually.  You can also automatically determine the appropriate values ‚Äã‚Äãfor the parameters using tools such as <a href="http://scikit-learn.org/stable/modules/grid_search.html">grid search</a> and <a href="http://scikit-learn.org/stable/modules/cross_validation.html">cross validation</a> . <br><br>  We called an instance of our clf evaluation algorithm, since it is a classifier.  Now it should be applied to the model, i.e.  he must learn on the model.  This is done by running our training sample through the fit method.  As a training sample, we can use all the representations of our data, except the last.  We made this sample using the Python syntax [: -1], which created a new array containing all but the last entity from digits.data: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>clf.fit(digits.data[:<span class="hljs-number"><span class="hljs-number">-1</span></span>], digits.target[:<span class="hljs-number"><span class="hljs-number">-1</span></span>]) SVC(C=<span class="hljs-number"><span class="hljs-number">100.0</span></span>, cache_size=<span class="hljs-number"><span class="hljs-number">200</span></span>, class_weight=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, coef0=<span class="hljs-number"><span class="hljs-number">0.0</span></span>, degree=<span class="hljs-number"><span class="hljs-number">3</span></span>, gamma=<span class="hljs-number"><span class="hljs-number">0.001</span></span>, kernel=<span class="hljs-string"><span class="hljs-string">'rbf'</span></span>, max_iter=<span class="hljs-number"><span class="hljs-number">-1</span></span>, probability=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, random_state=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, shrinking=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, tol=<span class="hljs-number"><span class="hljs-number">0.001</span></span>, verbose=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br>  Now we can predict new values, in particular, we can ask the classifier what number is contained in the last representation in the digits data set, which we did not use in the classifier training: <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>clf.predict(digits.data[<span class="hljs-number"><span class="hljs-number">-1</span></span>]) array([<span class="hljs-number"><span class="hljs-number">8</span></span>])</code> </pre> <br>  The corresponding image is presented below: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8cf/8ff/85c/8cf8ff85cc3c5b71775f7ffcaccf86af.png" alt="image"><br><br>  As you can see, this is a difficult task: the presentation is in poor resolution.  Do you agree with the classifier? <br><br>  The complete solution to this classification problem is available as an example, which you can run and study: <a href="http://scikit-learn.org/stable/auto_examples/classification/plot_digits_classification.html">Recognizing hand-written digits</a> . <br><br><h4>  Saving model </h4><br>  In scikit, the model can be saved using a built-in module called <a href="http://docs.python.org/library/pickle.html">pickle</a> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> svm &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datasets &gt;&gt;&gt; clf = svm.SVC() &gt;&gt;&gt; iris = datasets.load_iris() &gt;&gt;&gt; X, y = iris.data, iris.target &gt;&gt;&gt; clf.fit(X, y) SVC(C=<span class="hljs-number"><span class="hljs-number">1.0</span></span>, cache_size=<span class="hljs-number"><span class="hljs-number">200</span></span>, class_weight=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, coef0=<span class="hljs-number"><span class="hljs-number">0.0</span></span>, degree=<span class="hljs-number"><span class="hljs-number">3</span></span>, gamma=<span class="hljs-number"><span class="hljs-number">0.0</span></span>, kernel=<span class="hljs-string"><span class="hljs-string">'rbf'</span></span>, max_iter=<span class="hljs-number"><span class="hljs-number">-1</span></span>, probability=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, random_state=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, shrinking=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, tol=<span class="hljs-number"><span class="hljs-number">0.001</span></span>, verbose=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pickle &gt;&gt;&gt; s = pickle.dumps(clf) &gt;&gt;&gt; clf2 = pickle.loads(s) &gt;&gt;&gt; clf2.predict(X[<span class="hljs-number"><span class="hljs-number">0</span></span>]) array([<span class="hljs-number"><span class="hljs-number">0</span></span>]) &gt;&gt;&gt; y[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  In the particular case of scikit, it may be more useful to notice pickle on the joblib library (joblib.dump &amp; joblib.load), which is more efficient for working with large amounts of data, but it allows you to save the model only on disk, and not in the line: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.externals <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> joblib &gt;&gt;&gt; joblib.dump(clf, <span class="hljs-string"><span class="hljs-string">'filename.pkl'</span></span>)</code> </pre> <br>  Then you can load the saved model (possibly in another Python process) with: <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>clf = joblib.load(<span class="hljs-string"><span class="hljs-string">'filename.pkl'</span></span>)</code> </pre> <br>  Note that joblib.dump returns a list of file names.  Each individual numpy array contained in the clf object is parsed as a separate file in the file system.  All files must be in the same folder when you load the model again with joblib.load. <br><br>  Please note that pickle has some security and maintenance issues.  For more detailed information on model storage in scikit-learn, refer to the <a href="http://scikit-learn.org/stable/modules/model_persistence.html">Model persistence</a> section. </div><p>Source: <a href="https://habr.com/ru/post/264241/">https://habr.com/ru/post/264241/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264229/index.html">Calque - a calculator that is more convenient than the browser console</a></li>
<li><a href="../264233/index.html">The complexity of building Python3 + Qt5 applications under Windows</a></li>
<li><a href="../264235/index.html">Mobile phones for / against special services</a></li>
<li><a href="../264237/index.html">Bikes of field engineers - installation and service of VKS / KC</a></li>
<li><a href="../264239/index.html">Special SIM card plus Internet telephony or a "vulture with legs" for everyone</a></li>
<li><a href="../264243/index.html">CAD technology</a></li>
<li><a href="../264245/index.html">Online Payment Statistics</a></li>
<li><a href="../264247/index.html">Google and Samsung promise to regularly update Android</a></li>
<li><a href="../264249/index.html">New Hyper-V vNext features</a></li>
<li><a href="../264251/index.html">Golang to AeroFS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>