<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Technology to combat MiniDuke. Simple protection against complex threats?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Just a year ago, many were convinced that targeted attacks (not to be confused with cyber-weapons ) were directed exclusively at American and Western ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Technology to combat MiniDuke. Simple protection against complex threats?</h1><div class="post__text post__text-html js-mediator-article">  Just a year ago, many were convinced that targeted attacks (not to be confused with <a href="http://www.securelist.com/en/analysis/204792257/Kaspersky_Security_Bulletin_2012_Cyber_Weapons">cyber-weapons</a> ) were directed exclusively at American and Western European companies.  However, the <a href="http://www.securelist.com/en/blog/785/The_Red_October_Campaign_An_Advanced_Cyber_Espionage_Network_Targeting_Diplomatic_and_Government_Agencies">exposure of</a> cyber-operations of Red October by experts of Kaspersky Lab allowed to dispel the myth of the narrow geographic focus of such threats. <br><br>  Another proof of the scale was not long in coming.  On February 27, Kaspersky Lab published a new <a href="http://www.securelist.com/en/blog/208194129/The_MiniDuke_Mystery_PDF_0_day_Government_Spy_Assembler_0x29A_Micro_Backdoor">report</a> on a study of a number of incidents involving cyber espionage against government agencies and scientific organizations around the world.  The malicious program MiniDuk continues to attack its victims from Ukraine, Belgium, Portugal, Romania, the Czech Republic, Ireland and other countries today.  Specially for Habr, the report on this new threat was prepared by <b>Vladimir Zapolyansky,</b> deputy head of the global research center, head of Kaspersky Lab's technology positioning department. <br><br><img src="http://www.securelist.com/ru/images/pictures/klblog/207764495.png" alt="image"><br>  <i>A tweet of an account created by command server operators and containing a specific tag that marks an encrypted URL for use by backdoors.</i> <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To penetrate the victim‚Äôs computer, MiniDuke uses an exploit for the newly discovered <a href="http://blog.fireeye.com/research/2013/02/the-number-of-the-beast.html">0-day vulnerability CVE-2013-0640</a> in PDF Adobe Reader 9, 10, 11. After opening a pdf file received via email, a small malicious program module penetrates the computer (20 KB).  A characteristic feature of the attack is that this module is written in Assembler in a style popular with virus writers in the late 90s - early 2000s, and is very rarely used today. <br><br>  After penetration, the program contacts its creators via the Twitter microblogging service, where it searches for tweets in accounts previously created by attackers.  Going on the links posted on Twitter, it downloads the bulk of the malicious code.  The download is carried out in several stages, after which the malicious code begins to function as Backdoor, thereby opening up to the attacker access to any data stored on the victim‚Äôs computer. <br><br><h4>  Is there any protection against MiniDuke? </h4><br>  Today, many anti-virus security companies <a href="https://www.virustotal.com/en/file/7815e5275ea849a9ed1f193abd8781ff7ae6b88ef6282f6a0900175a4bb59131/analysis/">block</a> MiniDuke with signature or heuristic methods.  However, this detection of malicious code became possible only after the information about the vulnerability used by Adobe Reader 0-day became publicly known, namely from February 12, 2013. At the same time, Adobe released a <a href="http://www.adobe.com/support/security/advisories/apsa13-02.html">patch</a> to close this vulnerability on February 20, 2013. <br><br>  This means that for a long time many anti-virus companies might not have a solution for protecting against this targeted attack: the exploit used in the attack can successfully bypass such advanced anti-exploit technologies like ASLR and DEP. <br><br><h4>  Protection of Kaspersky Lab </h4><br>  As shown by the <a href="http://ksn.kaspersky.com/">Kaspersky Security Network (KSN)</a> data, the ‚Äúcombat load‚Äù (Shellcode) of the Adobe Reader exploit was blocked by our products for corporate and home users even before we learned about the existence of this attack. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/363/ecc/2bb/363ecc2bb942ad7eae6484c2d3dd463c.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/5b0/615/667/5b0615667bc3755e94ebc8d8f5a0ed3e.png" alt="image"><br>  <i>Fig.</i>  <i>1 Kaspersky Security Network statistics for February 2013. Geography of distribution and the number of blocked execution attempts on the shellcode computer used in the Adobe Reader exploit</i> <br><br>  Moreover, lockdown statistics for this shellcode for 2012 indicate its use earlier. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ee3/2d7/173/ee32d7173e44c8f1962bf221d32eb221.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/17b/859/7f0/17b8597f0d1f48a657384ea3196611c7.png" alt="image"><br>  <i>Fig.</i>  <i>2 Statistics of the Kaspersky Security Network for 2012. Geography of distribution and the number of blocked execution attempts on a shellcode computer used in the Adobe Reader exploit</i> <br><br>  This shellcode was first discovered and blocked by our products at the end of 2010! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c43/0d5/f56/c430d5f56038bd84eeaf2c1334a5bd02.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/629/d11/67c/629d1167ccbf138d7fe3f915704c486a.png" alt="image"><br>  <i>Fig.</i>  <i>3 Statistics of Kaspersky Security Network from 2010 to 2013. The geography of distribution and the number of blocked execution attempts on the shellcode computer used in the Adobe Reader exploit</i> <br><br>  <b>Thus, the ‚Äúcombat load‚Äù (Shellcode) used in the Adobe Reader exploit for the MiniDuke cyber attack has been successfully blocked by our products since 2010.</b> <br><br>  This happens at the stage of analysis of email messages by email antivirus.  In the case of an attempt to penetrate a letter with a malicious object onto a computer, a user of Kaspersky Lab products simply receives an email with a deleted file and information that the file contained a malicious program with the Exploit.JS.Pdfka.giw verdict. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/efb/c58/612/efbc58612ef6143228d871422f8a2825.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/d37/344/89a/d3734489ae3cb37515ae0295bf340ce2.png" alt="image"><br>  Fig.  4 Notification to the user about blocking the Shellcode exploit when receiving mail in interactive and non-interactive modes <br><br>  <b>How was it possible to block this shellcode before we learned about its existence?</b> <br><br>  Usually in the detection of complex threats, including targeted attacks, involved several layers of protection.  One key is <a href="http://www.kaspersky.com/downloads/pdf/kaspersky_lab_whitepaper_automatic_exploit_prevention_eng_final.pdf">Automatic Exploit Prevention</a> .  It was this proactive technology that <a href="http://habrahabr.ru/company/kaspersky/blog/169839/">worked</a> effectively when Red October was detected, as well as <a href="http://www.securelist.com/en/blog/208194070/Java_0day_Mass_Exploit_Distribution">Java 0-day</a> , public information about which appeared in January 2013. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a7c/30e/97e/a7c30e97e20071d4ed240c1f4dea8d52.png" alt="image"><br>  <i>Fig.</i>  <i>6. Multi-level protection model of Kaspersky Lab</i> <br><br>  However, in the case of MiniDuke, everything turned out to be much simpler.  In August 2010, our antivirus experts created a heuristic signature to block many exploits that exploit vulnerabilities in Adobe Reader.  It is this link of multi-layer protection implemented in our products that effectively worked in this case. <br><br><h4>  Heuristic detection by Kaspersky Lab </h4><br>  Heuristic analysis belongs to the class of proactive protection technologies, it allows you to find files infected with an unknown virus or a new modification of a known instance.  This technology makes it possible to block a lot of malicious files with a single signature, at the same time allowing you to improve the quality of detection and reduce the size of anti-virus databases. <br><br>  In our products implemented static and dynamic analysis. <br><br>  Static analysis scans the code for suspicious commands that may be a sign of malware.  For example, a characteristic of a malicious program may be the behavior in which it performs the search for executable files and their subsequent modification. <br><br>  The heuristic analyzer scans the program code and, having encountered a suspicious command or fragment, increases the program‚Äôs ‚Äúsuspicion counter‚Äù.  If, after scanning the entire program, the value of this counter exceeds a certain threshold value, then the object is recognized as suspicious. <br><br>  When using dynamic analysis, the launch of an object's program is emulated in a virtual address space.  If during the emulation process the heuristic analyzer detects suspicious actions, then the program or object is recognized as malicious and their launch on the user's computer is blocked. <br><br>  In our products, a number of components use heuristic analysis, such as File Anti-Virus, Mail Anti-Virus, Web Anti-Virus, IM Anti-Virus, Application Activity Control, etc. <br><br><h4>  Conclusion </h4><br>  However, the simple way to block this threat does not mean that all such attacks can be neutralized in the same way. <br>  Therefore, we continue to improve the multi-level approach to protecting the user and regularly release new technologies, such as <a href="http://whitelist.kaspersky.ru/">Whitelist</a> , <a href="http://eugene.kaspersky.com/2012/02/27/halt-who-goes-there-or-remedy-3/">Application Control</a> , <a href="http://eugene.kaspersky.ru/2012/09/28/default-deny-application-control/">Default Deny</a> , <a href="http://eugene.kaspersky.com/2012/08/14/safe-money-online-banking-security/">Safe Money</a> .  This allows Kaspersky Lab products to provide reliable comprehensive protection against computer threats, including new and previously unknown ones. </div><p>Source: <a href="https://habr.com/ru/post/172293/">https://habr.com/ru/post/172293/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../172279/index.html">Non-obvious ways to protect against malware</a></li>
<li><a href="../172281/index.html">Philips opens development program for Hue bulbs</a></li>
<li><a href="../172283/index.html">Ejabberd Crutches protection</a></li>
<li><a href="../172285/index.html">Implementing long-term arithmetic in C ++</a></li>
<li><a href="../172289/index.html">Large-scale update of the mobile version of 2GIS</a></li>
<li><a href="../172295/index.html">Mysterious FrontCache</a></li>
<li><a href="../172299/index.html">Record and modify sound in the browser</a></li>
<li><a href="../172301/index.html">How graphics kill gameplay</a></li>
<li><a href="../172307/index.html">Registration of rights to the software without registering itself</a></li>
<li><a href="../172309/index.html">BAT: a wireless flying mouse that can prevent carpal tunnel syndrome</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>