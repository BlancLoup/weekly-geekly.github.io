<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Machine training in sewers (in a good way)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sewage ... It would seem that there may be related to technology. Well, maybe some kind of pollution sensor. But it turns out, no. Everything is much ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Machine training in sewers (in a good way)</h1><div class="post__text post__text-html js-mediator-article">  Sewage ... It would seem that there may be related to technology.  Well, maybe some kind of pollution sensor.  But it turns out, no.  Everything is much more interesting.  Indeed, machine learning helps to identify anomalies and deviations in the wastewater control system.  Details under the cut! <br><br><img src="https://habrastorage.org/webt/qe/qm/yi/qeqmyi3ugisrkvwcowxfeb_ssua.jpeg"><a name="habracut"></a><br><br><h2>  Overview </h2><br>  The following code example presents an innovative method for detecting anomalies and expected deviations using the <a href="https://docs.microsoft.com/ru-ru/azure/machine-learning/team-data-science-process/apps-anomaly-detection-api">Microsoft Anomaly Detection API</a> and binary classification that supports filtering of time series. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Situation </h2><br>  <a href="http://www.carlsolutions.com/">Carl Data Solutions</a> develops <a href="http://www.flowworks.com/">Flow Works</a> software tools used by municipal organizations to monitor wastewater infrastructure.  These tools receive data from a variety of sensors that measure indicators such as water consumption, speed and depth. <br><br>  Sensors sometimes fail or behave in an unpredictable manner, which causes deviations of the indicators.  Since prognostic models are created on the basis of readings obtained from sensors, their deviations can reduce the accuracy of the model.  Currently, municipal organizations using Carl Data Flow Works tools resort to the services of consultants who manually check data from all sensors and change the values ‚Äã‚Äãthat appear to be erroneous to eliminate such inaccuracies. <br><br>  <b>Sample daily meter readings with marked anomalies</b> <br><br><img src="https://habrastorage.org/webt/2e/nw/in/2enwin5noa5fjbfemkxjle6scea.png"><br><br>  To avoid additional time and cost, Carl Data decided to create an anomaly detection model that would automate the detection of such errors. <br><br><h2>  Problem </h2><br>  Since sensor errors occur infrequently, the training sets that are based on the logs selected by Carl Data contained much more ‚Äúaccurate‚Äù values ‚Äã‚Äãthan ‚Äúinaccurate‚Äù ones.  In case of uneven distribution of training samples, traditional binary classifiers in some cases may not detect sensor errors due to the large number of positive examples.  Often, uncontrolled algorithms for detecting deviations of dynamic series are used to detect irregular flow. <br><br>  However, uncontrolled deviation detection systems such as the Twitter <a href="https://github.com/twitter/AnomalyDetection">Anomaly Detection Package</a> or Microsoft <a href="https://docs.microsoft.com/ru-ru/azure/machine-learning/team-data-science-process/apps-anomaly-detection-api">Anomaly Detection API</a> , although coping with the task of detecting irregular flows, still cannot distinguish the expected deviations in behavior (for example, peak values ‚Äã‚Äãin the event of flooding) from sensor errors.  In addition, these APIs only perform batch classification, which takes too much time to work effectively in real time. <br><br><h2>  Interaction </h2><br>  Microsoft is helping Carl Data develop an anomaly detection model that can identify various types of abnormalities and transfer it to the production environment via event concentrators and PowerBI. <br><br><h4>  Anomaly detection method of machine learning </h4><br>  <b>Model 1. Deviation detection (unsupervised algorithm)</b> <br><br><ol><li>  Read the raw statistics from the speed sensor. </li><li>  Read the tagged anomalies from the selected data for the speed sensor. </li><li>  Send the raw data to the Microsoft Anomaly Detection API to mark deviations. </li><li>  Evaluate the deviation model based on the results of the Anomaly Detection API, comparing the results obtained with its help with ‚Äúmanual anomalies‚Äù. </li></ol><br>  <b>Model 2. Binary Classifier (Controlled)</b> <br><br><ol><li>  Read the raw statistics from the speed sensor. </li><li>  Read and merge the tagged anomalies from the selected data for the speed sensor. </li><li>  Create a history window for the previous four readings based on data from the speed sensor at each point in time. </li><li>  Create a training and test set by randomly separating data in the history windows. </li><li>  Teach a random forest classifier using training data. </li><li>  Measure the performance of a random forest based on test data. </li></ol><br>  <b>Model 3. Hybrid classifier (differentiation of anomalies and deviations)</b> <br><br><ol><li>  Read the raw statistics from the speed sensor. </li><li>  Read the tagged anomalies from the selected data for the speed sensor. </li><li>  Send the raw data to the Microsoft Anomaly Detection API to mark deviations. </li><li>  Create a history window for the four previous values ‚Äã‚Äãof the readings obtained from the speed sensor for each moment in time, using only the values ‚Äã‚Äãmarked as deviations. </li><li>  Create a training and test set by randomly separating data in the history windows. </li><li>  Teach a random forest classifier using training data. </li><li>  Measure the performance of a random forest based on test data. </li><li>  Measure the performance of a random forest for the entire dynamic speed range except for the training set. </li></ol><br><h4>  Integration method </h4><br><img src="https://habrastorage.org/webt/zf/mz/hd/zfmzhdaozsrzpyu9j_fr6wlgcg0.jpeg"><br><br><ol><li>  Transfer data from the channel to the Anomaly Detection event hub by setting the window size to n. </li><li>  Mark new events as ‚Äúanomaly‚Äù or ‚Äúnot anomaly‚Äù using the model described in the last section. </li><li>  Transfer the tagged channel data to the visualization event hub. </li><li>  Use stream analytics to process data from a visualization event hub. </li><li>  Import stream analytics data into PowerBI to visualize the tagged anomalies. </li></ol><br><h4>  results </h4><br>  In the process of interaction, we created three models, combining the Microsoft Anomaly Detection API with a set of random forests and logistic regression to reveal a sensor error. <br><br>  Although the Anomaly Detection API reveals identifier deviations in order to classify anomalies, in the Carl Data dataset the difference between anomalies and a regular flow was linearly differentiable enough to obtain a comparable qualitative result when using a binary random forest classifier, and in combination with the Anomaly Detection API . <br><br>  In some cases, analysts can manually tag as abnormal values ‚Äã‚Äãwithin the abnormal peak of the sensor.  Anomaly Detection API cannot correctly label such values.  However, if the sensor error is presented more clearly and the anomalies are not sufficiently linearly differentiable, the hybrid method gives more generalized results than using only the binary classifier. <br><br>  The selected model has the following performance characteristics with a high degree of accuracy (99%) and full return (100%): <br><br>  <b>Measuring model performance using the SciKit performance test module</b> <br><br><img src="https://habrastorage.org/webt/en/nk/k1/ennkk1bhvnmb50grkg3mklcjkyo.jpeg"><br><h2>  Code </h2><br>  For source code and notes on using the described method, see <a href="https://github.com/aribornstein/Channel-Sensor-Error-Detection">GitHub</a> . <br><br><h2>  Use cases </h2><br>  The technique outlined in this code example is important from the point of view of the application of machine learning of time series in such sparsely covered areas as wastewater control. <br><br>  In addition, as the Internet of Things develops and the transition from data aggregation to predictive analytics, it becomes increasingly important to distinguish between anomalies caused by sensor errors and anomalies representing expected deviations.  The approach outlined in this code example is recommended in these cases. </div><p>Source: <a href="https://habr.com/ru/post/345442/">https://habr.com/ru/post/345442/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345432/index.html">10 quotes HolyJS 2017 Moscow</a></li>
<li><a href="../345434/index.html">Difficult about the simple: how to measure the opening time of the page and not make enemies</a></li>
<li><a href="../345436/index.html">How to draw a Christmas tree in MIDI</a></li>
<li><a href="../345438/index.html">Translation: Setting up your applications and games for devices with a long screen</a></li>
<li><a href="../345440/index.html">3CX V15.5 SP3 alpha and 3CX Session Border Controller Update</a></li>
<li><a href="../345446/index.html">Create a Q & A bot: step by step instructions</a></li>
<li><a href="../345448/index.html">Common examples of using advanced JQL queries</a></li>
<li><a href="../345450/index.html">Technoporn with WebAssembly</a></li>
<li><a href="../345452/index.html">Machine learning and chocolates</a></li>
<li><a href="../345454/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ294 (December 18 - 24, 2017)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>