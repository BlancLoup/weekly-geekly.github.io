<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>From Amazon EC2 to Mail.ru Infra: Test Cloud VPS (Linux)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Domestic companies have recently competed with the big three cloud providers - Amazon, Google and Microsoft, although there are few significant player...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>From Amazon EC2 to Mail.ru Infra: Test Cloud VPS (Linux)</h1><div class="post__text post__text-html js-mediator-article">  Domestic companies have recently competed with the big three cloud providers - Amazon, Google and Microsoft, although there are few significant players in our market.  These are mostly relatively small projects, traditional hosters (including large ones) and / or operators of commercial data centers offering clouds in the appendage to the traditional package of services. <br><br>  The situation began to change with the advent of Mail.ru Cloud Solutions ( <a href="https://mcs.mail.ru/">MCS</a> ): the Russian provider offers customers virtual infrastructure, object and block storages and a number of other micro services. <br><br><img src="https://habrastorage.org/webt/5w/vz/o1/5wvzo1nkfv20kngrlx59q5g4rnq.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this series of articles, in addition to the main foreign ones (Amazon, Google, Microsoft), we take the notable Russian competitors Mail.ru: Selectel, Servers.ru and Rostelecom, although they definitely lose Mail.ru in the sense of a set of available services - such a rich offer which of the local players do not. <br><br>  First of all, let's evaluate cloud VPS on Linux, we will compare Infra from Mail.ru with Amazon EC2, Google Compute Engine, Microsoft Azure VM and services of the already mentioned domestic companies: Selectel, Rostelecom and Servers.ru, a local branch of Servers.com with the same offer . <br><a name="habracut"></a><br><h2>  Nuances of registration, payment and support </h2><br>  Domestic services prefer to work on a prepaid basis: we first replenish the balance of the personal account, then we get services.  This is due to the very difficult law enforcement practice of debt collection from Russian individuals.  And it will be difficult to recover money from other companies. <br><br>  Major Western services have accepted postpay, and in the event of an account being hacked, you can ‚Äúfly in‚Äù into space amounts in a very short time.  <a href="https://geektimes.ru/post/247794/">Here's an interesting case: the guy hijacked an AWS account and vigorously ‚Äúsounded‚Äù 12 kilobakks of debt</a> for using cloud virtual servers (save us Turing so ‚Äúget there‚Äù!).  The victim of the goodwill of the company forgiven the debt, but could recover. <br><br>  From here, by the way, there are problems with registration - to a new AWS account (Google and Microsoft are about the same), individuals are required to bind a bank card.  If you have a Russian bank, your account may be "suspended."  In this case, his work will not be automatically restored - you need to write to tech support.  There, in response, they will be asked to present a lot of proofs - and almost a <s>certificate of passing a medical examination</s> center from their place of work: <br><br><img src="https://habrastorage.org/webt/a-/wt/38/a-wt38_26auhuye0pcd7o9l5k7o.jpeg"><br><br>  For a company, payment for a service in a foreign jurisdiction is also not easy if the cloud provider does not have a Russian legal entity and is not particularly interested in our market. <br><br>  And the last moment: the prices for services of large international cloud services are pegged to a hard currency, which can be painful in conditions of an unstable ruble exchange rate.  Theoretically, you can pay and rubles, but still at the rate and usually at the internal - more profitable in dollars at the rate of your bank (this is from practice).  Another reason to choose a domestic service, the good is what to choose. <br><br><h2>  Prices </h2><br>  The most interesting, of course, is the price.  Amazon EC2 pays for computing resources, storage, allocated IP addresses, and in some cases data transfer.  There are three payment options: on-demand instances, reserved and spot instances.  Amazon EC2 price list can be found <a href="https://aws.amazon.com/ru/ec2/pricing/">here</a> .  For example, in the data centers of Ohio (USA), a four-processor virtual machine will cost you from 11.26 rubles.  up to 50.66 rub.  (from $ 0.2 to $ 0.9) per hour + tax (prices in Amazon prices are indicated without tax).  Dedicated storage for 1 GB EBS SSD (gp2) volumes in the Ohio data center costs 5.63 rubles.  ($ 0.10) per month, but there are <a href="https://aws.amazon.com/ru/ebs/pricing/">other options</a> . <br><br>  <i>* for calculations, the exchange rate of the Central Bank of the Russian Federation as at January 30, 2018 was used.</i> <br><br>  Microsoft has a similar <a href="https://azure.microsoft.com/ru-ru/pricing/details/virtual-machines/linux/">pricing policy</a> with pay for <a href="https://azure.microsoft.com/ru-ru/pricing/details/ip-addresses/">using IP addresses</a> and <a href="https://azure.microsoft.com/ru-ru/pricing/details/bandwidth/">transferring outgoing data</a> .  Prices for four-processor configurations range from 9.94 to 61.32 rubles per hour.  However, it seems that Microsoft is talking about honest processor cores, while Amazon in some configurations can provide, for example, two cores with hyper trading instead of four.  All new virtual machines have an operating system disk and a local (or ‚Äúresource disk‚Äù), for which <a href="https://azure.microsoft.com/ru-ru/pricing/details/managed-disks/">no fee is charged</a> . <br><br>  <a href="https://cloud.google.com/compute/pricing%3Fhl%3Dru">Google has</a> its own configuration besides standard ones.  The price of four-processor ranges between 7.98 rubles.  ($ 0.1418) and 13.33 rubles.  ($ 0.2368) per hour, but the choice of standard configurations is not rich.  There are also <a href="https://cloud.google.com/compute/docs/sustained-use-discounts%3Fhl%3Dru">discounts</a> for regular use, they are provided automatically when certain thresholds are reached.  Google‚Äôs price tag seems to be the lowest of the foreign trinity, but in each case it‚Äôs necessary to count, especially for serious projects with a predicted load. <br><br>  Let us turn to domestic providers.  Here it is better to use tariff calculators - it is easier to create an individual profitable price list.  The <a href="https://mcs.mail.ru/infra/">Infra from Mail.ru</a> practices monthly billing with per-minute payment, with an annual contract the provider offers a significant discount.  Prices for configurations are shown with VAT: 1 GB of memory = 190 rubles per month, 1 CPU = 510 rubles per month, 1 GB disk = 7 rubles per month.  Popular four-processor configurations cost 5430 rubles per month, or about 7.54 per hour. <br><br>  On Servers.ru, you can choose between sets of <a href="https://www.servers.ru/cloud">ready-made configurations</a> , prices are indicated per month and per hour, a disk and a certain amount of traffic are also included in the price ‚Äî the overrun is charged.  Currencies are different, since the data centers of the provider in different countries, but immediately there is a recalculation in rubles.  The four-processor configuration in the Moscow data center will cost from 3600 or 4800 rubles per month (in Russia, the company offers only two four-processor configurations) - 6 rubles or 8 rubles per hour. <br><br>  Selectel has a virtual private cloud (VPC) on the main site.  A virtual machine is built using a constructor, you can specify the desired amount of vCPU, memory, disk size and type, number of ip-addresses, etc. All prices are in rubles, VAT included.  A four-processor machine will rise from 3+ thousand to 7 thousand and above rubles per month, or approximately 4.17 and 9.72+ per hour, respectively. <br><br>  Rostelecom offers businesses (they do not cooperate with individuals) access to the national cloud platform - and for a change it even has a price list (prices are per day, daily <a href="https://moscow.rt.ru/data/doc/tariffs_virtualnyi_tsod.pdf">billing</a> depends on the volume of services). <br><br>  As you can see, the prices of domestic providers are generally lower than those of the western troika.  Because of the Russian dislike for clear prices, this is not very striking, but when it took us $ 3 to pay for Amazon or Microsoft services, ours did not have to pay a hundred rubles to a personal account.  Plus, our services (for example, Mail.ru) offer free instances.  At Amazon, they also have, but there are limits on the use there, which is not particularly clearer. <br><br>  Domestic services have a relatively small selection of hardware configurations of virtual machines.  Infra is a pleasant exception, and it is clear why: Mail.ru is a rather big company and it has seriously aimed at this market, it has enough opportunities. <br><br><h2>  SLA </h2><br>  All providers that generally do it, declare approximately the same availability factor - 99.98% of the time the service is operational.  These statements are based on statistics collected by the Uptime Institute, which shows that the data center availability level of TIER III is 99.982%. <br><br>  And since almost all providers use these data centers (this is the most running level), marketers are tempted.  In fact, this is a myth and practical readiness is theoretically immeasurable.  TIER levels relate to the topology of the engineering subsystems of the data center and business processes for the upper certification stage (operation, incident response, that's all).  From this point of view, the IT load simply ‚Äúconsumes power and generates heat that needs to be removed.‚Äù  In this sense, there is no difference between a server and another electric heater (joke). <br><br>  Practical readiness on the performance of the IT load (hardware + software) depends not least.  How to measure it?  No way yet.  Unless it is purely practical, i.e., on the basis of real statistics of exploitation.  Although if the provider‚Äôs service level agreement specifies the provider‚Äôs economic liability for failures, this is a good sign. <br><br><h2>  Check communication channels </h2><br>  For the test, we will take another virtual machine from a third-party relative to all experimental Russian data centers, which we will use as a client machine.  First of all, we check the bandwidth of the channel through pings in large and small packets, and so on - we take one configuration from all providers in order not to produce entities.  At first we will ping in one hundred small (64 bytes) and one hundred large (1 kilobyte) packets.  Packages do not fight (0% loss), but the response time (in the table) is slightly different.  In domestic services it is less, as expected. <br><br><img src="https://habrastorage.org/webt/ly/_v/oy/ly_voyklghvloocjel7cdvgroiu.png"><br><br>  Next is a test of downloading a file by each virtual machine: <br><br>  $ wget -O / dev / null - <a href="http://ftp.corbina.ru/pub/100Mb">http://ftp.corbina.ru/pub/100Mb</a> <br>  $ wget -O / dev / null - <a href="">http://cachefly.cachefly.net/100mb.test</a> <br>  $ wget -O / dev / null - <a href="">http://speedtest.london.linode.com/100MB-london.bin</a> <br><br><img src="https://habrastorage.org/webt/f7/b-/co/f7b-copeymqefsazm9yionfjmy8.png"><br><br>  Now check the speed using Iperf, this program works on the principle of client-server.  On the external to all experimental Russian (for the purity of the experiment) host, we start the server: <br><br> <code>$ iperf -s -p 9999</code> <br> <br>  Then we execute the command from each verified virtual machine (testing runs for 60 seconds): <br><br> <code>$ iperf -c server_ip -p 9999 -t 60</code> <br> <br><img src="https://habrastorage.org/webt/9y/io/u9/9yiou9hwolpz66vyp1hzxne1luc.png"><br><br>  Of course, this is not in-depth testing, which needs to be done at different times of the day, take a series of iterations, and so on, but even in such a primitive version it is obvious that domestic services from the runet are more accessible (less delay, higher throughput).  This is a plus in the treasury of our services.  Serious Russian providers go "nostrils to nostrils" - the difference is within the limits of statistical error. <br><br><h2>  We test using Hardinfo </h2><br>  On each virtual cloud server we run the Hardinfo benchmarks.  It is clear that synthetic tests demonstrate spherical VPS in vacuum and configurations that are identical in terms of computational capabilities give almost similar results without the possibility of choosing obvious leaders and outsiders.  But as a starting point when choosing, they are useful. <br><br><div class="spoiler">  <b class="spoiler_title">Benchmarks</b> <div class="spoiler_text">  CPU Blowfish is a performance test using a cryptographic algorithm developed by Bruce Schneier and implementing symmetric block encryption. <br>  CPU CryptoHash - calculation of cryptoresistant hash function. <br>  Fibonacci CPU - Fibonacci function calculation using recursive coding and parallel programming. <br>  CPU N-Queens - a test from the combinatorics, the solution of the chess problem of placing N queens on a chessboard the size of NxN cells so that no one queen could attack any other. <br>  FPU FFT is a test for fast calculation of the discrete Fourier transform. <br>  FPU Raytracing - ray tracing calculation for 3d rendering. <br></div></div><br>  The result is given in seconds (the smaller it is, the better) in all tests except CPU CryptoHash - there is MiB / sec and the more it is, the better: <br><br>  Configuration 1 (entry-level server): 1 CPU (2.3 - 2.7 GHz depending on the provider), 1 GB of RAM, 10 GB of storage (for servers.ru - 30 GB, Ubuntu 16.04. <br><br><img src="https://habrastorage.org/webt/co/az/3h/coaz3hp2rc0b6bfcnzgbpbzhdz8.jpeg"><br><br>  Configuration 2 (mid-level server): 2 CPU (2.3 - 2.7 GHz depending on the provider), 4 GB of RAM, 40 GB drive (servers.ru have 81 GB), Ubuntu 16.04. <br><br><img src="https://habrastorage.org/webt/hk/gx/h2/hkgxh2bfhjge5rijgqqqzdvncdw.jpeg"><br><br>  Configuration 3 (high-performance server): 8 CPU (2.3 - 2.7 GHz depending on the provider), 16 GB (for servers.ru - 32 GB, but for the test of the processor this is unprincipled) of RAM, 100 GB drive (at servers.ru - 322 GB), Ubuntu 16.04. <br><br><img src="https://habrastorage.org/webt/ii/lc/i3/iilci3myco_a1rojmwndl2huyu8.jpeg"><br><br>  According to the synthetic test, all the machines showed expectedly close results - it does not reflect real workloads.  During operation, everything can be completely different.  Obviously, in the top configuration, large providers look better - including due to their wide capabilities.  They can afford a network of huge data centers and a greater variety of iron.  From Russian services only Mail.ru is close to them. <br><br><h2>  Compare drives </h2><br>  We test drives in a separate virtual machine with simple tasks for sequential reading and writing.  Both Servers.ru and Mail.ru did not have configurations with HDDs - while Mail.ru has drives from distributed ceph storage.  In terms of sequential read speed, they are roughly like SSDs, and in sequential write speeds they are like smart HDDs. <br><br><img src="https://habrastorage.org/webt/8e/eq/ps/8eeqps3kjcskumgcfdskj1puq40.jpeg"><br><br>  In comparison, conventional solid-state drives, premium (with payment for IOPS, for example) options were not considered. <br><br><h2>  findings </h2><br>  On the whole, the virtual cloud servers of Mail.ru and other domestic providers are not inferior to the offers made by Western competitors.  Of course, the world's major players can offer more diverse configurations, but their prices are higher, and problems may arise with registration and payment (especially if you are a legal entity, and the provider does not have a Russian legal entity). <br><br>  Another important point: some Russian providers have data centers in the West, but the big three foreign data centers do not have data centers in our country.  This does not in the best way affect the availability of resources from the Russian segment of the Internet (response time increases) and could create problems for the owner to process and store Russian personal data - current legislation requires the server to be located in the country.  And now many companies store and process PD: for example, employee and customer data. <br><br>  In the next articles of the cycle, we will test Windows servers, object storages and other services. </div><p>Source: <a href="https://habr.com/ru/post/348132/">https://habr.com/ru/post/348132/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348122/index.html">Issue # 9: IT training - current issues and challenges from leading companies</a></li>
<li><a href="../348124/index.html">Why most people do not use two-factor authentication?</a></li>
<li><a href="../348126/index.html">Can I use the CQRS pattern in GO?</a></li>
<li><a href="../348128/index.html">R as a lifeline for the system administrator</a></li>
<li><a href="../348130/index.html">[DotNetBook] Stackalloc: forgotten C # command</a></li>
<li><a href="../348134/index.html">Chromium: other errors</a></li>
<li><a href="../348136/index.html">The most correct implementation of splash screen</a></li>
<li><a href="../348138/index.html">Isometric depth sorting for moving platforms</a></li>
<li><a href="../348140/index.html">Four ways to fool a deep learning neural network</a></li>
<li><a href="../348142/index.html">The history of hacking a single WordPress plugin - or how you allow vulnerabilities in your projects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>