<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Facebook Web Injection for delivering Android mobile bot</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="An application called iBanking belongs to the Android malware class. Being installed on the device, it can spy on the user, fixing his activity. iBank...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Facebook Web Injection for delivering Android mobile bot</h1><div class="post__text post__text-html js-mediator-article">  An application called <b>iBanking</b> belongs to the Android malware class.  Being installed on the device, it can spy on the user, fixing his activity.  iBanking has many interesting features, including the ability to capture incoming and outgoing SMS messages, redirect incoming voice calls and even capture audio content using the device‚Äôs microphone.  As the well-known Kafeine <b>writer</b> pointed out in his <a href="http://malware.dontneedcoffee.com/2013/12/nitmo-no-just-ibanking-used-by-the.html">blog</a> , this mobile application was put up for sale in one of the underground forums and was used by several banking Trojan programs to bypass two-factor authentication based on confirmation codes.  This enhanced security mode for monitoring operations is called mTAN or mToken.  Today, mTAN is used not only for banking operations, but also for working with services such as Google, Facebook and Twitter. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f1c/534/8e0/f1c5348e040fd5f7c0d69a818b0f01da.png"><br><br>  Recently, RSA <a href="https://blogs.rsa.com/ibanking-mobile-bot-source-code-leaked/">published</a> information according to which the source code of this malicious program was leaked to one of the underground forums.  Leakage of this data, among which were the source texts of the bots control panel, as well as the builder itself, can help attackers to redirect iBanking to other goals.  Due to free access to the source code, we expected that the attackers would use iBanking more actively.  Unfortunately, these expectations were met. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  Thanks to our monitoring of the activity of the <a href="http://www.virusradar.com/en/Win32_Qadars/detail">Win32 / Qadars</a> banking Trojan program, information about which was previously published in our <a href="http://habrahabr.ru/company/eset/blog/207216/">blog</a> , we were able to obtain information about a new type of web injection and mobile bot, which is installed with its help.  This web injection uses JavaScript to compromise the Facebook web page.  It allows attackers to lure the unsuspecting user to the installation page of the mobile component of the malicious program. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/218/739/aae/218739aaeb099e03937807d085b3ad66.png"><br>  Fig.  Web injection Qadars, which is downloaded from a remote server and is intended for implementation on the Facebook page. <br><br>  As soon as a user logs into his Facebook account, the malicious code attempts to embed the above script on a web page, which results in the next window being displayed to the user. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bc0/c74/a23/bc0c74a23d0445336da7b970638298a3.png"><br>  Fig.  A fake page requesting the installation of a mobile application. <br><br>  After the user enters his phone number, he is redirected to the next page (if you select Android OS in the menu). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/944/38e/30f/94438e30fa3378e44911a3eeef477840.png"><br>  Fig.  Delivery page links to install the mobile application. <br><br>  If the SMS with the link was not delivered to the user's mobile device, it can also use the direct download link, or use the installation instructions below. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bed/997/67f/bed99767ff55ba0db8e0c8bbd300d3c8.png"><br><br>  A similar method of installing a mobile malware is already quite widespread, but earlier we met it when introducing JavaScript into online banking pages.  It should be noted that a similar way to compromise the Facebook webpage is also quite effective in deceiving inattentive or new users of this social network who have not yet used the real two-factor authentication and the Facebook mobile application to distinguish it from counterfeit. <br><br>  The iBanking mobile bot, which attackers recommend installing to the user as a legitimate application, is discovered by ESET as <a href="">Android / Spy.Agent.AF</a> .  Compared with previously detected mobile malware such as <a href="http://krebsonsecurity.com/2013/08/a-closer-look-perkele-android-malware-kit/">Perkele</a> , this bot demonstrates the implementation of more complex functions.  It can be used in conjunction with any malware that specializes in introducing malicious code into web pages (web injection), and is also interested in bypassing the two-factor authentication mechanism (redirecting mTAN SMS messages). <br><br>  As stated in our <a href="http://habrahabr.ru/company/eset/blog/207216/">previous post</a> , the mobile component Perkele has already been used by attackers for campaigns involving the Win32 / Qadars malware.  This was done to bypass the two-factor authentication mechanism when compromising online banking sites.  Now we are seeing that attackers have also started using the iBanking bot.  This situation did not come as a surprise to us, since we know that these web injections, used by Qadars operators, were bought in underground forums and are not tied to any type of platform.  This does not prevent other attackers from acquiring this mobile bot to use it for their own purposes.  In addition, in the future, you can predict the emergence of mobile components aimed at other popular Internet services. <br><br>  Many banking Trojans use mobile components to support their operations.  Such mobile components are ZitMo, SpitMo, Citmo, Perkele, as well as iBanking detected.  The last two representatives were not tied to a specific banking trojan, but were put up for sale in various underground forums.  Such an approach led to <i>a</i> wider spread of the practice of circumventing two-factor authentication, since now the developers of Trojan programs can not develop a mobile bot, but simply buy it from other intruders. </div><p>Source: <a href="https://habr.com/ru/post/219777/">https://habr.com/ru/post/219777/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../219765/index.html">Cryptofon from InfoTeKS and Yota</a></li>
<li><a href="../219767/index.html">New image recognition algorithm from Google is able to recognize CAPTCHA with an accuracy of 99.8%</a></li>
<li><a href="../219769/index.html">Crank English with LinguaLeo: create thematic dictionaries, train your memory and train in a group!</a></li>
<li><a href="../219771/index.html">Service capable of rating your employees and business</a></li>
<li><a href="../219773/index.html">Smart watch do it yourself for 1500 rubles. Part 3 - the program on MK</a></li>
<li><a href="../219779/index.html">Sharing code between WP, Win8. Part 2</a></li>
<li><a href="../219781/index.html">Google received a patent for contact lenses with a video camera.</a></li>
<li><a href="../219783/index.html">Chrome Remote Desktop - now connect to PC and from Android smartphone</a></li>
<li><a href="../219787/index.html">A graduate student from Berkeley restored the look of a plant that lived 375 million years ago.</a></li>
<li><a href="../219789/index.html">Migration of MSSQL database versions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>