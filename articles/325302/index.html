<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Necurs, one of the largest botnets in the world, received a DDoS module</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Necurs botnet is known as one of the largest bots in the world. Its owners use the power of their offspring to send a huge number of spam messages. Th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Necurs, one of the largest botnets in the world, received a DDoS module</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a1c/8f4/286/a1c8f42868bc4f0287c2d3c03ddd0f74.jpg"><br><br>  Necurs botnet is known as one of the largest bots in the world.  Its owners use the power of their offspring to send a huge number of spam messages.  Their volume is so large that the work of Necurs noticeably affects the total size of e-mail traffic worldwide.  Generally speaking, Necurs is not just a spamboot, it is a dangerous enough malware that infects vulnerable systems, pulling up the main module of the botnet and the corresponding modules. <br><br>  Necurs has been around for several years.  During this time, he has become the object of research for many information security specialists.  The experts were able to find out what vulnerabilities the attacking part of the botnet uses and what protocol is used by the spam module.  But the platform itself is not static, it is changing and improving. <br><a name="habracut"></a><br>  About six months ago, Anubisnetworks specialists noticed that Necurs now works not only with port 80, but also with other ports that belong to a completely different data transfer protocol.  Here is an example of analyzing Necurs traffic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/8ea/24f/c8f/8ea24fc8f05c89353cd4a74587693603.png"><br><br>  Studying this aspect, the company's specialists were able to understand that, in fact, the botnet was activated in order to install a module in the affected systems that provides Necurs with the ability to conduct DDoS attacks. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d4c/c26/04a/d4cc2604a1d705e377de74131c06ff58.png"><br><br>  In the first case, the installation of a spam module, which is well known to specialists.  There is a mention of C2 addresses that are associated with new spam campaigns.  But in the second case, the parameters of the hitherto unknown module that communicates with the server through port 5222 are specified. <br><br>  The approximate ‚Äúrelease date‚Äù of this module is August 23, 2016.  True, there is a possibility that this was a preliminary version, replaced by a final one. <br><br>  Campaign staff downloaded the module and conducted reverse engineering in order to understand what it is.  At first glance, this is a simple SOCKS / HTTP module.  But if you look better, it becomes clear that this module has the ability to work with HTTP and UDP requests, which are put in an infinite loop.  Accordingly, it becomes clear that this module is designed to implement DDoS attacks. <br><br>  By the way, the botnet is really big - there are <a href="http://blog.anubisnetworks.com/blog/monitoring-necurs-the-tip-of-the-iceberg">more than a million</a> infected active elements in this network.  With this size it is a very convenient option for conducting DDoS attacks.  Some infected network elements have been part of it for more than two years.  So long the botnet lasted thanks to the caution of its owners, who carefully dispose of the received features. <br><br>  As soon as the module is loaded into the victim system.  The following actions are performed: <br><br>  * There is a parsing of parameters and settings; <br><br>  * A database of internal IP addresses of the system is being collected, as well as an external database; <br><br>  * Network bandwidth is determined; <br><br>  * Determined random port; <br><br>  * A botnet tries to find out if the main system is hidden behind a NAT or not; <br><br>  * If not, the bot starts the SOCKS / HTTP service for an arbitrary port greater than 1024. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/385/3b4/f44/3853b4f440ddea46cd95d551fe4e0e8a.png"><br><br>  After initialization, the bot tries to connect to the current C2 every 10 minutes.  He does this until the operators give the command to stop. <br><br>  In addition, the botnet is equipped with a SOCKS / HTTP module, which allows platform operators to use the compromised elements of the botnet as a proxy (HTTP, SOCKSv4 and SOCKSv5 protocols).  Work with a proxy is conducted in two modes: direct proxy and proxy backconnect. <br><br>  As for the first mode, here the principle of operation is simple: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ba/fe9/21c/8bafe921cf8ee6829cb3c3f782474416.png"><br><br>  But working in this mode is possible only if the infected system is not hidden behind NAT or is not protected by a firewall.  And such systems are literally units. <br><br>  As for the proxy backconnect mode, everything is more complicated. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a7/490/8ce/0a74908ce0431e3c2d69beb5ca40ff30.png"><br><br>  But working in this mode is possible even if the infected system is behind NAT or a firewall.  In this case, you can connect to the internal resources of the network, of which the infected system is a part.  Moreover, the connection is from the system itself.  Another way to work with such proxies is to constantly change IP addresses. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e7a/f08/c21/e7af08c21b7e19c3989f2a3ed4365f4c.png"><br><br><h3>  DDoS module </h3><br>  But the most interesting thing is not a proxy, but a new DDoS module.  It provides for the possibility of conducting basic attacks of two types.  Despite the fact that there are no tricks like methods of enhancing the attack, the scale of the bot allows its operators to do without tricks. <br><br>  When receiving a command from a botnet operator, it attacks a specific target using HTTP or UDP flood, as indicated above. <br><br>  HTTP works in 16 parallel request streams. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e03/cad/771/e03cad771c5c51bd4c1c11fc93e130d6.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/628/534/8f7/6285348f734a6e3dc29f62ad71802517.png"><br><br>  The request is formed as follows. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d33/c70/3f2/d33c703f2cbf879db5fe82a24c31af02.png"><br><br>  As for UDP, here everything is somewhat different - a botnet sends packets with a radome size from 128 to 1024 bytes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f7e/df5/a9c/f7edf5a9c6c38c99807285c3c35d1604.png"><br><br>  So far, no DDoS attacks using Necurs have been fixed.  But such attacks are possible at any time.  But Necurs is even more than Mirai, with which the attackers attacked several large telecommunications organizations in different countries of the world.  True, some experts believe that the DDoS module in Necurs is not intended for carrying out custom attacks, but for the own needs of botnet operators, for example, to attack competitors' resources. <br><br> <a href="https://www.king-servers.com/servers/antiddos/%3Futm_source%3Dhabrapost%26utm_campaign%3Dantiddos20discount%26utm_medium%3Dcpc"><img src="https://habrastorage.org/files/a73/b3e/f99/a73b3ef990e44924a5c8d274a39d8235.jpg"></a> </div><p>Source: <a href="https://habr.com/ru/post/325302/">https://habr.com/ru/post/325302/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325292/index.html">Kazakhstan: How I helped to submit 100 forms of tax reporting. Start 200 form</a></li>
<li><a href="../325294/index.html">SMS and Email Notifications and Mailings in MyTaskHelper Online Designer</a></li>
<li><a href="../325296/index.html">Experience in developing an automated proctoring system to confirm the results of online exams</a></li>
<li><a href="../325298/index.html">An overview of hash-opening tools: John the Ripper password cracker and MDCrack</a></li>
<li><a href="../325300/index.html">Certificates from StartCom and WoSign finally turned into a pumpkin</a></li>
<li><a href="../325304/index.html">How we ported the software / hardware solution from SPARC Solaris to AMD64 Linux and virtualized it all</a></li>
<li><a href="../325308/index.html">Functional C #</a></li>
<li><a href="../325310/index.html">Development ‚Üí Kazakhstan: How I helped to submit 100 forms of tax reporting. Continuation 300 form</a></li>
<li><a href="../325312/index.html">The right to oblivion does not apply to data in business registers: decision of the Court of Justice of the European Union of March 9, 2017</a></li>
<li><a href="../325316/index.html">MySQL sample rotation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>