<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We saw a web demo - Wavescroll</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will try to lucidly talk about the process of creating the Wavescroll demo . 



 About the code in the article 
 The goal of this a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We saw a web demo - Wavescroll</h1><div class="post__text post__text-html js-mediator-article">  In this article I will try to lucidly talk about the process of creating the <a href="http://codepen.io/suez/full/wMOVXz">Wavescroll demo</a> . <br><br><img src="http://i.imgur.com/MXoOiZM.jpg" alt="image"><br><a name="habracut"></a><br><h4>  About the code in the article </h4><br>  The goal of this article is to try to teach people how to implement various non-trivial effects, without relying all their lives on ready-made plugins and similar solutions for every sneeze.  The code in the demo (like the article itself) is written in a straightforward and very intelligible way (hopefully), without using a lot of superfluous things that are now full of all possible tutors.  There is no ES6, webcam, reakta, modular systems and other things.  You do not need to sit for 5-15 minutes on the command line, setting various dependencies for the environment, so that you can finally bring the coveted Hello World to the screen.  We will write "clumsy" code, use jQuery because it is understandable to almost anyone who has ever worked with javascript, and in the end we get something that you can touch. <br><br>  All the demos I create on codepen, where various libraries and preprocessors are connected with a couple of clicks and you only need to write code. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Prehistory </h4><br>  It all started with the fact that on the Internet, I came across a wonderful site jetlag.photos, which struck me with its swipe background effect (hold down the mouse anywhere and drag).  Immediately there was a desire to realize a clone without peeping "under the hood."  As it turned out later, even if I wanted to, I would not be able to extract any useful information from devTools, because everything was implemented on the canvas.  And digging into compressed &amp; aggregated canvas code is a perversion.  So I started to cut the demo, guided only by what I see on the screen, using the standard html + css + js bundle (I still‚Äôm not really friends with the canvas). <br><br><h4>  We start </h4><br>  First we need to create a fullscreen container that will contain blocks of backgrounds inside. <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ws-pages"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ws-bgs"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ws-bg"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ws-bg"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ws-bg"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ws-bg"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ws-bg"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  All backgrounds are nested in an additional block, because then we still have a block for the texts.  Now we stylize them: <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.ws</span></span> { &amp;-pages { <span class="hljs-attribute"><span class="hljs-attribute">overflow</span></span>: hidden; <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: relative; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">100vh</span></span>; //     100%   } &amp;<span class="hljs-selector-tag"><span class="hljs-selector-tag">-bgs</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: relative; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">100%</span></span>; } &amp;<span class="hljs-selector-tag"><span class="hljs-selector-tag">-bg</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">100%</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-size</span></span>: cover; <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>: center center; //  ,  ,     &amp;:after { <span class="hljs-attribute"><span class="hljs-attribute">content</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>: table; <span class="hljs-attribute"><span class="hljs-attribute">clear</span></span>: both; } }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">About CSS</b> <div class="spoiler_text">  As you already noticed, I use a preprocessor.  In this case, this is SASS with the SCSS syntax. <br></div></div><br>  Now we need to create parts of the backgrounds, add them to the appropriate blocks and style them.  Our task is to make all the pieces look like a single block, the background of which is stretched using background-size: cover and centered.  For this, an additional block will be added to each part, to which the background image will be displayed.  Each internal block will occupy 100% of the screen width and shift to the left with each step, so that the whole picture will turn out. <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.ws-bg</span></span> { &amp;__part { <span class="hljs-attribute"><span class="hljs-attribute">overflow</span></span>: hidden; //           <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: relative; <span class="hljs-attribute"><span class="hljs-attribute">float</span></span>: left; //       <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">100%</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">cursor</span></span>: grab; <span class="hljs-attribute"><span class="hljs-attribute">user-select</span></span>: none; //      &amp;-inner { <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: absolute; <span class="hljs-attribute"><span class="hljs-attribute">top</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; // left      js <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: <span class="hljs-number"><span class="hljs-number">100vw</span></span>; //     100%   <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">100%</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-size</span></span>: cover; <span class="hljs-attribute"><span class="hljs-attribute">background-position</span></span>: center center; } } }</code> </pre><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $wsPages = $(<span class="hljs-string"><span class="hljs-string">".ws-pages"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bgParts = <span class="hljs-number"><span class="hljs-number">24</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     24 . var $parts; function initBgs() { var arr = []; var partW = 100 / bgParts; //   ,  % for (var i = 1; i &lt;= bgParts; i++) { var $part = $('&lt;div class="ws-bg__part"&gt;'); //    var $inner = $('&lt;div class="ws-bg__part-inner"&gt;'); //       var innerLeft = 100 / bgParts * (1 - i); //     $inner.css("left", innerLeft + "vw"); $part.append($inner); $part.addClass("ws-bg__part-" + i).width(partW + "%"); //           arr.push($part); } $(".ws-bg").append(arr); //        $wsPages.addClass("s--ready"); //      $parts = $(".ws-bg__part"); }; initBgs();</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">How it was implemented initially</b> <div class="spoiler_text">  Initially, I used: after for .ws-bg__part and looping in sass set the left for pseudo-elements.  But then I decided that the need to synchronize the variable number of parts in js and sass is a bad practice and did everything completely on js. <br></div></div><br>  So, at the end of the function, we add the class s - ready to the container.  We need this in order to remove the background from the .ws-bg blocks, which will initially be displayed with the background, so that the user can see the content before the javascript adds parts.  After the parts are added, the background of the main blocks is not needed, because they will not move.  So add the following for .ws-bg. <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.ws-bg</span></span> { .ws-pages.s--ready &amp; { //   .ws-pages.s--ready .ws-bg <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: none; } } //          <span class="hljs-selector-class"><span class="hljs-selector-class">.ws-bg</span></span>     <span class="hljs-selector-class"><span class="hljs-selector-class">.ws-bg__part-inner</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">c</span></span>  <span class="hljs-selector-tag"><span class="hljs-selector-tag">css</span></span> //  ,       <span class="hljs-selector-tag"><span class="hljs-selector-tag">css</span></span>   ,       </code> </pre><br><h4>  Move your mouse </h4><br>  It's time to hang up the handlers for the swipe mouse and implement page switching. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> curPage = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     var numOfPages = $(".ws-bg").length; //   //          var winW = $(window).width(); var winH = $(window).height(); //     ,      $(window).on("resize", function() { winW = $(window).width(); winH = $(window).height(); }); var startY = 0; var deltaY = 0; $(document).on("mousedown", ".ws-bg__part", function(e) { //       startY = e.pageY; //  Y      deltaY = 0; //       $(document).on("mousemove", mousemoveHandler); //      $(document).on("mouseup", swipeEndHandler); //     }); var mousemoveHandler = function(e) { var y = e.pageY; //   X     ,         var x = e.pageX; index = Math.ceil(x / winW * bgParts); deltaY = y - startY; //        moveParts(deltaY, index); //       }; var swipeEndHandler = function() { //   /  $(document).off("mousemove", mousemoveHandler); $(document).off("mouseup", swipeEndHandler); if (!deltaY) return; //     Y  ,     //  " "      ,      if (deltaY / winH &gt;= 0.5) navigateUp(); if (deltaY / winH &lt;= -0.5) navigateDown(); //    //      ,            changePages(); }; //         function navigateUp() { if (curPage &gt; 1) curPage--; }; function navigateDown() { if (curPage &lt; numOfPages) curPage++; };</span></span></code> </pre><br>  Add the functionality of the movement of parts, based on the variables deltaY and index (call the moveParts function inside the mousemoveHandler).  We need to make the effect of a two-sided ladder, when each part located on either side of the active part (the one on which the pointer is located) begins to move along the Y axis with a certain delay in the distance of the swipe (it is much more difficult to describe in words than to understand visually).  Moreover, the farther the part is from the active one, the less its ‚Äústep height‚Äù should be. <br><br><div class="spoiler">  <b class="spoiler_title">Just don't hit</b> <div class="spoiler_text">  I wrote the functional of movement of the parts late at night, when I should have been sleeping sweetly.  And then I was too lazy to refactor this whole thing according to the mind, so you just have to contemplate this horror.  If someone is able to fix it beautifully, I will be glad to help in the comments. <br><br>  I also experienced significant problems with an adequate description of what is happening, in fact everything is simpler and clearer there than it seems, I just now are not able to express my thoughts normally along the way = / <br></div></div><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> staggerVal = <span class="hljs-number"><span class="hljs-number">65</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      var staggerStep = 4; // ,          var changeAT = 0.5; //     function moveParts(y, index) { // y = deltaY; index -    var leftMax = index - 1; //       var rightMin = index + 1; //      //         var stagLeft = 0; var stagRight = 0; //        var stagStepL = 0; var stagStepR = 0; var sign = (y &gt; 0) ? -1 : 1; //    movePart(".ws-bg__part-" + index, y); //    for (var i = leftMax; i &gt; 0; i--) { //   " "      var step = index - i; // ,      //            var sVal = staggerVal - stagStepL; //   15    ,     1 //    .   . stagStepL += (step &lt;= 15) ? staggerStep : 1; //           ,         if (sVal &lt; 0) sVal = 0; stagLeft += sVal; //           var nextY = y + stagLeft * sign; // Y    //        deltaY ,        if (Math.abs(y) &lt; Math.abs(stagLeft)) nextY = 0; movePart(".ws-bg__part-" + i, nextY); //   } //          ,          for (var j = rightMin; j &lt;= bgParts; j++) { var step = j - index; var sVal = staggerVal - stagStepR; stagStepR += (step &lt;= 15) ? staggerStep : 1; if (sVal &lt; 0) sVal = 0; stagRight += sVal; var nextY = y + stagRight * sign; if (Math.abs(y) &lt; Math.abs(stagRight)) nextY = 0; movePart(".ws-bg__part-" + j, nextY); } }; function movePart($part, y) { var y = y - (curPage - 1) * winH; //  Y     //     (   ) //  : // TweenMax.to(%%, %   %, {%     %} //  Back easing    bounce.  bounce      TweenLite.to($part, changeAT, {y: y, ease: Back.easeOut.config(4)}); };</span></span></code> </pre><br>  As you have already noticed, I use GSAP (greensock) for animation.  I used to do most demos without special libraries for animation, because it‚Äôs very fun and great pumping, but this time I decided to feel sorry for myself when I realized that the requestAnimationFrame implementation of the bike would take a lot of time, because using css transition's is not going away .  This is due to the fact that we need a real-time animation, which will automatically pause the previous animation and launch the next one while moving, while maintaining smoothness. <br><br>  Now you need to write a function to change pages.  Everything is simple, we are essentially using a much lighter version of the moveParts function: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> waveStagger = <span class="hljs-number"><span class="hljs-number">0.013</span></span>; <span class="hljs-comment"><span class="hljs-comment">//                 13  //           ,        - ,         function changePages() { var y = (curPage - 1) * winH * -1; //      var leftMax = index - 1; var rightMin = index + 1; TweenLite.to(".ws-bg__part-" + index, changeAT, {y: y}); for (var i = leftMax; i &gt; 0; i--) { var d = (index - i) * waveStagger; //     ,        TweenLite.to(".ws-bg__part-" + i, changeAT - d, {y: y, delay: d}); } for (var j = rightMin; j &lt;= bgParts; j++) { var d = (j - index) * waveStagger; TweenLite.to(".ws-bg__part-" + j, changeAT - d, {y: y, delay: d}); } }; //         .        //              debounce. $(window).on("resize", function() { winW = $(window).width(); winH = $(window).height(); changePages(); });</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Alternative</b> <div class="spoiler_text">  If you do not need animation with a delay step, then the function can be reduced to 2 lines of code.  But I liked the delayed option more in terms of aesthetics. <br></div></div><br>  Now we can move the background with the mouse swipe.  An intermediate version of the demo can be found <a href="http://codepen.io/suez/pen/b7ccd9206454ccf62d17eef7a94db020">here</a> . <br><br><h4>  WaveSCROLL </h4><br>  Next, we hang handlers on the mouse wheel and arrows in order to turn the demo into a full-fledged implementation of one page scroll.  Well, and at the same time it will be clear why this name was chosen (although it was not me who invented it, they helped me). <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,                  var waveBlocked = false; var waveStartDelay = 0.2; //    //    . DOMMouseScroll   FireFox $(document).on("mousewheel DOMMouseScroll", function(e) { if (waveBlocked) return; if (e.originalEvent.wheelDelta &gt; 0 || e.originalEvent.detail &lt; 0) { navigateWaveUp(); } else { navigateWaveDown(); } }); $(document).on("keydown", function(e) { if (waveBlocked) return; if (e.which === 38) { navigateWaveUp(); } else if (e.which === 40) { navigateWaveDown(); } }); function navigateWaveUp() { //     navigate ,            //            ,          ,    - if (curPage === 1) return; curPage--; waveChange(); }; function navigateWaveDown() { if (curPage === numOfPages) return; curPage++; waveChange(); }; function waveChange() { waveBlocked = true; //    var y = (curPage - 1) * winH * -1; for (var i = 1; i &lt;= bgParts; i++) { //         ,   var d = (i - 1) * waveStagger + waveStartDelay; TweenLite.to(".ws-bg__part-" + i, changeAT, {y: y, delay: d}); } var delay = (changeAT + waveStagger * (bgParts - 1)) * 1000; //       setTimeout(function() { waveBlocked = false; //       //        onComplete  gsap'e,        }, delay); };</span></span></code> </pre><br>  All main functionality is implemented. <br><br><h4>  Small optimization </h4><br>  After I climbed to watch this demo on the phone, I ran into significant problems in terms of performance during the swipe.  Then I immediately remembered that the motion handler (be it a mousemove or touchmove) should be slightly optimized.  For this, I will use requestAnimationFrame, aka rAF. <br><br><div class="spoiler">  <b class="spoiler_title">rAF?</b>  <b class="spoiler_title">WTF?</b> <div class="spoiler_text">  requestAnimationFrame is a special browser API created for animation and similar things.  Read more <a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">here</a> . <br></div></div><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,       ,           rAF  ,    window.requestAnimFrame = (function() { return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function(callback){ window.setTimeout(callback, 1000 / 60); }; })(); //   throttle ,       function rafThrottle(fn) { //      var busy = false; //     ,        return function() { //  ,     if (busy) return; //  ,     busy = true; //     fn.apply(this, arguments); //   //  rAF,     ,    requestAnimFrame(function() { busy = false; }); }; }; //   mousemove  rafThrottle var mousemoveHandler = rafThrottle(function(e) { //     });</span></span></code> </pre><br>  This optimization gave a noticeable performance boost on my Nexus 5, as it reduced the amount of computation and animation restarts with constant mouse / finger movement.  Yes, and on the desktop, too, everything looked better working (although there were no problems before, considering that the browser works from the integrated video card). <br><br>  As text titles are implemented, I will not paint, everything is pretty simple, reading the code will help you. <br><br>  But in general, that's all!  Links to the demo: <br><br>  Version <a href="http://codepen.io/suez/pen/wMOVXz">with editor</a> . <br>  <a href="http://s.codepen.io/suez/debug/wMOVXz">A fullscreen version without an iframe and pieces of codepen</a> - if you want to check on the phone, then open this version, others are bugging on touch devices. <br><br><div class="spoiler">  <b class="spoiler_title">So, stop, and the code for the touch devices?</b> <div class="spoiler_text">  The original demo supports touch devices.  There, in fact, only an additional handler on the touchmove is added, which does the same thing and a few more lines of code that are easy to find.  But I decided not to describe this part in the article, because even after optimizing, my demo significantly loses in performance on the phones (at least on my Nexus 5) to the original site, which runs on canvas.  Although it is still a good result for this effect. <br>  And besides, on mobile devices there are problems with black stripes on the edges of the parts of the background during movement.  This is due to the width in% and the combination of 3D transformations during the movement, because of which the sizes of the parts slightly change and shine through the pieces of the black background of the body. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">At last</b> <div class="spoiler_text">  This is my first article, so the quality is very lame.  Yes, and the demo is clearly not one of the best.  But I decided to write about this demo, because I did it only 10 days ago and remember well the course of my thoughts. <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/278181/">https://habr.com/ru/post/278181/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278171/index.html">Simple checksum calculation</a></li>
<li><a href="../278173/index.html">ASP.NET Core + Docker: Cooking Together</a></li>
<li><a href="../278175/index.html">Differences between Azure Resource Manager and Azure Service Manager - a developer‚Äôs perspective</a></li>
<li><a href="../278177/index.html">Azure-IaaS-Digest number 2 (February)</a></li>
<li><a href="../278179/index.html">Why technical debt is good</a></li>
<li><a href="../278183/index.html">Where and from whom to study robotics, big data management, high-quality software development</a></li>
<li><a href="../278185/index.html">"We will understand": Why not need to introduce complex products on their own</a></li>
<li><a href="../278187/index.html">Broadcast of TechNet Virtual Conference 2016 from Redmond, March 1-3</a></li>
<li><a href="../278189/index.html">Very smart WordPress blog with nginx + PHP-FPM + MariaDB + Varnish</a></li>
<li><a href="../278191/index.html">Speaking in plain language</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>