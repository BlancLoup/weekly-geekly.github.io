<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Customization of workflows in YouTrack. My experience tweaking YouTrack as HelpDesk</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I would like to tell you about my experience of setting ‚ÄúYouTrack as HelpDesk‚Äù . 

 Following the link that I indicated above, you will find more or l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Customization of workflows in YouTrack. My experience tweaking YouTrack as HelpDesk</h1><div class="post__text post__text-html js-mediator-article">  I would like to tell you about my experience of setting <a href="http://habrahabr.ru/company/JetBrains/blog/222673/">‚ÄúYouTrack as HelpDesk‚Äù</a> . <br><br>  Following the link that I indicated above, you will find more or less detailed instructions on how to deploy YouTrack from scratch and perform its initial configuration.  In the case when HelpDesk is built to handle requests in a large company, the development of its Workflow is inevitable. <br><a name="habracut"></a><br><h4>  1. We register the appeal, we form auto-responses </h4><br>  I work in a company that provides its services to banks.  Until a certain time, we used a self-help HelpDesk and it was poor.  At a certain time there was a question about his replacement.  At the same time, this relocation should have been minimal / noticeable for bank employees. <br><br>  The first thing I had to deal with was the registration of new calls and sending auto-answers to them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      With registration everything is simple, we add SMTP, we add a box and a filtering rule in the email integration settings.  With auto answer more interesting.  Initially, I had the ‚ÄúSend notifications to unregistered users‚Äù rule in the notifyUnregisteredUsers process.  Its essence boiled down to the rule ‚ÄúWhen a comment is added - send‚Äù.  However, this rule is suitable for us only to send a response to the bank, when we wrote it ourselves in a comment. <br><br>  As a solution, the following rule was written: <br><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-function">rule notification about created issue when </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">becomesReported</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ..... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Customer email != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { sendMail(Customer email, <span class="hljs-string"><span class="hljs-string">"Autoreply:"</span></span> + <span class="hljs-string"><span class="hljs-string">" ["</span></span> + getId() + <span class="hljs-string"><span class="hljs-string">"] "</span></span> + issue.summary, <span class="hljs-string"><span class="hljs-string">"       \" \",     : ["</span></span> + getId() + <span class="hljs-string"><span class="hljs-string">"]&lt;br&gt; : "</span></span> + now.format(mediumDateTime) + <span class="hljs-string"><span class="hljs-string">"&lt;br&gt;      . &lt;br&gt;&lt;br&gt; , ....  .."</span></span>) } }</code> </pre> <br>  The condition when becomes Report () always works BEFORE the publication of a new issue.  This is how the auto answer is solved. <br>  The next question was how to send an auto answer when adding a bank comment (i.e., an answer to the supporter‚Äôs answer).  As a solution to the corrected Send notifications to unregistered users: <br><br><pre> <code class="java hljs">when comments.added.isNotEmpty { ...... <span class="hljs-comment"><span class="hljs-comment">//  Last comment author  null,    if (Last comment author != null) { sendMail(Last comment author, "Autoreply:" + " [" + getId() + "] " + issue.summary, "   c    \" \"        : [" + getId() + "]&lt;br&gt; : " + now.format(mediumDateTime) + "&lt;br&gt;      . &lt;br&gt;&lt;br&gt; , c ....."); } ....... Last comment author = null; }</span></span></code> </pre><br>  Last comment author is a technical field, it is necessary in order to understand who wrote the bank or supporter.  In the post-processing rule, we specified ‚ÄúLast comment author $ {from}‚Äù which means ‚ÄúSet the value of the Last comment author field as the email sender of the letter‚Äù. <br>  And at the end of the rule, we always set it as null.  Therefore, the bank wrote - send an auto answer, otherwise do not send. <br><br><h4>  2. Filling in custom fields </h4><br>  In addition to communication letters, we needed to collect information on the status of the task, who owns, how many letters on the task went.  For these purposes, we created our own task fields such as Type, Criticality, Number of Bank Letters, Polygon, Release, Deadline, Bank Closing Date, and so on. <br><br>  A good half of them were filled in with Workflow.  Below is an example of filling in the deadline and determining the bank by mail domain: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">when </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">becomesReported</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ..... <span class="hljs-comment"><span class="hljs-comment">//        issue.deadline = now + 24 hours; if (issue.deadline.format(#e) == 6) { issue.deadline = issue.deadline + 48 hours; } if (issue.deadline.format(#e) == 7) { issue.deadline = issue.deadline + 24 hours; } ..... //     var bank = ""; var ce = ""; ce = issue.Customer email + "~"; bank = ce.substringBetween("@", "~"); if (issue. == null) { if (bank == "somebank.domain.com") { issue. = {- }; } ....... } }</span></span></code> </pre><br>  I will a little explain the code.  issue. {something} is a custom task field.  It is displayed in the project.  And you can also omit the ‚Äúissue.‚Äù So that the issue. Customer email and Customer email are one and the same.  But the var bank = "";  just a local variable. <br><br>  Here is the rule that closes the task yourself: <br><br><pre> <code class="java hljs">rule CloseFromBankRequest when issue.hasTag(<span class="hljs-string"><span class="hljs-string">" "</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (issue.hasTag(<span class="hljs-string"><span class="hljs-string">" "</span></span>)) { debug(<span class="hljs-string"><span class="hljs-string">"   "</span></span> + issue.getId()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (issue.Type == {Bug}) { <span class="hljs-comment"><span class="hljs-comment">//   ,          if (issue.desc == null) { issue.desc = issue.summary; } if (issue.solution == null) { issue.solution = "  "; } issue.ballis = {}; issue.polygon = {}; issue.causer = {}; if (issue. == null) { issue. = { }; } issue.Timer = {}; } else { if (issue.desc == null) { issue.desc = issue.description; } if (issue. == null) { issue. = { }; } issue.ballis = {}; issue.Timer = {}; } } }</span></span></code> </pre><br>  when issue.hasTag - when added a tag. <br><br>  I use this rule like this.  Implemented its own web-interface, in which the list of tasks of the bank is transmitted via api.  Clicking on the "Close" button again, via api YouTrack put the tag.  With this tag, Workflow closes the task itself, sets the required fields itself. <br><br><h4>  3. Just a couple of examples. </h4><br>  Task closure notification: <br><br><pre> <code class="java hljs">rule VoteCloseIssues when issue..changed { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (issue. == {Fixed} &amp;&amp; (issue.Type == {Bug} || issue.Type == {Task})) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> preview = <span class="hljs-string"><span class="hljs-string">" . &lt;br&gt;&lt;br&gt;  ,     ["</span></span> + getId() + <span class="hljs-string"><span class="hljs-string">"] . &lt;br&gt;    ,    &lt;a href=\"mailto:support@bifit.ua?subject=["</span></span> + getId() + <span class="hljs-string"><span class="hljs-string">"] "</span></span> + summary + <span class="hljs-string"><span class="hljs-string">"&amp;body= \"&gt;&lt;/a&gt;     . &lt;br&gt;&lt;br&gt;      ? &lt;br&gt;&lt;a href=\"http://{link_to_web_interface}/report/Issues.php?api=vote&amp;id="</span></span> + getId() + <span class="hljs-string"><span class="hljs-string">"&amp;mark=good\"&gt;,  &lt;/a&gt;&lt;br&gt;&lt;a href=\"http://{link_to_web_interface}/report/Issues.php?api=vote&amp;id="</span></span> + getId() + <span class="hljs-string"><span class="hljs-string">"&amp;mark=bad\"&gt;,  &lt;/a&gt;&lt;br&gt;&lt;br&gt;  :&lt;br&gt;&lt;br&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> author_comment = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> subj_comment = <span class="hljs-string"><span class="hljs-string">"    ["</span></span> + getId() + <span class="hljs-string"><span class="hljs-string">"]"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text_comment = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> date_comment = now.format(mediumDateTime); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> full_text = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (issue.comments[i].text != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || i &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) { author_comment = issue.comments[i].author.fullName; date_comment = issue.comments[i].created.format(mediumDateTime); text_comment = wikify(issue.comments[i].text); <span class="hljs-comment"><span class="hljs-comment">//    if (issue.comments[i].permittedGroup == null &amp;&amp; issue.comments[i].text != null) { full_text = "&lt;b&gt;" + author_comment + ":&lt;/b&gt;&lt;br&gt; : " + date_comment + "&lt;br&gt;&lt;blockquote&gt;" + text_comment + "&lt;/blockquote&gt;&lt;br&gt;&lt;hr&gt;&lt;br&gt;&lt;br&gt;" + full_text; } i = i + 1; } full_text = full_text + "&lt;b&gt;" + ":&lt;/b&gt;&lt;br&gt; : " + issue.created.format(mediumDateTime) + "&lt;br&gt;&lt;blockquote&gt;" + wikify(issue.description) + "&lt;/blockquote&gt;&lt;br&gt;&lt;hr&gt;&lt;br&gt;&lt;br&gt;"; full_text = preview + full_text; sendMail(Customer email, subj_comment, full_text); } }</span></span></code> </pre><br>  Here I will explain a little. <br><br><pre> <code class="java hljs">when issue..changed</code> </pre>  When changed the value of the field "Status". <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (issue. == {Fixed} &amp;&amp; (issue.Type == {Bug} || issue.Type == {Task}))</code> </pre>  If the status is ‚ÄúClosed‚Äù and the task type is ‚ÄúBug‚Äù or ‚ÄúConsultation‚Äù. <br><pre> <code class="java hljs">preview</code> </pre>  The beginning of the text of the letter.  There is a notification about closing the task, links to the assessment (the same web interface and api). <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (issue.comments[i].text != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || i &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre>  Let's go through the last 10 comments and add the author, the text of the comment in full_text (this is the history of correspondence) <br><pre> <code class="java hljs">full_text = full_text + <span class="hljs-string"><span class="hljs-string">"&lt;b&gt;"</span></span> + <span class="hljs-string"><span class="hljs-string">":&lt;/b&gt;&lt;br&gt; : "</span></span> + issue.created.format(mediumDateTime) + <span class="hljs-string"><span class="hljs-string">"&lt;br&gt;&lt;blockquote&gt;"</span></span> + wikify(issue.description) + <span class="hljs-string"><span class="hljs-string">"&lt;/blockquote&gt;&lt;br&gt;&lt;hr&gt;&lt;br&gt;&lt;br&gt;"</span></span>;</code> </pre>  In the history, the most recent comment will be the first appeal of the bank wikify (issue.description) <br><pre> <code class="java hljs">sendMail(Customer email, subj_comment, full_text);</code> </pre>  Send all this to the bank. <br><br>  Fill the subsystem automatically if a specific type of integration module is selected: <br><br><pre> <code class="java hljs">rule set_subsystem_if_change_gateway when issue. .changed { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (issue.Subsystem != { } &amp;&amp; issue.  != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { issue.Subsystem = { }; } }</code> </pre><br>  We check if we have gone beyond the deadline (timed tasks): <br><br><pre> <code class="java hljs">schedule rule check deadline every minute [issue.Timer != {} || issue. == {Fixed}] { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (issue.deadline == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || issue. == {Fixed} || issue.ballis == {}) { <span class="hljs-comment"><span class="hljs-comment">//               ,  if (issue.hasTag("")) { issue.applyCommand("  "); } // ,    } else if (issue.deadline &lt;= now) { //      ,  ""     if (issue.hasTag("")) { if (issue.hasTag("")) { issue.applyCommand("  "); if (issue.isoverdue == {}) { issue.isoverdue = null; } } //  (  ) } else { if (!issue.hasTag("")) { issue.applyCommand("  "); if (issue.isoverdue == null) { issue.isoverdue = {}; } } } } }</span></span></code> </pre><br><br>  If we forget to stop the task and go home, YouTrack will do it for you: <br><br><pre> <code class="java hljs">schedule rule pause all issues in overtime daily at <span class="hljs-number"><span class="hljs-number">18</span></span>:<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> [issue.Timer == { }] { issue.Timer = {}; }</code> </pre><br><br>  Well that's all.  I hope my publication will someday help. <br><br>  Write questions / comments in comments or private messages. </div><p>Source: <a href="https://habr.com/ru/post/247939/">https://habr.com/ru/post/247939/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../247925/index.html">Herringbone, light up! Part 2: C software, work with GPIO and software PWM</a></li>
<li><a href="../247927/index.html">That's what happens if you install the top 10 programs from Download.com</a></li>
<li><a href="../247929/index.html">Session of white magic without revealing or how I was looking for trolls in LJ</a></li>
<li><a href="../247933/index.html">Triggerable - event-oriented logic for ActiveRecord models</a></li>
<li><a href="../247935/index.html">About input [type = range], the multiple parameter and how to make everything work</a></li>
<li><a href="../247943/index.html">The outgoing voice era</a></li>
<li><a href="../247945/index.html">The first report from the project Devuan</a></li>
<li><a href="../247947/index.html">Manual installation of complex boards on components 0402, 0603, QFN, LQFP and THT</a></li>
<li><a href="../247949/index.html">Questions about indexes that you do not need to ask</a></li>
<li><a href="../247951/index.html">Unity3D Editor: Tips and Tricks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>