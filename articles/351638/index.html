<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ComputerVision and what it eat</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With the development of computer power and the emergence of a variety of image processing technologies, the question has increasingly arisen: can we t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ComputerVision and what it eat</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/fl/xu/gy/flxugygvxdxbnshzlqvekqs4ivy.png" alt="image" align="left" width="250" height="272">  With the development of computer power and the emergence of a variety of image processing technologies, the question has increasingly arisen: can we teach the machine to see and recognize images?  For example, to distinguish a cat from a dog or even a bloodhound from a basset?  There is no need to speak about the accuracy of recognition: our brain is incomparably faster able to understand that it is in front of us, provided that earlier we received enough information about the object.  Those.  even seeing only a part of a dog, we can safely say that it is a dog.  And if you are a dog breeder, then it is easy to determine the breed of a dog.  But how to teach the car to distinguish between them?  What are the algorithms?  Is it possible to deceive the car?  (Spoiler: of course you can! In the same way as our brain.) Let's try to comprehend all these questions and, if possible, answer them.  So let's get started. <br><a name="habracut"></a><br><h2>  How to teach the car to see? </h2><br>  Machine Vision refers to Machine Learning, which includes semantic analyzers, sound recognizers, and so on.  This is a complex subject area, and it requires in-depth knowledge of mathematics (including brrrrr, tensor mathematics).  There are many algorithms that are used in pattern recognition: VGG16, VGG32, VGG29, ResNet, DenseNet, Inception (V1, V2, V3, V ... there are hundreds of them!).  The most popular are VGG16 and Inception V3 and V4.  The easiest, most popular and most suitable for a quick start is VGG16, so we select and pick it.  Let's start with the name VGG16 and find out what is sacred in it and how it stands for.  And here K.O.  prompts that everything is simple: VGG is the Visual Geometry Group c of the Faculty of Engineering Sciences of the Oxford University.  Well, where did 16 come from?  It is a bit more complicated and directly related to the algorithm.  16 - the number of layers of the neural network, which is used for pattern recognition (finally, an interesting thing is started, otherwise everything is around).  And it's time to cut into the very essence of matan.  They themselves use from 16 to 19 layers and 3x3 filters at each level of the neural network.  Actually, there are several reasons: the greatest performance with just such a number of layers, recognition accuracy (this is quite enough, links to articles, <a href="http://www.robots.ox.ac.uk/~vgg/research/very_deep/">once</a> and <a href="https://arxiv.org/pdf/1603.08695.pdf">twice</a> ).  It should be noted that the neural network is used not simple, but an improved convolutional neural network (CNN) and Convolutional Neural Network with Refinement (CNN-R). <br><br>  And now we will understand the principles of operation of this algorithm, why we need a convolutional neural network and with what parameters it works.  And, of course, it is better to do it in practice right away.  Assistant in the studio! <br><br><img src="https://habrastorage.org/webt/ba/iw/au/baiwauninetumhy7a-3r1tx7ic4.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This wonderful husky will become our assistant, and we will set up experiments on it.  She is already glowing with happiness and wants to quickly get into the details. <br>  So, in simple words: the convolutional neural network works with two ‚Äúcommands‚Äù (I exaggerate a lot, but it will be clearer).  The first - select the fragment, the second - try to find the whole object.  Why the whole thing?  Having available a set of the smallest patterns with contours of whole objects, it is easier for neural networks to further obtain the characteristic features and compare them with the image that is required to be recognized.  And here we will help the image of the algorithm in the final form.  Who wants to study in detail, with tons of matan - that's <a href="https://arxiv.org/pdf/1603.08695.pdf">pruflink</a> .  And we go further. <br>  Explaining the following algorithm is not so difficult.  This is the complete algorithm for the work of the convolutional neural network with the enhancement module (this is the one that is surrounded by a dotted line and is present after each step of the convolution). <br><br>  The first step: we are cutting the image in half (done with the Huskies, but it doesn‚Äôt look as impressive as the elephants in the picture).  Then in half, then more and more, and so we reach the cockroaches, in the sense of a block 14x14 and less (the minimum size, as already mentioned, 3x3).  Between steps - the main magic.  Namely - getting the mask of the whole object and the probability of finding the whole object on the sawed piece.  After all these manipulations we get a set of pieces and a set of masks for them.  What to do with them now?  The answer is simple: when reducing the image, we get the degradation of neighboring pixels, which will simplify the construction of the mask in a simplified form and provide an opportunity to increase the probability of distinguishing transitions between objects. <br><br><img src="https://habrastorage.org/webt/bc/76/pa/bc76pacppncqz19d0cnwxlbekoy.png"><br><br>  Based on the analysis of reduced images, independent initial descriptions are built and then the result is averaged for all masks.  But it should be noted that this option is not the best for the segmentation of the object.  The average mask may not always be applicable when there are small differences in color between the objects and the background (this is why this test image was chosen). <br><br>  The proposed approach is more or less efficient, but for objects that are entirely in the image and contrast with the background, at the same time, the separation of two identical or similar objects (we will not go far beyond the example: a flock of sheep, all have white wool) . <br><br>  To obtain an adequate pixel mask and the separation of objects it is necessary to bring the algorithm to mind. <br><br>  And now the time has come to ask: why do we need this ‚Äúmodule-improver‚Äù, if everything seems to be so good? <br><br>  At each step, we add not only the construction of the mask, but also the use of all the information obtained from low-level functions together with knowledge of high-level objects that are recognized in the upper layers of the neural network.  Along with obtaining independent results, at each step generation and coarse recognition is performed, the result is a semantically complete functional multichannel map into which only positive information from the early layers is integrated. <br><br>  What is the difference between the classic convolutional neural network and the improved convolutional neural network? <br><br>  Each step of reducing the original image allows you to get a coded mask generated when passing from the overall image to a smaller one.  At the same time, in the improved convolutional neural network, there is a movement from a smaller image to a larger one, with obtaining characteristic functions (points).  The result is a mask resulting from the bidirectional merging of functions and characteristic points. <br>  It sounds quite confusing.  Let's try to apply to our image. <br><br><img src="https://habrastorage.org/webt/p-/uf/a0/p-ufa03yqgdkx_kkvwmyklfduky.png"><br><br>  Effectively.  This is called DeepMask - the rough boundaries of the objects in the image.  Let's try to figure out why.  Let's start with a simple - with the nose.  When the image is degraded, the contrast is obvious, therefore the nose is selected as an independent object.  The same with the nostrils: at certain levels of the convolution, they became independent objects due to the fact that they were completely on the fragment.  In addition, the face of the second dog is circled separately (how can you not see? Why, she is right in front of you!).  A piece of hand was recognized as a background.  So what to do?  With the main part of the background color does not contrast.  But the transition "hand-shirt" is highlighted.  And the error in the form of a ‚Äúhand-mesh‚Äù spot, and a large spot, an exciting background and a husky's head. <br><br>  Well, the result is interesting!  How can you help the algorithm to cope with the task better?  Only if you make fun of our assistant.  To begin, let's try to make it in grayscale.  Hmm ... The photo is worse than the passport.  After that, the technician had nothing to lose, I just turned on one filter, and everything began to turn ... Sepia, and after it solarization, overlaying and subtracting layers, blurring the background with the addition of images - in general, what I saw was used;  The main thing is that the objects become more noticeable in the image.  As they say, the picture in Photoshop can endure.  Mocked, it would be time to see how the image will now be recognized. <br><br><img src="https://habrastorage.org/webt/5v/6v/hp/5v6vhpfq_ofgzwaghpcgxrxo0zo.png"><br><br>  The neural network said: "There is no one who can somehow be classified."  It is logical, contrasting only the nose and eyes.  Not very typical with a small set of training. <br><br><img src="https://habrastorage.org/webt/ng/vw/nb/ngvwnb-yw-fr4rmq2fxcokaeqnq.png"><br><br>  Wow, what a horror (sorry, friend)!  But here we seriously added contrast to the objects in the image.  How?  We take and duplicate the image (several times).  On one we unscrew the contrast, on the other - the brightness, on the third - we burn the colors (make them unnaturally bright) and then add it all up.  And finally, we will try to stuff the long-suffering husky into processing. <br><br><img src="https://habrastorage.org/webt/hi/7c/bg/hi7cbgp1qbwpb2qycwxzshve_fs.png"><br><br>  I must say that it became better.  Not straightforward ‚Äúwow, how cool,‚Äù but better.  The number of incomplete objects decreased, the contrast between the objects appeared.  Further experiments with preprocessing will give more contrast: object - object, object - background.  We get 4 segments instead of 8. From the point of view of processing a large flow of images (150 images per minute) it‚Äôs better not to bother with pre-processing at all.  She - so, play on the home computer. <br><br>  Go ahead.  SharpMask will not differ much.  SharpMask is the construction of a refined object mask.  The improvement algorithm is the same. <br><br>  The main problem of DeepMask is that this model uses a simple network of direct distribution, which successfully creates ‚Äúrough‚Äù masks, but does not perform segmentation with pixel accuracy.  We skip the example for this step, as the Huskies are already not so easy to live. <br>  The last step is an attempt to recognize what happened after the mask was clarified. <br><br><img src="https://habrastorage.org/webt/om/_u/mk/om_umkchx_jego7qd_oiwgdjzps.png"><br><br>  We run a quickly assembled demo and get the result - as much as 70% that this is a dog.  Not bad. <br><br>  But how did the car realize that it was a dog?  So we sawed pieces, got beautiful masks, matrices for them and sets of signs.  What's next?  And then everything is simple: we have a trained network, which has reference sets of signs, masks, etc., etc., etc.  Well, are they, and what's next?  Here is our husky with a set of signs, here is a reference spherical dog in a vacuum with a set of signs.  Stupid comparison in the forehead can not be done, because the lack of signs in the image, which we recognize, will lead to an error.  And what to do?  To do this, they came up with such a wonderful parameter as a dropout, or a random network reset.  This means the following: both sets are taken and signs are randomly removed from each of them (in other words, there are sets of 10 signs, dropout = 0.1; we discard each sign, then compare).  And as a result?  And as a result - PROFIT. <br><br>  I will answer the question why the second dog is not a dog, and the hand is not a man.  The test sample was only 1000 images of cats and dogs.  She studied in just two steps of evolution. <br><br><h2>  Instead of conclusions </h2><br>  So, we got a picture and the result that this is a dog (it is obvious to us, but for a neural network it was not very).  The training was conducted in just two steps and there was no evolution of the model (which is very important).  The image was loaded as it is, without processing.  In the future, it is planned to check whether the neural network can recognize dogs by the minimum set of features. <br><br>  Of the benefits: <br><br><ul><li>  We conducted training on one machine.  If necessary, files can be scattered immediately to other machines, and they (the machines) will already be able to do the same. </li><li>  High definition accuracy when learning and network evolution (this is soooo long). </li><li>  You can evolve under different recognition algorithms and "train" the network. </li><li>  Huge database of COCO and VOC images (updated annually). </li></ul><br>  Of the minuses: dancing with a tambourine with each framework. <br><br>  PS When conducting experiments, no husky suffered.  About how they collected, what they collected, how many rakes, to which places and so on - in the next article of our series ‚ÄúMachine Vision for Housewives‚Äù. <br><br>  PPS And very, very briefly: a silver bullet does not exist, but there is a Faust-cartridge that can be turned with a file.  And for a quick start, the following frameworks were used: <br><br>  <a href="https://keras.io/">Keras</a> <br>  <a href="http://caffe.berkeleyvision.org/">Caffe</a> <br>  <a href="https://www.tensorflow.org/">Tensorflow</a> </div><p>Source: <a href="https://habr.com/ru/post/351638/">https://habr.com/ru/post/351638/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351628/index.html">Quantum circuits and valves - introductory course</a></li>
<li><a href="../351630/index.html">Fundamentals of quantum computing: pure and mixed states</a></li>
<li><a href="../351632/index.html">Quantum teleportation in Q #</a></li>
<li><a href="../351634/index.html">Quantum Computing: Reference Materials</a></li>
<li><a href="../351636/index.html">We speed up the time of assembly and delivery of java web applications</a></li>
<li><a href="../351644/index.html">Amazon will launch internal accounts for customers without bank cards</a></li>
<li><a href="../351646/index.html">Difficulties of registering on Skype without a phone</a></li>
<li><a href="../351648/index.html">Triton vs Kao's Toy Project. We continue a good tradition</a></li>
<li><a href="../351650/index.html">Digest news from the world of PostgreSQL. Issue number 4</a></li>
<li><a href="../351652/index.html">Release Yii 2.0.15 and database extensions with fixed vulnerabilities</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>