<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PBX in your pocket: set up IP telephony for remote work</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="High-speed Internet has become available almost everywhere: from cafes in the center of Moscow to the wild beach on the Adriatic. Now it has become ve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PBX in your pocket: set up IP telephony for remote work</h1><div class="post__text post__text-html js-mediator-article">  High-speed Internet has become available almost everywhere: from cafes in the center of Moscow to the wild beach on the Adriatic.  Now it has become very easy to stay in touch - I installed a couple of applications on a smartphone and you can go on holiday to warm countries without fear that the desired call, message or e-mail will pass by.  When communicating in social networks in response to "Hello, are you here?", It may be quite normal: "On the run, I'll dial later."  Another thing is if a business is tied to Internet communications - at any time you need to be ready to answer an incoming or make an important outgoing call (even if you are riding a motorbike around Pattaya). <br><br>  We will write about how to ‚Äúcorrectly‚Äù build a telephony, without reference to geography, for a remotely mobile entrepreneur (who loves the sea, the sun and the mountain air) using the example of the Zadarma cloud service. <br><br><img src="https://habrastorage.org/files/32b/fae/e29/32bfaee29f244f5699418baa6f190fb1.png"><br><a name="habracut"></a><br>  For most ordinary users, telephony is a comprehensive, unified service that allows you to both take a call and dial the desired number from one device.  Through the eyes of a specialist, a telephone service consists of two, often unrelated, things: incoming and outgoing communication.  You can take a call on one channel, and send - completely different.  This is especially noticeable when using VoIP, when a user can set up several accounts on one IP phone / softphone or use an <a href="https://zadarma.com/ru/services/pbx/">IP PBX</a> with multiple numbers.  This is a huge plus of VoIP-technologies: we are practically unlimited in the possibilities of switching and optimizations. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <font color="#cc0000">Our task:</font> </h4><ol><li>  To organize the most effective incoming and outgoing communication without reference to a fixed channel of the Internet and geography. </li><li>  Provide the ability to work with multiple virtual numbers. </li><li>  Configure call acceptance on all devices with which we deal.  So that the incoming person always reaches the addressee and always has the opportunity to dial the number of any country in the world, regardless of our location, at minimum rates. </li></ol><br>  On the Internet, many ways to organize telephony for a remote client using ‚Äúknee‚Äù solutions are described - from your own Asterisk to a dozen GSM gateways around the world.  Yes, it really works, but it requires money to support servers, purchase the same gateways, configure and configure.  An entrepreneur who ‚Äúsaws‚Äù a startup from Montenegro is definitely not up to sip.conf and sip-invites, he just needs to call.  Let us set aside configs and invites with redjacks aside, and set up everything that is needed on the <a href="https://zadarma.com/">Zadarma</a> cloud platform. <br>  The main postulate: for remote work entrepreneur applications such as Viber and Skype is not enough.  It is difficult to fully operate without telephony - clients not only write to us, they also call.  Thus, several virtual numbers will be required for incoming communications.  The digital business is a global thing, so we will provide not only Russian numbers, for it‚Äôs important for us to make it convenient for the client to communicate with us.  Whatever country you are in, whatever device you use (a laptop with a headset, a smartphone with an application, or a regular cellular phone), we will configure processing scripts so that the incoming ones do not go into void if one of the devices is unavailable. <br>  A typical layout looks like this: <br><img src="https://habrastorage.org/files/959/00f/e15/95900fe157be494bb4d0c17b1c14bbd6.png"><br><br><h4>  <font color="#cc0000">Consider the case</font> </h4><br>  Remote worker Kirill honestly worked for four years in a digital agency, was engaged in front-end development and layout, mastered Bootstrap and a bit of RoR.  Feeling tired of life in the capital and feeling an irresistible desire to relax and, perhaps, ‚Äúgrind out‚Äù something of his own, Cyril moved to a remote place and moved to Burgas, Bulgaria, where he made a studio 100 meters from the sea.  All metropolitan contacts and connections have been preserved, we still have to work, after a month of meditations on the Black Sea sunsets, there are still a hundred project ideas.  Kirill started a blog about a happy life on the seashore, periodically helps people familiar with the design of a residence permit in the European Union, and on occasion, he is ready to help with the selection of housing.  Kirill maintains his own Landing Website Designer, makes many calls in Russia and Europe in search of investors and communicates with clients. <br><br><img src="https://habrastorage.org/files/b4f/1af/7f9/b4f1af7f9fc349e2ab1b7e6707b8c52b.png"><br><br><h4>  <font color="#cc0000">Inbound connection</font> </h4><br>  Kirill has business partners in Slovenia and Latvia, clients in Russia and Kazakhstan and friends in Montenegro.  In order to always be in touch by phone and advertise in the right regions, you need local virtual numbers configured via SIP and connected to the <a href="https://zadarma.com/ru/services/pbx/">cloud PBX</a> . <br>  Set up incoming numbers. <br><img src="https://habrastorage.org/getpro/habr/post_images/2e0/e71/57b/2e0e7157bace84c0d0b3ec43c708ca85.png" alt="image"><br><br><ol><li>  Select the desired cities and countries from the list of available virtual <a href="https://zadarma.com/ru/tariffs/numbers/">numbers</a> .  The numbers are already pre-configured and immediately after purchase, incoming calls are routed to Zadarma.  In addition, we will take the Moscow number in the code 499 for communication with Russia, it is definitely more convenient than keeping the roaming option permanently connected to the Russian SIM card.  Together with the Moscow number we will receive an outgoing communication packet.  Convenient, since you still have to call.  So, we have several regional numbers of the Russian Federation and a couple of European ones.  On them we are waiting for incoming from customers and partners. <br>  In order to easily understand which of the numbers they are calling, we will give each number a name (Moskwa, Sofia, Riga).  The names of the numbers will be displayed in the programs with each call, and then in the statistics of the PBX. <br><img src="https://habrastorage.org/files/21b/38b/9a9/21b38b9a93bf43c98b129c12bf7230f0.png"></li><li>  Sister Cyril lives in Yekaterinburg and sometimes calls from the city - to find out how things are.  There is no special meaning for her to have a separate local incoming number, her sister is a man and she understands that communication abroad is not a cheap pleasure.  We will offer her to call a toll-free incoming call with an extension: the IVR hangs on the number, which offers to enter an additional SIP number of the subscriber, then the call goes into the common scenario.  It is convenient to dial through it to those who are ready to enter an internal number to an extension (for example, relatives, friends). </li><li>  Two years ago, Cyril bought a virtual number in code 499 for his project, he posted it on the site and Russian customers call him.  It‚Äôs impossible to lose the number, it sometimes feeds us with orders.  We leave it and configure it as an additional external gateway on the Zadarma server.  Standard procedure: enter the login, password, server, issued when you buy a number from a third-party provider. </li></ol><img src="https://habrastorage.org/files/908/a25/45c/908a2545cfc340eeb151f20cf45c4e96.png"><br><br><h4>  <font color="#cc0000">PBX for incoming</font> </h4><br>  When incoming numbers are more than one, then PBX functionality is indispensable.  Calls should come according to certain rules, they should be met with a voice greeting and sometimes sent to a friend Ruslana in Riga, who is responsible for the joint portal for Europe in the field of ecotourism.  To do this, set up the incoming scripts with the traditional "Hello, you called the young, dynamic, company ...".  At the same time, Ruslana from Riga and Maxim from Belgrade will be allocated internal extensions with short numbers in order to call each other and, if necessary, transfer calls to each other, as well as communicate in conferences. <br>  Calls to the Latvian number will be sent first to Ruslan, and calls to the Russian advertising number for real estate in Bulgaria will be voiced by a pleasant female voice with a Bulgarian accent.  We will also set up a direct call to Maxim for permanent European customers, ‚Äútourists‚Äù (numbers of which we already know), and we will immediately send customers from Kazakhstan to Cyril (routing through the caller's telephone code). <br><br><h4>  <font color="#cc0000">Outgoing calls</font> </h4><br><img src="https://habrastorage.org/files/f59/0a1/3d6/f590a13d6bdc4c308630258ac18ef8cd.png"><br><br>  Set up rules for outbound communication.  Here everything seems to be simple.  We allow outgoing calls to all concessionaires (with the exception of Maxim from Belgrade, calls to Serbia are very expensive, let him call from his mobile phone).  Close Maxim outgoing. <br>  Now you need to deal with CallerID (Caller ID).  We have several incoming numbers and we want to show Russian when calling to Moscow and Baltic - when calling to the Baltic States.  To do this, we compare the internal extensions and virtual numbers.  When calling from 101 we show the Russian number, while calling from 102 - Latvian.  Kirill calls to Russia with Russian AON, and Ruslan to Vilnius - from Riga. <br>  Sometimes Kirill calls his friends in the Russian Federation and wants them to see his mobile number, not the startup advertising number.  No problem: we will configure another extran for calls with cell number substitution - we confirm the mobile phone via SMS, and now it is in the list of available numbers.  Voila, the problem is solved! <br><br><h4>  <font color="#cc0000">Call forwarding and mobile app</font> </h4><br><img src="https://habrastorage.org/files/322/5dc/9bc/3225dc9bc02b465e83dcd47a72331f69.png"><br><br>  We will understand how and to which devices we will receive calls.  In fact, the choice is quite large.  Kirill spends almost the whole day in his home office: replies to e-mail, talks on video in Skype, drinks coffee and watches TV.  When there is a laptop and a headset at hand, we send calls to the softphone in the laptop.  This is the most comfortable and correct way to communicate - all the functions and settings of the PBX are at hand, you can watch statistics and even listen to the recording of conversations. <br>  Sometimes Kirill becomes unbearably cramped on his 28 square meters, he rides his bicycle to the sea to unwind.  At the sea, the 3G network is almost invisible, so there will be no ‚Äúnormal‚Äù Internet - we set up the call forwarding to its Bulgarian mobile by the non-response softphone on the laptop.  Calls to mobiles in Bulgaria are cheap and a couple of redirected calls can be answered without great expense. <br><br><img src="https://habrastorage.org/files/efb/15d/d8a/efb15dd8ae8f4af48ba5be52d63f75f2.png"><br><br>  For Saturday trips to cafes and on the embankment, Cyril uses <a href="https://zadarma.com/ru/support/instructions/android/zadarma/">Zadarma</a> softphone <a href="https://zadarma.com/ru/support/instructions/android/zadarma/">on his mobile</a> .  Bulgarian 3G allows itself to communicate without loss of packets even with a high-quality, 711th codec.  In their free time, people in Burgas prefer to sit in a cafe, and not on YouTube, so the network is free and the voice through 3G goes "with a bang."  The ‚Äúnames‚Äù of the numbers will help you understand exactly where the call came from and to whom.  ‚ÄúDialer‚Äù is also used for outgoing calls.  On the softphone, we set up several accounts with different extensions in order to easily make calls to different countries with different CallerIDs. <br><br><h4>  <font color="#cc0000">Callback and call from the site</font> </h4><br>  Incoming scenarios are set up: concessionaires Kirill, Ruslan and Maxim have connected the real robot seller.  Several virtual numbers of the Russian Federation and Europe were instituted at the PBX, advertising numbers were posted on different Internet projects, a separate IVR was assigned to each incoming trunk, calls of regular customers are routed immediately to the person in charge.  Also, calls are processed by a special scenario: depending on the geographical location of the client, calls are routed to different accounts.  Conditional and unconditional forwarding to mobile phones or applications are configured.  No call will pass by.  Outgoing calls go the most economical routes.  The Zadarma personal account interface can be closed and opened only to replenish the balance.  The remote access concession from the telephone network looks no worse than the call center of a large bank, and in some places even cooler. <br>  It remains to add a couple of "features" and provide for emergency situations when the Internet suddenly ended, and you need to call. <br><img src="https://habrastorage.org/files/0ce/5da/b79/0ce5dab799d648c8b0d83bd018729776.png"><br><br>  Callback, with the active development of mobile broadband, is gradually losing its relevance, but in some cases irreplaceable.  Kirill receives a notification of a missed from a regular customer during a bike ride in the mountains, this sometimes happens.  Customers call when they need them, and not only during working hours.  We urgently need to call back and clarify the essence of the issue.  In the mountains there is no 3G, only GPRS and voice communication work.  We will use the callback: dial the access number of the callback platform, get a hang up without lifting the handset (the outgoing is not charged) and wait for the incoming to the Bulgarian sim card.  After receipt of the incoming, enter the customer number and talk.  The problem of the lack of mobile Internet has been solved, the conversation took place, only a few eurocents were written off from the Zadarma balance sheet. <br><img src="https://habrastorage.org/getpro/habr/post_images/877/b32/26e/877b3226e07ea03e483960af2627bf05.png" alt="image"><br><br>  Sometimes Cyril has to send SMS, and from those numbers that are listed on the site of his many projects.  Non-virtual, no SIM cards are not provided, but the substitution of the desired number of the sender is needed as air.  We use the form of sending SMS in your Zadarma account - enter SMS text and select the sender's number.  The SMS to Riga flew away with the Riga number.  It is done. <br><br>  The triumph of innovation in Cyril's projects would not have looked so convincing if he had not used the ‚ÄúCallback‚Äù button on his website ‚ÄúReal Estate in the Czech Republic‚Äù.  Call-tracking, calls from the site and other WebRTC are gaining momentum and those who did not have time, he was late.  Do you want to be in the forefront - be in trend.  We put the " <a href="https://zadarma.com/ru/services/callme/">Callback</a> " button on the home and set up a reaction to the atypical behavior of the client - the visitor comes in for the third time in a row and for a long time admires the villa description for half a million in the suburb of Ljubljana, we will make him an offer to order the call right now.  If the visitor enters his mobile number and clicks OK, the callback will come to the PBX and will be processed by all clever scenarios. <br><br><h4>  <font color="#cc0000">Summing up</font> </h4><br>  Having painted the above mentioned methods, we did not discover America; to a greater or lesser degree, many of the VoIP techniques have been used for a long time by many users.  Some enthusiasts contain entire ATA and GSM gateways and manage to manage them.  The difference between the Zadarma project and the many ingenious ‚ÄúInternet adaptations‚Äù is that only complex cloud services with a single user interface and personal account are used to set up complex scenarios and call routes.  Does it make sense to buy hardware solutions and order gateways in Chinese online stores to do something on the knee, which already works out of the box with a service with a good reputation?  The advantage of Zadarma is that the set of services is designed not only for SMB, but also for small home offices with non-standard requests.  The scheme with Kiril a remote worker is a good example of the direction VoIP has been moving in the past few years: towards a single numbering plan for distributed offices, towards complex incoming call schemes with multiple numbers and call processing scenarios, towards providing IP telephony services mobile devices.  <a href="https://zadarma.com/ru/">Zadarma project understands</a> this well and regularly improves its service. <br><br>  <b>PS:</b> We note that Zadarma services connect not only remotes by the sea.  There are special demand offers for medium / large <a href="https://zadarma.com/ru/topup/corporate/">businesses</a> .  For example, now for offices there is a unique offer of a pair of identical numbers: <a href="https://zadarma.com/ru/tariffs/numbers/russian_federation/tollfree-3179">federal 8-800 and Moscow 499</a> . <br><br>  <b>PPS:</b> We have already begun preparing a description of the new case. </div><p>Source: <a href="https://habr.com/ru/post/271261/">https://habr.com/ru/post/271261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271245/index.html">Risks and problems of password hashing</a></li>
<li><a href="../271249/index.html">Modular ASP.NET 5 Application</a></li>
<li><a href="../271255/index.html">Objective-C: how blocks work</a></li>
<li><a href="../271257/index.html">Classic cryptanalysis</a></li>
<li><a href="../271259/index.html">Two-factor authentication of Cisco AnyConnect clients. FreeRadius and Google Authenticator</a></li>
<li><a href="../271265/index.html">swirl: the rapid immersion in R (learning by doing)</a></li>
<li><a href="../271269/index.html">Gradle: 5 Utility for the Developer</a></li>
<li><a href="../271271/index.html">What else affects the infrastructure: How to ensure the quality of equipment installation</a></li>
<li><a href="../271273/index.html">Introducing the new version of Kerio Connect 9</a></li>
<li><a href="../271275/index.html">NOT useful tips for the programmer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>