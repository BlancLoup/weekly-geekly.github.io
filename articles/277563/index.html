<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Word2Vec: classification of text documents</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The well-known distributional semantics utility Word2Vec demonstrates amazing results and consistently provides specialists using it with top places i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Word2Vec: classification of text documents</h1><div class="post__text post__text-html js-mediator-article">  The well-known distributional semantics utility Word2Vec demonstrates <a href="https://habrahabr.ru/post/249215/">amazing results</a> and consistently provides specialists using it with top places in <a href="http://www.dialog-21.ru/adx/aspx/adxGetMedia.aspx%3FDocID%3Dbf62355c-eeb8-4965-af7f-25b7da5e10cd">machine linguistics competitions</a> .  The advantage of the utility, as well as its analogues - Glove and AdaGram, is in the cheapness of the process of education and the preparation of training texts.  But there are drawbacks - the representation of words in the form of vectors works well on words, satisfactorily on phrases, so-so on phrases and in general nothing - on long texts. <br><br>  In this article, an approach is proposed for discussion that allows you to represent text of any length as a vector, allowing you to perform comparison (distance calculation), addition, and subtraction operations with texts. <br><a name="habracut"></a><br><h4>  From vector representations to semantic vector </h4><br><br>  Vector representations of words derived from Word2Vec work have the following interesting property - only the distances between the vectors, and not the vectors themselves, make sense.  In other words, to decompose the vector representation of a specific word into its components and to study it seems to be an intractable task.  First of all, because the learning process starts with some random initial vectors and moreover, the learning process itself is random.  Its randomness is connected with the principle of stochastic learning, when parallel-running learning streams do not synchronize the changes being made with each other, realizing the data race in its pure form.  But the quality of training this race does not significantly reduce, while the speed of learning increases very noticeably.  It is due to the random structure of the algorithm and data - the vector representation of the word is not decomposable into meaningful components and can only be used as a whole. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The negative effect of this property of vector representation is the rapid degradation of vectors during operations on them.  The addition of vectors of two words usually demonstrates that common thing between these words (if the words are really related in the real world), but an attempt to increase the number of components very quickly leads to the loss of any practically valuable result.  To put together the words of one phrase - it is still possible, several phrases - no longer exist.  A different approach is needed. <br><br>  From the point of view of the philistine logic, how can you describe any text?  Try to indicate his subject, maybe - to say a few words about the style.  Texts dedicated to cars, obviously, will contain a sufficiently large number of the words ‚Äúcar‚Äù and close to it, may contain the word ‚Äúsport‚Äù, the names of car brands and so on.  On the other hand, texts on other topics will contain such words much less or not at all.  Thus, having listed a sufficient number of possible topics of the text, we can calculate the statistics of the presence in the text of the words corresponding to each topic and get a semantic text vector - a vector, each element of which indicates the relationship of this text to the topic encoded by this element. <br><br>  The style of the text, in turn, is also determined by statistical methods - these are characteristic for the author words, parasites and verbal expressions, the specifics of the beginning of phrases and the placement of punctuation.  Since we share uppercase and lowercase letters when learning and do not remove punctuation from the text, the Word2Vec dictionary is full of words like ‚Äútext,‚Äù like that, with a comma.  And it is precisely these words that can be used to highlight the author's style.  Of course, really huge text corpuses are needed for a sustainable style selection, or at least a very original author's style, but, nevertheless, it‚Äôs easy to distinguish a newspaper article from a forum post or tweet. <br><br>  Thus, to build a semantic vector of text, it is necessary to describe a sufficient number of stable clusters reflecting the subject and style of the text.  In the Word2Vec utility itself there is a built-in clusteriser based on kMeans, and we will use it.  The cluster will divide all the words from the dictionary into a given number of clusters, and if the number of clusters is large enough, you can expect each cluster to indicate a rather narrow subject of the text, or more precisely, a narrow indication of the subject or style.  In my task, I used two thousand clusters.  That is - the length of the semantic vector of the text is two thousand elements, and each element of this vector can be explained through the words corresponding to the given cluster. <br><br>  The relative density of words from each cluster in the text under study describes the text well.  Of course, each specific word is related to many clusters, to some more, to some less.  Therefore, first of all, it is necessary to calculate the semantic vector of the word - as a vector describing the distance from the word to the center of the corresponding cluster in the Word2Vec vector space.  Then, adding the semantic vectors of the individual words that make up the text, we get the semantic vector of the entire text. <br><br>  The described algorithm, based on the calculation of the relative frequency of words defining relevant topics, is good because it is suitable for texts of any length.  From one word to infinity.  In this case, as we know, it is difficult to find a sufficiently long text of one subject, often the subject of the text changes from its beginning to its end.  A short text, or a message, on the contrary, cannot cover many topics precisely because of its brevity.  As a result, it turns out that the semantic vector of a long text is distinguished by the signs of several themes from the short text, in which the signs are much smaller, but they are represented much more strongly.  The length of the text is clearly not taken into account; nevertheless, the algorithm reliably spreads short and long texts in vector space. <br><br><h4>  How to use semantic text vector? </h4><br>  Since each text is matched by a vector in semantic space, we can calculate the distance between any two texts as a cosine measure between them.  Having the distance between the texts, you can use the kMeans algorithm for clustering or classification.  Only this time - already in the vector space of texts, rather than individual words.  For example, if we have the task of filtering out the text stream (news, forums, tweets, etc.) only having topics that interest us, we can prepare a base of pre-marked texts, and for each text being studied, calculate the class for which it is (maximum of averaged cosine measure over several best occurrences of each class - pure kMeans). <br><br>  In this way, the rather difficult task of classifying texts into a large (several hundred) number of classes was successfully solved, with significant differences in texts by style (different sources, length, even message languages) and with thematic relatedness of classes (one text can often be related to several classes).  Unfortunately, the specific figures of the results obtained are under the NDA, but the overall effectiveness of the approach is as follows - 90% accuracy at 9% of classes, 99% accuracy at 44% of classes, 76% accuracy at 3% of classes.  These results should be interpreted as follows: the classifier sorts all several hundred target classes according to the degree of conformity of the text to this class, after which if we take the top 3% of classes, the target class will be in this list with 76% probability, and 9% of classes the probability already exceeds 90%.  Without exaggeration, it is an amazing result with great practical benefits for the customer. <br><br>  I invite you to listen to a more detailed report with a detailed description of the algorithm, formulas, schedule and results at the next Dialogue. <br><br><h5>  How else to use the semantic vector? </h5><br>  The semantic vector of the text, as already mentioned, consists of meaningful (no one will comprehend all two thousand elements of the vector, but it is possible) elements.  Yes, they are not independent, but, nevertheless, they are a ready-to-use feature vector that can be loaded into your favorite universal classifier ‚Äî SVM, trees, or deep grids. <br><br><h4>  findings </h4><br>  The method of transforming text of arbitrary length into a vector based on vector representations of words Word2Vec really works and gives good results in the problems of clustering and text classification.  The signs of the text, encoded by the semantic vector, do not degrade with an increase in the length of the text, but vice versa - they allow for a more subtle differentiation of long texts from each other and strongly separate texts with substantially different lengths.  The total amount of calculations is modest - one month on a normal server. <br><br>  We are happy to answer your questions in the comments. </div><p>Source: <a href="https://habr.com/ru/post/277563/">https://habr.com/ru/post/277563/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277539/index.html">Yelp, Wunderlist and GIPHY introduced new type applications</a></li>
<li><a href="../277541/index.html">Another approximation by polynomial of a function of several variables</a></li>
<li><a href="../277543/index.html">Clean code architecture and development through testing in PHP</a></li>
<li><a href="../277545/index.html">Game design f2p games or how not to make mistakes</a></li>
<li><a href="../277559/index.html">How Relap.io is organized - a service that issues 30 billion recommendations per month</a></li>
<li><a href="../277565/index.html">Framer Animation for Beginners</a></li>
<li><a href="../277567/index.html">Windows 10 application with data in the cloud using Azure Mobile Apps</a></li>
<li><a href="../277569/index.html">Battle for sound speed on Android x86</a></li>
<li><a href="../277571/index.html">Security Week 07: Apple vs. FBI, global glibc vulnerability, crypto-fiber and medicine</a></li>
<li><a href="../277573/index.html">Kotlin 1.0. Ask the team a question</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>