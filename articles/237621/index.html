<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Steering behavior. Types of changing the direction of movement of the character on the go</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When developing games, it is often necessary to implement the following of some route. For example, a character needs to build a path from point A to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Steering behavior. Types of changing the direction of movement of the character on the go</h1><div class="post__text post__text-html js-mediator-article">  When developing games, it is often necessary to implement the following of some route.  For example, a character needs to build a path from point A to point B. Suppose we calculated it using some kind of path finding algorithm, let's go.  And here it turns out that from point C to point D there goes another unit and crosses our way and we should get around it.  What to do?  Constantly rebuilding the path is expensive, a lot of unnecessary computational costs, when it is enough to slightly change the direction already during the movement to avoid a collision. <br>  Types of changing direction in the course of movement and steering steering. <br><a name="habracut"></a><br>  This note is a translation of the first article in the <a href="http://gamedevelopment.tutsplus.com/series/understanding-steering-behaviors--gamedev-12732">Understanding Steering Behaviors</a> cycle written by Fernando Bevilacqua. <br><br>  In Russian, it turned out to be difficult to choose an adequate translation. I decided to use the term "Stiring", which I met most often in Runet.  Stiring helps the characters to move in a realistic manner, using simple forces, the union of which allows for very natural movement of the characters around the world around them.  The ideas behind the styring were proposed by <a href="http://www.red3d.com/cwr/">Craig Reynolds</a> .  They do not use complex strategies associated with planning paths or huge calculations, instead using available information, such as the forces acting on neighboring characters (units).  This makes them easy to understand and implement, while allowing very complex patterns of movement. <br>  To understand this article should have a general idea of ‚Äã‚Äãthe mathematics of vectors.  For those who want to refresh their knowledge in memory, I recommend reading the following article ( <a href="http://habrahabr.ru/post/131931/">Linear algebra for game developers</a> ). <br><br><h4>  Position, Speed ‚Äã‚Äãand Movement </h4><br>  You can implement all the forces involved in changing the direction of travel with the help of mathematical vectors.  Since these forces will influence the character‚Äôs speed and position, the use of vectors is a good approach. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Although the vector should have a direction, it will be ignored when we talk about the character's position vector (we will assume that the radius vector is directed to the character's current location). <br><br><img src="https://habrastorage.org/files/6f4/d83/796/6f4d83796e5a4b3992ecd5b9abd5f099.png"><br>  The figure above shows the character - its coordinates (x, y);  V (a, b) is the velocity vector.  Movement is calculated according <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25AD%25D0%25B9%25D0%25BB%25D0%25B5%25D1%2580%25D0%25B0">to the Euler method</a> . <br><br><pre><code class="actionscript hljs">position = position + velocity</code> </pre> <br>  The direction of the velocity vector will control where the character is going, while the length of the vector indicates how far the character moves per unit of time.  The greater the length of the vector, the faster the character will move.  As a rule, the velocity vector can be limited to any value, as a rule, the maximum speed in the simulated world is used. <br>  The speed is calculated as follows: <br><br><pre> <code class="actionscript hljs">velocity = normalize(target - position) * max_velocity,</code> </pre><br>  where <i>target</i> is the target to which we are moving, <i>position</i> is the current position of the character, <i>max_velocity</i> is the maximum speed <br><br>  It should be noted that without styling, the character moves only in a straight line and, if the target changes, changes its direction instantly.  These movements look very unnatural. <br><br><h4>  Calculation of forces </h4><br>  One of the ideas of the styling is to influence the movement of the character, through the addition of steering forces.  Depending on them, the character will move in one direction or another. <br><br>  For behavior, the desire (seek bahavior) adding control force to the character, causes him to smoothly adjust his speed, avoiding abrupt changes in the route.  If the target moves, the character will gradually change its speed vector, trying to reach the target in its new location. <br><br>  Behavior Aspiration uses two forces: the desired speed (desired velosity) and the steering force (steering force): <br><br><img src="https://habrastorage.org/files/253/bfc/ea5/253bfcea5ac345cea6419b2759ea84bd.png"><br><br>  The desired speed is the force that directs the character to his goal along the shortest possible path.  The control force is the result of subtracting the current speed from the desired one and pushes the character towards the target.  These forces are calculated as follows (remember that all operations are performed on vectors): <br><br><pre> <code class="actionscript hljs">desired_velocity = normalize(target - position) * max_velocity steering = desired_velocity ‚Äì velocity</code> </pre><br><h4>  Adding strength </h4><br>  After the control force vector is calculated, it must be added to the character (to the velocity vector).  Adding a control force every moment in time will allow the character to abandon the direct route and head for the goal along a smooth line (the orange curve in the figure below). <br><br><img src="https://habrastorage.org/files/833/a3b/c6d/833a3bc6d0eb46bca573d62fc7c81afc.png"><br><br>  The addition of these forces and the final calculation of speed and location are as follows: <br><br><pre> <code class="1c hljs">steering = truncate (steering, max_force) steering = steering / mass velocity = truncate (velocity + steering , max_speed) position = position + velocity</code> </pre><br>  The control force may not exceed the maximum allowed force that can act on the character.  Also, the controlling force must be divided by the mass of the character, which will allow you to calculate different speeds depending on the weight of the character. <br><br><h4>  Run away </h4><br>  Behavior Avoiding (flee behavior) uses the same forces as Seek Behavior, but they allow the character to move away from the target. <br><br><img src="https://habrastorage.org/files/008/07f/2dd/00807f2ddb034ea5b86de8822a74a72e.png"><br><br>  The new vector of the desired speed is calculated by subtracting the position of the character from the position of the target.  The result is a vector that goes from the target to the character.  The control force is calculated almost similarly: <br><br><pre> <code class="actionscript hljs">desired_velocity = normalize(position - target) * max_velocity steering = desired_velocity ‚Äì velocity</code> </pre><br>  The desired speed in this case is the simplest route that the character can use to get away from the target.  The control force allows the character to abandon the current route, pushing it in the direction of the desired velocity vector. <br>  Thus, between the final vectors in the behavior of Aspiration and Avoidance, the following correspondence can be established: <br><br><pre> <code class="actionscript hljs">flee_desired_velocity = -seek_desired_velocity</code> </pre><br>  In other words, the vectors are opposite in direction. <br><br>  Once the control force vector has been calculated, it must be added to the character‚Äôs velocity vector.  Thus, this force pushes the character away from the target, and at each moment of time the character stops moving toward the target and starts moving away from it (the orange curve in the figure below) <br><br><img src="https://habrastorage.org/files/30f/2d1/508/30f2d150883c471d85ba7a11b0a7eddc.png"><br><h4>  Conclusion </h4><br>  Stiring is a good tool for creating realistic motion patterns.  Despite the fact that the calculation is simple to implement, the method shows very good results in practice. </div><p>Source: <a href="https://habr.com/ru/post/237621/">https://habr.com/ru/post/237621/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../237609/index.html">Retirement IT-specialist (survey)</a></li>
<li><a href="../237613/index.html">Javascript transducers. Part one</a></li>
<li><a href="../237615/index.html">Writing testable javascript</a></li>
<li><a href="../237617/index.html">RailsClub'Moscow 2014: Interview with Ravil Bayramgalin</a></li>
<li><a href="../237619/index.html">Tables - Emacs and org-mode</a></li>
<li><a href="../237625/index.html">10 performance indicators that every online store owner should follow</a></li>
<li><a href="../237627/index.html">Infrastructure for load testing in the cloud - with Visual Studio 2013 and only when necessary</a></li>
<li><a href="../237629/index.html">Cell Steppers</a></li>
<li><a href="../237631/index.html">What could be the AI ‚Äã‚Äãprogram</a></li>
<li><a href="../237633/index.html">To help the leading "Mafia"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>