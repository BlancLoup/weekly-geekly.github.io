<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Protect" mp3 files on amazon.com</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. 
 Not so long ago, they gave at work a task to study the fact of the presence of any hidden information in the required mp3-files. Because it w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Protect" mp3 files on amazon.com</h1><div class="post__text post__text-html js-mediator-article">  Hello. <br>  Not so long ago, they gave at work a task to study the fact of the presence of any hidden information in the required mp3-files.  Because  it was not exactly known whether something was in them or not, the task seemed almost insoluble.  At one time, he wrote a diploma on the topic of hiding information in audio files (audio steganography) and imagined that if you wanted to hide something, it would be almost impossible to detect it.  First of all, I started searching from reading the ID3 tag fields, I remembered that there is, in particular, the Lyrics tag (which serves to save the lyrics), the contents of which are not displayed in the same winamp. <br><br>  In practice, this field was empty. <br>  After some time of communication with Google, I first came across an article on Amazon MP3 ( <a href="http://en.wikipedia.org/wiki/Amazon_MP3">http://en.wikipedia.org/wiki/Amazon_MP3</a> ), and then already on songs on amazon.com, which contain some ‚Äúunique purchase identifier‚Äù . <a name="habracut"></a>  The article will be devoted to the study of this identifier. <br><br>  Let's take it in order. <br>  On September 25, 2007, amazon.com launches a public beta version of the online music store, which in early 2008.  became the first music store to sell music without digital copyright protection (DRM).  From the same article in the wiki we learn that initially Amazon did not sign the mp3 files sold by it with a digital watermark, some of the files were signed by labels to identify the seller, but not the buyer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Since 2011, the company's policy has changed and for some songs they began to write explicitly that they contain a unique purchase identifier. <br><br>  A couple of these tunes: <br>  <a href="http://www.amazon.com/Silent-Night/dp/B0047E6AR2/ref%3Dpd_sim_dmusic_t_5%3Ftag%3Dacleint-20">http://www.amazon.com/Silent-Night/dp/B0047E6AR2/ref=pd_sim_dmusic_t_5?tag=acleint-20</a> <br>  <a href="http://www.amazon.com/gp/product/B005I0DKPO/ref%3Ddm_dp_trk1">http://www.amazon.com/gp/product/B005I0DKPO/ref=dm_dp_trk1</a> <br><br>  Official information on the Amazon website: <br>  <a href="http://www.amazon.com/gp/help/customer/display.html/ref%3Ddm_adp_uits%3Fie%3DUTF8%26nodeId%3D200422000">http://www.amazon.com/gp/help/customer/display.html/ref=dm_adp_uits?ie=UTF8&amp;nodeId=200422000</a> <br><br>  If in Russian: the downloaded file will contain a unique identifier for the purchase, the date / time of the purchase and other information about which below. <br><br>  Downloading these songs into the forehead did not work out (Amazon swears and says that they can only sell them in the US).  I had to ask American acquaintances and after a while I had the same song in my hands, but independently downloaded by two different people from different accounts in the Amazon.  By the form, the files were exactly the same, the size coincided up to a byte. <br><br>  But since  Amazon wrote that it included a download identifier in every mp3 and decided to check some of the data for the two existing files and found the differences immediately. <br><br>  At the beginning of each encrypted file there is a private frame, starting with PRIV and then xml. <br><br>  Here is an example: <br><br><img src="http://dl.dropbox.com/u/175676/habrahabr/amazon-1.png" alt="image"><br><br>  Separately xml: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/49b/f36/0cc/49bf360cc541883460eb9e5bd16d1609.jpg" alt="image"><br><br>  (Part of the data was deliberately changed) <br>  And what we see: <br>  <b>C2br1vaR</b> - Amazon random numbers assigned to order <br>  <b>Amazon.com</b> - Amazon.com Store Name <br>  <b>2011-12-08T03: 10: 50Z</b> - Date and time of purchase of the song <br>  <b>00011805301110</b> - apparently this is the album ID (Universal Product Code) <br>  <b>USAG21130102</b> - <a href="http://ru.wikipedia.org/wiki/ISRC">International Standard Audio / Video Recording Number</a> <br>  <b>KRXaw + vu1wr8bB2cCNxJScKWcFKk7fDg</b> - the number of the sale transaction, which in the Amazon database are tied to the credit card number, address, and so on customer data <br>  <b>user-name</b> - customer identifier (the initial part of the customer's email) <br>  Next come a few more options.  Most likely this is a digital signature by which it will be possible to determine whether the file has been modified or not. <br><br>  With this information on hand, you can unambiguously determine who, from whom and when bought this composition.  And if this record will later be laid out somewhere ... then it will be clear from where the legs grow. <br><br>  According to our own observations, this section of PRIV, along with xml, takes about 8kb of mp3-file (more precisely, the necessary information itself takes less than 1kb, the rest is supplemented with zeros) <br><img src="http://dl.dropbox.com/u/175676/habrahabr/amazon-2.png" alt="image"><br>  ... <br><img src="https://habrastorage.org/getpro/habr/post_images/bcc/f93/8b7/bccf938b73db429c7994491ab8a12c84.png" alt="image"><br>  ... <br><img src="https://habrastorage.org/getpro/habr/post_images/bbf/d16/56f/bbfd1656fd2b949f2bd412b22b811bce.png" alt="image"><br><br>  In this case, non-destructive audio data steganography, that is  The embedded data does not affect the audio data itself, but hides in the service fields that are not displayed in the most common ID3-Tag scanners. <br>  In one foreign blog, a certain craftsman has already laid out a program that removes ‚ÄúAmazon's kind of information‚Äù - <a href="http://invertedsky.net/desiccate/">http://invertedsky.net/desiccate/</a> . <br>  It can work in batches, can first analyze the files and indicate to the user whether these fields are in the file or not. <br><br>  Googling, stumbled upon another import blog, the owner of which made the ID3-Tag viewer, capable of reading all the frames in an mp3 file according to standards - <a href="http://glassocean.net/perrys-id3-tag-viewer/">http://glassocean.net/perrys-id3-tag-viewer/</a> . <br>  Thus, the most common at first glance (and hearing) mp3-box can contain a lot of useful and even confidential information. <br><br>  Listen to good music and be more attentive when sharing music! </div><p>Source: <a href="https://habr.com/ru/post/134523/">https://habr.com/ru/post/134523/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134517/index.html">TOR: Negligence of leadership</a></li>
<li><a href="../134518/index.html">Critical error in the method of processing SMS messages in Windows Phone 7</a></li>
<li><a href="../134520/index.html">Co-ownership and domain management</a></li>
<li><a href="../134521/index.html">We decorate the desktop with random wallpapers with GoodFon</a></li>
<li><a href="../134522/index.html">HTC Titan - all-aluminum shell</a></li>
<li><a href="../134524/index.html">MongoDB: Creating, updating and deleting documents</a></li>
<li><a href="../134525/index.html">Firefox does not fit in 32-bit address space</a></li>
<li><a href="../134526/index.html">Arduino in production *</a></li>
<li><a href="../134527/index.html">Belarus Startup'2011</a></li>
<li><a href="../134528/index.html">WordPress 3.3 ‚ÄúSonny‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>