<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to manage a microcontroller, without attracting the attention of orderlies</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Microcontrollers are everywhere, in transport, at work, in medicine, in everyday life. Thanks to them, the ability to ‚Äúsolder a lot‚Äù was replaced by t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to manage a microcontroller, without attracting the attention of orderlies</h1><div class="post__text post__text-html js-mediator-article">  Microcontrollers are everywhere, in transport, at work, in medicine, in everyday life.  Thanks to them, the ability to ‚Äúsolder a lot‚Äù was replaced by the ability to program.  The fact that yesterday it was necessary to re-solder is reprogrammed today.  The elementary multivibrator, for the project of the next tweeter, performed on the microcontroller, will be more reliable and cheaper, the analogue on separate components.  And such a trend, in my opinion, will only increase. <br><br>  A part of not complex projects on microcontrollers, such as light switches or level sensors, once debugged, no longer require any additional settings.  However, most projects still involve interaction with the outside world.  For example, a thermostat or a timer needs the ability to adjust and control given values.  Most often, this function is implemented by adding user interaction mechanisms to the project.  And the simplest project begins to acquire screens, buttons, encoders ... <br><a name="habracut"></a><br>  Part of the already limited resources of the microcontroller goes to the maintenance of the entire infrastructure of user interaction.  As a result, the core carrying all useful functionality, the microcontroller and power switches, occupy 5-10% of the physical volume.  Everything else is auxiliary, screens and buttons. <br><br>  This state of affairs is almost universally.  Significant efforts are spent on the creation of all these control panels for TVs, air conditioners, refrigerators, machine tools ...  Crazy multi-level menus-quests are composing ... In addition, all these built-in mechanical buttons and encoders, screens often break.  In some cases, resulting in the uselessness of a fully functional otherwise. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the same time, all these buttons and screens have limited potential for use, compared to any mobile gadget in the pocket of each of us ... With a convenient, large, contrast, touch screen and a fairly productive ‚Äúiron‚Äù.  In addition, many on the shelf gathering dust no less powerful, completely serviceable, outdated, device, sometimes not one.  Which to throw out ... until the hand rises. <br><br>  In this regard, it would not be bad, in projects on microcontrollers, to completely abandon screens and buttons and transfer all the functionality of monitoring, control and control to mobile devices.  Well, or on computers.  As a result, in my opinion, it will be more user-friendly and more effective solution. <br><br>  Work in this direction is already underway.  For example, there are <a href="http://www.mi.com/en/scale/">models of floor scales</a> , which through Bluetooth allow not only to see the weight on the mobile phone, but also to track the history of its change.  However, so far, the built-in weight indicator is still not discarded ....  until. <br><br>  I think, soon enough, everything will come to the fact that having bought a household appliance, the user, in order to use its functionality, will need to download from the manufacturer‚Äôs website, and install the application on his phone. <br><br>  So why now, since the advantages are so obvious, don‚Äôt start transferring from the microcontroller a part of the user interaction functionality to the side of mobile devices. <br><br>  The answer is simple. <br>  It's complicated. <br>  Distributed systems are always much more complicated. <br><br>  And the complexity is not in the very principle of communication / transport, which has already been managed to be formalized as UART, I2C, CAN ..., but in the complexity of writing the protocol itself over transport.  Some of the problems: tracking the failure of the channel, requesting a retransmission, scheduling packets ... for machines with sufficient resources, could be implemented as TCP / IP.  But the rest, the writing of the actual communication protocol itself is specific for each project and requires considerable expenses.  One of the ways to simplify the problem can be automation of the programming process. <br><br>  For this, as a rule, they create a language (DSL) with which they formally describe a protocol, and then create a program that, based on this description, generates source code for various target platforms in the required programming languages.  There are a lot of examples of ready-made solutions in this style. <br><br>  <a href="https://developers.google.com/protocol-buffers/docs/overview">Protocol buffers</a> <br>  <a href="https://capnproto.org/language.html">Cap'n proto</a> <br>  <a href="http://google.github.io/flatbuffers/flatbuffers_guide_writing_schema.html">Flatbuffers</a> <br>  <a href="">ZCM</a> <br>  <a href="https://github.com/mavlink/mavlink">MAVLink</a> <br>  <a href="https://thrift.apache.org/docs/idl">Thrift</a> <br><br>  The complexity of the exchange protocol can be estimated <a href="">by one of the descriptors of</a> the exchange protocol with the quadcopter.  In this example, XML is selected as the protocol description language. <br><br>  For microcontrollers, many solutions from the world of large machines, such as TCP / IP, are not applicable due to limited resources.  We have to remember and use <a href="https://en.wikipedia.org/wiki/Cyclic_redundancy_check">CRC</a> , <a href="https://web.cs.wpi.edu/~rek/Undergrad_Nets/C04/BitByteStuffing.pdf">Bit / Byte stuffing</a> , <a href="https://en.wikipedia.org/wiki/Endianness">Endianness</a> , and also take into account many other, sometimes completely unobvious subtleties like <a href="https://www.youtube.com/watch%3Fv%3DJijOpH75xG8">this</a> or <a href="https://www.youtube.com/watch%3Fv%3DmS-6n5yAjR0">that</a> .  Attempting to solve a problem by manually writing code can turn a programmer‚Äôs creative life into hell.  Similar to the one that was with java script support on different browsers.  Only here are different languages ‚Äã‚Äãon completely different platforms.  Even small changes to a debugged protocol can lead to a very long debugging process. <br><br>  Not many of the above tools, in their kodogeneratsii fall to the level of microcontrollers.  Attempting to use the mentioned code generation tools hardly managed to pull on the older 32 bit series microcontrollers.  The most popular, cheap and widespread 8-bit microcontrollers were left out.  I very often come across projects in which the most correct would be the removal of controls on a mobile device.  Sometimes it was possible to do this, but further maintenance and expansion of the functional became very difficult. <br><br>  Having gained considerable experience in using existing code generation tools, understanding their advantages and disadvantages ... after a while I created my amusement park ... <b><a href="https://github.com/cheblin/BlackBox">BlackBox</a></b> . <br><br>  The code generator itself was decided to write on <b>SCALA</b> , the well-known language <b>JAVA</b> was taken as the basis for the protocol description language. <br><br>  Why is that?  The language is simple, for <b>JAVA</b> the largest number of really convenient development environments has been created.  It turned out to have enough language constructs in order to describe not only the types of data transmitted in the packet, but also many additional characteristics and, very importantly, the network topology. <br><br>  <b>BlackBox</b> generates source code in the following programming languages <b>JAVA, C #, C.</b> Support for <b>SWIFT</b> is planned <b>.</b> <br><br>  At the moment, the <b>BlackBox</b> code generator is built as <b>SaaS</b> .  To obtain the generated and tested code, you must: <br><br><ul><li>  Create a protocol specification.  In fact, this is the usual source for java.  <a href="">Here's an example of</a> how it looks for a control project demo with Android by flashing the LED on the board under STM8S103F3P6 via Bluetooth UART on HC 08. When writing a specification, you need to connect a <a href="https://github.com/cheblin/BlackBox/tree/master/org/unirail/BlackBox">set of annotations</a> describing the characteristics of the data to the java project, and also, <a href="http://www.unirail.org/%3Flang%3Dru">following a small set of rules,</a> describe the packets, channels, hosts, communication interfaces, network topology </li><li>  Check that the specification is successfully compiled, and send its source, in the form of attachment of a letter to the postal address of <b>OneBlackBoxPlease@outlook.com</b> .  The server periodically takes the sent specifications from this mailbox, checks their correctness.  Generates the ordered source code in the required programming languages.  After this, several tests are created and the sources are run through them.  If all the tests were successful, the generated code, the last test passed, as well as an example of using the ordered API is packed into the archive and sent to the addressee.  If an error is detected, the sender is notified of a possible delay and the BlackBox support service understands the difficulty encountered. </li></ul><br>  <a href="https://github.com/cheblin/BlackBox_LEDBlink_Demo/tree/master/Generated">Here you can find</a> an example of the generated generated code, <a href="https://github.com/cheblin/BlackBox_LEDBlink_Demo/tree/master/Examples">and here the use of</a> this code in the above-mentioned, demonstration project of control with android flashes of the LED on the demo board collected on <b>STM8</b> . <br><br>  Using <b>BlackBox</b> you can easily establish communication not only between microcontrollers, mobile devices, but also ordinary computers.  And what is important, with minimal time and effort.  In fact, the code generated by the <b>BlackBox</b> can be the skeleton of your distributed application.  The programmer will just have to add handlers to the packet receiving events, as well as the logic for creating the packet, filling it with data and sending it to the recipient. <br><br>  Take a look around how many projects can win by following this paradigm.  <a href="http://e-design.com.cn/">Here are the guys from Guangzhou</a> made oscilloscope <b><a href="https://www.youtube.com/watch%3Fv%3DlxxS6rvrk3o">DS212</a></b> .  If you move the screen and controls to the side of a mobile phone or tablet, you can: <br><br><ul><li>  significantly reduce the cost of the product </li><li>  Significantly improve ergonomics with all touchscreen features. </li><li> the oscilloscope itself, becoming even more compact, will be located where the measurement directly takes place, and the result will be displayed where it is convenient for the user, within 10 meters, if it is Bluetooth. </li><li>  receiving the measured data through the bes wire and powering the oscilloscope from the battery, which it will now consume much more modestly, we get a reliable galvanic isolation. </li></ul><br>  In addition, in the process of creating code generation for JAVA, I thought about the <a href="https://www.youtube.com/watch%3Fv%3DHzs6OBcvNQE%26feature%3Dyoutu.be">problems and shortcomings of the enum construction built into JAVA</a> .  As a solution, Android programmers suggest using <a href="https://developer.android.com/reference/android/support/annotation/IntDef.html">IntDef</a> annotation. <br><br>  Creatively rethinking, I created my solution <a href="https://github.com/cheblin/SlimEnum">SlimEnum</a> .  It is actively used in BlackBox during code generation on JAVA.  For ease of programming using SlimEnum, a plugin for IDEA / Android studio was created, which can be installed from the Intellij plugin repository.  <a href="https://github.com/cheblin/SlimEnum">SlimEnum itself</a> , its advantages and features will be described in a separate article. </div><p>Source: <a href="https://habr.com/ru/post/374149/">https://habr.com/ru/post/374149/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../374139/index.html">Nakraudfandili: 15 most successful projects of 2017</a></li>
<li><a href="../374141/index.html">Let the new, in 2018 ...</a></li>
<li><a href="../374143/index.html">Kaluza-Klein Partner Particles, Part 1</a></li>
<li><a href="../374145/index.html">Astronautics 2018 - overview of missions and launches</a></li>
<li><a href="../374147/index.html">Christmas gifts, part two: Specter</a></li>
<li><a href="../374151/index.html">How not to become dependent on public opinion, and why is it not disgraceful to be a bydlokoder?</a></li>
<li><a href="../374153/index.html">Intel Core Processors with Radeon Vega Graphics Officially Presented</a></li>
<li><a href="../374155/index.html">The choice of HashFlare: five promising cryptocurrencies that are worth paying attention to in 2018</a></li>
<li><a href="../374157/index.html">WD My Cloud backdoor for everyone</a></li>
<li><a href="../374159/index.html">Astronomers built a 3D model of the center of the Milky Way based on data from the Chandra orbital observatory</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>