<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What does it mean to develop a robot</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="You read about robots and programming and think: ‚ÄúIt would be great to do something like this on your own!‚Äù Those who take this idea a little more jus...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What does it mean to develop a robot</h1><div class="post__text post__text-html js-mediator-article">  You read about robots and programming and think: ‚ÄúIt would be great to do something like this on your own!‚Äù Those who take this idea a little more just look at who and how did their robot do.  Read articles, watch videos.  The pictures are clear.  In the videos, ready-made products are also usually shown, as well as their production technologies.  And it seems that everything is clear: sawed off, screwed, soldered, connected, programmed out on that program with this code. <br><br>  Even more enthusiastic, choosing an interesting and, at first glance, simple option, go into action and, often copying, make their first robot.  This is a strong-willed and very significant decision - the main thing is to start at least do something yourself!  In the process of manufacturing, there is a lot of technological stumbles up to the point that it turns out for ordering / buying some items, you need to find out how exactly it is called.  And yet - the connectors are not soldered normally - and how does everything work with a one-touch video?  The creation process is often delayed, but the persistent beginner robotics somehow finishes the result to some meaningful first launch at least ‚Äúin a straight line‚Äù. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fc4/b03/73a/fc4b0373af834c11a42adef8d76e1e70.JPG"></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Then, when the robot is finished, there comes an understanding of why everything is being done this way and in that sequence.  The creation process can already be somehow realized, formalized, painted.  It is from this moment that the <b>development of the</b> model of the next, second generation begins. <br><a name="habracut"></a><br>  Yes, I also read articles with interest before.  And now I read!  I especially like articles about copters: from the ground, yes to heaven!  However, to be honest, they caused only thoughts in me.  Moreover, it was necessary to understand programming, and the last time I worked with C at the institute, everything was completely forgotten.  I know what Arduino is, but I have never seen it live.  And so on.  I have a technical education, I deal with DSP on FPGA.  Technically, there are no obstacles for me to take and figure out, but ... in fact, I do all this at work and I have all this business there, as they say, "above the roof."  As a result, I needed some kind of good incentive to somehow start doing this.  Stimulus appeared when it became necessary for someone else: the truth is that real creation is when you give to others. <br><br>  My good friend, who is one of the founders of <a href="http://endurancerobots.com/">Endurance</a> , a young (one might say freshly baked) company, knowing the nature of my work, turned to me on a number of technical issues.  It turned out that the guys have developers in the USA and have already presented their prototype of the super-cheap (phone + plastic platform with wheels on the Arduin - it seems to be cheaper and nowhere) a telepresence robot.  But they wanted not just to do one marketing and business in the style of ‚Äúbought there - sold here‚Äù, but they wanted to immerse themselves in more detail into a technical topic and even plan to develop their own model (even if equivalent in principle and functionality), but here in Russia, in order to obtain not only the finished result, but also understandable by the technology of its manufacture.  Such is the premise of participation in this matter of your humble servant (I hint at myself). <br><br>  At first, I also read articles, looked where they buy and how they do it.  But there was no single picture.  It seems that, in general, everything is clear, but at the same time not everything.  It is not clear how to control from a computer, how to deliver video to a computer.  Moreover, I am not a softphone and I would not like to ‚Äúdig out‚Äù this, soft, theme from scratch, although it would be interesting, of course;  so I somehow successfully satisfied all my needs with the AutoIt scripting language.  As a result of the search, I found two key resources that have become key for me: the online store <a href="http://carduino.ru/">carduino</a> and the <a href="http://www.cyber-place.ru/">cyber-place</a> forum.  The store could buy all the necessary components - all in one place. <br><br>  Prices, compared with ebay or ali, of course, wild, but the main thing was not the case - you could buy a platform and the necessary body kit for it, as well as all small things.  And it was convenient to pick up / order.  At the forum in the section "Do it yourself" \ "Robotics" and "Do it yourself" \ "CyberWrt" you can learn general information, as well as how to organize a detailed computer connection with the robot via Wi-Fi.  Ten years of experience in the specialty made me feel, and instead of immediately starting to copy, twisting or programming something, I picked up a pencil and paper ... <br><br>  What does ‚Äúdevelop‚Äù mean?  It is clear what ‚Äúmake a robot‚Äù means - you take it and ... you do it!  And how to ‚Äúdevelop‚Äù it? <br>  Below I tried to describe the process, namely, development, and not the creation of a robot.  The creation of a robot, as a construction, is initially intuitive and understandable.  As the creation is screwed this - this, this - this.  Ponakrutil so - and suddenly it turned out that the second part, it is necessary to fasten otherwise, then the eighth part will stand up like a glove, you just need to move the wiring from the batteries to the left closer to the fifth part, and in order not to dangle, it is better to attach to the fourth, slightly turning them as there will be the tenth part there.  Sheer creativity.  And let's try for an adult: first we will think about what we will do, and then we will do it :) <br><br>  So, what will be discussed in this article.  I decided not to write about how I did the robot, there are a lot of such articles and there is no sense in the appearance of another one.  I‚Äôm certainly not the first, or even the tenth, who on the purchase platform, having mounted the sensors, made the toy to the delight of myself and others.  I decided to try, so to speak, to state my technology of thinking.  I tried to convey to readers not just the fact that it is not so difficult to make a robot, but to explain the methodology by which you can take and try to make your robot from scratch, and the beginning of robotics will be clear and understandable the steps of creation initially, rather than opening advancement into the unknown. <br><br>  Imagine a person who has never worked on robotics.  He has a friend, a soldering iron, a multimeter and any hand tools such as nippers, screwdrivers and others.  Introduced yourself?  Fine!  Go‚Ä¶ <br><br><hr><br><br>  <b>The first stage - understanding</b> <br><br>  What do we want to do?  And why is it necessary? <br><br>  For me, this issue was initially resolved for me - I need to make a machine with a video camera that could connect via Wi-Fi or the Internet to a computer, on the computer I would see the picture from the machine and control it, causing it to move.  It seems to be understandable, but somehow boring and something is missing.  Remote control - is it some kind of robot?  Robot?  What is a robot?  A robot is some kind of autonomous thing that does the work itself.  How to apply it for this task?  And let the machine will drive itself!  As such, the formulation of the problem is not - well, let him go as he pleases.  However, if she drives as she pleases, she will collide with objects.  This is somehow wrong, wrong.  So, the machine should be able to see ahead of itself and go around obstacles, preventing a collision.  How can I do that?  You can process the data from the camcorder.  Uh-uh ... somehow it is not clear how to approach this at all.  Probably it is not easy.  What else do we have?  Sold all sorts of infrared and laser distance meters!  You can buy this and somehow get the distance from it.  This is crazy, but there is something in it ... <br><br>  Based on thinking, the idea is born, the concept of the device.  The result of reflection should be presented in general terms thesis and briefly, concentrating the essence.  You need to get a device that: <br><br>  - is able to move on the surface according to the operator's commands, broadcasting video to him in front of himself; <br>  - has an autonomous mode of "existence": can independently move in an arbitrary direction; <br>  - controls the situation in front of him; <br>  - in case of detection in front of some object, it does not allow itself to collide with it, ignoring the operator‚Äôs commands, or changes the direction of movement in the autonomous mode. <br><br>  It seems to have decided on the goal.  We take a soldering iron and arrange it on the table.  You can wrap in a rag - it will be softer, more comfortable.  Let him get used to the situation. <br><br>  <b>The second stage - the study of reality</b> <br><br>  After we decided on the basic functionality and it became clear what needs to be done, the question arises: how to do it, what will it look like? <br><br>  You can take the hammer in your hands and tell your surroundings with a stern look, categorically: cover from the table, castors from chairs, a rubber band from underwear, a pair of Chinese chopsticks, 20 centimeters of cloth from the curtains, sandals from sandals, a laptop disassembled for parts - everything surrender to me in the name of progress!  So that there are no unnecessary questions to the voice, you can give shades of threat and spiritualization at the same time.  However, I propose a more efficient method: a tool created by people called the Internet is ideal for this purpose.  We type the word "Robot do it yourself" in the search engine that your religion allows you to use, and start reading, watching, listening and understanding.  This stage can last much longer than the previous one, since it is much easier to think of something to do than to figure out how to do it.  Moreover, in passing, you can still find out so much interesting! <br><br>  So, the result of this stage should be a more detailed abstract list, which will determine the form of what we came up with at the last stage.  Our device will look like this: <br><br>  - a three-wheeled platform with two engines: two driving wheels, the third - as a support; <br>  - powered by AA batteries (1.2-1.3V x 4 = approximately 5 volts - just suitable for engines); <br>  - the device will be controlled by the Arduino Nano microcontroller (motor control - through the driver of the engines, the microcontroller can be powered from 5V); <br>  - the range will be determined using an ultrasonic sensor (5V power supply); <br>  - the flashed router (5V power) will work as an access point, connecting to which you can connect to the web server and issue commands to the microcontroller, while we will have a picture from the webcam connected to the router; <br>  - two switches are installed on the device: ON / OFF power and ON / OFF standalone mode - from this point on, no devices, since it can work autonomously - it means the robot; <br>  - the robot is equipped with an LED that will light up when an obstacle is detected; <br>  - on the robot there will be two bright white LEDs on the front - lights - why not: when it‚Äôs dark, the robot shouldn‚Äôt be scared, and with a bright light it‚Äôs always more cheerful, the main thing is not to look back again - the video camera will be sent only forward; <br>  - the robot will have a webcam installed that will be connected to the router. <br><br>  This appearance we represent is based on the ideas that we received by studying the market of components for robots.  There is no detailed presentation of the robot to the screw - only common features, however, they allow us to imagine what the result will be.  In general, we come to the conclusion that everything can be bought in the carduino store, as well as to communicate with the robot using the router and setting it up in the same way as indicated on the cyber-place forum.  Until you understood the intricacies of connecting individual components and did not understand how to program the router.  But they realized that the individual components can be connected to each other (electrically and informationally), and also determined, at a minimum, the structure and appearance. <br><br><div class="spoiler">  <b class="spoiler_title">Robot components</b> <div class="spoiler_text">  Platform with wheels, engines and fasteners: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fdf/4eb/7a2/fdf4eb7a2c5b41c3841f3252d66f431a.jpg"></div><br><br>  Electronics fee: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/305/f92/e2b/305f92e2bb6740c28e34162258318061.png"></div><br><br>  Microcontroller Carduino Nano v.7: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b7a/4dd/08c/b7a4dd08c04a4d65bce7ed9376f20f91.jpg"></div><br><br>  Ultrasonic Sensor HC-SR04: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bd0/106/271/bd01062715a34e8bb40489a234bd2cfa.jpg"></div><br><br>  Driver for engine management: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/4d4/bda/1a4/4d4bda1a483a4fee904345bd2bcf17df.jpg"></div><br><br>  TP-Link MR3020 Router: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bd5/57b/2e1/bd557b2e13f64b46b2645ff538c68f9b.jpg"></div><br><br>  Hub (compact and miniature hub of an unknown model): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ec2/af9/8a9/ec2af98a9eca419aa300de32e4e46b29.JPG"></div><br><br>  Webcam (Logitech C270): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e7c/000/15b/e7c00015b34f418c8ec872b3c638bb12.jpg"></div><br></div></div><br><br>  The soldering iron lies on the table and looks interested at the pictures above.  Interest is clear - to solder it all to him! <br><br>  <b>The third stage - creativity: general development</b> <br><br>  So much time was spent, but the result is not yet visible!  The result is only in our heads in the form of images and thoughts.  Maybe it is worth somehow to materialize these thoughts?  How the appearance of the robot will look like is already clear.  Also defined a set of components.  How will it connect?  How will all this communicate with each other?  The robot - it's not a light bulb - clicked the switch and it caught fire.  Then he clicked the tumbler, the power went on - and then what?  And here, dear readers, the development begins to branch into three components: design, electrical and software. <br><br>  We will not have a full-scale engineering development, as we use everything completely ready.  All the visible design work will be in the successful gluing of individual boxes on double-sided tape and screwing the bolts in specially designated areas.  On a good bill, of course, there must be an assembly drawing of those components that are.  But, if we didn‚Äôt have a platform or foundation, then we should estimate the sizes of all components to be installed, calculate the dimensions and understand how much the base board will be made of, and how other components of the robot will be attached to it, and so on.  But, everything is simple here, the pictures of the final type of robot perform the role of an assembly drawing, therefore this direction of development in this article is not considered at all. <br><br>  After sitting and painting you can come to the following functional robot view: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5da/202/816/5da2028161664536a26d1ae45f74f03b.jpg"></div><br><br>  I apologize in advance for the quality of the pictures.  I got a lot of pictures, but I didn‚Äôt want to inflate the traffic under the cut, so I came to some compromise between quality and volume, which means that weighed a little, but was readable and understandable. <br><br>  What do we see in the picture? <br><br>  Our robot will consist of two independent parts: a communication unit and a control unit.  The communication unit communicates with the external operator, receives commands from it, and issues them to the control unit.  The control unit, taking commands, executes them.  That is, we divided the management into two levels - low-level (platform control, interaction with sensors) and high-level (interaction with the operator and command control of the low-level part).  The management task was divided into two parts that can be solved separately: first, deal with the moving platform in the form of an Arduino microcontroller, then with the connection in the form of a reconfigured router. <br><br>  Communication unit <br><br>  1) Elektkrotekhnika.  Here, it seems, in general, everything is clear: the camera gives video and sound and connects via a hub to the router.  To him through the hub and connects Arduino.  There is little wisdom to plug the cable into the USB connector, the probability of doing it wrong, or vice versa, is quite small. However, there is enough of this probability for some, but this is not about us !!!  We look, where we interpose, if we don‚Äôt climb, we just press it harder - it should fit, this is USB! <br><br>  2) Programming.  There is no development, as already used firmware is used for the router and ready-made modules for the robot.  The interface protocol with the control unit has already been identified for us - we also just need to figure it out.  How exactly to flash and what exactly to set up there - let's see later. <br><br>  Control block. <br><br>  1) Electrical engineering.  It seems, too, everything is clear.  We have a motherboard on which everything is unsoldered.  It will be necessary only to figure out where the sensors are connected to the Arduino and at the same time never mess up the extra work, confusing the ground with power.  In terms of connectivity, there seems to be no particular problems.  True, you don‚Äôt immediately figure out where on the board what is connected, but after looking at the <a href="http://cyber-place.ru/showthread.php%3Ft%3D404">works of the masters</a> , and also, having found the picture below, everything falls into place.  How is it and what is divorced - then we will understand, especially since nobody canceled the <a href="https://lurkmore.co/%25D0%259E%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D0%25B0%25D1%2582%25D1%258C_%25D0%25BD%25D0%25B0%25D0%25BF%25D0%25B8%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25BE%25D0%25BC">file rule</a> : if we do something, we will refine it! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dd9/cc3/627/dd9cc3627d9b458e99e88eb1707ef8ff.png"></div><br><br>  2) Programming.  And here is the problem.  How and what should be done there.  Here came the team.  What to do?  We take again a pencil with a piece of paper and draw.  As a result, you can get the following functional software scheme (platforms only): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/1bf/df0/594/1bfdf05944dc47b396041a1f74f5be3d.jpg"></div><br><br>  Turned out the next squares.  But now it is purely software modules.  Some materialization of that which cannot be touched and touched, but it is, as the robot moves on the basis of the logic of this level of abstraction. <br>  The command must be received by the interface module.  It is he who must recognize that the incoming data makes sense, that it is not interference or the wrong command.  When identifying a command, the module must inform the management module what kind of command it has come to us.  The command control module will have to perform some actions ‚Äî start moving, stop, ‚Äúsee‚Äù whether there are any obstacles ahead, turn on the lights or turn them off, and so on. <br><br>  If the offline button is pressed, the control module will have to determine whether there are any obstacles ahead and move forward by issuing the appropriate command to the motor module, as well as take some action if there is an obstacle.  The functions of directly controlling the end devices are partially delegated to other modules based on the level of complexity.  The control module, in order to order the module to move engines forward, needs to know whether it is possible to move forward.  In general, most likely, just like that, you will not receive data from an ultrasonic sensor - and why should we do this?  We only know how to command - there is a sonar module for working with the sensor!  Here we are requesting a report on the operational situation in front of the robot - can you go ahead? <br><br>  The soldering iron happily and imperceptibly got out from under the rag, looking with interest at the outlet: I wonder how many volts there are - 110 or 220? <br><br>  <b>The fourth stage - creativity: detailed development</b> <br><br>  What and how to do it is clear.  It is clear from what.  It is clear exactly how it should and will look functional.  It's time!  It's time to start doing something!  So many things have been read, viewed, appreciated, thought out, invented, rejected, painted.  Eh ... there, a soldering iron lies not far away.  Looking at us.  Perplexed - it would seem to take it and solder, then what to do with garbage?  We sigh and cover the soldering iron with a piece of paper: sleep for now, not everything is ready yet.  It is not enough to understand how everything will look functional, you need to understand how everything will look structurally.  It is necessary to maximally detail your understanding. <br><br>  Communication unit <br><br>  Practically everything was found out at the last stage.  All clear.  On the cyber-place forum, let's take a look at <a href="http://cyber-place.ru/showthread.php%3Ft%3D720">this topic</a> and understand how to flash the TP-Link MR3020 router and configure it.  Download the firmware for the router.  We create files with a description of where what IP to enter, what and where to click.  The only problem is that it is not clear which teams will be sent to the microcontroller.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After sitting on the forum, reading and talking it becomes more and more understandable (thanks more to everyone who answered me and tried to help). </font><font style="vertical-align: inherit;">We write all the commands in the same text file and mark which team is responsible for what. </font><font style="vertical-align: inherit;">It turned out to be simple - when you press a button, for example, ‚Äúforward,‚Äù a certain ASCII line of code is sent, and when you release the button, another command is issued - ‚Äústop‚Äù (which bytes are transmitted below).</font></font><br><br>  Control block. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At the previous stages we determined what exactly will be connected to the control unit. </font><font style="vertical-align: inherit;">The heart of the control unit is the Arduino nano.</font></font> What it is?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What are those bulbs responsible for and these connectors? </font><font style="vertical-align: inherit;">What conclusions are connected feet from sonar? </font><font style="vertical-align: inherit;">Anyway: how to communicate with the sonar? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We begin to study information on components. </font><font style="vertical-align: inherit;">Fortunately, the library does not need to go in the presence of the Internet. </font><font style="vertical-align: inherit;">We make for ourselves the technical descriptions of the components used. </font><font style="vertical-align: inherit;">You can read on the Russian-language resources which board how it works and take notes. </font><font style="vertical-align: inherit;">In order to understand how to connect and how to work with end devices, they create their own ‚Äúdatasheets‚Äù, in which everything is extremely brief, clear and understandable. </font><font style="vertical-align: inherit;">It may be enough just to study the English-language datasheet from the manufacturer, but sometimes it happens that the language is Chinese or the datasheet itself is quite voluminous (there are 200 pages), so it‚Äôs reasonable to make your own brief notes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Create for yourself a "help" on the microcontroller: </font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carduino Nano v.7</font></font></b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/files/a02/33a/c84/a0233ac8474d490eaf55ecc4f2ddcd1c.jpg"></div><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then we understand how peripheral devices are connected and controlled. </font><font style="vertical-align: inherit;">Engine Driver:</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L9110S chip driver</font></font></b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/files/527/e19/ec6/527e19ec666740f487b0e762bca3544b.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/daa/aaa/5fe/daaaaa5feff74c33b804d9924c9d6877.jpg"></div><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And ultrasonic sensor: </font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sonar HC-SR04</font></font></b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/files/153/643/c72/153643c726ee42188700730c83d79296.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a8c/6ff/eab/a8c6ffeab1af4fd8aeb64b0059e9d96e.jpg"></div><br></div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> After all this understanding, a block diagram of the connection of software modules is drawn, which reflects the interaction with them and contains information about what and where is connected (to which legs of the microcontroller): </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a6d/545/bf6/a6d545bf6b234a30a0566fcfa003e3dc.jpg"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drawing this scheme requires a good mental effort - after all, in fact, the framework is set, on which the code then falls. Here it is necessary to make a remark. The fact is that I am engaged in development on the FPGA, therefore, initially I painted the structure as I would for the FPGA. It should be understood that for SI-like programming the number of signals on the circuit is actually redundant. But on the other hand, we get a kind of platform independence - you can try everything on FPGAs, especially there </font></font><a href="http://marsohod.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">are options available</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's read this diagram from left to right. The UART interface module will receive the data. If the data is a command, then it issues the control byte CTRL under the pulse SCTRL gate to the control module. The control module, having received a strobe, understands that a command has arrived, reads the CTRL input and executes the command. Let's say the team came "forward." A pulse signal Get_Dist is output to the output and data on the Dist input is expected. In principle, we are not prohibited from constantly issuing Get_Dist pulses, in this case we can simply remove the distance value from the Dist input port at the right time. Suppose everything is fine with the range - the obstacle is still far away, and you can ride with a breeze. The motor control module sends a signal to the Mode bus, indicating that it is necessary to move forward with the set Speed.When measuring the distance and when moving to the corresponding LEDs, a high level is also given (logical unit) to indicate the operation and understanding of what is happening with the system (it will be useful for debugging).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The modular scheme is there! </font><font style="vertical-align: inherit;">In the head order! </font><font style="vertical-align: inherit;">It is clear how and what. </font><font style="vertical-align: inherit;">Now you just need to describe it - what each module should do and under what conditions.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interface module:</font></font></b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/files/f1c/c64/ade/f1cc64ade1c2484eb934aa70a5615cb9.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b5e/95a/3e0/b5e95a3e080c4240917c0b15cb56b9b1.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/542/b20/7a2/542b207a2cab46bcab01cf90002e34b2.jpg"></div><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Control Module:</font></font></b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/files/6ad/c0d/95a/6adc0d95ae97426991ac84fea07e0136.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/322/3b4/04b/3223b404be1b4c02a8c5eeb897345f21.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d08/b64/8a8/d08b648a809c40149ae463bb860229fd.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/478/4ed/1aa/4784ed1aa27b40e6a1014e39abd615bc.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/6cc/e9d/467/6cce9d46793843398eb18bbe07c45431.jpg"></div><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Range measurement module:</font></font></b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/files/ff8/198/7a3/ff81987a3d874f3a899108055a857594.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/217/4d3/3cb/2174d33cb85d489da431c99fd8d0934a.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9af/7cc/c9b/9af7ccc9bdee41008510e6f6e0eeba20.jpg"></div><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Motor control module:</font></font></b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/files/aef/33b/1ff/aef33b1ff6294f229d885468800f71ea.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/4fb/e88/a71/4fbe88a71b3245b485126e0a5727ed4c.jpg"></div><br></div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A tail with a plug from a soldering iron fell out from under the edge of the sheet around the corner of the table. The leaf slipped a little and opened its face. The soldering iron looks with an expression that does not even require the gesture ‚Äútwist the finger at the temple‚Äù: ‚ÄúTK writes himself to himself - what for heresy ... I was lucky with the owner, however,‚Äù he thought sadly, imperceptibly shaking his fork at the table. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fifth stage - creation</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Development is almost complete. All moments are clarified to the limit. It remains to create a miracle - from this heap of spare parts and a small stack of leaves with pictures, tablets, diagrams and diagrams to collect something, for which everything was started.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grab a sad soldering iron and turn on the outlet. He begins to bask and hiss with pleasure in those moments when we clean the sting on the sponge. Flux with solder lead a friendly round dance on the table. The sun peeks out the window, highlighting the spot solder SMD resistor on the board. Life is good when you solder slowly!</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e1e/1fb/83b/e1e1fb83ba094c66aa581307784ad78d.JPG"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/505/67c/486/50567c4866b94929a595e6ef4dca99dd.JPG"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The most fun and entertaining stage of development, which will not leave anyone indifferent. </font><font style="vertical-align: inherit;">There is already something interesting, obvious to everyone. </font><font style="vertical-align: inherit;">This stage contrasts with all the previous ones, since drawing some pictures with tablets, not only is it not interesting for the observer to sincerely understand how something can come of it. </font><font style="vertical-align: inherit;">And then ... it's so great when your first robot will drive its first centimeter on the table and respectfully stop from the edge exactly 20 centimeters just because you have blocked the edge of the table with your palm. </font><font style="vertical-align: inherit;">A clever tvaryushka turned out - he understands that he cannot continue!</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/340/1ae/4f8/3401ae4f874a4e56a4367046fada4e31.JPG"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3e5/0b2/057/3e50b20577f44312b3411d153a3e544c.JPG"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At this stage, we assemble the entire mechanical structure, solder the wires, and program the microcontroller. </font><font style="vertical-align: inherit;">We are testing what happened. </font><font style="vertical-align: inherit;">We do not understand.</font></font> We think.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We rule the TK, as in reality it turns out, perhaps, quite differently from what is written and invented! </font><font style="vertical-align: inherit;">We return again to the assembly. </font><font style="vertical-align: inherit;">We are testing. </font><font style="vertical-align: inherit;">We do not understand. </font><font style="vertical-align: inherit;">Do not lose heart. </font><font style="vertical-align: inherit;">We poke a multimeter and replace dead batteries. </font><font style="vertical-align: inherit;">We are happy ...</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/09b/a71/d3b/09ba71d3b2894819912d832310922e84.JPG"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5e2/504/859/5e250485914643cea700579ac66e7a84.JPG"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/33c/5df/7c2/33c5df7c2aca4356a7fb8f34a677bef6.JPG"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Strictly speaking, at the end of this stage a list should be formed, which together with the above documentation would ensure repeatability of the result. </font><font style="vertical-align: inherit;">I mentioned the large components above, however, when placing an order, I also asked to put the necessary ‚Äúdistribution‚Äù: a power switch, a connector for connecting the battery compartment, a 2.54-mm connector strip ...</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/347/b24/4dd/347b244dd59b4960be664715ad13c08d.JPG"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/694/9c0/c4d/6949c0c4d3f04863bcc66425d0d23225.JPG"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, consumables were used in the work - wires, solder, flux, as well as tools. </font><font style="vertical-align: inherit;">If there are any technological nuances, attention should also be focused on them.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d6c/af9/743/d6caf974315f4a798616ec0dea2a8c45.JPG"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I wrote the program twice. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first time was written as it was written. I actively read the site </font></font><a href="http://arduino.ru/Reference"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arduino.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I did not write the program anymore, but I understood the syntax, recalled C and constantly used to swear at the sequence of program code execution (I got used to the parallel execution of the code, when all the computational blocks and not only one line is processed).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The second time I approached the organization of the program rigidly structurally. This was not always justified, but if the original style was set, it should be adhered to. The meaning is ... repetition in the code structure of the software models drawn above. In the code, we first declare all the variables and set up tuning constants. Then follows the initialization block ‚Äúvoid setup‚Äù. And then follows the main ‚Äúvoid loop‚Äù cycle, the task of which is to continuously poll modules. Each module has its own input and output variables that affect its operation. In the main loop, these variables are managed.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The polled button sets the operation modes of all modules. </font><font style="vertical-align: inherit;">If a command came through the interface, it is transmitted to other control modules, if the offline mode is not activated. </font><font style="vertical-align: inherit;">At first I had only two modules - motor and light controls. </font><font style="vertical-align: inherit;">Then a sound shaping module appeared, which I did not have time to do. </font><font style="vertical-align: inherit;">This is precisely what the built-in structure affected - it is simple and clear to add / exclude modules: a block in variable declarations, a line in the initialization, a line in the main loop, and the code of the module itself. </font><font style="vertical-align: inherit;">The module for determining the distance and the module implementing the turn algorithm are called from other modules as necessary.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text of the program</font></font></b> <div class="spoiler_text"><pre><code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ Robot Platform RASH 1 AlSHex /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 1.0 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ Create: 23/</span></span><span class="hljs-number"><span class="hljs-number">03</span></span>/<span class="hljs-number"><span class="hljs-number">2015</span></span> /<span class="hljs-regexp"><span class="hljs-regexp">/ Modification: 11/</span></span><span class="hljs-number"><span class="hljs-number">04</span></span>/<span class="hljs-number"><span class="hljs-number">2015</span></span> /<span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ Description:    RASH 1 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ const int LEDtech = 13; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/     const int LEDdist = 3; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/      const int Sonar_t = 14; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   const int Sonar_r = 15; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   const int Mode = 16; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    -   : =0 - ; 1=   const int MB1 = 4; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  - digital const int MB2 = 5; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  - pwm const int MA1 = 6; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  - pwm const int MA2 = 7; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  - digital const int HDL = 17; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    const int SPK = 11; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/const int LGHT = ; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   const long UART_Speed = 9600; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ UART /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   const int D1 = 20; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/         const int D2 = 110; const float A = 2.5; const float B = 305; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   const byte Byte_forward = byte('W'); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/:  const byte Byte_back = byte('S'); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/:  const byte Byte_left = byte('A'); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/:  const byte Byte_right = byte('D'); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/:  const byte Byte_stop = byte('x'); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/:  const byte Byte_sound = byte('C'); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/:  /</span></span> const byte Byte_light = byte(<span class="hljs-string"><span class="hljs-string">'V'</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>:  const int Dist_min = <span class="hljs-number"><span class="hljs-number">40</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ,        [] const int Cycle_lightoff = <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>-            const int Speed_default = <span class="hljs-number"><span class="hljs-number">255</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  ,         ,            /<span class="hljs-regexp"><span class="hljs-regexp">/  const int Delay_prog = 10; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   , [] const int M_stop = 0; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    (  ) const int M_forward = 1; const int M_back = 2; const int M_left = 3; const int M_right = 4; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    -  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Interface ========== void _UART_Interf(unsigned int RST, unsigned int *Data); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  : Data[0]=1 -  ; Data[1] -   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/RST - : 0=  ; 1=  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/Data -    : Data[0]=1 -  ; Data[1] -   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  UART     Serial /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Motor ========== void _Motor(unsigned int RST, unsigned int Mode, unsigned int Speed); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/RST - : 0=  ; 1=  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/Mode -  : 0= ; 1=  ; 2=  ; 3=  ; 4=   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/Speed:    - ,  : 0=  ; 255=   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/MA1, MA2, MB1, MB2 -   , MB1  MA2 - , MB2  MA1 -  (0/</span></span><span class="hljs-number"><span class="hljs-number">255</span></span>) /<span class="hljs-regexp"><span class="hljs-regexp">/LEDtech -      ,          "" /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Sonar ========== unsigned int _Sonar(unsigned int RST); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/RST - : 0=  ; 1=  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/Sonar_t -      Trig /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/Sonar_r -      Echo /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/LEDdist -  (0/</span></span><span class="hljs-number"><span class="hljs-number">255</span></span>)    ,     -    -   ,      /<span class="hljs-regexp"><span class="hljs-regexp">/========== Control Motor ========== void _ControlM(unsigned int RST, unsigned int SCTRL, unsigned int DCTRL, unsigned int Mode); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/RST - : 0=  ; 1=  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/SCTRL -    DCTRL: 0= ; 1=  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/DCTRL -  ()    /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/Mode -  : 0=   ; 1=   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    Sonar, Motor  Rotate /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/LEDtech -      ,   1       /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Control Light ========== void _ControlL(unsigned int RST, unsigned int SCTRL, unsigned int DCTRL, unsigned int Mode); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/RST - : 0=  ; 1=  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/SCTRL -    DCTRL: 0= ; 1=  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/DCTRL -  ()    /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/Mode -  : 0=   ; 1=   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/HDL -      : 0=  ; 1=   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Control Sound ========== void _ControlS(unsigned int RST, unsigned int SCTRL, unsigned int DCTRL, unsigned int Mode); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/RST - : 0=  ; 1=  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/SCTRL -    DCTRL: 0= ; 1=  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/DCTRL -  ()    /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/Mode -  : 0=   ; 1=   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/SPK -  (0/</span></span><span class="hljs-number"><span class="hljs-number">255</span></span>)       /<span class="hljs-regexp"><span class="hljs-regexp">/========== Rotate ========== -  ,      ControlM   void _Rotate(unsigned int RST, unsigned int Speed); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/RST - : 0=  ; 1=  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/Speed:    - ,  : 0=  ; 255=   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  unsigned int CMD[2] = {0,0}; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  : CMD[0]=1 -  ; CMD[1] -   unsigned int CTRL[8] = {0,0,0,0,0,0,0,0}; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/CTRL[0]: 0=  ; 1=   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/CTRL[1]: 0=  ; 1=   void setup() { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ pinMode(MB1, OUTPUT); digitalWrite(MB1, LOW); pinMode(MB2, OUTPUT); analogWrite(MB2, 0); pinMode(MA1, OUTPUT); analogWrite(MA1, 0); pinMode(MA2, OUTPUT); digitalWrite(MA2, LOW); pinMode(Sonar_t, OUTPUT); digitalWrite(Sonar_t, LOW); pinMode(Sonar_r, INPUT); digitalWrite(Sonar_r, LOW); pinMode(LEDdist, OUTPUT); analogWrite(LEDdist, 0); pinMode(Mode, INPUT); digitalWrite(Mode, LOW); pinMode(LEDtech, OUTPUT); digitalWrite(LEDtech, LOW); pinMode(HDL, OUTPUT); digitalWrite(HDL, LOW); pinMode(SPK, OUTPUT); analogWrite(SPK, 0); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   Serial.begin(UART_Speed); _UART_Interf(1, CMD); _UART_Interf(0, CMD); _Sonar(1); _Sonar(0); _Motor(1, 0, 0); _Motor(0, 0, 0); _Rotate(1, 0); _Rotate(0, 0); _ControlM(1, 0, 0, 0); _ControlM(0, 0, 0, 0); _ControlL(1, 0, 0, 0); _ControlL(0, 0, 0, 0); _ControlS(1, 0, 0, 0); _ControlS(0, 0, 0, 0); } void loop() { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/       if (digitalRead(Mode) == LOW) { if (CTRL[1] == 1) { CTRL[0] = 1; } else { CTRL[0] = 0; } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/     ,    reset      ,  .  reset  CTRL[1] = 0; } else { if (CTRL[1] == 0) { CTRL[0] = 1; } else { CTRL[0] = 0; } CTRL[1] = 1; } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ ,     D_Interf _UART_Interf(CTRL[0], CMD); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  _ControlM(CTRL[0], CMD[0], CMD[1], CTRL[1]); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  _ControlL(CTRL[0], CMD[0], CMD[1], CTRL[1]); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  _ControlS(CTRL[0], CMD[0], CMD[1], CTRL[1]); delay(Delay_prog); } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Interface module ========== void _UART_Interf(unsigned int RST, unsigned int *Data) { unsigned int DUART; static unsigned int cnt_byte; if (RST == 0) { if (Serial.available() != 0) { DUART = Serial.read(); switch (cnt_byte) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  ,     -         case 0: if (DUART == byte('t')) { cnt_byte++; } else { cnt_byte = 0; } Data[0] = 0; Data[1] = 0; break; case 1: if (DUART == byte('x')) { cnt_byte++; } else { cnt_byte = 0; } Data[0] = 0; Data[1] = 0; break; case 2: if (DUART == byte('_')) { cnt_byte++; } else { cnt_byte = 0; } Data[0] = 0; Data[1] = 0; break; case 3: if (DUART == byte('c')) { cnt_byte++; } else { cnt_byte = 0; } Data[0] = 0; Data[1] = 0; break; case 4: if (DUART == byte('o')) { cnt_byte++; } else { cnt_byte = 0; } Data[0] = 0; Data[1] = 0; break; case 5: if (DUART == byte('m')) { cnt_byte++; } else { cnt_byte = 0; } Data[0] = 0; Data[1] = 0; break; case 6: if (DUART == byte('=')) { cnt_byte++; } else { cnt_byte = 0; } Data[0] = 0; Data[1] = 0; break; case 7: /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   ,        cnt_byte = 0; Data[0] = 1; Data[1] = DUART; break; } } else { Data[0] = 0; Data[1] = 0; } } else { cnt_byte = 0; Data[0] = 0; Data[1] = 0; } } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Sonar module ========== unsigned int _Sonar(unsigned int RST) { unsigned int Duration; if (RST == 0) { digitalWrite(Sonar_t, HIGH); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    delayMicroseconds(10); digitalWrite(Sonar_t, LOW); Duration = pulseIn(Sonar_r, HIGH); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/     (   ) /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    if (Duration/</span></span><span class="hljs-number"><span class="hljs-number">58</span></span> &gt; D1 &amp;&amp; Duration/<span class="hljs-number"><span class="hljs-number">58</span></span> &lt; D2) { analogWrite(LEDdist,int((-A*float(Duration/<span class="hljs-number"><span class="hljs-number">58</span></span>)+B))); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Duration/<span class="hljs-number"><span class="hljs-number">58</span></span> &lt; D1) { analogWrite(LEDdist, HIGH); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { analogWrite(LEDdist, LOW); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Duration/<span class="hljs-number"><span class="hljs-number">58</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { digitalWrite(LEDdist, LOW); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } } /<span class="hljs-regexp"><span class="hljs-regexp">/========== Control Motor module ========== void _ControlM(unsigned int RST, unsigned int SCTRL, unsigned int DCTRL, unsigned int Mode) { unsigned int Dist; static unsigned int Speed; static unsigned long Time_forward; if (RST == 0) { if (Mode == 0) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/""     if (SCTRL == 1) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   switch (byte(DCTRL)) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  case Byte_forward: Dist = _Sonar(0); if (Dist &gt; D1) { _Motor(0, M_forward, Speed); } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    -  break; case Byte_back: _Motor(0, M_back, Speed); break; case Byte_left: _Motor(0, M_left, Speed); break; case Byte_right: _Motor(0, M_right, Speed); break; case Byte_stop: _Motor(0, M_stop, Speed); break; default: break; } if (DCTRL &gt; 47 &amp;&amp; DCTRL &lt; 58) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  Speed = (DCTRL-47)*25+5; digitalWrite(LEDtech, HIGH); delay(1000); digitalWrite(LEDtech, LOW); } } } if (Mode == 1) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  Speed = Speed_default; Dist = _Sonar(0); if (Dist &gt; Dist_min) { if (millis()-Time_forward &lt; 21000) { _Motor(0, M_forward, Speed); } else { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 20    ,    , ..     . _Motor(0, M_stop, Speed); delay(300); _Motor(0, M_back, Speed); delay(600); _Motor(0, M_stop, Speed); delay(300); _Rotate(0, Speed); _Motor(0, M_stop, Speed); delay(300); Time_forward = millis()-1; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/-1  ,  millis()-Time_forward      } } else { _Motor(0, M_stop, Speed); delay(300); _Rotate(0, Speed); delay(300); Time_forward = millis()-1; } } } else { Dist = 0; Speed = Speed_default; Time_forward = 0; _Sonar(1); _Motor(0, 0, 0); _Rotate(1, 0); digitalWrite(LEDtech, LOW); } } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Control Light ========== void _ControlL(unsigned int RST, unsigned int SCTRL, unsigned int DCTRL, unsigned int Mode) { static unsigned int Light; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 0=  ; 1=   if (RST == 0) { if (Mode == 0) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/""     if (SCTRL == 1) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   switch (byte(DCTRL)) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  case Byte_light: if (Light == 0) { Light = 1; digitalWrite(HDL, HIGH); } else { Light = 0; digitalWrite(HDL, LOW); } break; default: break; } } } if (Mode == 1) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/block operations } } else { Light = 0; digitalWrite(HDL, LOW); } } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Control Sound ========== void _ControlS(unsigned int RST, unsigned int SCTRL, unsigned int DCTRL, unsigned int Mode) { if (RST == 0) { if (Mode == 0) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/""     if (SCTRL == 1) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   switch (byte(DCTRL)) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  case Byte_sound: /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/block operations break; default: break; } } } if (Mode == 1) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/block operations } } else { analogWrite(SPK, 0); } } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Motor module ========== void _Motor(unsigned int RST, unsigned int Mode, unsigned int Speed) { if (RST == 0) { switch (Mode) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/      case 0: /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/stop digitalWrite(LEDtech, LOW); digitalWrite(MB1, LOW); analogWrite(MB2, 0); analogWrite(MA1, 0); digitalWrite(MA2, LOW); break; case 1: /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/forward digitalWrite(LEDtech, HIGH); digitalWrite(MB1, HIGH); analogWrite(MB2, 255-Speed); analogWrite(MA1, Speed); digitalWrite(MA2, LOW); break; case 2: /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/back digitalWrite(LEDtech, HIGH); digitalWrite(MB1, LOW); analogWrite(MB2, Speed); analogWrite(MA1, 255-Speed); digitalWrite(MA2, HIGH); break; case 3: /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/left digitalWrite(LEDtech, HIGH); digitalWrite(MB1, LOW); analogWrite(MB2, Speed); analogWrite(MA1, Speed); digitalWrite(MA2, LOW); break; case 4: /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/right digitalWrite(LEDtech, HIGH); digitalWrite(MB1, HIGH); analogWrite(MB2, 255-Speed); analogWrite(MA1, 255-Speed); digitalWrite(MA2, HIGH); break; default: break; } } else { digitalWrite(LEDtech, LOW); digitalWrite(MB1, LOW); analogWrite(MB2, 0); analogWrite(MA1, 0); digitalWrite(MA2, LOW); } } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/========== Rotate ========== -   void _Rotate(unsigned int RST, unsigned int Speed) { unsigned int Dist; static unsigned int Num; unsigned int cnt; unsigned long Now_time; if (RST == 0) { do { if (Num%2 == 0) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  if (Num &gt;= 0 &amp;&amp; Num &lt; 128) { _Motor(0, M_right, Speed); delay(100); _Motor(0, M_stop, Speed); delay(100); } if (Num &gt;= 128 &amp;&amp; Num &lt; 255) { _Motor(0, M_right, Speed); delay(200); _Motor(0, M_stop, Speed); delay(100); } } else { if (Num &gt;= 0 &amp;&amp; Num &lt; 128) { _Motor(0, M_left, Speed); delay(250); _Motor(0, M_stop, Speed); delay(100); } if (Num &gt;= 128 &amp;&amp; Num &lt; 255) { _Motor(0, M_left, Speed); delay(150); _Motor(0, M_stop, Speed); delay(100); } } cnt++; Dist = _Sonar(0); } while (Dist &lt; Dist_min &amp;&amp; cnt &lt;= 3); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/      3   ( .            - -  Num) cnt = 0; Now_time = millis(); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  while (Now_time &gt; 255) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  Now_time -= 255; } Num += Now_time; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   : + while (Num &gt; 255) { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/     Num -= 255; } } else { Dist = 0; Num = 0; cnt = 0; Now_time = 0; _Motor(1, 0, 0); _Sonar(1); } }</span></span></code> </pre> <br></div></div><br><br>  <b>The sixth stage is the comprehension of creation.</b> <br><br>  What did we want to do? <br>  Let's get a look: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/yv5uHp6yu4Y" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  In general, it seems to be nothing.  Rides  Stops.  Is spinning.  But ... not so good.  The robot goes quite cheerfully without the ‚Äúsecond floor‚Äù, but when installing the second one it‚Äôs obviously ‚Äúboring‚Äù.  In addition, he constantly takes to the left, hinting that he alone is very bad in life, and since he did it, it would be nice to attend to this very ... variety of species. <br><br>  Summing up, you can honestly admit that there is much to develop. <br><br>  1) The robot always takes to the left with a rectilinear motion.  The stronger the discharge of the power source, the greater the deviation.  Obviously, this is due to the variation of the parameters of the engines, possibly due to the different work of the channels of the driver of the engines.  To eliminate this behavior of the robot, it is necessary to connect optical encoders and, receiving information from them, adjust the algorithm of the engine control module when moving forward or backward.  In addition, for the power source, you must have an integrated voltage regulator, for example, you can transfer power to a pair of Li-ION cells using a buck converter. <br><br>  2) The robot often does not see the object in front.  This is due to the narrow viewing angle of the ultrasonic distance meter.  It is obvious that the accuracy and reliability of determining the distance to objects can be improved by installing two or three ultrasonic sensors.  To determine the distance, the sensors are interrogated sequentially with short pauses to eliminate the effect of the reflections of the ultrasonic signals on each other. <br><br>  3) A couple of times on the firmware version 1.0 there was a situation of hanging up the rotation algorithm - the robot was constantly spinning and did not move forward, even if there was no obstacle ahead.  If the robot is forced to hold in a free direction, then after a while it began to work normally.  To eliminate such situations, it is necessary to expand the criteria for self-diagnosis of the behavior of the robot with its forced re-initialization in case of problems.  To avoid freezing MK, you must use WatchDog. <br><br>  4) In case of remote control, a situation often arises when, after releasing the button on the keyboard that specifies the movement, the robot did not stop.  Then it was necessary to quickly press and release any movement button.  Perhaps the ‚Äústop‚Äù command was lost in the receiving buffer, perhaps the command was not issued from the router.  To avoid such situations, a ‚Äústop‚Äù command must be issued from the router several times in a row when the movement button is released. <br><br>  5) When creating firmware for MK, the program specifies a consistent execution of the program.  In order to work out the ‚Äúforward‚Äù command, you need to sequentially interrogate the interface modules, determine the range, control, and then call the motion module.  With such a survey, the range determination module introduces a delay of up to fifty milliseconds, slowing down the decision on the incoming team.  In the case of excessive expansion of the functionality or the appearance of additional range modules, the delay may become unacceptable.  There is no such problem in the FPGA - all the blocks at a time are working in parallel, i.e.  It is permissible to receive a command at one time, process the range and output it to the LED, and also perform a bunch of other operations.  In MC, parallel execution of even unrelated functions with each other is impossible, or it is necessary to constantly use interrupt on external events, which is not always convenient.  However, the development of firmware for the FPGA is, essentially, more labor-intensive work, which requires certain qualifications, since  Virtually any programmer can write C code, and writing code on VHDL / Verilog requires an understanding of how the chip logic works. <br><br>  6) With remote control, the picture from the onboard camera changes too much, making orientation in space difficult.  To reduce this effect, it is necessary to apply anti-aliasing and / or reduction of the display window. <br><br>  7) In the process of testing revealed an unsuccessful design of the mechanical part.  When fully loaded (platform + ‚Äúsecond floor‚Äù), the dynamics of the platform decrease, you can hear squeaks when cornering.  Perhaps the situation can be corrected by raising the supply voltage.  In addition, the rear wheel often gets stuck when cornering and lubrication of the ball bearings does not help because of the unsuccessful design. <br><br>  8) With manual control at maximum speed while moving forward, if necessary, stopping and fast backward movement, the robot could sharply lean forward, while the rear pivot point was taken off the ground. <br><br>  And how should we be now? <br><br>  1) The implementation of the issuance of a sound signal - the development of a generator of sound signals with a certain frequency. <br>  2) Aligning wheel speed in straight-line motion using optical sensors and optical encoders for wheels. <br>  3) The implementation of automatic on / off headlights using the sensor light. <br>  4) Improving the reliability of determining the distance to the objects in front by increasing the ultrasonic sensors to three. <br>  5) Power supply based on two Li-Ion batteries, size 18650, and an integral voltage regulator. <br>  6) Disassemble and lubricate the gear motors with silicone grease to eliminate squeaks. <br>  7) Assess the increase in supply voltage to 6.0-7.5V.  In this case, take into account that you have to recalculate and re-solder resistors for LEDs to prevent the maximum output current of the MK output from being exceeded. <br>  8) With an abrupt change of state (starting or stopping) to realize a smooth change in speed, the change function can be linear or exponential. <br><br>  <b>Seventh stage - development</b> <br><br>  go to "Second Stage" <br><br><hr><br><br>  Well, here, we got to the finale of the whole story. <br><br>  I successfully demonstrated the robot and passed it along with, so to say, supporting documentation, as well as a description of the identified deficiencies and ways to eliminate them.  In my opinion, acquaintance with these technical descriptions and technical tasks should make a correct understanding of the operation of electronic devices "inside", as well as remove the vast majority of "thin" technical issues.  It seems that everyone was happy. <br>  Unfortunately, I do not always have enough free time to seriously participate in the development of the company Endurance.  As far as I know, the company is looking for interested and moderately independent developers, and if you are not only interested in this topic, but also have some experience, opportunities and a desire to participate in robot building, then they will surely welcome you there. <br><br>  Of course, the use of a robot in this performance is seen in an ironic light from the point of view of some industrial problems.  However, this platform may be useful.  I think it would be nice for me to have such a robot at the cottage for the purposes of remote monitoring.  If you install servos on it that allow you to rotate a video camera, think over the power supply system, then I could at any time inspect the situation in the house.  And if you make a check on the windowsills to the windows (yes, at least just put the boards, making an inclined plane), then outside the house. <br><br>  If the batteries are replaced with Li-ION batteries, they can be charged without any problems, because  similar controllers are available in finished form.  In the first version of such a robot, after inspection, it can be simply customized to the charging station manually, and it will connect the contactors using, for example, miniature electromagnets (offhand: the robot can switch to mains supply at the time of switching and the batteries will be isolated from wiring and charging autonomously).  In the second version of the robot, you can learn how to do it yourself - drove to the charging station and pressed the ‚Äúparking‚Äù button (offhand: you can draw some bright figure in the center of the parking target, the robot will be guided by using the color detection sensor, and at night everything will be highlighted headlights). <br><br>  Good luck in robotics! <br>  Do not be afraid to start. </div><p>Source: <a href="https://habr.com/ru/post/257983/">https://habr.com/ru/post/257983/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../257975/index.html">Messaging in Microsoft Azure, or How to communicate in the clouds</a></li>
<li><a href="../257977/index.html">Wiren Board 4 - controller for automation</a></li>
<li><a href="../257979/index.html">How I started working with nRF24LE or another way to program this chip</a></li>
<li><a href="../25798/index.html">Adventure of a domainer on the web :). Comparative analysis of Ukrainian domain registrars</a></li>
<li><a href="../257981/index.html">Automatically Testing JavaFX Applications</a></li>
<li><a href="../257985/index.html">Development of MMO RPG - a practical guide. Server (Part 1)</a></li>
<li><a href="../25799/index.html">We do TIKR.ru - an analogue of Google / Yahoo Finance</a></li>
<li><a href="../257991/index.html">Features of API development on symfony2</a></li>
<li><a href="../257999/index.html">Internal representation of values ‚Äã‚Äãin PHP7 (part 1)</a></li>
<li><a href="../2580/index.html">Google plugin gives passwords</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>