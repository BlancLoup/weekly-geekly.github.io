<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How Om Nom from Cut the Rope 2 moved to Amazon Fire Phone</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, Amazon has released a new Fire Phone smartphone, and ZeptoLab has received a proposal to modify the game Cut the Rope 2 for it. We added sup...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How Om Nom from Cut the Rope 2 moved to Amazon Fire Phone</h1><div class="post__text post__text-html js-mediator-article">  <i>Recently, Amazon has released a new Fire Phone smartphone, and ZeptoLab has received a proposal to modify the game Cut the Rope 2 for it. We added support for smartphone innovations there, and the game was included in the list of pre-installed applications.</i> <i><br></i> <br>  The device came to us long before the official release.  Devkit was placed in a special box, which protected the design of the device from prying eyes, and, most importantly, from the camera lens.  However, the most interesting thing was the ‚Äústuffing‚Äù of the phone. <br><br><img src="https://habrastorage.org/files/d95/0ac/172/d950ac1726cc43db9a1f7d44f52d04e0.JPG"><br><br><a name="habracut"></a><br>  The main feature of the first smartphone from Amazon - four front cameras that monitor the user's eyes and transmit data about their position in the program.  This creates a false 3D effect: you can slightly rotate the image on the screen with a glance, ‚Äúanimating‚Äù icons and other interface elements.  A particularly impressive impression is the viewing of maps: buildings acquire volume, and they can be viewed from any direction, simply by moving the view around the screen. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Another feature of the phone are Hero Icon and Hero Widget.  Fire Phone runs on Fire OS, Android modifications, and instead of the usual home screen, there are Carousel and App Grid screens. <br><br><img src="https://habrastorage.org/files/ccb/1f9/97f/ccb1f997f7a342a781cb3e49a681d5f1.png"><br><br>  App Grid is a familiar ‚Äúgrid‚Äù of installed applications, and Carousel is a set of recently used programs with horizontal scrolling.  For each application, the screen is divided into two parts: the three-dimensional icon Hero Icon is displayed at the top, and the set of Hero Widget elements at the bottom.  The widget contains a set of lines for displaying data on the application without having to start it;  These elements can also perform actions for quick access to parts of the application, even if it is closed or minimized. <br><br>  For Cut the Rope 2, widget support means that you can start the game faster by going straight to the level selection menu, bypassing the main menu and one of the two loading screens.  Achievements can also be viewed faster, because the need to search for the path to this element through the game menu disappears. <br><br>  To modify Cut the Rope 2 under the Fire Phone, we needed to make a three-dimensional icon, teach the game to create a widget and add support for the commands of this widget to it. <br><br>  <b>Create Hero Icon</b> <br><br>  In Fire Phone, the default 3D Hero Icon for all applications is created - <br>  flat object with the texture of the usual 2D icons. <br><br><img src="https://habrastorage.org/files/6f6/7a2/8c9/6f67a28c91384429a9613be2852542b8.png"><br><br>  However, in order to better utilize the functionality provided, we also added depth to our icon and made it a more appropriate smartphone style. <br><br>  From Amazon, we got the toolset, <a href="https://developer.amazon.com/public/solutions/devices/fire-phone/docs/using-maya-to-create-custom-visual-assets">instructions for creating icons in Autodesk Maya,</a> and the finished sample. <br><br>  Exactly repeating all the points specified in the instructions, we made the first version of the icon: <br><br><img src="https://habrastorage.org/files/8b4/453/0e3/8b44530e31cd434a920214eff2aa5835.png"><br><br>  As you can see, the dies are located at a distance from each other, so that when we move we can see the displacement of some elements relative to others.  Each die - <br>  This is one of the ‚Äúdetails‚Äù of Om Nom or the background of the icon.  At a great distance and when turning the icon at an angle of up to 30 degrees, Om Nom's pupils noticeably shift, but remain within the eye. <br><br>  We started to make an icon in parallel with the development of the widget, and did not have the opportunity to check how it will look on the smartphone screen.  After the very first export of the model to the .vbl format, made by Amazon for HeroIcon, we found out that the alpha channel is displayed incorrectly.  Therefore, we moved to the second version and made a simple icon based on the 2D version, which we really liked. <br><br><img src="https://habrastorage.org/files/25a/1e6/400/25a1e640001d4cc0afb21ec1c2d33caf.png"><br><br>  And when it seemed that all the problems were over, the most interesting began. <br><br>  First, errors when exporting the model to the vbl format: <br><br>  1. [ERROR]: Skeleton: No bind up for the junction, create a ind keys keys keys keys keys keys keys. <br><br>  The solution to the problem was found on forums.developer.amazon.com: it turns out that it was necessary to add another empty animation called ‚Äúbind‚Äù.  In the official instructions there is no such information. <br><br>  2. [ERROR]: StateMachine: Detected self looping state transitions with infinite loops. <br><br>  This error is treated quite simply: you need to go to Tools Euclid, which you install in Maya according to the instructions, go into StateMachine editing, right-click on ‚ÄúState‚Äù and select ‚ÄúRemove Self Connection‚Äù. <br><br>  There were also several problems, solutions to which we did not find, as well as we could not determine the steps to repeat them. <br><br>  For example, our icon did not want to be displayed on the right side of the desired axis: no matter how we turned it - on the Y, Z or X axis - in any case, the device displayed a side view. <br><br>  Since we could not solve the problem within the framework of the scene that was made according to the instructions, we took the ready samples from Amazon and imported our icon into the scene with the template icon.  To our joy, the export went without errors, and on the device there was a 3D icon Cut the Rope 2 in the form we needed.  And this is despite the fact that the sample scene was not, for example, described in the animation instructions. <br><br>  Secondly, this error got out: <br><br>  [ERROR]: MaterialExporter: Unable to open material template "MaterialApplication.app.template" <br><br>  This error continued to be repeated randomly in the sample scene, each time we performed any manipulations on the model.  To get rid of it, we took a clean sample, repeated the import of the finished model into the scene and exported it again. <br><br>  <b>Developing commands for the widget</b> <br><br>  This is where our work on the icon ended, but we still had to figure out what to display in the widget.  If the application does not install its own widget into the system, the standard list of products in Amazon that are close in subject to this application is displayed in its place.  For Cut the Rope 2, the smartphone listed several games from the Amazon Appstore.  Replacing the standard behavior, we set up in the widget the display of game information - the number of collected stars, received medals and recently used elements, such as teleports or hints.  These lines of the widget also allow you to navigate to the game level map, to the Amazon GameCircle achievement screen, and to several sections of the in-game store. <br><br><img src="https://habrastorage.org/files/1a9/30b/a26/1a930ba26f5345e1a14e9caa73e31865.png"><img src="https://habrastorage.org/files/006/2cc/662/0062cc662dbf4620a655d1c2ac4a1019.png"><br><br>  As reference materials, we had three Amazon training documents on the Home Screen, Hero Icon and Hero Widget.  Also at our disposal was the SDK for working with the new device and a small reference material on its installation and configuration. <br><br>  We started the installation of the Fire Phone SDK.  The problem was that the SDK only works with Android API not higher than 17, and we had to manually lower the version of the development environment (we could not do this automatically).  This required deleting folders from the Android SDK and downloading old versions of the components (SDK Tools 22.6.3, SDK Build-tools 19.0.1, API 17 Platform tools) using the links found on the Internet.  After that, installing the SDK from Amazon was not a big problem. <br><br>  Next, you had to add the library connection string in AndroidManifest: <br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-library</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.amazon.device.home"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br>  The widget elements themselves are created from the program text.  After creation, they need to be placed in lists and groups, and then they initialize the widget.  Thus, widget elements get style, main, minor and tertiary text, as well as icon and intent. <br><pre> <code class="cpp hljs">final ListEntry listEntry = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ListEntry(context) .setContentIntent(heroIntent) .setVisualStyle(SHOPPING) .setPrimaryText(primaryText) .setPrimaryIcon(imageUri); listEntry.setSecondaryText(secondaryText); listEntry.setTertiaryText(tritaryText); ... listEntries.add(listEntry); group.setListEntries(listEntries); groups.add(group); ‚Ä¶ mWidget.setGroups(groups);</code> </pre><br>  Intent for a widget is created through a special class: <br><pre> <code class="cpp hljs">heroIntent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HeroWidgetActivityStarterIntent(<span class="hljs-string"><span class="hljs-string">"com.zeptolab.ctr2.CTR2Activity"</span></span>);</code> </pre><br>  Then you need to get a request from the widget.  We decided to make the project code extensible to work with possible similar widgets or intents.  At the level of the framework ZFramework, which is used by our projects, the contents of the intents coming into the program are caught in onCreate () and onNewIntent ().  We use the virtual intent handler IntentInterpreter in the framework, and at the level of this project - the widget from Amazon - a specific WidgetIntentInterpreter class for processing the intents of the widget. <br><br>  We also had to take into account that, in contrast to the standard Android Intents, in the case of a widget from Amazon, only strings can be transmitted as additional data with an intent.  Therefore, the abstract class of parsing events we got methods for translating between strings and event IDs: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> abstract <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractIntentInterpreter</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> abstract </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processIntent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Intent intent)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> abstract </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIdForString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String stringData)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> abstract String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getStringForId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Id)</span></span></span></span>; }</code> </pre><br>  It is used like this: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> viewRequested = intentInterpreter.processIntent(intent); view.addEvent(viewRequested);</code> </pre><br>  The project code using WidgetIntentInterpreter takes the message from the intent and translates it into the requested ID: <br><pre> <code class="cpp hljs">String extra = intent.getStringExtra(HeroWidgetActivityStarterIntent.EXTRA_HERO_WIDGET_DATA); result = getIdForString(extra);</code> </pre><br>  The second line in this code converts the text string to the request ID, if the string received in the parameters matches one of the possible queries. <br><br>  At the framework level, the View class stores the request ID in the EventDispatcher class, which provides an interface for adding, reading event IDs and erasing them: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ZEventDispatcher</span></span></span><span class="hljs-class"> {</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ZEventDispatcher</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(android.content.Context context)</span></span></span><span class="hljs-function"> ... </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clearEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> ‚Ä¶ </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNextEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(boolean clearAfterRead)</span></span></span><span class="hljs-function"> ‚Ä¶ }</span></span></code> </pre><br>  This code is independent of a specific project, it can work to parse events from other widgets or other events. <br><br>  Then it only remained to calculate the event ID in the project using JNI.  For example, like this: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIntentEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> clearAfterRead)</span></span></span><span class="hljs-function"> </span></span>{ JNIEnv* env = JNI::getEnv(); jclass cls = env-&gt;GetObjectClass(JNI::eventDispatcher); jmethodID meth = env-&gt;GetMethodID(cls, <span class="hljs-string"><span class="hljs-string">"getNextEvent"</span></span>, <span class="hljs-string"><span class="hljs-string">"(Z)I"</span></span>); jint jEventId = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;jint&gt;(env-&gt;CallIntMethod(JNI::eventDispatcher, meth, clearAfterRead)); env-&gt;DeleteLocalRef(cls); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result = jEventId; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre><br>  Reading a single request from a widget can be done several times in the program, so it happens without simultaneously clearing the event. <br><br>  The algorithm for processing a widget request when the program is started is something like the following: <br><br><ol><li>  The onCreate event of the Java class of the application processes the intent, receiving the request ID; </li><li>  The resulting ID is stored in the EventDispatcher event resolver; </li><li>  When creating the bootstrap screen, the request ID is read by the RootView class; </li><li>  The load screen receives the request ID as a parameter and, depending on it, selects the set of resources to be loaded; </li><li>  At the completion of the loading screen, a specific program screen is displayed, depending on the request ID. </li></ol><br><br>  We had a little difficulty with getting the right amount on deploying a collapsed application.  At first this intent was caught by the onResume method, however this event restores the original intent with which the application was originally launched.  We needed to receive new intent at each new deployment.  The solution was to add properties to the application. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> ‚Ä¶ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  It allowed getting new intents in the onNewIntent () method.  As a result, when deployed, the application began to receive its unique set of parameters. <br><br>  Other difficulties arose in processing special scenarios, for example, when the user interrupts the loading screen, minimizing the application, and then opens it again through another element of the widget.  In this case, it is necessary to compare the target of the current download and the request of the widget, and, if there is a mismatch, initiate a new download by the new ID.  At the same time, the absence of a request when expanding (i.e. loading by the application icon, and not by the widget element) after interrupting the loading should not start a new download, but simply continue the old one. <br><br>  Another difficulty arose with dropping the OpenGL context when the application was minimized and opened using the widget.  Loading a new view and restoring the context should not interrupt each other, and usually either one or the other is started. <br><br>  <b>Future prospects</b> <br><br>  Among the possible prospects for development is improving the set of commands for the widget.  It is very easy to change it in the code, and then, using the code of the game, update the widget in the phone system when the game is running. <br><br>  Speaking about the options for the development of the widget, it should also be noted that after adding support for Amazon Hero Widget in Cut the Rope 2, we have code that can be easily adapted to other widgets on Android or iOS if desired. <br><br>  It was a story about the creation of a modification of the Cut the Rope 2 under the Amazon Fire Phone.  We hope our experience will be useful to you. <br><br><img src="https://habrastorage.org/files/d31/d0b/a1d/d31d0ba1d4ab4e709c47162e2387fb4e.JPG"><br><br>  Well, as for experimenting with new technologies, this is a frequent practice in ZeptoLab, and in this regard, we have to reconsider the requirements for newcomers to technical tasks from time to time.  In particular, we updated the test task for the C ++ developer position, and in order not to mislead the obsolete ones, we roll out its most recent version. <br><br>  <b>You must write a simple version of the classic game Asteroids:</b> <br><ul><li>  We lead the spacecraft through the asteroid field, control is at your discretion; </li><li>  The task - to hold out the maximum time, avoiding asteroids or shooting at them.  When a projectile hits an asteroid, it shatters into smaller fragments, and the fragments, in turn, are completely destroyed when they hit; </li><li>  Asteroids should be randomly created polygons. </li></ul><br><br>  <b>Prototype requirements:</b> <br><ul><li>  The game is written under the iOS or Android platform (strictly); </li><li>  Rendering should be implemented using OpenGL ES version 2.0 or higher (you can restrict yourself to geometric shapes of lines); </li><li>  If you are writing under Android, the game should be written using NDK (C ++) - the program should be entirely in C ++, in Java there can only be code binding; </li><li>  If you are writing under iOS, the game should be written in C ++.  On Objective-C, only code binding is allowed; </li><li>  The game should be written without the use of any third-party libraries like Cocos2D or GLKit. </li></ul><br><br>  We are still accepting your test tasks at <b>job@zeptolab.com</b> around the clock. <br>  We already <a href="http://habrahabr.ru/company/ZeptoLab/blog/147684/">wrote about</a> how we check them.  A <a href="http://habrahabr.ru/company/ZeptoLab/blog/225735/">little earlier,</a> we talked a little about the developer training system that we introduced this year - and we will only continue to develop it, do not miss it. <br><br>  In the near future we hope to please you with new interesting things happening in the Zepto-space. <br><br>  Always yours, <br>  Zeptoteam </div><p>Source: <a href="https://habr.com/ru/post/236867/">https://habr.com/ru/post/236867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../236853/index.html">How to stop making executive project documentation</a></li>
<li><a href="../236859/index.html">Fail2ban and nginx: blocking unwanted traffic to a specific URL</a></li>
<li><a href="../236861/index.html">Flask Mega-Tutorial, Part 14: I18n and L10n</a></li>
<li><a href="../236863/index.html">Parable about programmers and coders</a></li>
<li><a href="../236865/index.html">Website development (web applications) in C ++ (and not only) in the form of link libraries (* .so, * .dll)</a></li>
<li><a href="../236871/index.html">HP Unified Wired and Wireless Access</a></li>
<li><a href="../236873/index.html">A battery-free pacemaker works like a clock</a></li>
<li><a href="../236875/index.html">Django + API Vkontakte: post entries with attachments, get a list of groups and entries</a></li>
<li><a href="../236877/index.html">Discussion of the prohibition of Bitcoin in Russia continues and goes to a new level</a></li>
<li><a href="../236879/index.html">How not to do federal information systems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>