<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis of the tasks of the competition to analyze the security of the network infrastructure NetHack</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During the Positive Hack Days III forum, a competition for experts in the field of network security NetHack was held . During the competition, partici...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analysis of the tasks of the competition to analyze the security of the network infrastructure NetHack</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/pt/blog/182058/"><img src="https://habrastorage.org/storage2/cf2/10d/003/cf210d0035dd395d64351e91432204e9.png" align="left"></a>  During the Positive Hack Days III forum, a competition for experts in the field of network security <a href="http://phdays.ru/program/contests/">NetHack was held</a> .  During the competition, participants had to access the five network devices in 50 minutes and retrieve the flags stored in them.  The gaming network, created specifically for this competition, contained typical vulnerabilities and network infrastructure errors encountered by Positive Technologies specialists during security audits and penetration testing.  Today we present to your attention the analysis of competitive tasks. <a name="habracut"></a><br><br><h4>  NetHack Legend </h4><br>  In order to bring a highlight to the competition, a special legend was developed.  So, here it is. <br><br>  At a large hydroelectric station, a malfunction of equipment occurred, as a result of which the connection between the central automated control system (ACS) and the units that discharge water was lost.  Prolonged downpours in nearby areas significantly added to the flow of water into the reservoir.  According to experts, the reservoir overflow will occur in 50 minutes, after which the water will rush through the dam to the city.  To prevent a catastrophe, it is necessary to gain access to the five faulty nodes and reconnect them to the Central Control System, thereby ensuring the possibility of opening emergency gateways. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Competition scheme </h4><br>  The competition infrastructure was built according to the following scheme: <br><br><img src="https://habrastorage.org/storage2/b24/97e/b1b/b2497eb1b3efad7d9087761eb572b953.png"><br><br>  Competition participants were required to access five devices on the network, find specially left md5 flags in the configurations and enter them on a special web page.  The victory was awarded to the participant who first finds and enters all five flags. <br><br><h4>  Getting the first flag </h4><br>  Logging into R1 is not difficult, just use the default account cisco with the password cisco.  And immediately upon entering the device, we get the first flag: <br><br><img src="https://habrastorage.org/storage2/980/4d3/42f/9804d342fea8acbd9b031d2e0ce8bcd4.png"><br><br><h4>  Getting the second flag </h4><br>  Getting the second flag already requires certain knowledge and skills.  Having entered the device, the first thing that we should do is to briefly familiarize ourselves with the configuration and see the neighboring devices on the network: <br><br><img src="https://habrastorage.org/storage2/edd/259/38c/edd25938cdf423d7a98c652c49f3b5f5.png"><br><br>  We see that we are connected to Router3 via Fa0 / 1.  The absence of Router2 and a large number of interfaces should make us suspicious, so we will execute the following command: <br><br><img src="https://habrastorage.org/storage2/5ad/925/6aa/5ad9256aaccc7964f1031820f3cf7f62.png"><br><br>  The interface Fa1 / 10 is forcibly disabled, which is very suspicious.  After turning on the interface, we again look at the neighbors: <br><br><img src="https://habrastorage.org/storage2/c2c/ec7/19d/c2cec719d02df2c90a20713088688f23.png"><br><br>  Finally we see our Router2.  Next we need to know the IP address of Router2: <br><br><img src="https://habrastorage.org/storage2/a8a/cd8/832/a8acd88321c805e6399af404f26dfea4.png"><br><br>  We are trying to access the device under the cisco / cisco account.  But not everything is so simple. <br>  Based on the response time, we can assume that centralized authentication is used.  In the configuration of Router1, we see information about the radius server: <br><br><img src="https://habrastorage.org/storage2/413/8b7/c1b/4138b7c1b3741d42d97977228d00afea.png"><br><br>  The route to it is also visible: <br><br><img src="https://habrastorage.org/storage2/0f1/ad0/05d/0f1ad005d87829c2bda6c36dbbf93b05.png"><br><br>  Accordingly, we need to ensure that radius is not available for Router2.  In our case, it is enough to pay off the Fa0 / 1 interface.  Try again to go to Router2: <br><br><img src="https://habrastorage.org/storage2/261/943/db2/261943db2d2d216327a00424d4462116.png"><br><br>  Great, we went to the second device and even raised the privileges.  We were lucky, the enable password is not set.  Examining the configuration briefly, we learn that we have several possible flags.  We try to bring only them.  Only one line is suitable as md5, this is our flag: <br><br><img src="https://habrastorage.org/storage2/8cf/f47/56b/8cff4756bcc658bc3d60f0c3d407ae7e.png"><br><br><h4>  Getting the third flag </h4><br>  If we try to log in to Router3 using a cisco / cisco account, then it will not work with us.  Let's try to find the account we need.  Once again we carefully study the configuration of Router2 and see the following line: <br><br><img src="https://habrastorage.org/storage2/f78/5f7/6bd/f785f76bddb8f2fd5cf6a4fade360771.png"><br><br>  Since type 7 is reversible encryption, we can easily get the password: Tf7NszYCnd. <br>  Now, we are ready for Router3.  We try to log in using the new admin account: <br><br><img src="https://habrastorage.org/storage2/9ea/0ad/1ec/9ea0ad1ec20040be84690a090d7d2286.png"><br><br>  Great, we're on the third node.  We are looking for our flag: <br><br><img src="https://habrastorage.org/storage2/a63/96f/caa/a6396fcaa730e6aa4bd398fb785e027c.png"><br><br><h4>  Getting the fourth flag </h4><br>  Now the hardest part.  We look at the neighbors by first enabling cdp on the Fa0 / 1 interface: <br><br><img src="https://habrastorage.org/storage2/0aa/8c3/b49/0aa8c3b4921db82fd80d399d9ee828ea.png"><br><br>  We are trying to log in to Router4 and understand that radius is also used there.  We carefully study the configuration of Router3 and see the community string PHDays2013 with write permissions.  After we fix the routing, we can try to pick up the Router4 configuration using the snmp protocol. <br><br>  After receiving the configuration, we see that ospf is configured on Router4.  Now we need to slip your route to the radius.  This can be done as follows: <br><br><img src="https://habrastorage.org/storage2/cc4/96e/21b/cc496e21b3af97343a53ed5c696d7c6f.png"><br><br>  Next we need to go to the device as cisco / cisco and find the fourth flag: <br><br><img src="https://habrastorage.org/storage2/400/1b8/f5f/4001b8f5f8c2f58fe6eb9f368e37975d.png"><br><br><h4>  Getting the fifth last flag </h4><br>  Again, look at the neighbors, find out the IP address of Router5 and try to log in via ssh or telnet.  Unfortunately, this does not work with us.  Again, we carefully study the configuration and see the ACL on the outgoing interface Fa0 / 1 blocking traffic to Router5 port 80: <br><br><img src="https://habrastorage.org/storage2/296/12b/f60/29612bf60c1d2422cd78700a74874e9c.png"><br><img src="https://habrastorage.org/storage2/361/fe2/e81/361fe2e81925a084414212de92b1db7b.png"><br><br>  We remove the ACL from the interface, add the necessary routes and try to enter: <br><br><img src="https://habrastorage.org/storage2/9ef/5a8/334/9ef5a833495d15a194870ff612226479.png"><br><br>  It now remains to find the flag: <br><br><img src="https://habrastorage.org/storage2/dfa/909/a10/dfa909a10f8260fe7f21e16da66deccb.png"><br><br><h4>  Winner </h4><br>  The struggle was stubborn: none of the contestants managed to get ahead and significantly outperform the competition.  Visitors to the PHDays forum could observe the course of the competition thanks to a special visualization that was broadcast on a large screen installed in one of the halls. <br><br><img src="https://habrastorage.org/storage2/53d/288/cee/53d288cee0ce2d025404cf85472834f5.png"><br><br>  In the 50 minutes initially set aside for the final, the winner could not be identified, since none of the participants managed to get all five flags.  As a result, the competition was extended by 15 minutes, which decided the outcome of the competition.  In the last seconds of extra time, the network administration specialist from Perm, Stanislav Mironov, <a href="http://blog.phdays.ru/2013/05/phdays_27.html">managed to take the</a> fifth flag.  He became the only one who managed to do it.  The second place was taken by Yuri Shkodin, and the third was Sergei Stankevich - they managed to take four flags each.  Congratulations to the winners :). <br><br>  That's all for today!  We will be happy to answer your questions in the comments. </div><p>Source: <a href="https://habr.com/ru/post/182058/">https://habr.com/ru/post/182058/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../182048/index.html">In the looking glass: how to hire sales managers</a></li>
<li><a href="../182050/index.html">Feedly opened API for third-party RSS applications</a></li>
<li><a href="../182052/index.html">Prism Developer Guide - Part 8.1, View-Based Navigation</a></li>
<li><a href="../182054/index.html">Burden of new</a></li>
<li><a href="../182056/index.html">From 4 mayors of cities in Denmark, Universal Music requires a payment of 42 thousand dollars for a musical parody of Gangnam Style</a></li>
<li><a href="../182060/index.html">Eidos Montreal showed teaser Deus Ex: The Fall</a></li>
<li><a href="../182062/index.html">IBM uses Roomba robots to control temperature in data centers</a></li>
<li><a href="../182064/index.html">Downshifting by Microsoft</a></li>
<li><a href="../182068/index.html">Wireless Arduino Network</a></li>
<li><a href="../182070/index.html">Threat rating in May 2013: increased activity of Zeus modifications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>