<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VLAN configuration on the routerOS operating system</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For a visual example, I will use the Mikrotik CCR1036-8G-2S + router and the CRS125-24G-1S switch. 

 This option is currently working in several hote...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VLAN configuration on the routerOS operating system</h1><div class="post__text post__text-html js-mediator-article">  For a visual example, I will use the Mikrotik CCR1036-8G-2S + router and the CRS125-24G-1S switch. <br><br>  This option is currently working in several hotels in Moscow and the Moscow region. <br>  Let's set up a conditional task, so that at each switching node there is a class A network (10.1.0.0/24) for company employees and a class C network (192.168.1.0/24) for WiFi for visitors. <br><br>  Suppose we have a switching node A with a Mikrotik CCR1036-8G-2S + router, a switching node B with a CRS125-24G-1S switch.  Switching nodes A and B will be connected by a communication channel (Trunk) in our case via twisted pair (communication channels (trunk) may be several depending on the number of switching nodes; also if there is a fiber optic and optical module SFP mikrotik, then you can assign a trunk to SFP).  I will give below the scheme with use of trunk on twisted pair. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/c825059a8e8f02774b388cc6859d3319.jpg" alt="image"></div><br>  We proceed to the configuration of the switching node A with the router Mikrotik CCR1036-8G-2S +. <br><a name="habracut"></a><br>  Let's call our router ‚Äúrouter-A‚Äù. <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">system</span></span> <span class="hljs-keyword"><span class="hljs-keyword">identity</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>=router-A</code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/e5d6c0dae7788cf102f2f089cb72c135.jpg"></div><br>  We denote physical ports so that there is no confusion as to which networks they belong to.  Denote by lan marking the physical ports that will belong to the network (class A) 10.1.0.0/24, by the wifi label, the physical ports that will belong to the network (class C) are 192.168.1.0/24 and by marking the trunk to the physical ports that will be used for the communication channel type trunk. <br><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether1 ] <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether1-wan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether2 ] <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether2-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether3 ] <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether3-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether4 ] <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether4-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether5 ] <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether5-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether6 ] <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether6-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether8 ] <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether8-trunk <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=sfp-sfpplus1 ] disabled=yes <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=sfp-sfpplus2 ] disabled=yes</code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/109bb8ed482ffd203a5bc28cf340b3d7.jpg" alt="image"></div><br>  Let's create virtual interfaces in the bridge tab, to connect the LAN ports. <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">name</span></span>=br1-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">name</span></span>=br2-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">name</span></span>=br3-trunk</code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/5f46755a0e7a14619e0a768d7dbc3296.jpg" alt="image"></div><br>  We create Vlan interfaces with which the 10.1.0.0/24 and 192.168.1.0/24 networks will be transported to the switching node B via a trunk communication channel.  VLAN id for the network 10.1.0.0/24 will be <b>11</b> , and for the network 192.168.1.0/24 will be <b>22</b> .  With the help of these id, information about the belonging of traffic to vlan1-lan and vlan2-wifi will be transmitted. <br><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> vlan add <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=br3-trunk <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=vlan1-lan vlan-id=<span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> vlan add <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=br3-trunk <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=vlan2-wifi vlan-id=<span class="hljs-number"><span class="hljs-number">22</span></span></code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/017f45c28bc96a6ea5bcef95363b2e69.jpg" alt="image"></div><br>  Assign the LAN ports of the router to the virtual interfaces (bridge) according to the above scheme <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br1-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether2-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br1-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether3-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br1-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether4-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br2-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether5-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br2-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether6-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br3-trunk <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether8-trunk <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br1-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=vlan1-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br2-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=vlan2-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br3-trunk <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether7</code> </pre> <br>  (I will add this LAN port for possibly future switching node C, for every fireman) <br><br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/669f63b5a28b0efae759b727dd6c64e8.jpg" alt="image"></div><br>  Assign networks to virtual interfaces <br><br><pre> <code class="hljs cs">ip address <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> address=<span class="hljs-number"><span class="hljs-number">10.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=br1-lan network=<span class="hljs-number"><span class="hljs-number">10.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> ip address <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> address=<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=br2-wifi network=<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> ip address <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> address=<span class="hljs-number"><span class="hljs-number">62.64</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether1-wan network=<span class="hljs-number"><span class="hljs-number">62.64</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span></code> </pre> <br>  <i>The provider provides me with the Internet protocol EOiP.</i>  <i>Therefore, you do not pay attention to this command, but configure the Internet access via the wan-port according to the settings provided by your provider.</i> <br><br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/77b0e80d6933bbb93477a490ebddd75e.jpg" alt="image"></div><br>  Set up a pool of addresses being distributed to networks, set up dhcp <br><br><pre> <code class="hljs pgsql">ip pool <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>=pool-wifi ranges=<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.50</span></span><span class="hljs-number"><span class="hljs-number">-192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.220</span></span> ip pool <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>=pool-lan ranges=<span class="hljs-number"><span class="hljs-number">10.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.50</span></span><span class="hljs-number"><span class="hljs-number">-10.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.220</span></span></code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/8f0df4ab2352c009b673dcfb2d509754.jpg" alt="image"></div><br><pre> <code class="hljs pgsql">ip dhcp-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> address-pool=pool-lan disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> interface=br1-lan <span class="hljs-type"><span class="hljs-type">name</span></span>=dhcp-lan ip dhcp-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> address-pool=pool-wifi disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> interface=br2-wifi <span class="hljs-type"><span class="hljs-type">name</span></span>=dhcp-wifi</code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/01f6bf136e9890e4a5ab6c8d15882160.jpg" alt="image"></div><br><pre> <code class="hljs pgsql">ip dhcp-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> network <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> address=<span class="hljs-number"><span class="hljs-number">10.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span> dns-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>=<span class="hljs-number"><span class="hljs-number">8.8</span></span><span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.8</span></span>,<span class="hljs-number"><span class="hljs-number">8.8</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">domain</span></span>=lan.<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> gateway=<span class="hljs-number"><span class="hljs-number">10.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> ip dhcp-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> network <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> address=<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span> dns-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>=<span class="hljs-number"><span class="hljs-number">8.8</span></span><span class="hljs-number"><span class="hljs-number">.8</span></span><span class="hljs-number"><span class="hljs-number">.8</span></span>,<span class="hljs-number"><span class="hljs-number">8.8</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">domain</span></span>=wifi.<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> gateway=<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span></code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/b3a27db836635ff19a1e8be380d3a7b3.jpg" alt="image"></div><br>  We will enable NAT so that devices located on the 192.168.1.0/24 and 10.1.0.0/24 networks have Internet access. <br><br><pre> <code class="hljs cs">ip firewall nat <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> action=masquerade chain=srcnat <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether1-wan src-address=<span class="hljs-number"><span class="hljs-number">10.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span> ip firewall nat <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> action=masquerade chain=srcnat <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether1-wan src-address=<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span></code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/d7b698220bdd01ad6d89055649535452.jpg" alt="image"></div><br>  We isolate subnets so that devices from the 192.168.1.0/24 network do not see and do not use devices that are on the 10.1.0.0/24 network.  (I prefer this method of isolation; there is another way to isolate subnets using Route Rules, but I will use the Firewall rule) <br><br><pre> <code class="hljs cs">ip firewall filter <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> action=drop chain=forward disabled=yes dst-address=<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=br1-lan</code> </pre> <br>  This rule can be enabled and disabled depending on your need for access to devices from the 10.1.0.0/24 network to 192.168.1.0/24 or vice versa. <br><br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/87f1186ac40f8385392988e81a78de87.jpg" alt="image"></div><br>  Now configure the switching node B with the Mikrotik CRS125-24G-1S switch <br><br>  Let's call our switch "switch-B": <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">system</span></span> <span class="hljs-keyword"><span class="hljs-keyword">identity</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>=switch-B</code> </pre> <br>  Let us denote physical LAN ports.  Let's unite ports 1 through 8 inclusive in a common hardware switch with ether-1 master port and designate it master, the rest from 2 through 8 inclusively denote slave.  We will do the same with ports 9 to 16 inclusive with ether-9 master port. <br><br><pre> <code class="hljs sql">interface ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether1 ] <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether1-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether2 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether1-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether2-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether3 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether1-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether3-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether4 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether1-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether4-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether5 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether1-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether5-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether6 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether1-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether6-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether7 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether1-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether7-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether8 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether1-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether8-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether9 ] <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether9-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether10 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether9-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether10-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether11 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether9-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether11-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether12 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether9-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether12-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether13 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether9-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether13-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether14 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether9-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether14-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether15 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether9-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether15-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether16 ] <span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-port=ether9-<span class="hljs-keyword"><span class="hljs-keyword">master</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether16-<span class="hljs-keyword"><span class="hljs-keyword">slave</span></span>-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> ethernet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> [ find <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether24 ] <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=ether24-trunk</code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/2051b67018f7ade7548d61189f1e5fbc.jpg" alt="image"></div><br>  We create Vlan interfaces on the physical 24 lan-port, with the help of which the networks 10.1.0.0/24 and 192.168.1.0/24 will be transported from the switching node A via a trunk communication channel.  Do not forget to specify the vlan id that we specified in accordance with the initial scheme. <br><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> vlan add <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether24-trunk <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=vlan1-lan vlan-id=<span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> vlan add <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether24-trunk <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=vlan2-wifi vlan-id=<span class="hljs-number"><span class="hljs-number">22</span></span></code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/2957d5e152f0565eab6e6f20273e53ed.jpg" alt="image"></div><br>  Let's create virtual interfaces in the bridge tab for combining LAN ports. <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">name</span></span>=br-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">name</span></span>=br-wifi</code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/5cd772de1965a10b9769eeb9c8395a4f.jpg" alt="image"></div><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=vlan1-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=vlan2-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether1-master-lan <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span> <span class="hljs-title"><span class="hljs-title">port</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">bridge</span></span>=br-wifi <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether9-master-wifi</code> </pre> <br><div style="text-align:center;"><img src="http://s8.hostingkartinok.com/uploads/images/2017/02/e7c3ee7ef7ba3d9307ec16133d911ab5.jpg" alt="image"></div><br>  Thus, we have a connection between the switching nodes A and B, connected by a twisted pair, through which two different networks 10.1.0.0/24 and 192.168.1.0/24 pass through VLAN. </div><p>Source: <a href="https://habr.com/ru/post/322720/">https://habr.com/ru/post/322720/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322708/index.html">Data Science Weekend March 3-4</a></li>
<li><a href="../322710/index.html">Primitives for implementing 1-Wire master using PWM and ICP on AVR AtMega microcontrollers</a></li>
<li><a href="../322712/index.html">Arrested the alleged organizer of the MIRAI botnet attack on the provider Deutsche Telekom</a></li>
<li><a href="../322714/index.html">NetScaler Unified Gateway: a secure solution for applications through a single URL</a></li>
<li><a href="../322716/index.html">PyMC3 - MCMC and not only</a></li>
<li><a href="../322724/index.html">ClickHouse: very fast and very convenient</a></li>
<li><a href="../322726/index.html">DEV Labs 2017. Online conference for .NET developers. March 4</a></li>
<li><a href="../322728/index.html">Implementation of FFT node with floating point on the FPGA</a></li>
<li><a href="../322730/index.html">What is the Tarantool IIoT platform?</a></li>
<li><a href="../322732/index.html">LED-it-GO - Data Security Risk</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>