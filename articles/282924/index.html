<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Test Gradle Plugins Correctly</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once, when preparing one of the reports about plugin development for Gradle, there was a task - how to test our products. Without tests in general, li...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Test Gradle Plugins Correctly</h1><div class="post__text post__text-html js-mediator-article"><p>  Once, when preparing one of the reports about plugin development for Gradle, there was a task - how to test our products.  Without tests in general, life is bad, and when your code actually runs in a separate process, and even more so, because you want debug, you want to start quickly and don‚Äôt want to write a million examples to test all possible cases.  Under the cut a comparison of several testing methods that we managed to try. </p><a name="habracut"></a><br><h3 id="podopytnyy-krolik">  Guinea pig </h3><br><p>  Our guinea pig will be a <a href="https://github.com/lavcraft/jpoint2016-gradle">project</a> that <a href="https://habrahabr.ru/users/tolkkv/" class="user_link">tolkkv</a> and <a href="https://habrahabr.ru/users/tolkkv/" class="user_link">I have been</a> preparing for the <a href="http://javapoint.ru/">2016 JPoint</a> conference.  In short, we wrote a plugin that will collect documentation from various projects and generate a regular html document with cross-reference links.  But it's not about how we wrote the plugin itself (although it was also fun and exciting), but how to test what you write.  I repent, but almost the entire project we tested integrationally, through examples.  And at some point, they realized that it was worth thinking about another method of testing.  So, our candidates: </p><br><ul><li>  Gradle Test Kit ( <a href="https://docs.gradle.org/current/userguide/test_kit.html">https://docs.gradle.org/current/userguide/test_kit.html</a> ) </li><li>  Nebula Test ( <a href="https://github.com/nebula-plugins/nebula-test">https://github.com/nebula-plugins/nebula-test</a> ) </li><li>  Unit Test as they are (example here: <a href="https://github.com/spring-gradle-plugins/dependency-management-plugin">https://github.com/spring-gradle-plugins/dependency-management-plugin</a> ) </li></ul><br><p>  The challenge is the same everywhere.  Just check that our documentation plugin is connected, and there is a task that can execute successfully.  They drove. </p><br><h3 id="gradle-test-kit">  Gradle test kit </h3><br><p>  Now it is in the incubation stage, which was very noticeable when we tried to fasten it.  If we take an example from the documentation and naively apply it to our realities (see the example below), it will not work.  Let's understand what we did. </p><br><pre><code class="hljs scala"><span class="hljs-meta"><span class="hljs-meta">@Slf</span></span>4j <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestSpecification</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Specification</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Rule</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-type"><span class="hljs-type">TemporaryFolder</span></span> testProjectDir = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">TemporaryFolder</span></span>() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">buildFile</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span></span>() { buildFile = testProjectDir.newFile(<span class="hljs-symbol"><span class="hljs-symbol">'build</span></span>.gradle') } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> "</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execution</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">documentation</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">distribution</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">task</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">up</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">date</span></span></span><span class="hljs-function">"</span></span>() { given: buildFile &lt;&lt; <span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">" buildscript { repositories { jcenter() } dependencies { classpath 'org.asciidoctor:asciidoctor-gradle-plugin:1.5.3' } } apply plugin: 'org.asciidoctor.convert' apply plugin: 'ru.jpoint.documentation' docs { debug = true } dependencies { asciidoctor 'org.asciidoctor:asciidoctorj:1.5.4' docs 'org.slf4j:slf4j-api:1.7.2' } "</span></span><span class="hljs-string"><span class="hljs-string">""</span></span> when: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-type"><span class="hljs-type">GradleRunner</span></span>.create() .withProjectDir(testProjectDir.root) .withArguments(<span class="hljs-symbol"><span class="hljs-symbol">'documentationDistZi</span></span>p') .build() then: result.task(<span class="hljs-string"><span class="hljs-string">":documentationDistZip"</span></span>).outcome == <span class="hljs-type"><span class="hljs-type">TaskOutcome</span></span>.<span class="hljs-type"><span class="hljs-type">UP_TO_DATE</span></span> } }</code> </pre> <br><p>  We use Spock, although you can use JUnit.  Our project will lie and run in a temporary folder, which is determined via <code>testProjectDir</code> .  In the <strong>setup</strong> method, we create a new project assembly file.  In a <strong>given,</strong> we defined the content of this file, connected the necessary plugins and dependencies to it.  In the <strong>when</strong> section through the <code>GradleRunner</code> new class, we transfer the previously defined directory with the project and say that we want to launch the task from the plugin.  In the <strong>then</strong> section, we check that we have the task, but since we have not determined any documents, we do not need to execute it. </p><br><p>  So here, running the test, we learn that the test framework does not know what <code>ru.jpoint.documentation</code> plugin - <code>ru.jpoint.documentation</code> - we connected.  Why it happens?  Because now <code>GradleRunner</code> does not pass the plug-in classpath inside.  And this greatly limits our testing.  We go to the documentation and find out that there is a <code>withPluginClasspath</code> method to which we can transfer the resources we need, and they will be picked up during the testing process.  It remains to understand - how to form it. </p><br><p>  If you think this is obvious, think again.  To solve the problem, you need to separate the task through yourself (thanks to Gradle for the imperative approach) to create a text file with a set of resources in the <code>build</code> directory.  We write: </p><br><pre> <code class="hljs ruby">task createClasspathManifest { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">outputDir</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sourceSets</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resourcesDir</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inputs</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">files</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sourceSets</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runtimeClasspath</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">outputs</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dir</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">outputDir</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doLast</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">outputDir</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mkdirs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> file(<span class="hljs-string"><span class="hljs-string">"$outputDir/plugin-classpath.txt"</span></span>).text = sourceSets.main.runtimeClasspath.join(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>) } }</code> </pre> <br><p>  Run, get the file.  Now we go to our test and in <strong>setup we</strong> add the following pleasant code for reading: </p><br><pre> <code class="hljs scala"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pluginClasspathResource</span></span></span><span class="hljs-function"> </span></span>= getClass().classLoader.findResource(<span class="hljs-string"><span class="hljs-string">"plugin-classpath.txt"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pluginClasspathResource == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">IllegalStateException</span></span>(<span class="hljs-string"><span class="hljs-string">"Did not find plugin classpath resource, run `testClasses` build task."</span></span>) } pluginClasspath = pluginClasspathResource.readLines() .collect { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">File</span></span>(it) }</code> </pre> <br><p>  Now pass the <code>classpath</code> to <code>GradleRunner</code> .  Run, and nothing works.  Go to the forums and find out that this only works with Gradle 2.8+.  We check that we have 2.12 and sad.  What to do?  Let's try to do as advised to do for Gradle 2.7 and below.  We will create another <code>classpath</code> ourselves and add it directly to the <code>buildscript</code> : </p><br><pre> <code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">classpathString</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pluginClasspath</span></span></span><span class="hljs-function"> .</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">collect</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">it</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">absolutePath</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">replace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'\\'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'\\\\'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> } .collect { <span class="hljs-string"><span class="hljs-string">"'$it'"</span></span> } .join(<span class="hljs-string"><span class="hljs-string">", "</span></span>)</code> </pre> <br><pre> <code class="hljs nginx"><span class="hljs-section"><span class="hljs-section">dependencies</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">classpath</span></span> files(<span class="hljs-variable"><span class="hljs-variable">$classpathString</span></span>) ... }</code> </pre> <br><p>  We start - it works.  This is not all problems.  You can read the <a href="https://discuss.gradle.org/t/nosuchmethoderror-in-testkit-after-2-9-2-10-transition">epic trad</a> and it will be completely sad. </p><br><p>  <strong>2.13 update:</strong> when we experimented, the new version has not yet been released.  It fixed (finally) the problem with pulling up resources and now the code looks much more decent and noble.  To do this, you need to connect the plugin in a slightly different way: </p><br><pre> <code class="hljs nginx"><span class="hljs-section"><span class="hljs-section">plugins</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">id</span></span> <span class="hljs-string"><span class="hljs-string">'ru.jpoint.documentation'</span></span> }</code> </pre> <br><p>  and run <code>GradleRunner</code> with an empty classpath: </p><br><pre> <code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GradleRunner</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> .withProjectDir(testProjectDir.root) .withArguments(<span class="hljs-string"><span class="hljs-string">'documentationDistZip'</span></span>) .withPluginClasspath() .build()</code> </pre> <br><p>  It remains only a disappointment that you cannot run this test from Idea through the context menu, because it does not know how to properly substitute the necessary resources.  Through <code>./gradlew</code> everything works great. </p><br><p>  <strong>Fix from <a href="https://habrahabr.ru/users/d10xa/" class="user_link">d10xa</a></strong> : In the settings, select the ‚ÄúGradle Test Runner‚Äù (Settings-&gt; Build-&gt; Build Tools-&gt; Gradle-&gt; Runner), delete the existing configuration and run the test again. </p><br><p>  <strong>The bottom line: the</strong> direction is correct, but use sometimes hurts. </p><br><h3 id="nebula-test">  Nebula Test </h3><br><p>  The second candidate showed himself much better.  All you need to do is connect the plugin to your dependencies: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">functionalTestCompile</span></span> <span class="hljs-string"><span class="hljs-string">'com.netflix.nebula:nebula-test:4.0.0'</span></span></code> </pre> <br><p>  Then in the specification, we can, by analogy with the previous example, create a <code>build.gradle</code> file: </p><br><pre> <code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { buildFile &lt;&lt; <span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">" buildscript { repositories { jcenter() } dependencies { classpath 'org.asciidoctor:asciidoctor-gradle-plugin:1.5.3' } } apply plugin: 'org.asciidoctor.convert' apply plugin: info.developerblog.documentation.plugin.DocumentationPlugin docs { debug = true } dependencies { asciidoctor 'org.asciidoctor:asciidoctorj:1.5.4' docs 'org.slf4j:slf4j-api:1.7.2' } "</span></span><span class="hljs-string"><span class="hljs-string">""</span></span> }</code> </pre> <br><p>  But the test itself looks easy, understandable, and most importantly - it starts without squats: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">def</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">execution</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">of</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">documentation</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">distribution</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">task</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">is</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">success</span></span>"() { <span class="hljs-attribute"><span class="hljs-attribute">when</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">createFile</span></span>(<span class="hljs-string"><span class="hljs-string">"/src/docs/asciidoc/documentation.adoc"</span></span>) ExecutionResult executionResult = <span class="hljs-built_in"><span class="hljs-built_in">runTasksSuccessfully</span></span>(<span class="hljs-string"><span class="hljs-string">'documentationDistZip'</span></span>) then: executionResult.<span class="hljs-built_in"><span class="hljs-built_in">wasExecuted</span></span>(<span class="hljs-string"><span class="hljs-string">'documentationDistZip'</span></span>) executionResult.<span class="hljs-built_in"><span class="hljs-built_in">getSuccess</span></span>() }</code> </pre> <br><p>  In this example, we also created a file with the documentation, and therefore the result of the execution of our task will be <code>SUCCESS</code> . </p><br><p>  <strong>Bottom line:</strong> everything is very cool.  Recommended for use. </p><br><h3 id="unit-testirovanie">  Unit testing </h3><br><p>  Ok, all we did before is all such integration tests.  Let's see what we can do through the mechanism of Unit-tests. </p><br><p>  At first we will configure the project simply through the code: </p><br><pre> <code class="hljs scala"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span></span>() { project = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">ProjectBuilder</span></span>().build() project.buildscript.repositories { jcenter() } project.buildscript.dependencies { classpath <span class="hljs-symbol"><span class="hljs-symbol">'org</span></span>.asciidoctor:asciidoctor-gradle-plugin:<span class="hljs-number"><span class="hljs-number">1.5</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span>' } project.plugins.apply(<span class="hljs-symbol"><span class="hljs-symbol">'org</span></span>.asciidoctor.convert') project.plugins.apply(<span class="hljs-type"><span class="hljs-type">DocumentationPlugin</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>) project.dependencies { asciidoctor <span class="hljs-symbol"><span class="hljs-symbol">'org</span></span>.asciidoctor:asciidoctorj:<span class="hljs-number"><span class="hljs-number">1.5</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>' docs <span class="hljs-symbol"><span class="hljs-symbol">'org</span></span>.slf4j:slf4j-api:<span class="hljs-number"><span class="hljs-number">1.7</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>' } }</code> </pre> <br><p>  As you can see, this is practically no different from what we wrote earlier, only <code>Closure</code> written slightly longer. </p><br><p>  Now we can test that our task from the plugin actually appeared in the configured project (and the configuration was successful in general): </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">def</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">execution</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">of</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">documentation</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">distribution</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">task</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">is</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">success</span></span>"() { <span class="hljs-attribute"><span class="hljs-attribute">when</span></span>: project then: project.<span class="hljs-built_in"><span class="hljs-built_in">getTasksByName</span></span>(<span class="hljs-string"><span class="hljs-string">'documentationDistZip'</span></span>, true).<span class="hljs-built_in"><span class="hljs-built_in">size</span></span>() == <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> </pre> <br><p>  But more than this we can not test.  That is, through this method, we do not understand that the task will do what it is supposed to do, and, say, the document will actually be generated. </p><br><p>  <strong>Bottom line:</strong> you can use to check the configuration of projects.  This is faster than testing through actual execution.  But our possibilities are very limited. </p><br><h3 id="rezyume">  Summary </h3><br><p>  The use of the <code>Nebula Test</code> for plugins testing is recommended.  If you have a spreading logic when configuring a project, then it makes sense to look towards Unit-testing.  Well, we are waiting for the finished <code>Gradle Test Kit</code> . </p><br><p>  Link to the project with tests and plugin: <a href="https://github.com/aatarasoff/documentation-plugin-demo">https://github.com/aatarasoff/documentation-plugin-demo</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/282924/">https://habr.com/ru/post/282924/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282912/index.html">We send data from Arduino to Azure IoT Hub</a></li>
<li><a href="../282914/index.html">Writing the background process on Apache Cordova</a></li>
<li><a href="../282916/index.html">IMAPSync. Transfer mail between servers</a></li>
<li><a href="../282918/index.html">Performance Indicators: KVM vs. Xen</a></li>
<li><a href="../282922/index.html">Work with WAV files using PHP</a></li>
<li><a href="../282926/index.html">About Modbus and Intel Edison Protocol</a></li>
<li><a href="../282930/index.html">Smart or virtual hardware drivers</a></li>
<li><a href="../282932/index.html">About the usefulness of indexes by expressions</a></li>
<li><a href="../282934/index.html">Easy Hack: Java application</a></li>
<li><a href="../282936/index.html">Efficient Rails - a new book on optimizing the development of Rails applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>