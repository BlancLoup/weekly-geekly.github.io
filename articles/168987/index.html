<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SMS payments: how it works</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Why SMS payments? 
 Now you will not surprise anyone with the possibility of paying for services by sending an SMS to a certain ‚Äúshort number‚Äù. Even t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SMS payments: how it works</h1><div class="post__text post__text-html js-mediator-article"><h4>  Why SMS payments? </h4><br>  Now you will not surprise anyone with the possibility of paying for services by sending an SMS to a certain ‚Äúshort number‚Äù.  Even the farthest person from the Internet could hear on TV: ‚ÄúSend an SMS to the number XXXX to vote for YYYY‚Äù, and at the bottom of the screen see the inscription: ‚Äú* the cost of sending 30 rubles‚Äù.  Below I will tell how it works. <br><a name="habracut"></a><br><h5>  pros </h5><br>  Why is this payment method so good?  Here are the main, in my opinion, arguments: <br><ol><li>  <i>Ease of payment</i> <br>  Today, almost every resident of the country has a mobile phone, and therefore almost everyone has the possibility of such a payment method.  To use, you need a minimum of gestures: take the phone and type a small text, and if payment comes from a mobile application (for example, a game), then the user usually only needs to press the ‚ÄúOK‚Äù button a couple of times - the application will generate and send an SMS message. <br>  Despite the fact that most of the amount deducted from the subscriber‚Äôs account goes into the operator‚Äôs pocket, the size of the accessible audience more than covers the difference: even if we assume that the seller receives one third of the cost of an SMS, it‚Äôs enough to have only three times a larger audience than is required to earn the same amount using direct (no commission) payment methods. <br></li><li>  <i>Ease of processing payments</i> <br>  Processing of SMS payments can be fully automated.  And if the provision of the service being sold can also be automated, this means the possibility of fully automating the whole process. <br></li></ol><br><br><h5>  Minuses </h5><br><ol><li>  <i>Small percentage</i> <br>  Unfortunately, in the best (for the seller) case, 40% of the SMS cost goes to the operator, and since there can be several intermediaries between the seller and the operator, below, the seller can ultimately receive, say, only 10 20% of the cost. </li><li>  <i>Fixed cost</i> <br>  The cost of sending an SMS to a short number is determined in advance at the operator level, so the only way to differentiate the amount of payment is to use several short numbers with different values. <br></li><li>  <b>[UPDATE:]</b> <i>Increased probability of failure</i> <br>  Since the message path can be quite long (2-3 jumps), there is an increased (on a vizdku, about 0.1%) probability of SMS delivery failure.  With each such case, you have to understand the "manual" mode, which again can be difficult, because first you need to figure out at what stage the failure occurred.  If the subscriber turns to the operator, then the problem "goes down" until there is a place of failure.  If the subscriber turns to the seller, the problem on the contrary ‚Äúrises‚Äù in the direction of the operator.  It is often easier to return money to the subscriber than to understand, and what actually happened. <br></li></ol><br><br><h4>  SMS Life Cycle </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Types of tariffing </h5><br>  There are two types of tariffing: <br><ul><li>  <i>MO-charging ("Mobile Originated")</i> <br>  The cost is deducted from the subscriber's account at the time of <b>sending an</b> SMS to a specific short number. <br></li><li>  <i>MT rating ("Mobile Terminated")</i> <br>  The cost is deducted from the subscriber's account at the time of <b>receiving the</b> SMS message. <br>  More precisely, first the user sends an SMS to a short number (no money is charged for this), then it is checked whether the subscriber has enough money to pay for the service, and whether the seller is ready to provide this service.  If all is well, a message is sent to the subscriber, for which a fee is charged. <br></li></ul><br>  Which type of tariffication is used in a particular case depends on the country, operator, short number. <br>  <i><b>[UPGRADE:]</b> Fixed a bug in the MO schema</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/b66/805/325/b6680532536a55787a73a779873b16e9.png" alt="SMS life cycle in MO"><br><img src="https://habrastorage.org/getpro/habr/post_images/7cb/88f/b0a/7cb88fb0a49874a7dfbb694d9e4ee5c6.png" alt="SMS life cycle in MT"><br><br><h5>  Payment network agents </h5><br><ol><li>  <i>Operators</i> <br>  Clearly, it is those who provide communication services to subscribers.  For the provision of services, each operator allocates a number of short numbers, which he rents.  A short number refers only to the operator to which the subscriber is connected, i.e.  SMS message to a short number is processed only by this service provider.  The operator "pinches" the lion's share of the cost of SMS. <br></li><li>  <i>Aggregators</i> <br>  Operators are usually not interested in dealing with individual sellers, since they need constant and large SMS traffic, so operators negotiate with aggregators who are intermediaries between them and the sellers. <br>  It is desirable for the aggregator that SMS messages to the XXXX short number reach him regardless of which operator has the subscriber (otherwise you will have to force the subscriber to find out which operator he has and select the corresponding short number yourself), so he separately negotiates with each operator and takes they are renting room xxxx.  Naturally, if one of the popular operators does not want to lease the desired number, then it is more profitable for the aggregator to look for another number to which most operators will agree. <br>  The operator and the aggregator agree on the cost of short numbers among themselves and the share of each in the cost of SMS.  Naturally, the aggregator needs the same short number for different operators to be at least approximately the same, but there will always be a small difference.  One operator may have the same short number, for example, 150 rubles, and another - 165. <br></li><li>  <i>Subaggregator</i> <br>  Aggregators, in fact, also not always profitable to work directly with sellers, so they can negotiate with subaggregators. <br>  A subaggregator usually negotiates with one or several aggregators on the one hand (for example, because different aggregators may have different coverage across countries and different tariff schedules), and on the other, with sellers.  For example, a subaggregator can be any affiliate system that sells, not independently, but through its partners.  The subaggregator and the aggregator agree among themselves how they divide the cost of the SMS, remaining after the operator has taken its share. <br>  Of course, nothing interferes with the existence of sub-subaggregators, etc., but since at each stage a significant amount is ‚Äúpinned off‚Äù from the residual SMS cost, this process has a reasonable limitation. <br></li><li>  <i>Sellers</i> <br>  Actually - those who directly provide services, the final link in the chain.  Sellers negotiate with the (sub-) aggregator for their share of SMS. <br></li></ol><br><br><h5>  Methods for determining the cost and addressee of the SMS payment </h5><br>  Usually, the cost and aggregator-addressee of the SMS message are determined only by the short number to which it was sent, but in fact this is not always the case.  In some cases, it is clarified by the content of the SMS text.  The aggregator can agree with the operator that the cost of an SMS to this number will be determined by the so-called ‚Äúprefix‚Äù - a pre-specified combination of characters at the beginning of the SMS text.  For example, it may be decided that all SMS to the number XXXX, starting with the text ‚ÄúAGREG1‚Äù or ‚ÄúAGREG2‚Äù, go to this aggregator, with the first ones costing $ 1 and the second $ 2. <br><br>  Since the aggregator has a limited number of numbers, it usually agrees with the subaggregator that SMS is sent to it, from certain short numbers and starting with a prefix attached to it, for example, ‚ÄúSUB‚Äù.  In the case when the cost is set by the prefix, it can be two-syllable, for example, ‚ÄúAGREG1 SUB‚Äù (the following is the text essential for the subaggregator). <br><br>  In turn, the subaggregator can also calculate the vendor by the next level prefix (‚ÄúAGREG1 SUB SELLER1‚Äù), or somehow encrypt the vendor ID in the SMS body. <br><br>  Full identification of the addressee and the cost of the SMS is determined by the parameters: <br>  Country - Operator - Short number - SMS text. <br><br><h4>  Technical details </h4><br><h5>  Sub Affiliate Interface </h5><br>  As a rule, all network agents, from the operator to the subaggregator, provide their sub-partners with a tool for obtaining statistics on SMS payments.  It is usually made in the form of a site where a sub-partner can register, start his own projects, view current SMS and revenue statistics, and get various reports. <br><br><h5>  Transportation system </h5><br>  In addition to the user interface, operators and aggregators (and sometimes subaggregators) provide a software interface for two-way interaction.  This interface is implemented in the form of web scripts that make http (s) requests to each other when it is necessary to transmit any information. <br><br>  Consider the example of the interaction of the aggregator and subaggregator. <br>  Each aggregator uses its own protocol and provides its own set of features, there is no standard protocol, but there is a set of standard data that is somehow provided by the aggregator to the sub-partner when receiving an SMS message: <br><ul><li>  <i>SMS text</i> <br>  In some cases, text can be delivered without a prefix, or the prefix can be delivered in a separate field. <br></li><li>  <i>Short number</i> <br>  The number to which the message was sent.  Required to determine the cost and type of service. <br></li><li>  <i>A country</i> <br>  The service can be provided in different countries, and therefore at different prices.  Sometimes a country has to be identified by an operator ID. <br></li><li>  <i>Operator</i> <br>  Some operator ID.  Different operators have different prices. <br></li></ul><br><br>  Other possible data: <br><ul><li>  <i>Session ID</i> <br>  Provided by most aggregators.  Used to determine which of the user requests we are currently processing.  For example, for MT-billing, the first request may contain a description of the SMS and session ID, and the second - a delivery report - only the session ID and payment status (delivered / canceled / expected). <br>  The session ID can also be used when responding from the subaggregator to the aggregator.  The fact is that more often the aggregators receive a response immediately as a result of the http request (i.e., the aggregator server makes an http request to the subaggregator server, in response to it the subaggregator sends the result of request processing), but sometimes the aggregator requires a response that is not the same request, and in the reverse parallel (i.e. after receiving a request from the aggregator, the subaggregator immediately answers ‚ÄúOK, received‚Äù, then processes it and already makes a new http-request to the server of the aggregator, in which it transmits the actual result plus the session ID to it was clear which SMS  and there is a speech). <br></li><li>  <i>Subscriber's phone number</i> <br>  Sometimes it is provided completely, sometimes partially, sometimes not at all. <br></li><li> <i>Caller ID</i> <br>  Provided by some systems in the form of an internal (for the aggregator) subscriber ID. <br></li><li>  <i>Attempt number</i> <br>  Sometimes the aggregator cannot reach the server of the subaggregator the first time, then it can repeat the same request after some time, but specifying a new connection attempt number (0 for the first attempt, 1 for the second, etc.).  If for a certain period the aggregator did not reach the subaggregator, then it may cancel payment processing. <br></li><li>  <i>Request time</i> <br>  It may be necessary to identify the message more accurately if the time on the server of the aggregator and subaggregator is not synchronized. <br></li></ul><br><br>  In addition, the following can be transmitted: internal (for the aggregator) short number identifier, tariff identifier, full SMS cost, subaggregator income, currency in which the payment was made, and so on. <br><br>  In response, the subaggregator usually sends the SMS text to be sent to the subscriber and / or an error description. <br><br>  Some aggregators allow the subaggregator to send SMS messages when it is necessary (not in response to the subscriber‚Äôs SMS, but as a broadcast) to the specified number, but the fee is charged from the subaggregator itself.  Also, some aggregators allow you to split the response into several messages. <br><br><h5>  Securing Communication </h5><br>  For communication security, the following methods are used: <br><ul><li>  Using encrypted protocols </li><li>  Encrypt request text using a predefined password </li><li>  Transfer of a pre-set password in the request text without using encryption </li><li>  Transfer MD5-hash from a predefined list of fields including a password </li><li>  Limit the list of IPs from which requests can be received </li></ul><br><br><h4>  Instead of a conclusion. </h4><br>  Of course, in my article I did not indicate all the possible nuances, and some things were told very blurry, but I tried to give a theoretical basis, which is completely enough to see the system from a bird's-eye view, and use it as a guide to action. <br><br>  <b>Thanks for attention!</b> </div><p>Source: <a href="https://habr.com/ru/post/168987/">https://habr.com/ru/post/168987/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168977/index.html">HTML with images in DOC in PHP with your own hands</a></li>
<li><a href="../168979/index.html">Results of a uniform rating of web studios 2013</a></li>
<li><a href="../168981/index.html">Monitor the health of HP Proliant servers at nagios / icinga. Plugins check_hpasm and check_ilo2_health.pl</a></li>
<li><a href="../168983/index.html">The buzz around Nokia‚Äôs early collapse is unjustified, or what are analysts keeping back?</a></li>
<li><a href="../168985/index.html">About long life and imminent death of magnetic stripe cards</a></li>
<li><a href="../168989/index.html">Review of Mark Siman's book "Dependency Injection in .NET"</a></li>
<li><a href="../168991/index.html">VDI & APP-V 5.0 & RDS Windows Server 2012 from ex-architect Microsoft</a></li>
<li><a href="../168993/index.html">Small talk about dough-driven baking</a></li>
<li><a href="../168997/index.html">We move information about users in Active Directory and Sharepoint using PowerShell</a></li>
<li><a href="../168999/index.html">Motion system do-it-yourself for $ 13</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>