<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using FitNesse for .Net applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr. 

 I think many of you have heard about such a thing as FitNesse . This is one of the test technologies where tests are created as wiki mark...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using FitNesse for .Net applications</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr. <br><br>  I think many of you have heard about such a thing as <a href="http://fitnesse.org/">FitNesse</a> .  This is one of the test technologies where tests are created as wiki markup (i.e., each test is a web page), and then it is run on a specific technology <a href="http://fitnesse.org/PlugIns">(Java, .Net, PowerShell, etc.)</a> <br><br>  In this article I will tell you about the example of using <a href="http://fitnesse.org/">FitNesse</a> for testing .Net applications.  And at the same time I will show a few tricks and tricks to reduce your development time.  By the way, all these technologies are absolutely free. <br><a name="habracut"></a><br><h5>  What it looks like </h5><br>  As I said, all the tests in FitNesee look like web pages.  The entire test can be represented as a sequence of tables, with each table containing one function.  But this is a theory, but in practice the function call looks like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <table><tbody><tr><td>  <b>login as</b> </td><td>  Some user </td></tr></tbody></table><br><br>  Immediately I will explain that the Habrovsky plates look stretched.  In fact, FitNesse will compress them to a minimum size - see here: <a href="http://fitnesse.org/FitNesse.UserGuide.TwoMinuteExample">http://fitnesse.org/FitNesse.UserGuide.TwoMinuteExample</a> . <br><br>  This label contains a call to the ‚ÄúloginAs‚Äù method, which receives ‚ÄúSome User‚Äù as input.  That is, the programmer implements the loginAs function, and then the tester can use it.  As you already understood, the name of the function is the combined bold text.  Parameters are plain text.  Each cell contains only one parameter.  Also, each cell contains either bold text or plain text. <br><br><table><tbody><tr><td>  <b>login history of user</b> </td><td>  Some user </td><td>  <b>is</b> </td></tr><tr><td>  <b>When</b> </td><td>  <b>IP</b> </td></tr><tr><td>  07/05/2014 </td><td>  192.168.0.1 </td></tr><tr><td>  07.06.2014 </td><td>  192.168.0.1 </td></tr></tbody></table><br><br>  In this case, the LoginHistoryOfUserIs function is launched with the argument Some User.  At the exit, a collection of objects is expected, each of which has the When and IP properties. <br><br>  Absolutely similarly, you can input a set of objects (for example, settings ‚Äî this label with key / value pairs). <br><br>  Total, each test is a sequence of similar tables.  The programmer creates functions, the tester creates a test script with their help.  Naturally, common pieces of code can be separated into separate files, templates are supported, you can define blocks that will run before each test, etc. The basic functionality is sufficiently rich to test applications (at least, business logic, separate from the UI ) <br><br><h5>  How to run </h5><br>  As I said above, FitNesse can run functions in different technologies and programming languages.  It looks like this: <br><br><ol><li>  FitNesse parses wiki markup, determines what needs to be run (which web pages) </li><li>  FitNesse launches the selected Runner in the required programming language and tells it what to run.  Moreover, only text is transmitted, there are no objects here. </li><li>  Runner already knows which classes it works with.  He parses the table and calls the function. </li></ol><br><br>  In this article I will describe the work on the .Net platform, so all classes and functions will be from this world.  In order to determine the Runner, you should first write these lines: <br><br>  ! define COMMAND_PATTERN {% m% p} <br>  ! define TEST_RUNNER {.. \ binary \ currentBuild \ NetRunner.Executable.exe} <br>  ! path .. \ binary \ testBuild \ NetRunner.InternalTests.dll <br><br>  The first relates to the Runner ( <a href="https://github.com/imanushin/NetRunner">in the example this Runner is used</a> ).  It determines how FitNesse will run Runner.  All these arguments are passed to the input + system variables, but these are details. <br>  The second line is the path to Runner. <br>  The third line is the path to dlls (there may be several!) That contain your API.  It's simple. <br><br>  And here is an example for <a href="https://github.com/jediwhale/fitsharp/downloads">another Runner</a> : <br><br>  ! define TEST_RUNNER {$ {working_directory} Lib \ fitsharp \ Runner.exe} <br>  ! define COMMAND_PATTERN {% m -a $ {working_directory} \ MyTests.dll.config -r fitnesse.fitserver.FitServer, $ {working_directory} Lib \ fitsharp \ fit.dll -v% p} <br>  ! path $ {working_directory} MyTests.dll <br><br>  As you can see, here I have initially defined the variable $ {working_directory}.  And further, depending on its values, Runners from different folders will be launched and, most importantly, the tests are also in different folders.  Such a structure is very useful on the build platform, where there can often be several branches for which builds and tests run. <br><br>  So, to make this whole system work: <br>  1. Download and run FitNesse <br>  2. Download one of the Runners. <br>  3. Create your own library that references Runner libraries and implements minimal API. <br>  4. Create a test that calls your library functions. <br>  5. Run it <br><br>  Everything, after that you already have a small test that does at least something.  Then it‚Äôs a small matter to improve the quality of the API, increase the number of tests and run them during the build process. <br><br><h5>  How to create a test API? </h5><br>  As you see above, creating tests that use the API is extremely simple: you simply call functions, compare values, create a business script.  Naturally, for this, it is necessary to create high-quality functions for launching, in order to ‚Äúemulate‚Äù business actions.  After all, in fact, the integration test is an ordinary tester who works 24/7 and can click a mouse very quickly. <br><br>  But with the creation of a test API has its own difficulties.  In my examples, I will use <a href="https://github.com/jediwhale/fitsharp">this Runner</a> , since it is the most common (it is even mentioned on the FitNesse website). <br><br>  First you need to understand how this fitSharp works.  And he does the following things: <br><ol><li>  Defines a list of dll that should be run </li><li>  Defines the configuration file to use. </li><li>  Creates a new <a href="http://msdn.microsoft.com/ru-ru/library/system.appdomain(v%3Dvs.110).aspx">Application Domain</a> for tests. </li><li>  Successively launches the functions requested by FitNesse </li></ol><br><br>  You need to create classes that contain these same functions to run.  For this: <br><ol><li>  Create a project </li><li>  Add <a href="https://www.nuget.org/packages/FitSharp/">this NuGet package</a> </li><li>  Create a class that inherits DoFixture.  Name the class, for example, MyTestFixture </li><li>  Create some method, for example, public void MyTest () </li><li>  Open FitNesse (I hope it has already been copied and launched) </li><li>  Create a new test in it </li><li>  Define TEST_RUNNER, COMMAND_PATTERN, and! Path just about the way I described above.  Use absolute paths best, so it will be easier to start. </li><li>  Add a table with just one cell - [namespace] .MyTestFixture.  Wiki text will look like |  ''! - [namespace of class MyTestFixture] .MyTestFixture-! '' |.  In essence, this is the full class name. </li><li>  Add a table with a single cell too - MyTest: |  '' 'My Test' '' |  (by the way, the case of characters is not important) </li><li>  Run the test </li></ol><br><br>  If there were no flaws, then the test will start.  So, what we did: <br><br><ol><li>  Magic with the creation of classes.  The fact is that initially fitSharp finds only classes that inherit from DoFixture.  Further it will create them and launch functions.  Classes can be internal. </li><li>  Explaining FitNesse'u, what and where we will run. </li><li>  Magic with fixture by default.  The fact is that fitSharp requires a function in style |  class name |  function name + arguments |.  Most often, all functions are combined in one class.  In order not to write it at the beginning each time, you can define it once from above.  Unfortunately, it is not always possible to redefine (there is an opinion that this is a bug).  And a few also do not define. </li><li>  Run test function.  With this, everything is quite simple: what function it was, this one was launched. </li></ol><br><br>  With simple texts more or less clear.  We turn to the difficult. <br><br><h6>  Difficult parameters </h6><br>  Consider the LoginAs (string userLogin) function.  It is more or less clear what it should do according to its meaning - it should be included in a certain system, and then the test environment should work as if from this user.  Everything is logical.  However, what parameter to pass to the input?  Option 1 - just pass a line, and then disassemble it.  Not very convenient, since if we have two functions: login and Get Login History, we will have to repeat the parsing procedure, etc. <br>  Although it is not documented, in fact there is a very simple solution: if you want to take a class as input, then it should have a public static Parse method (string arg).  Which, naturally, will return our class.  For example, Int32 fully fits the definition (for structures this also works).  Using this scheme, we get a good division of responsibility: our test methods will work with already more or less processed data.  And all exceptions when parsing will still be displayed to the user. <br>  An absolute analogy occurs with the methods that return collections (see above).  They are checked with the help of the table, well, that is, the tester sends the expected data to the input, and your function must return the correct collection.  In this case, if you return a class in which all fields can be parsed (well, that is, all types have the Parse method), then it will not be a string comparison, but a comparison of objects.  Which is already fully controlled by you. <br><br><h6>  Entrance sign </h6><br>  It is often convenient to add data to the system using tables.  The standard example is any Mapping (for example, the settings are Map: name -&gt; value).  That is, in fact, a table and several columns are transmitted to the input.  This can also be done in fitSharp.  To do this, you need to create such a method: <br>  public SetUpFixture SetSettingsForUserAs (User user).  The name of the method and the arguments can be any, but the return value is SetUpFixture. <br>  Next, we implement the class - <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MySettings</span></span> : <span class="hljs-title"><span class="hljs-title">SetUpFixture</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> User user; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MySettings</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">User user</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.user = user; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NameValue</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> parameterName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> parameterValue</span></span></span><span class="hljs-function">)</span></span> { } }</code> </pre> <br><br>  And in the end, our table will look like this: <br><br><table><tbody><tr><td>  <b>Set Settings For User</b> </td><td>  habrauser </td><td>  <b>As</b> </td></tr><tr><td>  <b>Name</b> </td><td>  <b>Value</b> </td></tr><tr><td>  First name </td><td>  John </td></tr><tr><td>  Last name </td><td>  Doe </td></tr></tbody></table><br><br>  How the mapping of the columns occurred is more or less clear.  And the arguments are now served in the form of such tablets. <br><br><h6>  Auto start </h6><br>  So, you have created a test.  Or even a test suite - Test Suite.  And they earned in FitNesse.  Now it's time to start running them automatically. <br>  There are two main ways to run: <br><ol><li>  Using the rest request to perform a test, download xml (for example, <pre>  http: // myServer: 8080 / MyTests? suite &amp; format = xml </pre>  ).  The result will be an xml file with information about what was performed, how it worked, time, result, etc. </li><li>  Run another copy of FitNesse in the "run and close" mode: java.exe -jar "fitnesse-standalone.jar" -d D: \ -c "MyTests? Suite &amp; format = xml" -b "d: \ builds \ TestsResults.xml ".  In this case, FitNesse will start, execute the rest request itself and, after the response, close. </li></ol><br><br>  The second method always works, that is, it does not require running FitNesse, moreover, you can keep FitNesse running and simultaneously perform tests in this way.  All results will appear in both FitNesse. <br><br><h4>  Total </h4><br>  As a result, in this article I tried to quickly run over the tops and tell you how to create and run the FitNesse integration tests.  Most often, these steps go through a trial and error method, but if I had this article a year ago, it would have saved a couple of days for sure.  I hope she helps you too. </div><p>Source: <a href="https://habr.com/ru/post/228967/">https://habr.com/ru/post/228967/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../228957/index.html">Idris language overview</a></li>
<li><a href="../228959/index.html">Cost Optimization Yota: Attempt # 3</a></li>
<li><a href="../228961/index.html">Ubuntu and Debian Linux for advanced</a></li>
<li><a href="../228963/index.html">How to make binary classifier work a little bit better</a></li>
<li><a href="../228965/index.html">The story of the creation of the game</a></li>
<li><a href="../228969/index.html">Radio-controlled walking robot on MG90</a></li>
<li><a href="../228971/index.html">Tor Relay in five minutes</a></li>
<li><a href="../228973/index.html">We unlock the bike computer VDO A4 to A8</a></li>
<li><a href="../228977/index.html">Writing a package for PFSense</a></li>
<li><a href="../228979/index.html">7 things in optimizing landing pages that often do wrong</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>