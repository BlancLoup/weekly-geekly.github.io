<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Django, getting started with the database</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Acquaintance with django, Work with DB. 

 On Habr√© there are many topics about django, with descriptions of various goodies. But I have not met a pos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Django, getting started with the database</h1><div class="post__text post__text-html js-mediator-article"><h2>  Acquaintance with django, Work with DB. </h2><br><br>  On Habr√© there are many topics about django, with descriptions of various goodies.  But I have not met a post, about the beginning of the path, so to speak for a beginner.  So I want to write a short guide novice fighter, on their own steps. <br>  <a href="http://www.djbook.ru/">Thanks to www.djbook.ru</a> , the Russian translation of the online <a href="http://djangobook.com/en/2.0/">book about django</a> , it was from here that I got the data for writing a post. <br><br>  Further in the text I will try to briefly describe the general information necessary to work with the database in django. <br><a name="habracut"></a><br>  I'll start by listing the applications I have worked with: <br><ol><li>  python 2.6 </li><li>  django 1.1.1 </li><li>  postgreSQL 8.4.2 </li><li>  python-psycopg2 2.0.8-0 </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://djbook.ru/ch02s02.html">here is a link to how to install django</a> <br>  Since this is a description of my own experience, I will describe everything in steps, as I did. <br><br><h3>  The first step.  Creating a project </h3><br><br>  First you need to create a new project.  To do this, decide on the name of the project directory and its location.  In the selected directory run the command: <br> <code>django-admin.py startproject hellowDjango <br></code> <br>  This action will create a new project template called hellowDjango.  More information about what happens when you run the command can be found <a href="http://djbook.ru/ch02s05.html">here</a> .  The project was created and it is time to move on to the next step. <br><br><h3>  The second step, setting up the database </h3><br><br>  Django can work with a lot of databases, but in this example I use postgresql. <br><br>  I assume that you have already installed and configured the database.  If not, here is the link <a href="https://help.ubuntu.com/community/PostgreSQL">that helped me set up my database on Ubuntu</a> .  Open the settings file, settings.py located in the project directory hellowDjango, we find there such lines and modify them until: <br> <code>DATABASE_ENGINE = 'postgresql_psycopg2' #'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'. <br> DATABASE_NAME = myDBName # Or path to database file if using sqlite3. <br> DATABASE_USER = myUserDB # Not used with sqlite3. <br> DATABASE_PASSWORD = myUserDBPasswor # Not used with sqlite3. <br></code> <br>  Just in case, I will explain: <br><ul><li>  'postgresql_psycopg2' - the driver through which the application will perform queries to the database and receive data; </li><li>  myDBName - the name of the database; </li><li>  myUserDB is the main database user; </li><li>  myUserDBPasswor - password of the main user. </li></ul><br><br>  Now you need to check that everything is configured correctly, for this you need to run the command in the project directory: <br><br> <code>python manage.py shell</code> <br> <br>  This command will start the python interpreter with the project settings.  In the interpreter, we check the connection to the database. <br> <code>&gt;&gt;&gt; from django.db import connection <br> &gt;&gt;&gt; cursor = connection.cursor() <br></code> <br><br>  In case of an error in the settings, a message will appear that will help to make the necessary corrections. <br><br><h3>  The third step, creating the application. </h3><br>  A django application is a set of database models and views stored in the same python package.  In order to create an application, you must run the following command in the project directory: <br><br> <code>python manage.py startapp MyName</code> <br> <br>  This command will create the MyName directory in the project directory hellowDjango, as well as create application ‚Äúblank‚Äù files in the MyName directory. <br><br><h3>  The fourth step, the description of the model. </h3><br>  The django database model is a python table description.  To create an application model, you need to edit the file <b>MyName / models.py</b> .  The model describes many classes, each of which will describe one DB table, and the class property is one column of the table.  The class must be inherited from the models.Model described in the django.db.models package.  Class properties must have the types described in the django.db.models package.  All data types and their use are described <a href="http://djangobook.com/en/1.0/appendixB/">here</a> . <br><br>  I used the following data types for my own purposes: <br><ol><li>  models.DateTimeField () - the field contains the Date and Time </li><li>  models.CharField (max_length = xx) - A text field of limited length.  String length = xx characters </li><li>  models.BooleanField () - A field containing a boolean value </li><li>  models.ForeignKey () - link to external table </li><li>  models.PositiveIntegerField () - positive integer value </li><li>  models.URLField (max_length = xx) - a link to a web page; the link length is limited to xx characters </li><li>  models.DateField () - field containing Date </li></ol><br><br>  When creating a data model, I had a problem with foreign keys.  When referring to an external table that was described below, an error occurred.  Rearranging the tables solved this problem.  I note that when creating foreign keys, django adds the postfix _id to the name of the foreign key field. <br><br>  To check the correctness of the created model, run the following command: <br> <code>python manage.py validate</code> <br>  After the model has passed the test, you can see how django will offer to generate tables.  To do this, execute another command: <br> <code>python manage.py sqlall MyName</code> <br>  To create a model in the database, execute the following command: <br> <code>python manage.py syncdb</code> <br> <br><h3>  Fifth step.  Working with the database in the interpreter. </h3><br><br><h4>  Below are the options for inserting data into the database </h4><br><br>  We start the interpreter <br> <code>python manage.py shell</code> <br> <code>&gt;&gt;&gt; import MyName.models as mo #     <br> <br> &gt;&gt;&gt; type = mo.ProductClass() #      <br> &gt;&gt;&gt; type.class_name = '' #   <br> &gt;&gt;&gt; type.save() #     <br> &gt;&gt;&gt; type <br> &lt; ProductClass: ProductClass object&gt; <br> <br> #         <br> &gt;&gt;&gt; mo.Dealer(organization_name = "   ").save() #     Dealer <br> &gt;&gt;&gt; mo.Dealer.objects.all() #      Dealer <br> [&lt; Dealer:    &gt;] #      1      1 ,      . <br> <br> #              .  : <br> &gt;&gt;&gt; mo.Product(name = '', price = 50, product_class = type).save() <br> Traceback (most recent call last): <br> ... <br> IntegrityError: null value in column "diler_id" violates not-null constraint <br> &gt;&gt;&gt; mo.Product(name = '', price = 50, product_class = type, diler = mo.Dealer.objects.all()[0]).save() #     Product <br></code> <br><br><h4>  Now we need to talk about choosing data from tables. </h4><br> <code>#     <br> &gt;&gt;&gt; mo.Product.objects.all() <br> [&lt; Product: &gt;, &lt; Product: &gt;, &lt; Product: &gt;] <br> <br> #    name <br> &gt;&gt;&gt; mo.Product.objects.filter(name = '') <br> [&lt; Product: &gt;] <br> <br> #     <br> &gt;&gt;&gt; mo.Product.objects.filter(name__contains = '') <br> [&lt; Product: &gt;, &lt; Product: &gt;] <br></code> <br><br>  We considered the insertion and selection of data. <br><h4>  Let's look at the options for updating records. </h4><br> <code>#            <br> &gt;&gt;&gt; item2 = mo.Product.objects.get(name = '') <br> &gt;&gt;&gt; item2.name = " " <br> &gt;&gt;&gt; item2.save() <br></code> <br>  This example is simple but has its drawback; it performs the update of all fields of the record, and not just those that have changed.  This fact can lead to a ‚Äúrace‚Äù of users when there is a massive change in the data in the Table.  To solve this problem, it will be correct to use the update method.  This method changes only the specified fields. <br> <code>&gt;&gt;&gt; mo.Product.objects.filter(id=3).update(name='oves') <br> 1 <br> &gt;&gt;&gt; cole[2] <br> &lt; Product: oves&gt; <br></code> <br><br><h4>  The last thing I want to describe is the removal of records from the database. </h4><br>  There are two ways to delete entries: <br><br>  First delete all data from table <br> <code>&gt;&gt;&gt; cm.Dealer.objects.all() <br> [&lt; Dealer:    &gt;] <br> &gt;&gt;&gt; cm.Dealer.objects.all().delete() <br> &gt;&gt;&gt; cm.Dealer.objects.all() <br> [] <br></code> <br>  Second deletion of selected entries <br> <code>&gt;&gt;&gt; cm.ProductClass.objects.all()[0].id <br> 1 <br> &gt;&gt;&gt; cm.ProductClass.objects.filter(id=1).delete() <br> &gt;&gt;&gt; cm.ProductClass.objects.all() <br> [] <br></code> <br>  For more information about all the commands api work with the database and you can read <a href="http://djangobook.com/en/1.0/appendixC/">here</a> . <br><br>  Here is a brief description of the possibilities of working with the database in django, I hope this information will be useful. <br>  A little more detailed article can be read in my <a href="http://sadhamster.blogspot.com/2010/03/django.html">blog.</a> <br></div><p>Source: <a href="https://habr.com/ru/post/87357/">https://habr.com/ru/post/87357/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../87351/index.html">Coffee table - he is a laptop from Sony</a></li>
<li><a href="../87353/index.html">I will give in good hands</a></li>
<li><a href="../87354/index.html">Google refuses SearchWiki</a></li>
<li><a href="../87355/index.html">The most lifting aircraft An-225 "Dream"</a></li>
<li><a href="../87356/index.html">About nanofilters, clean water and inquisition - ask a question to Gryzlov-Man</a></li>
<li><a href="../87358/index.html">English. Learning problems</a></li>
<li><a href="../87359/index.html">CodeIgniter News - 2.0 soon</a></li>
<li><a href="../87362/index.html">Tele2 :: Roaming</a></li>
<li><a href="../87364/index.html">PyPy 1.2 came out and accelerated Python at times!</a></li>
<li><a href="../87365/index.html">Screwing PollDaddy.com. Battle for iPad in 4 actions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>