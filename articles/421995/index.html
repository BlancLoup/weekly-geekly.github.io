<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Differences Between Website Compilation and Web Application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are many variations of ASP.NET modules based on different platforms, such as Web Forms, Web Pages, Model-View-Controller (MVC) and the newest Co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Differences Between Website Compilation and Web Application</h1><div class="post__text post__text-html js-mediator-article">  There are many variations of ASP.NET modules based on different platforms, such as Web Forms, Web Pages, Model-View-Controller (MVC) and the newest Core.  In this article I want to consider a number of differences between the compilation of an ASP.NET website and an ASP.NET web application. <br><br><img src="https://habrastorage.org/webt/fs/b2/fd/fsb2fdsaeqflgf8aq0zyekqxd_4.jpeg"><a name="habracut"></a><br><br>  Compilation of the website (Fig. 1) and web applications (Fig. 2). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/ce/wz/wt/cewzwtnulzesee4umhzuct-g16k.png"><br><br>  <i>Fig.</i>  <i>1: ASP.NET website and the difference between an ASP.NET website and an ASP.NET web application</i> <br><br><img src="https://habrastorage.org/webt/cl/yq/9b/clyq9bkc9z_xsghewgwrl21vx4g.png"><br><br>  <i>Fig.</i>  <i>2: ASP.NET Web Application and the Difference between an ASP.NET Web Site and an ASP.NET Web Application</i> <br><br>  This article is not about the internal structure of ASP.NET projects, but about the experience that I gained while working on the Azure App Service platform.  The internal structure is already documented <a href="https://docs.microsoft.com/en-us/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/precompiling-your-website-cs">here</a> - ‚ÄúPrecompiling Your Website (C #)‚Äù (‚ÄúPrecompiling a website in C #‚Äù).  You need to understand the difference between automatic and explicit compilation.  In addition, if you are dealing with an ASP.NET website, seriously consider precompiling using aspnet_compiler.exe, as described in the <a href="https://msdn.microsoft.com/library/ms227972.aspx">article</a> ‚ÄúHow to: Precompile ASP.NET Web Sites‚Äù (‚ÄúHow to precompile websites ASP.NET "). <br><br>  Here are a number of publications that will help you expand your horizons on this issue and explore other topics: <br><br><ul><li>  <a href="https://blogs.msdn.microsoft.com/benjaminperkins/2015/12/01/why-is-my-asp-net-application-recycling/">"Why is my ASP.NET application recycling, restarting" ("Why an ASP.NET application is recompiled, reloaded")</a> </li><li>  <a href="https://blogs.msdn.microsoft.com/benjaminperkins/2017/12/21/must-use-must-know-windbg-commands-my-most-used/">"Must use, must know WinDbg commands, my most used" ("WinDbg commands that you need to know and use and which I use most often")</a> </li><li>  <a href="https://blogs.msdn.microsoft.com/benjaminperkins/2016/06/20/lab-28-the-impact-of-debugtrue/">Lab 28: The impact of debug = true ("Session 28: the effect of debug = true")</a> </li><li>  <a href="https://blogs.msdn.microsoft.com/benjaminperkins/2012/09/16/debug-true/">‚ÄúDebug = True‚Äù</a> </li><li>  <a href="https://blogs.msdn.microsoft.com/benjaminperkins/tag/asp-net/">All my articles on ASP.NET</a> </li></ul><br>  So, how did it all start?  I wanted to check whether I understand the process of compiling ASP.NET modules into assemblies correctly, and decided to do it in the Azure App Service environment.  I already knew about temporary ASP.NET files, about compiling ASPX files into a .dll assembly, and where they were stored on a standalone server.  I was sure that on the App Service platform, the first two items were implemented in the same way, but I doubted the third one, namely, where the compiled assemblies are stored.  So I wrote the code to find out. <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> _<span class="hljs-title"><span class="hljs-title">default</span></span> : <span class="hljs-title"><span class="hljs-title">System</span></span>.<span class="hljs-title"><span class="hljs-title">Web</span></span>.<span class="hljs-title"><span class="hljs-title">UI</span></span>.<span class="hljs-title"><span class="hljs-title">Page</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Page_Load</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { LabelFileLocation.Text = <span class="hljs-string"><span class="hljs-string">$"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{System.Web.HttpRuntime.CodegenDir}</span></span></span><span class="hljs-string">"</span></span>; rptResults1.DataSource = System.IO.Directory.GetFiles(System.Web.HttpRuntime.CodegenDir, <span class="hljs-string"><span class="hljs-string">"*.dll"</span></span>); rptResults1.DataBind(); } }      () &lt;asp:Repeater ID=<span class="hljs-string"><span class="hljs-string">"rptResults1"</span></span> runat=<span class="hljs-string"><span class="hljs-string">"server"</span></span>&gt; &lt;HeaderTemplate&gt;&lt;table&gt;&lt;/HeaderTemplate&gt; &lt;ItemTemplate&gt; &lt;tr&gt; &lt;td&gt;&lt;%<span class="hljs-meta"><span class="hljs-meta"># Container.DataItem %&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/ItemTemplate&gt; &lt;FooterTemplate&gt;&lt;/table&gt;&lt;/FooterTemplate&gt; &lt;/asp:Repeater&gt;</span></span></code> </pre> <br>  Then I published this code on the App Service platform. <br><br>  When I first accessed the website, I got the result shown in fig.  3 (initially there were three pages in the root of my ASP.NET website) <br><br><img src="https://habrastorage.org/webt/hg/zi/gu/hgziguyugjpggh0jxrokjm79nny.png"><br><br>  <i>Fig.</i>  <i>3: Compile an ASP.NET website on the Azure App Service platform</i> <br><br>  I restarted the website, and the binaries compiled into the new build (Figure 4).  This was rather unexpected, since I only performed a reboot and did not make any deployments or changes. <br><br><img src="https://habrastorage.org/webt/xp/m5/kw/xpm5kwlqdzdo9gbo9ir_gbw6w3w.png"><br><br>  <i>Fig.</i>  <i>4: Compile an ASP.NET website on the Azure App Service platform</i> <br><br>  I searched the build directory in KUDU and did not find it;  it was very strange. <br><br>  After clicking the ‚ÄúAnother Page‚Äù and ‚ÄúAnd another Page‚Äù links, all my pages were compiled into one assembly, and I was quite surprised to find this, because my web.config file was set to debug = true. <br><br>  I needed to find out the answers to the following questions: <br><br><ol><li>  Why did my application recompile after a reboot, although I did not perform any deployments or configuration changes? </li><li>  Why did I not find the build in KUDU, although my source code was correct? </li><li>  Why did my application compile into a single assembly, although the debug = true parameter was set in the web.config file? </li></ol><br>  The answer to the first question was that I was actually looking at the KUDU build, and not the one that was compiled for the App Service.  Take a look at Figure 2 in the <a href="https://blogs.msdn.microsoft.com/benjaminperkins/2017/02/01/create-a-memory-dump-for-your-slow-performing-web-app/">article</a> ‚ÄúCreate a memory dump for your slow performing Web App‚Äù.  Here it is shown that KUDU works in a different process than App Service.  So KUDU recompiled itself when creating an instance, and it was not my instance of App Service. <br><br>  I also dealt with the second question on the basis of information obtained on the first question.  I‚Äôll omit the details about the configuration of files on the App Service platform and say that I managed to display my ASP.NET web site assemblies on this platform: for this I set the WEBSITE_DISABLE_SCM_SEPARATION value to true (see Figure 5).  Do this only for testing and / or debugging and for nothing more.  I do not recommend matching multiple pages of a website to a single process in the App Service.  After debugging, reset this value and re-divide the processes. <br><br><img src="https://habrastorage.org/webt/o2/qr/tv/o2qrtvgwe47wzcwdipcpmyzburo.png"><br><br>  <i>Fig.</i>  <i>5: Compile an ASP.NET website into an Azure App Service;</i>  <i>I can not find temporary files ASP.NET on KUDU</i> <br><br>  The answer to the third question was that if the Web.Debug.config file is present during the deployment process, the debug = true attribute is deleted. <br><br><pre> <code class="cs hljs">&lt;compilation xdt:Transform=<span class="hljs-string"><span class="hljs-string">"RemoveAttributes(debug)"</span></span> /&gt;</code> </pre> <br>  I wrote about XDT files <a href="https://blogs.msdn.microsoft.com/benjaminperkins/2015/03/03/making-changes-to-the-applicationhost-config-on-azure-websites/">here</a> , <a href="https://blogs.msdn.microsoft.com/benjaminperkins/2018/01/09/how-to-disable-preloadenabled-on-an-azure-app-service/">here</a> and <a href="https://blogs.msdn.microsoft.com/benjaminperkins/2017/06/12/changing-the-maxlogfilesizekb-on-an-azure-app-service/">here</a> , but in this case I had to think a little bit in order to understand (remember, realize) their meaning. <br><br>  After setting the WEBSITE_DISABLE_SCM_SEPARATION parameter to true, I stopped and started, in other words, cold start ... and saw that in fact both SCM / KUDU and my website started up in the same process (Fig. 6.) <br><br><img src="https://habrastorage.org/webt/7a/sy/kk/7asykkocx_f85ytnjpqksmhh6zw.png"><br><br>  <i>Fig.</i>  <i>6: Compile the ASP.NET website into the Azure App Service;</i>  <i>I can not find temporary files ASP.NET on KUDU</i> <br><br>  Publication and compilation of default.aspx is initiated, the name of the assembly remains unchanged after all requests (Fig. 7). <br><br><img src="https://habrastorage.org/webt/6f/ks/5c/6fks5cvijafskfvdax_0rernwe8.png"><br><br>  <i>Fig.</i>  <i>7: Compile an ASP.NET website on the Azure App Service platform</i> <br><br>  To verify this, I took a memory dump of the process, took a dump of the module and analyzed it.  Honestly, I was still puzzled by the result displayed by the resulting assembly, as I figured out the debug = true parameter only after all the tests were completed.  Sometimes I do not write articles in the order in which events follow.  In confusion, I decided to test the batch compilation;  read about it <a href="https://msdn.microsoft.com/en-us/library/s10awwz0(v%3Dvs.85).aspx">here</a> : ‚ÄúCompilation Element (ASP.NET Settings Schema)‚Äù (‚ÄúCompilation Element - ASP.NET web settings schema‚Äù).  I expected that one build would be compiled per page, so the result (see Figure 8) came as a complete surprise. <br><br><img src="https://habrastorage.org/webt/_z/xx/jt/_zxxjtcna1xw1xsu1el2uthc1nc.png"><br><br>  <i>Fig.</i>  <i>8: Compile an ASP.NET website on the Azure App Service Platform</i> <br><br>  I expected to see one build per page, since I thought that I was working with the parameter debug = true.  Reading about batch compilation, I realized that it compiles all pages into an assembly contained in a specific directory.  So I created two directories and placed aspx files in each of them.  The PID did not change, so there was no ‚Äúcold start‚Äù (Fig. 9). <br><br><img src="https://habrastorage.org/webt/u9/xv/i-/u9xvi-tatl-pbcdclryyuh4k56s.png"><br><br>  <i>Fig.</i>  <i>9: Compile an ASP.NET website on the Azure App Service platform</i> <br><br>  However, the site was indeed recompiled into another binary file, but remained in the same directory (path) (Fig. 10). <br><br><img src="https://habrastorage.org/webt/nq/mp/i1/nqmpi1_6w3oe6o-ot3-j4odg5hs.png"><br><br>  <i>Fig.</i>  <i>10: Compile an ASP.NET website on the Azure App Service platform.</i> <br><br>  I made a memory dump to make sure my conclusions were correct.  And as soon as I turned to the site root and saw that all the pages in the catalog were compiled, I realized that my hypothesis about batch compilation was confirmed (Fig. 11). <br><br><img src="https://habrastorage.org/webt/-k/8d/ea/-k8deauc5scgcfwhawwhz--7yxa.png"><br><br>  <i>Fig.</i>  <i>11: Compile an ASP.NET website on the Azure App Service platform</i> <br><br>  I followed the ‚ÄúDirectory 1‚Äù link and saw another build (fig. 12). <br><br><img src="https://habrastorage.org/webt/7u/oh/jd/7uohjdt0h4dr2ewwor9t6_f7mac.png"><br><br>  <i>Fig.</i>  <i>12: Compile an ASP.NET website on the Azure App Service platform.</i> <br><br>  I did a memory dump again, took a module dump and saw that it really corresponds to the ‚ÄúDirectory 1‚Äù page (Figure 13). <br><br><img src="https://habrastorage.org/webt/om/0d/lv/om0dlv5ixpbp3wjsg6vnggfphoa.png"><br><br>  <i>Fig.</i>  <i>13: Compile an ASP.NET website on the Azure App Service platform</i> <br><br>  I did the same for the ‚ÄúDirectory 2‚Äù page (Fig. 14 and 15). <br><br><img src="https://habrastorage.org/webt/lq/wd/fj/lqwdfjfxsg6du4k3q9qnlbstksi.png"><br><br>  <i>Fig.</i>  <i>14: Compile an ASP.NET website on the Azure App Service platform.</i> <br><br><img src="https://habrastorage.org/webt/rd/jy/ic/rdjyicwmjyelxdfijkoefwddsqm.png"><br><br>  <i>Fig.</i>  <i>15: Compile an ASP.NET website on the Azure App Service platform.</i> <br><br>  I also got the opportunity to go to the assemblies themselves in SCM / KUDU (Fig. 16). <br><br><img src="https://habrastorage.org/webt/wi/gq/g_/wigqg_1d19lyyclnnrq98g_bucc.png"><br><br>  <i>Fig.</i>  <i>16: Compile an ASP.NET website on the Azure App Service platform</i> <br><br>  As soon as I found out the problem with the parameter debug = true, everything fell into place, and it was a good learning experience.  I hope that my article will be useful for you. <br><br><img src="https://habrastorage.org/webt/us/ky/dm/uskydmcgdhawgffrunohviocjoa.png"><br><br><h2>  Useful resources </h2><br><h4>  Cloud Application Architecture Guide </h4><br> <a href="https://azure.microsoft.com/ru-ru/campaigns/cloud-application-architecture-guide/%3Fwt.mc_id%3DAID729732_QSG_270347"><img width="200" align="left" src="https://habrastorage.org/webt/zk/ns/pq/zknspqark8ose3vto4iom_kbdaq.jpeg"></a>  Use a structured approach to developing cloud applications.  This 300-page e-book on cloud computing architecture discusses architecture, development, and deployment recommendations that apply regardless of the cloud platform chosen.  This guide includes steps to: <br><br><ul><li>  Choosing the right style of the cloud application architecture for your application or solution; </li><li>  selection of appropriate computing and data storage technologies; </li><li>  implementation of 10 development principles for creating a scalable, fault-tolerant and managed application; </li><li>  following the five principles of creating high-quality software that guarantees the success of your cloud application; </li><li>  using constructive patterns intended for the problem you are trying to solve. </li></ul><br><br>  ‚Üí <a href="https://azure.microsoft.com/ru-ru/campaigns/cloud-application-architecture-guide/%3Fwt.mc_id%3DAID729732_QSG_270347"><b>Download</b></a> <br><br><h4>  Azure Developer Guide </h4><br> <a href="https://azure.microsoft.com/ru-ru/campaigns/developer-guide/%3Fwt.mc_id%3DAID729732_QSG_270352"><img width="200" align="right" src="https://habrastorage.org/webt/ik/2g/ot/ik2gotwyadnbqcjeusitbjdk550.png"></a> <br><br>  From this update to the Azure Developer‚Äôs Guide, you‚Äôll find out how a complete set of services for the Azure software platform fits your needs.  Here you will find information about architectural approaches and the most common situations that arise when creating cloud applications. <br><br><br>  ‚Üí <a href="https://azure.microsoft.com/ru-ru/campaigns/developer-guide/%3Fwt.mc_id%3DAID729732_QSG_270352"><b>Download</b></a> <br><br><h4>  Microsoft Azure Basics </h4><br> <a href="https://info.microsoft.com/CE-AzureINFRA-CNTNT-FY18-05May-10-MicrosoftAzureEssentials-MGC0002411_01Registration-ForminBody.html%3Fwt.mc_id%3DAID729732_QSG_270354"><img width="200" align="left" src="https://habrastorage.org/webt/w1/pe/sj/w1pesji9lrslkdggsjzwdkya2la.png"></a>  This book provides insight into important information about Azure key services for developers and IT professionals who are not familiar with cloud computing.  Step-by-step demos are included to help the reader understand how to get started with each of the key services.  Each chapter is independent, no practical demonstrations from previous chapters are required to understand a particular chapter. <br><br>  This book covers the following topics: <br><br><ul><li>  Get started with Azure; </li><li>  Azure App Service and Web Apps; </li><li>  Virtual machines; </li><li>  Storage service; </li><li>  Database; </li><li>  Additional Azure services. </li></ul><br>  ‚Üí <a href="https://info.microsoft.com/CE-AzureINFRA-CNTNT-FY18-05May-10-MicrosoftAzureEssentials-MGC0002411_01Registration-ForminBody.html%3Fwt.mc_id%3DAID729732_QSG_270354"><b>Download</b></a> <br><br><h2>  useful links </h2><br><ul><li>  <a href="https://aka.ms/ASPNETCoret">ASP.NET documentation</a> </li><li>  <a href="https://aka.ms/aspnetttt">ASP.NET Core Tutorials</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/421995/">https://habr.com/ru/post/421995/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../421979/index.html">Dracula Theme is a universal theme for almost everything.</a></li>
<li><a href="../421983/index.html">Machine learning will help reduce the tsetse fly population to reduce the incidence of sleeping sickness</a></li>
<li><a href="../421985/index.html">GraphQL future of microservices?</a></li>
<li><a href="../421991/index.html">Hosting a web application on Amazon Web Services. Cheap. Is it possible?</a></li>
<li><a href="../421993/index.html">Python interesting and useful</a></li>
<li><a href="../422001/index.html">CO2 measurement device</a></li>
<li><a href="../422003/index.html">Fixed and variable costs in software development</a></li>
<li><a href="../422005/index.html">Raspberry Pi cartridge from NES</a></li>
<li><a href="../422007/index.html">How I did a line-interactive UPS (Part 1)</a></li>
<li><a href="../422009/index.html">Hungarian algorithm, or how mathematics helps in assigning assignments</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>