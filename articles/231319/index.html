<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We make a Cloud IVR with intellectual redirection and recognition in a few minutes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The standard scenario that many businesses need to implement is an IVR menu for an incoming call that allows you to either get some information or con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We make a Cloud IVR with intellectual redirection and recognition in a few minutes</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/f3a/b55/cd2/f3ab55cd2059459caa5df772012e3898.png" width="300" align="left">  The standard scenario that many businesses need to implement is an IVR menu for an incoming call that allows you to either get some information or contact a specific employee or operator of the company.  The caller can control the menu either by pressing the buttons on the phone (DTMF), or even voice (ASR).  Since the VoxImplant platform allows you to quickly write and debug call processing scripts in Javascript, we decided to tell you how you can improve your business experience in a few minutes by making a convenient and technological IVR menu.  In addition, you can intelligently distribute the load on your telephone system and employees.  For details, as usual, welcome under cat. <a name="habracut"></a><br>  As usual, we will need a free developer account VoxImplant ( <a href="https://voximplant.com/sign-up/">you can take here</a> ) and some free time.  So, in order to demonstrate more possibilities of VoxImplant, let's make an IVR, which asks for a call to call the city of Russia and tells the weather forecast for the selected city.  For weather information, we use the weather.yandex.ru service.  So, go to the control panel VoxImplant and in the Applications section create a new application, you can call it ivr.  Go to the Scenarios section and create a new script of the following form: <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     require(Modules.ASR); var call, asr, city, cityId, Weather = {}, // Yandex  Weather.cities tts_voice = Language.RU_RUSSIAN_FEMALE; //   text-to-speech //    function getCities() { var opts = new Net.HttpRequestOptions(); opts.rawOutput = true; Net.httpRequest("http://weather.yandex.ru/static/cities.json", function (e) { if (e.code == 200) { // json   octet-stream var response = bytes2str(e.data, 'utf-8'); //   Weather.cities eval(response); } else Logger.write("Couldn't load cities. Status: " + e.code); }, opts); } //  id        - function getCityId(name) { for (var i in Weather.cities) { var country = Weather.cities[i]; for (var k in country) { if (k.toLowerCase() == name.toLowerCase()) return country[k]; } } return -1; //   } //      ( ),   ,     ,        VoxEngine.addEventListener(AppEvents.Started, function (e) { getCities(); call = VoxEngine.callPSTN("  ", "    "); //   ,    ,    Voximplant      ,    caller id call.addEventListener(CallEvents.Connected, handleCallConnected); //    call.addEventListener(CallEvents.Failed, cleanup); call.addEventListener(CallEvents.Disconnected, cleanup); }); //    (      ) VoxEngine.addEventListener(AppEvents.CallAlerting, function (e) { getCities(); call = e.call; call.answer(); //    call.addEventListener(CallEvents.Connected, handleCallConnected); //    call.addEventListener(CallEvents.Disconnected, cleanup); }); //   function handleCallConnected(e) { call.say("!   ,      .", tts_voice); enableASR(); } //   function enableASR() { //   ASR,  ,  -      ( ) asr = VoxEngine.createASR(ASRLanguage.RUSSIAN_RU, ASRDictionary.ADDRESS_RU); //  ,        asr.addEventListener(ASREvents.CaptureStarted, function (e) { call.stopPlayback(); }); asr.addEventListener(ASREvents.Result, handleRecognitionResult); //      ASR call.sendMediaTo(asr); } //    function handleRecognitionResult(e) { //  ASR asr.stop(); //    50% if (e.confidence &gt;= 50) { city = e.text; if (city.toLowerCase() == "") city = "-"; //         cityId = getCityId(city); if (cityId == -1 &amp;&amp; /\s/g.test(city)) { Logger.write("Replacing whitespace"); city = city.replace(/\s/g, "-"); cityId = getCityId(city); } if (cityId !== -1) { call.say("   " + city, tts_voice); call.addEventListener(CallEvents.PlaybackFinished, handleCityChosen); } else { call.say(" ,     . ,  ,        .", tts_voice); enableASR(); } } else { call.say(" ,     . ,  ,        .", tts_voice); enableASR(); } } //    function declOfNum(number, titles) { cases = [2, 0, 1, 1, 1, 2]; return titles[(number % 100 &gt; 4 &amp;&amp; number % 100 &lt; 20) ? 2 : cases[(number % 10 &lt; 5) ? number % 10 : 5]]; } //        function handleCityChosen(e) { call.removeEventListener(CallEvents.PlaybackFinished, handleCityChosen); // cityId Net.httpRequest("http://export.yandex.ru/weather-ng/forecasts/" + cityId + ".xml", function (e) { if (e.code == 200) { Logger.write("Weather info has been loaded"); var data = e.text.split("\n").slice(1).join("\n"), forecast = new XML(data), ns = new Namespace('w', 'http://weather.yandex.ru/forecast'), temperature = forecast.ns::fact.ns::temperature, humidity = forecast.ns::fact.ns::humidity, pressure = forecast.ns::fact.ns::pressure, wind_speed = forecast.ns::fact.ns::wind_speed; wind_speed = parseFloat(wind_speed).toFixed(1).replace(/\.0{1}$/, ""); var forecast_string = " " + parseNumber(temperature) + " " + declOfNum(Math.abs(temperature), ['', '', '']) + ", " + forecast.ns::fact.ns::weather_type + ",  " + parseNumber(humidity) + " " + declOfNum(humidity, ['', '', '']) + ", " + "  " + parseNumber(pressure) + " " + declOfNum(pressure, ['', '', '']) + "  , " + "  " + parseNumber(wind_speed) + " " + declOfNum(wind_speed, ['', '', '']) + "  "; //     call.say(forecast_string, tts_voice); call.addEventListener(CallEvents.PlaybackFinished, VoxEngine.terminate); } else { Logger.write("Couldn't load weather info. Status: " + e.code); call.say(" ,    . ,   .", tts_voice); call.addEventListener(CallEvents.PlaybackFinished, VoxEngine.terminate); } }); } //   function cleanup(e) { Logger.write("Cleanup"); VoxEngine.terminate(); }</span></span></code> </pre> <br>  Do not forget to substitute your phone number in <pre> <code class="javascript hljs">call = VoxEngine.callPSTN(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">"    "</span></span>);</code> </pre>  , number format - 7xxxxxxxxxxx, well, or another country code, if you are not in Russia.  Also indicate the number from which the call will be made;  You can confirm the number you own through the Voximplant control panel.  Save, you can call the SmartIVR script.  If you carefully looked at the code, you noticed that there is a function parseNumber, which is not declared anywhere.  When calling, the executed scripts can be combined, so we can make a separate parseNumber script and insert the code of this function there: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parseNumber = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dictionary = [ [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span> ], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>], [<span class="hljs-string"><span class="hljs-string">"|||"</span></span>, <span class="hljs-string"><span class="hljs-string">"|||"</span></span>, <span class="hljs-string"><span class="hljs-string">"|||"</span></span>, <span class="hljs-string"><span class="hljs-string">"|||"</span></span>] ]; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">number, limit</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> temp = number.match(<span class="hljs-regexp"><span class="hljs-regexp">/^\d{1,3}([,|\s]\d{3})+/</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> temp[<span class="hljs-number"><span class="hljs-number">0</span></span>].replace(<span class="hljs-regexp"><span class="hljs-regexp">/[,|\s]/g</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); temp = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.abs(<span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(number)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (temp !== temp || temp &gt; limit) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>(temp); }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setEnding</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">variants, number</span></span></span><span class="hljs-function">) </span></span>{ variants = variants.split(<span class="hljs-string"><span class="hljs-string">"|"</span></span>); number = number.charAt(number.length - <span class="hljs-number"><span class="hljs-number">2</span></span>) === <span class="hljs-string"><span class="hljs-string">"1"</span></span> ? <span class="hljs-literal"><span class="hljs-literal">null</span></span> : number.charAt(number.length - <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (number) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"1"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> variants[<span class="hljs-number"><span class="hljs-number">0</span></span>] + variants[<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"2"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"3"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"4"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> variants[<span class="hljs-number"><span class="hljs-number">0</span></span>] + variants[<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> variants[<span class="hljs-number"><span class="hljs-number">0</span></span>] + variants[<span class="hljs-number"><span class="hljs-number">3</span></span>]; }; }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPostfix</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">postfix, number</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> postfix === <span class="hljs-string"><span class="hljs-string">"string"</span></span> || postfix <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (postfix.split(<span class="hljs-string"><span class="hljs-string">"|"</span></span>).length &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> + postfix; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> + setEnding(postfix, number); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">number, postfix</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> number === <span class="hljs-string"><span class="hljs-string">"undefined"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"999"</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(dictionary[<span class="hljs-number"><span class="hljs-number">3</span></span>].length + <span class="hljs-number"><span class="hljs-number">1</span></span>).join(<span class="hljs-string"><span class="hljs-string">" 999"</span></span>); number = <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>(number); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> minus = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; number.replace(<span class="hljs-regexp"><span class="hljs-regexp">/^\s+/</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>).replace(<span class="hljs-regexp"><span class="hljs-regexp">/^-\s*/</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ minus = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>; }); number = getNumber(number, <span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(dictionary[<span class="hljs-number"><span class="hljs-number">3</span></span>].length + <span class="hljs-number"><span class="hljs-number">2</span></span>).join(<span class="hljs-string"><span class="hljs-string">"999"</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!number) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>; postfix = getPostfix(postfix, number); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (number === <span class="hljs-string"><span class="hljs-string">"0"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> + postfix; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> position = number.length, i = <span class="hljs-number"><span class="hljs-number">0</span></span>, j = <span class="hljs-number"><span class="hljs-number">0</span></span>, result = []; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (position--) { result.unshift(dictionary[i++][number.charAt(position)]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i === <span class="hljs-number"><span class="hljs-number">2</span></span> &amp;&amp; number.charAt(position) === <span class="hljs-string"><span class="hljs-string">"1"</span></span>) result.splice(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, dictionary[<span class="hljs-number"><span class="hljs-number">0</span></span>][number.substring(position, position + <span class="hljs-number"><span class="hljs-number">2</span></span>)]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i === <span class="hljs-number"><span class="hljs-number">3</span></span> &amp;&amp; position !== <span class="hljs-number"><span class="hljs-number">0</span></span>) { i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (position &gt; <span class="hljs-number"><span class="hljs-number">3</span></span> &amp;&amp; number.substring(position - <span class="hljs-number"><span class="hljs-number">3</span></span>, position) === <span class="hljs-string"><span class="hljs-string">"000"</span></span>) { j++; <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; }; result.unshift(setEnding(dictionary[<span class="hljs-number"><span class="hljs-number">3</span></span>][j++], number.substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, position))); }; }; position = result.length - <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (result[position]) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>: result[position] = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>: result[position] = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (minus) result.unshift(<span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result.join(<span class="hljs-string"><span class="hljs-string">" "</span></span>).replace(<span class="hljs-regexp"><span class="hljs-regexp">/\s+$/</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>).replace(<span class="hljs-regexp"><span class="hljs-regexp">/\s+/g</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>) + postfix; }; }();</code> </pre><br>  Save the script, we can call it by the function name parseNumber.  If someone has a desire, then you can modify the function so that it can also translate fractional numbers into words :) It remains to attach our scripts to the application using rules (Rule), after which you can make the first test call to your phone.  To do this, go to the Applications section and edit our previously created ivr application - go to the Rules section and click Add Rule.  You can call the rule as you wish, since we are now making the rule for an outgoing call, we can call it OutboundTest, and leave it in. * In the Pattern, since the script is not taken into account when running scripts via the HTTP API API (the id is specified in the request).  Drag parseNumber and SmartIVR into Assigned and save (see screenshot) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/b68/682/565/b686825658204c32bf05b86da161eda7.png"><br><br>  If after that you hover the cursor over the newly created rule, we will see 3 buttons - to start, edit and delete.  We are interested in the first. <br><br><img src="https://habrastorage.org/files/a29/453/5ba/a294535ba4294a3aa0c606d6f3b14f74.png"><br><br>  A dialog appears that allows, in fact, conveniently to call the <a href="httpapi/managing_scenarios">StartScenarios</a> method described in the <a href="httpapi/">HTTP API</a> . <br><br><img src="https://habrastorage.org/files/999/dc7/60c/999dc760cc4448f68cc18ae0a1708a71.png"><br><br>  If you entered the phone number correctly, then after pressing the Run button you will receive an incoming call and will be asked to name the city of Russia, if the system recognizes the city and finds it in the Yandex Weather database, then they will tell you about the current weather in this city.  Of course, you can take a phone number and attach it to this scenario so that the IVR works for incoming calls, in this case, do not forget to comment out the AppEvents.Started handler, and then every time you call to IVR, the system will also make an outgoing call to your number :) The number is attached to the application in the Phone Numbers&gt; <a href="https://manage.voximplant.com/">My phone numbers</a> section, after which you need to make a rule (Rule) of the application that incoming calls to the number will send to our scripts, you can simply write a phone number to the Pattern. <br><br>  PS You can read about creating ordinary IVRs from the menu using VoxImplant <a href="http://voximplant.com/blog/ivr-module-usage-example/">in our blog.</a> </div><p>Source: <a href="https://habr.com/ru/post/231319/">https://habr.com/ru/post/231319/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../231309/index.html">Replacing HDD through official service and support of Western Digital in Russia</a></li>
<li><a href="../231311/index.html">Android and MikroTik</a></li>
<li><a href="../231313/index.html">"Building successful distributed teams" by Matthew Aldridge, in Kiev on July 31</a></li>
<li><a href="../231315/index.html">System for big science</a></li>
<li><a href="../231317/index.html">LG G3 smartphone and LG G Watch: tested in humans</a></li>
<li><a href="../231321/index.html">Gamification in E-commerce</a></li>
<li><a href="../231323/index.html">Overview of the most interesting materials on data analysis and machine learning ‚Ññ6 (July 21 - 28, 2014)</a></li>
<li><a href="../231325/index.html">Single refactoring analysis</a></li>
<li><a href="../231327/index.html">Anton Arkhipov - Class Loaders and Bytecode Instrumentation</a></li>
<li><a href="../231331/index.html">Interview with Dino Esposito, author of Microsoft .NET: Architecting Applications for the Enterprise</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>