<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Getting Started with Junos PyEZ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The topic of network automation is very popular now. One of the tools for such automation in the Juniper world is the PyEZ library, developed by the t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Getting Started with Junos PyEZ</h1><div class="post__text post__text-html js-mediator-article">  The topic of network automation is very popular now.  One of the tools for such automation in the Juniper world is the PyEZ library, developed by the team of Jeremy Schulman (Jeremy Schulman).  PyEZ is a micro-framework for remote control and automation of Juniper devices, written in Python.  The main advantage of PyEZ is its simplicity and focus on the audience of network engineers, not programmers. <br><br>  Some features of PyEZ: <br><ul><li>  Collect "facts", such as serial number, OS version, etc. </li><li>  Extracting operational (analogue of the show commands) information </li><li>  Retrieving Configuration </li><li>  Configuration change </li></ul><br>  In this article I would like to dwell on the possibility of extracting operational information on the example of the EX4200 switch. <br><a name="habracut"></a><br><h4>  Preparation for work </h4><br><ol><li>  Installing the framework itself comes down to one command: <br><br><pre><code class="bash hljs">pip install junos-eznc</code> </pre> <br>  On my Ubuntu 14.04, everything was established without problems, but if suddenly - I <a href="https://techwiki.juniper.net/Automation_Scripting/010_Getting_Started_and_Reference/Junos_PyEZ/Installation">recommend reading the official wiki page.</a> <br></li><li>  To access network devices, PyEZ uses the NETCONF protocol, which must be enabled. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">system</span></span> services netconf ssh</code> </pre><br>  NETCONF, in turn, works on top of SSH, so make sure that SSH is configured and an account is created to access the device. <br></li></ol><br><br>  At this stage, everything should be ready to go.  To check, you can try to connect to the device and remove the basic information. <br><br><pre> <code class="python hljs">dteslya@ubuntu:~$ python Python <span class="hljs-number"><span class="hljs-number">2.7</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span> (default, Mar <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">2014</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">59</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span>) [GCC <span class="hljs-number"><span class="hljs-number">4.8</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>] on linux2 Type <span class="hljs-string"><span class="hljs-string">"help"</span></span>, <span class="hljs-string"><span class="hljs-string">"copyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"credits"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"license"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pprint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pprint &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device &gt;&gt;&gt; dev = Device(host=<span class="hljs-string"><span class="hljs-string">'1.2.3.4'</span></span>) &gt;&gt;&gt; dev Device(<span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>) &gt;&gt;&gt; dev.open() Device(<span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>) &gt;&gt;&gt; pprint(dev.facts) {<span class="hljs-string"><span class="hljs-string">'2RE'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'HOME'</span></span>: <span class="hljs-string"><span class="hljs-string">'/var/home/dteslya'</span></span>, <span class="hljs-string"><span class="hljs-string">'RE0'</span></span>: {<span class="hljs-string"><span class="hljs-string">'last_reboot_reason'</span></span>: <span class="hljs-string"><span class="hljs-string">'Router rebooted after a normal shutdown.'</span></span>, <span class="hljs-string"><span class="hljs-string">'mastership_state'</span></span>: <span class="hljs-string"><span class="hljs-string">'master'</span></span>, <span class="hljs-string"><span class="hljs-string">'model'</span></span>: <span class="hljs-string"><span class="hljs-string">'EX4200-24F'</span></span>, <span class="hljs-string"><span class="hljs-string">'status'</span></span>: <span class="hljs-string"><span class="hljs-string">'OK'</span></span>, <span class="hljs-string"><span class="hljs-string">'up_time'</span></span>: <span class="hljs-string"><span class="hljs-string">'2 days, 3 hours, 34 minutes, 40 seconds'</span></span>}, <span class="hljs-string"><span class="hljs-string">'domain'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-string"><span class="hljs-string">'fqdn'</span></span>: <span class="hljs-string"><span class="hljs-string">'SW1'</span></span>, <span class="hljs-string"><span class="hljs-string">'hostname'</span></span>: <span class="hljs-string"><span class="hljs-string">'SW1'</span></span>, <span class="hljs-string"><span class="hljs-string">'ifd_style'</span></span>: <span class="hljs-string"><span class="hljs-string">'SWITCH'</span></span>, <span class="hljs-string"><span class="hljs-string">'master'</span></span>: <span class="hljs-string"><span class="hljs-string">'RE0'</span></span>, <span class="hljs-string"><span class="hljs-string">'model'</span></span>: <span class="hljs-string"><span class="hljs-string">'EX4200-24F'</span></span>, <span class="hljs-string"><span class="hljs-string">'personality'</span></span>: <span class="hljs-string"><span class="hljs-string">'SWITCH'</span></span>, <span class="hljs-string"><span class="hljs-string">'serialnumber'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'switch_style'</span></span>: <span class="hljs-string"><span class="hljs-string">'VLAN'</span></span>, <span class="hljs-string"><span class="hljs-string">'vc_capable'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'version'</span></span>: <span class="hljs-string"><span class="hljs-string">'12.3R8.7'</span></span>, <span class="hljs-string"><span class="hljs-string">'version_RE0'</span></span>: <span class="hljs-string"><span class="hljs-string">'12.3R8.7'</span></span>, <span class="hljs-string"><span class="hljs-string">'version_info'</span></span>: junos.version_info(major=(<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), type=R, minor=<span class="hljs-number"><span class="hljs-number">8</span></span>, build=<span class="hljs-number"><span class="hljs-number">7</span></span>)} &gt;&gt;&gt; dev.close() &gt;&gt;&gt;</code> </pre><br><br>  I will explain what is happening here.  First, two classes are imported: standard pprint for formatted output and Device from the PyEZ library.  Next, the device itself is announced to which we will connect.  When a device is declared, it is enough to specify only an IP address, then key authentication will be applied, and the user name will be taken from the $ USER environment variable.  Optionally, you can specify a username and password for password authentication (more details on the <a href="https://techwiki.juniper.net/Automation_Scripting/010_Getting_Started_and_Reference/Junos_PyEZ/Device_Connectivity">wiki</a> ).  Then there is the connection to the device and the collection of "facts" that are displayed using pprint, after which the connection is closed. <br><br>  Now you can move on to more interesting examples of using PyEZ. <br><br><h4>  Formulation of the problem </h4><br>  Consider the task of polling switches and removing information about the topology of Spanning Tree.  Roughly speaking, you need to go through the switches and display a list of ports of each switch, indicating the status of the STP. <br><br><h4>  Junos CLI </h4><br>  Let's see how to get this information using the CLI. <br><br><pre> <code class="hljs go">dteslya@SW1&gt; show spanning-tree <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> Spanning tree <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> parameters <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> instance <span class="hljs-number"><span class="hljs-number">0</span></span> Interface Port ID Designated Designated Port State Role port ID bridge ID Cost ge<span class="hljs-number"><span class="hljs-number">-0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">23.0</span></span> <span class="hljs-number"><span class="hljs-number">128</span></span>:<span class="hljs-number"><span class="hljs-number">536</span></span> <span class="hljs-number"><span class="hljs-number">128</span></span>:<span class="hljs-number"><span class="hljs-number">536</span></span> <span class="hljs-number"><span class="hljs-number">32768.54e032f</span></span>deb41 <span class="hljs-number"><span class="hljs-number">20000</span></span> DIS DIS xe<span class="hljs-number"><span class="hljs-number">-0</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> <span class="hljs-number"><span class="hljs-number">128</span></span>:<span class="hljs-number"><span class="hljs-number">561</span></span> <span class="hljs-number"><span class="hljs-number">128</span></span>:<span class="hljs-number"><span class="hljs-number">691</span></span> <span class="hljs-number"><span class="hljs-number">32768.3</span></span>c94d5902981 <span class="hljs-number"><span class="hljs-number">2000</span></span> FWD ROOT xe<span class="hljs-number"><span class="hljs-number">-0</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> <span class="hljs-number"><span class="hljs-number">128</span></span>:<span class="hljs-number"><span class="hljs-number">563</span></span> <span class="hljs-number"><span class="hljs-number">128</span></span>:<span class="hljs-number"><span class="hljs-number">563</span></span> <span class="hljs-number"><span class="hljs-number">32768.54e032f</span></span>deb41 <span class="hljs-number"><span class="hljs-number">2000</span></span> FWD DESG {master:<span class="hljs-number"><span class="hljs-number">0</span></span>}</code> </pre><br><br><h4>  Junos XML </h4><br>  Now let's see how it looks ‚Äúin reality‚Äù, i.e.  in xml. <br><div class="spoiler">  <b class="spoiler_title">show spanning-tree interface |</b>  <b class="spoiler_title">display xml</b> <div class="spoiler_text"><pre> <code class="xml hljs">dteslya@SW1&gt; show spanning-tree interface | display xml <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rpc-reply</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:junos</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://xml.juniper.net/junos/12.3R8/junos"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-information</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-instance</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">instance-id</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">instance-id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interfaces</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"brief"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface-name</span></span></span><span class="hljs-tag">&gt;</span></span>ge-0/0/23.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"128:536"</span></span></span><span class="hljs-tag">&gt;</span></span> 536 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"128:536"</span></span></span><span class="hljs-tag">&gt;</span></span> 536 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span>20000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span>DIS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"32768.54e032fdeb41"</span></span></span><span class="hljs-tag">&gt;</span></span> 54e032fdeb41 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-priority</span></span></span><span class="hljs-tag">&gt;</span></span>32768<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-role</span></span></span><span class="hljs-tag">&gt;</span></span>DIS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-role</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface-name</span></span></span><span class="hljs-tag">&gt;</span></span>xe-0/1/0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"128:561"</span></span></span><span class="hljs-tag">&gt;</span></span> 561 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"128:691"</span></span></span><span class="hljs-tag">&gt;</span></span> 691 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span>2000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span>FWD<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"32768.3c94d5902981"</span></span></span><span class="hljs-tag">&gt;</span></span> 3c94d5902981 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-priority</span></span></span><span class="hljs-tag">&gt;</span></span>32768<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-role</span></span></span><span class="hljs-tag">&gt;</span></span>ROOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-role</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface-name</span></span></span><span class="hljs-tag">&gt;</span></span>xe-0/1/2.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"128:563"</span></span></span><span class="hljs-tag">&gt;</span></span> 563 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"128:563"</span></span></span><span class="hljs-tag">&gt;</span></span> 563 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span>2000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span>FWD<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"32768.54e032fdeb41"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span>20000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span>DIS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"32768.54e032fdeb41"</span></span></span><span class="hljs-tag">&gt;</span></span> 54e032fdeb41 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-priority</span></span></span><span class="hljs-tag">&gt;</span></span>32768<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-role</span></span></span><span class="hljs-tag">&gt;</span></span>DIS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-role</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface-name</span></span></span><span class="hljs-tag">&gt;</span></span>xe-0/1/0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"128:561"</span></span></span><span class="hljs-tag">&gt;</span></span> 561 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"128:691"</span></span></span><span class="hljs-tag">&gt;</span></span> 691 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span>2000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span>FWD<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"32768.3c94d5902981"</span></span></span><span class="hljs-tag">&gt;</span></span> 3c94d5902981 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-priority</span></span></span><span class="hljs-tag">&gt;</span></span>32768<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-role</span></span></span><span class="hljs-tag">&gt;</span></span>ROOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-role</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface-name</span></span></span><span class="hljs-tag">&gt;</span></span>xe-0/1/2.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">interface-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"128:563"</span></span></span><span class="hljs-tag">&gt;</span></span> 563 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"128:563"</span></span></span><span class="hljs-tag">&gt;</span></span> 563 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span>128<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-port-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span>2000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-cost</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span>FWD<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-state</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">junos:format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"32768.54e032fdeb41"</span></span></span><span class="hljs-tag">&gt;</span></span> 54e032fdeb41 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-mac</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-priority</span></span></span><span class="hljs-tag">&gt;</span></span>32768<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">designated-bridge-priority</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-role</span></span></span><span class="hljs-tag">&gt;</span></span>DESG<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port-role</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-entry</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interfaces</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-instance</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stp-interface-information</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cli</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">banner</span></span></span><span class="hljs-tag">&gt;</span></span>{master:0}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">banner</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cli</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rpc-reply</span></span></span><span class="hljs-tag">&gt;</span></span> {master:0}</code> </pre></div></div><br>  Here it is worth making a digression and tell about the approach used by PyEZ to extract configuration and operational (running state) information from devices.  For this, the concepts of tables (Tables) and selections (Views) are introduced.  If we draw an analogy with databases, then in Junos there is an ‚Äúoperational database‚Äù, which consists of a set of tables.  For example, using the show route command, you can view the routing table, and using the show interfaces command, you can see the interface table.  In turn, Views, i.e.  sampling is a way of representing information from tables.  For example, show route protocol ospf will show only routes received via OSPF, i.e.  sampling from the entire routing table. <br><br><h4>  Yaml </h4><br>  Let's return to the received XML.  We are interested in the &lt;stp-interface-entry&gt; elements and &lt;interface-name&gt;, &lt;port-state&gt; and &lt;port-role&gt; elements included in them.  To access these elements, you need to define a table and a selection.  This is done in a separate YAML file. <br><br><pre> <code class="hljs kotlin">--- STPInterfaces: rpc: <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-stp-bridge-<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">information</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">item</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">stp-instance/stp-interfaces/stp-interface-entry key: interface-name view: STPInterfacesView STPInterfacesView: fields: state: port-state role: port-role</span></span></span></span></code> </pre><br><br>  Go through the contents: <br><ul><li>  <b>STPInterfaces</b> - the name of the table.  Maybe any. </li><li>  <b>rpc</b> is the command sent to the device.  You can view it using the xml rpc display filter in Junos CLI: <br><pre> <code class="xml hljs">dteslya@SW1&gt; show spanning-tree interface | display xml rpc <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rpc-reply</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:junos</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://xml.juniper.net/junos/12.3R8/junos"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rpc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">get-stp-bridge-interface-information</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">get-stp-bridge-interface-information</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rpc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cli</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">banner</span></span></span><span class="hljs-tag">&gt;</span></span>{master:0}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">banner</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cli</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rpc-reply</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></li><li>  <b>item</b> is a table element of interest.  It is specified using XPath with respect to the first element following the &lt;rpc-reply&gt; tag, i.e.  &lt;stp-interface-information&gt; in our case. </li><li>  <b>key</b> - the key with which you can refer to the records of interest in the table.  In our case, the key is &lt;interface-name&gt;. </li><li>  <b>view</b> - a link to a selection that retrieves data from a table element defined earlier. </li><li>  <b>STPInterfacesView</b> - the name of the sample.  Maybe any. </li></ul><br>  Finally, in <b>STPInterfacesView, we</b> define the fields of interest. <br><br>  In my opinion, to correctly compile a YAML file is the most difficult in the entire described process.  I highly recommend reading the <a href="http://www.w3schools.com/xpath/default.asp">XPath tutorial</a> . <br><br><h4>  Python shell </h4><br>  Now let's see how this can be used in Python.  Suppose the YAML file was saved as stp.yml. <br><pre> <code class="python hljs">Python <span class="hljs-number"><span class="hljs-number">2.7</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span> (default, Mar <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">2014</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">59</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span>) [GCC <span class="hljs-number"><span class="hljs-number">4.8</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>] on linux2 Type <span class="hljs-string"><span class="hljs-string">"help"</span></span>, <span class="hljs-string"><span class="hljs-string">"copyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"credits"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"license"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.factory <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> loadyaml &gt;&gt;&gt; yml_file = <span class="hljs-string"><span class="hljs-string">"stp.yml"</span></span> &gt;&gt;&gt; globals().update(loadyaml(yml_file)) &gt;&gt;&gt; dev = Device(host=<span class="hljs-string"><span class="hljs-string">'1.2.3.4'</span></span>) &gt;&gt;&gt; dev.open() Device(<span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>) &gt;&gt;&gt; tbl = STPInterfaces(dev) &gt;&gt;&gt; tbl.get() STPInterfaces:<span class="hljs-number"><span class="hljs-number">1.2</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span> items &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tbl: ... <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> key.name, key.role, key.state ... ge<span class="hljs-number"><span class="hljs-number">-0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">23.0</span></span> DIS DIS xe<span class="hljs-number"><span class="hljs-number">-0</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> ROOT FWD xe<span class="hljs-number"><span class="hljs-number">-0</span></span>/<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> DESG FWD &gt;&gt;&gt; dev.close() &gt;&gt;&gt;</code> </pre><br>  We get the same list of ports as in the CLI. <br><br><h4>  Useful links: </h4><br><ul><li>  <a href="http://forums.juniper.net/t5/Automation/Python-for-Non-Programmers-Part-1/bc-p/218543">Python for Non-Programmers</a> </li><li>  <a href="https://techwiki.juniper.net/Automation_Scripting/010_Getting_Started_and_Reference/Junos_PyEZ/Troubleshooting%252C_Auditing%252C_and_Reporting">Junos PyEZ: Troubleshooting, Auditing and Reporting</a> </li><li>  <a href="https://techwiki.juniper.net/Automation_Scripting/010_Getting_Started_and_Reference/Junos_PyEZ/Example%253A_CreatingTables_or_Views">Example: CreatingTables or Views</a> </li><li>  <a href="https://techwiki.juniper.net/Automation_Scripting/010_Getting_Started_and_Reference/Junos_PyEZ/Troubleshooting%252C_Auditing%252C_and_Reporting/Define_Operational_Table">Define Operational Table</a> </li><li>  <a href="https://techwiki.juniper.net/Automation_Scripting/010_Getting_Started_and_Reference/Junos_PyEZ/Troubleshooting%252C_Auditing%252C_and_Reporting/Using_Views">Using Views</a> </li><li>  <a href="http://ipengineer.net/2014/05/using-juniper-pyez-library/">Using the Juniper PyEZ Library [Beginner]</a> </li><li>  <a href="http://www.w3schools.com/xpath/default.asp">W3Schools XPath Tutorial</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/261775/">https://habr.com/ru/post/261775/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../261763/index.html">Antivirus adventure Vkontakte</a></li>
<li><a href="../261765/index.html">Trade Automation: A Service Engineer's View</a></li>
<li><a href="../261767/index.html">Creating a JMS Application Emulator with JMeter</a></li>
<li><a href="../261769/index.html">Puns on css</a></li>
<li><a href="../261773/index.html">The formula for calculating the number of days in the month</a></li>
<li><a href="../261777/index.html">Batcher's even-odd merge sort</a></li>
<li><a href="../261779/index.html">Express analysis of suspicious activity in the web server log</a></li>
<li><a href="../261781/index.html">About the intricacies of privacy in the Telegram Bots API: ‚Äúthis is not a bug, this is a feature‚Äù</a></li>
<li><a href="../261783/index.html">Vim in full: Working with Git</a></li>
<li><a href="../261785/index.html">Seven amazing "features" Javascript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>