<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing Windows 7 over the network using Microsoft Windows AIK</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago I ran into a situation that, in principle, does not cause any special problems for system administrators. There was a need to update t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing Windows 7 over the network using Microsoft Windows AIK</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/f40/77f/749/f4077f749925602836ae401041282f7e.jpg"><br><br>  Not so long ago I ran into a situation that, in principle, does not cause any special problems for system administrators.  There was a need to update the OS on numerous computers of the organization, which in turn still caused a number of some problems, solutions of which had to be assembled in parts, and also finished most of the whole process about what I actually want to tell you myself. <br><a name="habracut"></a><br>  These problems were limitations in having one DVD-ROM drive, one day of free time, as well as about twenty computers on which it was necessary to install Windows 7 with the entire set of necessary drivers, programs, etc. <br>  When searching for information in <a href="https://www.google.ru/">Google</a> on this issue, there was nothing that would work without jambs or work at all.  But let's start in order. <br><br><h4>  Preparing an operating system image </h4>  For ease of preparation of the combat OS, the latest version of <a href="https://www.virtualbox.org/">Oracle VirtualBox</a> , as well as Windows 7 x64 Professional, was taken as the basis.  The first thing you need to do is install and configure Windows 7 on a virtual machine.  To do this, in the process of adding a VM, we create two virtual hard disks.  One to install and configure Windows 7 on it, the second to save the image of the configured system on it.  You also need to install the Virtualbox Guest Additions guest OS add-on and create a shared folder to further copy the created image to the physical machine. <br>  After installing all the stuffing on the VM, go to the system preparation stage using the <b>sysprep</b> utility located in the root of our VM system: <pre><code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%windir%</span></span>\system32\sysprep\sysprep.exe</code> </pre> <br>  To prepare the system for creating a customized image, you need to set the utility parameters: <br><ol><li>  Go to the system's welcome window (OOBE) - this mode will be activated the next time you start the system.  Runs the computer in welcome screen mode. </li><li>  Tick ‚Äã‚Äãthe box ‚ÄúPreparing for use‚Äù - prepares the installation of Windows before creating the image.  Security ID (SID) is reset, system restore points are reset, event logs are deleted. </li><li>  Shutdown Options ‚ÄúShutdown‚Äù - upon completion of the utility operation, the system will complete its operation. </li></ol><br>  Do not start the OS before saving the system image, because during the next start of the computer, the specialized configuration step starts to work.  A new security identifier (SID) is created and the Windows activation clock is reset. <br><img src="https://habrastorage.org/storage2/f73/9e8/e74/f739e8e74177696b171b7475324a360d.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The utility also removes installed drivers.  To save them, you need to run <b>sysprep</b> from the command line with the parameter: <pre> <code class="dos hljs">/unattend:     </code> </pre>  In the answer file, you must specify the parameter PersistAllDeviceInstalls (starting with Windows 8 there is also the DoNotCleanUpNonPresentDevices parameter): <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PersistAllDeviceInstalls</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PersistAllDeviceInstalls</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Windows 8   &lt;DoNotCleanUpNonPresentDevices&gt;true&lt;/DoNotCleanUpNonPresentDevices&gt; --&gt;</span></span></code> </pre>  After cleaning, the system will automatically shut down.  We proceed to the next stage. <br><br><h4>  Install and configure Windows AIK + PE </h4>  Download and install the <a href="http://www.microsoft.com/ru-ru/download/details.aspx%3Fid%3D5753">Windows</a> Automated Installation <a href="http://www.microsoft.com/ru-ru/download/details.aspx%3Fid%3D5753">Kit (AIK) for Windows 7</a> .  After running setup.exe, select "Install Windows AIK".  There should be no particular problems during installation. <br><br><h5>  Creating and Configuring a Windows PE Image </h5>  <b>Windows PE</b> is the pre-installation environment used to prepare for OC installation.  Using Windows PE, we will capture the system volume into a wim image using the <b>imagex</b> utility and save it to another hard disk partition. <br>  In this case, creating a disk with a 64-bit version of Windows PE is considered.  If you are creating a disk with a 32-bit version of Windows PE, you will need to replace the architecture (amd64 with x86) in all commands. <br><br>  From the Start menu, go to All Programs&gt; Microsoft Windows AIK&gt; <b>Deployment Tools Command Prompt</b> ‚Äî all subsequent commands will be entered into this command line window.  Requires running as administrator. <br>  Copy Windows PE image files <br><pre> <code class="dos hljs">copype.<span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span> amd64 d:\winpe_image</code> </pre><br>  To modify a copied Windows PE image, you must connect it with the command <br><pre> <code class="dos hljs">dism /Mount-Wim /WimFile:d:\winpe_image\winpe.wim /index:<span class="hljs-number"><span class="hljs-number">1</span></span> /MountDir:d:\winpe_image\mount</code> </pre><br>  Now, having connected the image, we can install packages into it and add our own files. <br>  Add the <b>imagex</b> utility to our image. <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> "<span class="hljs-variable"><span class="hljs-variable">%ProgramFiles%</span></span>\Windows AIK\Tools\amd64\imagex.exe" d:\winpe_image\iso\</code> </pre><br>  Also, if desired, you can immediately prepare a list of exceptions - files and folders that will not be included in the saved image.  Create a Wimscript.ini file in any text editor and specify in it the files and folders that you want to exclude from the image.  The Wimscript.ini file is located in the same folder as the imegex. <br>  By default, <b>imagex</b> uses the following exceptions: <br><pre> <code class="dos hljs">[ExclusionList] \$ntfs.log \hiberfil.sys \pagefile.sys "\System Volume Information" \RECYCLER \Windows\CSC [CompressionExclusionList] *.mp3 *.zip *.cab \WINDOWS\inf\*.pnf</code> </pre><br>  Now you need to save the image with the command: <br><pre> <code class="dos hljs">dism /unmount-Wim /MountDir:d:\winpe_image\mount /Commit</code> </pre><br>  All the preparatory work was done with the winpe.wim file, and for the Windows PE boot disk, the boot.wim file located in the winpe_x86 \ ISO \ sources folder is used.  Therefore, it is necessary to replace the boot.wim file with the winpe.wim file, while renaming it. <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> /yd:\winpe_image\winpe.wim d:\winpe_image\ISO\sources\boot.wim</code> </pre><br>  To create an image, execute the command: <br><pre> <code class="dos hljs">oscdimg -n -bd:\winpe_image\etfsboot.com d:\winpe_image\ISO d:\winpe_image\winpe_image.iso</code> </pre><br><h5>  Creating a Windows 7 Image </h5>  It is necessary to save the image of our OS using the <b>imagex</b> utility.  We are loading into the VM from the image winpe_image.iso that we created earlier.  After a successful download, a command line window opens before us, and we‚Äôll just work in it. <br>  Capture and save the image produced by one team. <br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">F:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">imagex.exe</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">capture</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">E</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">D</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">install.wim</span></span></span><span class="hljs-function"> "</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Windows</span></span></span><span class="hljs-function"> 7 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x64</span></span></span><span class="hljs-function">" /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compress</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maximum</span></span></span></span></code> </pre><br>  <b>/ capture E:</b> - capture section E: <br>  <b>D: \ install.wim</b> is the location and name of the saved WIM file. <br>  <b>"Windows 7 x64"</b> - the name of the image.  The name must be enclosed in quotes. <br>  <b>/ compress maximum</b> - type of compression of files in the image (optional).  For the <b>/ compress</b> option, the <b>maximum</b> (maximum compression), <b>fast</b> (fast compression) and <b>none</b> (without compression) values ‚Äã‚Äãare allowed.  If not specified, fast compression is used.  Maximum compression can reduce the size of the image, but the capture takes longer than with fast compression.  The speed of unpacking an image is almost independent of the type of compression.  It remains to wait 20-30 minutes and the image will be ready. <br><br>  After saving the image on the second disk of the virtual machine, for further work it needs to be transferred to the physical OS.  We start the virtual machine again and complete the installation of Windows, which was interrupted at the OOBE stage.  If you have already installed Virtual Machine Additions, you now need to copy the file from the virtual machine to the physical one using the shared folder, which can be specified in the virtual machine settings. <br><br><h5>  Configuring a boot image of Windows 7 </h5>  At this stage, run the ‚ÄúDeployment Tools Command Prompt‚Äù again and copy the Windows PE image files: <br><pre> <code class="dos hljs">copype.<span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span> amd64 d:\winpe</code> </pre><br>  Mount image <br><pre> <code class="dos hljs">imagex /mountrw winpe.wim <span class="hljs-number"><span class="hljs-number">1</span></span> mount</code> </pre>  Windows PE is mounted and in the d: \ winpe folder you can find the file winpe.wim. <br><br><h5>  Setup autorun installation Windows. </h5>  In order not to manually create a virtual disk and not to start the installation manually, you can edit the startnet.cmd and startnet2.cmd files.  They are located d: \ winpe \ mount \ windows \ system32. <br><br>  startnet.cmd <br><pre> <code class="dos hljs">wpeinit <span class="hljs-variable"><span class="hljs-variable">%windir%</span></span>\system32\startnet2.<span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span></code> </pre><br>  startnet2.cmd <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">chcp</span></span> <span class="hljs-number"><span class="hljs-number">1251</span></span> netsh interface ip <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> address name="   " source=dhcp <span class="hljs-built_in"><span class="hljs-built_in">chcp</span></span> <span class="hljs-number"><span class="hljs-number">866</span></span> <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span> use z: \\<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>\win7 /user:install install <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d Z:\sources setup.exe</code> </pre><br>  The net use command connects to the computer with the IP address 192.168.0.1 (our server computer) to the shared directory with the name win7 as the install user with the same password. <br>  We can create the user we need with such a command in cmd <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">net</span></span> user install install /add /passwordchg:no</code> </pre><br>  Follow the instructions below: <br><ul><li>  On the server computer, create the root directory for the boot (I have d: \ win7 \), and in it the folder boot. </li><li>  We share the win7 folder, that is, we share it with all users. </li><li>  Copy the entire sources folder from the Windows 7 installation disk to d: \ win7. </li><li>  Replace the install.wim file in the d: \ win7 \ sources directory with the file that was previously copied from the virtual machine (ready Windows 7 image) </li></ul><br>  Now you need to copy additional files to install Windows 7. <br>  Mount the WinPE image: <br><pre> <code class="dos hljs">imagex /mountrw winpe.wim <span class="hljs-number"><span class="hljs-number">1</span></span> mount</code> </pre><br>  We copy: <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> d:\winpe\mount\windows\boot\pxe\pxeboot.n12 d:\win7 <span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> d:\winpe\mount\windows\boot\pxe\bootmgr.exe d:\win7 <span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> d:\winpe\winpe.wim d:\win7\boot <span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> d:\winpe\iso\boot\boot.sdi d:\win7\boot</code> </pre><br>  Unmount the image with the command: <br><pre> <code class="dos hljs">imagex.exe /unmount d:\winpe\mount</code> </pre><br><br>  Next, you need to create a BCD file (boot configuration data) in the d: \ win7 \ boot directory.  To simplify this process, use the createbcd.cmd file.  Create the file d: \ winpe \ createbcd.cmd and enter into it: <br><pre> <code class="dos hljs">bcdedit -createstore %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -create {ramdiskoptions} /d "Ramdisk options" bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> {ramdiskoptions} ramdisksdidevice boot bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> {ramdiskoptions} ramdisksdipath \boot\boot.sdi <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /F "tokens=<span class="hljs-number"><span class="hljs-number">2</span></span> delims={}" <span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ('bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -create /d "MyWinPE Boot Image" /application osloader') <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> guid={<span class="hljs-variable"><span class="hljs-variable">%%i</span></span>} bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">%guid%</span></span> systemroot \Windows bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">%guid%</span></span> detecthal Yes bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">%guid%</span></span> winpe Yes bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">%guid%</span></span> osdevice ramdisk=[boot]\Boot\winpe.wim,{ramdiskoptions} bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-variable"><span class="hljs-variable">%guid%</span></span> device ramdisk=[boot]\Boot\winpe.wim,{ramdiskoptions} bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -create {bootmgr} /d "Windows BootManager" bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> {bootmgr} timeout <span class="hljs-number"><span class="hljs-number">30</span></span> bcdedit -store %<span class="hljs-number"><span class="hljs-number">1</span></span>\BCD -<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> {bootmgr} displayorder <span class="hljs-variable"><span class="hljs-variable">%guid%</span></span></code> </pre><br>  Run the command as an administrator: <br><pre> <code class="dos hljs">createbcd.<span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span> d:\win7\boot</code> </pre><br>  If you have any problems with the drivers, you can add them as well in the ‚ÄúCommand Line Deployment Tools‚Äù: <br>  Mounting the image to add drivers <br><pre> <code class="dos hljs">dism /mount-wim /wimfile:winpe.wim /index:<span class="hljs-number"><span class="hljs-number">1</span></span> /mountdir:mount</code> </pre><br>  To integrate drivers into an already mounted image, use the command <br><pre> <code class="dos hljs">dism /image:mount /add-driver /driver:&lt;       inf&gt;</code> </pre><br>  After all the work with the image is finished, it must be unmounted. <br><pre> <code class="dos hljs">dism /unmount-wim /mountdir:mount /commit</code> </pre><br><br><h4>  Configure TFTP server and DHCP </h4>  To create these servers you need to download the program <a href="http://tftpd32.jounin.net/tftpd32_download.html">TFTPD32</a> . <br>  The task of the DHCP server is to provide information to the remote computer about the free IP address, network mask, as well as the name of the download file and the TFTP server address where this file is located.  The task of a TFTP server is to ensure the transfer required for downloading files to a remote computer. <br><br>  Run the program and first select the folder d: \ win7, and a little lower - the IP of the network card.  In my case, the computer has an IP of 192.168.0.1. <br>  Go to the settings (the Settings button in the middle below) and gradually fill in the tabs: <br><ul><li>  GLOBAL tab - tick only opposite TFTP Server, DHCP Server and Enable IPv6. </li><li>  TFTP tab - select the folder d: \ win7. </li><li>  TFTP Security - Standart. </li><li>  TFTP configuration - leave as is. </li><li>  Advanced TFTP Options - there should be ticks opposite: Option negotiation, Show Process bar and Translate Unix file names. </li><li>  DHCP tab </li><li>  IP pool starting address indicates which IP address to start issuing addresses from.  In my example, the issuance of IP addresses will start from 192.168.0.2. </li><li>  Size of pool indicates the number of IP addresses that will be dynamically allocated.  I set the value to 30. </li><li>  Boot File tells the remote computer the name of the file to be used as a bootloader.  Set the value in pxeboot.n12. </li><li>  Mask, indicates the netmask.  In our case, this is 255.255.255.0.  The remaining values ‚Äã‚Äãof the parameters are left as default. </li><li>  Ping address before assignation - uncheck (if you have a computer-to-computer connection without switches and routers). </li></ul><br>  Now you need to enable the BIOS from the network card and boot from it.  After that, the IP address will be obtained via DHCP and execute pxeboot.n12 - which will launch Windows PE from the winpe.wim file.  Immediately after booting up Windows PE, the win7 directory will be automatically mounted and the installation will start.  Next, the installation is the same as with the disk. </div><p>Source: <a href="https://habr.com/ru/post/171017/">https://habr.com/ru/post/171017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../171005/index.html">Story of one optimization</a></li>
<li><a href="../171007/index.html">4 life hacking for investing in a startup: hooray, there is a fast and simple legal model</a></li>
<li><a href="../171009/index.html">Product Information Support: KANO Special Practice</a></li>
<li><a href="../171011/index.html">We work with the VKontakte API from the Google Chrome extension</a></li>
<li><a href="../171015/index.html">Example - clock on CSS3 without images and javascript</a></li>
<li><a href="../171019/index.html">Prediction system based on neural networks in industry</a></li>
<li><a href="../171021/index.html">Programming low latency sound in iOS</a></li>
<li><a href="../171025/index.html">Practical tips for portfolio building for testers</a></li>
<li><a href="../171029/index.html">‚ÄúFake video work of the smartphone application with the background around‚Äù or ‚ÄúHow to save on the DIY stabilization system‚Äù or ‚ÄúIs it possible to write this down with a thread of software right in the smart?‚Äù</a></li>
<li><a href="../171031/index.html">New Grandmothers. "Innovative" cloud video surveillance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>