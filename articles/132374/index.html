<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Little Java Tricks. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the continuation of the first article I will add a few more strokes about the most common errors and just bad code that you often have to deal with...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Little Java Tricks. Part 2</h1><div class="post__text post__text-html js-mediator-article">  In the continuation of the first <a href="http://habrahabr.ru/blogs/java/132241/">article</a> I will add a few more strokes about the most common errors and just bad code that you often have to deal with when working with already written projects.  I could not stand it in the first part, as these situations are much less common, but since the first part caused a lot of positive feedback, I decided to continue.  Thanks to all the commentators, feedback and comments.  I will try to avoid mistakes.  So let's continue: <br><br><h6>  Buffered Streams </h6><br><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// InputStream is = new FileInputStream(file); int val; while ((val = is.read()) != -1) { } // InputStream is = new BufferedInputStream(new FileInputStream(file)); int val; while ((val = is.read()) != -1) { }</span></span></code> </pre> <br>  It would seem - an obvious truth, is not it?  But as someone else's code and experience of interviewing candidates showed, some of the developers definitely do not understand the advantage of buffered streams.  Who hasn't figured it out yet - the read () method of the FileInputStream class: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">native</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException</span></span>;</code> </pre><br>  Agree, every time to make a system call to count one byte is somewhat wasteful.  Actually, in order to avoid this problem, shell buffers were created.  All that they do is the first time the system call read () is read, it is slightly larger (depending on the specified buffer size, which is 8 kb by default) and the next time that read () is read, the data is already read from the buffer.  Productivity gains - by an order.  System calls, in fact, are not always bad, for example: <br><pre> <code class="java hljs">System.arraycopy(src, srcPos, dest, destPos, length);</code> </pre> <br>  In the case of copying an array, the system method will be much faster implemented in java.  And yet - read the data in portions, rather than bytes, it also allows you to decently save. <br><a name="habracut"></a><br><h6>  Enum vs string </h6><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// String status = plan.getStatus(); if (status.equals("draft")) { //do stuff } else if (status.equals("submitted")) { //do stuff } // PlanStatus status = plan.getStatus(); if (status == PlanStatus.DRAFT) { //do stuff } else if (status == PlanStatus.SUBMITTED) { //do stuff }</span></span></code> </pre><br>  Use Enum for predefined model states where possible.  This not only simplifies the understanding of the code, but also speeds up the process of comparing these states.  Comparison by reference is definitely an order of magnitude faster than aligning strings or other objects.  However, in this case there is one big minus - the cost of supporting the application increases, this becomes especially noticeable when you need to add, delete or change one of the existing states.  But if this is unchanged properties, like the month of the year, then feel free to use the listing. <br><br><h6>  ArrayList vs HashSet </h6><br>  Carefully approach the issue of data storage in collections.  Very often, Set is used where the list can be dispensed with, and the list is where the array can be dispensed with.  For example, in classes that are mapped on database tables.  Avoid this, build the right dependencies and correct queries.  This will allow you to save some memory, because it is not a secret to anyone that HashSet is implemented on a HashMap, and HashMap in turn uses the internal class Entry, which in addition to the key and value also stores the hash and a link to the next Entry object.  In addition, the hash is constantly calculated as it is added, which can be expensive for complex objects. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  Data reading </h6><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// byte[] fileBinaryData = readFile(filepath); // InputStream fileStream = readFile(filepath);</span></span></code> </pre><br>  What is wrong with these innocent lines?  Yes, in general, nothing, except for the fact that we do not know the size of the file that we read.  Instead of a file, there can be anything ‚Äî an open socket that accepts data, data from a post request, everything ... In general, try not to read everything into an array of bytes, you simply may not have enough memory.  Therefore, be careful with the size of any data.  Try to process and forward the data in parts.  And always keep track of the size of user data and, if possible, limit it. <br><br><h6>  Log field </h6><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// private Logger logger = Logger.getLogger(Plan.class); // private static final Logger logger = Logger.getLogger(Plan.class);</span></span></code> </pre><br>  Using log in class?  Always define the log variable as static final.  First: you will never have problems when trying to serialize and deserialize an object.  Secondly: initialization occurs only 1 time, instead of constant initialization when creating objects of a class. <br><br><h6>  Fields initialization </h6><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// class Plan { private String name = null; private Boolean isNew = false; private Set&lt;Document&gt; documents = new HashSet&lt;Document&gt;(); } // class Plan { private String name; private Boolean isNew; private Set&lt;Document&gt; documents; }</span></span></code> </pre><br>  Try not to initialize the class fields prematurely, except when you are very confident about this.  Still, for these purposes you have a constructor.  In case of explicitly specifying values ‚Äã‚Äãfor class fields, they will be initialized before calling the constructor, which incurs additional costs in cases where you do not need to use initialized values, for example, when you immediately set up other values ‚Äã‚Äãfor initialized fields after creating the object.  Well, do not forget that the class fields are always initialized with default values. <br><br><h6>  Empty String </h6><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// if (name.equals("")) { // if (name.isEmpty()) {</span></span></code> </pre><br>  If you need to check if a string contains an empty value, use the isEmpty () method.  Why not equals ()?  It is corny slower.  If you look at its implementation for the string, you will immediately understand everything.  Do not be surprised, many developers still do not know about this method. <br><br><h6>  Object [] vs custom Class </h6><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Object[] data = new Object[3]; data[0] = row.getUserCount(); data[1] = row.getOwnerCount(); data[2] = row.getLocations(); return data; // RowResult data = new RowResult(); data.setUserCount(row.getUserCount()); data.setOwnerCount(row.getOwnerCount()); data.setLocations(row.getLocations()); return data;</span></span></code> </pre><br>  The code with Object is completely unreadable when you have to work with the return value in another place.  Ie, in order to understand what the return value holds in itself, you need to return to the call class and read the comments to the method, if, of course, they exist, and if you don‚Äôt have a good look at the code, that is not very effective.  Actually, I myself sometimes sin when I am in a hurry.  This can be reconciled if it is very rare, but, nevertheless, in such situations it is better to create a new class.  Make life easier for those who come after you. <br><br><h6>  Anonymous Classes </h6><br>  Anonymous classes are a great feature, but don't push them into all places of your application just because it will save you a minute of time.  The code with anonymous classes is read much more difficult and difficult for perception.  It is better, of course, to make it into separate classes, except when an anonymous class is very appropriate. <br><br><h6>  Comparison order </h6><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// if (name.equals("broadcast")) { // if ("broadcast".equals(name)) {</span></span></code> </pre><br>  This method allows you to get rid of unnecessary null checks.  But if you follow the rules from the first article, then there is no need for this method. <br><br><h6>  findings </h6><br>  Yes, much of what is written is more obvious than the obvious.  But if so, where does all this come from project to project?  This article is by no means a guide to improving the performance of your application.  This is just a good, correct style.  Hope this helps you. </div><p>Source: <a href="https://habr.com/ru/post/132374/">https://habr.com/ru/post/132374/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132364/index.html">MatLab and OOP optimization</a></li>
<li><a href="../132366/index.html">Approximate solution of algebraic and transcendental equations</a></li>
<li><a href="../132369/index.html">Simple HotSpot on FreeBSD</a></li>
<li><a href="../132370/index.html">Knowledge management in IT companies, is it necessary?</a></li>
<li><a href="../132372/index.html">The idea of ‚Äã‚Äãimplementing an I / O package in Java</a></li>
<li><a href="../132375/index.html">Let's design the UI elements correctly.</a></li>
<li><a href="../132376/index.html">vcprompt or sugar for the console</a></li>
<li><a href="../132377/index.html">CiEx will tell you which movie to watch - part 2</a></li>
<li><a href="../132378/index.html">Are you arrested? There is an Android application for this.</a></li>
<li><a href="../132379/index.html">Resolving authorization issues in phpBB 3.0.X forums via Loginza</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>