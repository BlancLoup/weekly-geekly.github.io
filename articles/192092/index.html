<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AndEngine GLES2 - Live Wallpaper</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last winter (most likely on a sunny day :) I became interested in the AndEngine graphic library, because I wanted to work with two-dimensional graphic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AndEngine GLES2 - Live Wallpaper</h1><div class="post__text post__text-html js-mediator-article">  Last winter (most likely on a sunny day :) I became interested in the AndEngine graphic library, because I wanted to work with two-dimensional graphics on my mobile phone (using OpenGL), and this solution seemed to me the most interesting and accessible.  Having made several graphic applications, I decided to create live wallpapers, all the more so in the delivery with AndEngine there is a special library for creating those.  Now I will share my experience in creating live wallpapers with you. <br>  Especially for this, I prepared a <a href="">project</a> (has abundant comments), a ‚Äútemplate‚Äù for showing the principle of live wallpaper. <br><img src="https://habrastorage.org/storage3/710/363/745/710363745f839776cddb0869efb022ff.png" alt="image"><br><a name="habracut"></a><br><br>  <b>Training</b> <br>  First of all, you need to install AndEngine itself and, in particular, the AndEngineLiveWallpaperExtension library (I recommend to immediately install all available libraries) since it will be the base.  Since this article is not a base for studying AndEngine, I will not tell you how to install libraries, especially since you can easily find this information, for example, here - <a href="http://www.matim-dev.com/how-to-setup-andengine.html">http://www.matim-dev.com/how-to-setup-andengine .html</a> .  Now you need to open the attached project and run it.  If it does not start right away, then most likely you need to check the connected libraries to the project.  In the end, you should have something like this - <a href="http://youtu.be/HRKzBma9vz0">http://youtu.be/HRKzBma9vz0</a> <br><br>  <b>Functional</b> <br>  And now briefly and in order (most of the functionality also applies to all other AndEngine GLES2 applications).  The ancestor of the main class of the project is BaseLiveWallpaperService, this is the class that is responsible for all the work with GLES2.  The following functions are required for overriding: <br><pre><code class="java hljs">onSurfaceChanged onCreateEngineOptions onCreateResources onCreateScene</code> </pre> <br>  <i>public void onSurfaceChanged (final GLState pGLState, final int pWidth, final int pHeight)</i> is a function for determining the screen size and installing the camera. <br>  <i>public EngineOptions onCreateEngineOptions ()</i> is the function for setting the live wallpaper engine.  This function returns the selected parameters to the system for setting up GLES2. <br>  <i>public void onCreateResources (OnCreateResourcesCallback pOnCreateResourcesCallback)</i> - as the name implies, this function is designed to create all (media) resources that will participate in the application. <br>  <i>public void onCreateScene (OnCreateSceneCallback pOnCreateSceneCallback)</i> is the function of creating a scene and placing all the desired objects on it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Download testures</b> <br>  Loading texture occurs in three stages: the definition of the atlas;  texture definition;  texture loading into satin  Consider them on the example of loading the background: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mOnScreenControlTexture0 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BitmapTextureAtlas(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getTextureManager(), <span class="hljs-number"><span class="hljs-number">1930</span></span>, <span class="hljs-number"><span class="hljs-number">1050</span></span>, TextureOptions.BILINEAR_PREMULTIPLYALPHA); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bg_TextureRegion = BitmapTextureAtlasTextureRegionFactory.createFromAsset(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mOnScreenControlTexture0,<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>,<span class="hljs-string"><span class="hljs-string">"gfx/bg.jpg"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getEngine().getTextureManager().loadTexture(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mOnScreenControlTexture0);</code> </pre><br>  The first line defines the size for the texture atlas.  It is necessary to determine in advance which textures and in what order they will be located on this atlas and calculate its size.  If it is wrong to calculate the position of the textures in the atlas or to make it smaller than the required size, then the program will not work correctly.  In our case, only one image (sprite) will be located in the atlas and therefore the size of the atlas will be the same size as the image. <br>  If you want to load two pictures (sprite) and more, then the size of the atlas will have to be calculated.  For example: We want to load two pictures with the size of 60 * 60 and 80 * 75 pixels.  To find the width of the atlas, we add the width of the first and second pictures, we get 140. At the same time, the height of the atlas should be leveled by the largest of these pictures.  If necessary, the layout of the atlas can be of any complexity, everything is limited only by the imagination of the programmer and the maximum size (2048 * 2048). <br><img src="https://habrastorage.org/storage3/3e0/24a/aec/3e024aaec43a50c7fe876c97473df3c8.png" alt="image"><br>  The second line defines the object through which in the future you can get the texture of interest.  The constructor arguments are as follows: atlas for storing textures;  context;  texture location;  X coordinate starting from which the texture is located;  Y coordinate, starting from which the texture is located.  All textures should be stored in the ‚Äúgfx‚Äù park ( <i>project / assets / gfx</i> ). <br>  The third line contains the loader itself, with which the entire graphic is loaded into the atlas. <br><br>  <b>Scene creation</b> <br>  The scene is created in just one line - mScene = new Scene (), then the most interesting thing happens - the placement of all the necessary objects on the stage.  The main building unit of all applications built using AndEngine are sprites (since the library works exclusively with two-dimensional objects).  Consider an example of creating a simple sprite: <br><pre> <code class="java hljs">bg = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Sprite(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bg_TextureRegion, getVertexBufferObjectManager()); bg.setSize(bg.getWidth() * <span class="hljs-number"><span class="hljs-number">2</span></span>, bg.getHeight() * <span class="hljs-number"><span class="hljs-number">2</span></span>); bg.setPosition(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>); mScene.attachChild(bg);</code> </pre><br>  The first line creates a sprite.  The constructor has the following arguments: position on the stage along the X axis;  position on the stage along the Y axis;  texture object;  buffer manager.  The second line overrides the size of the sprite, by default it is equal to the size of the texture.  The third line overrides the position of the sprite on the screen.  In the fourth line, the sprite is directly added to the screen. <br>  If you look at the code for the attached example, you will notice that the Sun class is defined in it.  It is a descendant of the Sprite class.  This class contains the logic of the animation of an object, which is to rotate an object relative to its center. <br>  Also defined class LiveWallpapperSettings, which is responsible for setting the live wallpaper.  Since this is a fairly standard thing, I will not describe the logic of the settings (you can easily find the information of interest in Yandex or in other search engines). <br><br>  <b>Conclusion</b> <br>  The library is very easy to use and functional.  Its main drawback is the freezing mechanism, which is triggered when wallpaper is hidden and does not always turn off when you continue to display it.  This minus is clearly seen when the wallpapers have a relatively large number of sprites on the scene (like for example here <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.livewallpaper.summermeado_wfull">https://play.google.com/store/apps/details?id=com.livewallpaper.summermeado_wfull</a> ).  If someone solved the problem with freezing, please share the solution. <br>  I deliberately did not inflate the example and add the maximum amount of functionality to show that Android graphics applications are quick and easy. <br>  Have a good test! <br><br>  Live Wallpaper Project - <a href="">http://www.anprog.com/documents/AE_gles2_LiveWallpaper.zip</a> </div><p>Source: <a href="https://habr.com/ru/post/192092/">https://habr.com/ru/post/192092/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../192078/index.html">Computer History Museum</a></li>
<li><a href="../192080/index.html">Roskomnadzor began active actions against telecom operators not blocking prohibited sites</a></li>
<li><a href="../192082/index.html">9 most important facts about mobile advertising</a></li>
<li><a href="../192084/index.html">Convenient file synchronization</a></li>
<li><a href="../192090/index.html">Core Data for iOS. Chapter number 2. Practical part</a></li>
<li><a href="../192094/index.html">Google has substantiated its plan for the planetary Internet Loon in terms of the distribution of balloons in the stratosphere</a></li>
<li><a href="../192098/index.html">Python. Non-obvious behavior of some constructions</a></li>
<li><a href="../192100/index.html">Developer iOS Notes: Sharing Experience, Part 2</a></li>
<li><a href="../192102/index.html">Sudoku generation algorithm</a></li>
<li><a href="../192106/index.html">Overview of network storage Fantec CL-35B2 RAID</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>