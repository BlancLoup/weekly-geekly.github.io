<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>C #, ways to store program settings</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 There are many ways to store the program settings on the Internet, but they are somehow scattered, so I decided to put them together an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>C #, ways to store program settings</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  There are many ways to store the program settings on the Internet, but they are somehow scattered, so I decided to put them together and describe how to use it. <br><br><h4>  C # and app.config </h4><br>  On Habr√© has already been devoted to this topic, so ... <a href="https://habrahabr.ru/post/128517/">go</a> <br><br><h4>  C # and Properties.Settings </h4><br>  <b>Information on Properties.Settings</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The Properties.Settings organization is a regular xml file that can be found in the user‚Äôs folder: <br><br>  C: \ Users \ [user name] \ AppData \ Local \ [(Project Name) or (AssemblyCompany)] \ [name project_cashBuild] \ [AssemblyVersion] \ user.config <br><br>  First of all, we need to create such variables for Properties.Settings.  Go to Properties -&gt; Settings.settings: <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Properties -&gt; Settings.settings in VS 2013</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/1ad/9ac/439/1ad9ac439429478780ad37746b82b886.png"><br></div></div><br>  I created 3rd variables and chose the area of ‚Äã‚Äãtheir use: 2- user area and 1-application. <br><br>  <i>The distinction between areas is simple.</i>  <i>The application area can only be read, and the user can change and read.</i> <br><habracut><br>  <i><u>Let's return to variables:</u></i> <br><br><ul><li>  Version - the version of our program.  The application defined it with a string and a region.  Since  the version may contain letters (for example, b - from beta).  And the region has chosen, so that our version of the application does not change (since AssemblyVersion is rarely used). </li><li>  Save_text is a variable where we will save our text. </li><li>  open_sum - how many times we opened the program. </li></ul><br>  <b>Now let's go to the code</b> <br><br><div class="spoiler">  <b class="spoiler_title">Form1.cs Code</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Habrahabr</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Form1</span></span> : <span class="hljs-title"><span class="hljs-title">Form</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Form1</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { InitializeComponent(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Text += <span class="hljs-string"><span class="hljs-string">" "</span></span> + Properties.Settings.Default.Version; <span class="hljs-comment"><span class="hljs-comment">//   , . Properties.Settings.Default.open_sum++; // +1  -  . label2.Text = Properties.Settings.Default.open_sum.ToString(); //  Label2 -  . richTextBox1.Text = Properties.Settings.Default.Save_text; //     Properties.Settings.Default.Save(); //  . } private void button1_Click(object sender, EventArgs e) { Properties.Settings.Default.Save_text = richTextBox1.Text; //   richTextBox1  Save_text Properties.Settings.Default.Save(); //  . MessageBox.Show(" ", "", MessageBoxButtons.OK, MessageBoxIcon.Asterisk); //  ,   . } } }</span></span></code> </pre> <br></div></div><br>  <b>The results of the program</b> <br><br>  The first launch, we see that the number of launches is 1. And there is no test in richTextBox1. <br><br><img src="https://habrastorage.org/files/cc5/d45/5e0/cc5d455e04a7428385c6b545ca2ecc96.png"><br><br>  Now we will write and save the text. <br><br><img src="https://habrastorage.org/files/08d/44c/be0/08d44cbe0f524acf836eec0cfbedb2ee.png"><br><br>  At the second launch, we see that the text is saved, and the number of launches is already 2-va. <br><br><img src="https://habrastorage.org/files/a82/cf1/095/a82cf10953ce46f8a2f71d4b4a967fb0.png"><br><br>  <b>Conclusion</b> <br><br>  It is very convenient to use this object if you need to work in different areas of visibility in one project.  The method is good when you don‚Äôt need an ordinary user to search through the program‚Äôs configuration files. <br><br><h4>  C # and ini files </h4><br>  With ini-files all the way around, they are in the folder next to the program, which allows the user to change the settings of the off-program.  This method is good if the program settings are entered manually.  For example, an emulator for launching a game without a license (revLoader). <br><br>  We now turn to our topic.  To work with this type of file, we need to create a class for working with it.  Create a class, for example, "IniFile", connect the namespace, which is not: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Reflection; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Runtime.InteropServices; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text;</code> </pre><br>  And now we analyze in order: <br><br><div class="spoiler">  <b class="spoiler_title">IniFiles.cs code</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Reflection; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Runtime.InteropServices; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">IniFiles</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">IniFile</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Path; <span class="hljs-comment"><span class="hljs-comment">// . [DllImport("kernel32")] //  kernel32.dll     WritePrivateProfilesString static extern long WritePrivateProfileString(string Section, string Key, string Value, string FilePath); [DllImport("kernel32")] //    kernel32.dll,     GetPrivateProfileString static extern int GetPrivateProfileString(string Section, string Key, string Default, StringBuilder RetVal, int Size, string FilePath); //          . public IniFile(string IniPath) { Path = new FileInfo(IniPath).FullName.ToString(); } // ini-        . public string ReadINI(string Section, string Key) { var RetVal = new StringBuilder(255); GetPrivateProfileString(Section, Key, "", RetVal, 255, Path); return RetVal.ToString(); } //  ini-.        . public void Write(string Section, string Key, string Value) { WritePrivateProfileString(Section, Key, Value, Path); } //    . public void DeleteKey(string Key, string Section = null) { Write(Section, Key, null); } //   public void DeleteSection(string Section = null) { Write(Section, null, null); } //,    ,    public bool KeyExists(string Key, string Section = null) { return ReadINI(Section, Key).Length &gt; 0; } } }</span></span></code> </pre><br></div></div><br>  Now go to the main program. <br><br><div class="spoiler">  <b class="spoiler_title">Form1.cs Code</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Data; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Drawing; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Windows.Forms; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">IniFiles</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Form1</span></span> : <span class="hljs-title"><span class="hljs-title">Form</span></span> { IniFile INI = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IniFile(<span class="hljs-string"><span class="hljs-string">"config.ini"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Form1</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { InitializeComponent(); auto_read(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">auto_read</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (INI.KeyExistsINI(<span class="hljs-string"><span class="hljs-string">"SettingForm1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Width"</span></span>)) numericUpDown2.Value = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.Parse(INI.ReadINI(<span class="hljs-string"><span class="hljs-string">"SettingForm1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Height"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> numericUpDown1.Value = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.MinimumSize.Height; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (INI.KeyExistsINI(<span class="hljs-string"><span class="hljs-string">"SettingForm1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Height"</span></span>)) numericUpDown1.Value = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.Parse(INI.ReadINI(<span class="hljs-string"><span class="hljs-string">"SettingForm1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Width"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> numericUpDown2.Value = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.MinimumSize.Width; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (INI.KeyExistsINI(<span class="hljs-string"><span class="hljs-string">"SettingForm1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Width"</span></span>)) textBox1.Text = INI.ReadINI(<span class="hljs-string"><span class="hljs-string">"Other"</span></span>, <span class="hljs-string"><span class="hljs-string">"Text"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Height = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.Parse(numericUpDown1.Value.ToString()); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Width = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.Parse(numericUpDown2.Value.ToString()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">button1_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { INI.WriteINI(<span class="hljs-string"><span class="hljs-string">"SettingForm1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Height"</span></span>, numericUpDown2.Value.ToString()); INI.WriteINI(<span class="hljs-string"><span class="hljs-string">"SettingForm1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Width"</span></span>, numericUpDown1.Value.ToString()); INI.WriteINI(<span class="hljs-string"><span class="hljs-string">"Other"</span></span>, <span class="hljs-string"><span class="hljs-string">"Text"</span></span>, textBox1.Text); MessageBox.Show(<span class="hljs-string"><span class="hljs-string">" SettingForm1  Other "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, MessageBoxButtons.OK, MessageBoxIcon.Asterisk); <span class="hljs-comment"><span class="hljs-comment">//  ,   . } private void button2_Click(object sender, EventArgs e) { auto_read(); //   . } private void button3_Click(object sender, EventArgs e) { INI.WriteINI("SettingForm1", "Height", numericUpDown2.Value.ToString()); INI.WriteINI("SettingForm1", "Width", numericUpDown1.Value.ToString()); this.Height = int.Parse(numericUpDown1.Value.ToString()); this.Width = int.Parse(numericUpDown2.Value.ToString()); MessageBox.Show(" SettingForm1   ", "", MessageBoxButtons.OK, MessageBoxIcon.Asterisk); //  ,   . } } }</span></span></code> </pre><br></div></div><br>  <b>The results of the program</b> <br><br>  When you first start, we do not have a config.ini file.  Therefore, when checking, the fasle returns and we equate the window with the minimum parameters. <br><br><img src="https://habrastorage.org/files/d6d/1b9/ffc/d6d1b9ffc73a4942a647c4731014bdab.PNG"><br><br>  Change the window settings and click "Apply" <br><br><img src="https://habrastorage.org/files/e9f/491/e94/e9f491e9461c409e87f6c6e7f829132f.PNG"><br><br>  Edit the config.ini file by hand and click download. <br><br><img src="https://habrastorage.org/files/353/0a9/3f4/3530a93f4efb48fca63bfc13da41f9da.PNG"><br><br>  That's all, next time I will describe the work with xml files and binary files. </habracut></div><p>Source: <a href="https://habr.com/ru/post/271483/">https://habr.com/ru/post/271483/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271471/index.html">The rise of Node.js - and why it will lead in the development of corporate software</a></li>
<li><a href="../271475/index.html">Parallel parsing of a large number of HTML pages using Apache Ignite (GridGain) in 200 lines of code</a></li>
<li><a href="../271477/index.html">Cooking ASP.NET 5: Continuous Deployment with Docker and Tutum</a></li>
<li><a href="../271479/index.html">Rabdological abacus Claude Perrot</a></li>
<li><a href="../271481/index.html">Domestic server manufacturer = self-assembly?</a></li>
<li><a href="../271485/index.html">A way to quickly measure the performance of a random server</a></li>
<li><a href="../271487/index.html">Under the hood Redis: Strings</a></li>
<li><a href="../271489/index.html">How do we live a year without sprockets and with react</a></li>
<li><a href="../271491/index.html">Free Webinars at Startup Week - Connect</a></li>
<li><a href="../271493/index.html">Infrastructure and trading robots: What programming languages ‚Äã‚Äãare used in finance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>