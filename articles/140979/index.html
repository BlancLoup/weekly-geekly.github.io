<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Library for registering and catching hotkeys</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A combination of keys means any number of keys pressed simultaneously, pressed in any order that your keyboard can allow. For the end user, however, d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Library for registering and catching hotkeys</h1><div class="post__text post__text-html js-mediator-article">  A combination of keys means any number of keys pressed simultaneously, pressed in any order that your keyboard can allow.  For the end user, however, do not exceed the number of more than five in one combination, because  Not everyone has gaming keyboards. <br><br><h5>  Usage example </h5><br><pre><code class="cs hljs">HotKeysManager manager = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HotKeysManager(); manager.AddHotKey(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HotKeyCombination(() =&gt; { MessageBox.Show(<span class="hljs-string"><span class="hljs-string">", !"</span></span>); }) { Keys.LControlKey, Keys.H });</code> </pre> <br>  Another option to add, where the current keystrokes are taken as a combination, is convenient in the case when the user assigns a combination himself.  In the demo there is an example of a similar recording of combinations. <br><pre> <code class="cs hljs">manager.AddHotKey(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HotKeyCombination(HookManager.CurrentDownedKeys.ToArray(), () =&gt; { MessageBox.Show(<span class="hljs-string"><span class="hljs-string">", !"</span></span>); }));</code> </pre><br><br>  Now when you press the LeftCtrl + H (or H + LeftControl) combination, we will see a welcome message. <br><a name="habracut"></a><br><h5>  As done </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Three WinAPI functions are used to intercept clicks globally: <br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">       </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)] private static extern int CallNextHookEx(int idHook, int nCode, int wParam, IntPtr lParam); </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">      </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall, SetLastError = true)] private static extern int SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hMod, int dwThreadId); </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">     </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall, SetLastError = true)] private static extern int UnhookWindowsHookEx(int idHook);</span></span></code> </pre><br><br>  When an event is received, it is checked whether the key was pressed or released, and a list of currently pressed keys is formed, after which a check of the combinations is called, and if there is a match an alert is sent. <br><br>  Interception of clicks automatically turns on / off depending on the presence of combinations. <br><br><h5>  Functional </h5><br><h6>  Class HotKeysManager </h6><br>  Methods: <br><ul><li>  <b>EnableHotKeys</b> / <b>DisableHotKeys</b> - manual enable disabling key combinations checking </li><li>  <b>AddHotKey (string, HotKeyCombination)</b> - add a key combination to the collection, with the key indicated </li><li>  <b>AddHotKey (HotKeyCombination)</b> - adding a key combination with automatic key generation (the key will be generated as Key1 + Key2 + ... + Keyn) </li><li>  <b>RemoveHotKey (string)</b> - delete a combination with the key in the collection </li><li>  <b>RemoveHotKey (HotKeyCombination)</b> - removal of a combination, the key will be generated automatically (Key1 + Key2 + ... + Keyn), if there is no combination with such a key, an exception will not be thrown </li></ul><br><br>  Developments: <br><ul><li>  <b>NewCombination</b> - notifies of the appearance of a new combination, a delegate of the form (string) {} is used, where Key1 + Key2 + ... + Keyn is passed as a parameter </li></ul><br><br><h6>  HookManager class (static class) </h6><br><br>  Properties: <br><ul><li>  <b>CurrentDownedKeys</b> - list of keystrokes (List &lt;Keys&gt;) </li><li>  <b>CurrentDownedKeysDescription</b> - a string with a description of the keys pressed (Key1 + Key2 + ... + Keyn) </li></ul><br><br>  Developments: <br><ul><li>  <b>ChangeKeyState</b> - notifies about changing the set of keystrokes, the delegate without parameters </li></ul><br><br>  <a href="http://rghost.ru/37290809">Download (source + bin_x86)</a> <br><br>  When using, it is worth remembering that perekhat is global, and if you want to keep the action only with the active window of your program, you need to enter an additional check. </div><p>Source: <a href="https://habr.com/ru/post/140979/">https://habr.com/ru/post/140979/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140971/index.html">We will help the person to compare pictures, or about Testing Localization of the application</a></li>
<li><a href="../140973/index.html">Top Favorite Media Articles - Editor's Choice in Google News</a></li>
<li><a href="../140974/index.html">Getting photos from android-smartphone right in html form</a></li>
<li><a href="../140976/index.html">Google has released the final version of the programming language Go 1</a></li>
<li><a href="../140977/index.html">Installing a lightpack on a laptop</a></li>
<li><a href="../140980/index.html">Is there life without AdBlock: do you have a banner cutter?</a></li>
<li><a href="../140981/index.html">Dojo, JSONP and all-all-all</a></li>
<li><a href="../140982/index.html">The best applications - free promotion!</a></li>
<li><a href="../140983/index.html">The world's largest CDN is ready to enable IPv6</a></li>
<li><a href="../140984/index.html">Two-week joint tests of Tele2 and Scientific Research Institute of LTE and GSM collaboration in Omsk and Pskov ended successfully</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>