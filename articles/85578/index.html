<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The Dark Side of Ruby, Proc and Lambda</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many people like Ruby for its beauty and flexibility. But some do not realize the dark side of the Ruby language. Today we will examine one of the dar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The Dark Side of Ruby, Proc and Lambda</h1><div class="post__text post__text-html js-mediator-article"> Many people like Ruby for its beauty and flexibility.  But some do not realize the dark side of the Ruby language.  Today we will examine one of the dark horses of the Ruby, many use it, but not many know its secret.  So, the topic of the day blocks! <br><a name="habracut"></a><br>  Blocks in ruby ‚Äã‚Äãare used almost everywhere, often they replace methods.  But, there are significant differences between the method and the block. <br><br>  The first difference: <br>  Blocks see variables declared in the block scope, but methods do not. <br><br>  Example using blocks: <br> <code>hello = "Hello World" <br> l = lambda {puts hello} <br> l.call #=&gt; Hello World =&gt; nil <br></code> <br>  Example using the method: <br> <code>def say_hello <br> puts hello <br> end <br> hello = "Hello World" <br> say_hello #=&gt; NameError: undefined local variable or method `hello' <br></code> <br>  As you can see, the method does not see the variable until you pass it as an argument. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The second difference: <br>  Sensitivity of methods and blocks to accepted arguments.  Methods are very sensitive to arguments, you can pass only the number of arguments that are described in the method.  Otherwise, you will get an error instead of a result. <br>  With blocks, the problem is simpler and more difficult at the same time, in Ruby there are two types of blocks, Proc.new {} and lambda {}, each of them reacts differently to the arguments. <br><br> <code>p = Proc.new { |i, k| [i, k] } <br> l = lambda { |i, k| [i, k] } <br> <br> p.call("hello", "world") # =&gt; ["hello","world"] <br> p.call("hello") # =&gt; ["hello, nil] <br> p.call # =&gt; [nil, nil] <br> p.call("hello", "world", "bye") # =&gt; ["hello", "world"] <br> <br> l.call("hello", "world") # =&gt; ["hello", "world"] <br> l.call("hello") # ArgumentError: wrong number of arguments (1 for 2) <br> l.call # ArgumentError: wrong number of arguments (0 for 2) <br> l.call("hello", "world", "bye") # ArgumentError: wrong number of arguments (3 for 2)</code> <br> <br>  Vrodeba is understandable, even if such a difference annoys a bit (it would seem the same block), you can get used to it, but these are just flowers!  :) <br>  In the previous example, we considered blocks that can have 2 or more arguments.  Logically, nothing should change if there is 1 or no arguments at all.  But since life is complicated and dishonest, so Ruby has his own view on logic. <br><br> <code>p = Proc.new { |i| i } <br> l = lambda { |i| i } <br> <br> p.call("hello") # =&gt; "hello" <br> p.call("hello", "world") # =&gt; ["hello", "world"] # warning: multiple values for a block parameter (2 for 1) <br> p.call # =&gt; nil # warning: multiple values for a block parameter (0 for 1) <br> <br> l.call("hello") # =&gt; "hello" <br> l.call("hello", "world") # =&gt; ["hello", "world"] # warning: multiple values for a block parameter (2 for 1) <br> l.call # =&gt; nil # warning: multiple values for a block parameter (0 for 1)</code> <br> <br>  How do you like this unusual turn of events?  From the previous example, the novice realized that there were 2 different blocks, and both of them react differently to the arguments, but after this example everything turned upside down, now, instead of an error, the novice received a warning.  Any person who has just started to learn this part of the language will get the brain loaded and freeze.  But Matz and here does not relax our brains.  Go ahead: <br><br> <code>p = Proc.new { puts " " } <br> l = lambda { puts " " } <br> <br> p.call # =&gt; nil <br> p.call("hello") # =&gt; nil <br> <br> l.call # =&gt; nil <br> l.call("hello") # =&gt; nil</code> <br> <br>  The final touch in breaking all patterns and rules of logic.  NLP trainings teach how to break a pattern to gain access to a person‚Äôs subconscious, this is one such example.  In the absence of arguments, both types of blocks react in the same way. <br><br>  You can sum up a little bit.  There are 2 types of work with arguments in Ruby - strict and indefinite (strict &amp; loose).  Methods always work on the principle of strict arguments, Proc blocks work on the principle of undefined arguments, but lambda blocks work in strict mode if there are more than 2 arguments and in indefinite mode if there are no arguments or there is one single argument. <br><br>  There is another difference between lambda and proc blocks.  This difference lies in return. <br>  lambda blocks simply return the result from the block, for example: <br><br> <code>def max_element <br> l = lambda { return [1,2,3,4] } <br> array = l.call <br> return array.max <br> end <br> max_element # =&gt; 4</code> <br> <br>  And Proc works a little differently, instead of simply returning the result from the block, Proc returns the result in its declared zone, for example: <br><br> <code>def max_element <br> p = Proc.new { return [1,2,3,4] } <br> array = p.call <br> return array.max #   Proc <br> end <br> max_element # =&gt; [1,2,3,4]</code> <br> <br>  As you can see, it never came to return array.max, since the p block caused return to this. <br>  Ruby is a wonderful language, which provides great opportunities for creativity, but it has its own dark sides that you need to know :) </div><p>Source: <a href="https://habr.com/ru/post/85578/">https://habr.com/ru/post/85578/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../85567/index.html">Free last.fm radio "Freelast radio"</a></li>
<li><a href="../85568/index.html">FineReader 10 released!</a></li>
<li><a href="../85569/index.html">Firefox and arbitrary selection of columns in tables</a></li>
<li><a href="../85576/index.html">Sort images by resolution ... on PowerShell scene</a></li>
<li><a href="../85577/index.html">PHP - framework with plugin support in 5 minutes</a></li>
<li><a href="../85579/index.html">Update news for HTC Hero on Android 2.1</a></li>
<li><a href="../85581/index.html">Yandex and Google home page widgets</a></li>
<li><a href="../85584/index.html">Yandex Tour</a></li>
<li><a href="../85586/index.html">Men choose Android</a></li>
<li><a href="../85587/index.html">I am looking for those who want to participate in the open source project NetEmul</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>