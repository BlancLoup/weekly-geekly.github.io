<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Localization of WPF applications on the fly</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are many ways to localize a WPF application, but it is difficult to find a method that allows you to change the labels of elements in automatic ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Localization of WPF applications on the fly</h1><div class="post__text post__text-html js-mediator-article">  There are many ways to localize a WPF application, but it is difficult to find a method that allows you to change the labels of elements in automatic mode without the need to close and reopen the form or completely restart the application.  In this publication, I will talk about how to localize the WPF application, which allows you to change the application culture without restarting the application and forms.  This solution requires the use of ResourceDictionary (XAML) for translating the interface (UI), and for localizing messages from code you can use resource files (RESX), which are conveniently used in the code and for editing which there is a plugin with a convenient editor ( <a href="https://resxresourcemanager.codeplex.com/">ResX Resource Manager</a> ). <br><a name="habracut"></a><br>  The project is written in Visaul Basic .NET, as well as in C #.  I hope this will facilitate the readability of the code for those who are not used to Visaul Basic .NET or C #. <br><br>  First, create a new WPF Application project: <br><br><img src="https://habrastorage.org/files/b3c/866/db8/b3c866db80de487aa82283523c4e26a4.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Do not forget to specify a neutral culture for the entire project.</b> <div class="spoiler_text"><ol><li>  Open the project properties. </li><li>  Go to the tab <b><i>Application</i></b> . </li><li>  Open <b><i>Assembly Information</i></b> . </li><li>  Choosing a neutral culture <br><img src="https://habrastorage.org/files/c7f/acc/52f/c7facc52f65f4f2caa31b49f998b865a.png" alt="image"></li><li>  Click OK. </li></ol></div></div><br>  Next, add the <i>resources</i> folder to the project for localization files. <br><br>  In the <i>Resources</i> folder, create a <i><b>Resource Dictionary</b></i> file <i><b>(WPF)</b></i> , call it <i>lang.xaml,</i> and add an attribute to the <b>ResourceDictionary</b> element already created that will allow you to describe values ‚Äã‚Äãwith an indication of the type: <br><br><pre><code class="xml hljs">xmlns:v="clr-namespace:System;assembly=mscorlib"</code> </pre> <br>  Now add the file to the application resources: <br><ol><li>  Open the <i>Application.xaml</i> file ( <i>App.xaml</i> for C #); </li><li>  Add a <b>ResourceDictionary</b> element to <b>Application.Resources</b> ; </li><li>  In the <b>ResourceDictionary</b> element, add the <b>ResourceDictionary.MergedDictionaries</b> element (here we will store all our ResourceDictionary); </li><li>  In the <b>ResourceDictionary.MergedDictionaries</b> element, add a <b>ResourceDictionary</b> element with a <b>Source</b> attribute that refers to the <i>lang.xaml</i> file. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Result example</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Application.Resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ResourceDictionary</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ResourceDictionary.MergedDictionaries</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ResourceDictionary</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Resources/lang.xaml"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ResourceDictionary.MergedDictionaries</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ResourceDictionary</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Application.Resources</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br>  Now we need to add localized data for the UI inside the <b>ResourceDictionary</b> element in the <i>lang.xaml</i> file: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"m_Title"</span></span></span><span class="hljs-tag">&gt;</span></span>WPF Localization example<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In this case, we put a text value (String), accessible by the key <i>m_Title</i> . <br><br><div class="spoiler">  <b class="spoiler_title">Sample application data</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"m_Title"</span></span></span><span class="hljs-tag">&gt;</span></span>WPF Localization example<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"m_lblHelloWorld"</span></span></span><span class="hljs-tag">&gt;</span></span>Hello world!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"m_menu_Language"</span></span></span><span class="hljs-tag">&gt;</span></span>Language<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:Double</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"m_Number"</span></span></span><span class="hljs-tag">&gt;</span></span>20.15<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:Double</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></div></div><br>  For other application cultures, duplicate the <i>lang.xaml</i> file in the <i>Resources</i> folder and rename it to <i>lang.</i>  <i><b>ru-RU</b> .xaml</i> , where <i><b>ru-RU</b></i> is the name of the culture ( <a href="">Culture name</a> ).  After duplication, you can translate the values.  It is advisable to do this after adding all the values ‚Äã‚Äãto the <i>lang.xaml</i> resource <i>file</i> . <br><br><div class="spoiler">  <b class="spoiler_title">Translated resource file into Russian culture (ru-RU)</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ResourceDictionary</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:v</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"clr-namespace:System;assembly=mscorlib"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Main window --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"m_Title"</span></span></span><span class="hljs-tag">&gt;</span></span> WPF <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"m_lblHelloWorld"</span></span></span><span class="hljs-tag">&gt;</span></span> !<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"m_menu_Language"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:String</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:Double</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"m_Number"</span></span></span><span class="hljs-tag">&gt;</span></span>10.5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v:Double</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ResourceDictionary</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></div></div><br>  Now in the <b><i>xaml</i></b> code of the window we add elements, and the text for them will be taken using dynamic resources: <br><br><img src="https://habrastorage.org/files/6ed/463/da8/6ed463da85014daf806e85985f0d22df.png"><br><br>  As you can see from the image above, Visual Studio sees the resources we created earlier. <br><br>  A note about the <b>Slider</b> element: The <b>Value</b> property is a <b>Double</b> , so you can only use a resource of the same type. <br><br><div class="spoiler">  <b class="spoiler_title">First start</b> <div class="spoiler_text">  We brought to the resources the name of the window, the name of the menu for changing the culture of the application, the text of the Label and the value of the Slider element. <br><img src="https://habrastorage.org/files/1cc/38c/8a7/1cc38c8a705f4917a74d16eb37cf1da8.png"></div></div><br>  Now let's start writing the code. <br><br>  To begin with, in the <b>Application</b> class ( <b>App</b> for C #) let us indicate which cultures our application supports: <div class="spoiler">  <b class="spoiler_title">Visual Basic .NET</b> <div class="spoiler_text"><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Application <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> Shared m_Languages As <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of CultureInfo) <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> Shared ReadOnly <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Languages As List(Of CultureInfo) <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> Return m_Languages <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>() m_Languages.Clear() m_Languages.Add(<span class="hljs-keyword"><span class="hljs-keyword">New</span></span> CultureInfo(<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>)) <span class="hljs-comment"><span class="hljs-comment">'     m_Languages.Add(New CultureInfo("ru-RU")) End Sub End Class</span></span></code> </pre></div></div><div class="spoiler">  <b class="spoiler_title">C #</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span> : <span class="hljs-title"><span class="hljs-title">Application</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> List&lt;CultureInfo&gt; m_Languages = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;CultureInfo&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> List&lt;CultureInfo&gt; Languages { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_Languages; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">App</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { m_Languages.Clear(); m_Languages.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CultureInfo(<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>)); <span class="hljs-comment"><span class="hljs-comment">//     m_Languages.Add(new CultureInfo("ru-RU")); } }</span></span></code> </pre></div></div><br>  At the application level, we implement the functionality that allows switching the culture from any window without duplicate code. <br>  We add the static Language property to the <b>Application</b> class ( <b>App</b> for C #), which will return the current culture, and changing the culture will replace the dictionary of the resources of the previous culture with a new one and cause an event that allows all windows to perform additional actions when changing culture. <br><br><div class="spoiler">  <b class="spoiler_title">Visual Basic .NET</b> <div class="spoiler_text"><pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">'      Public Shared Event LanguageChanged(sender As Object, e As EventArgs) Public Shared Property Language As CultureInfo Get Return System.Threading.Thread.CurrentThread.CurrentUICulture End Get Set(value As CultureInfo) If value Is Nothing Then Throw New ArgumentNullException("value") If value.Equals(System.Threading.Thread.CurrentThread.CurrentUICulture) Then Exit Property '1.   : System.Threading.Thread.CurrentThread.CurrentUICulture = value '2.  ResourceDictionary    Dim dict As New ResourceDictionary() Select Case value.Name Case "ru-RU" dict.Source = New Uri(String.Format("Resources/lang.{0}.xaml", value.Name), UriKind.Relative) Case Else dict.Source = New Uri("Resources/lang.xaml", UriKind.Relative) End Select '3.   ResourceDictionary       ResourceDictionary Dim oldDict As ResourceDictionary = (From d In My.Application.Resources.MergedDictionaries _ Where d.Source IsNot Nothing _ AndAlso d.Source.OriginalString.StartsWith("Resources/lang.") _ Select d).First If oldDict IsNot Nothing Then Dim ind As Integer = My.Application.Resources.MergedDictionaries.IndexOf(oldDict) My.Application.Resources.MergedDictionaries.Remove(oldDict) My.Application.Resources.MergedDictionaries.Insert(ind, dict) Else My.Application.Resources.MergedDictionaries.Add(dict) End If '4.      . RaiseEvent LanguageChanged(Application.Current, New EventArgs) End Set End Property</span></span></code> </pre></div></div><div class="spoiler">  <b class="spoiler_title">C #</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//      public static event EventHandler LanguageChanged; public static CultureInfo Language { get { return System.Threading.Thread.CurrentThread.CurrentUICulture; } set { if(value==null) throw new ArgumentNullException("value"); if(value==System.Threading.Thread.CurrentThread.CurrentUICulture) return; //1.   : System.Threading.Thread.CurrentThread.CurrentUICulture = value; //2.  ResourceDictionary    ResourceDictionary dict = new ResourceDictionary(); switch(value.Name){ case "ru-RU": dict.Source = new Uri(String.Format("Resources/lang.{0}.xaml", value.Name), UriKind.Relative); break; default: dict.Source = new Uri("Resources/lang.xaml", UriKind.Relative); break; } //3.   ResourceDictionary       ResourceDictionary ResourceDictionary oldDict = (from d in Application.Current.Resources.MergedDictionaries where d.Source != null &amp;&amp; d.Source.OriginalString.StartsWith("Resources/lang.") select d).First(); if (oldDict != null) { int ind = Application.Current.Resources.MergedDictionaries.IndexOf(oldDict); Application.Current.Resources.MergedDictionaries.Remove(oldDict); Application.Current.Resources.MergedDictionaries.Insert(ind, dict); } else { Application.Current.Resources.MergedDictionaries.Add(dict); } //4.      . LanguageChanged(Application.Current, new EventArgs()); } }</span></span></code> </pre></div></div><br>  Well, it remains to teach our window to switch the culture of the program.  When creating a new window, we‚Äôll add all the cultures supported by the application to the culture change menu, as well as add an event handler, <b>Application.LanguageChanged</b> , which we‚Äôve previously created.  We also add a handler for clicking on the ChangeLanguageClick culture change <b>point</b> , which will change the application culture and the <b>LanguageChanged</b> function for handling the <b>Application.LanguageChanged</b> event: <br><br><div class="spoiler">  <b class="spoiler_title">Visual Basic .NET</b> <div class="spoiler_text"><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> MainWindow <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>() InitializeComponent() <span class="hljs-comment"><span class="hljs-comment">'       AddHandler Application.LanguageChanged, AddressOf LanguageChanged Dim currLang = Application.Language '   : menuLanguage.Items.Clear() For Each lang In Application.Languages Dim menuLang As New MenuItem() menuLang.Header = lang.DisplayName menuLang.Tag = lang menuLang.IsChecked = lang.Equals(currLang) AddHandler menuLang.Click, AddressOf ChangeLanguageClick menuLanguage.Items.Add(menuLang) Next End Sub Private Sub LanguageChanged(sender As Object, e As EventArgs) Dim currLang = Application.Language '        For Each i As MenuItem In menuLanguage.Items Dim ci As CultureInfo = TryCast(i.Tag, CultureInfo) i.IsChecked = ci IsNot Nothing AndAlso ci.Equals(currLang) Next End Sub Private Sub ChangeLanguageClick(sender As Object, e As RoutedEventArgs) Dim mi As MenuItem = TryCast(sender, MenuItem) If mi IsNot Nothing Then Dim lang As CultureInfo = TryCast(mi.Tag, CultureInfo) If lang IsNot Nothing Then Application.Language = lang End If End If End Sub End Class</span></span></code> </pre></div></div><div class="spoiler">  <b class="spoiler_title">C #</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">WPFLocalizationCSharp</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Interaction logic for MainWindow.xaml </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public partial class MainWindow : Window { public MainWindow() { InitializeComponent(); App.LanguageChanged += LanguageChanged; CultureInfo currLang = App.Language; //   : menuLanguage.Items.Clear(); foreach (var lang in App.Languages) { MenuItem menuLang = new MenuItem(); menuLang.Header = lang.DisplayName; menuLang.Tag = lang; menuLang.IsChecked = lang.Equals(currLang); menuLang.Click += ChangeLanguageClick; menuLanguage.Items.Add(menuLang); } } private void LanguageChanged(Object sender, EventArgs e) { CultureInfo currLang = App.Language; //        foreach (MenuItem i in menuLanguage.Items) { CultureInfo ci = i.Tag as CultureInfo; i.IsChecked = ci != null &amp;&amp; ci.Equals(currLang); } } private void ChangeLanguageClick(Object sender, EventArgs e) { MenuItem mi = sender as MenuItem; if (mi != null) { CultureInfo lang = mi.Tag as CultureInfo; if (lang != null) { App.Language = lang; } } } } }</span></span></code> </pre></div></div><br>  The application is ready.  But for complete happiness, we will configure the application in such a way that it will remember our chosen culture when launching the application. <br><br>  Add the <b>DefaultLanguage</b> setting to the project, specify the <b>System.Globalization.CultureInfo</b> type (located in the <b>mscorlib</b> library), and specify the default neutral project culture: <br><br><img src="https://habrastorage.org/files/1a7/ee7/721/1a7ee77217374c828cab92d92c5944ee.png"><br><br>  We also add 2 additional functions to the <b>Application</b> class: <br><br><div class="spoiler">  <b class="spoiler_title">Visaul Basic .NET</b> <div class="spoiler_text"><pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Application_LoadCompleted(sender As Object, e As NavigationEventArgs) Handles <span class="hljs-keyword"><span class="hljs-keyword">Me</span></span>.LoadCompleted Language = My.Settings.DefaultLanguage <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> Shared <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> OnLanguageChanged(sender As Object, e As EventArgs) Handles MyClass.LanguageChanged My.Settings.DefaultLanguage = Language My.Settings.Save() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre></div></div><div class="spoiler">  <b class="spoiler_title">C #</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Application_LoadCompleted</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, System.Windows.Navigation.NavigationEventArgs e</span></span></span><span class="hljs-function">)</span></span> { Language = WPFLocalizationCSharp.Properties.Settings.Default.DefaultLanguage; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">App_LanguageChanged</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Object sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { WPFLocalizationCSharp.Properties.Settings.Default.DefaultLanguage = Language; WPFLocalizationCSharp.Properties.Settings.Default.Save(); }</code> </pre><br>  In <i>App.xaml, we</i> add a <b>LoadCompleted</b> event handler to the <b>Application</b> element: <br><br><pre> <code class="xml hljs">LoadCompleted="Application_LoadCompleted"</code> </pre> <br>  Add the <b>App.LanguageChanged</b> event handler to the <b>App</b> class constructor: <br><br><pre> <code class="cs hljs">App.LanguageChanged += App_LanguageChanged;</code> </pre> </div></div><br>  The application will now start with the culture that was selected when the application was closed. <br><br>  The whole project is posted on <a href="https://github.com/Epsil0neR/WPF-Localization">GitHub</a> . <br><br>  <b>UDP</b> : (2017.02.13) <br>  The code contains a bug with preserving culture and initializing a program with a culture that is not a default culture.  The bug has been fixed on github. </div><p>Source: <a href="https://habr.com/ru/post/256193/">https://habr.com/ru/post/256193/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../256181/index.html">Google, eBay and AliExpress will store personal data of Russians on servers in the Russian Federation</a></li>
<li><a href="../256183/index.html">Its cloud image storage in 30 minutes</a></li>
<li><a href="../256187/index.html">RAD Studio XE8 World Tour in Kazan, St. Petersburg and Tbilisi</a></li>
<li><a href="../256189/index.html">Characteristics of microservices, applications and systems</a></li>
<li><a href="../256191/index.html">Virtual memory organization</a></li>
<li><a href="../256197/index.html">Step-by-step instructions on how to implement uploading files to the server without reloading the page in PHP + Javascript</a></li>
<li><a href="../256199/index.html">Analysis of ARPD on the example of several small mobile applications and games</a></li>
<li><a href="../256201/index.html">CLRium: continue the tour of the cities. Ekaterinburg and Peter</a></li>
<li><a href="../256203/index.html">How and why do I write articles on Habrahabr. Personal experience</a></li>
<li><a href="../256207/index.html">Using LevelDB</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>