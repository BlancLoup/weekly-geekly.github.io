<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Javascript: tracking variable value changes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The issue of tracking changes to variables (or properties of objects) in javascript arises, as a rule, among developers after some time spent writing ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Javascript: tracking variable value changes</h1><div class="post__text post__text-html js-mediator-article">  The issue of tracking changes to variables (or properties of objects) in javascript arises, as a rule, among developers after some time spent writing code.  At the very moment when the question <b>‚Äúhow to do it?</b>  " <b>Is</b> replaced by the question" <b>how to do it more optimally?</b> ". <br><br>  Agree to ‚Äúbind‚Äù a property that is responsible for some dynamic value of your web application, with the DOM tree update function, or with methods that build calculations to work only with the model in the future, without thinking about subsequent necessary manipulations - not only comfortable, but also beautiful in terms of architecture. <br><br>  If you build your application on a library or framework where there is an implementation of this issue ( <b>react</b> suggests the <i>setstate</i> method, <b>vue</b> gives the user its own <i>reactivity system</i> ) then everything is clear. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      However, the methods of implementing the task in pure javascript out of the box are somewhat more complicated than the simple ones and are not always convenient to use (Object.defineProperty (), Proxy).  The super-light <b>floss-js</b> library (&lt;1kb) is designed to provide functionality for tracking property changes and calling handler methods. <a name="habracut"></a>  Working under the hood with <b>Object.defineProperty, the</b> library stores real values ‚Äã‚Äãin a separate special data store, proxying them through user-defined properties and tracking access events (returns from the store) and changes (overwrites the value in the store and calls the user-defined handler function). <br><br>  Simply put: floss-js ( <a href="https://github.com/DmitryTitov89/FLOSS">github</a> ) keeps track of the variables and properties of an object and executes custom code as they are modified. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0dc/451/a67/0dc451a679015fa2b57608e8bc82fb37.jpg" alt="image"><br><br><h2>  Installation </h2><br>  Add a library to the project is very easy. <br><br><ul><li>  You can use the npm package manager: <pre><code class="javascript hljs">npm install floss-js --save</code> </pre> </li><li>  or yarn: <pre> <code class="javascript hljs">yarn add floss-js</code> </pre> </li><li>  or just add the script to the html document: <pre> <code class="javascript hljs">&lt;script src=<span class="hljs-string"><span class="hljs-string">"FLOSS.min.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> </li></ul><br><h2>  Event creation </h2><br>  Suppose there is a small web application that implements some kind of functionality.  What exactly for us does not matter.  In the application, there is a <b>state</b> variable that contains a string indicating the current state of the application (for example: loading, expectation of the user, user writing ..., saving ..., unexpected error, etc.);  the value of a variable can change both due to data coming from the server, and due to user manipulations. <br><br>  In DOM, there is a container for displaying notifications for the user: <br><br><pre> <code class="javascript hljs">&lt;div id=<span class="hljs-string"><span class="hljs-string">"state"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br>  We have already connected FLOSS.min.js and now we need to hang the handler: when the <b>state</b> value is changed, the function that updates the DOM tree should be called. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/*      DOM */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> updateState = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'#state'</span></span>).innerHTML = state; }</code> </pre><br>  Next, hang the handler itself: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/*     FLOSS */</span></span> FLOSS({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'state'</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-string"><span class="hljs-string">'Waiting for status'</span></span>, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newState</span></span></span><span class="hljs-function">) =&gt;</span></span> { updateState(newState); } });</code> </pre><br>  Consider in more detail: <b>name</b> - the name of the variable or property, for changes that need to be monitored.  If the variable does not exist, it will be created globally, as a property of the window object.  If it is necessary to monitor the property of an object, then the object itself must also be passed to the <i>bind</i> property of the <i>FLOSS</i> function.  <b>value</b> - the default value assigned to the variable.  And finally, the <b>action</b> is a handler function, to which the new value of the variable is transferred, after the change.  The first action is triggered after the creation of the FLOSS handler.  Therefore, in this example, the updateState function will execute immediately and will display ‚ÄúWaiting for status‚Äù to the user.  If the first call to action needs to be postponed until the change of the monitored variable is changed, then you can specify an additional parameter <b>defer: true</b> . <br><br>  By implementing this example, you can set a different <b>state</b> directly in the console.  The FLOSS handler will immediately respond and call a method that updates the DOM. <br><br>  It's simple, is not it? <br><br>  Let's look at another, more complex, example of the use of a micro library. <br>  The situation is similar: it is necessary to track changes in the state of the application.  However, the state itself is now stored in a special object and the notification text is a computed property. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> server = { <span class="hljs-attr"><span class="hljs-attr">state</span></span>: { <span class="hljs-number"><span class="hljs-number">200</span></span>: <span class="hljs-string"><span class="hljs-string">'OK'</span></span>, <span class="hljs-number"><span class="hljs-number">201</span></span>: <span class="hljs-string"><span class="hljs-string">'Created'</span></span>, <span class="hljs-number"><span class="hljs-number">203</span></span>: <span class="hljs-string"><span class="hljs-string">'Non-Authoritative Information'</span></span>, <span class="hljs-number"><span class="hljs-number">526</span></span>: <span class="hljs-string"><span class="hljs-string">'Invalid SSL Certificate'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">logs</span></span>: <span class="hljs-string"><span class="hljs-string">'...'</span></span>, <span class="hljs-attr"><span class="hljs-attr">status</span></span>: <span class="hljs-string"><span class="hljs-string">'200'</span></span>, <span class="hljs-attr"><span class="hljs-attr">notification</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.state[</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.status]}</span></span></span><span class="hljs-string">, status: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.status}</span></span></span><span class="hljs-string">`</span></span> } }</code> </pre><br>  We are interested in the <b>notificaion</b> property.  However, it is a function that generates a notification for the user.  Accordingly, we will track the <b>status</b> property. <br><br><pre> <code class="javascript hljs">FLOSS({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: server.status, <span class="hljs-comment"><span class="hljs-comment">/*  value     */</span></span> action: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ updateState(server.notification()); }, <span class="hljs-attr"><span class="hljs-attr">defer</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">bind</span></span>: server <span class="hljs-comment"><span class="hljs-comment">/* ,     */</span></span> });</code> </pre><br>  Naturally, the use of state-tracking variable methods is not always advisable.  Often there is no need for this technique, and if there is, then you can always implement your own narrowly focused method, which accepts a new value as input, mutates the necessary property, and also handlers that call all the necessary functions.  However, if your child balances between a small application and an application that requires a foundation like REACT - with <b>FLOSS,</b> you can make the code more minimalistic and structured. <br><br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/418949/">https://habr.com/ru/post/418949/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../418935/index.html">DZ Online Tech: ABBYY. How not to get lost in neural networks?</a></li>
<li><a href="../418937/index.html">Celebrating the 8th anniversary of the first release at GeekUniversity</a></li>
<li><a href="../418941/index.html">Do not be afraid of microservice: Alexey Baitov on the use of microservice architecture in practice</a></li>
<li><a href="../418943/index.html">Singing computer, cyborgs and music of the waves - we discuss unusual sounds and audio gadgets</a></li>
<li><a href="../418945/index.html">Best ICO August 2018 (Voting)</a></li>
<li><a href="../418951/index.html">UE4 | Inventory for Multiplayer # 2 | Connect Blueprint to C ++</a></li>
<li><a href="../418953/index.html">Antiquities: vintage antivirus and applied digital archeology</a></li>
<li><a href="../418955/index.html">Dodo: IT company that makes pizza. Programming and IT-processes / ITHIP</a></li>
<li><a href="../418957/index.html">Alternative: ‚ÄúHow to teach Zabbix to send problem notifications directly to the desktop‚Äù</a></li>
<li><a href="../418959/index.html">A special-purpose audio gadget: a valuable ‚Äúthing‚Äù for the US embassy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>