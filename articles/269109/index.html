<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Charles: an indispensable tool in the arsenal of a QA-engineer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="To test mobile applications that work with remote servers, QA-engineer has to keep on hand a lot of different test accounts, logs, requests and respon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Charles: an indispensable tool in the arsenal of a QA-engineer</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/169/32e/da4/16932eda4133487fa76d40eea72765ff.png"><br>  To test mobile applications that work with remote servers, QA-engineer has to keep on hand a lot of different test accounts, logs, requests and responses.  The reality is that it is not always possible to agree on providing the necessary test data on time.  Most often, server developers will be strangers to you on the other side of Skype.  In such situations, you have to substitute the server response with your own hands before sending it to the application. <br><br>  To edit the server output and play complex test scripts in QA Redmadrobot, we use <b><a href="http://www.charlesproxy.com/">Charles</a></b> . <br><a name="habracut"></a><br><h2>  How it works? </h2><br>  Charles is a tool for monitoring HTTP / HTTPS traffic.  The program works as a proxy server between the mobile application (in our case) and the server of this application.  Charles records and saves all requests that pass through the phone connected to it and allows you to edit them. <br><br><div class="spoiler">  <b class="spoiler_title">Installation instructions for Charles on Mac OS X and connect the phone.</b> <div class="spoiler_text">  1. <a href="http://www.charlesproxy.com/download/">Download and install</a> . <br>  2. When you first start, Charles will carefully offer to automatically configure the network settings - we agree. <br>  3. Go to Proxy&gt; Proxy Settings and set port 8888 if it is not already registered. <br>  4. On the phone, go to the Wi-Fi settings and assign the IP address of your Mac and port 8888 to the proxy server. <br>  The phone must be connected to the same Wi-Fi network as your Mac. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/bae/4db/707/bae4db707768420ba4c25eb08b8384b6.png"><br><br>  Is done.  The next time the client connects, Charles will ask for permission to connect your phone.  After that, Charles starts displaying all HTTP requests and responses that pass through your phone. <br><br>  To monitor <b>HTTPS</b> traffic, you need to go through additional steps: <br>  5. Go to the phone browser and go to <a href="http://www.charlesproxy.com/getssl">www.charlesproxy.com/getssl</a> to install the SSL certificate that will be used when connecting.  Install. <br>  6. In the list of hosts, select the desired host with HTTPS and tick Enable SSL Proxying. <br><img src="https://habrastorage.org/files/667/29f/ae9/66729fae9a50475fb1bb4d41d874a6fb.png"><br><br>  Is done.  Now the client Charles displays HTTPS traffic on the selected host. <br><br><blockquote>  <b>Important</b> <br>  If your application uses SSL pinning, then Charles will not be able to intercept requests and responses. </blockquote><br></div></div><br><br><h2>  Traffic monitoring </h2><br>  For a visual demonstration of working with API, we use the Habrahabr for Android application.  On the iPhone, there is protection from programs like Charles, but on Android it is not. <br><br><img src="https://habrastorage.org/files/0af/09e/a71/0af09ea713a943f78c043c35aff6619a.PNG" width="320"><br><br>  Charles builds all the queries in the order they are sent to the server.  Requests and replies can be viewed in both formatted and ‚Äúraw‚Äù form.  In QA Redmadrobot during testing, the phone is always connected to Charles.  Thus, it remains possible to view the history of requests and track tricky bugs. <br><br><img src="https://habrastorage.org/files/dd9/17d/3dc/dd917d3dc4614b41906441588721e930.png"><br><br><h3>  Data substitution </h3><br>  As you can see, I do not have much karma.  Charles will help to pretend that it is a little more than it actually is. <br><br><img src="https://habrastorage.org/files/d27/c7f/f29/d27c7ff2935b40c9af42d0264898e545.png" width="320"><br><br>  The issue of the account looks like this (only JSON-string, without headers): <br><pre><code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"data"</span></span>: { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">946584</span></span>, <span class="hljs-string"><span class="hljs-string">"login"</span></span>: <span class="hljs-string"><span class="hljs-string">"yaryabu"</span></span>, <span class="hljs-string"><span class="hljs-string">"time_registered"</span></span>: <span class="hljs-string"><span class="hljs-string">"2015-02-27T15:22:52+03:00"</span></span>, <span class="hljs-string"><span class="hljs-string">"score"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"fullname"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"sex"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"rating"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"rating_position"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"geo"</span></span>: { <span class="hljs-string"><span class="hljs-string">"country"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"region"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"city"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-string"><span class="hljs-string">"counters"</span></span>: { <span class="hljs-string"><span class="hljs-string">"posts"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"comments"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">"followed"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"followers"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-string"><span class="hljs-string">"badges"</span></span>: [{ <span class="hljs-string"><span class="hljs-string">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"habred"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"plural"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"   \u003E0."</span></span> }], <span class="hljs-string"><span class="hljs-string">"avatar"</span></span>: <span class="hljs-string"><span class="hljs-string">"http:\/\/habrahabr.ru\/i\/avatars\/stub-user-middle.gif"</span></span>, <span class="hljs-string"><span class="hljs-string">"is_readonly"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-string"><span class="hljs-string">"server_time"</span></span>: <span class="hljs-string"><span class="hljs-string">"2015-10-16T20:38:02+03:00"</span></span> }</code> </pre> <br><br>  The log has a score field: <br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"score"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span></code> </pre>  Apparently, just what I need. <br><br><h4>  <b>Rewrite settings</b> </h4>  To replace the server data, open Tools&gt; Rewrite. <br>  The list on the left displays sets of requests that you can make to your taste.  After creating the set is setting the location.  Here we write the request URL with query parameters (optional). <br><br>  The next step is to create a substitution rule.  Unfortunately, Charles does not know how to replace information by key.  You need to manually prescribe the key and value, and then write what we go to see. <br><br>  The rule creation window will look like this: <br><br><img src="https://habrastorage.org/files/9f6/495/cca/9f6495cca535449dbe092eef8d285ff4.png"><br><br>  The replacement screen itself will look something like this: <br><br><img src="https://habrastorage.org/files/44e/f9b/0b4/44ef9b0b490f429fb5236a0fcd30cf19.png"><br><br>  The following response to a request for information about yourself will have edited data, score = 5000: <br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"data"</span></span>: { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">946584</span></span>, <span class="hljs-string"><span class="hljs-string">"login"</span></span>: <span class="hljs-string"><span class="hljs-string">"yaryabu"</span></span>, <span class="hljs-string"><span class="hljs-string">"time_registered"</span></span>: <span class="hljs-string"><span class="hljs-string">"2015-02-27T15:22:52+03:00"</span></span>, <span class="hljs-string"><span class="hljs-string">"score"</span></span>: <span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-string"><span class="hljs-string">"fullname"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"sex"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"rating"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"rating_position"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"geo"</span></span>: { <span class="hljs-string"><span class="hljs-string">"country"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"region"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"city"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-string"><span class="hljs-string">"counters"</span></span>: { <span class="hljs-string"><span class="hljs-string">"posts"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"comments"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">"followed"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"followers"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-string"><span class="hljs-string">"badges"</span></span>: [{ <span class="hljs-string"><span class="hljs-string">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"habred"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"plural"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"   \u003E0."</span></span> }], <span class="hljs-string"><span class="hljs-string">"avatar"</span></span>: <span class="hljs-string"><span class="hljs-string">"http:\/\/habrahabr.ru\/i\/avatars\/stub-user-middle.gif"</span></span>, <span class="hljs-string"><span class="hljs-string">"is_readonly"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-string"><span class="hljs-string">"server_time"</span></span>: <span class="hljs-string"><span class="hljs-string">"2015-10-16T20:58:05+03:00"</span></span> }</code> </pre><br><br>  The next transition to the profile screen in the Habr application, we will see the fruit of our labors. <br><img src="https://habrastorage.org/files/a9a/120/eb4/a9a120eb470843e2bdbdf319c68d0aa8.png" width="320"><br><br>  I want to remind once again that the information on the server remains the same.  The data changes during the journey to the MP and these changes <b>do not affect the actual</b> profile <b>data</b> in any way. <br><br>  In the same way it is possible to substitute not only answers, but also requests.  To do this, on the Rewrite rule screen, you need to tick the Request field, not the Response field. <br><br><h4>  <b>Breakpoints</b> </h4>  When changing queries using Rewrite settings in Charles, it is impossible to edit the Cyrillic alphabet.  When changing any information to Cyrillic, your logs will consist of a set of question marks. <br><br>  Fortunately, this flaw can be circumvented with another Charles function - breakpoints.  The idea is similar, but only the answers stop right before being transferred to the MP, and you can edit them with your own hands in real time. <br><br>  Open Breakpoints settings and write the request URL. <br><img src="https://habrastorage.org/files/944/d5f/e38/944d5fe38c6e4cf6a4065d3ca438f648.png"><br><br>  The next time you respond to this request, Charles will intercept all of the issue and allow us to work with it.  It should be borne in mind that the MP can throw out a timeout error, and the current request will go nowhere. <br><img src="https://habrastorage.org/files/af8/a90/b0f/af8a90b0f85b4e59bfc5ee6afc53d54c.png"><br><br>  Replace my login with something written in Cyrillic. <br><img src="https://habrastorage.org/files/7ae/9d5/c84/7ae9d5c84d1a45c3853696a2affeae59.png"><br><br>  That's all.  The application displays the information we need and there are no problems with the Cyrillic alphabet. <br><img src="https://habrastorage.org/files/18c/c36/526/18cc365262784f2aa8ddbb962f1ae704.png" width="320"><br><br><h2>  <b>The most important thing</b> </h2><br>  The licensed version of Charles costs <a href="http://www.charlesproxy.com/buy/">$ 50 per person</a> .  Charles allows you to use yourself for free, but with restrictions.  The functionality of the tool is not blocked, but when using the trial version, windows will sometimes appear asking you to wait 5-10 seconds before resuming work and think again about how cool it would be to buy a license.  Also, the program will automatically end every 30 minutes and the entire query history will be lost. <br><br><h2>  <b>Results</b> </h2><br>  Charles is an indispensable tool in the arsenal of Redmadrobot QA engineers.  With it, you can create any necessary test data, both real and impossible (if you believe the API-specifications).  Such capabilities expand the testing of the black box and allow you to observe all the main interactions of your MP and its servers.  Testing at this level allows you to find more complex defects and significantly improves the overall quality of the application. </div><p>Source: <a href="https://habr.com/ru/post/269109/">https://habr.com/ru/post/269109/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269099/index.html">Russian hackers hacked Dow Jones and seized insider information</a></li>
<li><a href="../2691/index.html">Companies, companies ...</a></li>
<li><a href="../26910/index.html">Interview with Vlad Merzhevich</a></li>
<li><a href="../269103/index.html">Big hakaton on VDNH</a></li>
<li><a href="../269107/index.html">[CodinGame] Back to the Code: Recar and Olaf69 share their strategies</a></li>
<li><a href="../269111/index.html">How to write RFP for software development</a></li>
<li><a href="../269113/index.html">Illusion of time</a></li>
<li><a href="../269115/index.html">Admin as unit test for HTTP API</a></li>
<li><a href="../269117/index.html">Network technology in higher education. Sad experience in finding young professionals</a></li>
<li><a href="../269119/index.html">Balancing 70 thousand requests per second on HighLoad ++</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>