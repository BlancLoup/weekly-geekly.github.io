<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ability to see abstractions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="My son, like many boys, likes cars. And the more they are unusual and - the more they like. When we walk down the street, and an evacuator or a snow r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ability to see abstractions</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/6b7/411/67d/6b741167dbda1a7ace01231999bd20fc.jpg"><br><br>  My son, like many boys, likes cars.  And the more they are unusual and - the more they like.  When we walk down the street, and an evacuator or a snow removal vehicle passes by, he invariably pulls my hand, points to the object of interest to him and says: ‚ÄúDad, bl-r!‚Äù.  He says so because he is one year old and the above two words make up 40% of his vocabulary.  However, in general, the idea is clear - pay attention to the car.  Let's think about how a child aged 8-10 years would say the same to his peer.  Something like, ‚ÄúWow, look what a cool car!‚Äù, Yes?  The thought is the same, but pay attention - already six words instead of two.  And finally, imagine how a person at the age of thirty will say the same: ‚ÄúHey, look, this is the 2008 2008 Ferrari California with a 454 horsepower V8 engine and a 7-speed automatic transmission!  It accelerates to a hundred in 3.9 seconds! ‚Äù  Yes, there are more details here, but if you are not a car mechanic or a Ferrari fan, you probably don‚Äôt need them and don‚Äôt matter.  The main idea is the same as in ‚ÄúWow, see what a cool car!‚Äù Or ‚ÄúDad, bl-r!‚Äù.  But it is expressed already in 30 words. <br><br>  Have you noticed how the abstraction "interesting car" has become overgrown with details and nuances, began to occupy much more space in the text and time for understanding, analysis and response?  The same thing happens with software code. <br><a name="habracut"></a><br><h4>  What is it all about </h4><br>  In my opinion, the main characteristic of a good programmer is not deep knowledge of mathematics, not 100 years of experience behind him, not knowledge of a heap of languages ‚Äã‚Äãand libraries, not% heap_drug_effect_new_%, but the ability to see abstractions.  Not only to see, of course, but also to design, use, correct, etc.  But the fact is a fact.  The success of some popular product today (substitute your favorite OS, browser, game - whatever) is determined by how well its architecture is designed, how well the high-level parts are separated from the low-level and from each other. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Look at the "dead" projects.  Very rarely, they die from the fact that the programmer could not increase the speed of work by 10%, or because they could not fasten the necessary library.  Most often, the reason for the closure is formulated in the spirit of "the existing architecture makes it impossible in principle to further develop."  Here it is, a mistake in the vision of abstractions.  Someone once did not see for a long time that several entities are actually one, or that one can have several representations, or that the client does not really have to pull the server, but vice versa, or that it would be nice to lay down the possibility of expanding the protocol - and here it is, the thunder of consequences that followed after years. <br><br><h4>  Patterns </h4><br>  In the modern world of programming there is such a thing as "patterns".  Well, you know, the book of the gang of four, all kinds of factories there \ singltons \ wrappers \ observers \ facades \ bridges.  The attitude of programmers to patterns is ambiguous.  There is a camp of pattern lovers who rightly argue that this is all - the quintessence of decades of the best programming experience, proven things and should not be slowed down, but to use the achievements to the fullest.  And there is a camp of opponents of patterns who blame them on excessive complexity (3-5 classes for the realization of one idea - quite typical for an average pattern), they say that studying patterns is like a school binge - when you just learn something without understanding causes, effects and options for precisely targeted use. <br><br>  It seems to me that this is again a matter of patterns with abstractions.  Some patterns are complete and unambiguously describe any one concept.  It can be understood, seen, realized, encapsulated in itself.  No matter, there will be one class, five or ten - if they form an entity that does not depend on the external environment, which can be placed in a separate module and then used through a simple interface - this is a good pattern. <br><br>  Other patterns are overt trash.  Just because these two classes are in the third, inherited from the fourth and call the methods of the fifth - they do not create an abstraction.  Perhaps they somehow speed up the code or bypass some limitation of the language, but they do not form a holistic idea.  It is difficult to understand, impossible to remember and it causes righteous anger in the rational brain of a programmer.  Approximately as a random set of words, not forming a sentence - the reader.  Pajamas sweet jump Moon contrary fast hatch? <br><br><h4>  Instruments </h4><br>  Unfortunately, modern development tools do not provide good automatic tools for seeing abstractions in a project.  Yes, you can see interfaces or abstract classes in code - but not the fact that this is what constitutes a real abstraction.  A certain layer of logic can contain dozens of interfaces, and the other can have just one class (and that one is just an empty wrapper around something else).  We can use the IDE to see classes, methods, and variables ‚Äî but we don‚Äôt see the real separation of the project into layers.  Everything remains on the conscience of the programmer.  Fortunately, today we have the opportunity to make the code in separate modules, we have namespaces, interfaces, good advice on refactoring and tools for its implementation.  It is possible to write a code well divided into separate modules.  And this is more important than writing fast code.  Of course, the ‚Äúmodular code‚Äù is not 100% equal to the ‚Äúideal code‚Äù, but very, very close to this. <br><br><h4>  Bad code example </h4><br>  A few years ago there was a peak in the popularity of the text editor Notepad ++.  Tens of millions of downloads, nice minimalistic interface, plugins.  The beginning was very good, nothing foreshadowed trouble.  Over the past couple of years, this text editor has been blown away and actually stalled in its development.  Here is the schedule of its downloads. <br><img src="https://habrastorage.org/storage2/aaf/b9a/8d5/aafb9a8d531d39bc192a9bf5bdd6bc6e.png"><br><br>  What are the reasons?  I do not undertake to call them all, but here is one.  Let's look at one file from its source. <br>  <a href="">NppBigSwitch.cpp</a> <br><br>  Carefully analyze some parts of this code. <br><br><div class="spoiler">  <b class="spoiler_title">Misunderstanding of the term 'variable name'.</b> <div class="spoiler_text"><pre><code class="cpp hljs">Macro m = _macro;</code> </pre> <br></div></div>  The variable name is not the processor register name.  The main task of a variable name is not to address a cell in memory, but to explain what data is in it.  Simply for addressing, it would be possible to allocate an array in memory once and start to run on it with pointers.  It is the variable name that is the abstraction that simplifies the understanding of the code.  Here, as we see, does not simplify. <br><br><div class="spoiler">  <b class="spoiler_title">Misunderstanding of version control systems</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* case NPPM_ADDREBAR : { if (!lParam) return FALSE; _rebarTop.addBand((REBARBANDINFO*)lParam, false); return TRUE; } case NPPM_UPDATEREBAR : { if (!lParam || wParam &lt; REBAR_BAR_EXTERNAL) return FALSE; _rebarTop.reNew((int)wParam, (REBARBANDINFO*)lParam); return TRUE; } case NPPM_REMOVEREBAR : { if (wParam &lt; REBAR_BAR_EXTERNAL) return FALSE; _rebarTop.removeBand((int)wParam); return TRUE; } */</span></span></code> </pre><br></div></div>  The old unnecessary code needs to be deleted with a comment in a separate commit about why it was deleted.  If this is not yet added functionality - its place in a separate branch.  Just to keep a bunch of commented-out code in project files means not to understand the ideas of version control systems. <br><br><div class="spoiler">  <b class="spoiler_title">Misunderstanding of where the program speed is more important, and where is the programmer‚Äôs speed</b> <div class="spoiler_text"><pre> <code class="cpp hljs">LRESULT Notepad_plus::process(HWND hwnd, UINT Message, WPARAM wParam, LPARAM lParam) { ... <span class="hljs-comment"><span class="hljs-comment">//  1800   ... }</span></span></code> </pre><br></div></div>  Nothing so much for one function, right?  The author probably tried to save a whole ten nanoseconds to call each individual piece of code through a separate function.  Well done, saved.  And I received a code in which it is disgusting to dig and you need to spend a lot of time on understanding and correcting. <br><br><div class="spoiler">  <b class="spoiler_title">Misunderstanding of abstractions 'flag', 'constant', 'magic number'.</b> <div class="spoiler_text"><pre> <code class="cpp hljs">nmdlg-&gt;Items[i] = <span class="hljs-number"><span class="hljs-number">0xFFFFFFFF</span></span>; <span class="hljs-comment"><span class="hljs-comment">// indicate file was closed ... if ((lParam == 1) || (lParam == 2)) ... long view = MAIN_VIEW; view &lt;&lt;= 30; return view|i;</span></span></code> </pre><br></div></div>  What is 0xFFFFFFFF, 1, 2 and 30?  Oh yeah, 0xFFFFFFFF - means that the file has been closed.  What a wonderful comment, how everything is vividly!  It was apparently very quick and convenient to simply jot down the numbers into the code - it compiles after all.  No time to explain, let's go further, right? <br><br><div class="spoiler">  <b class="spoiler_title">Lack of abstraction over encodings</b> <div class="spoiler_text"><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> COPYDATA_FILENAMESA : { <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *fileNamesA = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *)pCopyData-&gt;lpData; CmdLineParams &amp; cmdLineParams = pNppParam-&gt;getCmdLineParams(); <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> UNICODE WcharMbcsConvertor *wmc = WcharMbcsConvertor::getInstance(); const wchar_t *fileNamesW = wmc-&gt;char2wchar(fileNamesA, CP_ACP); loadCommandlineParams(fileNamesW, &amp;cmdLineParams); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> loadCommandlineParams(fileNamesA, &amp;cmdLineParams); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> break; } case COPYDATA_FILENAMESW : { wchar_t *fileNamesW = (wchar_t *)pCopyData-&gt;lpData; CmdLineParams &amp; cmdLineParams = pNppParam-&gt;getCmdLineParams(); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> UNICODE loadCommandlineParams(fileNamesW, &amp;cmdLineParams); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> WcharMbcsConvertor *wmc = WcharMbcsConvertor::getInstance(); const char *fileNamesA = wmc-&gt;wchar2char(fileNamesW, CP_ACP); loadCommandlineParams(fileNamesA, &amp;cmdLineParams); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> break; } } return TRUE; }</span></span></code> </pre><br></div></div>  In each place where a program is compiled in Unicode or not, we see constructs that load the programmer‚Äôs brain with things that are not needed at the moment.  Even in the Win32 API, where many functions have unicode and non-unicode versions, we do not think what to call each time, we simply write ‚ÄúMessageBox‚Äù, and thanks to macros this is replaced with MessageBoxA or MessageBoxW.  This allows you to rise above this level, disable the brain from having to remember about this part.  For the authors of Notepad ++, this way seems to be too easy. <br><br><div class="spoiler">  <b class="spoiler_title">Lack of abstraction layer over operating system UI-primitives</b> <div class="spoiler_text"><pre> <code class="cpp hljs">::MoveWindow(_rebarTop.getHSelf(), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, rc.right, _rebarTop.getHeight(), TRUE); ... ::SendMessage(_statusBar.getHSelf(), WM_SIZE, wParam, lParam);</code> </pre><br></div></div>  Every time we need to move a window, hide it, or perform some other action with an interface element, the Win32 API functions are pulled directly.  No interface libraries, no wrappers, no classes.  As a result, a lot of superfluous and duplicate code, absolute non-portability to other OS, all the disadvantages of the Win32 API are right inside our code.  Moreover, the authors expose this approach as an advantage of the product, they say, no extra components!  It's just awful.  Hundredths of a percent increase in performance (at best) - and hell in the source. <br><br>  As a result of all of the above, developing Notepad ++ is catastrophically difficult and slow.  My patch that fixes a couple of important bugs for me has been on the ‚Äúpending‚Äù list for six months now, along with almost 200 other patches.  The author, of course, accepts some of them from time to time, but you yourself understand that it is absolutely impossible to do it quickly with such a code base.  I am very sorry for the editor who once seemed to be a good editor, but you see yourself - death is inevitable. <br><br><h4>  Good code example </h4><br>  Perhaps you know such a popular library as Qt - it has been a lot written about it lately on Habr√©.  Again, I don‚Äôt presume to say that I know best of all the reasons for its success, but here‚Äôs one of them.  The entire library is built on a beautiful core of abstractions: there are abstractions from the platform, from the network, from the elements of the OS interface, from encodings, and from virtually anything.  Looking at any Qt component, we don‚Äôt need to go deep down or up so that we understand how it works.  And all this is not due to good documentation, but because of the code of the library itself. <br><br>  Let's take a look at one of the Qt library header files. <br><br><div class="spoiler">  <b class="spoiler_title">qpdfwriter.h</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> QPDFWRITER_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> QPDFWRITER_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;QtCore/qobject.h&gt; #include &lt;QtGui/qpagedpaintdevice.h&gt; QT_BEGIN_NAMESPACE class QIODevice; class QPdfWriterPrivate; class Q_GUI_EXPORT QPdfWriter : public QObject, public QPagedPaintDevice { Q_OBJECT public: explicit QPdfWriter(const QString &amp;filename); explicit QPdfWriter(QIODevice *device); ~QPdfWriter(); QString title() const; void setTitle(const QString &amp;title); QString creator() const; void setCreator(const QString &amp;creator); bool newPage(); void setPageSize(PageSize size); void setPageSizeMM(const QSizeF &amp;size); void setMargins(const Margins &amp;m); protected: QPaintEngine *paintEngine() const; int metric(PaintDeviceMetric id) const; private: Q_DISABLE_COPY(QPdfWriter) Q_DECLARE_PRIVATE(QPdfWriter) }; QT_END_NAMESPACE #endif</span></span></span></span></code> </pre><br></div></div><br>  Do not be scared of possibly unfamiliar macros - not about them.  I want to draw your attention to another thing.  Note that there are no private properties in this class.  And in almost no other Qt class, either.  Rather, in fact, in each of them there is exactly one private variable ‚Äî this is an implicitly declared via the Q_DECLARE_PRIVATE macro pointer to a subclass, which already contains all the properties and part of the private methods.  This is done according to the official explanation to ensure binary compatibility - it turns out that this class in any version of Qt has the same size (since the storage space for one pointer is constant within the platform) and it can be safely transferred back and forth between modules without fear there is a segmentation fault. <br><br>  In fact, for me, the beauty of this solution is different.  See - we open the header file and what do we see?  Only public methods.  This is the first time you see this header file (and, in general, the Qt library, maybe) - but you already understand what this class is and how to use it, right?  All entrails are gracefully hidden in a private subclass.  Unfortunately, classic C ++ forces the programmer to mix in the header file what is needed by the external user of the class and its inside.  But in Qt, when reading a header file, we see a clear message from Qt developers: ‚ÄúYou don‚Äôt need the insides of this class.  It's not your business what is there and how, this is an abstraction - use it through public methods. ‚Äù  And that's great, damn it!  I want to see all libraries in a similar style.  Show me the things I need right away and hide unnecessary things so that they have to be searched for for a long time and hard.  Behind this approach is the future, I am sure. <br><br><h4>  findings </h4><br>  Most good tips for programmers like ‚ÄúUse refactoring‚Äù, ‚ÄúUse good patterns‚Äù, ‚ÄúPremature optimization is evil‚Äù, ‚ÄúDo not write large functions‚Äù, ‚ÄúDon't start global variables‚Äù are actually conclusions from a more general advice ‚ÄúKnow how to see abstractions ". <br><br>  Have a nice programming. </div><p>Source: <a href="https://habr.com/ru/post/185144/">https://habr.com/ru/post/185144/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../185130/index.html">Football on the plus, part 2: practical</a></li>
<li><a href="../185134/index.html">The digest of news from the world of mobile development for the last week ‚Ññ18 (June 24 - 30, 2013)</a></li>
<li><a href="../185138/index.html">Wi-Fi seamless roaming</a></li>
<li><a href="../185140/index.html">Building a Qt 5.1 Android application on a Mac seriously?</a></li>
<li><a href="../185142/index.html">The digest of interesting news and materials from the world of PHP over the past two weeks, number 20 (06/18/2013 - 06/30/2013)</a></li>
<li><a href="../185148/index.html">Changed the time for taking Microsoft exams</a></li>
<li><a href="../185150/index.html">Simple-Science - Simple Experiments (Digest # 24)</a></li>
<li><a href="../185152/index.html">Simple NAS-based Web Server</a></li>
<li><a href="../185154/index.html">Real time music generation</a></li>
<li><a href="../185160/index.html">Building scalable applications in TypeScript. Part 2 - Events or why you should reinvent your own bike</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>