<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using artificial immune systems to solve symbolic regression</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear habro-community! 

 I submit to your judgment an article written based on my master's work (Faculty of Applied Mathematics, Computer Sc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using artificial immune systems to solve symbolic regression</h1><div class="post__text post__text-html js-mediator-article">  Good day, dear habro-community! <br><br>  I submit to your judgment an article written based on my master's work (Faculty of Applied Mathematics, Computer Science and Mechanics of the Voronezh State University).  Her theme is "The use of distributed artificial immune systems to solve the problem of symbolic regression."  I will try briefly (but informatively) to review the basic concepts of artificial immune systems and my approach to their implementation for solving the problem of symbolic regression - restoring the symbolic representation of a function from a given set of its values ‚Äã‚Äãat some points.  The program was written in Python (version 3.3), the source code is available on Github. <br><a name="habracut"></a><br><h5>  Basic concepts and description of the immune system </h5><br>  The search showed that the topic of artificial immune systems in Habr√© is covered very sparingly ( <a href="http://habrahabr.ru/post/75414/">times</a> ).  And in Russian, only one book is worthy of mentioning, which is almost impossible to find in the printed version [1].  Therefore, we consider some basic concepts borrowed from biology. <br><br>  In some ways, immune systems can be considered heirs of genetic algorithms and neural networks with specific characteristics.  Judging from various publications, they are trying to apply them for the following tasks: recognition (along with the immune systems), creation of antiviruses (which is logical, based on the basic function of biological immune systems), various optimization tasks. <br>  Lymphocytes are the cells that make up the immune system.  In the body, there are B-lymphocytes, which are both the main carriers of immune memory, and the main ‚Äúcombat units‚Äù that provide resistance to the enemy (antigen), and T-lymphocytes, which can enhance or suppress the B-cell response.  In the overwhelming majority of papers, only B-lymphocytes are considered, we will also consider only them.  It is obvious that, depending on the problem being solved, lymphocytes can be different objects of the considered area.  In our task (searching for a symbolic representation of a function), the lymphocyte will be one of the possible solutions to the problem ‚Äî a certain function represented by an expression tree (for example, such as in Figure 1).  In this tree, various operations can be used (+, -, *, /, sin, cos), numbers, variables, the maximum number of which is set (to limit the search depth).  If you use the terms of genetic algorithms, a lymphocyte is just an individual. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/6eb/53b/2ad/6eb53b2ad1c27e9c90d659f0ff0c9a41.png">  Fig.  one <br><br>  Affinity is a measure of how well a given lymphocyte responds to an antigen (virus).  In biology, this is determined by various chemical bonds and reactions; in our country, this is simply the value of the objective function, which is the Euclidean distance between the exact given values ‚Äã‚Äãof the function and the values ‚Äã‚Äãof the function obtained at the same points. <br><br>  Initially, a number of randomly generated lymphocytes are created (in the body, the bone marrow is involved).  Then, throughout the entire system functioning cycle, the best of the current set of lymphocytes are selected, various hypermutation operations are applied to them (to create better adapted cells ‚Äî evolution in action).  Then, from the old and newly obtained cells, a new current set is selected, and this step is repeated anew until a solution is found with sufficient accuracy, or we carry out the maximum allowable number of iterations.  As an assessment of solutions, the previously considered objective function is used.  The functioning algorithm can be observed in Figure 2. <br><br><img src="https://habrastorage.org/storage2/f17/3f5/f83/f173f5f83a1a87e0453d85d55668459f.png">  Fig.  2 <br><br>  It is easy to see that the algorithm is similar to the classical genetic one, only the recombination operators are not used here, and the selection looks different (similar to elitism, in fact). <br><br>  The following actions on expression trees are used as mutations: <br><ul><li>  Mutation of the numeric value 2 * x ‚Üí 2.23 * x </li><li>  Mutation of the variable 2 * (x + y) * x ‚Üí 2 * (x + y) * y </li><li>  Mutation of the unary operator sin (x) * y ‚Üí cos (x) * y </li><li>  Mutation of the binary operator x + y ‚Üí xy </li><li>  Mutation of a subexpression (subtree of an expression tree) 2 * (x + y) ‚Üí 2 * sin (x) </li></ul><br><br><h5>  Add concurrency </h5><br>  Of course, I would like to add the ability to parallelize this system for functioning on several machines.  In this case, OpenMP had to be abandoned for precisely this reason (it is necessary to run on several machines), MPI - on another: I would like the compute nodes to be added / fail / shut down while the entire system is running, and the system continued would function.  This can be achieved by creating such a ‚Äútopology‚Äù, which is used in p2p.  One node knows about several neighbors, exchanges only with them.  Of course, it looks like a bicycle, but to check the very possibility of paralleling this model - just right. <br>  It now remains to figure out how to organize this most distributed immune system, given that data transmission over the network is not very fast, so the interaction between the nodes at each iteration is excluded.  The biological immune system can be considered distributed (to some extent) - cells are distributed throughout the body.  Therefore, in our model, you can simply add the exchange of the best lymphocytes between two nodes every N iterations.  And, of course, not with the same thing, but with different ones.  Thus, the parallel version of our algorithm will take the following form: <br><br><img src="https://habrastorage.org/storage2/0e9/92a/470/0e992a47034645df7737161cfba16cad.png">  Fig.  3 <br><br>  If we draw analogies with genetic algorithms, then such distribution is similar to the island model - when individual populations exchange specially selected individuals. <br><br><h5>  Implementation and code </h5><br>  I am not a Python programmer (but very much C #), but Python is close to me and I really like it, I handed in tasks for numerical methods (thanks to numpy, scipy, matplotlib), wrote scripts for myself.  I read a couple of books (Lutz, Dive into python), PEP-8, of course, but I think that the code for good Python programmers does not look very appetizing.  By the time it came out about as much as I would write it in C #.  I used unittest, for testing there are scripts main.py, local_node.py and local_server.py.  All comments / additions / tips are very welcome, I would like to get at least some feedback. <br><br>  <a href="https://github.com/StanislavUshakov/ArtificialImmuneSystem">Project on Github</a> <br><br>  This is how the program works (for the function x * x + sin (sin (x)) * x * y, the function values ‚Äã‚Äãare given at 100 points, 4 computing nodes, 200 iterations of the algorithm, exchange after every 30 iterations): <br><img src="https://habrastorage.org/storage2/0e5/c17/918/0e5c1791825abce63ecb8172e8ee1522.png">  Fig.  four <br><br><h5>  Literature and links </h5><br>  1) Artificial immune systems and their application / [ed.  Dasgupta] - M .: Fizmatlit 2006 - 344 p. <br>  2) Colin G. Johnson Artificial Immune Systems Programming for Symbolic Regression / Colin G. Johnson // Genetic Programming: 6th European Conference.  - 2003. - P. 345‚Äì353 - ISBN = 3-540-00971-X <br><br>  PS Sorry if the text is a bit muddled, in some way it is an attempt to prepare for defense - to collect thoughts, to tell about the work done. </div><p>Source: <a href="https://habr.com/ru/post/181342/">https://habr.com/ru/post/181342/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../181330/index.html">GlacierWorks and Microsoft have created an interactive site on Everest</a></li>
<li><a href="../181332/index.html">How to beat Candy Crush Saga</a></li>
<li><a href="../181334/index.html">The Ministry of Culture proposes to fine users of file-sharing networks for 5000 rubles</a></li>
<li><a href="../181336/index.html">Arduino: Automatic staircase lighting</a></li>
<li><a href="../181338/index.html">Adding animation to the ListView</a></li>
<li><a href="../181344/index.html">A little more about 2D graphics for Android</a></li>
<li><a href="../181350/index.html">Warner Bros. and NBC Universal demanded the removal of the address of the file hosting Mega from the Google search results</a></li>
<li><a href="../181354/index.html">Scalable networks in Openstack. Part 2: VlanManager</a></li>
<li><a href="../181356/index.html">Fundamental problems of the economy on Bitcoin</a></li>
<li><a href="../181362/index.html">Overview of the Philips Shoqbox SB7300 Portable Audio System</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>