<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Several subtleties of using jade in Meteor-projects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago I had to plunge into Meteor. Despite the fact that I do not like javascript, coffeescript is even more, and node.js infuriates me, Meteo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Several subtleties of using jade in Meteor-projects</h1><div class="post__text post__text-html js-mediator-article">  Some time ago I had to plunge into Meteor.  Despite the fact that I do not like javascript, coffeescript is even more, and node.js infuriates me, Meteor very quickly gained my recognition and love.  I did not work with it until version 1.0+, as far as I know, there were a lot of horrors there, but now, for me personally, this is a very convenient tool for small interactive projects.  Therefore, I really want to share something that can facilitate the use of this tool to other people. <br><br>  My experience with Meteor is not so big to take and start something difficult to put on the shelves.  However, I ran into some things, smacked my head about them and found some solutions.  And in this article I want to share my observations / tips on working with jade in Meteor.  Unfortunately, with him everything is not as cool as with a clean jade. <br><a name="habracut"></a><br>  I use the mquandalle: jade package in my projects, and it has a number of unpleasant features.  Custom template helpers do not work exactly as expected.  Standard syntax implies that we simply take and call the helper with a regular string if it is used by itself.  Or we frame it in # {} if it is used in a string with something.  Here is an example (all coffeescript code): <br><br>  Helpers: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="coffeescript hljs">Template.Some.helpers( ifHelper: <span class="hljs-function"><span class="hljs-function">-&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> plainTextHelper: <span class="hljs-function"><span class="hljs-function">-&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'Just some value'</span></span> )</code> </pre> <br>  Template: <br><br><pre> <code class="html hljs xml"> template(name='Some') if ifHelper .some-class #{someHelper}</code> </pre><br>  Everything works fine, until you try to pass the value to the helper, to get the value of the string.  And this is required, and quite often.  If you write # {someHelper someval}, you will get the output '# {someHelper someval}'.  Maybe someone will decide right away that if the Jade option does not work, then the standard template syntax should be used.  But, for example, I extremely dislike the use of non-native things in the syntax, and therefore I have long and stubbornly searched for how to make the design I need work on the jade syntax.  The answer is no way.  At least at the time of this writing, I have never found a recipe.  I had to sacrifice the principle and write is not very nice {{someHelper someVal}}. <br><br>  However, if you need to return the text from the html helper (and this happens), then you need to use triple curly braces {{{someHelper someVal}}}.  Otherwise, the html-code will be secure, i.e. it will be displayed as '&amp; code;' <br><br>  If not instead, you should use unless.  But there are no normal js-conditions inherent in this template-maker in free life in the meteor edition.  Therefore, pretty quickly I had a file in which I add the functionality I need for the template engine, and I drag it between projects.  While it looks like this: <br><br><pre> <code class="coffeescript hljs">UI.registerHelper <span class="hljs-string"><span class="hljs-string">'print'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(obj)</span></span></span><span class="hljs-function">-&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'TEMPLATE DEBUG: type:'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(obj), <span class="hljs-string"><span class="hljs-string">'val:'</span></span>, obj) UI.registerHelper <span class="hljs-string"><span class="hljs-string">'equal'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(obj1, obj2)</span></span></span><span class="hljs-function">-&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> obj1 == obj2 UI.registerHelper <span class="hljs-string"><span class="hljs-string">'notequal'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(obj1, obj2)</span></span></span><span class="hljs-function">-&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !(obj1 == obj2) UI.registerHelper <span class="hljs-string"><span class="hljs-string">'collectionIsEmpty'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(col)</span></span></span><span class="hljs-function">-&gt;</span></span> error_flag = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> col.fetch() <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> error obj = col error_flag = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !error_flag obj = col.fetch() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !obj.length</code> </pre><br>  If someone does not know, then the UI.registerHelper function registers the global helper, which is available in all templates.  As for the functions themselves, the first is used to debug template variables.  Sometimes it is useful to understand what lies in a variable and why it does not work the way I expect.  Just write: <br><br><pre> <code class="html hljs xml">{{print someVar}}</code> </pre><br>  ‚Ä¶ or: <br><br><pre> <code class="html hljs xml">{{print someHelper}}</code> </pre><br>  ... and get the output to the console, where we see the type and value. <br><br>  The second and third helpers are an adaptation of simple template conditions from Django, my favorite web framework (well, where is it without ads?) <br><br>  The last helper is used to test the ability to iterate (iterate) the collection.  In order not to doubt whether I returned .fetch () from the collection, or whether it was in its pure form, the helper is slightly complicated. <br><br>  Also, in working with templates, I have long beaten about the each syntax.  When we call each, we change the context of the template, and this begins to point not to the scope of the template, but to the scope of the object being iterated. <br><br><pre> <code class="html hljs xml"> .some-class #{this.title} each MyBlogPostCollection h1 #{this.title}</code> </pre><br>  In the first case, .title will either be a helper template with that name, or a property from the data object if you are using iron-router.  In the second, the .title will be taken from the MyBlogPostCollection collection object.  By the way, this can not be written to access the properties, simply # {title} <br><br>  But it's all pretty simple, and now actually what I was fighting with.  If in each we need to refer to an object from the parent context, then it is used ... (two points), and there is no need to write this, its parser will not devour.  The result is such here, not always obvious constructions: <br><br><pre> <code class="html hljs xml">{{someHelper ../../..}}</code> </pre><br>  Within the context of the parent context, if required, you can also directly access the properties.  i.e .: <br><br><pre> <code class="html hljs xml">{{someHelper ../../title}}</code> </pre><br>  I also pretty well beat my head trying to dynamically set a class for an element.  Although, perhaps, it is only up to me that some things get so tight. <br><br><pre> <code class="html hljs xml">.contacts(class="{{#if isPdf}} border-radius-pdf {{/if}}")</code> </pre><br>  Well, if the same is required with a helper, then: <br><br><pre> <code class="html hljs xml">.contacts(class="{{#if isPdf}} {{border-radius-pdf someVal}} {{/if}}")</code> </pre><br>  And yes, a small note, the whole if-else construction looks like this: {{#if &lt;...&gt;}} {{else}} {{/ if}} i.e. else has no # that, in my a glance is not logical. <br><br>  Pure jade if-else looks simple: <br><br><pre> <code class="html hljs xml"> if .some value else .another value</code> </pre><br>  But remember that you can‚Äôt add a condition to if. <br><br>  From the subtleties of using jade, this is probably all that I can now tell.  When I sat down to write an article, I wanted to share several tricks not only in working with templates, but also with processing the form data, loading images, but writing about jade, I decided not to throw everything into the general pile.  I also solved a nontrivial task the other day - I learned how to make a screenshot of an application with user data.  Perhaps some of this will be interesting - leave comments, if there is a demand - I will write. </div><p>Source: <a href="https://habr.com/ru/post/251355/">https://habr.com/ru/post/251355/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251345/index.html">Pebble Time: a new watch with a color screen</a></li>
<li><a href="../251347/index.html">Context Model Pattern via Aero Framework</a></li>
<li><a href="../251349/index.html">Processing logs based on previous messages in logstash / elasticsearch</a></li>
<li><a href="../251351/index.html">CoinFest-2015-Moscow</a></li>
<li><a href="../251353/index.html">We write a bot for MMORPG with assembler and draenei. Part 3</a></li>
<li><a href="../251357/index.html">Data exchange using MPI. Working with the MPI Library on the example of the Intel¬Æ MPI Library</a></li>
<li><a href="../251359/index.html">Complete energy autonomy or how to survive with solar panels in the outback (part 1. theoretical)</a></li>
<li><a href="../251361/index.html">MVC and Model 2. Component Knowledge and Responsibilities</a></li>
<li><a href="../251363/index.html">Modifying HTTP traffic using FiddlerScript and .NET plug-ins to Fiddler</a></li>
<li><a href="../251365/index.html">Top 10 Mistakes That Newbies Make to Java</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>