<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Auto-vectorization and auto-parallelization with Guided Auto-parallelization (GAP)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Having published the post New features of vectorization and parallelization in the Intel¬Æ Parallel Composer , I decided to go all the way myself, whic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Auto-vectorization and auto-parallelization with Guided Auto-parallelization (GAP)</h1><div class="post__text post__text-html js-mediator-article"><img src="http://software.intel.com/file/28626" alt="image" align="left"><br>  Having published the post <a href="http://habrahabr.ru/company/intel/blog/97011/">New features of vectorization and parallelization in the Intel¬Æ Parallel Composer</a> , I decided to go all the way myself, which I suggested in the <a href="http://habrahabr.ru/company/intel/blog/97011/">commentary</a> .  Namely, access to the Intel¬Æ Parallel Composer to test one of the features (English feature).  Since I was already porting serial code to CEAN + Cilk, I stopped testing Guided Auto-parallelization (GAP).  The first sentence in the GAP documentation ‚Äú <i>Guided auto-parallelization is the code that can be parallelized</i> .‚Äù Gave me the idea that I already know something like that from the compiler.  Namely, auto-vectorization and auto-parallelization diagnostics keys <code>‚Äìvec-report</code> and <code>‚Äìpar-report</code> .  What are the differences read under the cut. <a name="habracut"></a><br>  Immediately make a reservation, I used only what is available during beta testing, I did not use any inside information.  I took <a href="http://software.intel.com/file/29059">an example</a> from the presentation and played with it.  First of all I checked for auto-vectorization: <br> <code>#icl -c gaptestcase.cpp /Qvec-report3</code> <br>  ... <br> <code>gaptestcase.cpp(19) (col. 1): remark: routine skipped: no vectorization candidates. <br></code> <br>  Further, though I am not very good at auto-parallelization (I prefer to parallelize myself), checked and how well the code is auto-parallelized: <br> <code>#icl -c gaptestcase.cpp /Qparallel /Qpar-report3</code> <br>  It gave me nothing.  After that, I decided to refer to the GAP documentation.  It turned out that there are three types of compiler options: <br><ul><li>  Enable diagnostics for vectorization, parallelization, and data transformation (data transformations), or all together: ‚Äìguide-vec, ‚Äìguide-par, and ‚Äìguide-data-trans (Linux * OS), or / Qguide-vec, / Qguide -par, and / Qguide-data-trans (Windows * OS) or ‚Äìguide [= n] (Linux * OS) or / Qguide [: n] (Windows *). </li><li>  Selection of specific code sections for diagnostics (eg most frequently used code areas (eng. Hotspots)): -guide-opts = &lt;arg.&gt;.  Eg / Qguide-opts: "bar.f90, 'module_1 :: routine_name`" </li><li>  Output redirection: -guide-file = &lt;file_name&gt; -guide-file-append [= file_name].  By default, all output to stderr, but you can redirect to a file or add to a file. </li></ul><br>  Next, follow the words of Mike Naumenko: <br>  ‚Äú <i>First a little excursion into history</i> <i><br></i>  <i>And we will move on to practice later (later, it means)</i> ‚Äù, <br>  moved on to practice.  First, I checked what GAP says about the auto-vectorization of the example: <br><img src="http://software.intel.com/file/29062" alt="image" align="left"><br> <code>#icl -c gaptestcase.cpp /Qguide-vec</code> <br>  Output on display: <br> <code>GAP REPORT LOG OPENED ON Sat Jul 10 17:39:54 2010 <br> remark #30761: Add -Qparallel option if you want the compiler to generate recommendations for improving auto-parallelization. <br> Recompile with -guide (Linux) or -Qguide (Windows) in both passes of IPO. <br> <b>‚Ä¶\gaptestcase.cpp(27): remark #30534:</b> (LOOP) Add -Qansi-alias option for better type-based disambiguation analysis by the compiler if appropriate (option will apply for entire compilation). This will improve optimizations for the loop at line 27 [VERIFY] Make sure that the semantics of this option is obeyed for entire compilation. <br> <b>‚Ä¶\gaptestcase.cpp(27): remark #30513:</b> (VECT) Use "#pragma ivdep" to vectorize the loop at line 27, if these arrays in the loop do not have unsafe cross-iteration dependencies: ?nodes@@3PAPAUTEST_STRUCT@@A, ?distances@@3PAMA. [VERIFY] A cross-iteration dependence exists if a memory location is modified in an iteration of a loop and accessed (a read or write) in another iteration of a loop. Make sure that there are no such dependencies, or that any cross-iteration dependencies can be safely ignored. <br> Number of advice-messages emitted for this compilation session: 2. <br> END OF GAP REPORT LOG</code> <br> <br><br>  Sensible tips.  After adding the <code>#pragma ivdep</code> to the code and / Qansi-alias compilation options: <br> <code>#icl -c gaptestcase.cpp /Qvec-report3 /Qansi-alias <br> ‚Ä¶\gaptestcase.cpp(27) (col. 3): remark: LOOP WAS VECTORIZED.</code> <br>  After that, I checked the author-paralleling: <br> <code>#icl -c gaptestcase.cpp /Qguide-par /Qparallel /Qansi-alias</code> <br>  Output on display: <br> <code>GAP REPORT LOG OPENED ON Sat Jul 10 17:36:46 2010 <br> <b>‚Ä¶\gaptestcase.cpp(27): remark #30525:</b> (PAR) If the trip count of the loop at line 27 is greater than 16, then use "#pragma loop count min(16)" to parallelize this loop. [VERIFY] Make sure that the loop has a minimum of 16 iterations. <br> Number of advice-messages emitted for this compilation session: 2. <br> END OF GAP REPORT LOG</code> <br> <br><br>  That's all right and works. <br>  As you can see, in this example, GAP showed itself from the good side.  Namely, he gave practical advice: <br><ul><li>  use the -Qansi-alias compilation key; </li><li>  add directives <code>#pragma ivdep</code> and <code>#pragma loop count min(16)</code> . </li></ul><br>  That allowed the compiler to successfully auto-vectorize and parallelize an example. <br>  Lastly, for fans of Microsoft Visual Studio 2010. GAP, like the composer, integrates into the IDE: <br><img src="http://software.intel.com/file/29060" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="http://software.intel.com/file/29061" alt="image"><br>  After that, the output goes to the standard output window. <br>  That's all.  Thanks for attention. <br><br>  Please refer to <a href="http://software.intel.com/ru-ru/articles/optimization-notice/">the Optimization Notice</a> page for more details on performance and optimization in Intel software products. </div><p>Source: <a href="https://habr.com/ru/post/98768/">https://habr.com/ru/post/98768/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../98756/index.html">A plugin for Vim that provides easy keyboard layout switching on Mac OS X</a></li>
<li><a href="../98758/index.html">Great Belarusian Firewall</a></li>
<li><a href="../98759/index.html">Galaxy S vs HTC Desire: Quake2 running test</a></li>
<li><a href="../98762/index.html">Media Player PowerZest HD-500</a></li>
<li><a href="../98766/index.html">V8 engine for .NET applications</a></li>
<li><a href="../98770/index.html">How to restart the server?</a></li>
<li><a href="../98771/index.html">Convenient and safe work with ssh servers</a></li>
<li><a href="../98775/index.html">RetroN 3 is a versatile gaming console for nostalgic gamers.</a></li>
<li><a href="../98778/index.html">InducTable: futuristic table for geeks</a></li>
<li><a href="../98779/index.html">C #: Etudes by Eric Lippert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>