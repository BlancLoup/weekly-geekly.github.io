<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Partial recovery after Petya (ExPetr)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="06.27.2017, for those who do not back up to removable media, it became the blackest day when the Petya virus-viper destroyed someone for a half hour o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Partial recovery after Petya (ExPetr)</h1><div class="post__text post__text-html js-mediator-article">  06.27.2017, for those who do not back up to removable media, it became the blackest day when the Petya virus-viper destroyed someone for a half hour of their work, and someone 10-25 years of experience, archive valuable files, databases and other things.  Making start life with a clean slate.  However, there is a chance to save at least the Outlook archives and photos.  Details under the cut. <a name="habracut"></a><br>  The virus worked in two stages: it encrypted files (and not everything and not completely), then initiated a reboot and, after rebooting, encrypted the bootloader (MBR) of the hard disk.  As a result, the hard disk turned into a conditional ‚Äúpumpkin‚Äù, from which nothing could be pulled out. <br>  If the PC has gone through only the first stage, then after the MBR has been restored, you can continue to work fully on the PC and observe the consequences of the file encryption program and look for those that survived.  If the PC has gone through two stages, then everything is much worse and even just pulling out the files is much more difficult. <br><br>  There is practically no information search in RuNet using methods of saving information from such a hard disk, so I had to experimentally select the optimal strategy for finding and recovering what could have survived.  About a dozen information recovery programs were tried, but most of the information was pulled out using the R-Studio program, we‚Äôll talk about it later, with a description of the sequence of actions for saving (all actions will be carried out under Windows 7, but I think no matter what version of windows you just have to run R-studio). <br><br>  I will say right away that almost all files can be pulled out, but they will be encrypted, except for files that were not encrypted, usually photos and videos.  It will be possible to recover some files if you have the utilities that the developers of the respective file format provided.  In the example below, we will look at the process of saving an archive file from Outlook. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So the sequence of actions: <br><br>  1. We connect an unformatted encrypted disk (this is a key requirement if the disk was formatted or the OS was reinstalled, then the chances of recovering at least something tend to zero), which went through 2 stages of encryption with the loss of the file system, to a Windows PC (connect You can either directly to the motherboard through the sata / ide ports or via USB adapters, for whom it is more convenient).  And after loading the PC, we get a message about the need to format the newly connected drive (in my case, this is drive G). <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/48a/53c/445/48a53c44540d4403873f4885c7259b09.png"><br></div></div><br>  Click cancel.  We are convinced that our disk is really damaged, in the disk manager it will be determined with the RAW file system: <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/a8b/195/753/a8b195753fc84e629bf40dc700bb392c.png"><br></div></div><br>  2. Run the R-Studio program (I used version 8.2) and watch the disks found.  Our experimental 320 GB hard drive was connected via a USB 3.0 docking station and was identified as JMicron Tech 023 under the letter ‚ÄúG‚Äù. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/974/df0/d32/974df0d325684b3a9c75c8ca4a10e282.png"><br></div></div><br>  Next, double-click on the line with the ‚ÄúG‚Äù disk, as in the figure above, and wait for the end of the disk scan. <br><br>  3. The R-Studio window will open to us with the scan results (see figure below): <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/577/3e0/c11/5773e0c114ac4dce8b9dc32ee433f092.png"><br></div></div><br>  As a rule, there are very few folders with a clear name, all the most valuable is in the "Additional Found Files" section.  Therefore, we proceed to the next step. <br><br>  4. Use the mouse to select the line ‚ÄúAdditionally found files‚Äù and click the ‚ÄúFind / Mark‚Äù button on the program's control panel. <br><br>  5. In the window that opens, select the search by file extension and specify the pst extension (file format of Outlook archive folders) and click the "Yes" button. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/ec1/752/876/ec1752876fb3404e9edfbe2551acc11e.png"><br></div></div><br>  6. Search will find archive files, there may be many of them in different folders.  Therefore, we focus on the way in which you have stored archive files.  The example below shows that the files you were looking for were in the Outlook Files folder. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/00f/989/27f/00f98927f437440eaf09e0754cd47492.png"><br></div></div><br>  Please note that if you look at the left menu and go up through the folder hierarchy, you can see that this folder is located in the user account folder and there are Desktop, Documents, etc. folders.  Thus, you can pull out photos and other files that were stored in the user in these folders. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/d4a/7d7/b5c/d4a7d7b5c80441c791c8ccda810ae905.png"><br></div></div><br>  7. Next, we tick the required files with the pst extension and click the Restore Marked button, indicate the place to save the saved files (in my case this is the Recover folder on drive C).  We are waiting for the end of the process of copying files. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/76f/a26/be7/76fa26be74b24160bb4fa8592ed7900f.png"><br></div></div><br>  8. The recovered archive file is usually damaged and is not detected by Outlook.  Fortunately, for large files, the virus encrypted only the first megabyte, leaving the rest intact.  Therefore, we need to try to restore the structure of the archive, for this there are several ways: <br><br>  A) Use the SCANPST utility included in the standard MS Office suite.  For example, in MS Office 2010 this utility is located in the folder C: \ Program Files (x86) \ Microsoft Office \ Office14 \ if you have 64-bit Windows and the path C: \ Program Files \ Microsoft Office \ Office14 when using the 32-bit version of Windows . <br><br>  B) Use third-party utilities.  Which you can find a lot in the open spaces of Google. <br><br>  I used the first option and, in principle, it worked on all the PCs that were brought to me for recovery. <br><br>  I also attach to the post a <a href="https://cloud.mail.ru/public/DAXJ/exdVt8mJ3">link</a> to step-by-step instructions for working with the SCANPST utility. <br><br>  That's all, other files are restored by the same algorithm, you only need to substitute the desired file extension, or manually scroll through all the folders in the "Additional found files" section and select what needs to be restored. <br>  If someone post my "captain", please do not criticize strongly, not everyone has data recovery experience and proven tools.  If you still have questions you can write in the LAN or here in the comments. </div><p>Source: <a href="https://habr.com/ru/post/357390/">https://habr.com/ru/post/357390/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357380/index.html">Not so simple with Petya</a></li>
<li><a href="../357382/index.html">How Slovakia stole the national top-level domain .SK</a></li>
<li><a href="../357384/index.html">How does a pension fund merge personal data</a></li>
<li><a href="../357386/index.html">China will block VPN for individuals</a></li>
<li><a href="../357388/index.html">Mozilla Firefox Add-ons Manager uses Google Analytics</a></li>
<li><a href="../357392/index.html">The US authorities have closed the two largest drug trafficking in the darknet: Hansa and AlphaBay</a></li>
<li><a href="../357394/index.html">18-year-old young man arrested for reporting a ‚Äúchildish‚Äù mistake in the new electronic ticket system of Budapest</a></li>
<li><a href="../357396/index.html">The President of Russia has signed a law banning anonymizers and VPN</a></li>
<li><a href="../357398/index.html">The attackers hacked the network of HBO channel, taking away the script "Game of thrones"</a></li>
<li><a href="../357400/index.html">The British Interior Minister said that real people do not need encryption</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>