<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Hello Christmas - New Year!" Or program NanoCAD with Visual Basic .NET</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The other day, looking through the documentation for the NanoCAD API that comes bundled with the SDK, I suddenly noticed that the description of the c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Hello Christmas - New Year!" Or program NanoCAD with Visual Basic .NET</h1><div class="post__text post__text-html js-mediator-article">  The other day, looking through the documentation for the <b>NanoCAD API that</b> comes bundled with the SDK, I suddenly noticed that the description of the class members for the .NET API and the MultiCAD.NET API is given in both C # and <b>Visual Basic</b> .  And I thought: ‚ÄúBut it's great that there is a description for VB!‚Äù <br><br>  And although honestly I don‚Äôt know VB at all, and the code on the good old BASIC was last seen about 100 years ago, but this is one of the languages ‚Äã‚Äãin which people start learning the basics of programming, so I decided to make a small contribution to popularizing the program. <br><br>  I must say that Habr√© already has a good article on the <a href="https://habrahabr.ru/post/238867">use of VB for NanoCAD</a> , there is considered a bundle of NanoCAD with Excel and how it can ultimately facilitate construction design. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We will solve another, simpler and festive problem with you, <b>draw a Christmas tree</b> and congratulate the user with the new year.  Despite the fact that the article is devoted to VB, the <b>C #</b> code will also be. <br><br>  And since ‚ÄúNew Year‚Äù is a costly holiday, we will be guided by the version of NanoCAD 5.1, which is <b>free for commercial use</b> (but, in theory, it should work without problems with NC 8.X). <br><br>  Also, let's not ignore the <b>Linux</b> users <b>,</b> since the C # code can be compiled and run on it using Mono and Wine. <br><br>  To be honest, I myself just recently started learning the NanoCAD API, and therefore my last holiday article this year is somewhat like a warm graphic graphic artist <b><a href="https://ikt-det.jimdo.com/%25D0%25B0%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC%25D0%25B8%25D0%25BA%25D0%25B0/%25D0%25B8%25D1%2581%25D0%25BF%25D0%25BE%25D0%25BB%25D0%25BD%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D0%25B8/%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9-%25D0%25B8%25D1%2581%25D0%25BF%25D0%25BE%25D0%25BB%25D0%25BD%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C-%25D0%25BA%25D0%25B5%25D0%25BD%25D0%25B3%25D1%2583%25D1%2580%25D0%25B5%25D0%25BD%25D0%25BE%25D0%25BA/">‚ÄúKengurenok (ROO)‚Äù</a></b> , but if that doesn‚Äôt stop you, you are <b><a href="https://ikt-det.jimdo.com/%25D0%25B0%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC%25D0%25B8%25D0%25BA%25D0%25B0/%25D0%25B8%25D1%2581%25D0%25BF%25D0%25BE%25D0%25BB%25D0%25BD%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D0%25B8/%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9-%25D0%25B8%25D1%2581%25D0%25BF%25D0%25BE%25D0%25BB%25D0%25BD%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C-%25D0%25BA%25D0%25B5%25D0%25BD%25D0%25B3%25D1%2583%25D1%2580%25D0%25B5%25D0%25BD%25D0%25BE%25D0%25BA/">welcome to</a></b> ‚Ä¶ <br><br><img src="https://habrastorage.org/webt/pj/yv/3c/pjyv3cf8mcb4ds42dbiuwtba8s0.png"><br><br>  <i>PS This is the first letter of the word "Habrahabr" - I didn‚Äôt have enough for more =)</i> <br><a name="habracut"></a><br><a name="I"></a><br>  Since, my new hobby, is already turning into a small cycle of articles, just in case, I will provide links to all previous articles under the spoiler: <br><br><div class="spoiler">  <b class="spoiler_title">Other articles of the cycle</b> <div class="spoiler_text"><ul><li>  <a href="https://habrahabr.ru/post/342186/">Scarless Face or First Steps in Multicad.NET API 7 (for Nanocad 8.1)</a> </li><li>  <a href="https://habrahabr.ru/post/342680/">‚ÄúLike a ram on a new gate‚Äù or custom ‚Äúpseudo-3D‚Äù objects in NanoCAD using the MultiCAD.NET API</a> </li><li>  <a href="https://habrahabr.ru/post/343772/">‚ÄúI am watching you‚Äù or how to make SCADA from CADa (MultiCAD.NET API)</a> </li><li>  <a href="https://habrahabr.ru/post/344884/">‚ÄúTruth in wine‚Äù or try programming NanoCAD under Linux (MultiCAD.NET API)</a> </li></ul></div></div><br>  To begin with, as usual, <b>let me</b> remind you that <b>I am not a programmer</b> and therefore not all of my thoughts in this article can be 100% correct, and also that <b>I have nothing to do with the developers of NanoCAD</b> , just for ideological reasons I popularize a native CAD system. <br><br>  By the end of the year I don‚Äôt want to produce a mountain of text, so the article will be short, that‚Äôs what we‚Äôll make out. <br><br>  Content: <br>  <a href="https://habr.com/ru/post/345834/">Part I: Introduction</a> <br>  <a href="https://habr.com/ru/post/345834/">Part II: we write code on C #</a> <br>  <a href="https://habr.com/ru/post/345834/">Part III: write code in VB</a> <br>  <a href="https://habr.com/ru/post/345834/">Part IV: with the Coming!</a> <br><a name="II"></a><br><h2>  Part II: we write code on C # </h2><br>  How to create a new project in Visual Studio 2015 for NC 8.5, I have already <a href="https://habrahabr.ru/post/342680/">told before</a> . <br><br>  This time, for the sake of curiosity, let's create a project in a more lightweight IDE Xamarin Studio ( <a href="http://www.monodevelop.com/download/">MonoDevelop</a> ). <br><br>  I will hide the whole process under the spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">How to create a C # project for NanoCAD 5.1 in IDE Xamarin Studio</b> <div class="spoiler_text">  First, create a new project and select the class library C # <br><br><img src="https://habrastorage.org/webt/ed/w_/wi/edw_wi-56uoyrzvnjrexhimjpwa.png"><br><br>  Give him some name <br><br><img src="https://habrastorage.org/webt/wg/ea/z9/wgeaz9bycxv62gvdnsg9ep3fdyi.png"><br><br>  Then we will configure the project by clicking on it with the RMB and selecting the ‚ÄúParameters‚Äù button <br><br><img src="https://habrastorage.org/webt/r0/fh/pr/r0fhprfh90el8mo2xos36vrp8ja.png"><br><br>  Choose version .Net 3.5 <br><br><img src="https://habrastorage.org/webt/np/1d/3r/np1d3rkqygmbvco66hegfvdws1w.png"><br><br>  Then, for the convenience of debugging, we will configure the launch of the Nanocad by pressing the F5 key <br>  (each time you make changes to the code, the Nankad will need to be restarted completely) <br><br><img src="https://habrastorage.org/webt/uc/dn/2r/ucdn2rh47q3ogbebw1hqjmomclu.png"><br><br>  Then we load the links to the libraries, we need those that are displayed on the right in the picture. <br><br><img src="https://habrastorage.org/webt/h5/nt/o1/h5nto11bym3ziimv9lovnq6jzje.png"><br><br>  Do not forget to remove the checkmark from the ‚Äúcopy locally‚Äù item in the mapimgd library <br><br><img src="https://habrastorage.org/webt/8g/ft/m3/8gftm3bzxi0qiz8f-zaygmu1krq.png"><br><br>  Well, actually it remains to write the code, press F5 and see that everything starts. <br><br><img src="https://habrastorage.org/webt/fx/ho/i0/fxhoi0hj5yelmzod_bqa_rm7wow.png"><br><br>  To load your library, enter the Netload command in the NanoCAD console and select your dll (as a rule it lies in the project folder, for example, C: \ Users \ b \ Dev \ habr \ XMTree \ XMTree \ bin \ Debug) <br><br>  In order not to do it every time <br>  Let's go to the address C: \ ProgramData \ Nanosoft \ nanoCAD 5.1 \ DataRW (you may differ) and find or create the load.config file with the following content <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"C:\Users\...\bin\Debug\ .dll"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Then the libraries will be loaded automatically when the program starts. <br></div></div><br>  Similar manipulations can be done under Linux, we need Wine to run NanoCAD 5.1, and to program MonoDevelop.  I described <a href="https://habrahabr.ru/post/344884/">in</a> more detail <a href="https://habrahabr.ru/post/344884/">in the last article</a> . <br><br>  Unfortunately, there I had some problems with Wine and the colors of NanoCAD were broken in some places, so our Christmas tree for Linux will look like this: <br><br><div class="spoiler">  <b class="spoiler_title">Spruce under linux</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/zk/3e/v7/zk3ev77hfauyzjqyanofkmcz_a0.png"><br><br></div></div><br>  The C # code will not be parsed in detail in chunks; we practically do nothing new. <br><br>  In short, we create a team that draws polylines and hatches them. <br>  The code is under the spoiler and on <a href="https://github.com/bosonbeard/Funny-models-and-scripts/tree/master/2.ForNanoCAD/2.Some_simple_scripts/3.XmasThree">GitHub</a> (there is also a version for VB). <br><br><div class="spoiler">  <b class="spoiler_title">Full code for NC 5.1 in C #</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Use Microsoft .NET Framework 3.5 and old version of MultiCad.NET (for NC 5.1) //Class for demonstrating the capabilities of MultiCad.NET //Assembly for the Nanocad 5.1 //Link mapimgd from Nanocad SDK //Link System.Windows.Forms and System.Drawing //The commands: draws a christmas three. //This code in the part of non-infringing rights Nanosoft can be used and distributed in any accessible ways. //For the consequences of the code application, the developer is not responsible. //The code was not tested with NANOCAD 8.X. // However, it should work, if you update SDK libraries and include NC 8.X dll using System.Collections.Generic; using System.Linq; using Multicad.Runtime; using Multicad.DatabaseServices; using Multicad.Geometry; using Multicad.DatabaseServices.StandardObjects; using System.Drawing; using System.Windows.Forms; namespace XmasThree { class XmasThree { [CommandMethod("DXThree", CommandFlags.NoCheck | CommandFlags.NoPrefix)] public void DrawXThree() { Point3d _pntBase; Point3d _bufPnt; //prompts for installation point entry InputJig jig = new InputJig(); // Get the first box point from the jig InputResult res = jig.GetPoint("Select first point:"); //It works only if input was successful if (res.Result == InputResult.ResultCode.Normal) { // The base point is taken from the entry point (click with mouse) _pntBase = res.Point; //Draw the outline of the left half of the Christmas tree //Create base points for the polyline List&lt;Point3d&gt; leftPatrOfThreePoints = new List&lt;Point3d&gt;() { new Point3d(_pntBase.X, _pntBase.Y, 0), new Point3d(_pntBase.X-125, _pntBase.Y-154, 0), new Point3d(_pntBase.X-31, _pntBase.Y-137, 0), new Point3d(_pntBase.X-181, _pntBase.Y-287, 0), new Point3d(_pntBase.X-31, _pntBase.Y-253, 0), new Point3d(_pntBase.X-242, _pntBase.Y-400, 0), new Point3d(_pntBase.X-37, _pntBase.Y-400, 0), new Point3d(_pntBase.X-37, _pntBase.Y-454, 0), new Point3d(_pntBase.X, _pntBase.Y-454, 0) }; //Create a polyline (geometry) Polyline3d leftPatrOfThree = new Polyline3d(leftPatrOfThreePoints); //Create a polyline object and place it on the drawing DbPolyline XThreeLeft = new DbPolyline(); XThreeLeft.Polyline = new Polyline3d(leftPatrOfThree); XThreeLeft.Polyline.SetClosed(false); XThreeLeft.DbEntity.Color = Color.Green; XThreeLeft.DbEntity.AddToCurrentDocument(); //The right part of the tree is obtained by mirroring the left DbPolyline XThreeRight = new DbPolyline(); XThreeRight.DbEntity.Color = Color.Green; XThreeRight.Polyline = (Polyline3d)XThreeLeft.Polyline.Mirror(new Plane3d(_pntBase, new Vector3d(10, 0, 0))); XThreeRight.DbEntity.AddToCurrentDocument(); //From the right and left sides we make a single contour for hatching DbPolyline XThreeR = new DbPolyline(); XThreeR.DbEntity.Color = Color.Green; //XThreeR.Polyline = XThreeRight.Polyline.Clone() as Polyline3d; for NC 8.5 XThreeR.Polyline = XThreeRight.Polyline.GetCopy() as Polyline3d; //FOR NC 5.1 XThreeR.DbEntity.AddToCurrentDocument(); List&lt;Point3d&gt; hatchPoints = new List&lt;Point3d&gt;(); hatchPoints.AddRange(leftPatrOfThreePoints); hatchPoints.AddRange(XThreeR.Polyline.Points.Reverse().ToList()); Polyline3d hatchContur = new Polyline3d(hatchPoints); //We will create on the basis of a contour a hatch (geometry) with continuous filling Hatch hatch = new Hatch(hatchContur, 0, 10, true); hatch.PattType = PatternType.PreDefined; hatch.PatternName = "SOLID"; //Based on the geometry of the hatch, we create the document object, set its color properties - green DbGeometry dbhatch = new DbGeometry(); dbhatch.Geometry = new EntityGeometry(hatch); dbhatch.DbEntity.Color = Color.Green; dbhatch.DbEntity.AddToCurrentDocument(); // if you want you can try to draw balls with circles use // DrawThreeBalls(_pntBase); //Similarly, make a Christmas tree toy (octagon) //red _bufPnt = _pntBase.Subtract(new Vector3d(30, 95, 0)); DbPolyline dbOctoRed = DrawThreeOctogonPl(_bufPnt);//implicit dbOctoRed.DbEntity.AddToCurrentDocument(); Hatch hatchCirkRed = new Hatch(dbOctoRed.Polyline, 0, 1, false); hatchCirkRed.PattType = PatternType.PreDefined; hatchCirkRed.PatternName = "SOLID"; DbGeometry dbhatchCirkRed = new DbGeometry(); dbhatchCirkRed.Geometry = new EntityGeometry(hatchCirkRed); dbhatchCirkRed.DbEntity.Color = Color.Red; dbhatchCirkRed.DbEntity.AddToCurrentDocument(); //green _bufPnt = _pntBase.Subtract(new Vector3d(-40, 200, 0)); DbPolyline dbOctoGreen = DrawThreeOctogonPl(_bufPnt);//implicit dbOctoGreen.DbEntity.AddToCurrentDocument(); Hatch hatchCirkGreen = new Hatch(dbOctoGreen.Polyline, 0, 1, false); hatchCirkGreen.PattType = PatternType.PreDefined; hatchCirkGreen.PatternName = "SOLID"; DbGeometry dbhatchCirkGreen = new DbGeometry(); dbhatchCirkGreen.Geometry = new EntityGeometry(hatchCirkGreen); dbhatchCirkGreen.DbEntity.Color = Color.LightSeaGreen; dbhatchCirkGreen.DbEntity.AddToCurrentDocument(); //blue _bufPnt = _pntBase.Subtract(new Vector3d(-12, 350, 0)); DbPolyline dbOctoBlue = DrawThreeOctogonPl(_bufPnt);//implicit dbOctoBlue.DbEntity.AddToCurrentDocument(); Hatch hatchCirkBlue = new Hatch(dbOctoBlue.Polyline, 0, 1, false); hatchCirkBlue.PattType = PatternType.PreDefined; hatchCirkBlue.PatternName = "SOLID"; DbGeometry dbhatchCirkBlue = new DbGeometry(); dbhatchCirkBlue.Geometry = new EntityGeometry(hatchCirkBlue); dbhatchCirkBlue.DbEntity.Color = Color.Blue; dbhatchCirkBlue.DbEntity.AddToCurrentDocument(); //display the text with congratulations MessageBox.Show("I Wish You A Merry Christmas And Happy New Year!"); } } public Polyline3d DrawThreeOctogonPl(Point3d _pntB) { //Create points for an octagon List&lt;Point3d&gt; octoPoints = new List&lt;Point3d&gt;() { new Point3d(_pntB.X, _pntB.Y, 0), new Point3d(_pntB.X-15, _pntB.Y, 0), new Point3d(_pntB.X-25, _pntB.Y-11.3, 0), new Point3d(_pntB.X-25, _pntB.Y-26.3, 0), new Point3d(_pntB.X-15, _pntB.Y-37.6, 0), new Point3d(_pntB.X, _pntB.Y-37.6, 0), new Point3d(_pntB.X+9.7, _pntB.Y-26.3, 0), new Point3d(_pntB.X+9.7, _pntB.Y-11.3, 0), new Point3d(_pntB.X, _pntB.Y, 0) }; return new Polyline3d(octoPoints); } //Draws three balls instead of an octagon, can not earn in NanoCAD 8.X public void DrawThreeBalls(Point3d _pntB) { CircArc3d circarcRed = new CircArc3d(_pntB.Subtract(new Vector3d(30, 100, 0)), Vector3d.ZAxis, 15); DbCircArc dbCircarcRed = circarcRed;//implicit dbCircarcRed.DbEntity.AddToCurrentDocument(); Hatch hatchCirkRed = new Hatch(circarcRed, 0, 1, false); hatchCirkRed.PattType = PatternType.PreDefined; hatchCirkRed.PatternName = "SOLID"; DbGeometry dbhatchCirkRed = new DbGeometry(); dbhatchCirkRed.Geometry = new EntityGeometry(hatchCirkRed); dbhatchCirkRed.DbEntity.Color = Color.Red; dbhatchCirkRed.DbEntity.AddToCurrentDocument(); CircArc3d circarcGreen = new CircArc3d(_pntB.Subtract(new Vector3d(-40, 200, 0)), Vector3d.ZAxis, 15); DbCircArc dbCircarcGreen = circarcGreen;//implicit dbCircarcGreen.DbEntity.AddToCurrentDocument(); Hatch hatchCirkGreen = new Hatch(circarcGreen, 0, 1, false); hatchCirkGreen.PattType = PatternType.PreDefined; hatchCirkGreen.PatternName = "SOLID"; DbGeometry dbhatchCirkGreen = new DbGeometry(); dbhatchCirkGreen.Geometry = new EntityGeometry(hatchCirkGreen); dbhatchCirkGreen.DbEntity.Color = Color.LightSeaGreen; dbhatchCirkGreen.DbEntity.AddToCurrentDocument(); CircArc3d circarcBlue = new CircArc3d(_pntB.Subtract(new Vector3d(-12, 350, 0)), Vector3d.ZAxis, 15); DbCircArc dbCircarcBlue = circarcBlue;//implicit dbCircarcBlue.DbEntity.AddToCurrentDocument(); Hatch hatchCirkBlue = new Hatch(circarcBlue, 0, 1, false); hatchCirkBlue.PattType = PatternType.PreDefined; hatchCirkBlue.PatternName = "SOLID"; DbGeometry dbhatchCirkBlue = new DbGeometry(); dbhatchCirkBlue.Geometry = new EntityGeometry(hatchCirkBlue); dbhatchCirkBlue.DbEntity.Color = Color.Blue; dbhatchCirkBlue.DbEntity.AddToCurrentDocument(); } } }</span></span></code> </pre> </div></div><br>  In theory, this code should work and in NC 8.X you only need to select .NET Framework 4.0 to include mapibasetypes.dll and mapimgd.dll in the project from the include folder of the corresponding bitness (x64 or x86) and replace one line (where is the corresponding comment, and also comment or delete the DrawThreeBalls method <br><br>  It turns out like this: <br><br><div class="spoiler">  <b class="spoiler_title">Full code for NC 8.X on C #</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Use Microsoft .NET Framework 4 and old version of MultiCad.NET (for NC 8.X) //Class for demonstrating the capabilities of MultiCad.NET //Assembly for the Nanocad 8.X //Link mapimgd and mapibasetypes from Nanocad SDK //Link System.Windows.Forms and System.Drawing //The commands: draws a christmas three. //This code in the part of non-infringing rights Nanosoft can be used and distributed in any accessible ways. //For the consequences of the code application, the developer is not responsible. using System.Collections.Generic; using System.Linq; using Multicad.Runtime; using Multicad.DatabaseServices; using Multicad.Geometry; using Multicad.DatabaseServices.StandardObjects; using System.Drawing; using System.Windows.Forms; namespace XmasThree { class XmasThree { [CommandMethod("DXThree", CommandFlags.NoCheck | CommandFlags.NoPrefix)] public void DrawXThree() { Point3d _pntBase; Point3d _bufPnt; //prompts for installation point entry InputJig jig = new InputJig(); // Get the first box point from the jig InputResult res = jig.GetPoint("Select first point:"); //It works only if input was successful if (res.Result == InputResult.ResultCode.Normal) { // The base point is taken from the entry point (click with mouse) _pntBase = res.Point; //Draw the outline of the left half of the Christmas tree //Create base points for the polyline List&lt;Point3d&gt; leftPatrOfThreePoints = new List&lt;Point3d&gt;() { new Point3d(_pntBase.X, _pntBase.Y, 0), new Point3d(_pntBase.X-125, _pntBase.Y-154, 0), new Point3d(_pntBase.X-31, _pntBase.Y-137, 0), new Point3d(_pntBase.X-181, _pntBase.Y-287, 0), new Point3d(_pntBase.X-31, _pntBase.Y-253, 0), new Point3d(_pntBase.X-242, _pntBase.Y-400, 0), new Point3d(_pntBase.X-37, _pntBase.Y-400, 0), new Point3d(_pntBase.X-37, _pntBase.Y-454, 0), new Point3d(_pntBase.X, _pntBase.Y-454, 0) }; //Create a polyline (geometry) Polyline3d leftPatrOfThree = new Polyline3d(leftPatrOfThreePoints); //Create a polyline object and place it on the drawing DbPolyline XThreeLeft = new DbPolyline(); XThreeLeft.Polyline = new Polyline3d(leftPatrOfThree); XThreeLeft.Polyline.SetClosed(false); XThreeLeft.DbEntity.Color = Color.Green; XThreeLeft.DbEntity.AddToCurrentDocument(); //The right part of the tree is obtained by mirroring the left DbPolyline XThreeRight = new DbPolyline(); XThreeRight.DbEntity.Color = Color.Green; XThreeRight.Polyline = (Polyline3d)XThreeLeft.Polyline.Mirror(new Plane3d(_pntBase, new Vector3d(10, 0, 0))); XThreeRight.DbEntity.AddToCurrentDocument(); //From the right and left sides we make a single contour for hatching DbPolyline XThreeR = new DbPolyline(); XThreeR.DbEntity.Color = Color.Green; XThreeR.Polyline = XThreeRight.Polyline.Clone() as Polyline3d; // for NC 8.5 //XThreeR.Polyline = XThreeRight.Polyline.GetCopy() as Polyline3d; //FOR NC 5.1 XThreeR.DbEntity.AddToCurrentDocument(); List&lt;Point3d&gt; hatchPoints = new List&lt;Point3d&gt;(); hatchPoints.AddRange(leftPatrOfThreePoints); hatchPoints.AddRange(XThreeR.Polyline.Points.Reverse().ToList()); Polyline3d hatchContur = new Polyline3d(hatchPoints); //We will create on the basis of a contour a hatch (geometry) with continuous filling Hatch hatch = new Hatch(hatchContur, 0, 10, true); hatch.PattType = PatternType.PreDefined; hatch.PatternName = "SOLID"; //Based on the geometry of the hatch, we create the document object, set its color properties - green DbGeometry dbhatch = new DbGeometry(); dbhatch.Geometry = new EntityGeometry(hatch); dbhatch.DbEntity.Color = Color.Green; dbhatch.DbEntity.AddToCurrentDocument(); // if you want you can try to draw balls with circles use // DrawThreeBalls(_pntBase); //Similarly, make a Christmas tree toy (octagon) //red _bufPnt = _pntBase.Subtract(new Vector3d(30, 95, 0)); DbPolyline dbOctoRed = DrawThreeOctogonPl(_bufPnt);//implicit dbOctoRed.DbEntity.AddToCurrentDocument(); Hatch hatchCirkRed = new Hatch(dbOctoRed.Polyline, 0, 1, false); hatchCirkRed.PattType = PatternType.PreDefined; hatchCirkRed.PatternName = "SOLID"; DbGeometry dbhatchCirkRed = new DbGeometry(); dbhatchCirkRed.Geometry = new EntityGeometry(hatchCirkRed); dbhatchCirkRed.DbEntity.Color = Color.Red; dbhatchCirkRed.DbEntity.AddToCurrentDocument(); //green _bufPnt = _pntBase.Subtract(new Vector3d(-40, 200, 0)); DbPolyline dbOctoGreen = DrawThreeOctogonPl(_bufPnt);//implicit dbOctoGreen.DbEntity.AddToCurrentDocument(); Hatch hatchCirkGreen = new Hatch(dbOctoGreen.Polyline, 0, 1, false); hatchCirkGreen.PattType = PatternType.PreDefined; hatchCirkGreen.PatternName = "SOLID"; DbGeometry dbhatchCirkGreen = new DbGeometry(); dbhatchCirkGreen.Geometry = new EntityGeometry(hatchCirkGreen); dbhatchCirkGreen.DbEntity.Color = Color.LightSeaGreen; dbhatchCirkGreen.DbEntity.AddToCurrentDocument(); //blue _bufPnt = _pntBase.Subtract(new Vector3d(-12, 350, 0)); DbPolyline dbOctoBlue = DrawThreeOctogonPl(_bufPnt);//implicit dbOctoBlue.DbEntity.AddToCurrentDocument(); Hatch hatchCirkBlue = new Hatch(dbOctoBlue.Polyline, 0, 1, false); hatchCirkBlue.PattType = PatternType.PreDefined; hatchCirkBlue.PatternName = "SOLID"; DbGeometry dbhatchCirkBlue = new DbGeometry(); dbhatchCirkBlue.Geometry = new EntityGeometry(hatchCirkBlue); dbhatchCirkBlue.DbEntity.Color = Color.Blue; dbhatchCirkBlue.DbEntity.AddToCurrentDocument(); //display the text with congratulations MessageBox.Show("I Wish You A Merry Christmas And Happy New Year!"); } } public Polyline3d DrawThreeOctogonPl(Point3d _pntB) { //Create points for an octagon List&lt;Point3d&gt; octoPoints = new List&lt;Point3d&gt;() { new Point3d(_pntB.X, _pntB.Y, 0), new Point3d(_pntB.X-15, _pntB.Y, 0), new Point3d(_pntB.X-25, _pntB.Y-11.3, 0), new Point3d(_pntB.X-25, _pntB.Y-26.3, 0), new Point3d(_pntB.X-15, _pntB.Y-37.6, 0), new Point3d(_pntB.X, _pntB.Y-37.6, 0), new Point3d(_pntB.X+9.7, _pntB.Y-26.3, 0), new Point3d(_pntB.X+9.7, _pntB.Y-11.3, 0), new Point3d(_pntB.X, _pntB.Y, 0) }; return new Polyline3d(octoPoints); } } }</span></span></code> </pre></div></div><br><a name="III"></a><br><h2>  Part III: write code in VB </h2><br>  Despite the fact that the process of creating a project in Visual Studio 2015 for VB.NET is almost completely identical to the creation of a project for C # given that people who lack the necessary skills can read the article, we‚Äôll still analyze this point in more detail. <br><br>  To begin with, we will create a new project, select the VB.NET class library and select .NET Framework 3.5 (for NC 8.X version 4.0) <br><br><img src="https://habrastorage.org/webt/fm/ad/nm/fmadnmmmxkgmg8mnck-qx4y_7x0.png"><br><br>  Then click RMB on the ‚Äúlinks‚Äù button on the right and add links to the libraries that you installed along with the SDK for any version of NanoCAD. <br><br>  For this project, we only need mapimgd (for NC 8.5, we also need mapibasetypes). <br>  You will also need to download the standard System.Windows.Forms and System.Drawing <br><br><img src="https://habrastorage.org/webt/em/mm/bi/emmmbia3d-imamurapfx7adz_xg.png"><br><br>  Do not forget to remove the checkmark from the property "copy locally" <br><br><img src="https://habrastorage.org/webt/ku/kr/uj/kukrujvw9md2rmtf9s6piavwbei.png"><br><br>  Then we will configure the project by clicking on it with PKM and selecting the "properties" button <br>  And for the convenience of debugging, we will configure the launch of the Nanocad by pressing the ‚ÄúF5‚Äù key <br><br><img src="https://habrastorage.org/webt/5x/as/vf/5xasvfluwkm3aapkqunired5eta.png"><br><br>  (each time you make changes to the code, the Nankad will need to be restarted completely) <br><br>  To load your library, enter the Netload command in the NanoCAD console and select the compiled dll (usually lies in the project folder, for example, C: \ Users \ b \ Dev \ habr \ XMTree \ XMTree \ bin \ Debug) <br><br>  In order not to do this each time, we‚Äôll go to C: \ ProgramData \ Nanosoft \ nanoCAD 5.1 \ DataRW (you may be different) and find or create a load.config file with the following content: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"C:\Users\...\bin\Debug\ .dll"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Then the libraries will be loaded automatically when the program starts. <br><br>  As I said, I don‚Äôt know VB.NET at all, but as it turned out, if you know a little C # and let all the rough work to do the code converter from C # to VB (for example, <a href="http://kbyte.ru/ru/Services/Converter.aspx">this one</a> ), then for our task there is no special knowledge will need, it will remain only a little tweak. <br><br>  I will place the full command code under the spoiler, and then analyze it in parts. <br><br><div class="spoiler">  <b class="spoiler_title">Full code for NC 5.1 on VB.NET</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">Imports <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic Imports Multicad.Runtime Imports Multicad.DatabaseServices Imports Multicad.Geometry Imports Multicad.DatabaseServices.StandardObjects Imports <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Drawing Imports <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Forms Namespace XmasThree <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> XmasThree &lt;CommandMethod("DXThree", CommandFlags.NoCheck <span class="hljs-keyword"><span class="hljs-keyword">Or</span></span> CommandFlags.NoPrefix)&gt; <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Sub DrawXThree() Dim _pntBase <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Point3d Dim _bufPnt <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Point3d Dim jig <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> InputJig() <span class="hljs-string"><span class="hljs-string">'prompts for installation point entry Dim res As InputResult = jig.GetPoint("Select first point:") If res.Result = InputResult.ResultCode.Normal Then '</span></span>The base <span class="hljs-type"><span class="hljs-type">point</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> taken <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> the entry <span class="hljs-type"><span class="hljs-type">point</span></span> (click <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> mouse) _pntBase = res.Point <span class="hljs-string"><span class="hljs-string">'Draw the outline of the left half of the Christmas tree '</span></span><span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> base points <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the polyline Dim leftPatrOfThreePoints <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> Point3d)() <span class="hljs-keyword"><span class="hljs-keyword">From</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X, _pntBase.Y, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">125</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">154</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">31</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">137</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">181</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">287</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">31</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">253</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">242</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">37</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">37</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">454</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">454</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) } <span class="hljs-string"><span class="hljs-string">'Create a polyline (geometry) Dim leftPatrOfThree As New Polyline3d(leftPatrOfThreePoints) '</span></span><span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> a polyline <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> place it <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the drawing Dim XThreeLeft <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> DbPolyline() XThreeLeft.Polyline = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Polyline3d(leftPatrOfThree) XThreeLeft.Polyline.SetClosed(<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) XThreeLeft.DbEntity.Color = Color.Green XThreeLeft.DbEntity.AddToCurrentDocument() Dim XThreeRight <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> DbPolyline() XThreeRight.DbEntity.Color = Color.Green XThreeRight.Polyline = DirectCast(XThreeLeft.Polyline.Mirror(<span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Plane3d(_pntBase, <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Vector3d(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>))), Polyline3d) XThreeRight.DbEntity.AddToCurrentDocument() <span class="hljs-string"><span class="hljs-string">'From the right and left sides we make a single contour for hatching Dim XThreeR As New DbPolyline() XThreeR.DbEntity.Color = Color.Green XThreeR.Polyline = TryCast(XThreeRight.Polyline.GetCopy(), Polyline3d) XThreeR.DbEntity.AddToCurrentDocument() Dim hatchPoints As New List(Of Point3d)() hatchPoints.AddRange(leftPatrOfThreePoints) hatchPoints.AddRange(XThreeR.Polyline.Points.Reverse().ToList()) Dim hatchContur As New Polyline3d(hatchPoints) '</span></span>We will <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the basis <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a contour a hatch (geometry) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> continuous filling Dim hatch <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Hatch(hatchContur, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) hatch.PattType = PatternType.PreDefined hatch.PatternName = "SOLID" <span class="hljs-string"><span class="hljs-string">'Based on the geometry of the hatch, we create the document object, set its color properties - green Dim dbhatch As New DbGeometry() dbhatch.Geometry = New EntityGeometry(hatch) dbhatch.DbEntity.Color = Color.Green dbhatch.DbEntity.AddToCurrentDocument() '</span></span>Similarly, make a Christmas tree toy (octagon) <span class="hljs-string"><span class="hljs-string">'red _bufPnt = _pntBase.Subtract(New Vector3d(30, 95, 0)) Dim dbOctoRed As DbPolyline = DrawThreeOctogonPl(_bufPnt) dbOctoRed.DbEntity.AddToCurrentDocument() Dim hatchCirkRed As New Hatch(dbOctoRed.Polyline, 0, 1, False) hatchCirkRed.PattType = PatternType.PreDefined hatchCirkRed.PatternName = "SOLID" Dim dbhatchCirkRed As New DbGeometry() dbhatchCirkRed.Geometry = New EntityGeometry(hatchCirkRed) dbhatchCirkRed.DbEntity.Color = Color.Red dbhatchCirkRed.DbEntity.AddToCurrentDocument() '</span></span>green _bufPnt = _pntBase.Subtract(<span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Vector3d(<span class="hljs-number"><span class="hljs-number">-40</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)) Dim dbOctoGreen <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> DbPolyline = DrawThreeOctogonPl(_bufPnt) dbOctoGreen.DbEntity.AddToCurrentDocument() Dim hatchCirkGreen <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Hatch(dbOctoGreen.Polyline, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) hatchCirkGreen.PattType = PatternType.PreDefined hatchCirkGreen.PatternName = "SOLID" Dim dbhatchCirkGreen <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> DbGeometry() dbhatchCirkGreen.Geometry = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> EntityGeometry(hatchCirkGreen) dbhatchCirkGreen.DbEntity.Color = Color.LightSeaGreen dbhatchCirkGreen.DbEntity.AddToCurrentDocument() <span class="hljs-string"><span class="hljs-string">'blue _bufPnt = _pntBase.Subtract(New Vector3d(-12, 350, 0)) Dim dbOctoBlue As DbPolyline = DrawThreeOctogonPl(_bufPnt) dbOctoBlue.DbEntity.AddToCurrentDocument() Dim hatchCirkBlue As New Hatch(dbOctoBlue.Polyline, 0, 1, False) hatchCirkBlue.PattType = PatternType.PreDefined hatchCirkBlue.PatternName = "SOLID" Dim dbhatchCirkBlue As New DbGeometry() dbhatchCirkBlue.Geometry = New EntityGeometry(hatchCirkBlue) dbhatchCirkBlue.DbEntity.Color = Color.Blue dbhatchCirkBlue.DbEntity.AddToCurrentDocument() MessageBox.Show("I Wish You A Merry Christmas And Happy New Year!!!") End If End Sub Public Function DrawThreeOctogonPl(_pntB As Point3d) As Polyline3d '</span></span><span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> points <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> an octagon Dim octoPoints <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> Point3d)() <span class="hljs-keyword"><span class="hljs-keyword">From</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntB.X, _pntB.Y, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntB.X - <span class="hljs-number"><span class="hljs-number">15</span></span>, _pntB.Y, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntB.X - <span class="hljs-number"><span class="hljs-number">25</span></span>, _pntB.Y - <span class="hljs-number"><span class="hljs-number">11.3</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntB.X - <span class="hljs-number"><span class="hljs-number">25</span></span>, _pntB.Y - <span class="hljs-number"><span class="hljs-number">26.3</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntB.X - <span class="hljs-number"><span class="hljs-number">15</span></span>, _pntB.Y - <span class="hljs-number"><span class="hljs-number">37.6</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntB.X, _pntB.Y - <span class="hljs-number"><span class="hljs-number">37.6</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntB.X + <span class="hljs-number"><span class="hljs-number">9.7</span></span>, _pntB.Y - <span class="hljs-number"><span class="hljs-number">26.3</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntB.X + <span class="hljs-number"><span class="hljs-number">9.7</span></span>, _pntB.Y - <span class="hljs-number"><span class="hljs-number">11.3</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntB.X, _pntB.Y, <span class="hljs-number"><span class="hljs-number">0</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Polyline3d(octoPoints) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Namespace</code> </pre></div></div><br>  Despite the fact that the code is simple, let's analyze it in detail and in parts, for we have not done this for VB before. <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">Imports</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">System</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Collections</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Generic</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Imports</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Multicad</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Runtime</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Imports</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Multicad</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DatabaseServices</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Imports</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Multicad</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Geometry</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Imports</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Multicad</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DatabaseServices</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.StandardObjects</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Imports</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">System</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Drawing</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Imports</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">System</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Windows</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Forms</span></span></code> </pre><br>  Import the namespaces of the MultiCAD.NET API library to draw, as well as the Windows libraries to display a window and assign colors to the hatching. <br><br><pre> <code class="hljs pgsql">Namespace XmasThree <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> XmasThree</code> </pre><br>  Define namespace and class name <br><br><pre> <code class="hljs vbscript"> &lt;CommandMethod(<span class="hljs-string"><span class="hljs-string">"DXThree"</span></span>, CommandFlags.NoCheck <span class="hljs-keyword"><span class="hljs-keyword">Or</span></span> CommandFlags.NoPrefix)&gt; <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> DrawXThreeLeft()</code> </pre><br>  Create a command that will then be entered into the command line Nanocad and actually draw our Christmas tree. <br>  <i>&lt;CommandMethod ("DXThree"&gt;</i> - the name of the command, as we will call it from Nanocad, you can specify any, but better in short, in the appointment of the remaining flags, I'm not sure. <br>  <i>Public Sub DrawXThreeLeft ()</i> - the name of the function (method) for the command is already the internal logic invisible to the CAD user. <br><br><pre> <code class="hljs pgsql">Dim _pntBase <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Point3d Dim _bufPnt <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> Point3d</code> </pre><br>  We create class fields (variables) in order to store the coordinates of the insertion point and the coordinates of the insertion buffer point for Christmas tree decorations. <br><br><pre> <code class="hljs pgsql">Dim jig <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> InputJig() Dim res <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> InputResult = jig.GetPoint("Select first point:")</code> </pre><br>  Create a new object for input into the console and give the user an invitation to click the mouse on the screen to determine the insertion point. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> res.Result = InputResult.ResultCode.Normal <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> _pntBase = res.Point</code> </pre><br>  If the input is successful, then the tree is drawn further; if not, nothing is done. <br><br><pre> <code class="hljs pgsql"> Dim leftPatrOfThreePoints <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> Point3d)() <span class="hljs-keyword"><span class="hljs-keyword">From</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X, _pntBase.Y, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">125</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">154</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">31</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">137</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">181</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">287</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">31</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">253</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">242</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">37</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X - <span class="hljs-number"><span class="hljs-number">37</span></span>, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">454</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Point3d(_pntBase.X, _pntBase.Y - <span class="hljs-number"><span class="hljs-number">454</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) }</code> </pre><br>  Create a list with points that define the vertices of the polyline (the left half of the tree) <br><br><pre> <code class="hljs pgsql"> <span class="hljs-string"><span class="hljs-string">'Create a polyline (geometry) Dim leftPatrOfThree As New Polyline3d(leftPatrOfThreePoints) '</span></span><span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> a polyline <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> place it <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the drawing Dim XThreeLeft <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> DbPolyline() XThreeLeft.Polyline = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Polyline3d(leftPatrOfThree) XThreeLeft.Polyline.SetClosed(<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) XThreeLeft.DbEntity.Color = Color.Green XThreeLeft.DbEntity.AddToCurrentDocument()</code> </pre><br>  First we create the geometry (not visible on the screen) for the left half of the tree, and then we create the document object, which we end up with in the drawing model space with the <i>XThreeLeft.DbEntity.AddToCurrentDocument ()</i> command. <br><br><pre> <code class="hljs pgsql"> Dim XThreeRight <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> DbPolyline() XThreeRight.DbEntity.Color = Color.Green XThreeRight.Polyline = DirectCast(XThreeLeft.Polyline.Mirror(<span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Plane3d(_pntBase, <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Vector3d(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>))), Polyline3d) XThreeRight.DbEntity.AddToCurrentDocument()</code> </pre><br>  In order to make the right half of the tree, simply mirror the left one (analogue of the mirror command in NanoCAD itself).  To do this, call the Mirror method at the polyline with the left half of the tree and do not forget to cast the type to Polyline3d using the DirectCast command. <br><br><pre> <code class="hljs pgsql"> Dim XThreeRight <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> DbPolyline() XThreeRight.DbEntity.Color = Color.Green XThreeRight.Polyline = DirectCast(XThreeLeft.Polyline.Mirror(<span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Plane3d(_pntBase, <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Vector3d(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>))), Polyline3d) XThreeRight.DbEntity.AddToCurrentDocument()</code> </pre><br>  Strangely enough, I didn‚Äôt find hatching references directly in the MultiCAD.NET API help in the NC 5.1 SDK, although they are in the documentation for the usual .NET API, but nonetheless the hatching seems to be implemented in the MultiCAD.NET API so the code below at least works fine for me. <br><br><pre> <code class="hljs pgsql"> Dim XThreeR <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> DbPolyline() XThreeR.DbEntity.Color = Color.Green XThreeR.Polyline = TryCast(XThreeRight.Polyline.GetCopy(), Polyline3d) XThreeR.DbEntity.AddToCurrentDocument() Dim hatchPoints <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> List(<span class="hljs-keyword"><span class="hljs-keyword">Of</span></span> Point3d)() hatchPoints.AddRange(leftPatrOfThreePoints) hatchPoints.AddRange(XThreeR.Polyline.Points.Reverse().ToList()) Dim hatchContur <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Polyline3d(hatchPoints)</code> </pre><br>  To begin with, we merge the points of the left and right half of the tree, and in order for the line to close in the correct order, the array of vertices for the right half must be ‚Äúflipped‚Äù so that the vertices go in the reverse order. <br><br>  Then, using the list of points, create the geometry of poly lines using the usual way. <br>  <i>Here the code is a bit redundant, you can rewrite it yourself neatly</i> <br><br><pre> <code class="hljs sql"> 'We will <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the basis <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a contour a hatch (geometry) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> continuous filling Dim hatch <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Hatch(hatchContur, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-literal"><span class="hljs-literal">True</span></span>) hatch.PattType = PatternType.PreDefined hatch.PatternName = <span class="hljs-string"><span class="hljs-string">"SOLID"</span></span></code> </pre><br>  Create a geometry for hatching, using our complete spruce contour.  As the type of hatching, select the solid fill (the names of the hatchings can be spied on in the Nanocad itself by selecting the ‚Äúhatching‚Äù command). <br><br><pre> <code class="hljs pgsql"> Dim dbhatch <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> DbGeometry() dbhatch.Geometry = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> EntityGeometry(hatch) dbhatch.DbEntity.Color = Color.Green dbhatch.DbEntity.AddToCurrentDocument()</code> </pre><br>  Now we will create a drawing object, which we will place in the model space, having previously set it a green color. <br><br>  We will hang out our Christmas tree toys.  It was originally supposed to shade the balls, but the advice on shading the circle from the developers forum only works for the C # version of the code and only in NC 5.1, so we will hatch the 8 squares. <br><br><pre> <code class="hljs pgsql"> <span class="hljs-string"><span class="hljs-string">'Similarly, make a Christmas tree toy (octagon) '</span></span>red _bufPnt = _pntBase.Subtract(<span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Vector3d(<span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">95</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)) Dim dbOctoRed <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> DbPolyline = DrawThreeOctogonPl(_bufPnt) dbOctoRed.DbEntity.AddToCurrentDocument() Dim hatchCirkRed <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> Hatch(dbOctoRed.Polyline, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) hatchCirkRed.PattType = PatternType.PreDefined hatchCirkRed.PatternName = "SOLID" Dim dbhatchCirkRed <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> DbGeometry() dbhatchCirkRed.Geometry = <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> EntityGeometry(hatchCirkRed) dbhatchCirkRed.DbEntity.Color = Color.Red dbhatchCirkRed.DbEntity.AddToCurrentDocument()</code> </pre><br>  The whole process is identical to what we did earlier, the only difference is that in order to reduce the amount of code we created the polyline for the octagon in a separate method <i>DrawThreeOctogonPl</i> <br>  There will be three such ‚Äúballs‚Äù (red, green, blue), I think it makes no sense to separate them separately. <br><br>  The last thing left is to bring out a window with congratulations. <br><br><pre> <code class="hljs pgsql"> MessageBox.<span class="hljs-keyword"><span class="hljs-keyword">Show</span></span>("I Wish You a Merry Christmas and Happy New Year!!!") <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub</code> </pre><br>  As a result, we get the following picture. <br>  For NC 5.1 <br><br><img src="https://habrastorage.org/webt/gd/fr/1f/gdfr1ful5stwb6dmsocbuo9ftxw.png"><br><br>  For NC 8.1 <br><br><img src="https://habrastorage.org/webt/jg/da/o3/jgdao3jwybnsgwdl_vvfq3kkvne.png"><br><br><a name="IV"></a><br><h2>  Part IV: with the Coming! </h2><br>  Well, maybe someone will say that we have now made useless and useless ‚Äúnonsense‚Äù to anyone ... <br><br><img src="https://habrastorage.org/webt/ea/su/2z/easu2zalwvny5-syxtfwaezchls.png" title="nonsense" alt=""><br><br>  And that this is again another article for beginners, which has no place on Habr√©. <br><br> ,          ,       , -   ,      Basic <i>(          Pascal)</i> .            Basic        ,      <a href="https://habrahabr.ru/hub/smallbasic/">SmallBasic</a> <br><br>  ,   NC 5.1     ,     NanoCAD    <a href="http://www.nanocad.ru/information/news/312530/">  </a> ,                           . <br><br> <i>    ,  NC                API,       <a href="https://habrahabr.ru/company/ascon/blog/328088/">¬´¬ª</a></i> <br><br>    <b> ,   </b>   2018 ! <br>  ,       2018      NanoCAD,   API    NET Framework. <br><br> <b>PS</b> !                   API  Nanocad 8.X. <br><br>         Windows 10  64   NanoCAD    (  ).       C#  ¬´  ¬ª. <br><br>  32     ,     ,       Windows 10    . </div><p>Source: <a href="https://habr.com/ru/post/345834/">https://habr.com/ru/post/345834/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345822/index.html">Defining a file format with Python</a></li>
<li><a href="../345824/index.html">Parallel data sorting in GPU</a></li>
<li><a href="../345826/index.html">ThreeFlow branch strategy</a></li>
<li><a href="../345830/index.html"># Acceleration4X. Principle number 0/1. Variable environment</a></li>
<li><a href="../345832/index.html">Issue # 5: IT training - current issues and challenges from leading companies</a></li>
<li><a href="../345836/index.html">Richard Hamming: The Basics of the Digital (Discrete) Revolution</a></li>
<li><a href="../345840/index.html">‚ÄúWishes‚Äù for 1C</a></li>
<li><a href="../345842/index.html">Docker self-organizing service infrastructure</a></li>
<li><a href="../345844/index.html">Install and update the Let's encrypt certificate for Zimbra mail server</a></li>
<li><a href="../345846/index.html">Whose is the text, Linus or Greg?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>