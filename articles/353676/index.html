<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attention! S in Ethereum stands for Security. Part 4. Tools</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We present the fourth part of the cycle devoted to typical vulnerabilities, attacks and problem areas, which are inherent in smart contracts in the So...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attention! S in Ethereum stands for Security. Part 4. Tools</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/in/zq/uo/inzquo0audtrhbdg1qvixrao4ya.jpeg"></p><br><p>  We present the fourth part of the cycle devoted to typical vulnerabilities, attacks and problem areas, which are inherent in smart contracts in the Solidity language and on the Ethereum platform as a whole.  Here we will talk about what tools for analyzing the security of smart contracts exist, and why they are (not) needed. </p><a name="habracut"></a><br><p>  In the <a href="https://habrahabr.ru/company/dsec/blog/345196/">first</a> part, we discussed the front-running attack, various random number generation algorithms and network resiliency with the Proof-of-Authority consensus.  The <a href="https://habrahabr.ru/company/dsec/blog/346408/">second</a> talked about Integer overflow, ABI encoding / decoding, Uninitialized storage pointer, Type Confusion and how to make a backdoor.  In the <a href="https://habrahabr.ru/company/dsec/blog/347110/">third</a> part, we touched upon several distinctive features of Solidity and explored some logical vulnerabilities found in contracts.  In this part we bring to your attention a review of existing tools for analyzing smart contracts. </p><br><p>  All the tools we have divided into several categories that allow you to do: </p><br><ul><li>  <a href="https://habr.com/ru/company/dsec/blog/353676/">debugging</a> ; </li><li>  <a href="https://habr.com/ru/company/dsec/blog/353676/">automatic vulnerability scan</a> ; </li><li>  reverse engineering; </li><li>  <a href="https://habr.com/ru/company/dsec/blog/353676/">testing</a> </li></ul><br><p>  Next we touch each of them.  Some of the tools work only with the source code of the smart contract, others without it.  And at once we will make a reservation that it will be a question only of those tools which are known to us, is in open access, and with which we worked.  If you have experience with any other tools on this subject, then you are welcome in the comments :) </p><br><h2 id="otladka">  Debugging </h2><br><p>  Currently, there is only one (or the only convenient) possibility to debug a smart contract with the source code - <a href="http://remix.ethereum.org/">Remix IDE</a> .  And if you need to understand bytecode, <a href="https://github.com/radare/radare2">Radare2</a> or <a href="https://github.com/ConsenSys/mythril-trace-explorer">MythrilTraceExplorer</a> can help <a href="https://github.com/ConsenSys/mythril-trace-explorer">you</a> . </p><br><h3 id="remix-idehttpsremixethereumorg">  <a href="https://remix.ethereum.org/">Remix IDE</a> </h3><br><p>  If you are a developer, most often you will use Remix for debugging (most likely, you do so).  It is very convenient to track the state of local variables (stack), the state of memory, storage, consumed gas and much more. </p><br><table><thead><tr><th><img src="https://habrastorage.org/webt/if/oe/rp/ifoerpptzjvkhajt-0sayktljue.png"></th></tr></thead><tbody><tr><td>  <em>Figure 1. Remix IDE interface</em> </td></tr></tbody></table><br><p>  If the contents of the "Storage completely loaded" tab scare you, we advise you to deal with the <a href="http://solidity.readthedocs.io/en/develop/miscellaneous.html">storage</a> device.  Of the minuses can be noted perhaps that the periodic <a href="https://github.com/ethereum/remix/issues/776">bugs</a> in the JavaScript VM and the fact that if you use assembler inserts, then line-by-line debugging you can hardly hope. </p><br><h3 id="radare2httpsgithubcomradareradare2">  <a href="https://github.com/radare/radare2">Radare2</a> </h3><br><p>  If you do not like Remix, but adore the console, then try Radare2.  With it, you can disassemble and debug contracts.  For debugging, traces are used (recorded transactions occurred).  The rpc radar connects to the node ( <a href="https://github.com/trufflesuite/ganache-cli">ganache-cli is</a> convenient) and tightens the data necessary to repeat the transaction. </p><br><p>  In graphics mode, you can open tiles with the contents of the stack and memory: </p><br><table><thead><tr><th><img src="https://habrastorage.org/webt/tq/xn/s5/tqxns5ijlj1-cyfa0xlsf4xhios.png"></th></tr></thead><tbody><tr><td>  <em>Figure 2. Radare 2 Interface</em> </td></tr></tbody></table><br><p>  You can set breakpoints and write to memory, but we did not find a way to look into storage or modify it. </p><br><p>  The Positive Technologies guys have examples of using Radare to <a href="https://blog.positive.com/reversing-evm-bytecode-with-radare2-ab77247e5e53">disassemble</a> and <a href="https://blog.positive.com/debugging-evm-bytecode-with-radare2-9e0e13cbd936">debug</a> contracts.  Since the radar is not the most intuitive tool, we advise you to take a look and get acquainted with its commands. </p><br><h2 id="avtomaticheskiy-poisk-uyazvimostey">  Automatic vulnerability scan </h2><br><p>  Before we have already been a <a href="https://consensys.net/diligence/evm-analyzer-benchmark-suite/">comparison of the</a> three tools - Mythrill, Manticore and Oyente.  According to the results of this analysis, Mythrill is in the lead, and Oyente is the worst.  During the tests, the authors "fed" the tools with contract source codes, so the results do not reflect how well they cope with raw bytecode, but mostly coincide with our impressions. </p><br><h3 id="mythrilhttpsgithubcomconsensysmythril">  <a href="https://github.com/ConsenSys/mythril">Mythril</a> </h3><br><p>  Mythril has broad functionality, including for analyzing both the source code and the bytecode of smart contracts.  It is noteworthy that it can also work on-chain, that is, online to connect to the node, download the contract and analyze it.  He is also a disassembler and can build good graphs (but be careful, he often does it incorrectly, so better try Ethersplay or IDA-EVM).  Mythril can also generate a state for a tool called MythrilTraceExplorer, which allows you to debug a smart contract bytecode with character variables: </p><br><table><thead><tr><th><img src="https://habrastorage.org/webt/6r/zs/ha/6rzshasvgsvv2ff3eeddrxpan1e.png"></th></tr></thead><tbody><tr><td>  <em>Figure 3. MythrilTraceExplorer interface</em> </td></tr></tbody></table><br><p>  A full list of Mythil and MythrilTraceExplorer options can be found in the <a href="https://github.com/ConsenSys/mythril/wiki/Installation-and-Setup">documentation</a> , and you can find the secret flag that isn't in it <a href="https://github.com/b-mueller/smashing-smart-contracts/blob/master/smashing-smart-contracts-1of1.pdf">here</a> . </p><br><p> Take the <code>eth_tx_order_dependence_minimal</code> contract from <a href="https://consensys.net/diligence/evm-analyzer-benchmark-suite/">Consensys</a> tests </p><br><div class="spoiler">  <b class="spoiler_title">Source eth_tx_order_dependence_minimal</b> <div class="spoiler_text"><pre> <code class="javascript hljs">contract Benchmark { address public owner; bool public claimed; uint public reward; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Benchmark</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span></span>{ owner = msg.sender; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setReward</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">payable</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">require</span></span> (!claimed); <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(msg.sender == owner); owner.transfer(reward); reward = msg.value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">claimReward</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">uint256 submission</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">require</span></span> (!claimed); <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(submission &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>); msg.sender.transfer(reward); claimed = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } }</code> </pre> </div></div><br><p>  and see how Mythril handles with source codes: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">user</span></span>% myth -x eth_tx_order_dependence_minimal.sol ==== Ether send ==== <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Warning</span></span> Contract: Benchmark <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>: claimReward(uint256) PC address: <span class="hljs-number"><span class="hljs-number">693</span></span> <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-string"><span class="hljs-string">'claimReward(uint256)'</span></span> a non-zero amount <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> Ether <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> sent <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> msg.sender. <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> storage_1. There <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">storage</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-number"><span class="hljs-number">7.</span></span> This <span class="hljs-keyword"><span class="hljs-keyword">storage</span></span> slot can be written <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> calling the <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-string"><span class="hljs-string">'claimReward(uint256)'</span></span>. <span class="hljs-comment"><span class="hljs-comment">--------------------</span></span></code> </pre> <br><p>  and now without them: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">user</span></span>% myth -x -c <span class="hljs-number"><span class="hljs-number">60806040523.</span></span>.<span class="hljs-number"><span class="hljs-number">.5</span></span>f9dc0029 The analysis was completed successfully. <span class="hljs-keyword"><span class="hljs-keyword">No</span></span> issues were detected.</code> </pre> <br><p>  As you can see, the raw Mythril bytecode could not be analyzed. </p><br><h3 id="oyentehttpsgithubcommelonprojectoyente">  <a href="https://github.com/melonproject/oyente">Oyente</a> </h3><br><p>  A tool with its own character execution engine for detecting vulnerabilities in smart contracts, written in Python.  Not so long ago, developers have finally added output information about the input data, which will lead to the triggering of the problem.  The tool produces more or less adequate results only when analyzing contracts with source codes.  If you set it on baytkod, then it will cover only a small part of it and therefore, most likely, it will not find bugs. </p><br><p>  By analogy with Mythril, we put the experience on Oyente and see how well it looks for vulnerabilities with and without source codes: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">user</span></span>% oyente -s eth_tx_order_dependence_minimal.sol <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:root:contract eth_tx_order_dependence_minimal.sol:Benchmark: <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: ============ Results =========== <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: EVM Code Coverage: <span class="hljs-number"><span class="hljs-number">98.3</span></span>% <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: <span class="hljs-type"><span class="hljs-type">Integer</span></span> Underflow: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: <span class="hljs-type"><span class="hljs-type">Integer</span></span> Overflow: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: Parity Multisig Bug <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: Callstack Depth Attack Vulnerability: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: <span class="hljs-keyword"><span class="hljs-keyword">Transaction</span></span>-Ordering Dependence (TOD): <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: <span class="hljs-type"><span class="hljs-type">Timestamp</span></span> Dependency: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: Re-Entrancy Vulnerability: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec:Flow1 eth_tx_order_dependence_minimal.sol:<span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Warning</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Transaction</span></span>-Ordering Dependency. <span class="hljs-keyword"><span class="hljs-keyword">owner</span></span>.transfer(reward) Flow2 eth_tx_order_dependence_minimal.sol:<span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Warning</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Transaction</span></span>-Ordering Dependency. msg.sender.transfer(reward) <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: ====== Analysis Completed ======</code> </pre><br><p>  Now let's set the bytecode of this contract: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">user</span></span>% oyente -b -s eth_tx_order_dependence_minimal.bin <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: ============ Results =========== <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: EVM Code Coverage: <span class="hljs-number"><span class="hljs-number">18.0</span></span>% <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: Callstack Depth Attack Vulnerability: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: <span class="hljs-keyword"><span class="hljs-keyword">Transaction</span></span>-Ordering Dependence (TOD): <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: <span class="hljs-type"><span class="hljs-type">Timestamp</span></span> Dependency: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: Re-Entrancy Vulnerability: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span>:oyente.symExec: ====== Analysis Completed ======</code> </pre> <br><p>  As you can see, the coverage has greatly decreased (from 98 to 18 percent) and the tool does not find problems with the contract. </p><br><p>  Developing Oyente is not easy due to (well, very) bad code.  For example, parameters from a module to a module are passed through global variables.  Most likely because no more than one and a half people work on the project. </p><br><p>  Just in case, it is worth keeping Oyente in your toolbox, but it is unknown whether it will develop and improve. </p><br><h3 id="porosityhttpsgithubcomcomaeioporosity">  <a href="https://github.com/comaeio/porosity">Porosity</a> </h3><br><p>  Perhaps, the most raspiarenny decompiler.  Its main feature is that it does not work. </p><br><p>  To demonstrate this feature, let's decompile the toy contract, which for the purity of the experiment will be compiled with the relatively old version of solc'a 0.4.12 of July 1, 2017.  Note that the last time Porosity was updated in January 2018, so you can expect that the tool will cope with our contract. </p><br><p>  Original: </p><br><pre> <code class="javascript hljs">contract sample { uint y; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foobar</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">uint x</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x == <span class="hljs-number"><span class="hljs-number">0</span></span>) { y = <span class="hljs-number"><span class="hljs-number">0x1337</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { y = <span class="hljs-number"><span class="hljs-number">0xb33f</span></span>; } } }</code> </pre> <br><p>  Unique decompiler output: </p><br><pre> <code class="javascript hljs">.\porosity.exe --code $binRuntime --decompile <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func_14ba3f12</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!msg.value) { } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arg_4 != <span class="hljs-number"><span class="hljs-number">0x0</span></span>) { store[var_xrpMC] = <span class="hljs-number"><span class="hljs-number">0xB33F</span></span>; } store[var_zdGc8] = <span class="hljs-number"><span class="hljs-number">0x1337</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; }</code> </pre> <br><p>  When you try to transfer abi, in order to make the tool easier to work with, Porosity will crash. </p><br><p>  We could not find the use of Porosity, all attempts to use ended with either receiving meaningless output, or the fall of the tool. </p><br><h3 id="manticorehttpsgithubcomtrailofbitsmanticore">  <a href="https://github.com/trailofbits/manticore">Manticore</a> </h3><br><p>  A tool for symbolic program execution.  Some time ago, EVM support was added to it and is being developed now (and if a <a href="https://twitter.com/trailofbits/status/1000057291922661376">permanent developer</a> appears, then things will go even faster).  There are a lot of chips in it, but they are not tested and most often do not work.  The project also has a rather poor documentation, but we hope that the community will soon correct this shortcoming. </p><br><p>  Before we look at examples of using Manticore, it‚Äôs worth explaining what symbolic execution is, and the slide from the presentation of Michael Hicks‚Äôs "Symbolic Execution for finding bugs" by: </p><br><table><thead><tr><th><img src="https://habrastorage.org/webt/jr/8k/h-/jr8kh-nqaujd24s4remtzcfx8h0.png" alt="image"></th></tr></thead><tbody><tr><td>  <em>Figure 4. Symbolic Execution for finding bugs.</em>  <em>Michael Hicks.</em> </td></tr></tbody></table><br><p>  Symbolic execution allows you to understand which input you need to submit to a function / program in order to be at a given point.  Roughly speaking, during the symbolic execution, all the restrictions (conditions) on the way of execution to a given point are collected, a formula is made up of these restrictions, and by solving this, we will get the input we need. </p><br><p>  For the demonstration, we will solve the "The Lock" <a href="https://etherhack.positive.com/">problem of the EtherHack</a> contest held at the Positive Hack Days 8 conference. The participants were not given the source code, but only the address of the contract.  To solve the task, it was necessary to call the contract with the correct pin-code (its check is implemented in the fallback).  The solution involved reverse engineering to understand the pin-code verification algorithm. </p><br><p>  Let's automate the solution to this problem.  However, we still have to take a look at the disassembled contract code in order to find out what will happen (or not happen) if the participant sends a valid PIN code.  Namely: it is worth noting that there is only one sstore instruction in the program, and we can safely assume that it will be executed if the casket key is selected correctly. </p><br><p>  Unfortunately, honestly solving the problem does not give bugs in Manticore (we sent bug reports to developers, we hope that errors will be fixed soon), so we have to get out - we rewrote the contract in the source code for Solidity and replaced it with a succession code by multiplications (due to Manticore's bugs, at the current moment it cannot emulate exponentiation with a symbolic base)  Of course, solving a task during a competition in such a perverted way is meaningless, but do not forget that we are simply demonstrating a tool!  And the presence of the source code does not simplify the work, because the symbolic execution does not work with it, but with bytecode. </p><br><p>  Enough excuses and blocking, let's take a look at the script: </p><br><div class="spoiler">  <b class="spoiler_title">the lock solver</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> manticore.ethereum <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ManticoreEVM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> manticore.core.smtlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Operators <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pack m = ManticoreEVM() m.verbosity(<span class="hljs-number"><span class="hljs-number">0</span></span>) contract_source_code = <span class="hljs-string"><span class="hljs-string">''' contract lock { uint public unlocked; function unlock(bytes4 cPincode) payable { uint digitPowers = 0; uint iPincode = 0; for (uint i = 0; i &lt; 4; i++) { if (cPincode[i] &gt;= 0x30 &amp;&amp; cPincode[i] &lt;= 0x39) { // manticore can't handle pow with symbolic input at the moment uint digit = (uint(cPincode[i]) - 0x30); digit *= digit; digit *= digit; digitPowers += digit; iPincode += (uint(cPincode[i]) - 0x30) * 10**(3-i); } else { revert(); } } if (uint(iPincode) == 0 || uint(iPincode) == 1) { revert(); } if (digitPowers == uint(iPincode)) { unlocked = 0x31337; } } } '''</span></span> user_account = m.create_account(balance=<span class="hljs-number"><span class="hljs-number">10</span></span>**<span class="hljs-number"><span class="hljs-number">18</span></span>) m.world.set_balance(user_account, <span class="hljs-number"><span class="hljs-number">10</span></span>**<span class="hljs-number"><span class="hljs-number">18</span></span>) contract_account = m.solidity_create_contract(contract_source_code, owner=user_account) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"[+] Created a contract account 0x%x"</span></span> % contract_account <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'[+] Sending transaction with symbolic input'</span></span> symbolic_data = m.make_symbolic_buffer(<span class="hljs-number"><span class="hljs-number">36</span></span>) m.transaction(caller=user_account, address=contract_account, data=symbolic_data, value=<span class="hljs-number"><span class="hljs-number">10</span></span>**<span class="hljs-number"><span class="hljs-number">18</span></span>) pincodes = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> state <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> m.all_states: world = state.platform <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> where, what <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> world.get_storage_items(int(contract_account)): _input = Operators.CONCAT(<span class="hljs-number"><span class="hljs-number">8</span></span>*<span class="hljs-number"><span class="hljs-number">4</span></span>, *world.human_transactions[<span class="hljs-number"><span class="hljs-number">-1</span></span>].data[<span class="hljs-number"><span class="hljs-number">4</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>]) <span class="hljs-comment"><span class="hljs-comment"># getting 4 bytes after function signature print '[+] Storage write 0x%x' % state.solve_one(what) pincodes = state.solve_n(_input, 10) print '[+] Found %i pincodes:' % len(pincodes) for pincode in sorted(pincodes): print ' "%s"' % pack('&gt;I', pincode) break if pincodes is not None: break</span></span></code> </pre> </div></div><br><p>  Running it, we get the following conclusion: </p><br><pre> <code class="hljs pgsql">[+] Created a contract account <span class="hljs-number"><span class="hljs-number">0x1bfa530d5d685155e98cd7d9dd23f7b6a801cfef</span></span> [+] Sending <span class="hljs-keyword"><span class="hljs-keyword">transaction</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> symbolic <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> [+] <span class="hljs-keyword"><span class="hljs-keyword">Storage</span></span> <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> <span class="hljs-number"><span class="hljs-number">0x31337</span></span> [+] <span class="hljs-built_in"><span class="hljs-built_in">Found</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> pincodes: "1634" "8208" "9474"</code> </pre> <br><p>  We will understand what is happening.  First, take a look at the contract code.  The unlock function accepts four bytes as input, in which it expects to see a textual representation of a four-digit decimal number.  Only those pin codes will fit, the sum of the digits in the fourth power of which is equal to the pin code itself, excluding zero and one.  Really, </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mn>1</mn><mn>4</mn></msup><mo>+</mo><msup><mn>6</mn><mn>4</mn></msup><mo>+</mo><msup><mn>3</mn><mn>4</mn></msup><mo>+</mo><msup><mn>4</mn><mn>4</mn></msup><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>$</mo></mrow><mn>163</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.136ex" height="2.66ex" viewBox="0 -987.6 10822.5 1145.2" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-31" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-34" x="707" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-2B" x="1176" y="0"></use><g transform="translate(2177,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-36" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-34" x="707" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-2B" x="3353" y="0"></use><g transform="translate(4354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-33" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-34" x="707" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-2B" x="5531" y="0"></use><g transform="translate(6532,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-34" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-34" x="707" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-3D" x="7764" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-24" x="8820" y="0"></use><g transform="translate(9321,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-36" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/dsec/blog/353676/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgE14BKus87UWLQLEU0eiRcukgP_Q#MJMAIN-33" x="1001" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mn>1</mn><mn>4</mn></msup><mo>+</mo><msup><mn>6</mn><mn>4</mn></msup><mo>+</mo><msup><mn>3</mn><mn>4</mn></msup><mo>+</mo><msup><mn>4</mn><mn>4</mn></msup><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>$</mo></mrow><mn>163</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> 1 ^ 4 + 6 ^ 4 + 3 ^ 4 + 4 ^ 4 = $ 163</script></p><br>  If the pin code meets these conditions, the number 0x31337 will be written to the <code>unlocked</code> variable located in storage. <br><p>  Now let's deal with the script.  What happens in the first part is easy to understand: a user account is created, then a contract.  A transaction is started with symbolic input.  This action will activate symbolic execution, which will take a couple of minutes.  Upon its completion, we go through all the final states, checking whether something was recorded in the storage, and if it was, find out what input data the transaction was performed with.  We extract from them the pin code, four bytes after the signature of the called function.  If we solved the problem and did not know how many digits in the pin code the contract expects, then we would get not four, but all thirty two bytes (the default size of the memory cell in EVM).  Then on the screen would see similar numbers: </p><br><pre> <code class="hljs">0x3136333434343434343434343434343434343434343434343434343434343434 0x3832303800000000000000000000000000000000000000000000000000000000</code> </pre> <br><p>  Using the results of the analysis of Manticore, we can not only solve toy puzzles, but also look for toy bugs in toy contracts, simply asking such naive questions like: "What do you need to send to the contract so that all the airings that contained the contract are on our address?" </p><br><p>  Let's look at an example with an unprotected wallet from the EthCC 2018 workshop: </p><br><div class="spoiler">  <b class="spoiler_title">UnprotectedWallet</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> manticore.ethereum <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ManticoreEVM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> manticore.core.smtlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> solver m = ManticoreEVM() <span class="hljs-comment"><span class="hljs-comment"># initiate the blockchain source_code = ''' contract UnprotectedWallet{ address public owner; modifier onlyowner { require(msg.sender==owner); _; } function UnprotectedWallet() public { owner = msg.sender; } // this function should be protected function changeOwner(address _newOwner) public { owner = _newOwner; } function deposit() payable public { } function withdraw() onlyowner public { msg.sender.transfer(this.balance); } } ''' # Generate the accounts. Creator has 10 ethers; attacker 0 creator_account = m.create_account(balance=10*10**18) attacker_account = m.create_account(balance=0) contract_account = m.solidity_create_contract(source_code, owner=creator_account) print "Creator account: 0x%x" % creator_account print "Attacker account: 0x%x" % attacker_account # Deposit 1 ether, from the creator contract_account.deposit(caller=creator_account, value=10**18) # Two raw transactions from the attacker symbolic_data = m.make_symbolic_buffer(320) m.transaction(caller=attacker_account, address=contract_account, data=symbolic_data, value=0) symbolic_data = m.make_symbolic_buffer(320) m.transaction(caller=attacker_account, address=contract_account, data=symbolic_data, value=0) for state in m.running_states: # Check if the attacker can ends with some ether balance = state.platform.get_balance(attacker_account) state.constrain(balance &gt; 1) if solver.check(state.constraints): print "Attacker can steal the ether! see %s"%m.workspace m.generate_testcase(state, 'WalletHack')</span></span></code> </pre> </div></div><br><p>  Obviously, the developers forgot to award changeOwner with the attribute onlyOwner.  Because of this, an attacker in two transactions can get funds.  As usual, all the fun is at the end of the script.  Enumerating the state, we ask the question: "In which of them did the attacker have coins?"  And Manticore is able to answer it.  We are looking for answers in the mcore_XXX folder in the WalletHack_00000000.tx file: </p><br><table><thead><tr><th><img src="https://habrastorage.org/webt/4l/gc/dc/4lgcdcnnrza1oatd10e7e7lqiuk.png" alt="image"></th></tr></thead><tbody><tr><td>  <em>Figure 5. Result of Manticore.</em> </td></tr></tbody></table><br><p>  If Manticore is not abandoned, it will grow into a good tool for flexible analysis of smart contracts, but now it is not yet ready to meet with the real world and real tasks. </p><br><h3 id="echidnahttpsgithubcomtrailofbitsechidna-fazing">  <a href="https://github.com/trailofbits/echidna">Echidna</a> (phasing) </h3><br><p>  Echidna is an experimental tool designed for fuzzing smart contracts.  However, this is not the fuzzy you might think about.  In order for Echidna to have the functions of a smart contract, you need to prepare your contract in a special way. </p><br><pre> <code class="hljs lua">//  contract EchidnaTest { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sensitiveFunc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint num, bool stop)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (num &gt; <span class="hljs-number"><span class="hljs-number">5</span></span> &amp;&amp; !stop) { selfdestruct(msg.sender); } } }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">after</b> <div class="spoiler_text"><pre> <code class="hljs cs">contract EchidnaTest { <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> num; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> stop; <span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">num_setter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> _num</span></span></span><span class="hljs-function">) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span> { num = _num; } <span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop_setter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> _stop</span></span></span><span class="hljs-function">) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span></span> { stop = _stop; } <span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">echidna_sensitiveFunc</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">returns</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (num &gt; <span class="hljs-number"><span class="hljs-number">5</span></span> &amp;&amp; stop) { selfdestruct(msg.sender); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } }</code> </pre></div></div><br><p>  In other words, you have to "unscrew" the function you want to map.  Echidna will do different call sequences for <code>num_setter</code> and <code>stop_setter</code> , and then <code>echidna_sensitiveFunc</code> .  Also note that Echidna is expecting (but obviously will not tell you) that your function will return <code>true</code> when everything goes well.  Thus, the ‚Äúwrong‚Äù behavior you can mark by returning <code>false</code> , <code>revert()</code> , <code>selfdestruct(0)</code> , etc. </p><br><pre> <code class="hljs ruby">p4lex@ubuntu<span class="hljs-symbol"><span class="hljs-symbol">:~/tools/echidna</span></span>$ echidna-test echid.sol ‚îÅ‚îÅ‚îÅ echid.sol ‚îÅ‚îÅ‚îÅ ‚úó <span class="hljs-string"><span class="hljs-string">"echidna_sensitiveFunc"</span></span> failed after <span class="hljs-number"><span class="hljs-number">23</span></span> tests <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">51</span></span> shrinks. ‚îÇ Call <span class="hljs-symbol"><span class="hljs-symbol">sequence:</span></span> num_setter(<span class="hljs-number"><span class="hljs-number">6</span></span>); ‚îÇ stop_setter(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); ‚úó <span class="hljs-number"><span class="hljs-number">1</span></span> failed.</code> </pre> <br><p>  It is also worth noting that you cannot specify some input data that Echidna will change, so for complex tasks the efficiency of such fuzzing leaves much to be desired.  But you probably noticed that you will have to rewrite every function that needs to be interpolated.  For the sake of fairness, it is worth noting that if you can write in Haskell, you can still set the input value generators so that they give a specific domain from a set of possible values ‚Äã‚Äã(for example, you know that <code>num</code> should be more than five). </p><br><p>  In general, fuzzing can give its results.  If a vulnerability is manifested only after a long chain of actions, symbolic execution will require a lot of CPU and memory costs, unlike fuzzing (which, however, will detect this vulnerability only with a certain probability).  More information about the approach used in Echidna can be found in <a href="https://blog.trailofbits.com/2018/05/03/state-machine-testing-with-echidna/">here</a> . </p><br><h3 id="smartcheckhttptoolsmartdecnet">  <a href="http://tool.smartdec.net/">SmartCheck</a> </h3><br><p>  A highly experimental, closed source tool that reentrancy is seen everywhere.  From the pleasant: you can simply copy your contract into the sending form or specify a link to the githab.  And since static code analysis is used, your contract is not even obliged to compile.  It looks like this: </p><br><table><thead><tr><th><img src="https://habrastorage.org/webt/9h/ke/ym/9hkeymjusofgs6rp5p87iawf9n8.png"></th></tr></thead><tbody><tr><td>  <em>Figure 6. SmartCheck Interface</em> </td></tr></tbody></table><br><p>  In this example, a balance reset occurs after the transfer of Ether, which is the signature for SmartCheck.  However, the use of the <code>send</code> and <code>transfer</code> functions in itself prevents reentrancy (we analyzed it in the <a href="https://habr.com/company/dsec/blog/347110/">third</a> part), so we see false positive in the screenshot above. </p><br><h2 id="obratnaya-razrabotka">  Reverse engineering </h2><br><p>  Since at the moment there are no working decompilers in open access, then in order to understand what logic a particular contract implements, you will have to revise.  In general, the hope that the decompiler will be there.  The first attempts were made at Porosity, and most likely the solution works, but, unfortunately, the guys from RET2 <a href="http://blog.ret2.io/2018/05/16/practical-eth-decompilation/">have a</a> closed one.  In the meantime, let's take a look at what we can do by being left alone with bytecode. </p><br><h3 id="evmdishttpsgithubcomarachnidevmdis">  <a href="https://github.com/Arachnid/evmdis">EVMdis</a> </h3><br><p>  The oldest and most convenient disassembler.  It cannot boast beautiful interfaces, but it has features that are not found in other tools: firstly, it minimizes instructions, instead of a sequence showing one more readable expression, and secondly, for each base unit, EVMdis shows the input stack into a block, including symbolized variables.  This greatly speeds up the process of understanding the logic of the code, because without this data, the stack state would have to be restored from the beginning of the function, because EVM is a stack machine. </p><br><p>  For example: </p><br><pre> <code class="hljs mel"># Stack: [] <span class="hljs-number"><span class="hljs-number">0x33</span></span> PUSH(<span class="hljs-number"><span class="hljs-number">0xFFFFFFFF</span></span> &amp; CALLDATALOAD(<span class="hljs-number"><span class="hljs-number">0x0</span></span>) / <span class="hljs-number"><span class="hljs-number">0x100000000000000000000000000000000000000000000000000000000</span></span>) <span class="hljs-number"><span class="hljs-number">0x34</span></span> DUP1 <span class="hljs-number"><span class="hljs-number">0x3E</span></span> JUMPI(:label5, <span class="hljs-number"><span class="hljs-number">0x2F54BF6E</span></span> == POP()) ... :label36 # Stack: [@0x420 @0x408 <span class="hljs-number"><span class="hljs-number">0x0</span></span> @0x2A1 @0x282 :label22 @0x33] <span class="hljs-number"><span class="hljs-number">0x43F</span></span> POP() <span class="hljs-number"><span class="hljs-number">0x440</span></span> POP() <span class="hljs-number"><span class="hljs-number">0x443</span></span> PUSH(MLOAD(<span class="hljs-number"><span class="hljs-number">0x40</span></span>)) ...</code> </pre> <br><p>  By 0x33, the value from calldata is obtained and put on the stack.  Since this value is unknown, it is symbolized.  Further, we can observe it in the stack of the label36 base unit among other symbolic and specific values ‚Äã‚Äã(numbers and transition addresses). </p><br><p>  In our opinion, this is the most convenient tool for developing back contracts. </p><br><h3 id="ethersplayhttpsgithubcomtrailofbitsethersplay">  <a href="https://github.com/trailofbits/ethersplay">Ethersplay</a> </h3><br><p>  A plugin for Binary Ninja that adds support for the EVM architecture.  Intermediate representations (LLIL, and MLIL) ninjies will not work, because EVM is a stack machine, so you will have to read bare assembler instructions.  From the pleasant: the plugin has a dictionary with pairs <code>{ :   }</code> , so you can immediately identify many known functions (for example, implementing different interfaces of the ERC standards): </p><br><table><thead><tr><th><img src="https://habrastorage.org/webt/dn/dx/dj/dndxdjkz2el_i0vunku6czhaxq0.png" alt="image"></th></tr></thead><tbody><tr><td>  <em>Figure 7. Binary Ninjia Interface with Ethersplay Plugin</em> </td></tr></tbody></table><br><p>  Also in the plugin there is a feature that shows the state of the stack for each instruction: </p><br><table><thead><tr><th><img src="https://habrastorage.org/webt/xv/wq/3g/xvwq3gqmjvlhvmt91hi-sv3ue0k.png" alt="image"></th></tr></thead><tbody><tr><td>  <em>Figure 8. Stack Status shown by Ethersplay</em> </td></tr></tbody></table><br><p>  But it replaces all character variables with the word <code>Unknown</code> , whereas EVMdis instead writes the address where this character variable appeared on the stack. </p><br><p>  Ethersplay did not take root in our arsenal, but perhaps it will be developed to the stage when it becomes a useful tool. </p><br><h3 id="ida-evmhttpsgithubcomtrailofbitsida-evm">  <a href="https://github.com/trailofbits/ida-evm">Ida-evm</a> </h3><br><p>  Processor module for IDA Pro, allowing it to disassemble contracts.  It also has a dictionary with function prototypes, as in Ethersplay. </p><br><table><thead><tr><th><img src="https://habrastorage.org/webt/3o/c8/rf/3oc8rfoflrungur29srh-lxxtog.png" alt="image"></th></tr></thead><tbody><tr><td>  <em>Figure 9. IDA interface with IDA-EVM processor module</em> </td></tr></tbody></table><br><p>  However, this is not enough for convenient backward development of contracts, because the state of the stack of the entire program will have to be worked through.  In our opinion, this tool does not deserve attention, because most likely it will not receive development, and in its current form it is useless. </p><br><h2 id="testirovanie">  Testing </h2><br><p>  In this section, I would like to talk about what really tends to make a secure contract out of your contract, namely about testing.  As practice shows, in a smart contract, which is at least 95% covered by tests, the probability of a serious vulnerability is small.  In the process of writing tests, most likely, a lot of necessary checks will be added, but you shouldn‚Äôt be deceived, there will be things that can only be prompted by experienced security auditors or a developer.  For example, find 0day vulnerabilities in the subject area that the contract implements, or some other logical errors, or suggest how to make certain contract mechanisms (DApp) more efficient. </p><br><h3 id="trufflehttptruffleframeworkcom">  <a href="http://truffleframework.com/">Truffle</a> </h3><br><p>  The most convenient way is to conduct testing "on the spot" with the help of Truffle (most smart contracts are being developed with it).  In the test folder (appears after <code>truffle init</code> ) you can write tests and run them with the command <code>truffle test</code> .  However, hardly anyone can tell better about testing with truffle than official <a href="http://truffleframework.com/docs/getting_started/javascript-tests">documentation</a> .  Also, do not forget to test coverage with the <a href="https://www.npmjs.com/package/solidity-coverage">solidity-coverage</a> tool. </p><br><h3 id="web3jshttpsweb3jsreadthedocsioen10">  <a href="https://web3js.readthedocs.io/en/1.0/">web3.js</a> </h3><br><p>  If for some reason (and there may be a lot of them) you are not satisfied with Truffle, you can write tests using the web3 libraries (they are for different languages).  The most convenient way is to use web3.js, since the written test code can be easily transferred to a future DApp as part of logic.  The only caveat is use web3.js version ^ 1.0.0.  The future is hers, and with version 0.14.0, which will be your first line in Google, it is not compatible.  Consider an example: </p><br><div class="spoiler">  <b class="spoiler_title">source code</b> <div class="spoiler_text"><pre> <code class="javascript hljs">pragma solidity ^<span class="hljs-number"><span class="hljs-number">0.4</span></span><span class="hljs-number"><span class="hljs-number">.23</span></span>; contract Testable { address public human; uint private counter; <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { human = tx.origin; } event CallmeLog(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callme</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">uint times</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span></span>{ counter++; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (times &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { callme(--times); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { emit CallmeLog(); } } }</code> </pre> </div></div><br><p>  Before proceeding to the tests themselves, you will have to write a function that will upload a fresh contract to the network, since it only needs to be done once :) </p><br><div class="spoiler">  <b class="spoiler_title">tests</b> <div class="spoiler_text"><pre> <code class="hljs matlab">const solc = require(<span class="hljs-string"><span class="hljs-string">'solc'</span></span>); const fs = require(<span class="hljs-string"><span class="hljs-string">'fs'</span></span>); const Web3 = require(<span class="hljs-string"><span class="hljs-string">'web3'</span></span>); const web3 = new Web3(new Web3.providers.HttpProvider(<span class="hljs-string"><span class="hljs-string">'http://127.0.0.1:8545'</span></span>)); const code = fs.readFileSync(<span class="hljs-string"><span class="hljs-string">'./testable.sol'</span></span>); async <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { // </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">when</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unlocked</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">account</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">from</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">node</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultAccs</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">web3</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eth</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAccounts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">web3</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eth</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultAccount</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultAccs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[0]</span></span></span><span class="hljs-function">; // </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">known</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">key</span></span></span><span class="hljs-function"> // </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">web3</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eth</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">accounts</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wallet</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(privKey.key)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Testable</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deploy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">human_test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Testable)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callme_tx_status_test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Testable, 3)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callme_event_test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Testable, 3)</span></span></span><span class="hljs-function">; // </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function">'</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">got</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">instance</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Testable</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deploy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callme_storage_test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Testable, 5)</span></span></span><span class="hljs-function">; } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">async</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deploy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">solc</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(code.toString()</span></span></span><span class="hljs-function">, 1); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestableABI</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contracts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[Object.keys(output.contracts)[0]</span></span></span><span class="hljs-function">].</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">interface</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestableBytecode</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contracts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[Object.keys(output.contracts)[0]</span></span></span><span class="hljs-function">].</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bytecode</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Testable</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">web3</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eth</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Contract</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JSON.parse(TestableABI)</span></span></span><span class="hljs-function">,{ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">from</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">web3</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eth</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultAccount</span></span></span><span class="hljs-function"> }); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gasCount</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Testable</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deploy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">({ data: TestableBytecode })</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimateGas</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Testable</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Testable</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deploy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">({ data: TestableBytecode })</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">({ gas: gasCount })</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">return</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Testable</span></span></span><span class="hljs-function">; } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">async</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">human_test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(instance)</span></span></span><span class="hljs-function"> { // </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function">'</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">that</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contract</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">has</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">owner</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(human)</span></span></span><span class="hljs-function"> // </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> "</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function">" </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">variables</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">and</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constant</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">methods</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">humanAddress</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">instance</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">methods</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">human</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(humanAddress !== web3.eth.defaultAccount)</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">throw</span></span></span><span class="hljs-function"> "‚úï </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">human</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">address</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wrong</span></span></span><span class="hljs-function">" } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">console</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(" human_test passed")</span></span></span><span class="hljs-function">; } } ...</span></span></code> </pre> </div></div><br><p>      ,   (     )    .        <a href="https://github.com/pertsev/web3_utilz/tree/master/Testing">web3_utilz/Testing</a> . </p><br><h2 id="podytozhim">  </h2><br><p> ,    ,      ,       , ,  ,    CTF. </p><br><p>          (reverse engineering),       ,    . , ,               -   (   <a href="https://medium.com/%40montedong/towards-cracking-crypto-kitties-genetic-code-629fcd37b09b">cryptoKittes</a> ).    ,               reverse engineering.    ,  ,    ,     . </p><br><p>  ,      ,    <a href="https://habr.com/users/p4lex/" class="user_link">p4lex</a>  <a href="https://habr.com/users/igor1024/" class="user_link">Igor1024</a> . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/353676/">https://habr.com/ru/post/353676/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353664/index.html">Impose flex-calendar</a></li>
<li><a href="../353666/index.html">How we broke Glusterfs</a></li>
<li><a href="../353668/index.html">Interfaces: how to tell the user if ‚ÄúOops, something went wrong‚Äù</a></li>
<li><a href="../353672/index.html">Distribution of static content - an account for milliseconds</a></li>
<li><a href="../353674/index.html">Divorce as it is (or "confirmation confirmation discord!")</a></li>
<li><a href="../353678/index.html">Reverse engineering "Kazakov 3", part of the network: create a local server</a></li>
<li><a href="../353680/index.html">Distributed control system based on SoC FPGA</a></li>
<li><a href="../353682/index.html">DevConf: Uber transition from PostgreSQL to MySQL</a></li>
<li><a href="../353684/index.html">One small ventilation</a></li>
<li><a href="../353686/index.html">"Closer to 5G": VMware helps telecom operators deploy new generation networks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>