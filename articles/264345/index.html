<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introduction to JavaScript Iterators on ES6</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="EcmaScript 2015 (also known as ES6) introduces a completely new iterator concept that allows you to specify sequences (limited and others) at the lang...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introduction to JavaScript Iterators on ES6</h1><div class="post__text post__text-html js-mediator-article">  EcmaScript 2015 (also known as ES6) introduces a completely new iterator concept that allows you to specify sequences (limited and others) at the language level. <br><br>  Let's talk about this in more detail.  We are all familiar with the for loop operator, and many even know his less popular for-in brother.  The latter can be used to help us explain the basic principles of working with iterators. <br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> table) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(key + <span class="hljs-string"><span class="hljs-string">' = '</span></span> + table[key]); }</code> </pre> <br>  There are many problems with the for-in loop operator, but the biggest one, perhaps, is that it does not give any guarantees of consistency.  We will try to solve this problem with the help of iterators.  More information under the cut! <a name="habracut"></a><br><br><h5>  For-of loop </h5><br>  for-of is a new syntax introduced in ES6, designed to work with iterators. <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> table) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(key + <span class="hljs-string"><span class="hljs-string">' = '</span></span> + table[key]); }</code> </pre><br>  In this example, we want to see an iterator application that guarantees a sequence of keys.  In order for an object to become iterable, it must use an iterative protocol, that is, an object (or one of the objects up the prototype chain) must have the property with the Symbol.iterator key.  This is what uses for-of, and in this particular example, it will be a table [Symbol.iterator]. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Symbol.iterator is another addition to ES6, which we will discuss in detail, but some other time.  For now, consider that Symbol.iterator is a way to set special keys that will not conflict with ordinary object keys. <br><br>  The element of the table [Symbol.iterator] object must be a function that conforms to the iterator protocol, that is, it must return an object as follows: {next: function () {}}. <br><pre> <code class="javascript hljs">table[<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.iterator] = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">next</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{} } }</code> </pre><br>  Every time the next function is called for-of, it must return an object that looks like this: {value: ..., done: [true / false]}.  The full implementation of our iterator is as follows: <br><pre> <code class="javascript hljs">table[<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.iterator] = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keys = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).sort(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> index = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">next</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: keys[index], <span class="hljs-attr"><span class="hljs-attr">done</span></span>: index++ &gt;= keys.length }; } } }</code> </pre><br><h5>  Laziness </h5><br>  Iterators allow us to delay the execution of a function until the first call to next.  In the example above, as soon as we call the iterator, the process of getting and sorting keys begins.  However, what happens if the next is not called?  Just spend time in vain.  So let's optimize the code: <br><pre> <code class="javascript hljs">table[<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.iterator] = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _this = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keys = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> index = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">next</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (keys === <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { keys = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(_this).sort(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: keys[index], <span class="hljs-attr"><span class="hljs-attr">done</span></span>: index++ &gt;= keys.length }; } } }</code> </pre><br><h5>  Difference between for-of and for-in </h5><br>  It is important to understand the difference between for-of and for-in.  We give a simple but illustrative example of why this is so. <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> list = [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>]; list.foo = <span class="hljs-string"><span class="hljs-string">'bar'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> list) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(key); <span class="hljs-comment"><span class="hljs-comment">// 0, 1, 2, foo } for (var value of list) { console.log(value); // 3, 5, 7 }</span></span></code> </pre><br>  As you can see, for-of gives only the values ‚Äã‚Äãthat are in the array, and omits all other properties.  This happens because the array iterator only returns the expected parameters. <br><br><h5>  Built-in iterators </h5><br>  <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">String</a> , <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a> , <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray">TypedArray</a> , <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">Map</a> , <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set">Set</a> contain built-in iterators, because their prototype objects contain the Symbol.iterator method. <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> string = <span class="hljs-string"><span class="hljs-string">"hello"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> chr <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> string) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(chr); <span class="hljs-comment"><span class="hljs-comment">// h, e, l, l, o }</span></span></code> </pre><br><h5>  Spread construct </h5><br>  The Spread operator can also take iterators.  You can use it like this: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hello = <span class="hljs-string"><span class="hljs-string">'world'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> [first, second, ...rest] = [...hello]; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(first, second, rest); <span class="hljs-comment"><span class="hljs-comment">// wo ["r","l","d"]</span></span></code> </pre><br><h5>  Infinite iterator </h5><br>  Using an infinite iterator is as easy as never returning done: true.  Of course, you need to make sure that there is no infinite loop anywhere. <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ids = { *[<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.iterator]: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> index = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">next</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-string"><span class="hljs-string">'id-'</span></span> + index++, <span class="hljs-attr"><span class="hljs-attr">done</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }; } }; } }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> counter = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ids) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(value); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (counter++ &gt; <span class="hljs-number"><span class="hljs-number">1000</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// let's make sure we get out! break; } }</span></span></code> </pre><br><h5>  Generators </h5><br>  If you are not familiar with generators in ES6, then it's time to read the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*">documentation</a> .  In a nutshell, generators are functions that you can pause and then resume.  Recently, generators are the most talked about functionality in ES6.  The context is saved between restarts.  Generators contain both protocols, Iterable and Iterator.  Let's look at a simple example: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">list</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> value) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> item; } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> list([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>])) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(value); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> iterator = list([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> iterator.next); <span class="hljs-comment"><span class="hljs-comment">// function console.log(typeof iterator[Symbol.iterator]); // function console.log(iterator.next().value); // 1 for (var value of iterator) { console.log(value); // 2, 3 }</span></span></code> </pre><br>  Taking into account the code above, we can rewrite the iterator code that sorts the keys using generators: <br><pre> <code class="javascript hljs">table[<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.iterator] = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keys = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).sort(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> keys) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> item; } }</code> </pre><br><h5>  Total </h5><br>  Iterators open up a whole new dimension to working with cycles, generators, and variable sets.  They can be transferred, set as a class, describes a list of parameters, create ‚Äúlazy‚Äù or endless lists, etc.  etc. <br><br><h5>  ES6 today </h5><br>  How can I take advantage of ES6 today?  The use of transpilers has become the norm in the last few years.  Neither simple developers nor large companies feel free to use them.  <a href="https://babeljs.io/">Babel</a> is a transpiler from ES6 to ES5 that supports all the innovations of ES6. <br><br>  If you use <a href="http://browserify.org/">Browserify</a> , you can add <a href="https://babeljs.io/">Babel in</a> just <a href="http://babeljs.io/docs/setup/">a couple of minutes</a> .  Of course, there is support for almost any build with Node.js.  For example: Gulp, Grunt and many others. <br><br><h5>  What about browsers? </h5><br>  Most browsers are gradually <a href="https://kangax.github.io/compat-table/es6/">adding new features</a> , but no one has yet got full support.  What now to wait?  It depends.  It makes sense to start using language features that will become universal in a year or two.  This will allow you to comfortably move to a new stage.  However, if you need 100% control over the source code, then for now it's better to wait and use ES5. <br><br>  Translation prepared by: <a href="http://habrahabr.ru/users/greebn9k/" class="user_link">greebn9k</a> (Sergey Gribnyak), <a href="http://habrahabr.ru/users/silmarilion/" class="user_link">silmarilion</a> (Andrey Khakharev) </div><p>Source: <a href="https://habr.com/ru/post/264345/">https://habr.com/ru/post/264345/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264335/index.html">Vulnerability in Mozilla Firefox web browser is exploited in-the-wild</a></li>
<li><a href="../264337/index.html">Glyuching, attacks on third-party channels and hacker projects on Kickstarter (continued)</a></li>
<li><a href="../264339/index.html">Working with text data in scikit-learn (translation of documentation) - part 1</a></li>
<li><a href="../264341/index.html">STC Metrotek. Part 2. Bercut-MMT and the rake race</a></li>
<li><a href="../264343/index.html">React boilerplate - Rocket React</a></li>
<li><a href="../264347/index.html">The third PyCon Russia will be held in Yekaterinburg on September 18-19</a></li>
<li><a href="../264349/index.html">Underground carders market. Translation of the book "Kingpin". Chapter 6. ‚ÄúI Miss Crime‚Äù</a></li>
<li><a href="../264351/index.html">Vim in full: The library on which everything rests</a></li>
<li><a href="../264353/index.html">Remove excess packages from Raspbian. Or how to make your Raspbian Mini ...</a></li>
<li><a href="../264355/index.html">SpiderTest: DIY AutoTests</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>