<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The golden rule of git rebase</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 We rewrote our web development course here a bit and added another month of studying JS. Well, as usual with us - consider something interes...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The golden rule of git rebase</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br><br>  We rewrote our <a href="https://otus.pw/OLpC/">web development course</a> here a bit and added another month of studying JS.  Well, as usual with us - consider something interesting that understands our course.  In this case, git rebase. <br><br>  Go. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What actually happens during git rebase, and why should you care. <br><br>  <b>Basics of rebase</b> <br><br>  So you could imagine a rebase in git: <br><br><img src="https://habrastorage.org/webt/q-/l0/rz/q-l0rzttwtjxruzdzrzaiq_nan8.png"><br><a name="habracut"></a><br>  You might think that when you rebase, you ‚Äúdetach‚Äù the branch you want to relocate and ‚Äúattach‚Äù it to the end of another branch.  This is not very far from the truth, but it is worth digging a little deeper.  Here is what the rebase <a href="https://git-scm.com/docs/git-rebase">documentation</a> says: <br><br>  <i>‚ÄúGit-rebase: Forward-port local commits to the updated upstream head‚Äù - git documentation</i> <br><br>  Not very helpful, is it?  Approximate translation (and translation of translation) may be as follows: <br><br>  <i>git-rebase: Reapply all commits from your branch to the end of another branch.</i> <br><br>  The most important word here is ‚Äúreapply‚Äù, because rebase is not just ctrl-x / ctrl-v from one branch to another.  Rebase will consistently take all commits from the branch you are in and reapply them to another branch.  This has two important consequences: <br><br><ol><li>  Replacing commits, git creates new ones.  These new commits, even if they make the same set of changes, will be viewed by git as completely different and independent. </li><li>  Git rebase reapplies commits without destroying old ones.  This means that even after rebase, the old commits will still be in the / objects folder in your .git directory.  If you're still unfamiliar with how git views and stores commits, you can find out something interesting here. </li></ol><br>  Thus, this may be a more accurate idea of ‚Äã‚Äãwhat actually happens during a rebase: <br><br><img src="https://habrastorage.org/webt/rz/s-/-h/rzs--hejjv03rfh34gzzg6tyvmw.png"><br><br>  As you can see, the feature branch has completely new commits.  As already mentioned, it has the same set of changes, but completely different objects in terms of git.  And you can also see that the previous commits are not destroyed.  They are simply not available directly.  If you remember, a branch is only a pointer to commits.  Therefore, if neither branches nor tags point to commits, it becomes almost impossible to get them, but commits still exist. <br><br>  Now let's talk about the famous golden rule. <br><br>  <b>The golden rule of rebase</b> <br><br>  <i>"Do not rebase the common branch" - Everything and everyone about rebase</i> <br><br>  You have probably already come across this rule, perhaps formulated differently.  For those who did not, this rule is quite simple.  Never, NEVER, NEVER rebase a common branch.  By a common branch, I mean a branch that exists in a remote repository and which other people from your team can bully themselves. <br><br>  Too often, this rule is presented as a divine truth, and I think you should figure it out if you want to improve your understanding of git. <br><br>  To do this, let's imagine a situation where a developer violates this rule, and see what happens. <br><br>  Let's say Bob and Anna are working on the same project.  Here is the Bob, Anna repository, and remote repository on GitHub: <br><br><img src="https://habrastorage.org/webt/c3/go/qe/c3goqerxvoxfdtmrwpkhxdemhtu.png"><br><br>  Everything is synchronized with a remote repository (GitHub) <br><br>  Now Bob innocently violates the golden rule of rebase, at the same time Anna decides to work on this feature and creates a new commit: <br><br><img src="https://habrastorage.org/webt/hp/a_/kq/hpa_kqtfvgjnubqqjsepfp9d2ba.png"><br><br>  Guess what will happen? <br><br>  Bob tries to push, he gets a failure and sees the following message: <br><br><img src="https://habrastorage.org/webt/zk/ml/v8/zkmlv8igbadvmrqkqdnaur0s4gy.png"><br>  <i><a href="https://github.com/robbyrussell/oh-my-zsh">Oh my zsh</a> with agnoster theme for those who are interested.</i> <br><br>  Git is not happy, because it doesn‚Äôt know how to merge the feature branch of Bob with the feature branch of GitHub.  Usually, when you push your branch to a remote repository, git merges the branch that you are trying to push with the branch located in the remote repository.  To be precise, git is trying to fast-forward your branch, and we will talk about this in a future post.  What you need to remember is that the remote repository cannot, in a simple way, deal with the relocated branch that Bob is trying to push. <br><br>  One solution for Bob would be to make git push-force, which tells the remote repository: <br>  ‚ÄúI‚Äôm pushing what you‚Äôve already been.  I‚Äôm pushing now for the new feature branch <br>  And this is what we end up with: <br>  ‚ÄúDo not try to combine or do any other work between what I push and what you already have.  Erase my version of the feature branch: what I am pushing is now a new feature branch ‚Äù <br><br>  And this is what we get: <br><br><img src="https://habrastorage.org/webt/kb/qo/pu/kbqopuuurmttazhn8gk8m26fxgm.png"><br><br>  If Anna knew what was going to happen, she would not have gone to work this morning. <br><br>  Now Anna wants to push her changes: <br><br><img src="https://habrastorage.org/webt/us/bq/bb/usbqbbzukcr-8y3yjfwonauyats.png"><br><br>  This is normal, git simply told Anna that she does not have a synchronized version of the feature branch, i.e.  its version of the branch and the version of the GitHub branch are different.  Naturally, Anna bullet.  Just as git tries to merge your local branch with what is in the remote repository when pushing, git tries to merge what is in the remote repository with what is in your local branch when you pull. <br><br>  This is how commits look in the remote and local feature in front of the pool: <br><br><pre><code class="bash hljs">A--B--C--D<span class="hljs-string"><span class="hljs-string">' origin/feature // GitHub A--B--D--E feature // Anna</span></span></code> </pre> <br><br>  When you pull, git must do a merge to solve this problem.  And that's what happens: <br><br><img src="https://habrastorage.org/webt/q3/5l/0l/q35l0lrqvbkdya-fzirf2cooxui.png"><br><br>  Commit M is a merge commit ‚Äî a commit in which Anna's branch and GitHub are finally reunited.  Anna finally sighs with relief, she managed to resolve all the merger conflicts, and now she can push her work.  Bob decides to run, and now everything is synchronized. <br><br><img src="https://habrastorage.org/webt/kg/mh/z3/kgmhz3c5-ltiyaiwpu75mifzs50.png"><br><br>  One glance at this mess should be enough to convince you of the fairness of the golden rule.  You should keep in mind that you are in front of a mess created by only one person, in a branch shared by only two people.  Imagine doing this with a team of 10 people.  One of the many reasons why people use git is that you can easily ‚Äúgo back in time‚Äù, but the more messy your story is, the harder it gets. <br><br>  You may also notice duplicate commits in the repository - D and D ', which have the same set of changes.  The number of duplicated commits can be as large as the number of commits within your relocated branch. <br><br>  If you're still not sure, try to introduce Emma, ‚Äã‚Äãthe third developer.  She worked on the feature before Bob ruined everything, and now she wants to push changes.  Please note that she fushes after our previous mini-script. <br><br><img src="https://habrastorage.org/webt/mv/lf/le/mvlfleayervhpvzrh0xtwpet5bc.png"><br>  <i>damn it bob!</i> <br><br>  update: As one reddit user noted, this post might make you think that rebase can only be used to relocate a branch to the top of another branch.  This is not the case; you can relocate the same branch, but that‚Äôs another story. <br><br>  Thanks for attention. <br><br>  THE END <br><br>  As always, we are waiting for your questions, comments here or you can torment the teachers in <a href="https://otus.pw/7BDW/">an open lesson.</a> </div><p>Source: <a href="https://habr.com/ru/post/352640/">https://habr.com/ru/post/352640/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352628/index.html">Rumors about the cancellation of the Kotelnikov theorem are greatly exaggerated</a></li>
<li><a href="../352630/index.html">As Google Adwords experts helped me to throw away 150,000 UAH (about $ 6000) per month or why I will not ...</a></li>
<li><a href="../352632/index.html">True implementation of a neural network from scratch. Part 2. Recognition of numbers</a></li>
<li><a href="../352634/index.html">Network Optimization for Unreal Engine 4</a></li>
<li><a href="../352636/index.html">20 modules for Node.js, which is useful to know</a></li>
<li><a href="../352644/index.html">GitLab 10.6 released: CI / CD for GitHub and in-depth integration with Kubernetes</a></li>
<li><a href="../352646/index.html">3CX voice application development: an introduction for beginners</a></li>
<li><a href="../352648/index.html">TeamLead Conf review: 2 days with 2 tracks, 25 reports, 474 participants, the pain is immeasurable</a></li>
<li><a href="../352650/index.html">DZ Online Tech: Postgres Professional</a></li>
<li><a href="../352652/index.html">Igor Sheludko, FSPro Labs: ‚ÄúWorking as a tracker, I see the evolution of many ideas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>