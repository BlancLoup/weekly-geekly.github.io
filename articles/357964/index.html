<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Access Controller for Go + Raspberry Pi + Arduino Nano</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to share the next solution of the trivial task of implementing a network access controller (ACS). 

 The background to the emergence of this ta...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Access Controller for Go + Raspberry Pi + Arduino Nano</h1><div class="post__text post__text-html js-mediator-article">  I want to share the next solution of the trivial task of implementing a network access controller (ACS). <br><br>  The background to the emergence of this task is, as is often the case, the desire of the customer to get a special functionality of the ACS controller.  This special functionality is as follows: <br><a name="habracut"></a><br><ul><li>  The controller must be networked (opening, closing the lock and the "hard lock" mode) </li><li>  Opening and closing by button (trigger mode) </li><li>  Opening and closing by key (trigger mode) </li><li>  Hard lock mode of input / output </li><li>  Adding, reading and deleting keys </li><li>  Key lock </li><li>  Event logging </li></ul><br>  In the hard blocking mode, the lock cannot be opened either with a key or through a button or via HTTP.  Disconnection occurs either by canceling the blocking mode or by resetting the controller by power. <br><br>  Considering that the customer was ready to pay, practically, any money, it was not planned to initially develop his controller, but it was decided to find a controller ready on the market and implement the task.  But in practice everything turned out to be not so joyful.  As a clarification, it is necessary to say that the customer‚Äôs office has implemented automation (the Smart Home system) based on KNX + Control4. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The available network controllers are very functional, but in most cases this functionality is wired by the manufacturer‚Äôs firmware and naturally cannot be changed.  For example, none of the controllers we reviewed (I will not give a list so that it does not look like an advertisement or anti-advertising, and in general for the meaning of the article, it doesn‚Äôt matter) does not have the function of closing the door by a button (surely some controllers can maybe we missed them).  But the network controller can theoretically receive various commands via HTTP, including open / close, and Control4 can send these commands.  But the SDK controllers available for the controllers in question are implemented on .NET libraries of older versions 1,2,3, which implied using Windows PCs as a gateway (now tomatoes from indignation of .NET developers should fly into me, such as the .NetCore, Mono and etc.).  Surely, it was possible for .Net to adapt the development to Linux, but there was no confidence in the correctness and stability of this approach at that time. <br><br>  Another problem was the key lock.  Only one controller handled this task easily, a budgetary one (let me designate one of the applicants) Z-5R from Ironlogic.  It has a ‚ÄúTrigger‚Äù mode, but the button is only for opening.  Sane information on the SDK from technical support has not received.  In general, after analyzing and evaluating all the information, it was decided to develop our own decision. <br><br>  As a hardware platform, we decided to use a bunch of Raspberry Pi (rev.B) + Arduino Nano.  Arduino works fine with low-level interfaces, and on the Malinka you can raise a full-fledged network stack and use high-level programming languages.  Communication between the boards via USB (via Serial Port) <br><br><img src="https://devgun.ru/pub/Skud-go.png" alt="image"><br>  <i>This diagram does not indicate the sound indication element (sound speaker), the implementation of which is reflected in the code for the Arduino.</i>  <i>From the code it will be seen that it is connected to pin - 9.</i> <br><br>  <b>The following components were used for implementation:</b> <br><br>  ‚Ä¢ Raspberry Pi (rev. B) - 1 pc. <br>  ‚Ä¢ Arduino Nano - 1 pc. <br>  ‚Ä¢ Sound speaker - 1 pc. <br>  ‚Ä¢ Touch Memory Key Reader (iButton) - 1 pc. <br>  ‚Ä¢ Resistor 220 Ohm - 1 tsh. <br>  ‚Ä¢ Relay 12V - 1 pc. <br>  ‚Ä¢ Electromagnetic lock 12V - 1 pc. <br><br>  <b>Requirements for the development environment</b> <br><br>  Before you develop on Go, you need to prepare the environment (since I was developing in Windows, the list of dependencies is described for this OS).  I will not elaborate on each item.  much has been said and written about them. <br><br><ol><li>  Installing <a href="https://habrahabr.ru/post/133281/">Go under Windows</a> </li><li>  Install development tools.  I used <a href="https://code.visualstudio.com/">Visual Studio Code</a> .  Very convenient and functional code editor.  Recommend!  Although you can use JetBrains IDE <a href="http://www.jetbrains.com/go">Goland</a> for Go </li><li>  Configure Visual Studio Code to work with <a href="https://code.visualstudio.com/docs/languages/go">Go</a> .  The instruction is in English, but everything is described quite clearly. </li><li>  Installed Arduino IDE - to fill the sketch. </li><li>  <a href="https://git-scm.com/download">Git</a> repository tool (to download Go packages from Github) </li></ol><br>  <b>Sketch access control for Arduino</b> <br><br>  The code for the Arduino is very simple and straightforward.  The only point to which you need to pay attention is that the OneWire library is not included in the standard set and must be <a href="">downloaded</a> . <br><br>  A small feature in the code is to save the current state of the lock in the EEPROM of the microcontroller, in case, in order to remember the current state of the lock if there is a short failure and power loss. <br><br><div class="spoiler">  <b class="spoiler_title">Sketch access control for Arduino</b> <div class="spoiler_text"><pre><code class="hljs lua">#include &lt;OneWire.h&gt; #include &lt;EEPROM.h&gt; #define RELAY1 <span class="hljs-number"><span class="hljs-number">6</span></span> //    boolean isClose; //     boolean hl=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; //      <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> i; OneWire ds(<span class="hljs-number"><span class="hljs-number">7</span></span>); //   <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> addr[<span class="hljs-number"><span class="hljs-number">8</span></span>]; //   String inCommand = <span class="hljs-string"><span class="hljs-string">""</span></span>; //    Raspberry Pi <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> character; //    void setup() { Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>); pinMode(RELAY1, OUTPUT); stateRead(); } void loop(){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ds.search(addr)) { ds.reset_search(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( OneWire::crc8( addr, <span class="hljs-number"><span class="hljs-number">7</span></span>) != addr[<span class="hljs-number"><span class="hljs-number">7</span></span>]) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!hl){ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; i++) { Serial.<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(addr[i],HEX); } Serial.println(); } } } ds.reset(); delay(<span class="hljs-number"><span class="hljs-number">500</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(Serial.available()) { character = Serial.<span class="hljs-built_in"><span class="hljs-built_in">read</span></span>(); inCommand.<span class="hljs-built_in"><span class="hljs-built_in">concat</span></span>(character); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inCommand==<span class="hljs-string"><span class="hljs-string">"hlock1"</span></span>){ hl=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; r_close(); Serial.println(<span class="hljs-string"><span class="hljs-string">"HardLock Enable"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inCommand==<span class="hljs-string"><span class="hljs-string">"hlock0"</span></span>){ hl=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; Serial.println(<span class="hljs-string"><span class="hljs-string">"HardLock Disable"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inCommand != <span class="hljs-string"><span class="hljs-string">""</span></span> &amp;&amp; !hl) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((inCommand==<span class="hljs-string"><span class="hljs-string">"open"</span></span>) &amp;&amp; (isClose) ){ r_open(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((inCommand==<span class="hljs-string"><span class="hljs-string">"close"</span></span>) &amp;&amp;(!isClose)){ r_close(); } } inCommand=<span class="hljs-string"><span class="hljs-string">""</span></span>; } void r_open(){ digitalWrite(RELAY1,LOW); isClose=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; stateSave(isClose); SoundTone(<span class="hljs-number"><span class="hljs-number">0</span></span>); delay(<span class="hljs-number"><span class="hljs-number">100</span></span>); Serial.println(<span class="hljs-string"><span class="hljs-string">"Relay Open "</span></span>); } void r_close(){ digitalWrite(RELAY1,HIGH); isClose=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; stateSave(isClose); SoundTone(<span class="hljs-number"><span class="hljs-number">1</span></span>); delay(<span class="hljs-number"><span class="hljs-number">100</span></span>); Serial.println(<span class="hljs-string"><span class="hljs-string">"Realy Close"</span></span>); } void stateSave(boolean st) //      EEPROM { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (st) { int val=<span class="hljs-number"><span class="hljs-number">1</span></span>; EEPROM.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>,val); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { int val=<span class="hljs-number"><span class="hljs-number">0</span></span>; EEPROM.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>,val); } } void stateRead() { int val; val= (EEPROM.<span class="hljs-built_in"><span class="hljs-built_in">read</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (val==<span class="hljs-number"><span class="hljs-number">1</span></span>) r_close(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> r_open(); } void SoundTone(boolean cmd){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!cmd){ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>;i++){ tone(<span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">815</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>); delay(<span class="hljs-number"><span class="hljs-number">250</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;<span class="hljs-number"><span class="hljs-number">4</span></span>;i++){ tone(<span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">395</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>); delay(<span class="hljs-number"><span class="hljs-number">350</span></span>); } } noTone(<span class="hljs-number"><span class="hljs-number">9</span></span>); }</code> </pre> <br></div></div><br>  The main controller code, as already mentioned, is written in Go.  Almost all libraries are taken from standard Go sources, with the exception of two. <br><br>  The first is the main BoltDB database, of type key \ value.  Working with her does not require "dancing with a tambourine", it is very simple and fast.  The second implements work with the COM port. <br><br>  <b>The main algorithm of the controller is as follows:</b> <br><br><ol><li>  At startup, the configuration is read from the <i>config.json</i> file; </li><li>  A small HTTP REST service is started; </li><li>  Opens the COM port for data exchange with the Arduino; </li><li>  A channel of type bool is created which is sent along with a pointer to a COM port to a go-routine where reading ID keys from the Arduino takes place; </li><li>  Then a cycle starts in which the data is waiting from the channel sent earlier to the go-routine.  Data will enter the channel only if the read key exists in the database and is active, after which the relay switching command will be sent to the Arduino. </li></ol><br>  Adding, deleting, reading keys and locking control is carried out through HTTP requests.  Many will immediately say that it is stupid, because  Anyone can make a request to the controller.  Yes, I agree that security needs to be further refined, but as a preventive measure, the configuration file has the ability to change the names of endpoints for various commands.  It is a little difficult to seize control of the controller by outsiders. <br><br><div class="spoiler">  <b class="spoiler_title">Controller code</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"bufio"</span></span> <span class="hljs-string"><span class="hljs-string">"encoding/json"</span></span> <span class="hljs-string"><span class="hljs-string">"io/ioutil"</span></span> <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> <span class="hljs-string"><span class="hljs-string">"regexp"</span></span> <span class="hljs-string"><span class="hljs-string">"time"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/boltdb/bolt"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/tarm/serial"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dbname = <span class="hljs-string"><span class="hljs-string">"access.db"</span></span> <span class="hljs-comment"><span class="hljs-comment">//    var isOpen, isHLock bool = false, false var serialPort *serial.Port func main() { //   config, err := readConfig() if err != nil { fmt.Printf("Error read config file %s", err.Error()) return } //   f, err := os.OpenFile(config.LogFilePath, os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666) if err != nil { log.Fatalf("error opening file: %v", err) } defer f.Close() log.SetOutput(f) //    HTTP- http.HandleFunc("/"+config.NormalModeEndpoint, webNormalMode) http.HandleFunc("/"+config.HardLockModeEndpoint, webHLockMode) http.HandleFunc("/"+config.CloseEndpoint, webCloseRelay) http.HandleFunc("/"+config.OpenEndpoint, webOpenRelay) http.HandleFunc("/"+config.AddKeyEndpoint, addKey) http.HandleFunc("/"+config.ReadKeysEndpoint, readKeys) http.HandleFunc("/"+config.DeleteKeyEndpoint, deleteKey) go http.ListenAndServe(":"+config.HTTPPort, nil) log.Printf("Listening on port %s...", config.HTTPPort) //    db, err := bolt.Open(dbname, 0600, nil) if err != nil { log.Fatal(err) } db.Close() //   Serial  c := &amp;serial.Config{Name: config.SerialPort, Baud: 9600} s, err := serial.OpenPort(c) if err != nil { fmt.Printf("Error open serial port %s ", err.Error()) log.Fatal(err) } serialPort = s //     , go- ch := make(chan bool) // wait chanel until key is valid go getData(ch, s) for { time.Sleep(time.Second) tmp := &lt;-ch if tmp { if isOpen { closeRelay() } else { openRelay() } } } } func getData(ch chan bool, s *serial.Port) { for { reader := bufio.NewReader(s) reply, err := reader.ReadBytes('\n') if err != nil { log.Fatal(err) } k := string(reply) if chk := checkKey(k); chk { ch &lt;- chk time.Sleep(2 * time.Second) } } } func invertBool() { //    isOpen = !isOpen } func checkErr(err error) { if err != nil { panic(err) } } func boltStore(value Key) { db, err := bolt.Open(dbname, 0600, nil) if err != nil { log.Fatal(err) } defer db.Close() db.Update(func(tx *bolt.Tx) error { b, err := tx.CreateBucketIfNotExists([]byte("keys")) if err != nil { return err } return b.Put([]byte(value.Key), []byte(value.isEnable)) }) } func boltRead(key string) bool { var strKey string db, err := bolt.Open(dbname, 0600, nil) if err != nil { log.Fatal(err) return false } defer db.Close() db.View(func(tx *bolt.Tx) error { re := regexp.MustCompile(`\r\n`) key := re.ReplaceAllString(key, "") re = regexp.MustCompile(`\n`) key = re.ReplaceAllString(key, "") re = regexp.MustCompile(`\r`) key = re.ReplaceAllString(key, "") log.Printf("Readed key: %s\n", key) b := tx.Bucket([]byte("keys")) v := b.Get([]byte(key)) strKey = string(v) return nil }) if strKey == "1" { log.Printf("Key %s valid\n", key) return true } return false } func addKey(w http.ResponseWriter, r *http.Request) { params := r.URL.Query() var key Key key.Key = params.Get("key") key.isEnable = params.Get("enable") boltStore(key) log.Printf("You add the key %s", key.Key) fmt.Fprintln(w, "You add the key", key.Key) } func readKeys(w http.ResponseWriter, r *http.Request) { keys := make(map[string]string) db, err := bolt.Open(dbname, 0600, nil) if err != nil { log.Fatal(err) } defer db.Close() db.View(func(tx *bolt.Tx) error { b := tx.Bucket([]byte("keys")) b.ForEach(func(k, v []byte) error { keys[string(k)] = string(v) fmt.Printf("map: %s\n", keys[string(k)]) return nil }) return nil }) data, _ := json.Marshal(keys) fmt.Fprintln(w, string(data)) } func deleteKey(w http.ResponseWriter, r *http.Request) { params := r.URL.Query() deleteKey := params.Get("key") db, err := bolt.Open(dbname, 0600, nil) if err != nil { log.Fatal(err) } defer db.Close() db.Update(func(tx *bolt.Tx) error { // Retrieve the users bucket. // This should be created when the DB is first opened. b := tx.Bucket([]byte("keys")) err := b.Delete([]byte(deleteKey)) if err != nil { fmt.Printf("Key: \"%s\" delete failed: %s\n", deleteKey, err.Error()) return err } fmt.Fprintf(w, "Key: \"%s\" deleted succesfully\n", deleteKey) // Persist bytes to users bucket. return nil }) } func webNormalMode(w http.ResponseWriter, r *http.Request) { isHLock = false _, err := serialPort.Write([]byte("hlock0")) if err != nil { log.Fatal(err) } fmt.Fprintln(w, "Normal Mode") } func webHLockMode(w http.ResponseWriter, r *http.Request) { _, err := serialPort.Write([]byte("hlock1")) if err != nil { log.Fatal(err) } isHLock = true fmt.Fprintln(w, "HardLock Mode") } func webCloseRelay(w http.ResponseWriter, r *http.Request) { switchRelay() fmt.Fprintln(w, "switch relay") } func webOpenRelay(w http.ResponseWriter, r *http.Request) { openRelay() fmt.Fprintln(w, "open lock") } func closeRelay() { _, err := serialPort.Write([]byte("close")) if err != nil { log.Fatal(err) } invertBool() log.Println("Close") } func openRelay() { _, err := serialPort.Write([]byte("open")) if err != nil { log.Fatal(err) } invertBool() log.Println("Open") } func switchRelay() { if isOpen { closeRelay() } else { openRelay() } } func checkKey(key string) bool { if boltRead(key) { return true } return false } func readConfig() (*Config, error) { plan, _ := ioutil.ReadFile("config.json") config := Config{} err := json.Unmarshal([]byte(plan), &amp;config) return &amp;config, err }</span></span></code> </pre><br></div></div><br>  I built the binary file on the Raspberry Pi itself (of course, I had to install all the dependencies for Go on raspberries). <br><br><pre> <code class="bash hljs">GOOS=linux GOARCH=arm go build -o /home/pi/skud-go/skud-go</code> </pre> <br>  Also, the main thing is not to forget to put the following dependent files together with the binary file: <br><br><pre> <code class="bash hljs">config.json access.db</code> </pre><br><div class="spoiler">  <b class="spoiler_title">config.json</b> <div class="spoiler_text">  { <br>  "SerialPort": "/ dev / ttyUSB0", <br>  "HttpPort": "80" <br>  "NormalModeEndpoint": "normal", <br>  "HardLockModeEndpoint": "block", <br>  "CloseEndpoint": "close", <br>  "OpenEndpoint": "open", <br>  "AddKeyEndpoint": "addkey", <br>  "DeleteKeyEndpoint": "deletekey", <br>  "ReadKeysEndpoint": "readkeys", <br>  "LogFilePath": "/ var / log / skud-go.log" <br>  } <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Types of data controller.</b>  <b class="spoiler_title">skud_type.go</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-comment"><span class="hljs-comment">//Key     type Key struct { Key string isEnable string } //Config    type Config struct { SerialPort string `json:"serialPort"` HTTPPort string `json:"httpPort"` NormalModeEndpoint string `json:"normalModeEndpoint"` HardLockModeEndpoint string `json:"hardLockModeEndpoint"` CloseEndpoint string `json:"closeEndpoint"` OpenEndpoint string `json:"openEndpoint"` AddKeyEndpoint string `json:"addKeyEndpoint"` DeleteKeyEndpoint string `json:"deleteKeyEndpoint"` ReadKeysEndpoint string `json:"readKeysEndpoint"` LogFilePath string `json:"logFilePath"` }</span></span></code> </pre> <br></div></div><br>  To start the controller as a service, you need to create an additional unit-file.  Such a file tells the systemd initialization system how to manage this or that resource.  Services are the most common type of unit-files, defining dependencies and parameters for starting and stopping a program. <br><br>  Create such a file for skud-go.  The file will be called skud-go.service and stored in / etc / systemd / system. <br><br><pre> <code class="bash hljs">sudo nano /etc/systemd/system/skud-go.service</code> </pre> <br>  File contents: <br><br><pre> <code class="bash hljs">[Unit] Description=Access Control System Controller by Go After=network.target [Service] User=pi ExecStart=/home/pi/skud-go/skud-go [Install] WantedBy=multi-user.target</code> </pre><br>  To start a new service, enter: <br><br><pre> <code class="bash hljs">sudo systemctl start skud-go</code> </pre> <br>  Now you need to enable the autostart of this service: <br><br><pre> <code class="bash hljs">sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> skud-go</code> </pre> <br>  The result was a fairly simple and functional uptime controller of which, for more than 6 months (tiny of course, but still ahead).  I hope this article will be useful for someone. <br><br>  ‚Üí Sources are available on <a href="https://github.com/zebox/skud-go">Github</a> </div><p>Source: <a href="https://habr.com/ru/post/357964/">https://habr.com/ru/post/357964/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357954/index.html">Raspberry Pi Zero went on sale for $ 5: links to stores</a></li>
<li><a href="../357956/index.html">ACS, raspberry and kettle</a></li>
<li><a href="../357958/index.html">Thermal Raspberry Pi 3 showed a temperature of 101¬∫C</a></li>
<li><a href="../357960/index.html">We acquaint Qt with Raspberry Pi 3</a></li>
<li><a href="../357962/index.html">Restricted Access and CCTV at Raspberry PI</a></li>
<li><a href="../357966/index.html">Orange Pi 2G-IOT or Orange Paradise</a></li>
<li><a href="../357968/index.html">Released updated Raspberry Pi 3 Model B +</a></li>
<li><a href="../357970/index.html">Second GIS-hackathon "Guessing on the Cards"</a></li>
<li><a href="../357972/index.html">Reverse "Neuromant". Part 2: Render the Font</a></li>
<li><a href="../357974/index.html">Get free, quick, easy and simple system information from a variety of PCs on the network</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>