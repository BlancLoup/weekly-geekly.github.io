<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Yii 2.0.13</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The release of the PHP framework Yii version 2.0.13. It includes more than 90 improvements and fixes . 


 Please note that there are changes in the r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Yii 2.0.13</h1><div class="post__text post__text-html js-mediator-article"><p>  The release of the PHP framework Yii version 2.0.13.  It includes more than <a href="">90 improvements and fixes</a> . </p><br><p>  Please note that there are changes in the release that may affect existing applications.  They are described in <a href="">UPGRADE.md</a> . </p><br><p>  Many thanks to <a href="https://github.com/yiisoft/yii2/graphs/contributors">the Yii community</a> for their support and pull requests! </p><br><p>  You can follow the development process by putting an asterisk on <a href="https://github.com/yiisoft/yii2">GitHub</a> .  Also subscribe <br>  on <a href="https://twitter.com/yiiframework">our twitter</a> and <a href="https://www.facebook.com/groups/yiitalk/">facebook</a> . </p><br><p> Since <a href="">we are working on Yii 2.1</a> , make sure that the version of the framework in <code>composer.json</code> spelled correctly ( <code>~2.0.13</code> ) and you will not upgrade to 2.1 by accident when it is released. </p><br><p>  Below we look at the most interesting improvements and fixes release.  A complete list can be found in <a href="">CHANGELOG</a> . </p><a name="habracut"></a><br><h2 id="shablony-prilozheniy">  Application Templates </h2><br><p>  Both the "basic" and "advanced" <a href="https://asset-packagist.org/">templates</a> now use <a href="https://asset-packagist.org/">asset-packagist.org</a> instead of the Composer asset plugin. </p><br><p>  Vagrant environment in advanced acquired XDdebug-ohm.  Also, it has become even easier to raise.  Required plugins are put automatically. </p><br><p>  The <code>Alert</code> widget has been added to the "basic" template (it was already in "advanced"). </p><br><h2 id="logirovanie-otladka-i-obrabotka-oshibok">  Logging, debugging and error handling </h2><br><p>  Logging, debugging and error handling is what we do every day.  Tools for this should work like a clock providing as much relevant information as possible.  In this release on this topic, the improvements are as follows: </p><br><ul><li>  <code>yii\web\DbSession</code> now uses the error handler's capabilities to display the exception page.  As it turned out, quite often developers forgot to check objects for existence when writing additional data to the database with sessions.  Debugging it was very difficult, because the errors were about the unsuccessful recording in the session.  Now the real reason is shown. </li><li>  Previously, migrations could be created with names of any length.  In this version, restrictions of 180 characters were introduced, since a large length causes problems in some DBMSs.  If exceeded, an exception is thrown. </li><li>  The logs now have milliseconds. </li></ul><br><p>  Among other things, Carsten Brandt improved the exception page by adding some useful buttons: </p><br><img src="https://habrastorage.org/webt/v7/-k/of/v7-koft0ekcldbeecrbt8zzytdw.png"><br><br><h2 id="filtry-dannyh">  Data filters </h2><br><p>  Thanks to the wonderful work of Pavel Klimov, data filters and their integration into the REST API appeared in Yii.  Filters can be used to build complex conditions for data providers.  They are perfectly customizable and fit like <br>  web applications as well as REST API. </p><br><p>  Documentation is available in the " <a href="">Filtering Data Providers using Data Filters</a> " section. </p><br><h2 id="parallelizm">  Parallelism </h2><br><p>  Proper behavior under concurrency is very important for high-load projects.  We fixed a few bugs on this topic.  @kidol corrected the processing of the race condition in <code>yii\mutex\FileMutex</code> .  @dynasource did the same for publishing assets to <br>  case using symbolic links. </p><br><h2 id="konteyner-dependency-injection-i-ego-ispolzovanie">  Container Dependency Injection and its use </h2><br><p>  What has changed: </p><br><ul><li>  Added support for a variable number of parameters in signatures. </li><li>  Dependencies are automatically embedded in the migration designer. </li><li>  Cookies are instantiated through a container. </li></ul><br><h2 id="php-72">  PHP 7.2 </h2><br><p>  PHP 7.2 is close.  <a href="http://php.net/archive/2017.php">RC is published</a> and there will be a stable release soon.  In 7.2 there are significant improvements, but there is also a breakdown of compatibility.  Starting with this release, Yii 2 is fully compatible with PHP 7.2. </p><br><p>  In addition to small changes, there is also a big one that can affect your applications.  Beginning with PHP 7.2, the use of certain keywords in class names <a href="https://wiki.php.net/rfc/object-typehint"><code>   object</code></a> , was prohibited. <br>  Using <code>Object</code> in PHP 7.2 causes a fatal error.  In Yii, there is a class <code>yii\base\Object</code> , which was used as the base class for most framework classes, many extensions, and applications. </p><br><p>  For Yii to work with PHP 7.2, we renamed the class.  <code>yii\base\Object</code> marked as deprecated.  Use <code>yii\base\BaseObject</code> .  Versions Yii 2 to 2.0.13 are not compatible with PHP 7.2. </p><br><p>  More detailed changes required for applications are described in <a href="">UPGRADE</a> . </p><br><h2 id="zaprosy">  Requests </h2><br><p>  The <code>getOrigin()</code> method has been added to the <code>yii\web\Request</code> class.  It returns the <code>HTTP_ORIGIN</code> current CORS request. </p><br><p>  Also, a new filter <code>yii\filters\AjaxFilter</code> , allowing to restrict access to the action of the AJAX controller requests. </p><br><h2 id="bezopasnost">  Security </h2><br><p>  A non-critical <a href="https://cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2017-11516">CVE-2017-11516</a> problem was found and fixed with screening in the error handler in debug mode. </p><br><p>  Security requests increased by <a href="http://www.yiiframework.com/doc-2.0/guide-runtime-requests.html">maintaining a list of trusted proxies</a> .  In the process, we removed the HTTP / HTTPS status via <code>X-Forwarded-Proto</code> by default. </p><br><h2 id="konsol">  Console </h2><br><p>  In the console, there were interesting improvements.  First, the <code>yii\console\ExitCode</code> , which contains constants that can be used for return codes for console commands: </p><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;importData()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ExitCode::OK; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ExitCode::SOFTWARE; }</code> </pre> <br><p>  Secondly, it became possible to display the tables: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> Table::widget([ <span class="hljs-string"><span class="hljs-string">'headers'</span></span> =&gt; [<span class="hljs-string"><span class="hljs-string">'test1'</span></span>, <span class="hljs-string"><span class="hljs-string">'test2'</span></span>, <span class="hljs-string"><span class="hljs-string">'test3'</span></span>], <span class="hljs-string"><span class="hljs-string">'rows'</span></span> =&gt; [ [<span class="hljs-string"><span class="hljs-string">'col1'</span></span>, <span class="hljs-string"><span class="hljs-string">'col2'</span></span>, <span class="hljs-string"><span class="hljs-string">'col3'</span></span>], [<span class="hljs-string"><span class="hljs-string">'col1'</span></span>, <span class="hljs-string"><span class="hljs-string">'col2'</span></span>, [<span class="hljs-string"><span class="hljs-string">'col3-0'</span></span>, <span class="hljs-string"><span class="hljs-string">'col3-1'</span></span>, <span class="hljs-string"><span class="hljs-string">'col3-2'</span></span>]], ], ]);</code> </pre> <br><p>  will lead </p><br><pre> <code class="hljs">‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï§‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï§‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó ‚ïë test1 ‚îÇ test2 ‚îÇ test3 ‚ïë ‚ïü‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï¢ ‚ïë col1 ‚îÇ col2 ‚îÇ col3 ‚ïë ‚ïü‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ï¢ ‚ïë col1 ‚îÇ col2 ‚îÇ ‚Ä¢ col3-0 ‚ïë ‚ïë ‚îÇ ‚îÇ ‚Ä¢ col3-1 ‚ïë ‚ïë ‚îÇ ‚îÇ ‚Ä¢ col3-2 ‚ïë ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïß‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïß‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù</code> </pre> <br><h2 id="bazy-dannyh">  Database </h2><br><p>  Sergey Makinen has implemented an API for managing constraints: </p><br><pre> <code class="php hljs">$connection = Yii::$app-&gt;db; $connection -&gt;createCommand() -&gt;addUnique(<span class="hljs-string"><span class="hljs-string">'unique-username'</span></span>, <span class="hljs-string"><span class="hljs-string">'user'</span></span>, <span class="hljs-string"><span class="hljs-string">'username'</span></span>) -&gt;execute(); $connection -&gt;createCommand() -&gt;dropUnique(<span class="hljs-string"><span class="hljs-string">'unique-username'</span></span>, <span class="hljs-string"><span class="hljs-string">'user'</span></span>) -&gt;execute(); $connection -&gt;createCommand() -&gt;addCheck(<span class="hljs-string"><span class="hljs-string">'check-price'</span></span>, <span class="hljs-string"><span class="hljs-string">'order'</span></span>, <span class="hljs-string"><span class="hljs-string">'price &gt; 0'</span></span>) -&gt;execute(); $connection -&gt;createCommand() -&gt;dropCheck(<span class="hljs-string"><span class="hljs-string">'check-price'</span></span>, <span class="hljs-string"><span class="hljs-string">'order'</span></span>) -&gt;execute(); $connection -&gt;createCommand() -&gt;addDefaultValue(<span class="hljs-string"><span class="hljs-string">'default-balance'</span></span>, <span class="hljs-string"><span class="hljs-string">'account'</span></span>, <span class="hljs-string"><span class="hljs-string">'balance'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) -&gt;execute(); $connection -&gt;createCommand() -&gt;dropDefaultValue(<span class="hljs-string"><span class="hljs-string">'default-balance'</span></span>, <span class="hljs-string"><span class="hljs-string">'account'</span></span>) -&gt;execute();</code> </pre> <br><p>  You can also get various information: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> Schema $schema */</span></span> $schema = $connection-&gt;getSchema(); $fks = $schema-&gt;getTableForeignKeys(<span class="hljs-string"><span class="hljs-string">'user'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($fks <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $fk) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $fk-&gt;onUpdate; }</code> </pre> <br><p>  Those interested can <a href="https://github.com/yiisoft/yii2/commit/e0dde88b87aa135273376aa7344cb3e597f77f67">look at this commit</a> . </p><br><h2 id="interfeysy">  Interfaces </h2><br><p>  We began to smoothly introduce interfaces for some components.  This time it is <code>yii\caching\CacheInterface</code> .  There will be both in 2.0 and 2.1. </p><br><h2 id="migracii">  Migrations </h2><br><p>  The new <code>migrate/fresh</code> command cleans the database and re-apply all migrations. </p><br><p>  The options <code>$compact</code> (makes the output more compressed) and <code>$maxSqlOutputLength</code> (cuts SQL to a specified number of characters) are added to the <code>Migration</code> class. </p><br><h2 id="moduli">  Modules </h2><br><p>  The service module locator is available from its controllers as <code>$this-&gt;module-&gt;get('myComponent')</code> .  If the object cannot be retrieved from it, attempts are made to retrieve the object from the locator service of the parent module.  Since the parent of all modules is an application, the component will eventually be searched for in it. </p><br><p>  This change will make it easier to build insulated modules.  When using <code>$this-&gt;module-&gt;get('myComponent')</code> you automatically get the opportunity to override dependencies from the module configuration, but still rely on the application components. </p><br><p>  Examples can be found in " <a href="">Accessing components from within modules</a> ". </p><br><h2 id="helpery">  Helpers </h2><br><p>  A <code>ArrayHelper</code> <code>setValue()</code> method has been <code>setValue()</code> .  He writes the value to the associative array at the specified path.  If there is no such path, the corresponding keys will be created.  If so, the value will be overwritten.  Two syntaxes are supported: </p><br><pre> <code class="php hljs">ArrayHelper::setValue($array, <span class="hljs-string"><span class="hljs-string">'key.in'</span></span>, [<span class="hljs-string"><span class="hljs-string">'arr'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'val'</span></span>]);</code> </pre> <br><p>  and </p><br><pre> <code class="php hljs">ArrayHelper::setValue($array, [<span class="hljs-string"><span class="hljs-string">'key'</span></span>, <span class="hljs-string"><span class="hljs-string">'in'</span></span>], [<span class="hljs-string"><span class="hljs-string">'arr'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'val'</span></span>]);</code> </pre> <br><p>  Another method in the release is <code>StringHelper::floatToString()</code> .  It converts <code>float</code> to <code>string</code> , but, unlike native casting, it always uses dots as a separator for the whole part. </p><br><h2 id="rbac">  RBAC </h2><br><p>  <code>yii\rbac\DbManager::checkAccess()</code> stopped making extra requests when receiving appointments.  If you stored a hierarchy in the database, the performance after the upgrade is likely to increase.  An additional index was also added to the tables, which made the queries themselves faster. </p><br><h2 id="sovmestimost-s-jquery-30">  JQuery 3.0 compatibility </h2><br><p>  Despite the fact that in Yii 2.1 we are trying to make the framework independent of JavaScript, 2.0 is tied to jQuery.  We updated JS and PHP code for compatibility with jQuery 3.0. </p><br><h2 id="activerecord-i-povedeniya">  ActiveRecord and behavior </h2><br><p>  A new <code>instance($refresh = false);</code> method has been added to the <code>yii\db\ActiveRecordInterface</code> through the new <code>yii\base\StaticInstanceInterface</code> <code>instance($refresh = false);</code>  .  Its purpose is to provide static instances of classes that can be used to obtain various <br>  metadata not available through static methods.  For example, changes made through DI or using behaviors can be made only at the object level, but, in some cases, it would be useful to make them at a static class level. </p><br><p>  <code>yii\behaviors\AttributesBehavior</code> been added.  It assigns values ‚Äã‚Äãto one or more attributes of the ActiveRecord object at certain events.  Unlike <code>yii\behaviors\AttributeBehavior</code> it works with several attributes at once.  In both <code>AttributeBehavior</code> and <code>AttributesBehavior</code> , the <code>preserveNonEmptyValues</code> option has been added.  When set to <code>true</code> it only allows values ‚Äã‚Äãto be overwritten when they are empty. </p><br><p>  Added option <code>skipOnEmpty</code> <code>yii\behaviors\SluggableBehavior</code> <code>skipOnEmpty</code> .  Enabling it prevents the generation of a new slug if the attribute is <code>null</code> or empty. </p><br><h2 id="asset-y">  Assets </h2><br><p>  Resource directory hashing now takes into account symbolic links.  Thereby, cache invalidation was fixed in the case when resources were not updated after the transition from copying to links.  Previously, you had to delete the contents of the assets directory. </p><br><p>  The compression and assembly of resources by the console command now takes into account that many popular libraries do not install <code>;</code>  at the end of the file.  From this, some script combinations did not work. </p><br><h2 id="csrf-i-kesh">  CSRF and cache </h2><br><p>  Added method <code>yii\web\View::registerCsrfMetaTags()</code> .  It registers CSRF tags dynamically, which allows you to be sure that caching does not affect them. </p><br><h2 id="novye-metody-formattera">  New formatter methods </h2><br><p>  The following methods have <code>Formatter</code> added to the <code>Formatter</code> : </p><br><ul><li>  <code>asWeight()</code> formats the number as weight, that is, "12 kilograms". </li><li>  <code>asShortWeight()</code> formats the number as weight in short form, i.e. "12 kg". </li><li>  <code>asLength()</code> formats the number as a length, that is, "12 meters". </li><li>  <code>asShortLength()</code> formats a number as a length in short form, i.e. "12 m". </li></ul><br><p>  <strong>UPDATE:</strong> and <a href="httpclient-mongodb-and-sphinx/">some release extensions</a> . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/341614/">https://habr.com/ru/post/341614/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341600/index.html">Open broadcast of the main hall HighLoad ++</a></li>
<li><a href="../341602/index.html">Modern Android development on Kotlin. Part 1</a></li>
<li><a href="../341606/index.html">Console assistants to work with Kubernetes via kubectl</a></li>
<li><a href="../341608/index.html">Long road in the dunes, or how the ESF engineering subculture changed</a></li>
<li><a href="../341612/index.html">Kaspersky Industrial CTF 2017: seven hours to cut down a plant</a></li>
<li><a href="../341616/index.html">African experiment Bitrix24</a></li>
<li><a href="../341620/index.html">Event digest for HR specialists in the IT field for November 2017</a></li>
<li><a href="../341622/index.html">Future with proxy</a></li>
<li><a href="../341626/index.html">Knowledge base of web development</a></li>
<li><a href="../341628/index.html">Developer Path, Part 4: Towards a Dream</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>