<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vim: bw,: bd,: bun,: quit,: close. What to do with all this?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vim has a lot of commands to close anything and in any combination, but what he doesn‚Äôt know how to close it all with one command. To the person who s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vim: bw,: bd,: bun,: quit,: close. What to do with all this?</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/storage2/1c0/92a/287/1c092a28753f5e811449264996beee71.jpg">  Vim has a lot of commands to close anything and in any combination, but what he doesn‚Äôt know how to close it all with one command.  To the person who started using Vim recently, this may seem rather strange.  Let's try to figure out how to fix this situation. <br><a name="habracut"></a><br><br>  When I first met Vim, my eyes ran away from the abundance of ways <br>  closing files, windows and the editor itself.  Here is a list of commands to delete (close) <br>  buffers and windows (in brackets are the full names of commands): <br><br><ul><li>  <b>: bd [elete]</b> - delete buffer.  Actually just makes the buffer invisible, but <br>  leaves it in memory. </li><li>  <b>: bw [ipeout]</b> - completely erases (wipeout) buffer from memory </li><li>  <b>: bun [load]</b> - removes the buffer from memory, but leaves it in the list of buffers. <br>  Useless team, except when you or <br>  giant file size or extremely little RAM. </li><li>  <b>: close</b> - close the current split.  The buffer is not deleted. </li><li>  <b>: q [uit]</b> - purely theoretically, the team should close Vim, in practice everything is a bit more complicated </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I highly recommend setting the <b>set confirm</b> option to .vimrc, this will allow <br>  avoid annoying error messages when trying to close (delete) the buffer with <br>  not saved changes.  A confirmation will appear instead of an error. <br>  close not saved file. <br><br>  To close a file in the traditional sense (for any other editor) <br>  suitable command <b>: bw</b> , but unfortunately all the commands for working with buffers <br>  have the ugly property to close the window in which, at the moment <br>  they are displayed (of course, if this is not the only window on the screen). <br>  This problem is solved by installing the <a href="http://www.vim.org/scripts/script.php%3Fscript_id%3D1147">bufkill.vim</a> plugin and using the command <br>  <b>: BW (: BD,: BUN)</b> instead of <b>: bw (: bd</b> <b>,:</b> <b>bun)</b> . <br><br>  The command <b>: q</b> should close Vim, but its behavior depends on the situation and is far from <br>  intuitively.  To close a window, use the command <b>: close</b> , but close it with <br>  using the last window you can not.  It is also not possible to close Vim with <br>  delete buffer commands (even if the buffer is the last). <br>  As a result, the empty buffer cannot be deleted, the last window <br>  you can not close and work with multiple files turns into a game "guess what <br>  the command should be used now -: bw,: BW,: q or: close ‚Äù.  After <br>  combing forums, I had to reinvent the wheel because <br>  I did not find the one I needed.  What I needed was so familiar (for others <br>  editors) and an intuitive way to quickly close files, windows and Vim itself. <br><br>  The first problem is to determine the algorithm of the ‚Äúusual‚Äù way to produce everything. <br>  above described.  By trial and error, the algorithm became like this: <br><br><img src="https://habrastorage.org/storage2/ebc/958/2cf/ebc9582cfe3e392c6e3f93cde21faea8.png"><br><br>  At first glance, a little difficult, but when you start to use - everything rises <br>  their places.  Of course, this is not a panacea - windows (not buffers) still need to be closed <br>  using <b>: close</b> . <br><br>  Here is the implementation: <br><br><pre><code class="python hljs">function! CountListedBuffers() let cnt = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> nr <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>,bufnr(<span class="hljs-string"><span class="hljs-string">"$"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> buflisted(nr) let cnt += <span class="hljs-number"><span class="hljs-number">1</span></span> endif endfor <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cnt endfunction function! SmartExit() let s:BufferToKill = bufnr(<span class="hljs-string"><span class="hljs-string">'%'</span></span>) let s:EmptyBuffer = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> bufname(<span class="hljs-string"><span class="hljs-string">'%'</span></span>) == <span class="hljs-string"><span class="hljs-string">''</span></span> &amp;&amp; ! &amp;modified &amp;&amp; &amp;modifiable <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> &amp;buftype == <span class="hljs-string"><span class="hljs-string">'nofile'</span></span> &amp;&amp; &amp;swapfile == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-string"><span class="hljs-string">" Is scratch buffer, not empty else let s:EmptyBuffer = 1 endif endif "</span></span> Get a list of all windows which have this buffer loaded let s:WindowListWithBufferLoaded = [] let i = <span class="hljs-number"><span class="hljs-number">1</span></span> let buf = winbufnr(i) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> buf != <span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> buf == s:BufferToKill let s:WindowListWithBufferLoaded += [i] endif let i = i + <span class="hljs-number"><span class="hljs-number">1</span></span> let buf = winbufnr(i) endwhile <span class="hljs-string"><span class="hljs-string">" Check that the buffer is last if(CountListedBuffers() &lt; 2) let s:LastBuffer = 1 else let s:LastBuffer = 0 endif if s:LastBuffer if len(s:WindowListWithBufferLoaded) &gt; 1 execute "</span></span>close<span class="hljs-string"><span class="hljs-string">" else if ! s:EmptyBuffer execute "</span></span>bw | bw<span class="hljs-string"><span class="hljs-string">" else execute "</span></span>q<span class="hljs-string"><span class="hljs-string">" endif endif else let g:BufKillActionWhenBufferDisplayedInAnotherWindow="</span></span>kill<span class="hljs-string"><span class="hljs-string">" execute "</span></span>BW<span class="hljs-string"><span class="hljs-string">" let g:BufKillActionWhenBufferDisplayedInAnotherWindow="</span></span>confirm<span class="hljs-string"><span class="hljs-string">" endif endfunction</span></span></code> </pre> <br><br>  To work, you must have bufkill.vim installed. <br><br>  As a result, my mapping for ‚Äúclosing everything and everything‚Äù looks like this: <br><br>  "Smart Close" <br>  nmap qq: call SmartExit () "Close the window, but do not delete the buffer <br>  nmap qw &lt;CW&gt; c <br><br>  I use qq much more often, it does exactly what I understand. <br>  should have done: q, but for some reason does not. <br><br>  Closing <br><br><h4>  Total </h4><br>  Vim'om I use recently, but I got the impression <br>  that I will have to write such crutches and bicycles more than once!  But what <br>  To be honest - this is extremely exciting.  Hope this mini plugin or <br>  The information from this article is useful to someone. <br><br>  <i>PS Not for holivar's sake, but how is it with Emacs?</i> <i><br><br></i>  <i>PPS I do not use tabs (tabs), splits within one screen are enough for me,</i> <i><br></i>  <i>they do not solve problems when working with buffers, they just add them.</i> </div><p>Source: <a href="https://habr.com/ru/post/149817/">https://habr.com/ru/post/149817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149812/index.html">Play on QuickTiGame2d in Appcelerator Titanium. Part 1</a></li>
<li><a href="../149813/index.html">The Russian neutron detector at Curiosity has begun work. No water detected yet</a></li>
<li><a href="../149814/index.html">Harvard scientists write 643 kilobytes of data into a DNA molecule</a></li>
<li><a href="../149815/index.html">Basic principles of interaction with the user's computer with visual impairment</a></li>
<li><a href="../149816/index.html">Grids without problems</a></li>
<li><a href="../149818/index.html">What compiler for C ++ do you use?</a></li>
<li><a href="../149821/index.html">Random search heuristics and motor ships</a></li>
<li><a href="../149822/index.html">Screenshots of the new Skype for Windows 8 Metro style</a></li>
<li><a href="../149824/index.html">Installing and configuring memcacheq on CentOS 6.2</a></li>
<li><a href="../149825/index.html">Do you like ‚ÄúMetro‚Äù design apps?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>