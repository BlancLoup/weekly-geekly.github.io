<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Legends of virus construction: the Great Worm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="21 years ago an event occurred forever imprinted itself in the history of the Internet. 

 On November 2, 1988, 99 lines of code caused a two-day shoc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Legends of virus construction: the Great Worm</h1><div class="post__text post__text-html js-mediator-article"><img src="http://www.picamatic.com/show/2009/11/02/05/03/5739933_256x256.png" align="right" alt="image">  21 years ago an event occurred forever imprinted itself in the history of the Internet. <br><br>  On November 2, 1988, 99 lines of code caused a two-day shock paralysis of the still young and inexperienced Internet security affairs. <br><br>  About 6,000 VAX machines running SUN and BSD UNIX operating systems were infected with an unprecedented infection.  Many administrators were forced to disable their wards in order to somehow stop the overload of computers and the spread of infection. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It was the Morris Worm or the common people simply the Great Worm.  Because of the devastating consequences that he had on the Internet, both in terms of overall system downtime, and psychological impact on the idea of ‚Äã‚Äãsafety and reliability on the network (by analogy with the <a href="http://www.catb.org/~esr/jargon/html/G/Great-Worm.html">Great Wolves of</a> Tolkien).  The surprise of the attack and some of the mechanisms built into the worm introduced many admins of that time into borderline emotional states.  The reaction was smeared across the spectrum from ‚Äúdisable everything!‚Äù To panic ‚Äúattack us!‚Äù <br><br>  The creator and initiator of the worm, at that time a student at Cornell University, Robert Morris Jr. (the eldest at the time was doing the exact opposite, he served as scientific supervisor at NCSC (National Computer Security Center)) launched his monster from the MIT computer (prep.ai. mit.edu is an open access machine, so as not to draw attention to your university.  Why he did it will always remain a mystery.  According to his own statements, it was just an experiment that went out of control.  However, strictly speaking, the Worm did not cause any direct damage. <br><br><h4>  A small list of attacked computers </h4><br><br>  MIT, University of Minnesota, North Carolina, University of Pittsburgh, RAND Corporation Machines, Stanford, Berkeley, Carnegie Mellon University, University of Maryland, University of Pennsylvania, Massachusetts University of Technology again, University of Colorado and Purdue University machines and many others . <br><br><h4>  Worm attack vectors </h4><br><br><img src="http://www.picamatic.com/show/2009/11/02/05/03/5739934_311x196.jpg" align="left" alt="image"><br>  The worm used several different paths for propagation, which boil down to exploiting vulnerabilities and the simplest selection of access passwords. <br><br>  The worm consisted of two parts: the loader (99 lines in C language) and the kernel, which consisted of two binary modules ‚Äî the code compiled for BSD and the same code only for the Sun architecture.  The names of all internal procedures had meaningful names (for example, doit or cracksome), which rather strongly facilitated the disassembly of binaries later on. <br><br>  The worm injected its copy on remote computers and launched it.  Every infected computer sought to infect and all other related machines.  The worm was sharpened for use in BSD UNIX and SUN-3.  Finding that such machines are connected to the infected, the worm was copied to a remote computer, launched there, seeking to gain maximum access to the information (using it only to continue hacking), and infect neighboring machines.  Avaline-like propagating through an unprotected network, the worm multiplied its copies in full accordance with the theory of self-replicating mechanisms, the foundations of which were laid by John von Neumann. <br><br>  At first, no one understood anything, but after a few hours the most advanced admins began to act, who, as best they could, someone disconnected their wards from the network and tried to reboot them hoping to remove the overload (which was completely in vain, because when the system was restarted created some more copies of himself and the system load only increased), someone rushed to panic sending messages to the mailing lists - ‚ÄúThey are attacking us!‚Äù (which was also in vain, because the lists did not work for several hours due to the worm‚Äôs actions), and someone  Looking for reasons for the instant distribution of the worm <br><br>  In Berkeley in the evening of the same day they understand that the attack is conducted through rsh and sendmail.  As a precaution, blocking of network services begins. <br><br>  After some time, realizing the scale of the problem that has arisen, Morris informs his friends about an experiment that has gone out of control.  After some time, anonymous posting appeared on the TCP-IP list, briefly describing how to stop the Worm.  The author of the posting (Andy Sudduth) sent this message after a telephone conversation with Morris, but, due to the overload of networks and computers, the letter was not sent within about a day. <br><br>  Soon, the attack vector of the worm began to be discovered independently by different people. <br><br>  The first was the sendmail daemon.  Kate Bostic sends a warning about the Worm and patches to sendmail to the TCP-IP mailing list, the 4bsd-ucb-fixes newsgroup and several system administrators. <br><br>  The worm used the debug feature of the sendmail daemon, which set the debug mode for the current communication session.  An additional feature of the debugging mode is to send messages with the recipient program, which runs on the remote machine and receives the message.  This feature, not covered by the SMTP protocol, was used by developers to debug the program and was left in the working version by mistake. <br><br>  Through sendmail, the worm infects two types of computers ‚Äî VAX and Sun ‚Äî so binary codes were sent for each architecture, both started, but only one could be executed.  In computers of other architectures, programs could not function, although they absorbed system resources at the time of compilation. <br><br>  A few hours later, it turned out that sendmail patches do not help, computers are infected in some other way.  Due to the actions of the worm, <a href="http://en.wikipedia.org/wiki/MILNET">MILNET</a> and <a href="http://ru.wikipedia.org/wiki/Arpanet">ARPANET</a> are disconnected. <br><br>  After a few more hours, different people in different laboratories independently discovered vulnerability and finished patches for the fingerd demon. <br><br>  Fingerd code snippet: <br><br> <code>{ <br> char buf[512]: <br> ... <br> gets(buf); <br> }</code> <br> <br>  There is a classic <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B5%25D1%2580%25D0%25B5%25D0%25BF%25D0%25BE%25D0%25BB%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B1%25D1%2583%25D1%2584%25D0%25B5%25D1%2580%25D0%25B0">buffer overflow</a> situation (then, apparently, it was not yet a classic).  The worm passed a specially prepared string of 536 bytes, which eventually called the execve function (‚Äú/ bin / sh‚Äù, 0, 0).  Only VAX machines with 4.3 BSD operating system were attacked in this way, on Sun computers such attacks failed. <br><br>  But that's not all.  In Nix, both then and now there is a set of services for the remote execution of programs today for such purposes ssh is used, and then its place was taken by so-called r-programs.  The most vulnerable point in them was the idea of ‚Äã‚Äã‚Äútrust‚Äù - computer users that were on the list of ‚Äútrusted sites‚Äù had the right to run their programs on a ‚Äútrusting‚Äù machine without any additional verification.  In addition, the relationship of trust was often mutual.  The worm tried to use the <a href="http://unixhelp.ed.ac.uk/CGI/man-cgi%3Frsh">rsh</a> remote interpreter's launch program to attack other machines with the received name and password of the current user or without authentication at all if the attacked machine ‚Äútrusted‚Äù this. <br><br>  So, the Worm penetrated the neighbors of the infected machine using a hole in sendmail, a hole in fingerd or ‚Äútrust‚Äù and rsh.  When a computer was attacked on an attacked computer, the loader, the command to compile and execute the loader, and erase all temporary files were thrown.  Then the loader would pull in all three files and try to start one, then another body.  If none of the two bodies started, the loader simply erased both themselves and itself, and stopped working. <br><br>  When launched, the Worm disguised itself in every way - erasing its executable file, encrypted both bodies, read them into memory, and also erased it from the disk, and, as far as possible, modified information about itself in the process table. <br><br>  Then, information was collected about the network interfaces of the infected computer and about the neighboring computers, and some of the neighbors were subjected to infection attempts.  Those who managed to infect, were marked as infected;  those that failed to infect - as "immune."  Although here in the worm code, experts tend to perceive an error, since the code section responsible for preventing the reinfection of machines contained many errors. <br><br>  This was key to the resilience of the worm: many machines were re-infected, the load on the systems and the network increased and became very tangible, often leading to a denial of service, with the result that the worm itself was detected and disarmed much faster than if repeated infections did not It was, although repeatedly infected machines spread the worm faster, probably proportional to the number of copies of the worm on the machine, which affected the lightning speed of the spread, and denials of service led to panic and  some key nodes failed, causing the network to collapse into subnets for a while. <br><br>  Passwords were selected in a rather simple, but at the same time, efficient way: four variations were used on the user's login, as well as a list of approximately 200-400 words.  According to some reports, on individual computers, more than half of the passwords were opened in this way. <br><br>  By the evening of November 5, the majority of the infected nodes were cured, patches were applied, and specialists at Berkeley prepared a breathless worm‚Äôs carcass. <br><br>  By the time the FBI realized who was guilty of what had happened, Morris was already going to surrender. <br><br><h4>  Mark on history </h4><br><br>  For the computer community, it was a shock.  The fundamentals of computer security were revised.  The damage caused by the Morris Worm was estimated at about $ 100 million (such estimates should be treated very, very carefully, since what are the methods for estimating them, which parameters are considered and which are not, is unknown). <br><br>  According to some information, the Worm is the only computer program in history which has pressed on the front pages materials about the presidential elections in the United States.  Many institutions and organizations have disconnected from the Internet for several weeks and even months.  Administrators, not presenting the real extent of the danger, decided to play it safe. <br><br>  The most reasonable measure of countering hacking, provoked by the Worm, was the formation of <a href="http://en.wikipedia.org/wiki/CERT_Coordination_Center">CERT</a> . <br><br><h3>  PS </h3><br><br>  In any software, there may be errors that threaten various vulnerabilities.  Gradually, the Internet is dragging us deeper and deeper, causing a catastrophic dependence, meanwhile, the average user qualification falls below the baseboard.  The user does not want to know anything about the computer (and this, of course, is not so scary, it is simply inevitable). <br><br>  Here the system administrator must be vigilant, must constantly monitor the safety of their wards.  However, alas, very often this is not the case and enikeyschiki sit at the posts of system administrators. <br><br>  A good administrator is always paranoid. <br><br><h4>  To this topic: </h4><br><br>  ‚Üí <a href="http://www.foo.be/docs-free/morris-worm/">Source Code of the</a> Morris Worm <br>  ‚Üí English <a href="http://en.wikipedia.org/wiki/Morris_worm">wiki article</a> about Worm <br>  ‚Üí Russian <a href="http://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B5%25D1%2580%25D0%25B2%25D1%258C_%25D0%259C%25D0%25BE%25D1%2580%25D1%2580%25D0%25B8%25D1%2581%25D0%25B0">wiki article</a> about the Worm <br>  ‚Üí Detailed analysis of <a href="http://bugtraq.ru/library/books/attack/chapter09/04.html">the</a> Worm <a href="http://bugtraq.ru/library/books/attack/chapter09/04.html">device</a> </div><p>Source: <a href="https://habr.com/ru/post/74095/">https://habr.com/ru/post/74095/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../74087/index.html">Making Pidgin beautiful as Adium</a></li>
<li><a href="../74091/index.html">Wikiproject Overview</a></li>
<li><a href="../74092/index.html">How does the smart card</a></li>
<li><a href="../74093/index.html">Music Gourmet Player</a></li>
<li><a href="../74094/index.html">Habrobanner</a></li>
<li><a href="../74096/index.html">Computer World Update</a></li>
<li><a href="../74100/index.html">Restore / var / lib / dpkg / status</a></li>
<li><a href="../74101/index.html">Ubuntu moblin remix</a></li>
<li><a href="../74104/index.html">What is the color of the universe?</a></li>
<li><a href="../74105/index.html">Fix png in IE6 with expression, one class and no single pixel gif</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>