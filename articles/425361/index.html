<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Content blocking, chromium browser extension</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The main trend of this year is ‚Äúblocking,‚Äù the expansion described below, which makes it possible to feel the power over content in the browser. 


 I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Content blocking, chromium browser extension</h1><div class="post__text post__text-html js-mediator-article">  The main trend of this year is ‚Äúblocking,‚Äù the expansion described below, which makes it possible to feel the power over content in the browser. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5z/xa/qt/5zxaqtw2ht7fmiwgbaqfjeuiswq.png"></div><br>  I remember a long time ago, in my childhood, when watching TV, during advertising blocks, there was always a certain break as a school break, to go to the kitchen or a latrine, to switch through other channels, with age a smoke break was added. <br><br>  Now I rarely watch TV, I read news on the Internet, I use ad blockers.  On the phone when they call and try to impose financial services or a window master, I hang up.  Sometimes, with rare exceptions, there are interesting or fun commercials, but even such videos after the second viewing turn into regular advertising. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A couple of years ago, I noticed that on all news sites, one could not say a day went by without news about bloggers: there is a conflict among bloggers or bloggers in the State Duma.  A blogger is such a ‚Äúsome kind of new name‚Äù and, as usual, ‚Äúthe very, very‚Äù blogger of all the other bloggers.  At the same time, they rarely write criteria for why he is ‚Äúthe most, the most‚Äù, so that the reader can watch videos or search the Internet, which is in the next blogger ‚Äúhimself, himself‚Äù.  Bloggers are introducing a new word ‚Äúsandpaper‚Äù, bloggers are up in arms, bloggers are doing their show. <br><br>  The last year about news bloggers has become less, the leader now ‚ÄúB ... wa‚Äù, I don‚Äôt specifically mention, there is a risk to turn the article into another news about ‚ÄúB ... woo‚Äù, and so every day there is new news.  Journalists are often literally forced to follow the link. <br><a name="habracut"></a><br>  I would write a few more examples, but I will not, as the one described above is not an attempt to be good myself by criticizing others.  With any things can be brute force or overdose.  I am more than confident that everyone has their own ‚Äúleaders‚Äù in the news, which they would prefer not to see, without them their day would be better. <br><br>  The above examples are in fact a kind of advertising, but spreading in the form of news, do not fall under any ad blockers.  Many browsers have built-in ad blocking, but unfortunately, there is no way to block content by words in the content.  I tried to search in extensions, but I did not find it with the necessary description, ad blockers caught my eye, who seemed to be able to block by words, but did not try to install.  I saw, recently, several articles that not all extensions are safe, and it is more interesting to write your own, simple, only with the necessary function of cutting out the content. <br><br>  There are many articles on creating extensions, but this article is not an instruction for creating. <br>  The first version of the expansion turned out just a couple of hours, the algorithm for cutting out is simple and versatile.  The flip side of universality is that the algorithm may not be suitable for all sites.  But for the visibility of the expansion, I had to write a lot more code to display the counters, the hidden content for each page. <br><br>  The content_script.js part is the main content blocking logic: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> search = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.evaluate(<span class="hljs-string"><span class="hljs-string">'/html/body//*[contains(., "...") and count(child::node())&lt;childsLimit]'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, XPathResult.ORDERED_NODE_ITERATOR_TYPE, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> thisHeading = search.iterateNext(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (thisHeading) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (thisHeading.tagName !== <span class="hljs-string"><span class="hljs-string">'script'</span></span> &amp;&amp; thisHeading.style.display != <span class="hljs-string"><span class="hljs-string">'none'</span></span>) { thisHeading.style.display = <span class="hljs-string"><span class="hljs-string">'none'</span></span>; } thisHeading = search.iterateNext(); }</code> </pre> <br>  In the above fragment, you can see that the ‚Äúdocument.evaluate‚Äù method is used.  When searching for text in the tags, the root elements also fall into the results.  For example, the text of the entire page, the text of the news block, etc.  To eliminate unnecessary elements, use the second condition on the number of nested child.  In my case, the number 9 came up. On three sites, the excess is hidden quickly and simply, although sometimes there is a photo on one of the sites in a certain block, but without a link to the news and links to the picture. <br><br>  There was initially a desire to make an extension settings page, maybe I will do later.  In the meantime, the main settings are made right in the code. <br><br>  Part of background.js - content blocking settings: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> childsLimit = <span class="hljs-number"><span class="hljs-number">9</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> blockString = <span class="hljs-string"><span class="hljs-string">'[contains(., "...") and count(child::node())&lt;childsLimit]'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> blockOnlyUrlOpt = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> urlOptions = [{<span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'https://exampleSite.com'</span></span>, <span class="hljs-attr"><span class="hljs-attr">unBlock</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">childsLimit</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>}];</code> </pre><br>  The first variable "childsLimit" allows you to set the overall level of nesting, blocking elements. <br><br>  The second variable ‚ÄúblockString‚Äù contains the xpath condition, when adding a new word, you must copy everything together with square brackets and add it to the end with the word ‚Äúor‚Äù and then replace the word search with quotation marks. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> blockString = <span class="hljs-string"><span class="hljs-string">'[contains(., "1") and count(.//*)&lt;childsLimit] or [contains(., "2") and count(.//*)&lt;childsLimit]'</span></span>;</code> </pre><br>  The third variable ‚ÄúurlOptions‚Äù allows you to make fine-tuning for different sites. <br>  Property "url" - contains the address for which the setting will be applied. <br>  The ‚ÄúunBlock‚Äù property - a boolean value true allows not to block content on the site specified in the ‚Äúurl‚Äù <br>  The "childsLimit" property is the nesting level of the blocked content item. <br>  The fourth variable, blockOnlyUrlOpt, allows you to define common logic.  If the value is ‚Äútrue‚Äù, the blocking works only on the sites listed in the variable array ‚ÄúurlOptions‚Äù, where the ‚ÄúunBlock‚Äù property is equal to ‚Äúfalse‚Äù. <br><br>  <a href="https://github.com/PloAl/ContentBlocking">Extension files are available by reference.</a> <br><br>  To install you need: <br><br><ul><li>  Download all the files in any convenient folder. </li><li>  In the browser, go to the extension and enable developer mode. </li><li>  By the button ‚ÄúLoad unpacked extension ...‚Äù specify a folder from item one. </li></ul><br>  Developed and tested in Opera browser, it should also work with other chromium browsers. </div><p>Source: <a href="https://habr.com/ru/post/425361/">https://habr.com/ru/post/425361/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../425351/index.html">Programmers do their own jobs</a></li>
<li><a href="../425353/index.html">The whole truth about the RTOS. Article # 13. Task data structures and unsupported API calls</a></li>
<li><a href="../425355/index.html">ICO-projects security rating</a></li>
<li><a href="../425357/index.html">How we put together a 12-story technology stack and weren‚Äôt crazy</a></li>
<li><a href="../425359/index.html">The Chinese used a microchip to control American computers.</a></li>
<li><a href="../425363/index.html">Tips for student programmers</a></li>
<li><a href="../425367/index.html">Simplest Arduino Game with Display 1602 - Part # 2</a></li>
<li><a href="../425369/index.html">KTRU (Catalog of goods, works, services) or the death of IT public procurement</a></li>
<li><a href="../425371/index.html">Node.JS: a library for modifying http responses</a></li>
<li><a href="../425373/index.html">QA Fest 2018: Review of the Main QA Conference of Ukraine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>