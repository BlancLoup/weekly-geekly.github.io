<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Puzzle game Neo Angle. Work with levels in Unity</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all! I would like to tell you the story of my new puzzle game Neo Angle, as well as share the experience of importing, storing and generat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Puzzle game Neo Angle. Work with levels in Unity</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/ec2/9a3/270/ec29a327056e49929da86e428eb359f8.png"><br><br>  Good day to all!  I would like to tell you the story of my new puzzle game Neo Angle, as well as share the experience of importing, storing and generating levels in Unity. <br><a name="habracut"></a><br>  I will begin with a brief background of 5 years ago, when I decided to take up game dev, having first become acquainted with the programming language action script 3.0 (for developing flash games) at the university. <br><br>  Having finished the semester, I decided that I could master my own game.  So, after sitting for a while behind a notebook and a karadash, the idea of ‚Äã‚Äãa puzzle with triangles came in, where a player needs to fill a given shape by turning a triangular stone and finish the level on the finish cell. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Thus, having spent a week on development alone, my first flash game <i>SeaQuest</i> was released. <br><br><img src="https://habrastorage.org/files/686/e21/3d4/686e213d47f442cda61613acbede3ef7.PNG"><br><br>  And I suffered to develop further.  After releasing some more portal flash drives, I returned to the idea with triangles, which led to a new part, where the gameplay was completely redesigned, namely, additional interactive objects were added: buttons with obstacles, teleports and rotators.  The goal of the level has also changed, now it was necessary to collect all the pearls and come to the finish line. <br><br><img src="https://habrastorage.org/files/09c/b5f/680/09cb5f680722477eb90995a907bf43b0.jpg"><br>  <i>The result is called Stone Quest</i> <br><br>  On this line of logic games ended and was successfully forgotten by me. <br><br>  This was followed by the promised collapse of the flash industry, which threw me into the unity development for mobile.  And so, in December 2016, quite by chance, the thought of triangular-oriented puzzles returned to my head.  Especially pushed to the development of the fact that the gameplay is great for touchscreen.  It was decided to use the mechanics of the previous game, but with a different styling. <br><br>  Here is a background that led to the active development of a month and a half.  Most of the work, oddly enough, went into game design.  From the previous version, almost all levels seemed to me not interesting enough, although the possibilities of gameplay have much greater potential.  As a result, development began with the level editor, which I wrote for the evening in the good old flash, with the ability to test written levels and export / import them in xml. <br><br>  The result of the work in the editor is shown below: <br><br><img src="https://habrastorage.org/files/ad4/97e/1fc/ad497e1fccf740e886db98f0b1a62beb.gif"><br><br>  Before moving on to working with Unity, I needed to make sure that I could provide enough levels for a mobile game that requires a variety of content.  Therefore, for the first week and a half I didn‚Äôt even open Unity, but I worked in my editor, at the same time doing graphics.  By the way, the 80s' retro-style synthwave, which is gaining popularity, was chosen.  It is quite simple in execution, while being very attractive. <br><br><img src="https://habrastorage.org/files/318/065/742/3180657424bb42e2a5f0fd9ec7b527db.png"><br><br>  Thus, having created a valid set of levels, I proceeded to porting them to Unity, continuing to spend some of my time refining and creating new ones. <br><br>  In this regard, the following questions arose: how to import, store and generate levels in Unity from the xml file? <br><br>  There were three possible solutions: <br><br>  1. When starting the game, read the xml file and dynamically create levels each time at runtime. <br>  2. In edit mode, generate levels and create for each stage. <br>  3. In edit mode, generate levels and create for each prefab. <br><br>  Obviously, the first option is not the best, because  all levels are prepared in advance and there is no sense to re-create them each time.  The second option is more suitable for more complex and large-scale projects, where each level has its own logic, interface, structure, etc.  In my case, I would have to duplicate interfaces and key objects in each scene with a level, and every time ui changes, all scenes would need to be updated.  It remains the last third option, which is just very well approached.  On its implementation, I will continue the story. <br><br>  To work with objects in edit mode, add a custom panel in the Unity editor.  To do this, create a class inherited from <i>EditorWindow</i> in the <i>Assets / Editor</i> folder and add the following method there: <br><br><pre><code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">MenuItem (</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Window/Level Loader"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-comment"><span class="hljs-comment">// Level Loader -     Window. public static void ShowWindow () { EditorWindow.GetWindow(typeof(LevelLoader)); // LevelLoader -    }</span></span></code> </pre> <br>  Immediately check that the panel is created in <i>Window -&gt; Level Loader</i> : <br><br><img src="https://habrastorage.org/files/085/0c8/de9/0850c8de96274f09aee9da914009aa1d.png"><br><br>  Further, in the OnGUI method, you can start adding buttons and fields for our window. <br><br>  Basic examples: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnGUI</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GUILayout.Label (<span class="hljs-string"><span class="hljs-string">"Custom Label"</span></span>, EditorStyles.boldLabel); <span class="hljs-comment"><span class="hljs-comment">//   //     GameObject GameObject customGO = EditorGUILayout.ObjectField(customGO, typeof(GameObject), true) as GameObject; int customInt = EditorGUILayout.IntField(customInt); //     int  EditorGUILayout.Space(); //    if (GUILayout.Button("Custom Button")) //      { ButtonHandler(); } }</span></span></code> </pre> <br>  More information on the components can be found in the official documentation.  And I will continue the description of my Level Loader'a, demonstrating the principle of operation below: <br><br><img src="https://habrastorage.org/files/481/20f/456/48120f456a664d93acfa7616658b91ba.gif"><br><br>  First, we read the levels from the xml file by clicking on Read Levels, then a drop-down list is created with a choice of level and additional controls appear that allow you to generate a level on the stage, create a prefab of the selected level, recreate prefabs of all levels, show / hide numbers fields (for testing drawing and tracking errors). <br><br>  To create objects on the scene in edit mode, the standard function <i>Instantiate is used</i> , and to delete <i>DestroyImmediate</i> . <br><br>  For a while, I created the prefabs of levels manually, dragging them from the stage to the Resources folder.  However, I quickly got tired of it and I got into the Internet for information on how to create prefabs in edit mode using software.  Below is a construction to do this: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateLevelPrefab</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameObject levelGO = GameObject.FindGameObjectWithTag(<span class="hljs-string"><span class="hljs-string">"Level"</span></span>).gameObject; <span class="hljs-comment"><span class="hljs-comment">//   Level      Object levelPrefab = EditorUtility.CreateEmptyPrefab("Assets/Resources/"+levelGO.name+".prefab"); EditorUtility.ReplacePrefab(levelGO, levelPrefab, ReplacePrefabOptions.ConnectToPrefab); }</span></span></code> </pre> <br>  Next, in game mode, the levels are added to the scene as follows: <br><br><pre> <code class="cs hljs">GameObject levelGO = Instantiate (Resources.Load (<span class="hljs-string"><span class="hljs-string">"Level"</span></span>+levelNum) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GameObject);</code> </pre> <br>  Thus, the stages of adding levels turned out the following: <br><br><ul><li>  Creating / editing a level in a flash editor and then exporting to xml </li><li>  Read xml level in unity </li><li>  Level generation on stage in edit mode </li><li>  Create / update prefab level in the Resources folder </li></ul><br>  That's all.  For me, this was the first experience with objects in edit mode.  I will be glad to get acquainted with your ideas about the implementation of the level editor directly in Unity, passing Flash. <br><br>  <b>Thanks for attention!</b>  You can play the game on <i>Google Play</i> at the request of <b>Neo Angle</b> . </div><p>Source: <a href="https://habr.com/ru/post/322704/">https://habr.com/ru/post/322704/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322692/index.html">How to understand who you are: Junior, Middle or Senior?</a></li>
<li><a href="../322694/index.html">How a two-year repository on GitHub has become a trend in 48 hours</a></li>
<li><a href="../322696/index.html">EMC DPO: How to protect your products from fakes</a></li>
<li><a href="../322700/index.html">The hunt for the mythical MVC. User Interface Building</a></li>
<li><a href="../322702/index.html">Mechanical Shakespeare: Are machines capable of literary creativity?</a></li>
<li><a href="../322706/index.html">Social bots: who, how and why use bots?</a></li>
<li><a href="../322708/index.html">Data Science Weekend March 3-4</a></li>
<li><a href="../322710/index.html">Primitives for implementing 1-Wire master using PWM and ICP on AVR AtMega microcontrollers</a></li>
<li><a href="../322712/index.html">Arrested the alleged organizer of the MIRAI botnet attack on the provider Deutsche Telekom</a></li>
<li><a href="../322714/index.html">NetScaler Unified Gateway: a secure solution for applications through a single URL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>