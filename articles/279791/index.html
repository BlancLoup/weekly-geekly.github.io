<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We go around the antivirus with ten lines of code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The information security specialist under the nickname evasiv3 published last week an entry in his blog that tells how you can work around any antivir...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We go around the antivirus with ten lines of code</h1><div class="post__text post__text-html js-mediator-article">  The information security specialist under the nickname <a href="https://twitter.com/evasiv3">evasiv3</a> published last week an entry in his blog that tells how you can work around any antivirus with ten lines of code. <br><br>  Initially, Evasiv3 planned to write a huge post about ways to bypass anti-virus protection, however, after testing the first step of its ‚Äúmanual‚Äù, he was very surprised: none of the 56 products tested, designed to ensure the safety of the user on the network, did not find his binary. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f16/b5c/c47/f16b5cc474a47c6c9ab873df9f960856.png" alt="image"><br><blockquote>  After obtaining a similar result, I decided to abandon my idea of ‚Äã‚Äãa long and exhausting round of anti-virus protection and act quickly, ‚Äúdirty‚Äù, but it is incredibly simple. </blockquote><br><a name="habracut"></a><br>  In his work, evasiv3 used <a href="https://www.veil-framework.com/framework/veil-evasion/">Veil-Evasion</a> , part of the <a href="https://www.veil-framework.com/">Veil-Framework</a> .  The author marks him as "an excellent tool that almost never let him down." 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The code presented below is written in C ++ and is focused on the attack, first of all, of the windows-platform: <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;windows.h&gt; #include &lt;iostream&gt; int main(int argc, char **argv) { char b[] = {/* your XORd with key of 'x' shellcode goes here ie 0x4C,0x4F, 0x4C */}; char c[sizeof b]; for (int i = 0; i &lt; sizeof b; i++) {c[i] = b[i] ^ 'x';} void *exec = VirtualAlloc(0, sizeof c, MEM_COMMIT, PAGE_EXECUTE_READWRITE); memcpy(exec, c, sizeof c); ((void(*)())exec)(); }</span></span></span></span></code> </pre> <br>  The above code creates an array of characters with a shell code, performs an XOR operation with an incredibly complex key "x" in lower case, allocates some memory, copies the array into it, and then executes it. <br><br>  If you now think "oh well!", Then you have the same reaction as that of Evasiv.  The fact that the binary was detected by 0 of the antiviruses out of 56 after checking it through VirusTotal adds fuel to the fire.  The AV bypass shown above shows that the simplest and most basic penetration method is still working. <br><br>  Of course, most antiviruses are focused on curbing the exploitation of vulnerabilities, and not on identifying them, so it‚Äôs too early to ‚Äúbury‚Äù them. <br><br>  <i>The screenshot at the beginning of the article shows the date for 2015, however, the author of the code rechecked the VirusTotal binary before <a href="http://www.attactics.org/2016/03/bypassing-antivirus-with-10-lines-of.html">publishing it on his blog</a> .</i>  <b>The result is the same: 0 out of 56.</b> </div><p>Source: <a href="https://habr.com/ru/post/279791/">https://habr.com/ru/post/279791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../279779/index.html">Case design: Coral Order e-commerce website</a></li>
<li><a href="../279781/index.html">Reg.ru fell along with all its services</a></li>
<li><a href="../279785/index.html">Make an autonomous photo booth on raspberry pi</a></li>
<li><a href="../279787/index.html">The main threats to site security</a></li>
<li><a href="../279789/index.html">Game development digest</a></li>
<li><a href="../279793/index.html">April 8 - learn everything about the Microsoft Azure cloud in one cloudy day</a></li>
<li><a href="../279797/index.html">How to use parquet and not slip</a></li>
<li><a href="../279799/index.html">Building Android applications step by step, part three</a></li>
<li><a href="../279801/index.html">IBM transferred almost 44,000 lines of code to the open-source blockchain project to the Hyperledger Project</a></li>
<li><a href="../279803/index.html">We select valid mobile numbers of VK friends in Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>