<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using the QtCreator Mode Panel + 2 Plugins</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Following the notes on plug-in development for QtCreator, this article describes how to place widgets directly in the mode switching panel. With a scr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using the QtCreator Mode Panel + 2 Plugins</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/getpro/habr/post_images/49c/f7b/3e6/49cf7b3e62ab96b709767a9b3e95ab4e.png"><br>  Following the notes on plug-in development for QtCreator, this article describes how to place widgets directly in the mode switching panel.  With a screen resolution of 1920x1080, there remains over 373x70 pixels of free space in it, which can be usefully used in its plugin.  As an example, two new plugins for QtCreator are provided.  Descriptions of the plug-ins, links to source repositories and binaries compiled for Windows and Linux for QtCreator 3.xx are attached. <br><a name="habracut"></a><br><h4>  Api Description </h4><br>  First of all, you need to create a plugin (in the dialog <i>File-&gt; New File or Project ...</i> select the project type <i>Libraries-&gt; Qt Creator Plugin</i> ).  In the project creation dialog, you will need to specify the path to the QtCreator source codes (which you got from the git repository) and the directory with the QtCreator compiled.  We assume that the framework of the plugin has been created and proceed to the description of Api for placing widgets.  In this case, Api will be understood as methods available to the plugin developer (located in <i>public</i> and not included in the namespace <i>Internal</i> ). <br><br>  You can add widgets both during plug-in <i>initialization</i> (in the <i>initialize</i> function) and after initializing all the plug-ins on which it depends (in the <i>extensionsInitialized</i> function). <br>  There are three ways to use the modes panel: add widgets (QWidget), add actions (QAction), and add modes (IMode derivatives).  In all cases, you will need to include the mode manager header file: <br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;coreplugin/modemanager.h&gt;</span></span></span></span></code> </pre> <br><h5>  1. Adding Widgets (QWidget) </h5><br>  Adding a widget is done using the static function <i>Core :: ModeManager :: addWidget (QWidget * widget)</i> . <br>  Consider the code that adds a simple label (QLabel) to the panel.  To do this, in the implementation of the <i>initialize</i> function of the plugin, add the following code: <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  -    QWidget *container = new QWidget(); //  QLabel *info = new QLabel(QString::fromUtf8("hello habrahabr!")); //    ,       info-&gt;setStyleSheet(QString::fromUtf8("QLabel {color: white; }")); //  QHBoxLayout *containerLayout = new QHBoxLayout(); //     containerLayout-&gt;addWidget(info); //  -    container-&gt;setLayout(containerLayout); // -   Core::ModeManager::addWidget(container);</span></span></code> </pre><br>  If you run this example, it will be seen how, having contained the entire caption, the panel ‚Äústretched out‚Äù in width. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ba0/8ee/7a0/ba08ee7a0fd4c53d1448d5ecd5b53739.png"></div><br>  For size control, it will be useful for QHBoxLayout to independently define indents, distances between widgets and also to fix the maximum size of the widget container, then the widgets located in the container will ‚Äúshrink‚Äù to the specified size and you can modify them: <br><pre> <code class="cpp hljs">containerLayout-&gt;setContentsMargins(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); containerLayout-&gt;setSpacing(<span class="hljs-number"><span class="hljs-number">0</span></span>); container-&gt;setMaximumWidth(<span class="hljs-number"><span class="hljs-number">70</span></span>);</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/38f/de9/9f2/38fde99f204d88e5c62593db8e714130.png"></div><br>  In the above code, the indents are zero and the widget may take the maximum available size (70).  If you change the left and right margins, the value of the maximum width for the widget also needs to be reduced by the sum of the left and right margins. <br><br>  In height is available all the free space.  But it should be borne in mind that if the widget begins to claim the space occupied by the mode buttons, they will move around (while hiding the icons, as shown in the figure): <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c5/6b0/4e0/5c56b04e00ef497b5e23ffb6b6fa290f.png"></div><br>  This is worth remembering if you intend to use the plug-in on a computer with a relatively low resolution (for example, like on my laptop: at a resolution of 1366x768 without a ‚Äúcutback‚Äù I could barely fit 2 plug-ins listed at the end of the article).  You can simulate this situation by setting a larger minimum value for the height of the widget container, for example: <br><pre> <code class="cpp hljs">container-&gt;setMinimumHeight(<span class="hljs-number"><span class="hljs-number">600</span></span>);</code> </pre><br><h5>  2. Adding actions (QAction) </h5><br>  Adding actions is performed using the function: <br><pre> <code class="cpp hljs">Core::ModeManager::addAction(QAction *action, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> priority)</code> </pre><br>  where action is a necessary action (created by the developer), and priority determines the order in which actions are to be placed.  The smaller the value, the lower will be the button to activate the action among others (Run, Start Debugging, Build Project) <br>  In the example below, an action (QAction) is created, which (for example) will run the installer build script (for example, NSIS): <br><pre> <code class="cpp hljs">QAction *buildInstallerAction = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QAction(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); buildInstallerAction-&gt;setIcon(QIcon(QString::fromUtf8(<span class="hljs-string"><span class="hljs-string">":/icons/icons/nsis48x48.png"</span></span>))); buildInstallerAction-&gt;setText(QString::fromUtf8(<span class="hljs-string"><span class="hljs-string">"Build installer"</span></span>)); Core::ModeManager::addAction(buildInstallerAction, <span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br>  The text ‚ÄúBuild installer‚Äù will be displayed in ToolTip.  Since the priority is ‚Äú0‚Äù, the action call GUI will be at the bottom, as shown in the figure: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ec3/426/a44/ec3426a446f7ce67b19d97a7942bf043.png"></div><br>  Images for QIcon should be used with a size of 32x32 px, since the larger ones will still be compressed to that size. <br>  <i>Note:</i> if you need to add a lot of actions, then you may want to consider adding a QToolBar to QtCreator: <br><pre> <code class="cpp hljs">QMainWindow *mainWindow = qobject_cast&lt;QMainWindow *&gt; (Core::ICore::mainWindow()); QToolBar *toolbar = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QToolBar(); toolbar-&gt;addAction(action); mainWindow-&gt;addToolBar(Qt::TopToolBarArea, toolbar);</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4b7/796/7c6/4b77967c6577ab99d868fc045adb96e1.png"></div><br>  You can also add actions to the project selection area using the function <br><pre> <code class="cpp hljs">Core::ModeManager::addProjectSelector(QAction *action);</code> </pre>  but due to the specificity of the purpose of this area (the choice of the current project and the type of assembly) its use in plug-ins seems to me not promising. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  3. Creating a new mode </h5><br>  Currently there are 7 modes in QtCreator (from <i>‚ÄúWelcome‚Äù</i> to <i>‚ÄúHelp‚Äù</i> ).  If you want to create your own mode, then it will be necessary to create the corresponding class, inheriting from Core :: IMode, and then add it to the extension system: <br><pre> <code class="cpp hljs">ExtensionSystem::IPlugin::addObject(myMode);</code> </pre><br>  Creating a new mode (IMode) may be necessary if there is not enough display capacity in the Output Panel (OutputPanel).  For example, if you decide to create a UML editor integrated into QtCreator.  This topic is quite voluminous, so we will not consider it in this article and proceed directly to the plugins. <br><br><h4>  Plugin for displaying user statistics Habrahabr </h4><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f6a/9a3/971/f6a9a3971181faf205da4f6cbacb8c3d.png"></div><br>  Suppose you have written an article and placed it on Habr√©.  It is reasonable to assume that you are interested in how the community perceived it.  There are not many options here: either it will be evaluated positively and, as a result, the rating will rise, or negatively - then the rating will fall.  There is a third option, when the article among users Causes the desire to put a minus in karma.  In this case, it may be worth it (until it is too late) to remove the article from the publication.  Of course, you can write a script and put it in cron on the server that will monitor these indicators and, in the case of a minus, send an SMS message to the user, but in my opinion this is too much.  However, each time, switching from IDE to the browser only to see the statistics, the developer spends not only time, but also attention.  In such situations, I recall the phrase: "If you repeat any sequence of actions more than 5 times, then this sequence needs to be automated."  So actually the idea of ‚Äã‚Äãa small automation appeared, which will allow monitoring the state of affairs without interrupting programming. <br><br>  The developed plug-in for a given user with a certain periodicity (which is also set in the settings in the range from 1 to 60 minutes) accesses the site's api (http://habrahabr.ru/api/profile/username/), receives xml data, parses them and updates the values ‚Äã‚Äãof karma and rating.  Settings are located on the ‚ÄúHabrahabr‚Äù tab of the ‚ÄúEnvironment‚Äù section. <br>  It should be noted that during testing of the plug-in, it was noted that the values ‚Äã‚Äãobtained through api may be lagging behind the data on the site. <br><br>  References: <br><ul><li>  <a href="https://sourceforge.net/p/habrastataplugin/src/HEAD/tree/trunk/">Sources</a> </li><li>  <a href="https://sourceforge.net/projects/habrastataplugin/files/Precompiled_Binaries/">Plugin compiled for different platforms</a> </li></ul><br><h4>  Audio Player Control Plugin </h4><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/609/679/e4a/609679e4a140e68ce243694492a6ec3c.png"></div><br>  This plugin is designed to control audio playback without leaving the development environment.  It uses <a href="http://habrahabr.ru/post/217779/">emulation of pressing multimedia keys</a> (i.e., it controls a working audio player).  After installing the plug-in in QtCreator, a panel with three buttons appears: go to the previous track, switch between pause and audio playback, and go to the next track. <br><br>  The plugin was tested with Aimp, iTunes and Audacious audio players. <br>  References: <br><ul><li>  <a href="https://sourceforge.net/p/audiocontrolplugin/src/HEAD/tree/trunk/">Sources</a> </li><li>  <a href="https://sourceforge.net/projects/audiocontrolplugin/files/Precompiled_Binaries/">Plugin compiled for different platforms</a> </li></ul><br><br>  To install both plugins, the contents of the archives must be unpacked into the directory where the plugins are located: <br>  <i><u>for Windows,</u></i> typically C: \ Qt \ Tools \ QtCreator \ lib \ qtcreator \ plugins. <br>  <i><u>for Lunux-based systems</u></i> /home/username/Qt5.2.0/Tools/QtCreator/lib/qtcreator/plugins when installing Qt in the user directory.  Or (as an option) /opt/Qt5.2.0/Tools/QtCreator/lib/qtcreator/plugins (installed on Ubuntu). <br><br><h4>  Conclusion </h4><br>  Perhaps the reader will have the idea of ‚Äã‚Äãan interesting plugin (please write about it in the comment or in a personal message to the author).  Using the described api you can, for example, create a plugin that will display the build status on the server <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/559/d16/998/559d169982d0819fbf1c6ff1bd73fb05.png"></div>  or a plugin that will display the time spent programming from the moment the IDE was launched and signal every N minutes: ‚ÄúYou have been working without a break for N minutes already‚Äù (short breaks are useful both for health and for productivity).  The last plugin can be developed into a system for collecting statistics on the project, which will allow you to analyze how much time is spent on development as a whole and for each file (and possibly a class / function, since api allows).  But this is a topic for a separate article. </div><p>Source: <a href="https://habr.com/ru/post/218311/">https://habr.com/ru/post/218311/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../218297/index.html">Identification of fast thermal processes</a></li>
<li><a href="../218299/index.html">The artist in the gaming industry: the organization of the workflow</a></li>
<li><a href="../218301/index.html">Kiev Ciklum Dynamics: CRM developers' internship course (participation is free)</a></li>
<li><a href="../218303/index.html">We lowered the prices of Appnestic resources.</a></li>
<li><a href="../218307/index.html">Stop scrollview scrolling</a></li>
<li><a href="../218313/index.html">Memory leak with ThreadLocal</a></li>
<li><a href="../218315/index.html">Interview with Jeffrey Richter at the Microsoft SWIT 2014 Conference</a></li>
<li><a href="../218319/index.html">20 years ago, Netscape Communications Corporation was founded.</a></li>
<li><a href="../218323/index.html">Plugging with Maven and Eclipse Aether</a></li>
<li><a href="../218325/index.html">Fail Fast! principle: debug less and create more reliable software</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>