<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Smart home control panel. iphone in the wall</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I started automating my home about 2 years ago, mainly using Z-Wave wireless technology, but I also assembled several devices on my own at the ATtiny2...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Smart home control panel. iphone in the wall</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/bf5/d7a/bcb/bf5d7abcbe723ffc7b2f82486f6fcaa3.png"><br><br>  I started automating my home about 2 years ago, mainly using Z-Wave wireless technology, but I also assembled several devices on my own at the ATtiny2313 microcontrol and Raspberry Pi microcontroller.  When I decided what I would do smart home, I set three tasks that the smart home had to solve, the first - saving electricity, the second - ensuring comfort, the third - displaying information about the state of the house in real time. <br><br>  <b>At the moment, managed to implement the following:</b> <br><ul><li>  Automatic switching on and off of the light in the corridors </li><li>  <a href="http://habrahabr.ru/post/193572/">Control your TV with iPhone with the Raspberry Pi and IR module</a> </li><li>  Weather station with temperature and humidity sensors </li><li>  IRobot vacuum cleaner that will soon be connected to WiFi </li></ul><br>  But the third task of displaying information was not completely solved.  In the kitchen and in the room I have weather stations showing temperature and humidity to see where the light is on, you need to open the application on the iPad, in order to find out the traffic jams, you need to open another application.  I use all this information every day, and it would be logical to get it from one place, so I decided to make an information panel installed permanently in a convenient place. <br><a name="habracut"></a><br>  <b>Having thought up the panel, I knew what features it should have, it is:</b> <br><ol><li>  Display temperature outside the window </li><li>  Display the temperature in the house </li><li>  Display humidity in the house </li><li>  Traffic Information </li><li>  Turning off electrical appliances </li><li>  TURN ALL button </li><li>  Clock </li></ol><br>  As a panel, I first planned to use an Android tablet for 7 inches, <a href="http://habrahabr.ru/post/180749/">and as an OpenRemote software, which was developed for this purpose</a> .  But later decided to make a panel of improvised means.  Under the hand was an old iPhone 4, which as it turned out later, coped with the role of the control panel perfectly well, despite the small screen. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, after selecting the panel, the main question arose: how to mount the iPhone into the wall, googling found several ready-made solutions, each of which cost around 600 ~ 800 euros.  The price of the mount exceeded the price of the iPhone itself, I thought it was not reasonable and decided to make the iPhone under myself! <br><br>  <b>To install the iPhone on the wall, you had to understand:</b> <br><ol><li>  What to fix the iPhone so that it does not fall out of the wall </li><li>  Where to hide the power supply </li></ol><br>  The solution to the first task was found in the box from the iPhone itself, the substrate separating the iPhone and accessories with minor modifications perfectly kept the iPhone in the wall. <br><img src="https://habrastorage.org/getpro/habr/post_images/2e3/5af/4c0/2e35af4c0112dbd55631478b1621b153.jpg"><br><br>  Plexiglas sawed frame increases the thickness of the substrate <br><img src="https://habrastorage.org/getpro/habr/post_images/733/a49/822/733a49822efc0b1b0721f352a187db66.jpg"><br><br>  Found plastic anti-lufty gaskets for switches, made ears from them <br><img src="https://habrastorage.org/getpro/habr/post_images/a3c/843/356/a3c843356bc4bb5bd5f6d7ac56cf565f.jpg"><br><br>  The power supply did not hide in the wall, but decided to move it into the room, the iPhone is conveniently located next to the door to the room.  Having bought the power cord for 2 meters, I stretched the wire under the door casing, started the drilled hole in the door box into the room and inserted the power supply into the outlet specially prepared there. <br><img src="https://habrastorage.org/getpro/habr/post_images/12d/2a1/5ec/12d2a15ec9397d2bc59bc5bd0355651c.jpg"><br><br>  Framed cut out of black glossy paper and stuck directly on the wallpaper, of course it would be cool to make such a frame of black glossy plexiglass, I even prepared an autocad file for cutting plexiglass on the machine, but the price in 1500r cooled me. <br><br>  <b>Here is the look of the finished panel:</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/fd4/f44/ca1/fd4f44ca19a18f53c0776d92b9b8dcc1.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/2d1/840/059/2d1840059a7e40da39ea7391aef44a43.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/1c0/fec/b10/1c0fecb107f617c46f3666b99957a8a8.jpg"><br><br>  After installing the iPhone in the wall, it was the turn to write software, I am a little familiar with programming under iOS, so there were no difficulties in programming.  Difficulties arose with the design, a few nights I pored in Photoshop over simple icons and the layout of the blocks.  The result was what you see! <br><br>  <b>Still tiled design I like</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/bf5/d7a/bcb/bf5d7abcbe723ffc7b2f82486f6fcaa3.png"><br><br>  <b>In the second part I want to talk about the devices that I use and control from the panel.</b> <br>  Light control is fully built on Z-Wave wireless technology.  The choice fell on it due to the large number of compatible devices, more than 200 companies worldwide produce Z-Wave devices, this means that I will not have any problems with the purchase of equipment in the future.  Plus, it is cheap compared to knx, amx, crestron, on average, the device costs $ 100 and most importantly it is wireless, I do not need to pull any wires between the devices for their interaction. <br><br>  <b>Installed equipment</b> <br><table><tbody><tr><td>  A photo </td><td>  Device </td></tr><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/7cb/7ec/e37/7cb7ece37d9643b875f2e0d14c602f37.jpg"></td><td>  <b>Z-Wave.Me Dimmer</b> 300W is a dimmer complete with a key, under the key are two buttons, pressed up - the light came on, pressed down - the light turned off, the key is always in the neutral position.  I have 3 such devices installed, one in the room so that you can adjust the light from the phone, one in the hallway and the corridor so that the light turns on at 20% at night and 100% at daytime.  These dimmers are installed in the phase gap, and according to the Soviet tradition, the wiring is so laid out that there is no zero in the switch box, only the phases, so I cannot use switches with a relay. </td></tr><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/976/00b/045/97600b0452df7a0bc90edf9c9766bd94.jpg"></td><td>  <b>Fibaro Universal Sensor</b> is a binary sensor, if you close two wires on it, then a signal will be sent to the Z-Wave network that the sensor has been triggered.  I have these wiring closes the motion sensor Astra-515.  Thus, I made my Z-Wave motion sensor.  I use 2 of these, one in the hallway, the other in the hallway, run by Z-Wave.Me Dimmer. </td></tr><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/d90/9f1/32a/d909f132ad930afaa1abfb7d751ded43.jpg"></td><td>  <b>Fibaro Dimmer</b> is a micromodule dimmer without a key the size of a crown, I connected a night light to it, and I use a small doorbell as a control button. </td></tr><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/3b2/283/af2/3b2283af20c4a31132280d073037bd4f.png"></td><td>  <b>Wall-mounted two-button switch on batteries Z-Wave.Me Dual Paddle Wall Controller</b> is a remote control in the form of a conventional switch, controlled by Z-Wave.Me Dimmer (chandelier) and Fibaro Dimmer (night light) in the room.  Glued around the bed. </td></tr><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/66b/a65/1f6/66ba651f61e4db5c2c72b336a1f5332d.jpg"></td><td>  <b>The Everspring rosette module with power consumption</b> is a radio-controlled socket, in the winter I turn on the garland and control it from the Z-Wave.Me Key Fob.  Now the lamp is plugged in, I turn it on with a single-button battery-operated switch. </td></tr><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/7c3/cbe/1a0/7c3cbe1a03a10f2fd595d1409234c1d4.png"></td><td>  <b>Wall-mounted single-button switch on batteries Z-Wave.Me Single Paddle Wall Controller</b> controls the sockets module Everspring. </td></tr><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/546/75f/d73/54675fd7345fde3529f6793eb820eac9.jpg"></td><td>  <b>Keyring Z-Wave.Me Key Fob</b> , each button turns on / off somewhere light. </td></tr><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/e1c/823/71b/e1c82371b5dd3048c40f5e4b331f0bbe.jpg"></td><td>  <b>The RaZberry expansion card for the Raspberry Pi</b> is a motherboard installed in the Raspberry Pi and turns it into a smart home controller, with its help I configure communications and interaction scenarios. </td></tr></tbody></table><br><br>  Z-Wave is a mesh network, i.e.  each device can communicate with each device directly without the participation of a central controller.  For example, a double switch on batteries, which I have glued to a double-sided tape to the wall near the bed, controls directly the dimmer in the chandelier and the dimmer in the nightlight. <br><br>  But in the hallway and in the corridor, where I have installed motion sensors and dimmers, the control is carried out using a controller.  When triggered, the motion sensor sends a signal to the controller, the controller runs a script that checks how much time it is, if from 7 to 0, the light turns on for the maximum, if the night from 0 to 7, the light turns on by 20%.  And of course, the whole world can be controlled from the iPad and see the status of the sensors. <br><br>  <b>The weather station in the room consists of two parts</b> <br>  First part: 2 seven-segment indicators of 4 segments each operate on an attiny2313 microcontroller with 2 temperature sensors DS18B20, one sensor in the room, the other outside the window. <br><br>  The second part: the LCD screen from the old Nokia 6020 is bolted to the Raspberry Pi, the SPI 9 bit displays information from the humidity sensor DHT-22.  For Raspberry Pi, I wrote a couple of cgi-bin scripts, with which I pull out humidity and temperature information on the iPhone using HTTP requests. <br>  If anyone is interested in the details of how to draw on the screen of Nokia 6020 with the PCF8833 16 bit color controller using raspberry, ask, because  I had to solve this task myself and this is a topic for a separate article. <br><img src="https://habrastorage.org/getpro/habr/post_images/041/f08/412/041f0841239fde8b3696ab271531e611.jpg"><br><br>  On the same Raspberry installed <a href="http://habrahabr.ru/post/193572/">board to control the TV via IR</a> .  It works simply, the HTTP command is sent from the iPhone via WiFi to the Raspberry Pi using the lirc program, the desired IR command is executed.  You can apply this fee to any IR technology. <br><img src="https://habrastorage.org/getpro/habr/post_images/c3d/c28/6c9/c3dc286c9eec5b197611e749c34c681a.jpg"><br><br>  The Roomba iRobot 770 vacuum cleaner lives in the next room, which is completely independent and operates on a schedule.  I am planning to purchase a <b>RooWiFi</b> WiFi card for <b>it</b> and steer it from the phone or launch it when I'm not at home. <br><img src="https://habrastorage.org/getpro/habr/post_images/9d7/65d/21c/9d765d21cb5910c34ca474f956c98893.png"><br><br>  <b>What I came to</b> <br>  I will continue to improve my home for a long time.  To demonstrate what is at the moment, I prepared a plan for my apartment in Planner5D, and with the help of Photoshop I placed the Z-Wave devices, indicating what they control. <br><img src="https://habrastorage.org/getpro/habr/post_images/6b6/9f0/23e/6b69f023e59d10375f9ddd420c807392.jpg"><br><br>  I am fond of technology and always strive to improve my skills.  I am interested in developing solutions that will be useful.  Combining entertainment and practical benefits, I created a really comfortable smart home.  Having decided to study the AVR microcontrollers and programming under the Raspberry Pi, I developed my weather station.  Inspired by the technology of smart homes, I made an automatic switch on the light in the corridor according to a temporary algorithm.  Robot vacuum cleaner was purchased for a known reason - the love of cleanliness and laziness to get out. <br><br>  At the moment, installing the control panel in the hallway, I achieved the desired level of comfort: leaving the house, I turn off the forgotten light and the TV with one button, after a couple of hours the vacuum cleaner will start its work, if necessary, I can check if my sensors didn't work the absence, and when I came home, I would open the front door and the light would light up without forcing me to break my legs in the dark, making my way to the switch. <br>  The house has become more comfortable, and the systems that work in it save me time, allowing me to spend it on the joy of life! </div><p>Source: <a href="https://habr.com/ru/post/217765/">https://habr.com/ru/post/217765/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../217747/index.html">How to identify hacker activity on the site, eliminate its consequences and defend against intruders</a></li>
<li><a href="../217751/index.html">Yandex cleaned DNS view for AAAA records</a></li>
<li><a href="../217753/index.html">StackExchange API Basics</a></li>
<li><a href="../217757/index.html">Cape Town Science Center: Polytechnic Museum, where you have to press all the buttons</a></li>
<li><a href="../217759/index.html">The story of the three core vulnerabilities</a></li>
<li><a href="../217767/index.html">Who is better: compare 5 popular credit cards</a></li>
<li><a href="../217769/index.html">The history of the Eiffel Tower and ... "Descriptive Geometry"</a></li>
<li><a href="../217771/index.html">How to minimize setting for content site</a></li>
<li><a href="../217775/index.html">Cosmos Facts Hard to Believe</a></li>
<li><a href="../217779/index.html">Emulation of pressing multimedia keys in Windows, Linux and Mac OS X</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>