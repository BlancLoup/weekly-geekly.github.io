<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Evil maid attack on encrypted hard drive</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="An article was published yesterday in which, not without the help of Microsoft, reveals interesting details about the internals of BitLocker. The arti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Evil maid attack on encrypted hard drive</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/003/7f7/849/0037f7849e744076b4ba5bdae1aa95ed.png" align="left">  An <a href="https://firstlook.org/theintercept/2015/06/04/microsoft-disk-encryption/">article</a> was published yesterday in which, not without the help of Microsoft, reveals interesting details about the internals of BitLocker.  The article is long and its contents can be summarized as ‚Äúin general, it looks adequate, there are no obvious vulnerabilities‚Äù.  But the links have a lot of interesting information about various attacks on an encrypted hard drive.  I suppose habrazhiteli will be interested in a brief statement of the attack with the romantic name ‚Äúevil maid‚Äù and its logical continuation.  Is your business correspondence securely protected by young, curious customs officers, if at the airport in sunny Spain you were asked to watch a laptop with an encrypted hard drive for 10 minutes? <br><a name="habracut"></a><br>  It would seem that if an adequate encryption algorithm is used and the attacker or the curious simply does not know your password, then the business correspondence is completely safe.  Is it so? <br><br>  Not really.  Encryption implements the operating system.  When you start a computer from Linux, Windows or OSX, first starts some operating system code that asks you for the passphrase from the encrypted hard drive, and then uses it to decrypt the hard drive in real time (or only home dir if encryption is used) by default in OSX).  The evil maid attack is that the backdoor, which sends all the necessary information to the attacker, is embedded in the code requesting the password.  Which is not encrypted, because it must be executed when the computer starts up before the user enters the passphrase.  You got your laptop back, you laughed at close-minded checkers, turned it on, entered your password, downloaded the OS, and that's it, the backdoor is already on your computer.  Bitlocker is partially protected from this attack - its bootloader verifies its own integrity (of course, nothing prevents you from changing the verification code, but it is much more difficult), OSX and popular Linux distributions do not even have such protection. <br><br>  Paranoids from security know about this approach and in case of suspicion that someone modified the computer disk is loaded from usb and overwrites part of the operating system responsible for the initial boot and password entry.  Or use the usb key instead of entering a passphrase.  Or downloaded from usb.  Or any other way.  But is that enough? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It turns out no.  Most hard disk encryption solutions use the AES algorithm in CBC block mode.  And the block encryption mode has a funny feature.  If the attacker knows the contents of the encrypted file on the hard disk, but does not know the key, then he can modify the encrypted data in such a way that after decryption, the content he needs will be obtained.  Suddenly, yes?  You can not touch the bootloader.  Knowing the version of the operating system and the location of its standard files on the disk, you can embed the backdoor into the system files simply by overwriting a part of the encrypted blocks.  Such an attack is described in detail in <a href="http://www.jakoblell.com/blog/2013/12/22/practical-malleability-attack-against-cbc-encrypted-luks-partitions/">another article</a> ; ibid. Is a practical implementation for Ubuntu 12.04 (starting from 12.10, XTS is used by default, which protects the OS from this attack). <br><br>  Starting with OSX Lion (10.7), the default encryption tool is changed to ‚ÄúFile Vault 2‚Äù, which uses XTS-AESW protected against such an attack instead of AES-CBC. <br><br>  Of course, such attacks are known to any reader familiar with the basics of information security.  All the rest, I hope, information about these two attacks will be at least curious.  As an illustration, the <a href="http://evil-rick.newgrounds.com/">work of this artist was used</a> . </div><p>Source: <a href="https://habr.com/ru/post/259781/">https://habr.com/ru/post/259781/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259767/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ163 (June 1 - 7, 2015)</a></li>
<li><a href="../259771/index.html">As I was increasing machine learning conversion</a></li>
<li><a href="../259773/index.html">Digest of grocery design, May 2015</a></li>
<li><a href="../259777/index.html">C ++ in the modern world</a></li>
<li><a href="../259779/index.html">Major changes in ASP.NET 5 and MVC 6</a></li>
<li><a href="../259783/index.html">Flexbox on the example of the dice</a></li>
<li><a href="../259785/index.html">New free courses of virtual academy Microsoft Virtual Academy, May 2015</a></li>
<li><a href="../259787/index.html">"TM" restarts "My Circle"</a></li>
<li><a href="../259789/index.html">Krutelochka to Pimp: how to reduce the number of non-valid bugs by half, and why technical support is a friend of the developer</a></li>
<li><a href="../259791/index.html">Kingdom of multi-layered mirrors</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>