<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Clojure Cup - the experience of participating in the hackathon on writing a web application on Clojure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This weekend was Clojure Cup - 48 hour hackathon on Clojure. It will be a relatively long post about how it went on in our team, with technical detail...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Clojure Cup - the experience of participating in the hackathon on writing a web application on Clojure</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage3/b41/922/b64/b41922b64a9159b2cf63e69ae7b860a9.png"><br>  This weekend was <a href="http://clojurecup.com/">Clojure Cup</a> - 48 hour hackathon on Clojure.  It will be a relatively long post about how it went on in our team, with technical details and other things.  Well, and at the end of the post, where already without this, we will tell quite a bit about our project.  And those who are too lazy to read, I can immediately go to <a href="http://codenotes.me/">CodeNotes</a> and even <a href="http://clojurecup.com/app.html%3Fapp%3Dcodenotes">vote for us</a> on the Clojure Cup page. <br><a name="habracut"></a><br><h4>  Work environment </h4><br>  There are two different ‚Äúregimes‚Äù in participation in the hackathon: participation for the sake of pleasure and for the sake of victory.  In the first case, we lazily code something cool for two days;  in the second, everything is a little different, with hardcore and early training.  We chose the second option. <br>  There were four of us in the team - two, including me and <a href="https://habrahabr.ru/users/si14/" class="user_link">si14</a> , are in Petersburg, one - in Tyumen ( <a href="https://habrahabr.ru/users/zloy_alu/" class="user_link">zloy_alu</a> ), another one - in Munich.  But we didn‚Äôt experience any communication problems - more or less successful task isolation, excellent <a href="http://trello.com/">Trello</a> service and simply divine <a href="http://flowdock.com/">FlowDock helped</a> .  The latter, in my opinion, is the ideal service for intra-team interaction.  Judge for yourself - there is both chat and file sharing, and separate threads of discussions, and notifications about various events (deploy, push to the repository, new tasks in trello, mention on Twitter).  It looks like this: <br><br><img src="https://habrastorage.org/storage3/9d2/b1f/a1b/9d2b1fa1b4b3d673b24f2abb5e8263c0.png"><br>  Since we were clearly planning to win, we started the preparation in advance.  In particular: <br><ul><li>  checked selected libraries and the structure of the application as a whole (for details, see below about Clony); </li><li>  checked the integration with third-party services like NewRelic; </li><li>  started a blog and Twitter; </li><li>  learned how to quickly and conveniently deploy (Makefiles and Ansible); </li><li>  prepared the JSON API documentation between the server and the web app, which allowed us to write these pieces more or less independently; </li><li>  prepared interface sketches on paper; </li><li>  bought a domain and issued an SSL certificate; </li><li>  learned how to configure nginx for normal work with websockets and static resources; </li><li>  we prepared contacts for the pool of beta testers (a certain file came out here - we were behind the schedule and sent out only at 11 Moscow time, so we managed to get only one review before the end of the hackathon). </li></ul><br><br><h4>  Technical details </h4><br>  And now the details of what might be useful for web developers at Clojure. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The experience of creating a small <a href="http://github.com/si14/clony">Clony</a> application was very useful.  This is an extremely simple thing on Clojure using <a href="http-kit.org/">http-kit</a> (http-server and client for Clojure) and <a href="https://github.com/weavejester/compojure">Compojure</a> (router), which communicates with its front-end with websockets.  It uses <a href="http://thinkrelevance.com/blog/2013/06/04/clojure-workflow-reloaded">Stuart Sierra's workflow</a> , thanks to which the development becomes noticeably more pleasant: we completely restarted our entire application (or its pieces) from nrepl in a split second.  During the hackathon, we made several improvements that are waiting for their backport in Clony. <br><br><h5>  The first day </h5><br>  We knew in advance that we would be deploying to a virtual machine, so we learned how to use <a href="https://github.com/ansible/ansible">Ansible</a> .  Thanks to him, we were online 4 hours after the start of the competition - with a fully developed production-configuration and a test application.  This would have happened earlier if it were not for problems with <a href="http://digitalocean.com/">DigitalOcean</a> , which provided hosting for the participants (they banned our account due to the suspicion of fraud).  We also had local virtuals ( <a href="http://vagrantup.com/">Vagrant</a> - super!) With a completely identical configuration, but in the end everyone scored on them and deployed immediately to production.  This happened also because some things had to be changed on the fly on the server by hand ‚Äî starting from the MariaDB configuration (damn these ANSI_QUOTES! We should have taken Postgres right away) and ending with the fact that we forgot to write logs to disk.  Plus, we did a fairly complete integration with <a href="http://newrelic.com/">NewRelic</a> .  I cannot say that he critically rescued us, but the ability to easily see such a large number of parameters ‚Äî server response time, DOM rendering time by clients, network delays, amount of free memory on the server, GC JVM statistics ‚Äî soothed my nerves.  The integration library turned out to be very small and we will definitely upload it in open-source. <br><br>  On the first day, we spent a lot of time trying to start <a href="https://github.com/pangloss/clang">clang</a> - integrating Angular.js with ClojureScript.  The abundance of minor troubles eventually forced to abandon ClojureScript entirely and switch to bare JavaScript.  ClojureScript is much better than a language, but in the conditions of a hackathon, there was simply no time to fight against its own lack of understanding of its subtleties. <br><br>  Trying to do everything as correctly as possible, we decided to add a library for SQL migrations to the project.  It was interesting to find that the very popular library for migrating <a href="https://github.com/budu/lobos">Lobos</a> <a href="https://github.com/budu/lobos/issues/55">does not work at all</a> .  As a result, we lost about an hour to search and process with a new one;  stopped at <a href="https://github.com/weavejester/ragtime">ragtime</a> . <br><br>  As a result, at the end of the first day we had a beautiful main page and a semi-working list of repositories (a small description of our project is slightly lower).  In the interval 22: 00‚Äì03: 00, the team dispersed to sleep (at this point no one slept from 4 am) and we gathered again around 8 am on Sunday. <br><br><h5>  Second day </h5><br>  On Sunday, things went better, but there were quite a lot of problems: <br><br><ul><li>  I had to redo a small piece of OAuth authorization; </li><li>  at some point, we were banned by GitHub on the limit of API requests, which was extremely unpleasant, and we had to reduce the number of requests being sent; </li><li>  To generate images, we first tried to use something in pure Java, but in the end we took a binding to ImageMagick.  There are two of them: one works through sh and pipes, the other through JNI.  The first one slows down (30 + ms per image), it was not possible to get the second one; </li><li>  and with the slow generation of images, and with the number of requests to GitHub, we were rescued by <a href="https://github.com/clojure/core.cache">core.cache</a> - the wonderful ‚Äúcore‚Äù library of Clojure; </li><li>  we made a risky decision to take core.async to work with events on the server.  As a result, this turned out to be a good solution: the first working version of the code with its use was born in an hour and a half and there were practically no problems with it, despite the fact that no one in the team had used it before.  With the help of core.async, we made it possible from any place in the code to write to the user's specific web socket and complex logic to restart scanning repositories in the event of server overload: we process the queue of scan requests, discarding everything that overflows the queue queues choose from the database that thrown during reloading.  The code is very compact and seems to work; </li><li>  bugs on the client, some of which, alas, we did not have time to fix until the end of the hackathon. </li></ul><br>  In general, the second day was more than productive.  We tried to focus on the first impression, so we paid attention to the little things: redirect to our own domain, beautiful ‚ÄúHow to Use‚Äù, clear text on the main, nice design, dies with ‚Äúsorry, you don‚Äôt have TODO in the repository, here‚Äôs a bug report form, if this is not true".  Of course, to speed up development, we used <a href="http://getbootstrap.com/">Bootstrap</a> , but we tried to do everything as nicely and as ‚Äúnon-default‚Äù.  How much this will help us get the best marks from the judges, we will find out on Friday. <br><br><h4>  The most interesting - what is it all about? </h4><br>  It would be strange to say nothing at all about our project. <br><img src="https://habrastorage.org/storage3/924/fbf/0c5/924fbf0c5e4aa54c6635300e47c30a8e.png"><br>  It seems to us that humanity has not yet invented the perfect bugtracker.  But ... Why do we need a bugtracker at all?  The essence of our project is to remove a separate bugtracker from your life.  And we have tried and will continue to try so that it can look like this: <br><blockquote>  <font color="#ff7700">def</font> somefun <font>(</font> <font>)</font> : <br>  <font color="#808080"># TODO: @ si14, please fix this before release</font> <br>  <font color="#ff7700">return</font> true </blockquote><br>  And we will do the rest - we will send a notification to the user that you have created a task for him, display it in our interface, and also monitor your commits and scan the code for new TODO, FIXME and NOTE.  In addition, you can generate a beautiful image for your repository on GitHub, indicating how much TODO is in your code and a link to information about it.  Our <a href="http://codenotes.me/">CodeNotes</a> project <a href="http://codenotes.me/">does</a> not yet have all the desired functionality (plus there are still some rather annoying bugs, so what to hide), but when the voting is over, we will immediately continue to improve it and make it the best bug tracker for small projects. <br><br>  In the meantime, by the way, you can <a href="http://clojurecup.com/app.html%3Fapp%3Dcodenotes">vote for us</a> and comment in the comments about what you think about the idea, about the hackathons, and about Clojure web programming in general. </div><p>Source: <a href="https://habr.com/ru/post/196090/">https://habr.com/ru/post/196090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../196080/index.html">Wireless Display for Android</a></li>
<li><a href="../196082/index.html">Test drive the clouds: why do you need it and how to do it</a></li>
<li><a href="../196084/index.html">Numenta NuPIC: First Steps</a></li>
<li><a href="../196086/index.html">Win32 / Napolar - new in-the-wild bot</a></li>
<li><a href="../196088/index.html">Derby.js TODO or not TODO</a></li>
<li><a href="../196092/index.html">Why we switched to Marionette.js</a></li>
<li><a href="../196094/index.html">Former Microsoft Privacy Director now trusts only open source software.</a></li>
<li><a href="../196096/index.html">Metric # 24 - A podcast about technologies, products, and services from the IT world</a></li>
<li><a href="../196098/index.html">Runetology (209): Arkady Akulov, founder of the project Fotoshkola.net</a></li>
<li><a href="../196100/index.html">HTML5 Flash Player Shumway added to Firefox</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>