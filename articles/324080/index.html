<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Atomic payments for parking fees in Lamoda</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have come up with a way to save you from checks and inconvenient reports for corporate compensation (food, gas, parking, communications, etc.). 


...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Atomic payments for parking fees in Lamoda</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/web/3cc/dd8/cd0/3ccdd8cd045446fca524fe81ed47f0c4.png"></p><br><p>  We have come up with a way to save you from checks and inconvenient reports for corporate compensation (food, gas, parking, communications, etc.). </p><br><p>  Having become an issuer of MasterCard cards, Yandex.Money learned how to create special card accounts for targeted expenses: your company credits money to such accounts that cannot be withdrawn from an ATM or spent in an inappropriate way - they can only pay for what the organization is ready to compensate. </p><br><p>  The highlight is that the employee does not need to carry additional cards or pieces of paper with him - one Ya.Money card is enough.  A new feature has taken root not only within our company, and even Lamoda, an online retailer of clothing, shoes and accessories, has tried a convenient payment scheme. <a name="habracut"></a></p><br><h1 id="chekam-i-bumazhkam--boy">  Checks and papers - fight </h1><br><p>  If your company practices different target compensation, you probably know the inconvenience associated with it.  Still, I remind you: </p><br><ul><li><p>  It is necessary not to forget to receive "checks" or "coupons".  Usually, this happens at a specific time, convenient to the outstanding. </p><br></li><li><p>  You have to report expenses by check or prepaid coupons. </p><br></li><li>  In some cases, separate cards are used for each restaurant or service organization, for which you can pay some part of the bill.  I immediately recall the fuel cards and company cards of some cafe network. </li></ul><br><p>  In addition to the inconvenience for the employee, grandfather accounting methods complicate the lives of financiers.  Payments to employees should be carried out as incomes of individuals, do not forget to calculate taxes each time, collect a heap of evidence of spending with the same checks, etc. </p><br><p>  One could simply transfer some amount for corporate expenses directly to the employee‚Äôs salary card.  This removes most of the problems from the accounting department, but can lead to inappropriate spending.  For example, no one will prevent spending money not on gasoline, but on something else - this spoils the whole idea of ‚Äã‚Äãcompensation and turns money into a kind of premium.  In addition, a bona fide employee may be uncomfortable when his personal money is mixed with corporate money. </p><br><p>  How is this implemented with us?  Both in the big Yandex and in Yandex.Money, power compensation has long been credited to an office pass, which could be paid in contactless in all canteens of the office and in the nearest cafes.  But at one point, Yandex.Money decided on an experiment with the payment of food with their own cards.  In order for everything to take off as it should, it was necessary to develop a separate ‚Äúnutritional‚Äù account for a wallet in Ya.Money. </p><br><p><img src="https://habrastorage.org/files/4ea/e74/ce3/4eae74ce3cdc4c6f948f80399dcabd1b.jpg" alt="image alt text"></p><br><p>  <em>The food limit is not taken into account and is not displayed in the total balance of the account - it can be seen only in a separate field.</em> </p><br><p>  The task was to ensure that when making payments in specific institutions, money was automatically deducted from this special account, and when paid in any other places, from the main account of the wallet.  Using a regular bank card for payment instead of a pass, we also simplified the task of integrating third-party cafes into the food system. </p><br><h1 id="metki-i-atomarnye-platezhi">  Tags and atomic payments </h1><br><p>  Since the target expenses should be as transparent as possible for the outlet, we built all the work around the ordinary card payment, hiding the magic on the side of the Yandex.Money payment service.  That is, the seller may not even know that you paid for lunch or parking from some special account - for him this is the usual payment with a MasterCard card. </p><br><p>  On the Yandex.Money side, each payment from the target account looks like this: </p><br><p><img src="https://habrastorage.org/files/404/2e5/c49/4042e5c4950a48c8aed8694028165b5a.png" alt="image alt text"></p><br><p>  <em>The beauty of an atomic operation is that money is transferred somewhere only if all the steps are completed successfully.</em> </p><br><p>  If in Yandex.Money this scheme is used to compensate for food, in Lamoda it is used to pay for parking by couriers who deliver orders.  At the time of the publication of this article in Lamoda there are about 400 sales representatives in Moscow alone.  Agree to count and compensate the expenses of so many people every month in traditional ways is too laborious. </p><br><p>  We will analyze the script in more detail: </p><br><ol><li><p>  The courier parked and launched a parking fee in the Yandex.Parking application. </p><br></li><li><p>  The module for communicating with stores (parking is a store in Yandex.Money terms) places a contract for payment and provides it with the sign ‚Äúborrowed funds can be used‚Äù. </p><br></li><li><p>  Courier sees the cost of parking and confirms the payment. </p><br></li><li><p>  In the payment service, each transaction goes through a set of rules that control the limits on payments and give the go-ahead for target expenses in stores.  In order for the courier to pay for the parking from the target account, you need the sign "parking shop" at the point of payment and the label "payment for parking" on the Yandex.Money courier account.  Of course, the target spending limit should also not be spent. </p><br></li><li>  The funds are credited to the user's account, after which the usual payment is made using a card.  The enrollment and debiting operations are carried out synchronously, that is, they form one atomic operation. </li></ol><br><p>  Depending on the rules, the purchase can be compensated in whole or in part.  In case of partial compensation, the missing corporate money is transferred to the user's account immediately prior to payment. </p><br><p>  With all this, the courier can keep personal funds in the Yandex.Money electronic wallet - when you pay for parking with a card, the personal account balance does not change, which allows you to not mix flies with cutlets.  The company is also pleased, since Yandex.Parks provide very detailed corporate reports showing <strong>the wallet number, the date and time of payment, the parking ID</strong> and the <strong>license plate number of the corporate car</strong> . </p><br><h1 id="vozvraty-hitrosti-i-oshibki">  Returns, Tricks and Errors </h1><br><p>  About the history of petty fraud, everything is up to date, and the announcements ‚ÄúLet's make a voucher for hotel accommodation, price - 500 rubles‚Äù can be found quite often.  Therefore, over the protection against abuse of trust funds also had to think: </p><br><ul><li><p>  In the case of atomic operations, scenarios are excluded when such an operation is canceled after the money is received in the user‚Äôs account, but before they are written off by the outlet. </p><br></li><li><p>  It‚Äôs banal to withdraw money from a target account via an ATM does not work, since it will not have a ‚Äúparking store‚Äù tag in the Yandex.Money database. </p><br></li><li>  If you carry out a refund for the same parking, the money will synchronously return to a separate corporate account, and not hang on the user's card.  When using trust funds, the transaction attributes indicate what amount was owned by the user and which was transferred from a specific target account. </li></ul><br><p>  Since corporate funds appear on the user's account only at the time of payment and there is no need to open additional accounts for this, financial accounting is notably simplified. </p><br><h1 id="mozhno-vzyat-i-klonirovat-dlya-oplaty-pitaniya-ili-svyazi">  You can take and clone to pay for food or communication </h1><br><p>  What is especially nice in the transparent payment from the target account is the ease of integration into any scenarios.  Since the service provider does not require any changes at all in the payment acceptance process, it is enough to add tags to the employees' wallets and to the identifiers of the payment sites. </p><br><p>  This is the dream of a corporate minimalist introvert: no agreements with sellers, no extra payment entities! </p><br><p>  <strong>Interestingly, in what ways does your company pay for various ‚Äúbenefits‚Äù?</strong> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/324080/">https://habr.com/ru/post/324080/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../324068/index.html">How to feed cattle. Advice to the head of the developer unit</a></li>
<li><a href="../324070/index.html">FPGA Image Filtering</a></li>
<li><a href="../324072/index.html">Software defined storage: compare 7 solutions</a></li>
<li><a href="../324076/index.html">Mitap MSK.NET Community</a></li>
<li><a href="../324078/index.html">Report from Data Fest‚Å¥ February 11-12</a></li>
<li><a href="../324082/index.html">Data Science Weekend. Speaker presentations</a></li>
<li><a href="../324086/index.html">Enterprise-class cloud storage based on NGINX Plus and Minio</a></li>
<li><a href="../324088/index.html">Create the perfect search string</a></li>
<li><a href="../324090/index.html">Search for the way in tower defense games</a></li>
<li><a href="../324092/index.html">How dangerous shortened links and how to protect against it</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>