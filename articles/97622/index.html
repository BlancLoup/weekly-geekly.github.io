<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Preloading Images</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Those who use HTML5 Canvas know that the image cannot be used via the URL to it. The image must first be loaded either via the img tag, or via the Ima...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Preloading Images</h1><div class="post__text post__text-html js-mediator-article">  Those who use HTML5 Canvas know that the image cannot be used via the URL to it.  The image must first be loaded either via the img tag, or via the Image object, or via <a href="https://developer.mozilla.org/en/Canvas_tutorial/Using_images">data: url</a> . <br>  In order not to think about loading each picture, they load all the necessary pictures before drawing the scene itself.  In this topic, I will give an example of my image loader, which uses Mootools from its mechanisms for working with classes. <br><a name="habracut"></a><br>  What should such a class look like in terms of design?  It should receive the addresses of the images that should be loaded, and in some way, notify about the download process. <br>  Fortunately, Mootools <a href="http://mootools.net/docs/core/Class/Class.Extras">provides</a> some tools for convenient work with events. <br><br>  The class implements <b>onload, onerror, onabort</b> Image object <b>handlers</b> , and when the percentage of total load has changed, its own are generated. <br>  The class generates three events: <br><ul><li>  <b>onStart ()</b> : called at the start of the download; </li><li>  <b>onUpdate (percent)</b> : called when the load percentage has changed; </li><li>  <b>onComplete ()</b> : called when all images have loaded. </li></ul><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> Imageloader = <font color="#0000ff">new</font> Class({ <br> <font color="#008000">//  Options  Events</font> <br> Implements : [Options, Events], <br> options : { <br> <font color="#008000">// </font> <br> <font color="#008000">// </font> <br> onStart : $empty, <br> <font color="#008000">//  </font> <br> onUpdate : $empty, <br> <font color="#008000">// </font> <br> onComplete : $empty, <br> <font color="#008000">//  .  </font> <br> <font color="#008000">//{</font> <br> <font color="#008000">// "url" : url,</font> <br> <font color="#008000">// "key" : key,</font> <br> <font color="#008000">// "size" : size</font> <br> <font color="#008000">//}</font> <br> images : [] <br> }, <br> initialize : <font color="#0000ff">function</font> (options) { <br> <font color="#0000ff">this</font> .setOptions(options); <br> <font color="#008000">//      </font> <br> <font color="#0000ff">this</font> .images = {}; <br> <br> <font color="#008000">//  </font> <br> <font color="#0000ff">this</font> .totalCount = <font color="#0000ff">this</font> .options.images.length; <br> <font color="#0000ff">this</font> .successCount = <font color="#0000ff">this</font> .failureCount = <font color="#0000ff">this</font> .loadedCount = 0; <br> <font color="#0000ff">this</font> .successSize = <font color="#0000ff">this</font> .failureSize = <font color="#0000ff">this</font> .loadedSize = <font color="#0000ff">this</font> .totalSize = 0; <br> <font color="#0000ff">this</font> .progress = 0; <br> <br> }, <br> start : <font color="#0000ff">function</font> () { <br> <font color="#008000">//  Image,</font> <br> <font color="#008000">// </font> <br> $each( <font color="#0000ff">this</font> .options.images, <font color="#0000ff">function</font> (obj) { <br> <font color="#0000ff">this</font> .totalSize += obj.size; <br> <font color="#0000ff">var</font> image = <font color="#0000ff">new</font> Image(); <br> image.onload = <font color="#0000ff">this</font> .onComplete.bind( <font color="#0000ff">this</font> ,obj); <br> image.onerror = <font color="#0000ff">this</font> .onFailure.bind( <font color="#0000ff">this</font> ,obj); <br> image.onabort = <font color="#0000ff">this</font> .onFailure.bind( <font color="#0000ff">this</font> ,obj); <br> image.src = obj.url; <br> <font color="#0000ff">this</font> .images[obj.key] = image; <br> }.bind( <font color="#0000ff">this</font> )); <br> <font color="#0000ff">this</font> .fireEvent( <font color="#A31515">'start'</font> ); <br> }, <br> <font color="#008000">//   Image  </font> <br> getImage : <font color="#0000ff">function</font> ( key ) { <br> <font color="#0000ff">return</font> <font color="#0000ff">this</font> .images[key]; <br> }, <br> <font color="#008000">// </font> <br> onComplete : <font color="#0000ff">function</font> ( image ) { <br> <font color="#008000">// </font> <br> <font color="#0000ff">this</font> .successCount++; <br> <font color="#0000ff">this</font> .successSize += image.size; <br> <br> <font color="#0000ff">this</font> .onImageEvent(image); <br> }, <br> <font color="#008000">//  </font> <br> onFailure : <font color="#0000ff">function</font> ( image ) { <br> <font color="#008000">// </font> <br> <font color="#0000ff">this</font> .failureCount++; <br> <font color="#0000ff">this</font> .failureSize += image.size; <br> <font color="#008000">//    </font> <br> <font color="#0000ff">this</font> .images[image.key] = <font color="#0000ff">new</font> Image(); <br> <font color="#0000ff">this</font> .onImageEvent(image); <br> }, <br> onImageEvent : <font color="#0000ff">function</font> ( image ) { <br> <font color="#008000">// </font> <br> <font color="#0000ff">this</font> .loadedCount++; <br> <font color="#0000ff">this</font> .loadedSize += image.size; <br> <br> <font color="#008000">//  </font> <br> <font color="#0000ff">var</font> progress = Math.round( <font color="#0000ff">this</font> .loadedSize*100/ <font color="#0000ff">this</font> .totalSize); <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .progress != progress ) { <br> <font color="#0000ff">this</font> .progress = progress; <br> <font color="#008000">//  update</font> <br> <font color="#0000ff">this</font> .fireEvent( <font color="#A31515">'update'</font> ,progress); <br> } <br> <font color="#008000">//   </font> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .totalCount == <font color="#0000ff">this</font> .loadedCount ) { <br> <font color="#0000ff">this</font> .fireEvent( <font color="#A31515">'complete'</font> ); <br> } <br> <br> } <br> }); <br> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Example of use: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> il = <font color="#0000ff">new</font> Imageloader({ <br> onUpdate : <font color="#0000ff">function</font> (percent) { <br> <font color="#008000">//  </font> <br> alert(percent); <br> }, <br> onComplete : <font color="#0000ff">function</font> ( ) { <br> <font color="#008000">//    </font> <br> alert( <font color="#A31515">"done"</font> ); <br> alert(d.getImage( <font color="#A31515">"winter2010"</font> ).complete); <br> }, <br> <font color="#008000">// </font> <br> images : [{ <br> <font color="#A31515">'url'</font> : <font color="#A31515">'http://www.google.com/intl/en_ALL/images/srpr/logo1w.png'</font> , <br> <font color="#A31515">'key'</font> : <font color="#A31515">'main_logo'</font> , <br> <font color="#A31515">'size'</font> : 7 <br> },{ <br> <font color="#A31515">'url'</font> : <font color="#A31515">'http://www.google.com/logos/winter2010_1-hp.jpg'</font> , <br> <font color="#A31515">'key'</font> : <font color="#A31515">'winter2010'</font> , <br> <font color="#A31515">'size'</font> : 32 <br> },{ <br> <font color="#A31515">'url'</font> : <font color="#A31515">'http://www.google.com/logos/komensky10_hp.gif'</font> , <br> <font color="#A31515">'key'</font> : <font color="#A31515">'komensky'</font> , <br> <font color="#A31515">'size'</font> : 26 <br> }] <br> }); <br> <font color="#008000">// </font> <br> il.start();</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a presentation of progress, I wrote another class that draws a progress bar through Canvas. <br><br>  An example of the implementation can be found <a href="http://it-devel.com/demo/index.html">here</a> (it loads somewhere 100kbyte Google logos) <br><br>  PS I plan to write a cycle of articles about game-building through Html5 Canvas.  This is the first, although it is a bit banal.  In the next article I will try to describe the principle of constructing a landscape in isometric projection (by tiles). </div><p>Source: <a href="https://habr.com/ru/post/97622/">https://habr.com/ru/post/97622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../97616/index.html">About company names</a></li>
<li><a href="../97617/index.html">Fun statistics</a></li>
<li><a href="../97619/index.html">Why are you asking where I live ?!</a></li>
<li><a href="../97620/index.html">k3b 2.0.0 release</a></li>
<li><a href="../97621/index.html">Another experience in time management implementation</a></li>
<li><a href="../97624/index.html">"Unlimited" mobile Internet is not fantastic, Eldar</a></li>
<li><a href="../97630/index.html">The future of the zone of the Russian Federation is! The results of the survey Domenus.ru</a></li>
<li><a href="../97631/index.html">On the issue of piracy of audio and video products</a></li>
<li><a href="../97632/index.html">Wean Firefox 3.6.6 kill Flash Player during debug</a></li>
<li><a href="../97633/index.html">lmBook - life management on the desktop and mobile phone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>