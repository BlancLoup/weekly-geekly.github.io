<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a library for iOS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Developers often face typical tasks that appear in new projects. The base of auxiliary code gradually accumulates, which is collected in libraries and...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a library for iOS</h1><div class="post__text post__text-html js-mediator-article"><p>  Developers often face typical tasks that appear in new projects.  The base of auxiliary code gradually accumulates, which is collected in libraries and transferred from project to project.  And the more projects, the harder it becomes to support such libraries. <br><img src="https://habrastorage.org/files/b38/b82/0ef/b38b820ef4b14335b1b11fef3a628d27.jpg" alt="image"></p><a name="habracut"></a><br><p>  Most likely you have a favorite set of categories over NSFoundation / UIKit for convenience or something to work with the network or with push notifications.  It would be logical to arrange this code in the library, store it in one place and connect it with the help of a package manager, for example cocoapods.  Cocoapods greatly facilitate the integration of dependencies into a project.  He does everything for you, creates the necessary targets and integrates their project.  Such ease and simplicity leads to the fact that there are often pods, which consist only of source codes and an example of integration.  This approach is <a href="https://guides.cocoapods.org/making/using-pod-lib-create.html">recommended officially</a> .  And, in fact, this is enough for integration through cocoapods, but not enough for development and support.  For this, an xcode project is best suited for building a library. </p><br><h1>  Xcode project </h1><br><p> We will call our <code>Utilities</code> test library and create an Xcode project for it.  The advantages of this approach are obvious: </p><br><ul><li>  You can configure the necessary build parameters ( <code>-Wall</code> / <code>-Weverything</code> , iOS7 + / iOS8 +, etc.) and work on errors during debugging (and not during integration) </li><li>  you can add unit tests </li><li>  In addition to integration through cocoapods, there is the possibility of integration through Carthage, manually or by git submodules. </li></ul><br><h1>  Static Library vs Framework </h1><br><p>  When creating a project, you need to choose what we will build: a library (static library) or a framework (dynamic framework).  Their main difference is that the framework is not compatible with iOS7, and the library is not supported by swift. </p><br><p>  In our case, iOS7 support is not needed, so the framework will do: <br><img src="https://habrastorage.org/files/548/3b8/47d/5483b847dc26410992d30f2bf74c51e8.png" alt="image"></p><br><h1>  File structure </h1><br><p>  After creating the project, it is necessary to change the structure of the files in the project so that the library is compatible with package managers.  The most commonly used package manager is, of course, Cocoapods.  The rest are used less, but it is also easier to maintain them, since there is no need to upload updated <code>podspec</code> into the storage every time after the update. </p><br><h2>  <a href="https://cocoapods.org/">Socoapods</a> </h2><br><p>  To support cocoapods you need: </p><br><ol><li>  add <code>podspec</code> file </li><li>  add <code>LICENSE</code> file </li></ol><br><p>  The team can help you with this. </p><br><pre> <code class="bash hljs">pod spec create</code> </pre> <br><p>  In addition, if you do not want to make the library public, you need <a href="https://guides.cocoapods.org/making/private-cocoapods.html">to create a private package repository</a> .  And add the <code>podspec</code> file to <code>podspec</code> : </p><br><pre> <code class="bash hljs">pod repo add myrepostorage https://github.com/user/podspecs pod repo push myrepostorage Utilities.podspec</code> </pre> <br><p>  Example <code>podspec</code> file: </p><br><pre> <code class="ruby hljs">Pod::Spec.new <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|s|</span></span> s.name = <span class="hljs-string"><span class="hljs-string">"Utilities"</span></span> s.version = <span class="hljs-string"><span class="hljs-string">"0.0.1"</span></span> s.summary = <span class="hljs-string"><span class="hljs-string">"My test library"</span></span> s.homepage = <span class="hljs-string"><span class="hljs-string">"https://github.com/user/utilities"</span></span> s.authors = <span class="hljs-string"><span class="hljs-string">"author name"</span></span> s.license = <span class="hljs-string"><span class="hljs-string">"MIT"</span></span> s.platform = <span class="hljs-symbol"><span class="hljs-symbol">:ios</span></span>, <span class="hljs-string"><span class="hljs-string">"8.0"</span></span> s.source = { <span class="hljs-symbol"><span class="hljs-symbol">:git</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"https://github.com/user/utilities.git"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:tag</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{s.version}</span></span></span><span class="hljs-string">"</span></span> } s.source_files = <span class="hljs-string"><span class="hljs-string">"Sources/**/*"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><h2>  <a href="https://swift.org/package-manager/">Swift Package Manager</a> </h2><br><p>  To support Swift PM you need: </p><br><ol><li>  put the sources in the <code>Sources</code> folder </li><li>  add <code>Package.swift</code> file </li></ol><br><p>  <code>Package.swift</code> example: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PackageDescription let package = Package( <span class="hljs-type"><span class="hljs-type">name</span></span>: "Utilities" )</code> </pre> <br><h2>  <a href="https://github.com/Carthage/Carthage">Carthage</a> </h2><br><p>  To support carthage, you need to: </p><br><ol><li>  <code>xcodeproj</code> project <code>xcodeproj</code> was in the root folder </li><li>  the schema in the project was marked as shared <br><img src="https://habrastorage.org/files/fbc/5f7/97e/fbc5f797e4214e21bda8c1cc31758b24.png" alt="image"></li></ol><br><p>  In addition, it does not hurt: </p><br><ol><li>  add description in <code>README.md</code> for github </li><li>  put unit tests in the <code>Tests</code> folder </li><li>  put support files in the <code>Supporting Files</code> folder </li></ol><br><p>  The result should be the following structure: <br><img src="https://habrastorage.org/files/a40/4fd/2c5/a404fd2c53dd45debe26f43390a37194.png" alt="image"></p><br><p>  The <code>Supporting Files</code> folder contains the <code>Defaults.xcconfig</code> file, which applies the compilation settings to the project.  It is convenient to put it in all such libraries, so as not to tune everything by hand.  We want to make strict settings so that the code is better, for example: </p><br><pre> <code class="hljs objectivec"><span class="hljs-built_in"><span class="hljs-built_in">CLANG_WARN_ENUM_CONVERSION</span></span> = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CLANG_WARN_INT_CONVERSION</span></span> = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CLANG_WARN_CONSTANT_CONVERSION</span></span> = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CLANG_WARN_BOOL_CONVERSION</span></span> = <span class="hljs-literal"><span class="hljs-literal">YES</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">CLANG_WARN_ASSIGN_ENUM</span></span> = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS</span></span> = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CLANG_WARN_IMPLICIT_SIGN_CONVERSION</span></span> = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CLANG_WARN_OBJC_IMPLICIT_RETAIN_SELF</span></span> = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CLANG_ANALYZER_SECURITY_INSECUREAPI_RAND</span></span> = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> GCC_WARN_CHECK_SWITCH_STATEMENTS = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> GCC_WARN_64_TO_32_BIT_CONVERSION = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> GCC_WARN_ABOUT_MISSING_NEWLINE = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> GCC_WARN_SHADOW = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> GCC_WARN_SIGN_COMPARE = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> GCC_TREAT_WARNINGS_AS_ERRORS = <span class="hljs-literal"><span class="hljs-literal">YES</span></span> WARNING_CFLAGS = -Weverything -Wno-objc-missing-property-synthesis -Wno-gnu -Wno-<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>-equal -Wno-<span class="hljs-keyword"><span class="hljs-keyword">nullable</span></span>-to-<span class="hljs-keyword"><span class="hljs-keyword">nonnull</span></span>-conversion -Wno-auto-import -Wno-direct-ivar-access</code> </pre> <br><h1>  Dependencies </h1><br><p>  If the library has a dependency, for example, on <code>AFNetworking</code> , then this dependency can be integrated as usual with usual methods.  For example, using cocoapods or carthage, you can connect it to our library.  You also need to remember to specify this dependency in the appropriate configuration files for package managers.  For cocoapods, this is a <code>Podfile</code> , and for carhage, this is a <code>Cartfile</code> . </p><br><h1>  Total </h1><br><p>  The result is a library that is easy to maintain and integrate with any package manager. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/283438/">https://habr.com/ru/post/283438/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../283428/index.html">Come to the meetings of the IT communities in your cities</a></li>
<li><a href="../28343/index.html">ITcommunity - a new social network for IT professionals</a></li>
<li><a href="../283430/index.html">All-Russian Engineering Olympiad for high school students: BigData and Intelligent Energy Systems</a></li>
<li><a href="../283432/index.html">Autodocumenting Perfect Server</a></li>
<li><a href="../283436/index.html">Connect to the webinar: "SQL Server 2016 Data Management Platform." Beginning May 13 at 11:00 (Moscow time)</a></li>
<li><a href="../28344/index.html">Google browser sync goes to open source</a></li>
<li><a href="../283440/index.html">Intel Edison in IoT: securely connecting the touch node to the Internet using MQTT</a></li>
<li><a href="../283442/index.html">Google I / O Extended 2016</a></li>
<li><a href="../283444/index.html">Who and how earns on public public financial data?</a></li>
<li><a href="../283446/index.html">Back to the future: Megamind returns to Habrahabr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>