<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using Microsoft Ajax Library 3.5 with Microsoft CDN</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Using Microsoft Ajax Library 3.5 with CDN 
 Microsoft recently announced the Microsoft Ajax content delivery network (CDN), which can significantly in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using Microsoft Ajax Library 3.5 with Microsoft CDN</h1><div class="post__text post__text-html js-mediator-article"><h4>  Using Microsoft Ajax Library 3.5 with CDN </h4><br>  Microsoft recently announced the Microsoft Ajax content delivery network (CDN), which can significantly increase the performance of any web application using ASP.NET AJAX.  When this technology was announced, the CDN was almost useless for existing ASP.NET 3.5-based web applications, since the CDN did not contain the Microsoft Ajax library 3.5 and did not support SSL work.  However, after a short period of time, Microoft was able to eliminate these problems and now web applications built on the basis of ASP.NET 3.5 can also use Microsoft Ajax CDN. <br><br>  So how can you force a link to MicrosoftAjax.js to refer to a CDN instead of using the file stored in the DLL resources on your server? <a name="habracut"></a>  Actually very simple with the help of ScriptManager.  Add the following definition on the Page (or Master page) which has ScriptManager control: <br><br><blockquote><code><font color="black">&lt;asp:ScriptManager runat= <font color="#A31515">"server"</font> EnablePartialRendering= <font color="#A31515">"false"</font> &gt; <br> &lt;scripts&gt; <br> &lt;asp:ScriptReference Name= <font color="#A31515">"MicrosoftAjax.js"</font> <br> Path= <font color="#A31515">"http://ajax.microsoft.com/ajax/3.5/MicrosoftAjax.js"</font> /&gt; <br> &lt;/scripts&gt; <br> &lt;/asp:ScriptManager&gt;</font> <br></code> </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This declaration means that a script named MicrosoftAjax.js, which is always automatically referenced by the ScriptManager, downloading it from the System.Web.Extensions dll should now be downloaded from this location: <a href="">ajax.microsoft.com/ajax/3.5/MicrosoftAjax.js</a> . <br><br>  This link will be used by default: <br><br><blockquote> <code><font color="black">&lt;script src= <font color="#A31515">"/ScriptResource.axd?d=eYUqBJhfSVL41hIDYkBL0tfaps9hoQId_ <br> 48PydfbcyWH41vNvL68sk-l7P9FLAPz7b4vtI8WkZ-ezAF0b_ZkyG52wt9oU <br> taQ5ezFfGBr7LY1&amp;t=ffffffffef976216"</font> <br> type= <font color="#A31515">"text/javascript"</font> &gt; <br> &lt;/script&gt;</font> <br> <br></code> </blockquote><br><br>  and this is how it will look like after we add the definitions described above to the ScriptReference: <br><br><blockquote> <code><font color="black">&lt;script src= <font color="#A31515">"http://ajax.microsoft.com/ajax/3.5/MicrosoftAjax.js"</font> <br> type= <font color="#A31515">"text/javascript"</font> &gt; <br> &lt;/script&gt; <br></font> <br></code> </blockquote><br><br>  Moreover, the ScriptManager is even smart enough to automatically use the debug version of the MicrosoftAjax.debug.js script from the CDN if the debug mode is enabled in the web.config file: <br><br><blockquote> <code><font color="black">&lt;compilation debug= <font color="#A31515">"true"</font> &gt; <br> &lt;script src= <font color="#A31515">"http://ajax.microsoft.com/ajax/3.5/MicrosoftAjax.debug.js"</font> <br> type= <font color="#A31515">"text/javascript"</font> &gt; <br> &lt;/script&gt; <br></font> <br></code> </blockquote><br><br>  So, everything is clear: we use MicrosoftAjax.js from CDN and this improves the performance of our web application and saves us and our visitors some traffic as the browser will reuse the same cached copy of MicrosoftAjax.js from CDN for all web applications, which link to it. <br><br><h4>  Using conditional script loading from CDN </h4><br>  What if we want to use MicrosoftAjax.js from CDN only when the web application was published to the production server and use the built-in script when we develop the site?  This may make sense when programmers are developing without having an Internet connection.  This option is also possible, but in this case we need to write some code.  We are going to add a link to MicrosoftAjax.js dynamically, depending on the value of the debug variable in the file web.config;  we add the necessary link only for the case when debug = "false": <br><br><blockquote> <code><font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">void</font> Page_Load( <font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">if</font> (!Context.IsDebuggingEnabled) <br> { <br> ScriptManager sm = ScriptManager.GetCurrent( <font color="#0000ff">this</font> ); <br> sm.Scripts.Add( <font color="#0000ff">new</font> ScriptReference {Name = <font color="#A31515">"MicrosoftAjax.js"</font> , <br> Path = <font color="#A31515">"http://ajax.microsoft.com/ajax/3.5/MicrosoftAjax.js"</font> }); <br> } <br> } <br></font> <br></code> </blockquote><br><br><h4>  Using CDN over SSL </h4><br>  Another important case is that our web application has pages that should work using SSL.  In this case, we automatically select the correct CDN URL for MicrosoftAjax.js.  To do this, we just slightly modify the previous code: <br><br><blockquote> <code><font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">void</font> Page_Load( <font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e) <br> { <br> <font color="#0000ff">if</font> (!Context.IsDebuggingEnabled) <br> { <br> ScriptManager sm = ScriptManager.GetCurrent( <font color="#0000ff">this</font> ); <br> sm.Scripts.Add( <font color="#0000ff">new</font> ScriptReference {Name = <font color="#A31515">"MicrosoftAjax.js"</font> , <br> Path = Request.Url.Scheme + <font color="#A31515">"://ajax.microsoft.com/ajax/3.5/MicrosoftAjax.js"</font> }); <br> } <br> } <br></font> <br></code> </blockquote><br><br><h4>  Problems with localization </h4><br>  When using script localization, which can be the case, for example, if you are using the AJAX Control Toolkit, an unpleasant problem emerged: instead of the correct MicrosoftAjax.js address, ScriptManager tries to load a localized version of the script that is not on the site and the application crashes.  This problem can be circumvented by using another parameter to create a ScriptReference, designed to specify the languages ‚Äã‚Äãfor which the localization of this script is supported.  If the language of the user who renders the browser is not contained in this list, the default version of the script will be loaded.  In the list of languages, you can use any string that, in this case, to our advantage.  We modify the example code as follows, specifying ‚Äúnone‚Äù as the supported localization language: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">sm.Scripts.Add( <font color="#0000ff">new</font> ScriptReference {Name = <font color="#A31515">"MicrosoftAjax.js"</font> , <br> Path = <font color="#A31515">"http://ajax.microsoft.com/ajax/3.5/MicrosoftAjax.js"</font> }, <br> ResourceUICultures = <font color="#0000ff">new</font> <font color="#0000ff">string</font> []{ <font color="#A31515">"none"</font> } }); <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now the correct version of the script will always be loaded. <br><br>  <font color="gray">PS Initially, I translated and posted this article in my personal blog: <a href="http://blog.dvteam.ru/">blog.dvteam.ru</a> .</font>  <font color="gray">(The original article is here: <a href="http://blog.turlov.com/2009/11/using-microsoft-ajax-library-35-with.html">blog.turlov.com/2009/11/using-microsoft-ajax-library-35-with.html</a> )</font> <font color="gray"><br></font>  <font color="gray">Could not resist and duplicated it on Habr√©.</font>  <font color="gray">The topic is interesting, and I would not want the information to be lost on my little-known page.</font>  This is my first topic, please do not kick much and do not be lazy to write in the comments if you put a minus for what I got it.  I am not a telepath and I can not take into account your opinion if you do not express it. <br><br>  Many thanks to <a href="https://geektimes.ru/users/pavel_osipov/" class="user_link">Pavel_Osipov</a> for help in highlighting the code. </div><p>Source: <a href="https://habr.com/ru/post/76250/">https://habr.com/ru/post/76250/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../76240/index.html">New Google acquisition</a></li>
<li><a href="../76246/index.html">Jquery tooltip widget</a></li>
<li><a href="../76247/index.html">App Store continues to fail</a></li>
<li><a href="../76248/index.html">What is a Pimpl version of Qt, and with what it is eaten!</a></li>
<li><a href="../76249/index.html">We saw patriotism</a></li>
<li><a href="../76251/index.html">Skype switches to SIP?</a></li>
<li><a href="../76253/index.html">Site Shantsev fell to 1.4 million rubles</a></li>
<li><a href="../76254/index.html">10 inexpensive ways to increase employee loyalty in a startup</a></li>
<li><a href="../76255/index.html">The ethics of robots - is it possible to kill one in order to save five?</a></li>
<li><a href="../76263/index.html">Sketch Flow - a little practical use.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>