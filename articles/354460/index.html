<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Testing systems in TPC-C - fast and easy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The first step in working with new computing resources, no matter whether we build them ourselves or rent them in the cloud, is an assessment of perfo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Testing systems in TPC-C - fast and easy</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/ca5/08a/047/ca508a047fd972a15f9455ef423d89f6.png"><br><br>  The first step in working with new computing resources, no matter whether we build them ourselves or rent them in the cloud, is an assessment of performance.  To this end, a series of tests is carried out that determine the performance of the new stand with respect to the existing one. <br><br>  In an ideal world, such a test is carried out ‚Äúlive‚Äù: the system is copied to a new stand and the real load is emulated.  But this way is too laborious, so synthetic tests are used in the real world. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It has always been interesting to me to measure the performance of our systems and look at their place in the world rankings.  In addition, from time to time there are tasks to load the server with a real load and see how the hardware behaves. <br><br>  And today I‚Äôll tell you how to measure bench performance using the TPC-C test and get the result in standard transactions per second. <br><a name="habracut"></a><br>  To begin, remember what synthetic tests are.  For processors suitable 7-Zip Benchmark, for drives - CrystalDiskMark.  With their help, we can very quickly see how fast our booth works on the algorithms embedded in these (!) Tests.  The thing is that in our system for which the stand is intended, other algorithms will definitely be used.  And with this we have to somehow live. <br><br>  For more accurate disk test results, there is SQLIO or FIO.  Be sure to read <a href="https://habr.com/users/amarao/" class="user_link">Amarao</a> 's two historical articles about testing disks - <a href="https://habrahabr.ru/post/154235/">one</a> and <a href="https://habrahabr.ru/post/168711/">two</a> , and a <a href="https://habrahabr.ru/company/nutanix/blog/348182/">recent article by a colleague</a> .  In these articles, you will learn how to properly apply this complex test. <br><br>  So why did I choose TPC testing for performance evaluation?  <a href="https://tpc.com/">TPC has</a> been developing data-processing tests since 1988.  These tests have long become the industry standard, they are used by almost all hardware vendors and publish the results they achieve on various samples of hardware and software. <br><br>  Since most business systems for which performance is critical are relational databases, the TPC-C test is of most interest to us.  This is a comprehensive test that generates a multi-user OLTP load from various transactions.  For its passage in the database, a set of data is generated, which is typical for business systems related to sales or production of goods and services.  TPC-C can be supplemented with a TPC-H test to emulate the load on an OLAP system. <br><br>  Some may say that the tests are over 10 years old.  But the principle of data processing embodied in them is used in almost every business system.  And that is why they are suitable for simulating a real load. <br><br>  For the TPC-C test we will use the <a href="http://www.hammerdb.com/">HammerDB</a> open source project. <br><br>  Virtual machine options for testing: <br><br><ul><li>  4 vgps 3GHz, <br></li><li>  64 GB of RAM, <br></li><li>  Disk on shared storage with SSD disks. <br></li></ul><br>  Why such parameters?  A smaller number of processors on servers with a DBMS is rare, memory for a DBMS does not happen much, well, putting it on hard disks is more expensive. <br><br>  Installed on the machine software: <br><br><ul><li>  Microsoft Windows 2016 x64, <br></li><li>  Microsoft SQL Server 2017 (not Express edition; or follow the maximum database size), <br></li><li>  SQL Server Management Studio, <br></li><li>  and actually HammerDB. <br></li></ul><br>  Of course, HammerDB and SQL server can be distributed to different VMs / servers to isolate user load from server load, which is quite correct.  But another time. <br><br>  And now we start the test. <br><br><ol><li>  The first step with the help of SQL Server Management Studio is to create a database for tests and place it on a separate disk - this is how you will have higher karma. </li><li>  Next, run HammerDB. <br><ol><li>  Choose MS SQL, TPC-C. </li><li>  Fill in the parameters for connecting to MS SQL: <br><ul><li>  number of warehouses: you can start with ten, but for real tests you need, for example, 2000, </li><li>  number of virtual users: double the number of our processors. </li></ul></li><li>  Click OK and wait. </li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/41d/0ce/047/41d0ce047d1c609272197d62877943ce.jpg"><br><br></li><li>  Our database is filled with data, growing.  For 2000 warehouses the size of the database on disk is about 250 GB. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/38a/4de/54b/38a4de54beb66b5093175c7224023c82.jpg"><br><br></li><li>  After the database is full (this may take several hours), we need to generate a driver script - a test script. <br><ol><li>  Set the conditions: <br><ul><li>  test time limit is 20 minutes </li><li>  time of "acceleration" of the test - 5 minutes.  This restriction is necessary not to "put" the system a sharp start. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/001/f03/e1f/001f03e1f199c054c725e7b9b3fbb3f3.jpg"><br><br></li><li>  Click Ok and go to Load. </li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/360/1bb/8d9/3601bb8d9db24b819f9b5785594093ad.jpg"><br>  <i>Our test script is ready.</i> </li><li>  Go to the Virtual Users and set the number of users. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/512/38e/474/51238e474debe5671e7c4c0556c7a50a.jpg"><br>  <i>In our case - 200 users, but in general it is recommended to set up 10 times less users than warehouses.</i> <br><br>  Here we select Show Output so that the test results are visible at the time of its operation, and the Log Output to Temp to generate a text file with the test results. <br><br>  Click Create, Run! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b17/01a/4b1/b1701a4b1b7dfc44e270c17604df1e3d.jpg"><br>  <i>Our Virtual Users have changed status.</i> </li><li>  We turn to the Transaction Counter and see if our test is launched. <br>  Hooray, it's very simple - and the test works! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a1/358/eef/2a1358eefe14c9d504542eb9a18e0ce1.jpg">  <i>This is how the test results are displayed after launch.</i> </li><li>  We are waiting for 5 minutes.  The load comes to plan;  performance, in my case, improved. <br><img src="https://habrastorage.org/getpro/habr/post_images/994/21d/5eb/99421d5eb082bfd896377dae78e2c49f.jpg"></li><li>  Now let's look at the results from virtualization.  And that's what we see. <br><ul><li>  VM processors during the test were loaded almost 100%: <img src="https://habrastorage.org/getpro/habr/post_images/85f/914/63f/85f91463f305f919c4c0c48e84e00c6f.jpg"></li><li>  The memory was used quite actively: <img src="https://habrastorage.org/getpro/habr/post_images/998/a92/ac0/998a92ac039880fa1d8129d5b7e01a2e.jpg"></li><li>  In disk operations prevailed reading, delays at the expected level: <br><img src="https://habrastorage.org/getpro/habr/post_images/efa/619/813/efa619813ebb3156c2a3a8488306ef3c.jpg"></li></ul></li></ol><br><br>  So, everything is quite simple and now we have a VM with a reference test.  By moving it around the various stands, we can evaluate their relative performance. <br><br>  And finally, useful advice.  During the test, try to remove all possible performance graphs of components of your system.  From them you will see what became the ‚Äúbottleneck‚Äù when passing the test.  Whether you loaded the system enough, or unnecessarily.  It may be worth returning to the test setup step and changing the values. <br><br>  Someone this text may seem very simple.  But I have not yet met in Russian an answer to the question: ‚ÄúHow can I measure the performance of our system in TPC-C?‚Äù Enjoy!  :-) </div><p>Source: <a href="https://habr.com/ru/post/354460/">https://habr.com/ru/post/354460/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354448/index.html">More than a state: US foreign debt</a></li>
<li><a href="../354450/index.html">CocoaHeads April 13, 2018 from Tutu.ru office: video speeches</a></li>
<li><a href="../354452/index.html">Symbolic vulnerability: how a simple message leads to errors in the phone</a></li>
<li><a href="../354456/index.html">SmartMailHack. Winners history in the task Name Entity Recognition</a></li>
<li><a href="../354458/index.html">How much does the compiler cost?</a></li>
<li><a href="../354462/index.html">Improving opportunities for finding vacancies and specialists at My Circle</a></li>
<li><a href="../354464/index.html">Interfaces in the real world-4: updates to the traditional pieces</a></li>
<li><a href="../354466/index.html">How to improve the quality of their work</a></li>
<li><a href="../354468/index.html">Automating log downloads from Kibana to Redmine</a></li>
<li><a href="../354472/index.html">Backup telegram</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>