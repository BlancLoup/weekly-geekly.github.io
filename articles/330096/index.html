<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to make money on the Yandex.Money API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From you - ideas of monetization of streaming and implementation of the Yandex.Money API, from us - the audience, advertising and money. 


 We decide...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to make money on the Yandex.Money API</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/web/bc9/641/f8a/bc9641f8ad2049c0ab157f9bfecd9369.png"></p><br><p>  <strong>From you - ideas of monetization of streaming and implementation of the Yandex.Money API, from us - the audience, advertising and money.</strong> </p><br><p>  We decided to celebrate the sixth birthday of the API transfers with the anti-hackathon, where anyone can try their hand at fighting for the jackpot.  In addition to the cash prize of 100,000 rubles, we <strong>will share with the winner a profit from transfers</strong> via Yandex.Money. </p><br><p>  We invite under the cut all individual developers, entrepreneurs and start-up teams. <a name="habracut"></a></p><br><p>  <strong>How to participate:</strong> you need to develop a ready-to-use solution for collecting money for streaming on the Web. </p><br><p>  <strong>Why do we need it at all: the</strong> number of services with streaming paid content is steadily growing, and there is no convenient way to get money for them.  At least one that would be convenient not only for the owner of the service, but also for the users. </p><br><p>  <strong>How free is the creativity:</strong> the decision should involve payments through the Yandex.Money API, all the rest is up to you.  A jury of experts from the company will select the best solution, and its authors will receive a prize of 100,000 rubles and will be able to pick up a commission of 0.5% from each operation of their service. </p><br><p>  <strong>When we sum up:</strong> ready prototypes and we take your questionnaires <em>until August 1, 2017</em> . </p><br><p>  The API allows you to perform the following tasks: </p><br><ul><li><p>  request a balance; </p><br></li><li><p>  view transaction history; </p><br></li><li><p>  transfer money between wallets; </p><br></li><li>  replenish the electronic wallet with a bank card. </li></ul><br><p>  To make it easier for you to immerse yourself in the solution of the problem, let‚Äôs take a look at examples of popular API usage scenarios. </p><br><h1 id="1-zapros-dostupa-k-operaciyam-v-koshelke">  # 1 Request access to transactions in the wallet </h1><br><p>  Before performing any operations with wallets in Yandex.Money (for example, viewing the history of operations or account status), the developer needs to obtain <a href="https://tech.yandex.ru/money/doc/dg/concepts/protocol-rights-docpage/">certain rights</a> . </p><br><blockquote>  By the way, the authorization of applications in Yandex.Money meets the following specifications: <br><ul><li>  <a href="http://tools.ietf.org/html/rfc6749">The OAuth 2.0 Authorization Framework</a> </li><li>  <a href="http://tools.ietf.org/html/rfc6750">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a> </li></ul><br></blockquote><p>  Register the application and specify its parameters.  As the Redirect URI, specify the address to which Yandex.Money will send the user after successful OAuth authentication.  After that you get your unique <strong>client_id</strong> . </p><br><p>  Now you can request the rights to conduct the necessary actions with the wallets of users.  An example of an authorization request with the right to view the history of operations of the wallet: </p><br><pre><code class="hljs perl">POST /oauth/authorize HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: money.yandex.ru Content-Type: application/<span class="hljs-keyword"><span class="hljs-keyword">x</span></span>-www-form-urlencoded Content-Length: <span class="hljs-number"><span class="hljs-number">191</span></span> client_id=ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ01&amp;response_type=code&amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb&amp;scope=account%2Dinfo%20operation%2Dhistory</code> </pre> <br><p>  Upon authorization request, the user is redirected to the authentication page, where he enters a login password and can confirm or reject the list of requested rights: </p><br><p><img src="https://habrastorage.org/web/855/bd6/cdd/855bd6cdd31f49778124311f71ddc041.png" alt="image alt text"><br>  <em>Authorization interface</em> </p><br><p>  The result of the authorization is returned as <strong>HTTP 302 Redirect</strong> - the application will redirect the user to the Redirect URI address that the developer specified in the request parameters.  The value of the Redirect URI must match the settings of the application, allowing the ability to add any additional parameters to the end of the line.  The redirection address with the successful result of the authorization contains the parameter <strong>code</strong> - a temporary authorization token. </p><br><pre> <code class="hljs pgsql">HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">302</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Found</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Location</span></span>: https://client.example.com/cb?code=i1WsRn1uB1ehfbb37</code> </pre> <br><p>  The last step is to get the token for which a certain set of rights is assigned.  After that, the application changes the temporary token to an authorization token, which the developer will use to access information in the wallet: </p><br><pre> <code class="hljs perl">POST /oauth/token HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: money.yandex.ru Content-Type: application/<span class="hljs-keyword"><span class="hljs-keyword">x</span></span>-www-form-urlencoded Content-Length: <span class="hljs-number"><span class="hljs-number">421</span></span> code=0DF3343A8D9C7B005B1952D9B933DC56ACB7FED6D3F2590A6FD90EC6391050EDFFCC993D325B41B00F58E5383F37F6831E8F415696E1CF07676EE8D0A3655CDD7C667189DFB69BFDB7116C0329303AB2554290048BAF9B767B4C335BF0E85830AC017AD2F14D97F529893C202D3B2C27A61EE53DC4FB04DAE8E815DE2E3F865F&amp;client_id=ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ01&amp;grant_type=authorization_code&amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb</code> </pre> <br><p>  But this answer will come with a successful exchange of temporary token: </p><br><pre> <code class="hljs sql">HTTP/1.1 200 OK Content-Type: application/json Content-Length: 293 <span class="hljs-keyword"><span class="hljs-keyword">Cache</span></span>-Control: <span class="hljs-keyword"><span class="hljs-keyword">no</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">store</span></span> { <span class="hljs-string"><span class="hljs-string">"access_token"</span></span>:<span class="hljs-string"><span class="hljs-string">"410012345678901.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123"</span></span> }</code> </pre> <br><p>  Access_token is a symmetric secret, so the application developer should take additional measures to protect it: keep the token in an encrypted form, provide access only if the owner passes the authentication successfully. </p><br><h1 id="2-prosmotr-istorii-operaciy">  # 2 View transaction history </h1><br><p>  When the token is received, the developer can use it for authorized actions with the wallet.  Let me remind you what exactly this authorization allowed to view the history in the user's wallet. </p><br><blockquote>  The simplest example from the field of crowdfunding in social networks: a certain VKontakte community dedicated to football - there are many subscribers and the activity is good, but this is a project made at leisure, and not a goal of life.  At one time, the public held meetings of subscribers and collected money for this and other needs through the administrator‚Äôs electronic wallet.  For greater transparency in the distribution of the money received, the administrator created a table and pulled in there data on the history of operations through the API.  When someone sends money to the wallet, everyone sees the details of the operation, the sender and the purpose of the transfer. </blockquote><p>  To view the data, we use the <a href="https://tech.yandex.ru/money/doc/dg/reference/operation-history-docpage/">operation-history</a> method, which allows us to personalize the developer's request.  At the output we get, for example, the last 10 transactions, or operations for the last six months, or only expense transactions.  It all depends on the appetite of users for whom the developer creates the service. </p><br><p>  In the case of tape drives, it is useful to display information on the date and time of the incoming deposit, including its amount, nickname and message of the sender, used payment method.  The data is most often filtered by nickname, which can be useful for a streamer: for example, you can choose the best donater (subscriber) and encourage him to offer any game that will be distributed in the near future. </p><br><p>  An example of a request to receive the last five incoming credits to a wallet looks like this: </p><br><pre> <code class="hljs pgsql">POST /api/operation-history HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: <span class="hljs-type"><span class="hljs-type">money</span></span>.yandex.ru <span class="hljs-keyword"><span class="hljs-keyword">Authorization</span></span>: Bearer <span class="hljs-number"><span class="hljs-number">410012345678901.7</span></span>EE34A50588723226C886A475AD1D415471BF687CCC2AFC7664BA12F4EC2BDBA1EB82625E49BC29D114A6C6AF12F87639A877E81A5B77B81F003A9DB4CCEB9BD80C6E70B157C18410E884465276AACBD58C2D7B6022CBDFD0004B80704E82D3F0E4039A29655EFAA44F037D6BF763B0B803329FE8A0E511057173B04341C4317 Content-<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>: application/x-www-form-urlencoded records=<span class="hljs-number"><span class="hljs-number">5</span></span>&amp;<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>=deposition</code> </pre> <br><p>  Here is what Yandex.Money service can answer: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"next_record"</span></span>: <span class="hljs-string"><span class="hljs-string">"5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"operations"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"operation_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"548936732440013012"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"amount"</span></span>: <span class="hljs-number"><span class="hljs-number">1.96</span></span>, <span class="hljs-attr"><span class="hljs-attr">"direction"</span></span>: <span class="hljs-string"><span class="hljs-string">"in"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetime"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-05-24T10:25:32Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"label"</span></span>: <span class="hljs-string"><span class="hljs-string">"123007"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"deposition"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"pattern_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"p2p"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"operation_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1097872036856016025"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"  410012345678902"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"amount"</span></span>: <span class="hljs-number"><span class="hljs-number">0.99</span></span>, <span class="hljs-attr"><span class="hljs-attr">"direction"</span></span>: <span class="hljs-string"><span class="hljs-string">"in"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetime"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-05-24T10:13:38Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"incoming-transfer"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"operation_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"548428048231013012"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"amount"</span></span>: <span class="hljs-number"><span class="hljs-number">1.96</span></span>, <span class="hljs-attr"><span class="hljs-attr">"direction"</span></span>: <span class="hljs-string"><span class="hljs-string">"in"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetime"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-05-18T13:07:28Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"deposition"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"operation_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"548427906481013012"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"amount"</span></span>: <span class="hljs-number"><span class="hljs-number">1.96</span></span>, <span class="hljs-attr"><span class="hljs-attr">"direction"</span></span>: <span class="hljs-string"><span class="hljs-string">"in"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetime"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-05-18T13:05:06Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"deposition"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"pattern_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"p2p"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"operation_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1096319740674326025"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"  410012345678903"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"amount"</span></span>: <span class="hljs-number"><span class="hljs-number">0.01</span></span>, <span class="hljs-attr"><span class="hljs-attr">"direction"</span></span>: <span class="hljs-string"><span class="hljs-string">"in"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetime"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-05-15T10:37:50Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"incoming-transfer"</span></span> } ] }</code> </pre> <br><p>  Another example of a service based on a request for history is collective purchases on the forums: people agree to chip in and order something in bulk at a lower price, and the organizer collects money for his wallet.  For everyone to see how many participants are in the purchase and how money is spent, you can use one of the many services based on the Yandex.Money API.  It is enough for the collector to log in to the wallet in one of these services. </p><br><h1 id="3-proverka-balansa">  # 3 Balance Check </h1><br><p>  Game streamers often work with multiple monitors, so the Yandex.Money team developed a widget in which you can specify the purpose of collecting money, the required amount - and track progress.  For example, a streamer wants to buy a new PlayStation 4. Once the required amount is collected in the wallet, Yandex.Money will send a notification to the widget that it‚Äôs time to make an order. </p><br><p><img src="https://habrastorage.org/web/658/b77/1a5/658b771a5efa4144aedcacace5809603.png" alt="image alt text"><br>  <em>Accumulation widget.</em> </p><br><blockquote>  Another example is when a streaming service needs constant access to the balance - a loyalty program: for example, you can place a pizzeria offer with a discount in your streamer‚Äôs personal account, where you can instantly order pizza.  But before that, the service must make sure that there is enough money in the account to order. </blockquote><p>  To view the balance, you can use the <a href="https://tech.yandex.ru/money/doc/dg/reference/account-info-docpage/">account-info</a> method <a href="https://tech.yandex.ru/money/doc/dg/reference/account-info-docpage/">:</a> </p><br><pre> <code class="hljs pgsql">POST /api/account-<span class="hljs-keyword"><span class="hljs-keyword">info</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: <span class="hljs-type"><span class="hljs-type">money</span></span>.yandex.ru <span class="hljs-keyword"><span class="hljs-keyword">Authorization</span></span>: Bearer <span class="hljs-number"><span class="hljs-number">410012345678901.1578E01607</span></span>EB3899853D2883E47841A195BC561F1F8CF479D593B662AD60B2D146EE49F02D750CB2972E51E0DF10369AE77FD930D82B7563AA0D65FA709A7C31EB59D4FFC1F2E85A14A817BDFB282C5A82FF1B79C65D2AE7B3BAE1C1C7D89CBE80477FF1C51A8F3DD9A032475BE629235949B7A2CA7823AC6AC06DB3176F9B54 Content-<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>: application/x-www-form-urlencoded</code> </pre> <br><p>  In response, the server will return the following: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"account"</span></span>: <span class="hljs-string"><span class="hljs-string">"410012345678901"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"balance"</span></span>: <span class="hljs-number"><span class="hljs-number">192.45</span></span>, <span class="hljs-attr"><span class="hljs-attr">"currency"</span></span>: <span class="hljs-string"><span class="hljs-string">"643"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"account_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"professional"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"identified"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"account_status"</span></span>: <span class="hljs-string"><span class="hljs-string">"identified"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"cards_linked"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"MasterCard"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"4005641800"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pan_fragment"</span></span>: <span class="hljs-string"><span class="hljs-string">"532130******2227"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"balance_details"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"total"</span></span>: <span class="hljs-number"><span class="hljs-number">192.45</span></span>, <span class="hljs-attr"><span class="hljs-attr">"available"</span></span>: <span class="hljs-number"><span class="hljs-number">192.45</span></span>, <span class="hljs-attr"><span class="hljs-attr">"blocked"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> } }</code> </pre> <br><p>  As a result, you will receive not only detailed information on the balance, but also information about the attached bank cards: the masked card number, type, ID of the linked card. </p><br><div class="spoiler">  <b class="spoiler_title">Another couple of scenarios where the balance check via the API is useful.</b> <div class="spoiler_text"><ul><li><p>  My favorite example is Zen-mani.  This is a service that helps users keep track of their budget and plan future spending.  The developers of Zen-mani offered users to link the Yandex.Money purse to the application so that it could add new spending operations and revenues on its own.  Of course, the option is useful only to active users of the wallet, who pay most of the purchases from it.  And this is really a great blessing, since in accounting for personal finances the most difficult thing is not to forget to note expenses in the program.  You can <a href="https://geektimes.ru/post/118161">read</a> how it all works in the article by Zen-mani at <a href="https://geektimes.ru/post/118161">Geektimes</a> . </p><br></li><li>  Or Classto is a service for parents and teachers to communicate.  With it, you can collect in a general wallet for the needs of the class not cash, but transfers from bank cards directly in the application.  You can also check the balance and find out how much money has been collected - an important element of transparency of fees and expenses, as this information is seen by any parent. </li></ul><br></div></div><br><h1 id="4-perevod-iz-koshelka">  # 4 Transfer from wallet </h1><br><p>  Using the API, you can initiate not only transfers from the wallet, but also from the linked card.  This is convenient for instant settlements with people who do not keep money in their wallet and use it as an interlayer, so as not to shine a card on the Internet.  At the same time, the payer is still in control of expenses, because even automatic debiting from the linked card must be authorized. </p><br><p>  How it works: </p><br><ol><li><p>  After receiving confirmation from the user, the API will try to write off the requested amount from the wallet. </p><br></li><li><p>  If there is not enough money on the balance, the service will respond <strong>not_enough_funds</strong> . </p><br></li><li>  Further, the service can write off money from a card tied to a wallet, if the user has allowed it.  Automatic debiting from the linked card is available only to legal entities.  In addition, to write off money from the card will not work when transferring between wallets. </li></ol><br><p>  Streamers can motivate viewers to subscribe to regular transfers for public gratitude on the air or social networks, gifts or the right to choose the next game for stream. </p><br><p>  Subscription is as follows: </p><br><ol><li><p>  Next to the ‚ÄúSupport‚Äù button there can be a checkbox ‚ÄúSubscribe to a monthly payment in favor of this tape drive‚Äù. </p><br></li><li>  When a user clicks on the ‚ÄúSupport‚Äù button, the developer checks the condition of regular payments and adjusts the list of requested rights in the Yandex.Money request. </li></ol><br><p>  Since we are talking about the operation in the wallet, you need to request permission to conduct it - the request for access remains almost as in Example 1, but the scope changes. </p><br><p>  The set of requested rights, which allows you to make a one-time transfer in the amount of 1000 rubles to the purse 410012345678901, is as follows: </p><br><pre> <code class="hljs pgsql">payment.<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>-account("410012345678901").<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>(,<span class="hljs-number"><span class="hljs-number">1000</span></span>)</code> </pre> <br><p>  If the sender subscribes to regular payments, the authorization may have the following meaning: </p><br><pre> <code class="hljs pgsql">payment.<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>-account("410012345678901").<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>)</code> </pre> <br><p>  Where 30 is the time period in days, 1000 is the total amount of payments for the period. </p><br><p>  Sample request for regular write-off: </p><br><pre> <code class="hljs perl">POST /oauth/authorize HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: money.yandex.ru Content-Type: application/<span class="hljs-keyword"><span class="hljs-keyword">x</span></span>-www-form-urlencoded client_id=<span class="hljs-number"><span class="hljs-number">49414287408917</span></span>F4BC735301F4731878533F409F3BA8EA055D0D441EE002F69B&amp;redirect_uri=http%3A%2F%2Fexample.com%2Fapi%2Fredirect_uri.php&amp;response_type=code&amp;scope=payment.to-account(%22410012345678903%22).limit(<span class="hljs-number"><span class="hljs-number">30</span></span>%2C1000)</code> </pre> <br><p>  The sender will see a beautiful form: </p><br><p><img src="https://habrastorage.org/web/fb6/3d7/ed7/fb63d7ed7f3d4dfd803475b46464a406.png" alt="image alt text"></p><br><p>  After receiving the token, the developer needs to write off via the <strong>request-payment</strong> and <strong>process-payment</strong> methods: </p><br><pre> <code class="hljs pgsql">POST /api/request-payment HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: <span class="hljs-type"><span class="hljs-type">money</span></span>.yandex.ru Content-<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>: application/x-www-form-urlencoded <span class="hljs-keyword"><span class="hljs-keyword">Authorization</span></span>: Bearer <span class="hljs-number"><span class="hljs-number">410012345678901.</span></span>D2E0917C3E09DE474DD3BF6288DDCB6818D55B6BBC8A9386ABA2A983F3F4666102F9B7A2D370D7079891299907368389F3BA8E2BE04597DCFF4CF02F4E3423896776D1C5CCE30A09B5D2E73874C5FE33CAE19286EAB03D146B46A188939BEC1ADA93F3530ECBFACA2591715F686EDBC9F616A7BF912CF4DC9CFB689473328347 pattern_id=p2p&amp;<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>=<span class="hljs-number"><span class="hljs-number">410012345678903</span></span>&amp;amount=<span class="hljs-number"><span class="hljs-number">10</span></span>&amp;<span class="hljs-keyword"><span class="hljs-keyword">comment</span></span>=Transfer+<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>+Nuke73&amp;message=Transfer+<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>+SuperMan</code> </pre> <br><p>  Sample answer: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"request_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"333235373335343733345f646366303562383436613661306133373130663766343166303137666131336262656637353539655f323537353532373836"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"recipient_identified"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"multiple_recipients_found"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"recipient_account_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"professional"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"recipient_account_status"</span></span>: <span class="hljs-string"><span class="hljs-string">"identified"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"contract_amount"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"money_source"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"cards"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"allowed"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"wallet"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"allowed"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"card"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"allowed"</span></span>: <span class="hljs-string"><span class="hljs-string">"false"</span></span> } } }</code> </pre> <br><blockquote>  Speaking of transfers and commissions.  In your personal account, you can choose who pays a commission for the transfer - the <strong>amount</strong> and <strong>amount_due</strong> parameters are responsible for this.  If the amount_due parameter is specified in the payment template, then this amount will go to the streamer wallet (commission paid by the viewer).  If the streamer is ready to take it over, then the input parameter indicates the amount.  Thus, the amount (amount to be transferred) is equal to the amount of commission and amount_due (amount receivable). </blockquote><p>  The transfer is performed after calling the <strong>process-payment</strong> method without the participation of the user, who once confirmed access when authorizing access.  The <strong>request_id</strong> is the identifier from the request-payment method response. </p><br><pre> <code class="hljs pgsql">POST /api/process-payment HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: <span class="hljs-type"><span class="hljs-type">money</span></span>.yandex.ru Content-<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>: application/x-www-form-urlencoded <span class="hljs-keyword"><span class="hljs-keyword">Authorization</span></span>: Bearer <span class="hljs-number"><span class="hljs-number">410012345678901.</span></span>D2E0917C3E09DE474DD3BF6288DDCB6818D55B6BBC8A9386ABA2A983F3F4666102F9B7A2D370D7079891299907368389F3BA8E2BE04597DCFF4CF02F4E3423896776D1C5CCE30A09B5D2E73874C5FE33CAE19286EAB03D146B46A188939BEC1ADA93F3530ECBFACA2591715F686EDBC9F616A7BF912CF4DC9CFB689473328347 request_id=<span class="hljs-number"><span class="hljs-number">333235373335343733345</span></span>f646366303562383436613661306133373130663766343166303137666131336262656637353539655f323537353532373836</code> </pre> <br><p>  Sample answer: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"payer"</span></span>: <span class="hljs-string"><span class="hljs-string">"410012345678901"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"payee"</span></span>: <span class="hljs-string"><span class="hljs-string">"410012345678903"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"credit_amount"</span></span>: <span class="hljs-number"><span class="hljs-number">9.95</span></span>, <span class="hljs-attr"><span class="hljs-attr">"payment_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"549038975018120011"</span></span> }</code> </pre> <br><p>  Excellent - the debit from the wallet was successful. </p><br><h1 id="5-perevod-s-bankovskoy-karty">  # 5 Transfer from a bank card </h1><br><p>  Transfer from a bank card is different from transfer from a wallet: </p><br><ul><li><p>  First, it does not require an authorization request.  To identify the card payment application, the developer registers his copy with Yandex.Money and obtains an instance_id using the <a href="https://tech.yandex.ru/money/doc/dg/reference/instance-id-docpage/">same-name method</a> ; </p><br></li><li>  Secondly, the sender somewhere you need to specify the details of your bank card.  To display this form, the developer needs to create a payment based on a standardized template using the <a href="https://tech.yandex.ru/money/doc/dg/reference/request-external-payment-docpage/">request-external-payment</a> method, and then initiate the payment operation using <a href="https://tech.yandex.ru/money/doc/dg/reference/process-external-payment-docpage/">process-external-payment</a> . </li></ul><br><p>  If the transfer is completed successfully, the <strong>request-external-payment</strong> method will return the following: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"   410011498692222"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"contract_amount"</span></span>: <span class="hljs-number"><span class="hljs-number">102.04</span></span>, <span class="hljs-attr"><span class="hljs-attr">"request_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"333235373135303437315f36313764393332336462393164373433353264303465346432626262313465353933363763333133"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"money_source"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"payment-card"</span></span>: {} } }</code> </pre> <br><p>  After receiving the <strong>request_id</strong> - a unique identifier for the payment context - you can initiate a payment transaction and redirect the user to the Yandex.Money form.  To do this, use a POST request at the address acs_uri with the parameters acs_params, where the payer needs to specify the bank card details. </p><br><p>  Request example: </p><br><pre> <code class="hljs perl">POST /api/process-external-payment HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: money.yandex.ru Content-Type: application/<span class="hljs-keyword"><span class="hljs-keyword">x</span></span>-www-form-urlencoded request_id=<span class="hljs-number"><span class="hljs-number">333235373135303437315</span></span>f36313764393332336462393164373433353264303465346432626262313465353933363763333133&amp;instance_id=hh2CVJWrU9uU7N2hpEh1LvjfyBAby8USyMUEF4DM8AS6w93o53M3xrlGHsMUiWTL&amp;ext_auth_success_uri=http%3A%2F%2Fexample.com%2Fsuccess%2F&amp;ext_auth_fail_uri=http%3A%2F%2Fexample.com%2Ffalse%2F&amp;request_token=false</code> </pre> <br><p>  And the answer is: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"ext_auth_required"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"acs_uri"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://m.money.yandex.ru/internal/public-api/to-payment-type"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"acs_params"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"cps_context_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"333235373135303437315f36313764393332336462393164373433353264303465346432626262313465353933363763333133"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"paymentType"</span></span>: <span class="hljs-string"><span class="hljs-string">"FC"</span></span> } }</code> </pre> <br><p><img src="https://habrastorage.org/web/153/4d1/fd4/1534d1fd4d264c8bb4fe8d62eff17882.png" alt="image alt text"><br>  <em>Card form Yandex.Money.</em> </p><br><p>  Directly carrying the payment falls on the shoulders of Yandex. Money.  After specifying the bank card details and clicking on the ‚ÄúPay‚Äù button, the user will go to the <strong>3-D Secure</strong> page <strong>of</strong> his issuing bank and, after entering the password, return to the developer's service: if the 3-D Secure authentication by the bank card is completed successfully, it will go to the page with payment confirmation (ext_auth_success_uri).  If the issuing bank refused to authenticate, the user is redirected to the page with an error (ext_auth_fail_uri). </p><br><blockquote>  Redirect addresses can be specified by the developer when calling the process-external-payment method. </blockquote><p>  When the payer goes to the success page after checking 3-D Secure, you need to make sure that the authorization on the bank card was also successful.  To do this, the developer re-invokes <strong>process-external-payment</strong> with the previously received <strong>request_id</strong> . </p><br><p>  Sample answer: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, }</code> </pre> <br><p>  Usually, card authorization occurs within 10-20 seconds after authentication.  If at the time of the process-external-payment re-call we did not receive the authorization status from the bank, the developer will know about it. </p><br><p>  An example of a similar answer: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"in_progress"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"next_retry"</span></span>: <span class="hljs-string"><span class="hljs-string">"5000"</span></span> }</code> </pre> <br><p>  <strong>Next_retry</strong> is the recommended time in milliseconds when the request should be repeated.  The field is present only in the <strong>in_progress</strong> status. </p><br><h1 id="dopolnitelnye-vozmozhnosti-konstruktor-form-i-knopok">  Additional features: form and button designer </h1><br><p>  The payment solution using the API requires some effort and complex technological interaction.  A simpler option is to use <a href="">ready-made custom</a> Yandex.Money <a href="">forms</a> : the information about the transfer is broken down into parameters and transmitted by the POST method to a special address. </p><br><p><img src="https://habrastorage.org/web/ff2/c65/677/ff2c6567743f4804827ba067eb2e2b07.png" alt="image alt text"></p><br><p>  <em>An example of the interface of the form of transfers to the Yandex streamer wallet.</em> </p><br><p>  The translation script using a custom form looks like this: </p><br><ol><li><p>  The sender chooses how to transfer money - from an electronic wallet or from a bank card. </p><br></li><li><p>  The developer generates a string from <a href="">the</a> Yandex.Money <a href="">parameters set</a> and sends them by the POST method to <strong>money.yandex.ru/quickpay/confirm.xml</strong> along with a unique payment label (label) for further identification.  The developer keeps the details of the operation in his database. </p><br></li><li><p>  The payer proceeds to the page for selecting the payment method and confirming the transfer on the Yandex.Money side, and the amount is debited and credited to the tape drive's purse.  Of course, minus the commission. </p><br></li><li><p>  The recipient will know about the receipt of funds through the HTTP-notification, email, SMS, push.  The address of the notification handler to the recipient must be specified in the wallet settings in advance. </p><br></li><li>  The developer analyzes the details received at the address of the processor and decides on further actions.  In our case, if the incoming amount satisfied the conditions of the tape drive, a subscriber message with an animated accompaniment was transmitted in its video stream.  The message was reproduced using <a href="https://tech.yandex.ru/speechkit/">SpeechKit</a> technology. </li></ol><br><p>  In this scenario, there is one drawback: for normal operation of the service, streamer requires extra manipulations with the settings of HTTP notifications inside the wallet. </p><br><p>  <strong>Unlike the API, the forms and buttons allow you to transfer money from a linked bank card.</strong>  <strong>However, the commission is taken only from the recipient</strong> . </p><br><p>  In order not to require unnecessary manipulations from the tape drive, it is enough to learn to look at its history of operations and match the unique translation label with the data from the database.  It remains only to get access to the tape drive operations, for which, at the very beginning of the article, we asked the tape drive to confirm access to <strong>account-info</strong> and <strong>operation-history</strong> rights.  The first method will help us find out the wallet number of the tape drive, the second - information on operations. </p><br><p>  Here is the answer to the request of the last two operations in the streamer wallet through the API using the operation-history method (the translation was received through a customized form): </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"next_record"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"operations"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"operation_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"549575176734053012"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"amount"</span></span>: <span class="hljs-number"><span class="hljs-number">49</span></span>, <span class="hljs-attr"><span class="hljs-attr">"direction"</span></span>: <span class="hljs-string"><span class="hljs-string">"in"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetime"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-05-31T19:46:16Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"label"</span></span>: <span class="hljs-string"><span class="hljs-string">"yadonate#1782"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"deposition"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"pattern_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"p2p"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"operation_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1098088627442030025"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"  410011498790000"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"amount"</span></span>: <span class="hljs-number"><span class="hljs-number">9.95</span></span>, <span class="hljs-attr"><span class="hljs-attr">"direction"</span></span>: <span class="hljs-string"><span class="hljs-string">"in"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetime"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-05-25T16:18:33Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"label"</span></span>: <span class="hljs-string"><span class="hljs-string">"testpayment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"success"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"incoming-transfer"</span></span> } ] }</code> </pre> <br><p>  After checking the success of the transfer to the Streamer wallet, you can create your favorite magic in the video stream. </p><br><p>  In this post, we looked at only the most basic ideas and scenarios for using the API for streaming services.  If something is not clear, feel free to ask in the comments.  And if among readers there are streamers or their viewers - share your opinion on how to make donations more convenient and more fun. </p><br><p>  You can register for participation on <a href="https://events.yandex.ru/events/meetings/18-august-2017/">Yandex.Events</a> .  <strong>Prototypes and questionnaires are accepted until August 1, 2017.</strong> </p><br><p>  <em>By screws!</em> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/330096/">https://habr.com/ru/post/330096/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330086/index.html">Preview RamblerFront & # 1</a></li>
<li><a href="../330088/index.html">All Flash Isilon NAS: Scalable Storage for Unstructured Data</a></li>
<li><a href="../330090/index.html">How did the intro on 64k</a></li>
<li><a href="../330092/index.html">Monte Carlo and tic-tac-toe tree search</a></li>
<li><a href="../330094/index.html">On the issue of numbers</a></li>
<li><a href="../330098/index.html">Text online from the festival RIT ++ 2017. Day One</a></li>
<li><a href="../330100/index.html">Text online from the festival RIT ++ 2017. Day two</a></li>
<li><a href="../330102/index.html">How to teach computational thinking?</a></li>
<li><a href="../330104/index.html">On the eve of Heisenbag: Grid Dynamics about testing</a></li>
<li><a href="../330106/index.html">20 free utilities and 89 scripts for monitoring and managing databases</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>