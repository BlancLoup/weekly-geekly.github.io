<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Add our own commands to the Explorer context menu</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once I already told on Habr√© how you can add your own command to the context menu of the Internet Explorer browser (A convenient addition to IE when w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Add our own commands to the Explorer context menu</h1><div class="post__text post__text-html js-mediator-article">  Once I already told on Habr√© how you can add your own command to the context menu of the Internet Explorer browser (A <a href="http://habrahabr.ru/blogs/ie/68067/">convenient addition to IE when writing reviews / Internet Explorer / Habrahabr</a> ).  Now I will tell you how to add your command to the context menu of the Explorer.  Go. <br><br><a name="habracut"></a><br><br>  Information about the context menu of the Explorer and the Desktop is stored in the registry key <b>HKEY_CLASSES_ROOT \ Directory \ Background \ Shell</b> .  It is from here that the system will know which commands need to be displayed in the context menu and which programs need to be launched when the user clicks on the selected menu command.  Thus, armed with this knowledge, we will be able to create the teams we need. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, to add a new command to the context menu, just create a new subkey in the <b>HKCR \ Directory \ Background \ Shell</b> section.  Suppose we want a command to appear on the menu that starts a standard Notepad.  We create a subsection of <b>notepad</b> and we can immediately check and make sure that the same-name command has appeared in the context menu of the Desktop.  We didn't even have to restart the computer.  Naturally, such a team does not suit us very much, and we want to set our own text, for example, <b>Notepad</b> .  To do this, edit the default parameter of the created subsection and write a new value for it that we want to see, for example, write the word <b>Notepad</b> .  We check again and make sure that our command appeared in the context menu. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/531/4a1/644/5314a1644f6510e91ddaa3ea9d7644d6.jpg"><br><br>  Now we configure other parameters so that the created command reacts to mouse clicks.  A subsection may contain other nested subsections and various string type parameters.  First, consider the parameters.  We already know that the default parameter defines the name of the command.  You can also use the following parameters (I present only a part of the possible parameters): <br><ul><li>  <b>MUIVerb</b> - the value of this parameter replaces the default value of the parameter, i.e.  we can in this parameter set the name for the command in the menu. </li><li>  Extended - if this parameter is present without a value, it tells the system that the command should be displayed only when the Shift key is pressed.  You can look at the subkey <b>HKEY_CLASSES_ROOT \ Directory \ Background \ shell \ cmd</b> , which contains such a parameter.  Therefore, if you hold down the Shift key, then the <b>Open</b> command <b>window command</b> appears in the context menu. </li></ul><br><br>  We now turn to subsections.  First of all, you need to create a subsection of <b>command</b> .  The default parameter of this subsection should contain a command that will be executed when selecting the corresponding item in the context menu.  In our case, you need to register the notepad.exe command. <br><br><img src="http://i002.radikal.ru/0912/cc/611251c3df70.jpg"><br><br>  As you can see, a few simple operations in the registry section and we get a new command for the context menu of the Desktop and Explorer.  And knowing the algorithm for creating a new command, you can study and edit the parameters from other programs that have registered their sections on your system. <br><br><h2>  Turn on / off thumbnails </h2><br><br>  Consider a practical example of creating your own team in the Explorer menu.  If you prefer to view files in Icon mode, you noticed that, for example, image icons are displayed as thumbnails.  In the folder settings, you can change this behavior and disable thumbnail display.  But to enable or disable these settings is very tedious.  Judge for yourself - you first need to press the Alt key so that the Explorer menu bar appears, then select the <b>Tools |</b>  <b>Folder options ...</b>  After that, you need to switch to the <b>View</b> tab and check or uncheck the <b>Always display icons, not sketches</b> box.  Simplify the task using the registry and a small VBS script that cyclically changes the values ‚Äã‚Äãof the <b>IconsOnly</b> parameter in the <b>HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Explorer \ Advanced</b> section.  Create a new <b>ToggleThumb</b> section in the <b>HKEY_CURRENT_USER \ Software \ Classes \ Directory \ Background \ Shell</b> section and assign the string value <b>Enable / Disable Thumbnails</b> to the default parameter.  Thus, we have created a new command for the context menu of the folder in Explorer.  Notice that we now use the <b>HKEY_CURRENT_USER</b> section so that the example applies to only one user.  Now we create a subsection of the <b>command</b> and set the default string <b>wscript.exe "% WinDir% \ togglethumbs.vbs"</b> in the parameter.  Next you need to create a script that will switch the display mode thumbnails. <br><br><pre> Set WshShell = CreateObject ("WScript.Shell")
 strValue = "HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Explorer \ Advanced \ IconsOnly"
 strIconsOnly = WshShell.RegRead (strValue)
 If strIconsOnly = 0 Then
 WshShell.RegWrite strValue, 1, "REG_DWORD"
 Else
 WshShell.RegWrite strValue, 0, "REG_DWORD"
 End if
 WshShell.SendKeys "{F5}"
</pre><br><br>  Save the created script as togglethumbs.vbs and copy it to the Windows folder. <br>  Now you can open the Conductors and test the work of the new team.  For convenience, I first selected the Large Icons mode, which are displayed as thumbnails. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/02a/d65/5c3/02ad655c3a1c424fbd04360ac8adaa48.jpg" alt="Display files as thumbnails"><br><br>  Then I selected <b>Enable / Disable Thumbnails</b> in the context menu and got the following result - instead of thumbnails, I saw the icons of Adobe Photoshop, the introductory version of which I put on my computer a few days ago. <br><br><img src="http://i024.radikal.ru/0912/dd/41ebb67dfff0.jpg" alt="Display files as icons"><br><br>  I got the idea for this example from <a href="http://www.winhelponline.com/blog/toggle-thumbnail-previews-right-click-menu-windows-vista-windows-7/">http://www.winhelponline.com/blog/toggle-thumbnail-previews-right-click-menu-windows-vista-windows-7/</a> and modified it a bit.  For more convenience, the author of the original example suggests using ready-made REG-files (togglethumbs.reg) and deleting (undo.reg) sections for a new team, as well as a ready-made script (togglethumbs.vbs).  I'd add that copying the script file to the Windows folder used by the author of the idea is not the best option, since this folder is protected and you do not need to clutter it with your own files.  Therefore, if you use the example on your computer, then redo it so that the script file is in a location more accessible to the user. <br><br><h2>  Deleting the contents of a folder without deleting the folder itself </h2><br><br>  Almost similarly added its own command and in the context menu of the folder.  Recently I found one example of using the context menu of a folder in Explorer - <a href="http://www.thewindowsclub.com/add-delete-folder-contents-to-windows-7-right-click-context-menu">Add Empty Folder Contents to Windows 7 Right Click Context Menu.</a>  <a href="http://www.thewindowsclub.com/add-delete-folder-contents-to-windows-7-right-click-context-menu">|</a>  <a href="http://www.thewindowsclub.com/add-delete-folder-contents-to-windows-7-right-click-context-menu">The Windows Club</a> . <br><br>  The author of the example tells how to add a command to the folder context menu for deleting the contents of the folder without deleting the folder itself.  Those.  you do not have to open the folder, select all files and press the Delete key, just select the <b>Delete folder contents</b> command.  I modified the example a little to make it more organic on the Russian version of Windows. <br><br>  To do this, add the <b>DeleteFolderContent subsection</b> to the <b>HKEY_CLASSES_ROOT \ Directory \ shell section</b> and create in it the string parameter <b>MUIVerb</b> with the string <b>Delete the contents of the folder</b> .  Further, in the <b>DeleteFolderContent</b> section, <b>we</b> create a subsection of the <b>command</b> and in its default parameter we write the line: <br><br><pre> cmd / c "cd / d% 1 &amp;&amp; del / s / f / q *. *"
</pre><br><br>  Everything is ready and you can use an example. <br><br><h2>  Conclusion </h2><br><br>  I want to warn you that I told you about the basic techniques for creating commands in the context menu of the Explorer.  The registry is quite a complicated thing and there are other ways to work with the context menu. <br><br>  As you can see, you can independently configure the context menu of the Explorer.  It all depends on your imagination.  If you need additional information about the registry settings, you can download the <b>Windows Registry</b> online guide on my site <a href="http://user.alexanderklimov.ru/">user.alexanderklimov.ru</a> .  In addition, a preliminary agreement was reached with one publisher on the release of a book on the Windows 7 registry. As they say, stay tuned.  By the way, while working on the book, I found out that many parameters were outdated and it was time to remove them from the directory.  But, since the number of users of Windows XP is still large, I decided to create a kind <a href="http://winchanger.narod.ru/registry/registry.htm">of a settling page</a> , where I will dump the old parameters. <br><br>  PS Strictly speaking, the methods of setting the context menu in Explorer are available in other versions of Windows, including Windows XP.  But, I have long since switched to Windows 7, so I‚Äôm posting this post on this blog. <br><br></div><p>Source: <a href="https://habr.com/ru/post/79443/">https://habr.com/ru/post/79443/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../79434/index.html">Do you have a floppy disk drive?</a></li>
<li><a href="../79435/index.html">OptionParser and UnitTest in python scripts</a></li>
<li><a href="../79439/index.html">Distributed Network Messaging Protocol - Well Forgotten FTN</a></li>
<li><a href="../79440/index.html">YouTube infrastructure</a></li>
<li><a href="../79442/index.html">Banana Cargo</a></li>
<li><a href="../79444/index.html">How much science in the movie Avatar?</a></li>
<li><a href="../79445/index.html">NPL Snowman by NPL</a></li>
<li><a href="../79446/index.html">iWebkit as a way to optimize your site for iPhone</a></li>
<li><a href="../79447/index.html">Weekday gamedev</a></li>
<li><a href="../79448/index.html">Samsung GT-i5700 Galaxy Spica Review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>