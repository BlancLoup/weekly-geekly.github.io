<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Interaction with GIS utilities using stunnel and openssl according to GOST</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The task of adjusting interaction with the GIS housing and communal services stood in front of us in full growth. According to the documentation , it ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Interaction with GIS utilities using stunnel and openssl according to GOST</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/8b5/4ac/bb8/8b54acbb80444c6e90ad24ede34ac7b6.jpg"><br><br>  The task of adjusting interaction with the <a href="https://dom.gosuslugi.ru/" title="https://dom.gosuslugi.ru/">GIS housing and communal services</a> stood in front of us in full growth.  According to the <a href="https://dom.gosuslugi.ru/filestore/publicDownloadServlet%3Fcontext%3Dcontentmanagement%26uid%3Df649ed5a-4cd6-40ca-aaae-67a063f63973" title="https://dom.gosuslugi.ru/filestore/publicDownloadServlet?context=contentmanagement&amp;uid=f649ed5a-4cd6-40ca-aaae-67a063f63973">documentation</a> , it is supposed to use the well-known domestic software to encrypt the tunnel and form an EDS according to GOST, but this is not our method.  Armed with Google and the console, I and <a href="https://habrahabr.ru/users/slavam/" class="user_link">slavam</a> implemented the necessary functionality with improvised means. <br>  All the necessary software is on both Linux and Windows platforms, because the technique can be called multiplatform. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  <a href="https://habr.com/ru/post/300856/">Training</a> </li><li>  <a href="https://habr.com/ru/post/300856/">Crypto Tunnel according to GOST</a> </li><li>  <a href="https://habr.com/ru/post/300856/">XMLDSig generation</a> </li><li>  <a href="https://habr.com/ru/post/300856/">Links</a> </li></ol><br><br><h4>  Training </h4><br><br>  The interaction consists of the following parts: <br><ul><li>  Installation according to GOST encrypted tunnel to the servers GIS utilities. </li><li>  Generate and send a signed XML request. </li><li>  Receiving and checking the answer. </li></ul><br>  To work using the server CentOS 6, Python 2.7.11, OpenSSL + GOST engine, stunnel.  Brief installation instructions openssl with GOST support <br><div class="spoiler">  <b class="spoiler_title">for the lazy:</b> <div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># wget https://www.openssl.org/source/openssl-1.0.2g.tar.gz # tar -xvf openssl-1.0.2g.tar.gz # cd openssl-1.0.2g/ # yum groupinstall "Development Tools" # yum install zlib zlib-devel # ./config shared zlib enable-rfc3779 # make &amp;&amp; make install # echo "/usr/local/ssl/lib/" &gt; /etc/ld.so.conf.d/openssl.conf # ldconfig # /usr/local/ssl/bin/openssl ciphers | tr ":" "\n" | grep -i gost GOST2001-GOST89-GOST89 GOST94-GOST89-GOST89 # cat /usr/local/ssl/openssl.cnf ‚Ä¶‚Ä¶‚Ä¶‚Ä¶ openssl_conf = openssl_def [openssl_def] engines = engine_section [engine_section] gost = gost_section [gost_section] engine_id = gost default_algorithms = ALL ‚Ä¶‚Ä¶‚Ä¶‚Ä¶</span></span></code> </pre> <br></div></div><br>  I think nothing complicated should be and everything has already been described hundreds of times.  And in more recent distributions, the <b>gost</b> module is out of the box. <br><br>  OpenSSL is used in two ways: stunnel is built with it, so that it works according to GOST;  and the <code>openssl</code> utility is called from the python code to generate and verify signatures.  The openssl call was caused by the fact that it was not possible to set the used crypto module from the python code.  All the necessary software is on both Linux and Windows platforms, because the technique can be called multiplatform. <br><br>  For python server CentOS 6 you will need to update the lxml library, and to do this put a few additional packages: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># yum install libxml2 libxml2-devel libxslt libxslt-devel python-devel # pip install lxml --upgrade</span></span></code> </pre><br><br>  We also need the certificate and private key files in the <a href="https://ru.wikipedia.org/wiki/PKCS12" title="https://ru.wikipedia.org/wiki/PKCS12">PKCS12 (.pem)</a> format.  You can get them from eToken using tools like P12FromGostCSP or <a href="https://habrahabr.ru/post/276057/" title="https://habrahabr.ru/post/276057/">manually</a> .  If this is not done for any reason, then there is the option of working with the <a href="http://www.rutoken.ru/" title="http://www.rutoken.ru/">‚ÄúRutoken EDS‚Äù</a> key <a href="http://www.rutoken.ru/" title="http://www.rutoken.ru/">directly</a> .  The site has detailed instructions on how to teach this OpenSSL and stunnel.  Thus, the task is reduced to the previous one.  I did not have such a key at hand, so I could not verify it. <br><br><h4>  Crypto Tunnel according to GOST </h4><br>  The tunnel is raised using <a href="https://www.stunnel.org/index.html" title="https://www.stunnel.org/index.html">Stunnel</a> , which works in proxy mode.  You just need to teach him to use the gost module.  But there is a moment - in order for the module to initialize correctly, you need to slightly fix the source code.  The problem, as I understand it, is related to the order of initialization of the module and methods.  So: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># wget https://www.stunnel.org/downloads/stunnel-5.31.tar.gz # tar -xvf stunnel-5.31.tar.gz # cd stunnel-5.31</span></span></code> </pre><br>  Edit the <b>src / options.c</b> file and add a call to <b>SSL_library_init ();</b> at the end of the " <code>NOEXPORT char *engine_init(void)</code> " <b>function;</b>  . <br><div class="spoiler">  <b class="spoiler_title">It turns out something like this:</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">NOEXPORT <span class="hljs-type"><span class="hljs-type">char</span></span> *engine_init(<span class="hljs-type"><span class="hljs-type">void</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(engine_initialized) <span class="hljs-comment"><span class="hljs-comment">/* either first or already initialized */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* OK */</span></span> s_log(LOG_DEBUG, "Initializing engine #%d (%s)", current_engine+<span class="hljs-number"><span class="hljs-number">1</span></span>, ENGINE_get_id(engines[current_engine])); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!ENGINE_init(engines[current_engine])) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ERR_peek_last_error()) <span class="hljs-comment"><span class="hljs-comment">/* really an error */</span></span> sslerror("ENGINE_init"); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s_log(LOG_ERR, "Engine #%d (%s) not initialized", current_engine+<span class="hljs-number"><span class="hljs-number">1</span></span>, ENGINE_get_id(engines[current_engine])); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> "Engine initialization failed"; } #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">/* it is a bad idea to set the engine as default for all sections */</span></span> <span class="hljs-comment"><span class="hljs-comment">/* the "engine=auto" or "engineDefault" options should be used instead */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!ENGINE_set_default(engines[current_engine], ENGINE_METHOD_ALL)) { sslerror("ENGINE_set_default"); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> "Selecting default engine failed"; } #endif s_log(LOG_INFO, "Engine #%d (%s) initialized", current_engine+<span class="hljs-number"><span class="hljs-number">1</span></span>, ENGINE_get_id(engines[current_engine])); SSL_library_init(); engine_initialized=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* OK */</span></span> }</code> </pre><br></div></div><br>  The solution was <a href="http://www.nikosoft.net/nspki/howto-stunnel-gost.php" title="http://www.nikosoft.net/nspki/howto-stunnel-gost.php">found here</a> . <br>  We assemble with the connection of previously assembled OpenSSL: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ./configure --with-ssl=/usr/local/ssl --disable-libwrap # make &amp;&amp; make install</span></span></code> </pre><br><br>  Configuration file <i>/etc/stunnel.conf</i> : <br><pre> <code class="bash hljs">client=yes <span class="hljs-comment"><span class="hljs-comment">#    (). CAFile=/etc/crypto/CA-SIT.pem engine=gost sslVersion=TLSv1 engineDefault = ALL output=/var/log/stunnel.log DEBUG=4 #   eToken-. cert=/etc/crypto/public.pem key=/etc/crypto/private.key [pseudo-https] #    ,    . accept = 10.1.5.133:8080 #    ,    (). connect = 54.76.42.99:60045 ciphers = GOST2001-GOST89-GOST89</span></span></code> </pre><br>  We put the certificate files in the <i>/ etc / crypto /</i> directory.  In general, stunnel can work under any user, but let us be root. <br><div class="spoiler">  <b class="spoiler_title">The simplest init.d service control script:</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#! /bin/bash # # stunnel Start/Stop Stunnel # # chkconfig: 2345 90 60 # description: launches Stunnel # processname: stunnel # config: /etc/stunnel.conf # Source function library. . /etc/init.d/functions # See how we were called. prog="Stunnel CryptoTunnel" RNG=PROGRAM export RNG start() { echo -n $"Starting $prog: " /usr/local/bin/stunnel /etc/stunnel.conf RETVAL=$? [ $RETVAL -eq 0 ] &amp;&amp; success [ $RETVAL -ne 0 ] &amp;&amp; failure echo return $RETVAL } stop() { echo -n $"Stopping $prog: " /usr/bin/killall /usr/local/bin/stunnel &gt;/dev/null 2&gt;&amp;1 RETVAL=$? [ $RETVAL -eq 0 ] &amp;&amp; success [ $RETVAL -ne 0 ] &amp;&amp; failure echo return $RETVAL } restart() { stop start } case "$1" in start) start ;; stop) stop ;; restart) restart ;; *) echo $"Usage: $0 {start|stop|status|restart}" exit 1 esac</span></span></code> </pre><br></div></div><br>  You can run and check, for example, <br><div class="spoiler">  <b class="spoiler_title">request to server address:</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># curl http://10.1.5.133:8080/ext-bus-nsi-service/services/Nsi?wsdl &lt;?xml version='1.0' encoding='UTF-8'?&gt;&lt;wsdl:definitions xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:tns="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/nsi-service/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:nsi-common="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/nsi-common/" xmlns:nsi="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/nsi/" xmlns:ns="http://www.w3.org/2000/09/xmldsig#" xmlns:base="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/" targetNamespace="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/nsi-service/"&gt; &lt;wsdl:types&gt; &lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:tns="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/nsi-service/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:nsi-common="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/nsi-common/" xmlns:nsi="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/nsi/" xmlns:ns="http://www.w3.org/2000/09/xmldsig#" xmlns:base="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/"&gt; &lt;xs:import namespace="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/" schemaLocation="http://54.76.42.99:60046//ext-bus-nsi-service/services/Nsi?xsd=hcs-basetypes-8.7.0.7.xsd"/&gt; &lt;xs:import namespace="http://dom.gosuslugi.ru/schema/integration/8.7.0.7/nsi/" schemaLocation="http://54.76.42.99:60046//ext-bus-nsi-service/services/Nsi?xsd=hcs-nsi-types-8.7.0.7.xsd"/&gt; &lt;/xs:schema&gt; ‚Ä¶‚Ä¶‚Ä¶</span></span></code> </pre><br></div></div><br>  If the output is completely different, then carefully look into the log file <i>/var/log/stunnel.log</i> . <br><br><h4>  XMLDSig generation </h4><br>  When the tunnel to the GIS utilities server is up and running, you can send any requests there and receive the necessary answers.  The request is sent in the form of XMLDSig, which contains the request itself, the hash of the request, the certificate hash, the certificate itself, the signature of the request hash with the certificate hash and a bunch of fields describing it all.  The most difficult thing was to unwind the whole chain and get XML, which is successfully tested by the GIS utilities.  All signed blocks are taken in the canonical form, and the resulting signatures and hash sums are encoded in BASE64. <br><br>  The XMLDSig generation algorithm can be implemented using any convenient programming language.  We used python 2.7.11, the demo code is attached.  As an example, I will also give the console analog. <br><br>  0. From the certificate, the serial number and data about the released person are obtained, the necessary id are generated and the current time is remembered. <br>  1. With the help of any soap client (for example, suds in Python) a SOAP request is made to the GIS utilities server. <br><div class="spoiler">  <b class="spoiler_title">Example of a SOAP request:</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOAP-ENV:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:ns0</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://dom.gosuslugi.ru/schema/integration/8.7.0.3/nsi/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:ns1</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.xmlsoap.org/soap/envelope/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:SOAP-ENV</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.xmlsoap.org/soap/envelope/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOAP-ENV:Header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RequestHeader</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://dom.gosuslugi.ru/schema/integration/8.7.0.4/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Date</span></span></span><span class="hljs-tag">&gt;</span></span>2016-04-11T14:28:28<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Date</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MessageGUID</span></span></span><span class="hljs-tag">&gt;</span></span>29f93de1-25b6-21e5-24ae-2c6f65dfe2b2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MessageGUID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SenderID</span></span></span><span class="hljs-tag">&gt;</span></span>4eb0a7d6-6317-45cf-8974-10e75cbb0cbc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SenderID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RequestHeader</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOAP-ENV:Header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ns1:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ns0:exportDataProviderNsiItemRequest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"signed-element"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ns0:RegistryNumber</span></span></span><span class="hljs-tag">&gt;</span></span>51<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ns0:RegistryNumber</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ns0:exportDataProviderNsiItemRequest</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ns1:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOAP-ENV:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Where <code>SenderID</code> is the identifier of the management company on whose behalf the request is being made.  <code>MessageGUID</code> is a unique ID generated as desired.  The body <code>&lt;ns1:Body&gt;</code> is the request itself with additional fields.  <code>Id="signed-element"</code> - ID of the request, which we indicate, how we want and which we are oriented to, signing the request. <br></div></div><br><br>  2. Take the contents of the <b><code>&lt;ns1:Body&gt;</code></b> (more precisely, the part with Id and without the first and last newline character), is canonized by the C14N algorithm (exclusive = True), the hash sum is calculated from it according to GOST and output as BASE64.  We <b><code>digest1</code></b> .  Console analog: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># cat in.xml ; echo &lt;ns0:exportDataProviderNsiItemRequest Id="signed-element"&gt; &lt;ns0:RegistryNumber&gt;51&lt;/ns0:RegistryNumber&gt;&lt;/ns0:exportDataProviderNsiItemRequest&gt; # cat in.xml | openssl dgst -engine gost -md_gost94 -binary | base64</span></span></code> </pre><br>  * openssl with GOST support.  The engine is explicitly specified, but by setting up openssl.cnf, you can not do this. <br><br>  3. The certificate is taken in x509, decoded from BASE64, the hash sum is considered from it, and the output is encoded in BASE64.  We <b><code>digest2</code></b> . <br><br>  4. Using the data obtained, the content of the <b><code>&lt;xades:SignedProperties&gt;</code></b> (see the Template) is formed, canonized by the C14N algorithm (exclusive = False) and is considered <b><code>digest3</code></b> (BASE64) from the content. <br><br>  5. The <b><code>&lt;ds:SignedInfo&gt;</code></b> block is formed, canonized by the C14N algorithm (exclusive = False), signed and encoded in BASE64.  The value of the <b><code>&lt;ds:SignatureValue&gt;</code></b> block is obtained.  Console analog: <br><pre> <code class="bash hljs">cat SignedInfo.xml | openssl dgst -sign private.key -engine gost -md_gost94 -binary | base64</code> </pre><br>  where SignedInfo.xml is an already canonized block, without the last line feed. <br><br>  6. All values ‚Äã‚Äãobtained are entered into <br><div class="spoiler">  <b class="spoiler_title">XAdES-BES XML Document Template:</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Signature</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xmldsig-{signature_id}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:ds</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2000/09/xmldsig#"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:SignedInfo</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:CanonicalizationMethod</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Algorithm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/TR/2001/REC-xml-c14n-20010315"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:SignatureMethod</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Algorithm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xmldsig-{signature_id}-ref0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">URI</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#{signed_id}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Transforms</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Algorithm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2000/09/xmldsig#enveloped-signature"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Algorithm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/10/xml-exc-c14n#"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Transforms</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:DigestMethod</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Algorithm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/04/xmldsig-more#gostr3411"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:DigestValue</span></span></span><span class="hljs-tag">&gt;</span></span>{digest1}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:DigestValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Reference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://uri.etsi.org/01903#SignedProperties"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">URI</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#xmldsig-{signature_id}-signedprops"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:DigestMethod</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Algorithm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/04/xmldsig-more#gostr3411"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:DigestValue</span></span></span><span class="hljs-tag">&gt;</span></span>{digest3}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:DigestValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Reference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:SignedInfo</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:SignatureValue</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xmldsig-{signature_id}-sigvalue"</span></span></span><span class="hljs-tag">&gt;</span></span> {signature_value} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:SignatureValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:KeyInfo</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:ds</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2000/09/xmldsig#"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:X509Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:X509Certificate</span></span></span><span class="hljs-tag">&gt;</span></span> {x590_cert} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:X509Certificate</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:X509Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:KeyInfo</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Object</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:QualifyingProperties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#xmldsig-{signature_id}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xades</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://uri.etsi.org/01903/v1.3.2#"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xades141</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://uri.etsi.org/01903/v1.4.1#"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:SignedProperties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xmldsig-{signature_id}-signedprops"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:SignedSignatureProperties</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:SigningTime</span></span></span><span class="hljs-tag">&gt;</span></span>{signing_time}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:SigningTime</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:SigningCertificate</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:Cert</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:CertDigest</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:DigestMethod</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Algorithm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/04/xmldsig-more#gostr3411"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:DigestValue</span></span></span><span class="hljs-tag">&gt;</span></span>{digest2}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:DigestValue</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:CertDigest</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:IssuerSerial</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:X509IssuerName</span></span></span><span class="hljs-tag">&gt;</span></span>{x509_issuer_name}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:X509IssuerName</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:X509SerialNumber</span></span></span><span class="hljs-tag">&gt;</span></span>{x509_sn}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:X509SerialNumber</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:IssuerSerial</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:Cert</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:SigningCertificate</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:SignedSignatureProperties</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:SignedProperties</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xades:QualifyingProperties</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Object</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ds:Signature</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  It was possible to form this template by picking and analyzing the <a href="https://github.com/Good-Samaritan/signature-demo" title="https://github.com/Good-Samaritan/signature-demo">complex</a> , which recommends the use of GIS utilities.  He himself is in the public domain, but requires a cryptographic cryptographic information system CryptoPro CSP and a cryptographic network Trusted Java 2.0 to work. <br><br>  7. In order to verify the signature thus formed, it is necessary to do all the steps in the reverse order.  Console signature verification option: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># cat SignedInfo.xml | openssl dgst -engine gost -md_gost94 -verify &lt;(openssl x509 -engine gost -in public.pem -pubkey -noout) -signature signature.sig</span></span></code> </pre><br>  where signature.sig is the signature decoded from BASE64, and the whole signed <code><b>&lt;ds:SignedInfo&gt;...&lt;/ds:SignedInfo&gt;</b></code> block of the checked block.  The values ‚Äã‚Äãof the hash sums are simply compared. <br><br>  You can take and use the python demo code (at your own risk) <a href="https://bitbucket.org/slavam/signature-demo/overview" title="https://bitbucket.org/slavam/signature-demo/overview">from here</a> .  The author of the code is Vyacheslav (@slavam, RO).  Such an algorithm can be implemented using any convenient language, without the need to purchase any additional tools and components.  The call to the OpenSSL utilities from the code looks clumsy, but it works both on Linux and on the Windows platform and makes it possible to refuse to use CryptoPro and additional components. <br>  The system of interaction with the GIS utilities is still at the stage of creation, but the resulting XMLDSig passes the necessary checks. <br>  We hope this article will make it easier for someone to implement such a bike. <br><br>  <b>UPD</b> <br>  In order to interact with the GIS utilities changes occur.  The current rules can be found <a href="https://dom.gosuslugi.ru/">on the website</a> .  Major changes: <br><ul><li>  Now to work with the system you need to register the IC. </li><li>  Before you send requests, you must perform basic-authorization. </li><li>  To work with a test stand, you also need to submit an application. </li></ul><br>  It also appeared quite decent software examples that (if you try) you can make friends with OpenSSL. <br><br>  <b>UPD2</b> <br>  To get OpenSSL under windows with GOST support you need: <br>  1. Put OpenSSL <a href="http://slproweb.com/products/Win32OpenSSL.html">from here</a> , it is already with GOST support, in the lib folder there is a corresponding library: <b><code>gost.lib</code></b> . <br><br>  2. In the configuration file, explicitly indicate its use: <br><pre> <code class="bash hljs">openssl_conf = openssl_def [openssl_def] engines = engine_section [engine_section] gost = gost_section [gost_section] engine_id = gost dynamic_path = ./gost.dll default_algorithms = ALL</code> </pre><br>  To determine exactly where OpenSSL is reading the configuration, you can set the environment variable: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> OPENSSL_CONF=C:\OpenSSL-Win32\openssl.cnf</code> </pre><br><br>  3. Check the result: <br><pre> <code class="bash hljs">C:\OpenSSL-Win32\bin&gt;openssl.exe ciphers -v | find /I <span class="hljs-string"><span class="hljs-string">"gost"</span></span> GOST2001-GOST89-GOST89 SSLv3 Kx=GOST Au=GOST01 Enc=GOST89(256) Mac=GOST89 GOST94-GOST89-GOST89 SSLv3 Kx=GOST Au=GOST94 Enc=GOST89(256) Mac=GOST89</code> </pre><br><br>  Thanks for attention. <br><br><h4>  Links </h4><br><ul><li>  <a href="http://dom.gosuslugi.ru/filestore/publicDownloadServlet%3Fcontext%3Dcontentmanagement%26uid%3Df649ed5a-4cd6-40ca-aaae-67a063f63973">Regulations and formats of information interaction of external information systems with GIS utilities (current formats v.8.7.0.7)</a> </li><li>  <a href="https://github.com/Good-Samaritan/signature-demo">Good-Samaritan / signature-demo</a> </li><li>  <a href="http://www.nikosoft.net/nspki/howto-stunnel-gost.php">HOWTO use Stunnel with GOST</a> </li><li>  <a href="https://habrahabr.ru/post/276057/">‚ÄúWhy is it possible for everyone, but I can‚Äôt?‚Äù Or reverse API and get data from eToken</a> </li><li>  <a href="http://club.directum.ru/post/XMLDSig-format-podpisi-XML.aspx">XMLDSig: XML signature format</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/300856/">https://habr.com/ru/post/300856/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../300844/index.html">Finalized the community track program of the DevCon 2016 conference</a></li>
<li><a href="../300846/index.html">String.raw: some features and limitations</a></li>
<li><a href="../300848/index.html">As behind a stone wall: the story of Qihoo 360 Total Security and opportunities in the Russian market</a></li>
<li><a href="../300850/index.html">Panamanian documents. From the world by thread</a></li>
<li><a href="../300854/index.html">Who do corporations want?</a></li>
<li><a href="../300858/index.html">E / M Commerce Day - grocery conference on electronic and mobile commerce</a></li>
<li><a href="../300860/index.html">Acceleration of automation of web-interface testing through the use of Python and Selenide</a></li>
<li><a href="../300862/index.html">Color palette from the masters of painting: Color Lisa</a></li>
<li><a href="../300864/index.html">Specialization in algorithms and data structures from Yandex, HSE, UC San Diego and CSC</a></li>
<li><a href="../300868/index.html">Apple removed System and Security Info from the App Store</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>