<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we select2 in helper wrapped</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think many are familiar with Select2 . Everything in it is wonderful: both the elements are beautiful, and the customization of the car, and c ajax ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we select2 in helper wrapped</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/4ec/9c9/875/4ec9c98757c64eb0a60102b2ddeb920c.png" align="left">  I think many are familiar with <a href="http://ivaynberg.github.io/select2/">Select2</a> .  Everything in it is wonderful: both the elements are beautiful, and the customization of the car, and c ajax works and can do much more useful things.  Only problem is one: initialization is rather cumbersome (js should be written, actions should be for <i>ajax</i> loading results, and so on).  It was not very convenient and we decided to make our <i>add2</i> for <i>Select2</i> , in which we don‚Äôt need to write js either, and we almost don‚Äôt have to go outside the view.  About how we did it and what happened read under the cut. <br><br><a name="habracut"></a><br><br><h2>  What were you aiming for? </h2><br>  Everyone knows the behavior of helpers from <i>ActionView :: Helpers :: FormTagHelper</i> .  For example <i>select_tag</i> : <br><pre><code class="ruby hljs">select_tag <span class="hljs-string"><span class="hljs-string">"people"</span></span>, options_from_collection_for_select(@people, <span class="hljs-string"><span class="hljs-string">"id"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>)</code> </pre> <br>  I want to work with <i>Select2</i> as well.  And with any variation of <i>Select2</i> : whether it is a static replacement for the usual <i>select</i> , <i>ajax</i> option or multi <i>select</i> . <br>  What happened?  It turned out about the following: <br><pre> <code class="ruby hljs">= select2_ajax_tag <span class="hljs-symbol"><span class="hljs-symbol">:my_select2_name</span></span>, {<span class="hljs-symbol"><span class="hljs-symbol">class_name:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:my_model_name</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">text_column:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:name</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">id_column:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:id</span></span>}, my_init_value_id, <span class="hljs-symbol"><span class="hljs-symbol">placeholder:</span></span> <span class="hljs-string"><span class="hljs-string">'Fill me now!'</span></span></code> </pre><br>  This is the easiest helper call.  No need for additional gestures.  As a result, we get a select with dynamic loading of variants from the <i>MyModelName</i> model. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Of course, this is the easiest way to use.  If there is a desire to make complex selections, to produce different results depending on other parameters on the page, to customize the display of options in the selection, etc., it does not matter, all this can be done, but you will have to add a little <i>Ruby</i> . <br><br><h2>  Examples in the studio! </h2><br>  For those who already want to touch with their hands, as well as those who perceive the source code better than a leisurely verbal description, I give a <a href="https://github.com/Loriowar/auto_select2_tag_example">link</a> to the RoR project with an example of use. <br><br><h2>  Alternatives </h2><br>  At one time, we did not find them, so the slow invention of this heme happened.  However, given the specificity of the resource and the power of comments, I am sure that someone will prompt an analog which we did not notice.  So I will be glad if you point out an alternative. <br><br><h2>  What is it all about? </h2><br>  These are the two heme <a href="https://github.com/Loriowar/auto_select2">AutoSelect2</a> and <a href="https://github.com/Loriowar/auto_select2_tag">AutoSelect2Tag</a> idea which proposed <a href="http://habrahabr.ru/users/tab10id/" class="user_link">Tab10id</a> .  Both <a href="https://github.com/argerim/select2-rails">gems are</a> based on <a href="https://github.com/argerim/select2-rails">select2-rails</a> and allow you to create Select2 elements without heavy thoughts about js initialization and other overhead. <br><br><h2>  How to use it? </h2><br>  Detailed <i>readme</i> has each of the gems, but they, as usual, in English.  Therefore, I will tell you in Russian about how to put the gems correctly, what they require for work and how to use their functionality as a result. <br><br><h3>  Installation </h3><br>  First of all, it‚Äôs necessary to say that if you have the asset pipeline shut down, the installation becomes rather nontrivial and is beyond the scope of this article, so we‚Äôll assume that everything‚Äôs fine with the pipeline. <br><br>  Now the points: <br><ol><li>  you need to install <a href="https://github.com/argerim/select2-rails">select2-rails</a> , set its scripts in <i>application.js</i> and styles in <i>application.css</i> (or what do you have instead of them?) </li><li>  install <a href="https://github.com/Loriowar/auto_select2">AutoSelect2</a> and set its scripts in <i>application.js</i> (or add <a href="https://github.com/Loriowar/auto_select2">helpers</a> to the necessary partials) </li><li>  check that there is no controller in the project named <i>Select2AutocompletesController</i> and <i>similar</i> routes <br><pre> <code class="ruby hljs">get <span class="hljs-string"><span class="hljs-string">'select2_autocompletes/:class_name'</span></span></code> </pre></li><li>  prepare an <i>'app / select2_search_adapter'</i> folder for your <i>SearchAdapter</i> </li><li>  install gem <a href="https://github.com/Loriowar/auto_select2_tag">autoselect2tag</a> </li></ol><br><br><h3>  Use static select2 </h3><br>  After these actions, you can use a helper for a static select: <br><pre> <code class="ruby hljs">= select2_tag <span class="hljs-symbol"><span class="hljs-symbol">:select2_name</span></span>, my_options_for_select2(my_init_value), <span class="hljs-symbol"><span class="hljs-symbol">placeholder:</span></span> <span class="hljs-string"><span class="hljs-string">'Fill me!'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">include_blank:</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">select2_options:</span></span> {<span class="hljs-symbol"><span class="hljs-symbol">width:</span></span> <span class="hljs-string"><span class="hljs-string">'auto'</span></span>}</code> </pre><br>  In essence, the method is a wrapper for the usual <a href="http://apidock.com/rails/ActionView/Helpers/FormTagHelper/select_tag">select_tag</a> .  It adds the necessary classes to initialize <i>Select2</i> and forward <a href="http://ivaynberg.github.io/select2/">the constructor parameters</a> . <br><br><h3>  Using ajax Select2 </h3><br>  The simplest helper call is available straight out of the box: <br><pre> <code class="ruby hljs">= select2_ajax_tag <span class="hljs-symbol"><span class="hljs-symbol">:my_select2_name</span></span>, {<span class="hljs-symbol"><span class="hljs-symbol">class_name:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:my_model_name</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">text_column:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:name</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">id_column:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:id</span></span>}, my_init_value_id, <span class="hljs-symbol"><span class="hljs-symbol">placeholder:</span></span> <span class="hljs-string"><span class="hljs-string">'Fill me now!'</span></span></code> </pre><br>  Here the second parameter of the helper should speak for itself. <br><br>  If you want more complex constructions in the select, you will have to write your <i>SearchAdapter</i> .  What it is?  This is the class that gives page by page hashes with options for the select and is responsible for the initialization value, if present.  This class is used in the <i>Select2AutocompletesController</i> controller, and its name is indicated in the second parameter <i>select2_ajax_tag</i> (see the example below).  Here is a set of requirements for <i>SearchAdapter</i> : <br><ul><li>  files with classes should be located in <i>'app / select2_search_adapter'</i> (by analogy with <i>inputs</i> from <a href="https://github.com/justinfrench/formtastic">formtastic</a> );  it is fair to say that they can be located in any other autoload directory, but the method described above seems to be the most optimal </li><li>  class names must end with <i>SearchAdapter</i> </li><li>  <i>SearchAdapter</i> should inherit from <i>AutoSelect2 :: Select2SearchAdapter :: Base</i> </li><li>  the class must implement the <i>search_default</i> method (see below for details) </li></ul><br>  In order not to describe the requirements for <i>search_default</i> for a <i>long time,</i> I <i>‚Äôll</i> give an example of a minimalist <i>SearchAdapter</i> : <br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SystemRoleSearchAdapter</span></span></span><span class="hljs-class"> &lt; AutoSelect2::Select2SearchAdapter::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Base</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> &lt;&lt; self </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">search_default</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">term</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">page</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">options</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">options</span></span></span><span class="hljs-class">[:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">init</span></span></span><span class="hljs-class">].</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nil?</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">roles</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">default_finder</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SystemRole</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">term</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">page</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">page</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">count</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">default_count</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SystemRole</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">term</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">items</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">roles</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">map</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> |</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">role</span></span></span><span class="hljs-class">| { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">text</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">role</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">role</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to_s</span></span></span><span class="hljs-class"> } </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#     'class_name' end, total: count } else get_init_values(SystemRole, options[:item_ids]) end end end end</span></span></span></span></code> </pre> <br>  As can be seen from the example, if the <i>options</i> : key is missing: init, then <i>search_default</i> should return a hash of the form: <br><pre> <code class="ruby hljs">{ <span class="hljs-symbol"><span class="hljs-symbol">items:</span></span> [ { <span class="hljs-symbol"><span class="hljs-symbol">text:</span></span> <span class="hljs-string"><span class="hljs-string">'first element'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">id:</span></span> <span class="hljs-string"><span class="hljs-string">'first_id'</span></span> }, { <span class="hljs-symbol"><span class="hljs-symbol">text:</span></span> <span class="hljs-string"><span class="hljs-string">'second element'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">id:</span></span> <span class="hljs-string"><span class="hljs-string">'second_id'</span></span> } ], <span class="hljs-symbol"><span class="hljs-symbol">total:</span></span> count }</code> </pre><br>  If: init is present, the function should return: <br><pre> <code class="ruby hljs">{<span class="hljs-symbol"><span class="hljs-symbol">text:</span></span> <span class="hljs-string"><span class="hljs-string">'displayed text'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">id:</span></span> <span class="hljs-string"><span class="hljs-string">'id_of_initial_element'</span></span>}</code> </pre><br>  After defining such a class, you can use ajax select2 as follows: <br><pre> <code class="ruby hljs">= select2_ajax_tag <span class="hljs-symbol"><span class="hljs-symbol">:my_select2_name</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:system_role</span></span>, init_value, additional_options</code> </pre><br>  And that's all.  The syntax is as close as possible to <i>select_tag</i> and can be used anywhere in the application. <br><br><h3>  Using multi ajax Select2 </h3><br>  Here, everything is similar to the previous item with <i>ajax select2</i> with the only difference that you need to include the <i>multi_ajax_select2_value_parser.js</i> script and add to the <i>select2_options</i> hash <i>: {multiple: true}</i> : <br><pre> <code class="ruby hljs">= select2_ajax_tag <span class="hljs-symbol"><span class="hljs-symbol">:multi_countries_select2</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:country</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">is</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">multiple</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">select2_options</span></span></span><span class="hljs-class">: {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">multiple</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">}</span></span></code> </pre><br>  Somewhere here, developers familiar with <i>Select2</i> should have a question: why the script?  I answer: the script implements the serialization of select options as an array, and not as a string with options separated by commas.  Author <i>Select2</i> promised to do the same in the next major version, but I don‚Äôt want to wait. <br><br><h2>  Additional features </h2><br>  Most of them are described in the <a href="https://github.com/Loriowar/auto_select2_tag_example">example</a> .  For those who are too lazy to launch the project, and just to complete the picture, I will make a brief overview. <br><br><h3>  Search_default extension </h3><br>  Suppose you created your <i>SearchAdapter</i> and implemented <i>search_default</i> in it.  Let this adapter be for the User model.  Everything is good, but once it was necessary to create a similar select, but in the variants there were only active users.  In order not to create a new class for the same entity, you can add the <i>search_active</i> method to the previously created <i>UserSearchAdapter</i> and specify this method when initializing <i>Select2</i> : <br><pre> <code class="ruby hljs">= select2_ajax_tag <span class="hljs-symbol"><span class="hljs-symbol">:active_user</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:user</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">search_method:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:active</span></span> <span class="hljs-comment"><span class="hljs-comment">#    search_   </span></span></code> </pre><br><h3>  Dependent samples </h3><br>  Another case: implement 2 (or more) selects, the options in which depend on each other.  For example, a cascade selection of a country and a city (an example from <a href="">auto_select2_tag_example</a> ).  If you choose a country, then you can choose a city only within this country and vice versa.  As it is inconveniently done with static and so it is clear.  And this is how it is done with <i>select2_ajax_tag</i> : first, you need to assign a class to all dependent elements, for example <i>dependent-input</i> ;  secondly, specify this class in <i>additional_ajax_data</i> : <br><pre> <code class="ruby hljs">= select2_ajax_tag <span class="hljs-symbol"><span class="hljs-symbol">:country_id</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:country</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">placeholder:</span></span> <span class="hljs-string"><span class="hljs-string">'Select country'</span></span>, <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dependent</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">input</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">select2_options</span></span></span><span class="hljs-class">: {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">additional_ajax_data</span></span></span><span class="hljs-class">: {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">selector</span></span></span><span class="hljs-class">: '.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dependent</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">input</span></span></span><span class="hljs-class">'}} = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">select2_ajax_tag</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">city_id</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">city</span></span></span><span class="hljs-class">, '', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">placeholder</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Select</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">city</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dependent</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">input</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">select2_options</span></span></span><span class="hljs-class">: {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">additional_ajax_data</span></span></span><span class="hljs-class">: {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">selector</span></span></span><span class="hljs-class">: '.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dependent</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">input</span></span></span><span class="hljs-class">'}}</span></span></code> </pre><br>  After that, when sending an ajax request for receiving options, the select will search for all elements with the <i>dependent-input</i> class, exclude itself from them, convert the remaining ones to json, where the key is the element's name-attribute and value is the value-attribute, and send the received json along with the request.  The controller, on the <i>other hand, forwards</i> all these parameters in <i>SearchAdapter</i> and in the <i>search_default</i> method (or any other <i>search_</i> ) in the <i>options</i> parameter there will be values ‚Äã‚Äãfrom the form.  Then they can be used in any convenient way and give only those options that meet the requirements. <br><br><h3>  Method to_select2 </h3><br>  You can <i>omit the text_column</i> and <i>id_column</i> options if the model has a <i>to_select2</i> method.  In this case, it will be automatically called to get options when generating <i>json</i> .  If you need to use a method other than <i>to_select2</i> , then you can pass the <i>hash_method</i> parameter: <br><pre> <code class="ruby hljs">= select2_ajax_tag <span class="hljs-symbol"><span class="hljs-symbol">:default_country_id</span></span>, {<span class="hljs-symbol"><span class="hljs-symbol">class_name:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:country</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">hash_method:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:to_select2_alternate</span></span>}, Country.first.id</code> </pre><br>  The benefit is obvious.  Without creating a <i>SearchAdapter,</i> you can transfer more complex options to a select. <br><br><h2>  A few words about initialization </h2><br>  Elements are automatically initialized after the page is loaded (that is, in <i>$ (document). Ready ()</i> ), after <i>ajax</i> requests (at the ajaxSuccess <i>event</i> ) and after the <i>cocoon: after-insert</i> event from <a href="https://github.com/nathanvda/cocoon">cocoon</a> .  There is no need to worry about re-initialization, nothing is caused twice and there are no problems.  If for some reason, manual initialization is still required, then <i>initAutoAjaxSelect2 ()</i> and / or <i>initAutoStaticSelect2 ()</i> should be called. <br><br><h2>  Future plans </h2><br>  Since gems are grown from the <i>Redmine</i> project, I want to do <i>pluging</i> for it.  Of course, here immediately raises the question of the pipeline, which in <i>Redmine</i> does not work in principle and for the launch of which you need to thoroughly <a href="https://github.com/Tab10id/redmine_plugin_asset_pipeline">try</a> .  Next, I want to make friends with <a href="https://github.com/justinfrench/formtastic">formtastic</a> . <br><br><h2>  Behind this all </h2><br>  Thank you for reading to the end.  Write about typos and inaccuracies in HP, I will be glad to fix it.  Other questions / comments / suggestions / indignations write in the comments, it will be interesting. </div><p>Source: <a href="https://habr.com/ru/post/244553/">https://habr.com/ru/post/244553/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244537/index.html">Rust: abstraction and security, completely free (video from the Saratov Open-IT session)</a></li>
<li><a href="../244539/index.html">Adaptive learning, or a few words about Knewton</a></li>
<li><a href="../244541/index.html">Angle detectors</a></li>
<li><a href="../244545/index.html">Expressive javascript: drawing on canvas</a></li>
<li><a href="../244551/index.html">The digest of interesting materials for the mobile developer # 81 (November 24-30)</a></li>
<li><a href="../244557/index.html">A tale about how tech support Veeam introduced gamification</a></li>
<li><a href="../244559/index.html">Brief history of hacking. A story from the head of information security at Yandex</a></li>
<li><a href="../244561/index.html">Do it yourself search on the site</a></li>
<li><a href="../244563/index.html">"Mathematics is one of the forms of art": post to the centenary of the birth of Martin Gardner</a></li>
<li><a href="../244565/index.html">The slowest x86 instruction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>