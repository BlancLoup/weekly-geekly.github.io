<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WPF4 and Taskbar in Windows 7: Thumbnail buttons</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Windows 7 taskbar has many ways for applications to provide unique information to make the UX even cooler. One of them is considered in this artic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WPF4 and Taskbar in Windows 7: Thumbnail buttons</h1><div class="post__text post__text-html js-mediator-article">  The Windows 7 taskbar has many ways for applications to provide unique information to make the UX even cooler.  One of them is considered in this article - buttons of the preview panel on the taskbar. <br><br>  There is a possibility that you already use several applications using this functionality.  Here is a screenshot of the Zune app with 4 preview buttons. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/564/5fd/004/5645fd0048a9f1e895a799f170e89cd8.png"></a> <br><a name="habracut"></a><br>  And this is how the application looks like with one of the buttons when you hover the mouse: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b2e/657/592/b2e6575925216eda26e1c65948f72d65.png"></a> <br><br>  Here is another example.  This time it's Fishbowl (client for Facebook) <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/5d5/d99/a21/5d5d99a216f3acf6a6d3e015d0ad528a.png"></a> <br><br>  Let's see how to implement preview buttons in our own WPF4 application. <br><br>  <strong>Project Setup</strong> <br><br>  Create a standard client WPF application.  In my example, I called it WpfTaskbarThumbnailButtons.  Once you have done this, open the XAML for the main window (this is where we will spend most of the time).  Add the resources section and the usual TaskbarItemInfo, as we did in previous posts. <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Window</font> <font color="#ff0000">x:Class</font> <font color="#0000ff">="WpfTaskbarThumbnailButtons.MainWindow"</font> <br> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</font> <br> <font color="#ff0000">xmlns:x</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml"</font> <br> <font color="#ff0000">Title</font> <font color="#0000ff">="Thumbnail Button Application"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="350"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="525"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Window.TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Window.TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Window</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The next step is to create resources for the images of our buttons. <br><br>  <strong>Button Images</strong> <br>  Once you have decided which buttons you want - it‚Äôs time to create a graphic for them.  The standard for the Windows 7 taskbar is 16x16 pixels (24x24 for high DPI), common in a black and white scheme.  If you create larger images - they will be reduced to a suitable size, so if you are lazy (especially if you have vector graphics) - you can not reduce manually. <br><br>  For this example, I'm going to create three buttons, each with a simple rounded square, in different colors. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingImage</font> <font color="#ff0000">x:Key</font> <font color="#0000ff">="Button1Image"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingImage.Drawing</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingGroup</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingGroup.Children</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">GeometryDrawing</font> <font color="#ff0000">Brush</font> <font color="#0000ff">="Red"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">GeometryDrawing.Geometry</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RectangleGeometry</font> <font color="#ff0000">Rect</font> <font color="#0000ff">="0 0 24 24"</font> <br> <font color="#ff0000">RadiusX</font> <font color="#0000ff">="4"</font> <br> <font color="#ff0000">RadiusY</font> <font color="#0000ff">="4"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">GeometryDrawing.Geometry</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">GeometryDrawing</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingGroup.Children</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingGroup</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingImage.Drawing</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingImage</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingImage</font> <font color="#ff0000">x:Key</font> <font color="#0000ff">="Button2Image"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingImage.Drawing</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingGroup</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingGroup.Children</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">GeometryDrawing</font> <font color="#ff0000">Brush</font> <font color="#0000ff">="Green"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">GeometryDrawing.Geometry</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RectangleGeometry</font> <font color="#ff0000">Rect</font> <font color="#0000ff">="0 0 24 24"</font> <br> <font color="#ff0000">RadiusX</font> <font color="#0000ff">="4"</font> <br> <font color="#ff0000">RadiusY</font> <font color="#0000ff">="4"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">GeometryDrawing.Geometry</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">GeometryDrawing</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingGroup.Children</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingGroup</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingImage.Drawing</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingImage</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingImage</font> <font color="#ff0000">x:Key</font> <font color="#0000ff">="Button3Image"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingImage.Drawing</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingGroup</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DrawingGroup.Children</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">GeometryDrawing</font> <font color="#ff0000">Brush</font> <font color="#0000ff">="Blue"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">GeometryDrawing.Geometry</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RectangleGeometry</font> <font color="#ff0000">Rect</font> <font color="#0000ff">="0 0 24 24"</font> <br> <font color="#ff0000">RadiusX</font> <font color="#0000ff">="4"</font> <br> <font color="#ff0000">RadiusY</font> <font color="#0000ff">="4"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">GeometryDrawing.Geometry</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">GeometryDrawing</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingGroup.Children</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingGroup</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingImage.Drawing</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DrawingImage</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  I used vector graphics here, but, as I mentioned in my article about the overlay icons on the taskbar (overlay icon), you can also use raster graphics. <br><br>  The next step is actually adding three buttons to the taskbar.  This is done through the ThumButtonInfos collection of TaskbarItemInfo classes. <br><br>  <strong>TaskbarItemInfo.ThumbButtonInfos</strong> <br>  Once you have decided which buttons you want on the preview pane of your application (you have space for a maximum of 7 buttons in Windows 7), and you have images for them - you can create them in code or, as I like, in XAML- e.  The buttons are instances of the TaskbarItemInfo class and are added to the ThumbButtonInfos collection. <br><br>  Here is the TaskbarItemInfo window property with our three simple buttons.  Note that all I defined for them is a picture and description (hint) <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Window.TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">TaskbarItemInfo.ThumbButtonInfos</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button1Image}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 1"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button2Image}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 2"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button3Image}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 3"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">TaskbarItemInfo.ThumbButtonInfos</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Window.TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  And here is a screenshot of the result.  Note that the order of the buttons is the same in which they are added to the collection.  From left to right - from the first to the last. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/a58/87d/b9a/a5887db9a85cbbc7c07f6010777a3c31.png"></a> <br><br>  <strong>ThumbButtonInfo Class</strong> <br><br>  The ThumbButtonInfo class describes one button in the preview window on the taskbar.  Since they must comply with the Windows 7 API, they are not the usual buttons that we are used to in WPF.  In other words, you cannot apply patterns to them as you could get used to.  However, they can assign a picture (raster or vector). <br><br>  <strong>Command, CommandParameter, CommandTarget</strong> <br>  This is support for the command infrastructure in WPF.  Nothing out of the ordinary here.  If you do not want to use commands, just hang up the handler on the Click event of the button. <br><br>  <strong>Description</strong> <br>  This is a tooltip button.  It is advisable to specify it. <br><br>  <strong>Isinteractive</strong> <br>  This property determines whether the button is a regular button or just a picture with a hint.  If True, then the button; if False, then the picture is displayed, but you cannot press it. <br><br>  <strong>IsBackgroundVisible</strong> <br>  This determines whether or not the border and background lighting around the button is visible.  In both examples below, I took a screenshot when I hover the mouse over the middle Button 2 button. <br><br>  <strong>Background Visible</strong> <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button2Image}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 2"</font> <br> <font color="#ff0000">IsBackgroundVisible</font> <font color="#0000ff">="True"</font> <font color="#0000ff">/&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/7b0/e80/9a1/7b0e809a14a5af68e7f0c07588e22c99.png"></a> <br><br>  <strong>Background Invisible</strong> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button2Image}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 2"</font> <br> <font color="#ff0000">IsBackgroundVisible</font> <font color="#0000ff">="False"</font> <font color="#0000ff">/&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/518/c3b/182/518c3b1826ef719bcda15553d45e9106.png"></a> <br><br>  <strong>DismissWhenClicked</strong> <br>  If true, click on the button to close the preview window.  False will leave the preview window open so that the user can click on other buttons or see the changes in the preview window. <br><br>  <strong>ImageSource</strong> <br>  An ImageSource is anything that is cast to the System.Windows.Media.ImageSource type, usually a DrawingImage or BitmapSource.  In our example, we used DrawingImage which contained a vector drawing. <br><br>  <strong>Visibility</strong> <br>  It works just like everywhere in WPF.  Visible buttons are displayed, Hidden occupy space but not displayed, and Collapsed neither displays nor occupy space <br><br>  <strong>Button 2 Visible</strong> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button2Image}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 2"</font> <br> <font color="#ff0000">IsBackgroundVisible</font> <font color="#0000ff">="True"</font> <br> <font color="#ff0000">Visibility</font> <font color="#0000ff">="Visible"</font> <font color="#0000ff">/&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/730/2b2/fe3/7302b2fe37d10f3ae07d5f9d9ec94da6.png"></a> <br><br>  <strong>Button 2 Hidden</strong> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button2Image}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 2"</font> <br> <font color="#ff0000">IsBackgroundVisible</font> <font color="#0000ff">="True"</font> <br> <font color="#ff0000">Visibility</font> <font color="#0000ff">="Hidden"</font> <font color="#0000ff">/&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/0d5/332/dcb/0d5332dcb9f4aec9baafb3e2eab75a72.png"></a> <br><br>  Notice that the button still takes up space. <br><br>  <strong>Button 2 Collapsed</strong> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button2Image}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 2"</font> <br> <font color="#ff0000">IsBackgroundVisible</font> <font color="#0000ff">="True"</font> <br> <font color="#ff0000">Visibility</font> <font color="#0000ff">="Collapsed"</font> <font color="#0000ff">/&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/7dd/a4e/db4/7dda4edb4f68272f376a75dc5451b9e5.png"></a> <br><br>  <strong>IsEnabled</strong> <br>  When True - the button is active and drawn in normal colors.  If False, the button is disabled and drawn in black and white colors. <br><br>  <strong>Button 2 Enabled</strong> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button2Image}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 2"</font> <br> <font color="#ff0000">IsEnabled</font> <font color="#0000ff">="True"</font> <br> <font color="#ff0000">IsBackgroundVisible</font> <font color="#0000ff">="True"</font> <br> <font color="#ff0000">Visibility</font> <font color="#0000ff">="Visible"</font> <font color="#0000ff">/&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/25d/c5a/253/25dc5a2539b4c6647b96e97e91458b49.png"></a> <br><br>  <strong>Button 2 Disabled</strong> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button2Image}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 2"</font> <br> <font color="#ff0000">IsEnabled</font> <font color="#0000ff">="False"</font> <br> <font color="#ff0000">IsBackgroundVisible</font> <font color="#0000ff">="True"</font> <br> <font color="#ff0000">Visibility</font> <font color="#0000ff">="Visible"</font> <font color="#0000ff">/&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/245/03f/ad1/24503fad15beecd4ce0c8f4c921b1c12.png"></a> <br><br>  Notice that the button turned black and white, just like the rewind buttons on the Zune screenshot at the beginning of this article. <br><br>  <strong>Customize button behavior</strong> <br>  There are several ways to customize the behavior of the buttons in the preview window.  You can use either commands or event handlers.  The method you choose depends on the architecture of your application and on your habits. <br><br>  Given that these buttons are separated from most of the user interface, commands seem to be a more natural approach. <br><br>  <strong>Event handling</strong> <br>  For demonstration purposes, we will start with event handling.  You can assign events in code or directly in XAML.  I usually do this in code, but I'll show you another way, I will allow Visual Studio 2010 to create handlers based on the XAML markup. <br><br>  Here is the corresponding XAML code: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Window.TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">TaskbarItemInfo.ThumbButtonInfos</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button1Image}"</font> <br> <font color="#ff0000">Click</font> <font color="#0000ff">="Button1_Click"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 1"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button2Image}"</font> <br> <font color="#ff0000">Click</font> <font color="#0000ff">="Button2_Click"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 2"</font> <br> <font color="#ff0000">IsEnabled</font> <font color="#0000ff">="False"</font> <br> <font color="#ff0000">IsBackgroundVisible</font> <font color="#0000ff">="True"</font> <br> <font color="#ff0000">Visibility</font> <font color="#0000ff">="Visible"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button3Image}"</font> <br> <font color="#ff0000">Click</font> <font color="#0000ff">="Button3_Click"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 3"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">TaskbarItemInfo.ThumbButtonInfos</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Window.TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  But the source code: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> MainWindow : Window <br> { <br> <font color="#0000ff">public</font> MainWindow() <br> { <br> InitializeComponent(); <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> Button1_Click( <font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e) <br> { <br> MessageBox.Show( <font color="#A31515">"Button 1"</font> ); <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> Button2_Click( <font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e) <br> { <br> MessageBox.Show( <font color="#A31515">"Button 2"</font> ); <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> Button3_Click( <font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e) <br> { <br> MessageBox.Show( <font color="#A31515">"Button 3"</font> ); <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now let's try the command approach. <br><br>  <strong>Teams</strong> <br>  This requires a bit more tweaking, but more in line with the top that the real application will do.  Often the buttons in the preview pane are just specialized copies of the buttons from your toolbar.  Using the commands allows you to specify these buttons to use the same code that you implement for the main buttons from the toolbar.  In addition to better structure and code reuse, you also receive additional bonuses, such as automatically setting the IsEnabled property. <br><br>  <strong>Creation of Teams</strong> <br>  First we will create three classes of teams in the Commands folder of our project.  Our classes will not do anything very different, but we still create three different classes.  In your own code, think over when it is better to use common commands with delegates, and when it is better to use more stable implementations of commands, such as were presented in Prism. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/63c/280/ea6/63c280ea6f3522a42b40797d848f8a53.png"></a> <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> RedCommand : ICommand <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">bool</font> CanExecute( <font color="#0000ff">object</font> parameter) <br> { <br> <font color="#008000">//        </font> <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">event</font> EventHandler CanExecuteChanged; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> Execute( <font color="#0000ff">object</font> parameter) <br> { <br> <font color="#008000">//    </font> <br> MessageBox.Show( <font color="#A31515">"Red Command."</font> ); <br> } <br> } <br> <br> <font color="#0000ff">class</font> GreenCommand : ICommand <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">bool</font> CanExecute( <font color="#0000ff">object</font> parameter) <br> { <br> <font color="#008000">//        </font> <br> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">event</font> EventHandler CanExecuteChanged; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> Execute( <font color="#0000ff">object</font> parameter) <br> { <br> <font color="#008000">//    </font> <br> MessageBox.Show( <font color="#A31515">"Green Command."</font> ); <br> } <br> } <br> <br> <font color="#0000ff">class</font> BlueCommand : ICommand <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">bool</font> CanExecute( <font color="#0000ff">object</font> parameter) <br> { <br> <font color="#008000">//        </font> <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">event</font> EventHandler CanExecuteChanged; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> Execute( <font color="#0000ff">object</font> parameter) <br> { <br> <font color="#008000">//    </font> <br> MessageBox.Show( <font color="#A31515">"Blue Command."</font> ); <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  This is not the best way to use commands.  I advise you to learn more about the teams before exploring them in your own application.  Here are two videos that can help <em>(video in English - approx. Lane.)</em> <br><br>  <a href="http://windowsclient.net/learn/video.aspx%3Fv%3D288066">‚Ä¢ How Do I: Use Command Binding in WPF</a> <br>  <a href="http://windowsclient.net/learn/video.aspx%3Fv%3D292642">‚Ä¢ How Do I: Create a Custom Command in WPF</a> <br><br>  <strong>Creating a ViewModel</strong> <br>  First we need a place where they are located.  ViewModel is the right place for these things.  Create a new class called MainViewModel (yes, this is a terrible name) and fill it with the appropriate properties with our commands. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> MainViewModel <br> { <br> <font color="#0000ff">private</font> RedCommand _redCommand = <font color="#0000ff">new</font> RedCommand(); <br> <font color="#0000ff">public</font> ICommand RedCommand <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _redCommand; } <br> } <br> <br> <font color="#0000ff">private</font> GreenCommand _greenCommand = <font color="#0000ff">new</font> GreenCommand(); <br> <font color="#0000ff">public</font> ICommand GreenCommand <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _greenCommand; } <br> } <br> <br> <font color="#0000ff">private</font> BlueCommand _blueCommand = <font color="#0000ff">new</font> BlueCommand(); <br> <font color="#0000ff">public</font> ICommand BlueCommand <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _blueCommand; } <br> } <br> <br> <font color="#008000">//   VM</font> <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Linking ViewModel and View <br>  Next we will provide an instance of ViewModel to our View.  There are lots of ways to do this, including: <br><br>  ‚Ä¢ Assigning View as a resource in a window in XAML <br>  ‚Ä¢ Instantiating ViewModel as a DataContext for a view in XAML <br>  ‚Ä¢ Assigning ViewModel to View in Code <br>  ‚Ä¢ Using dependency injection to enable viewmodel in view <br><br>  We are going to embed the ViewModel directly into our XAML code as the DataContext of our window.  Due to this, we have improved the structure of the application, but we lose in testability.  If you want to minimize connectivity, you need to use interfaces and a DI approach. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Window</font> <font color="#ff0000">x:Class</font> <font color="#0000ff">="WpfTaskbarThumbnailButtons.MainWindow"</font> <br> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</font> <br> <font color="#ff0000">xmlns:x</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml"</font> <br> <font color="#ff0000">xmlns:viewModels</font> <font color="#0000ff">="clr-namespace:WpfTaskbarThumbnailButtons"</font> <br> <font color="#ff0000">Title</font> <font color="#0000ff">="Thumbnail Button Application"</font> <br> <font color="#ff0000">Height</font> <font color="#0000ff">="350"</font> <br> <font color="#ff0000">Width</font> <font color="#0000ff">="525"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Window.DataContext</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">viewModels:MainViewModel</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Window.DataContext</font> <font color="#0000ff">&gt;</font> <br> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Notice that I also created xmlns: viewModels to indicate where I store the ViewModel.  In most applications, you will have separate ViewModel and View folders, and sometimes separate assemblies. <br><br>  There are better ways to use commands in WPF applications, especially if you follow the ViewModel template.  An example is the very beginning, and I hope that it will give you a little more than the usual code for the demonstration. <br><br>  <strong>Connecting buttons</strong> <br>  This is the easiest part.  Now that the entire infrastructure is set up, and our data context (DataContext) is configured for our ViewModel, all you need to do is use WPF binding to bind the ViewModel properties. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">TaskbarItemInfo.ThumbButtonInfos</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button1Image}"</font> <br> <font color="#ff0000">Command</font> <font color="#0000ff">="{Binding RedCommand}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 1"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button2Image}"</font> <br> <font color="#ff0000">Command</font> <font color="#0000ff">="{Binding GreenCommand}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 2"</font> <br> <font color="#ff0000">Visibility</font> <font color="#0000ff">="Visible"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ThumbButtonInfo</font> <font color="#ff0000">ImageSource</font> <font color="#0000ff">="{StaticResource Button3Image}"</font> <br> <font color="#ff0000">Command</font> <font color="#0000ff">="{Binding BlueCommand}"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="Button 3"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">TaskbarItemInfo.ThumbButtonInfos</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">TaskbarItemInfo</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  When you do this, launch the application and you will see message boxes appearing from the commands (again, this is not what the usual command will do, and not exactly what you usually do with the preview button, but this is not bad for a demonstration). <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/cfc/3b7/8d8/cfc3b78d86c2028c12794e7ae6620bb8.png"></a> <br><br>  <strong>Instructions for your own applications.</strong> <br>  As well as overlay icons (icon overlays) and showing progress on the taskbar, you need to be sensible about how to use these buttons.  They should be part of the overall design of the user interface of the application, and not something that you stuck, because you can stick it.  If your application has this feature that users need ‚Äúat the first call‚Äù, without having to view the full-size version of the application, such buttons are quite suitable for you. <br><br>  However, do not treat them as another toolbar.  Do not put there such functions that are not available anywhere else.  In addition, do not put there functions that require the application to be in focus or at least visible on the screen. <br></div><p>Source: <a href="https://habr.com/ru/post/78380/">https://habr.com/ru/post/78380/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../78374/index.html">telephone systems that I crossed with VoIP Wi-Fi cell phones. Cisco CME</a></li>
<li><a href="../78375/index.html">Television about the portal gosuslugi.ru</a></li>
<li><a href="../78376/index.html">Four mobile toys that I crossed with office VoIP / SIP telephony: nokia e51 (Symbian), HP 514 & HTC Diamond (Windows Mobile), Samsung i7500 (Android)</a></li>
<li><a href="../78377/index.html">PSGI - interface between web servers and perl web applications</a></li>
<li><a href="../78378/index.html">All in one click</a></li>
<li><a href="../78381/index.html">LCD LG LF2510 or "why do I need a DVD now?"</a></li>
<li><a href="../78385/index.html">Session Manager - we operate with tabs in Chrome</a></li>
<li><a href="../78388/index.html">China has tightened the registration of domains to individuals</a></li>
<li><a href="../78391/index.html">Quick macro on iPhone</a></li>
<li><a href="../78394/index.html">QST: QsT SQL Tools, Qt Toolkit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>