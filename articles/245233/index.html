<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Processing and processing reports in Excel in PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not rarely, when developing a project, it becomes necessary to form reporting statistics. If the project is developed in Delphi , C # or for example, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Processing and processing reports in Excel in PHP</h1><div class="post__text post__text-html js-mediator-article">  Not rarely, when developing a project, it becomes necessary to form reporting statistics.  If the project is developed in <strong>Delphi</strong> , <strong>C #</strong> or for example, in <strong>C ++</strong> and under <strong>Windows</strong> , then there are no problems.  Just need to use the <a title="Component Object Model" href="http://ru.wikipedia.org/wiki/Component_Object_Model">COM</a> object.  But things are different if you need to generate a report in excel format for <strong>PHP</strong> .  And for this creation to function on <strong>UNIX-like</strong> systems.  But, fortunately, not so bad.  And there are enough libraries for this.  I stopped my choice on <strong>PHPExcel</strong> .  I have been working with this library for a couple of years now and am satisfied.  Since it is cross-platform, there are no problems with portability. <br>  PHPExcel allows you to import and export data to excel.  Apply different styles to reports.  In general, everything is on top.  There is even the possibility of working with formulas (I have not tried it myself).  Just remember that all work (read and write) must be in the <em>utf-8</em> encoding. <br><a name="habracut"></a><br>  <strong>Library installation</strong> <br>  A version of PHP 5.2.0 or higher is required.  The following extensions are also needed: php_zip, php_xml and php_gd2.  You can download the library <a title="PHPExcel Library" href="http://phpexcel.codeplex.com/">from here</a> . <br><br>  <strong>Using the PHPExcel library, you can write data in the following formats:</strong> <br><br><ul><li>  Excel 2007; </li><li>  Excel 97 and later versions; </li><li>  PHPExcel Serialized Spreadshet; </li><li>  HTML; </li><li>  PDF; </li><li>  CSV. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Import data from PHP to Excel </h2><br>  Consider an example of the formation of the multiplication table. <br><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//      excel require_once('PHPExcel.php'); //        excel require_once('PHPExcel/Writer/Excel5.php'); //    PHPExcel $xls = new PHPExcel(); //     $xls-&gt;setActiveSheetIndex(0); //    $sheet = $xls-&gt;getActiveSheet(); //   $sheet-&gt;setTitle(' '); //     A1 $sheet-&gt;setCellValue("A1", ' '); $sheet-&gt;getStyle('A1')-&gt;getFill()-&gt;setFillType( PHPExcel_Style_Fill::FILL_SOLID); $sheet-&gt;getStyle('A1')-&gt;getFill()-&gt;getStartColor()-&gt;setRGB('EEEEEE'); //   $sheet-&gt;mergeCells('A1:H1'); //   $sheet-&gt;getStyle('A1')-&gt;getAlignment()-&gt;setHorizontal( PHPExcel_Style_Alignment::HORIZONTAL_CENTER); for ($i = 2; $i &lt; 10; $i++) { for ($j = 2; $j &lt; 10; $j++) { //    $sheet-&gt;setCellValueByColumnAndRow( $i - 2, $j, $i . "x" .$j . "=" . ($i*$j)); //   $sheet-&gt;getStyleByColumnAndRow($i - 2, $j)-&gt;getAlignment()-&gt; setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER); } }</span></span></code> </pre> <br>  Next we need to get our * .xls file.  Here you can go two ways.  If we assume you have an online store, and the customer wants to download the price list, then it would be better to resort to this conclusion: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  HTTP- header ( "Expires: Mon, 1 Apr 1974 05:00:00 GMT" ); header ( "Last-Modified: " . gmdate("D,d M YH:i:s") . " GMT" ); header ( "Cache-Control: no-cache, must-revalidate" ); header ( "Pragma: no-cache" ); header ( "Content-type: application/vnd.ms-excel" ); header ( "Content-Disposition: attachment; filename=matrix.xls" ); //    $objWriter = new PHPExcel_Writer_Excel5($xls); $objWriter-&gt;save('php://output');</span></span></code> </pre><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/041/7d0/05c/0417d005c05f45f88b4988a33cf29373.jpg"></div><br>  Here, the generated data immediately ‚Äúspit out‚Äù in the browser.  However, if you need to save the file and not ‚Äúdiscard‚Äù it immediately, then you do not need to output <strong>HTTP headers</strong> and instead of ‚Äúphp: // output‚Äù you should specify the path to your file.  Remember that the directory in which the file is supposed to be created must have write access.  This applies to UNIX-like systems. <br>  Consider another example of three useful instructions: <br><br><ul><li>  <strong>$ sheet-&gt; getColumnDimension ('A') -&gt; setWidth (40)</strong> - sets the column ‚ÄúA‚Äù 40 units wide; </li><li>  <strong>$ sheet-&gt; getColumnDimension ('B') -&gt; setAutoSize (true)</strong> - here the automatic width will be set for the column ‚ÄúB‚Äù; </li><li>  <strong>$ sheet-&gt; getRowDimension (4) -&gt; setRowHeight (20)</strong> - sets the fourth row height to 20 units. </li></ul><br><br>  Also notice these methods here: <strong>setCellValue</strong> and <strong>setCellValueByColumnAndRow</strong> . <br><br><ul><li>  <strong>setCellValue</strong> (pCoordinate, pValue, returnCell = false) takes three parameters: the cell coordinate, the data to output to the cell, and the third parameter is optional (if you set it to true, the method will return the cell object, otherwise the worksheet object); </li><li>  <strong>setCellValueByColumnAndRow</strong> (pColumn, pRow, pValue = null, returnCell = false) takes four parameters: the column number of the cell, the row number of the cell, the data to output to the cell, and the fourth parameter works similarly to the third parameter of the setCellValue method. </li></ul><br><br>  That is, you can access cells in two different ways.  Which is very convenient. <br><br><h2>  Making a report using PHP in Excel </h2><br>  It is often necessary to highlight some data in a report.  Make a font selection or apply a frame with a background fill for some cells, etc.  What allows you to concentrate on the most important information (although it may conversely distract).  For these purposes, the PHPExcel library has a whole set of styles that can be applied to cells in excel.  Of course, there is a small ‚Äúminus‚Äù in this library - it is impossible to apply the style to several cells at the same time, but only to each individually.  But this does not create discomfort when developing web applications. <br>  You can assign a style to a cell in two ways: <br><br><ul><li>  Apply the <em>applyFromArray</em> method, class <strong>PHPExcel_Style</strong> .  An array with the following parameters is passed to the <em>applyFromArray</em> method: <br><ul><li>  <strong>fill</strong> - an array with fill parameters; </li><li>  <strong>font</strong> - an array with font parameters; </li><li>  <strong>borders</strong> - an array with the parameters of the frame; </li><li>  <strong>alignment</strong> - an array with alignment parameters; </li><li>  <strong>numberformat</strong> - an array with the format parameters of the data cell; </li><li>  <strong>protection</strong> - array with cell protection parameters. </li></ul><br></li><li>  Use the class method <strong>PHPExcel_Style</strong> for each of the styles separately.  For example, you can assign a font to a cell like this: $ sheet-&gt; getStyle ('A1') -&gt; getFont () -&gt; setName ('Arial'). </li></ul><br><br><h3>  Fill </h3><br>  The value of the <strong>fill</strong> parameter is an array with the following optional parameters: <br><br><ul><li>  <strong>type</strong> - fill type; </li><li>  <strong>rotation</strong> - the angle of the gradient; </li><li>  <strong>startcolor</strong> - value in the form of an array with the initial color parameter in the RGB format; </li><li>  <strong>endcolor</strong> - value as an array with the final color parameter in ARGB format; </li><li>  <strong>color</strong> - value in the form of an array with the initial color parameter in the RGB format. </li></ul><br><br>  <strong>Fill styles</strong> <br><br><table border="1"><tbody><tr><td>  FILL_NONE </td><td>  none </td></tr><tr><td>  FILL_SOLID </td><td>  solid </td></tr><tr><td>  FILL_GRADIENT_LINEAR </td><td>  linear </td></tr><tr><td>  FILL_GRADIENT_PATH </td><td>  path </td></tr><tr><td>  FILL_PATTERN_DARKDOWN </td><td>  darkDown </td></tr><tr><td>  FILL_PATTERN_DARKGRAY </td><td>  darkGray </td></tr><tr><td>  FILL_PATTERN_DARKGRID </td><td>  darkGrid </td></tr><tr><td>  FILL_PATTERN_DARKHORIZONTAL </td><td>  darkHorizontal </td></tr><tr><td>  FILL_PATTERN_DARKTRELLIS </td><td>  darkTrellis </td></tr><tr><td>  FILL_PATTERN_DARKUP </td><td>  darkUp </td></tr><tr><td>  FILL_PATTERN_DARKVERTICAL </td><td>  darkVertical </td></tr><tr><td>  FILL_PATTERN_GRAY0625 </td><td>  gray0625 </td></tr><tr><td>  FILL_PATTERN_GRAY125 </td><td>  gray125 </td></tr><tr><td>  FILL_PATTERN_LIGHTDOWN </td><td>  lightDown </td></tr><tr><td>  FILL_PATTERN_LIGHTGRAY </td><td>  lightGray </td></tr><tr><td>  FILL_PATTERN_LIGHTGRID </td><td>  lightGrid </td></tr><tr><td>  FILL_PATTERN_LIGHTHORIZONTAL </td><td>  lightHorizontal </td></tr><tr><td>  FILL_PATTERN_LIGHTTRELLIS </td><td>  lightTrellis </td></tr><tr><td>  FILL_PATTERN_LIGHTUP </td><td>  lightUp </td></tr><tr><td>  FILL_PATTERN_LIGHTVERTICAL </td><td>  lightVertical </td></tr><tr><td>  FILL_PATTERN_MEDIUMGRAY </td><td>  mediumGray </td></tr></tbody></table><br>  <strong>An example of specifying settings for the fill:</strong> <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'type'</span></span> =&gt; PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR, <span class="hljs-string"><span class="hljs-string">'rotation'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'startcolor'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'rgb'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'000000'</span></span> ), <span class="hljs-string"><span class="hljs-string">'endcolor'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'argb'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'FFFFFFFF'</span></span> ), <span class="hljs-string"><span class="hljs-string">'color'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'rgb'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'000000'</span></span> ) );</code> </pre> <br>  Or you can use the following methods: <br>  $ PHPExcel_Style-&gt; getFill () -&gt; setFillType (PHPExcel_Style_Fill :: FILL_GRADIENT_LINEAR); <br>  $ PHPExcel_Style-&gt; getFill () -&gt; setRotation (0); <br>  $ PHPExcel_Style-&gt; getFill () -&gt; getStartColor () -&gt; applyFromArray (array ('rgb' =&gt; 'C2FABD')); <br>  $ PHPExcel_Style-&gt; getFill () -&gt; getEndColor () -&gt; applyFromArray (array ('argb' =&gt; 'FFFFFFFF')). <br><br><h3>  Insert images </h3><br>  Quite rarely, but it is useful to insert an image into a report.  This could be a logo, a scheme, etc.  To work we need the following methods: <br><ul><li>  <strong>setPath</strong> ($ pValue = '', $ pVerifyFile = true) takes one required and the second optional parameters: the first parameter is the path to the image file.  The second parameter makes sense to specify if it is necessary to check for the existence of a file (it can be one of true or false values). </li><li>  <strong>setCoordinates</strong> ($ pValue = 'A1') takes one parameter as a string with the cell coordinate as input. </li><li>  <strong>setOffsetX</strong> ($ pValue = 0) takes one parameter with an X offset value from the left edge of the cell. </li><li>  <strong>setOffsetY</strong> () takes one parameter with an Y offset value from the top edge of the cell. </li><li>  <strong>setWorksheet</strong> (PHPExcel_Worksheet $ pValue = null, $ pOverrideOld = false) This method takes two parameters as input.  The first is mandatory, and the second is not.  The first parameter is an instance of the active sheet object.  If the value of the second parameter is true, then if the sheet has already been assigned before, it will be overwritten and, accordingly, the image will be deleted. </li></ul><br><br>  Code showing the image insertion algorithm is shown below: <br><pre> <code class="php hljs">... $sheet-&gt;getColumnDimension(<span class="hljs-string"><span class="hljs-string">'B'</span></span>)-&gt;setWidth(<span class="hljs-number"><span class="hljs-number">40</span></span>); $imagePath = dirname ( <span class="hljs-keyword"><span class="hljs-keyword">__FILE__</span></span> ) . <span class="hljs-string"><span class="hljs-string">'/excel.png'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file_exists($imagePath)) { $logo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PHPExcel_Worksheet_Drawing(); $logo-&gt;setPath($imagePath); $logo-&gt;setCoordinates(<span class="hljs-string"><span class="hljs-string">"B2"</span></span>); $logo-&gt;setOffsetX(<span class="hljs-number"><span class="hljs-number">0</span></span>); $logo-&gt;setOffsetY(<span class="hljs-number"><span class="hljs-number">0</span></span>); $sheet-&gt;getRowDimension(<span class="hljs-number"><span class="hljs-number">2</span></span>)-&gt;setRowHeight(<span class="hljs-number"><span class="hljs-number">190</span></span>); $logo-&gt;setWorksheet($sheet); } ...</code> </pre><br><br>  Here is the report with the image inserted: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/02f/35c/6a8/02f35c6a85f04dd2b93de5972f2aceb8.jpg"></div><br><br><h3>  Font </h3><br>  The value of the <strong>font</strong> parameter is an array that contains the following optional parameters: <br><br><ul><li>  <strong>name</strong> - the name of the font; </li><li>  <strong>size</strong> - font size; </li><li>  <strong>bold</strong> - bold; </li><li>  <strong>italic</strong> - italicize; </li><li>  <strong>underline</strong> - <strong>underline</strong> style; </li><li>  <strong>strike</strong> - cross out; </li><li>  <strong>superScript</strong> - superscript; </li><li>  <strong>subScript</strong> - subscript; </li><li>  <strong>color</strong> - value in the form of an array with a color parameter in the RGB format. </li></ul><br>  <strong>Underline styles</strong> <br><br><table border="1"><tbody><tr><td>  UNDERLINE_NONE </td><td>  not </td></tr><tr><td>  UNDERLINE_DOUBLE </td><td>  double underscore </td></tr><tr><td>  UNDERLINE_SINGLE </td><td>  single underscore </td></tr></tbody></table><br>  <strong>Example of specifying settings for the font:</strong> <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Arial'</span></span>, <span class="hljs-string"><span class="hljs-string">'size'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">'underline'</span></span> =&gt; PHPExcel_Style_Font::UNDERLINE_DOUBLE, <span class="hljs-string"><span class="hljs-string">'strike'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">'superScript'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">'subScript'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">'color'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'rgb'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'808080'</span></span> ) );</code> </pre> <br>  Or use the following methods: <br>  $ PHPExcel_Style-&gt; getFont () -&gt; setName ('Arial'); <br>  $ PHPExcel_Style-&gt; getFont () -&gt; setBold (true); <br>  $ PHPExcel_Style-&gt; getFont () -&gt; setItalic (false); <br>  $ PHPExcel_Style-&gt; getFont () -&gt; setSuperScript (false); <br>  $ PHPExcel_Style-&gt; getFont () -&gt; setSubScript (false); <br>  $ PHPExcel_Style-&gt; getFont () -&gt; setUnderline (PHPExcel_Style_Font :: UNDERLINE_DOUBLE); <br>  $ PHPExcel_Style-&gt; getFont () -&gt; setStrikethrough (false); <br>  $ PHPExcel_Style-&gt; getFont () -&gt; getColor () -&gt; applyFromArray (array ('rgb' =&gt; '808080')); <br>  $ PHPExcel_Style-&gt; getFont () -&gt; setSize (12). <br><br><h3>  Frame </h3><br>  The value of the <strong>borders</strong> parameter is an array that contains the following optional parameters: <br><br><ul><li>  <strong>frame view (top | bootom | left | right | diagonal | diagonaldirection)</strong> - an array of parameters: <br><ul><li>  <strong>style</strong> - frame style; </li><li>  <strong>color</strong> - value in the form of an array with a color parameter in the RGB format. </li></ul><br></li></ul><br>  <strong>Line styles</strong> <br><br><table border="1"><tbody><tr><td>  BORDER_NONE </td><td>  not </td></tr><tr><td>  BORDER_DASHDOT </td><td>  dotted with dot </td></tr><tr><td>  BORDER_DASHDOTDOT </td><td>  dotted with two dots </td></tr><tr><td>  BORDER_DASHED </td><td>  dotted </td></tr><tr><td>  BORDER_DOTTED </td><td>  point </td></tr><tr><td>  BORDER_DOUBLE </td><td>  double </td></tr><tr><td>  BORDER_HAIR </td><td>  hairline </td></tr><tr><td>  BORDER_MEDIUM </td><td>  average </td></tr><tr><td>  BORDER_MEDIUMDASHDOT </td><td>  dotted with dot </td></tr><tr><td>  BORDER_MEDIUMDASHDOTDOT </td><td>  thick dotted line with two points </td></tr><tr><td>  BORDER_MEDIUMDASHED </td><td>  thick dotted </td></tr><tr><td>  BORDER_SLANTDASHDOT </td><td>  slant dotted with dot </td></tr><tr><td>  BORDER_THICK </td><td>  thickened </td></tr><tr><td>  BORDER_THIN </td><td>  thin </td></tr></tbody></table><br>  <strong>Example of specifying settings for the frame:</strong> <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'bottom'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'style'</span></span> =&gt; PHPExcel_Style_Border::BORDER_DASHDOT, <span class="hljs-string"><span class="hljs-string">'color'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">' rgb'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'808080'</span></span> ) ), <span class="hljs-string"><span class="hljs-string">'top'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'style'</span></span> =&gt; PHPExcel_Style_Border::BORDER_DASHDOT, <span class="hljs-string"><span class="hljs-string">'color'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'rgb'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'808080'</span></span> ) ) );</code> </pre> <br>  You can also resort to using the following methods: <br>  $ PHPExcel_Style-&gt; getBorders () -&gt; getLeft () -&gt; applyFromArray (array ('style' =&gt; PHPExcel_Style_Border :: BORDER_DASHDOT, 'color' =&gt; array ('rgb' =&gt; '808080')))); <br>  $ PHPExcel_Style-&gt; getBorders () -&gt; getRight () -&gt; applyFromArray (array ('style' =&gt; PHPExcel_Style_Border :: BORDER_DASHDOT, 'color' =&gt; array ('rgb' =&gt; '808080')))); <br>  $ PHPExcel_Style-&gt; getBorders () -&gt; getTop () -&gt; applyFromArray (array ('style' =&gt; PHPExcel_Style_Border :: BORDER_DASHDOT, 'color' =&gt; array ('rgb' =&gt; '808080')))); <br>  $ PHPExcel_Style-&gt; getBorders () -&gt; getBottom () -&gt; applyFromArray (array ('style' =&gt; PHPExcel_Style_Border :: BORDER_DASHDOT, 'color' =&gt; array ('rgb' =&gt; '808080')))); <br>  $ PHPExcel_Style-&gt; getBorders () -&gt; getDiagonal () -&gt; applyFromArray (array ('style' =&gt; PHPExcel_Style_Border :: BORDER_DASHDOT, 'color' =&gt; array ('rgb' =&gt; '808080')))); <br>  $ PHPExcel_Style-&gt; getBorders () -&gt; setDiagonalDirection (array ('style' =&gt; PHPExcel_Style_Border :: BORDER_DASHDOT, 'color' =&gt; array ('rgb' =&gt; '808080'))). <br><br><h3>  Alignment </h3><br>  The value of the <strong>alignment</strong> parameter is an array that accepts four optional parameters as input: <br><br><ul><li>  <strong>horizontal</strong> - horizontal alignment constant; </li><li>  <strong>vertical</strong> - vertical alignment constant; </li><li>  <strong>rotation</strong> - the angle of rotation of the text; </li><li>  <strong>wrap</strong> - allow text wrapping; </li><li>  <strong>shrinkToFit</strong> - whether to change the font size when the text leaves the cell area; </li><li>  <strong>indent</strong> - indent from the left edge. </li></ul><br>  <strong>Horizontal alignment</strong> <br><br><table border="1"><tbody><tr><td>  HORIZONTAL_GENERAL </td><td>  the main </td></tr><tr><td>  HORIZONTAL_LEFT </td><td>  on the left </td></tr><tr><td>  HORIZONTAL_RIGHT </td><td>  right hand </td></tr><tr><td>  HORIZONTAL_CENTER </td><td>  centered </td></tr><tr><td>  HORIZONTAL_CENTER_CONTINUOUS </td><td>  centered selection </td></tr><tr><td>  HORIZONTAL_JUSTIFY </td><td>  across the width </td></tr></tbody></table><br>  <strong>Vertical Alignment</strong> <br><br><table border="1"><tbody><tr><td width="300">  VERTICAL_BOTTOM </td><td width="161">  bottom edge </td></tr><tr><td width="300">  VERTICAL_TOP </td><td width="161">  along the top edge </td></tr><tr><td width="300">  VERTICAL_CENTER </td><td width="161">  centered </td></tr><tr><td width="300">  VERTICAL_JUSTIFY </td><td width="161">  by height </td></tr></tbody></table><br>  <strong>An example of alignment style settings:</strong> <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'horizontal'</span></span> =&gt; PHPExcel_Style_Alignment::HORIZONTAL_CENTER, <span class="hljs-string"><span class="hljs-string">'vertical'</span></span> =&gt; PHPExcel_Style_Alignment::VERTICAL_CENTER, <span class="hljs-string"><span class="hljs-string">'rotation'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'wrap'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'shrinkToFit'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">'indent'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">5</span></span> )</code> </pre> <br>  And you can use the following methods: <br>  $ PHPExcel_Style-&gt; getAlignment () -&gt; setHorizontal (PHPExcel_Style_Alignment :: HORIZONTAL_CENTER); <br>  $ PHPExcel_Style-&gt; getAlignment () -&gt; setVertical (PHPExcel_Style_Alignment :: VERTICAL_JUSTIFY); <br>  $ PHPExcel_Style-&gt; getAlignment () -&gt; setTextRotation (10); <br>  $ PHPExcel_Style-&gt; getAlignment () -&gt; setWrapText (true); <br>  $ PHPExcel_Style-&gt; getAlignment () -&gt; setShrinkToFit (false); <br>  $ PHPExcel_Style-&gt; getAlignment () -&gt; setIndent (5). <br><br><h3>  Data presentation format </h3><br>  The <strong>numberformat</strong> parameter is an array that includes only one parameter: <strong>code</strong> is the data format of the cell. <br>  <strong>List of possible formats</strong> <br><br><table border="1"><tbody><tr><td>  FORMAT_GENERAL </td><td>  General </td></tr><tr><td>  FORMAT_TEXT </td><td>  @ </td></tr><tr><td>  FORMAT_NUMBER </td><td>  0 </td></tr><tr><td>  FORMAT_NUMBER_00 </td><td>  0.00 </td></tr><tr><td>  FORMAT_NUMBER_COMMA_SEPARATED1 </td><td>  #, ## 0.00 </td></tr><tr><td>  FORMAT_NUMBER_COMMA_SEPARATED2 </td><td>  #, ## 0.00_- </td></tr><tr><td>  FORMAT_PERCENTAGE </td><td>  0% </td></tr><tr><td>  FORMAT_PERCENTAGE_00 </td><td>  0.00% </td></tr><tr><td>  FORMAT_DATE_YYYYMMDD2 </td><td>  yyyy-mm-dd </td></tr><tr><td>  FORMAT_DATE_YYYYMMDD </td><td>  yy-mm-dd </td></tr><tr><td>  FORMAT_DATE_DDMMYYYY </td><td>  dd / mm / yy </td></tr><tr><td>  FORMAT_DATE_DMYSLASH </td><td>  d / m / y </td></tr><tr><td>  FORMAT_DATE_DMYMINUS </td><td>  dmy </td></tr><tr><td>  FORMAT_DATE_DMMINUS </td><td>  dm </td></tr><tr><td>  FORMAT_DATE_MYMINUS </td><td>  my </td></tr><tr><td>  FORMAT_DATE_XLSX14 </td><td>  mm-dd-yy </td></tr><tr><td>  FORMAT_DATE_XLSX15 </td><td>  d-mmm-yy </td></tr><tr><td>  FORMAT_DATE_XLSX16 </td><td>  d-mmm </td></tr><tr><td>  FORMAT_DATE_XLSX17 </td><td>  mmm-yy </td></tr><tr><td>  FORMAT_DATE_XLSX22 </td><td>  m / d / yy h: mm </td></tr><tr><td>  FORMAT_DATE_DATETIME </td><td>  d / m / yh: mm </td></tr><tr><td>  FORMAT_DATE_TIME1 </td><td>  h: mm AM / PM </td></tr><tr><td>  FORMAT_DATE_TIME2 </td><td>  h: mm: ss AM / PM </td></tr><tr><td>  FORMAT_DATE_TIME3 </td><td>  h: mm </td></tr><tr><td>  FORMAT_DATE_TIME4 </td><td>  h: mm: ss </td></tr><tr><td>  FORMAT_DATE_TIME5 </td><td>  mm: ss </td></tr><tr><td>  FORMAT_DATE_TIME6 </td><td>  h: mm: ss </td></tr><tr><td>  FORMAT_DATE_TIME7 </td><td>  i: sS </td></tr><tr><td>  FORMAT_DATE_TIME8 </td><td>  h: mm: ss </td></tr><tr><td>  FORMAT_DATE_YYYYMMDDSLASH </td><td>  yy / mm / dd;  @ </td></tr><tr><td>  FORMAT_CURRENCY_USD_SIMPLE </td><td>  "$" #, ## 0.00 _-; @ </td></tr><tr><td>  FORMAT_CURRENCY_USD </td><td>  $ #, ## 0_- </td></tr><tr><td>  FORMAT_CURRENCY_EUR_SIMPLE </td><td>  [$ EUR] #, ## 0.00_- </td></tr></tbody></table><br>  <strong>Example setup for cell data format:</strong> <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'code'</span></span> =&gt; PHPExcel_Style_NumberFormat::FORMAT_CURRENCY_EUR_SIMPLE );</code> </pre> <br>  And you can use the method: <br>  $ PHPExcel_Style-&gt; getNumberFormat () -&gt; setFormatCode (PHPExcel_Style_NumberFormat :: FORMAT_CURRENCY_EUR_SIMPLE); <br><br><h3>  Cell protection </h3><br>  The value of the <strong>protection</strong> parameter is an array, which contains two optional parameters: <br><br><ul><li>  <strong>locked</strong> - protect the cell; </li><li>  <strong>hidden</strong> - hide formulas. </li></ul><br>  <strong>Parameter setting example for cell protection:</strong> <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'locked'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'hidden'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> );</code> </pre> <br>  Or use the following methods: <br>  $ PHPExcel_Style-&gt; getProtection () -&gt; setLocked (true); <br>  $ PHPExcel_Style-&gt; getProtection () -&gt; setHidden (false); <br>  Now we know what style settings there are and what parameters each style has.  Now we apply a layout style to the cells of the table, but we will do this using two methods.  The first method is to create an array of settings, which we pass as the parameter to the <em>applyFromArray</em> method, <em>PHPExcel_Style</em> class. <br><br><pre> <code class="php hljs">$style = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'font'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Arial'</span></span>, ), <span class="hljs-string"><span class="hljs-string">'fill'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'type'</span></span> =&gt; PHPExcel_Style_Fill::FILL_SOLID, <span class="hljs-string"><span class="hljs-string">'color'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> ( <span class="hljs-string"><span class="hljs-string">'rgb'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'C2FABD'</span></span> ) ), <span class="hljs-string"><span class="hljs-string">'alignment'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> ( <span class="hljs-string"><span class="hljs-string">'horizontal'</span></span> =&gt; PHPExcel_Style_Alignment::HORIZONTAL_CENTER ) );</code> </pre><br><br>  Next we apply the style we created to the excel cells. <br><br><pre> <code class="php hljs">$sheet-&gt;getStyleByColumnAndRow($i - <span class="hljs-number"><span class="hljs-number">2</span></span>, $j)-&gt;applyFromArray($style);</code> </pre> <br>  Now apply the same style, but using a different technique. <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  $sheet-&gt;getStyleByColumnAndRow($i - 2, $j)-&gt;getAlignment()-&gt;setHorizontal( PHPExcel_Style_Alignment::HORIZONTAL_CENTER); //   $sheet-&gt;getStyleByColumnAndRow($i - 2, $j)-&gt;getFont()-&gt;setName('Arial'); //   $sheet-&gt;getStyleByColumnAndRow($i - 2, $j)-&gt;getFill()-&gt; setFillType(PHPExcel_Style_Fill::FILL_SOLID); $sheet-&gt;getStyleByColumnAndRow($i - 2, $j)-&gt;getFill()-&gt; getStartColor()-&gt;applyFromArray(array('rgb' =&gt; 'C2FABD'));</span></span></code> </pre><br>  Here's what we got: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/ad7/fb5/44b/ad7fb544bbb34b0ab8c311832267b57a.jpg"></div><br>  If you want to apply the style many times, then the first method is better, in the other case, it is better to stay on the second.  To obtain an object (an instance of the class <strong>PHPExcel_Style</strong> ) of the cell responsible for the style, you must use one of the following methods: <br><br><ul><li>  getStyleByColumnAndRow (pColumn, pRow) - to access a cell by index; </li><li>  getStyle (pCellCoordinate) - to refer to the coordinate of the cell. </li></ul><br><h2>  Reading data from Excel </h2><br>  Generating reports and applying styles to them is of course excellent.  But the possibilities of the PHP Excel library do not end there.  Well, let's look at what she is still capable of.  And it is also capable of reading data from * .xls / * .xlsx files. <br>  <strong>Using the PHPExcel library, you can read the following formats:</strong> <br><br><ul><li>  Excel 2007; </li><li>  Excel 5.0 / Excel 95; </li><li>  Excel 97 and later versions; </li><li>  PHPExcel Serialized Spreadshet; </li><li>  Symbolic Link; </li><li>  CSV. </li></ul><br>  To work we need objects of two classes: <br><br><ul><li>  <strong>PHPExcel_Worksheet_RowIterator</strong> - used for sorting rows; </li><li>  <strong>PHPExcel_Worksheet_CellIterator</strong> - used to iterate over cells. </li></ul><br>  For demonstration we will display data from the table with information about cars. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/23c/50a/ca3/23c50aca383444da87233c293abc080b.jpg"></div><br>  An example of reading the file is presented below: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span> (<span class="hljs-string"><span class="hljs-string">'PHPExcel/IOFactory.php'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   $xls = PHPExcel_IOFactory::load('xls.xls'); //     $xls-&gt;setActiveSheetIndex(0); //    $sheet = $xls-&gt;getActiveSheet();</span></span></code> </pre><br><br>  <strong>First option</strong> <br><pre> <code class="php hljs">... <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;table&gt;"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//        $rowIterator = $sheet-&gt;getRowIterator(); foreach ($rowIterator as $row) { //          $cellIterator = $row-&gt;getCellIterator(); echo "&lt;tr&gt;"; foreach ($cellIterator as $cell) { echo "&lt;td&gt;" . $cell-&gt;getCalculatedValue() . "&lt;/td&gt;"; } echo "&lt;/tr&gt;"; } echo "&lt;/table&gt;";</span></span></code> </pre><br><br>  <strong>Second option</strong> <br><br><pre> <code class="php hljs">... <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;table&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">1</span></span>; $i &lt;= $sheet-&gt;getHighestRow(); $i++) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;tr&gt;"</span></span>; $nColumn = PHPExcel_Cell::columnIndexFromString( $sheet-&gt;getHighestColumn()); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($j = <span class="hljs-number"><span class="hljs-number">0</span></span>; $j &lt; $nColumn; $j++) { $value = $sheet-&gt;getCellByColumnAndRow($j, $i)-&gt;getValue(); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;td&gt;$value&lt;/td&gt;"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;/tr&gt;"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;/table&gt;"</span></span>;</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b7c/2ef/763/b7c2ef763328407da002d5854a6329fc.jpg"></div><br>  In the first variant, we read data from cells using iterators.  And in the second, we use index addressing to access and retrieve data from the cells of the paper.  You can get data on the number of rows and columns using the following methods of the <strong>PHPExcel_Worksheet</strong> class: <br><br><ul><li>  <strong>getHighestColumn ()</strong> - returns the character representation of the last occupied column in the active sheet.  Note: not the column index, but its symbolic representation (A, F, etc.); </li><li>  <strong>getHighestRow ()</strong> - returns the number of rows occupied in the active sheet. </li></ul><br>  And also, we cannot do without the help of the <em>columnIndexFromString</em> method, which is part of the <strong>PHPExcel_Cell</strong> class.  This method allows you to determine the column index by its symbolic representation. <br>  With the help of the demonstrated capabilities, you can generate and read any reports in the form of files, excel format.  And also almost all possible methods for working with styles were demonstrated. </div><p>Source: <a href="https://habr.com/ru/post/245233/">https://habr.com/ru/post/245233/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245223/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ137 (December 1 - 7, 2014)</a></li>
<li><a href="../245225/index.html">Blender Development Plans</a></li>
<li><a href="../245227/index.html">Yii 2.0.1</a></li>
<li><a href="../245229/index.html">Strange behavior of Google Search results for Highscreen in Google Chrome browser</a></li>
<li><a href="../245231/index.html">Budget hakaton. HackDay Experience</a></li>
<li><a href="../245237/index.html">Sergey Chernyshev: ‚ÄúEvery year the Web only gets slower‚Äù</a></li>
<li><a href="../245239/index.html">Functional CoffeeScript programming with the f_context library</a></li>
<li><a href="../245241/index.html">In search of the Holy Grail of business analysis</a></li>
<li><a href="../245243/index.html">Component Dropbox source for MODX Revolution</a></li>
<li><a href="../245247/index.html">Pebble: add configuration and save options to your application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>