<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A few tips on working with VBA in Excel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! 

 Some time ago I was asked to ‚Äúhelp with Excel‚Äù, and then the work turned up like this, so over the past couple of months I have learned a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A few tips on working with VBA in Excel</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/0371e214/cbb6b54a/d4b1d60f/f9746189.gif" align="left"><br>  Good day! <br><br>  Some time ago I was asked to ‚Äúhelp with Excel‚Äù, and then the work turned up like this, so over the past couple of months I have learned a lot of useful things, and I want to share with you in a recent article. <br><br>  It is assumed that you know the basics of Visual Basic.  I will not tell you how to create forms or modules, here are just code examples. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><h4>  Visual basic </h4><br><h5>  Options </h5><br>  Firstly, in VB arrays can begin with index 1, which is strange for many, therefore you can write in the beginning of modules: <br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">OPTION</span></span> BASE <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  It is also recommended to register: <br><pre> <code class="hljs vbscript"><span class="hljs-keyword"><span class="hljs-keyword">OPTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXPLICIT</span></span></code> </pre> <br>  In this case, the interpreter will require all variables to be declared in advance.  Variables must be declared because: <br>  - VB will remember their message and will not correct the entire code for the last entered variant; <br>  - sometimes errors occur with the transfer of variables byRef, if they are not declared (that is, you must either declare a variable, or assign byVal in a function / procedure before it). <br><br>  Another important operator is ON ERROR.  Here are the options: <br><pre> <code class="hljs vhdl"><span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-literal"><span class="hljs-literal">ERROR</span></span> RESUME <span class="hljs-keyword"><span class="hljs-keyword">NEXT</span></span> '     <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-literal"><span class="hljs-literal">ERROR</span></span> GOTO <span class="hljs-keyword"><span class="hljs-keyword">label</span></span>: ' ,   ,   <span class="hljs-keyword"><span class="hljs-keyword">label</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> EROR GOTO <span class="hljs-number"><span class="hljs-number">0</span></span> '   .</code> </pre> <br><h5>  Language features </h5><br>  Although VB is quite simple, it is helpful to read the documentation for its syntax.  For example, I was surprised to find out that you can prescribe complex usolviya in SELECT'ah (analog switch): <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> parametr <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-string"><span class="hljs-string">' do something'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-string"><span class="hljs-string">' do something else'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-string"><span class="hljs-string">' do something funny'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span>: <span class="hljs-string"><span class="hljs-string">' do do do'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span></code> </pre> <br><br><h4>  Macro acceleration </h4><br>  Often, macros require a long execution time, which can be significantly reduced.  Call Prepare and Ended at the beginning and at the end of each resource-intensive function. <br><pre> <code class="hljs vbscript"><span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Prepare() Application.ScreenUpdating = <span class="hljs-literal"><span class="hljs-literal">False</span></span> Application.Calculation = xlCalculationManual Application.EnableEvents = <span class="hljs-literal"><span class="hljs-literal">False</span></span> ActiveSheet.DisplayPageBreaks = <span class="hljs-literal"><span class="hljs-literal">False</span></span> Application.DisplayStatusBar = <span class="hljs-literal"><span class="hljs-literal">False</span></span> Application.DisplayAlerts = <span class="hljs-literal"><span class="hljs-literal">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Ended() Application.ScreenUpdating = <span class="hljs-literal"><span class="hljs-literal">True</span></span> Application.Calculation = xlCalculationAutomatic Application.EnableEvents = <span class="hljs-literal"><span class="hljs-literal">True</span></span> ActiveSheet.DisplayPageBreaks = <span class="hljs-literal"><span class="hljs-literal">True</span></span> Application.DisplayStatusBar = <span class="hljs-literal"><span class="hljs-literal">True</span></span> Application.DisplayAlerts = <span class="hljs-literal"><span class="hljs-literal">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre> <br>  In order: <br>  1. Disable redrawing of objects on the screen so that nothing blinks. <br>  2. Turn off the calculation.  Attention, if the macro is interrupted in the middle of work, the calculation will remain in manual mode! <br>  3. Do not handle events. <br>  4. Displaying page borders also helps for some reason. <br>  5. The status bar displays various data, which slows down the work, turn off. <br>  6. This is if needed.  Turns off Excel messages.  For example, we are doing a Workbook.Close, Excel wants to ask whether to save the changes.  When you turn off this option, all answers will be given automatically (the changes will not be saved). <br><br>  It is important to understand that VBA performs all actions in the same way as the user.  Therefore, in order to set the page parameters, it opens and closes the parameters window every time.  I set the parameters for 10 sheets, it really is not fast.  Therefore, we do this: <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> Sheets("01").PageSetup.PrintArea &lt;&gt; "A1:D5" <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Sheets("01").PageSetup.PrintArea = "A1:D5" <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> Sheets("02").PageSetup.PrintArea &lt;&gt; "A1:E8" <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Sheets("02").PageSetup.PrintArea = "A1:A1:E8"</code> </pre> <br><br>  Further, it is often necessary to look at various ranges of cells and do something with them.  It is important not to use for loops with brute force indexes, they are slow.  You can use the built-in functions of Excel, but the most convenient option is this: <br><pre> <code class="hljs vbscript"><span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> tCell As Variant <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> tCell <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> Sheets(<span class="hljs-string"><span class="hljs-string">"01"</span></span>).Range(<span class="hljs-string"><span class="hljs-string">"P16:Q19"</span></span>).SpecialCells(xlCellTypeFormulas) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> tCell.Interior.ColorIndex = xlColorIndexNone <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> tCell.Locked = <span class="hljs-literal"><span class="hljs-literal">True</span></span> tCell.Interior.Color = <span class="hljs-built_in"><span class="hljs-built_in">RGB</span></span>(<span class="hljs-number"><span class="hljs-number">220</span></span>, <span class="hljs-number"><span class="hljs-number">230</span></span>, <span class="hljs-number"><span class="hljs-number">241</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> tCell</code> </pre>  This code looks at the specified range, selects ‚Äúspecial cells‚Äù in it, in this case, all that have formulas (that is, start with the equal sign).  For each cell it looks, if it is not painted over, then it must be protected (see below) and painted.  This code works very fast. <br><br>  For any variables to which you are going to assign a book, the sheet, range (cell) must first be declared as Variant. <br><br>  Naturally, if you need the same type of values ‚Äã‚Äãin the cells, you need to use autocomplete, just the same as ‚Äústretching‚Äù the cells by the user. <br><pre> <code class="hljs pgsql">Sheets("01").Range("P15").AutoFill Sheets("01").Range("P15:Q15"), xlFillValues</code> </pre> <br>  The second range should include the first, and the second optional parameter indicates the type of autocomplete. <br><br><h4>  Download books and events </h4><br>  When you open the book every time the procedure is triggered. <br><pre> <code class="hljs vhdl">Private Sub workbook_open() Dim sh as Variant Prepare '   <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> Each sh <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> ActiveWorkbook.Worksheets <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> sh.PageSetup <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> .Orientation &lt;&gt; xlLandscape <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> .Orientation = xlLandscape <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> .LeftMargin &lt;&gt; Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">0.5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> .LeftMargin = Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">0.5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> .RightMargin &lt;&gt; Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">0.5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> .RightMargin = Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">0.5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> .TopMargin &lt;&gt; Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">1.5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> .TopMargin = Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">1.5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> .BottomMargin &lt;&gt; Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">0.5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> .BottomMargin = Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">0.5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> .HeaderMargin &lt;&gt; Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> .HeaderMargin = Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> .FooterMargin &lt;&gt; Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> .FooterMargin = Application.CentimetersToPoints(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> sh Ended <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub</code> </pre>  In this case, the print settings (margins, orientation) are reset to default.  It is possible to perform another initialization.  It is important that if macros are disabled, then nothing will be executed.  If in Eksele a macro warning warning panel came out at the top and the user clicked "Enable", then at that very moment the Workbook_open () procedure will be executed. <br><br>  The list of available events can be viewed at the top of the VB editor.  For example, I did a check on the Change event, where the cell in which there were changes lies, and if this is the desired range, then an entry was made to the log with the old and new values. <br><br><h4>  Protection </h4><br>  Firstly, I note right away that MS Office does not execute macros on computers where it did not find the antivirus if the book is encrypted.  Collided on computers where the antivirus was, but apparently Windows XP did not know about it. <br><br>  Another antivirus can strangely interfere with work, cause errors that are not entirely explainable.  I showed it to IT people, they said ok, they did something, I don‚Äôt know. <br><br>  So, we need to protect the book so that the input is allowed only in the necessary cells (formulas and headers can not be changed).  First, you need to make the corresponding cells "unprotected."  To do this, do one of: <br>  - select the range, the format of the cells, uncheck "Block cell"; <br>  - display the ‚ÄúBlock cell‚Äù button in quick access and press it, it is very convenient to look at it in order to understand whether the cell is protected or not; <br>  - and it will come in handy to check the third option - to write a macro, which removes the protection from the desired cells itself. <br><br>  Next you need to protect the sheet.  On the Review tab there is such a button.  The window asks for a password and set exceptions (what the user can do).  Unfortunately, the list of exceptions is small.  The most annoying thing is that you cannot allow collapsing / expanding groups of columns / rows.  Therefore, we act like this; we prescribe the following to download the book: <br><pre> <code class="hljs pgsql">myPassword = "123" <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> sh <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> ActiveWorkbook.Worksheets sh.Unprotect (myPassword) sh.EnableOutlining = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> sh.Protect <span class="hljs-keyword"><span class="hljs-keyword">Password</span></span>:=myPassword, _ UserInterfaceOnly:=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, AllowSorting:=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, _ AllowFiltering:=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, AllowFormattingRows:=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, _ AllowFormattingColumns:=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, DrawingObjects:=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span> Next sh</code> </pre>  The underscore continues the logical line on the next physical line.  So here we are: <br>  1. Removed protection. <br>  2. Enabled grouping. <br>  3. Put the protection, with: <br>  - protection only from the user, macros continue to have full access (!), It is extremely important; <br>  - allowed sorting, filtering and formatting rows / columns (height / width); <br>  - DrawingObject in this case removes protection from the notes to the cells, maybe something else. <br><br>  Here we are faced with a couple of surprises.  First, not all macros will even work this way.  Known bug, you can not do anything.  You cannot insert a string, for example.  We have to remove and immediately put the protection.  If the ‚Äúattacker‚Äù at this moment presses ctrl + break, the protection will fly off. <br><br>  Secondly, let's say in no way can you delete rows (AllowDeletingRows) that have protected cells, at least one.  Read more <a href="http://excel.tips.net/Pages/T003004_Inserting_and_Deleting_Rows_in_a_Protected_Worksheet.html">here</a> . <br><br>  The solution (crutch) is to add a button or keyboard shortcut for deletion.  At the same time, you can check that the user does not remove what is not needed.  Add to Workbook_open: <br><pre> <code class="hljs objectivec">Application.OnKey <span class="hljs-string"><span class="hljs-string">"+{DELETE}"</span></span>, <span class="hljs-string"><span class="hljs-string">".DelSelectedRow"</span></span></code> </pre> <br>  Now the procedure will be called when you press shift + delete. <br><pre> <code class="hljs pgsql">Sub DelSelectedRow() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> Selection.<span class="hljs-keyword"><span class="hljs-keyword">Rows</span></span>.Count = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> Selection.Parent.Name = "01" <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> Selection.Cells.Count &gt;= <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> Selection.<span class="hljs-keyword"><span class="hljs-keyword">row</span></span> &gt; <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> Selection.<span class="hljs-keyword"><span class="hljs-keyword">row</span></span> &lt; <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Selection.<span class="hljs-keyword"><span class="hljs-keyword">Delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub</code> </pre>  I know the code is ugly, sorry.  Here I tried to check that a row is highlighted, that is, there are 1 rows, and no less than a thousand cells.  To remove the wrong, you will have to select a thousand cells starting from a different column.  Next, check the sheet name and line numbers.  Instead of 50, the last line was calculated (because their number changes, if we delete and add them). <br><br><h4>  Conclusion </h4><br>  VBA is a very buggy thing that allows you to move mountains in MS Office.  Many businesses use Excel models for years, and if they are done well, then everything works. <br><br>  He himself is suitable for studying VBA, firstly there is a good reference.  For example, to find out all the options that can be resolved in the Protect method, press F1, Protect, input.  And voila. <br><br>  Secondly, you can do the required actions manually by writing a macro, and then viewing its code.  The code will be terrible (for example, if you change the page settings, the macro will record the values ‚Äã‚Äãof all parameters and fields, not just the one you changed), but there are answers.  Although, for example, .AutoFit, which is recorded when the cell height changes in content (double click on the border to the left), does not actually work. <br><br>  I suggest experts to share their experiences, give advice in the comments.  Thank you for your attention, good development to you. </div><p>Source: <a href="https://habr.com/ru/post/112458/">https://habr.com/ru/post/112458/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../112452/index.html">Are you ready to ride the Harley?</a></li>
<li><a href="../112453/index.html">Using Linux on the SAN network. Little trick</a></li>
<li><a href="../112454/index.html">Start Cloud Printing</a></li>
<li><a href="../112456/index.html">A hundred best</a></li>
<li><a href="../112457/index.html">Translated into Russian a very visual circuit simulator</a></li>
<li><a href="../112459/index.html">How in the Ulyanovsk region "selected" the Minister of IT</a></li>
<li><a href="../112461/index.html">ArchBang Release 2011.01 - Symbiosis</a></li>
<li><a href="../112462/index.html">How do you feel about team building training for IT teams (extreme, rope courses)?</a></li>
<li><a href="../112463/index.html">Google Voice in Gmail</a></li>
<li><a href="../112464/index.html">Linq To Tasks and the continuation monad</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>