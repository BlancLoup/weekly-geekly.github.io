<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Random letter generator and its variants</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Turning to the topic of writing random letter generators suggested that in JS there is an atypical native function of converting a string to an n-ary ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Random letter generator and its variants</h1><div class="post__text post__text-html js-mediator-article">  Turning to the topic of writing random letter generators suggested that in JS there is an atypical native function of converting a string to an n-ary number, where n = 2..36.  36 in the standard language was not invented by chance - it is the sum of the number of numbers and small English letters from which it is proposed to write such numbers.  This means that with a couple of native functions it is already possible to build a useful generator of small strings from an alphabet. <br><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random().toString(<span class="hljs-number"><span class="hljs-number">36</span></span>) <span class="hljs-comment"><span class="hljs-comment">//   0.816cwugw2ky, 0.opgqwav8w1m, 0.f0w4ejtq8wk, ...</span></span></code> </pre> <br>  This means that for some tasks it is possible not to write relatively honest generators based on dull strings of the form ‚Äúabcdefghijklmno ...‚Äù. <br><a name="habracut"></a><br>  The results can be used in any programming language in which we will get used functions in any way, but we will talk about javascript, since the length and simplicity of functions as text in the browser matter in various practical tasks. <br><br>  Having learned about key words, it is easy to google achievements in building random letter digital generators, which are offered, in particular, at StackOverflow.  You can see a funny picture that they first write a conscientious wordy algorithm with a choice of characters from a string, it is furiously plus, <a href="http://stackoverflow.com/questions/1349404/generate-a-string-of-5-random-characters-in-javascript">like here</a> , then someone remembers that there is such a very short way, which sometimes fits very well into the solution of the problem.  However, it does not always bring the matter to the end, and the decision needs to be finished, independently assessing the speed and clarity of the decision. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Consider solutions for different typical tasks.  Let's try to estimate the speed of some decisions - sometimes you need to generate random strings in large volumes.  The result is a story about the methods and their comparison.  Let's see what is usually asked on the Internet when it comes to generating random characters. <br><br>  We will not touch on the quality of random sequences - let's take the Math.random () generator as a basis.  Its improvements are highly dependent on the needs and there is a topic for a separate study.  Let's not forget about the balance of probabilities of the appearance of various symbols, so that our algorithm does not worsen the probability of the distribution of numbers or symbols.  Consider and classic algorithms with a sequence of characters as a model for the generator. <br><br>  The task in general form is as follows: <br>  <i>" <u>You need to get a sequence of random characters (numbers, letters, small and large letters, all together, the letters of the national alphabet) so that the probability of the appearance of any character is equal for all characters.</u> "</i> <br><br>  If the question concerns a small number of digits, then the solution is already there, you just need to cut off the desired piece of them from the result of the Math.random () function. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">randN</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// [ 1 ] random numbers return (Math.random()+'').slice(2, 2 + Math.max(1, Math.min(n, 15)) ); }</span></span></code> </pre><br><br>  We will look at first with what it is necessary to deal: how many digits after a point function Math.random () gives. <br><pre> <code class="php hljs">Chrome30: <span class="hljs-number"><span class="hljs-number">0.5439428824465722</span></span> Firefox24:<span class="hljs-number"><span class="hljs-number">0.8270932732750623</span></span> Opera <span class="hljs-number"><span class="hljs-number">12</span></span>: <span class="hljs-number"><span class="hljs-number">0.1945655094774541</span></span> IE8: <span class="hljs-number"><span class="hljs-number">0.48207786689050286</span></span></code> </pre><br>  In binary representation (javascript: Math.random (). ToString (2)): <br><pre> <code class="php hljs">Chrome30: <span class="hljs-number"><span class="hljs-number">0.10010010010000001000110001001001</span></span> Firefox24:<span class="hljs-number"><span class="hljs-number">0.1000101010011110010101000000110000110010010101111001</span></span> Opera <span class="hljs-number"><span class="hljs-number">12</span></span>: <span class="hljs-number"><span class="hljs-number">0.11000111010010011011101000110100000000100110000011111</span></span> IE8: <span class="hljs-number"><span class="hljs-number">0.10000011001010000101111011000010000101001001110001</span></span></code> </pre><br>  In 36-bit (javascript: Math.random (). ToString (36)): <br><pre> <code class="php hljs">Chrome30: <span class="hljs-number"><span class="hljs-number">0.</span></span>acpi1knlm53tyb9 Firefox24:<span class="hljs-number"><span class="hljs-number">0.</span></span>r9pe3mirhw Opera <span class="hljs-number"><span class="hljs-number">12</span></span>: <span class="hljs-number"><span class="hljs-number">0.</span></span>kmzlo986rok IE8: <span class="hljs-number"><span class="hljs-number">0.33</span></span>t3if0bsh6j</code> </pre><br>  As you can see, one must be careful in anticipation of the number of digits, and in accuracy, depending on the number system.  For the minimum limit, you must take the minimum of the number of digits shown and completely trust no one.  At least 16 are shown among decimal digits, so the maximum number was 15, which is already too optimistic, but the value of our first function is small. <br><br>  The results of profiling the randN () function without checking the limits (300 thousand cycles with 15 characters each, values ‚Äã‚Äãin milliseconds, averaging over 20 measurements - 300,000 * 15 * 20 = 90 million characters were calculated): <br><pre> <code class="php hljs">Ch30: <span class="hljs-number"><span class="hljs-number">240.2</span></span> ¬± <span class="hljs-number"><span class="hljs-number">2.47</span></span>% Fx24: <span class="hljs-number"><span class="hljs-number">770.8</span></span> ¬± <span class="hljs-number"><span class="hljs-number">1.68</span></span>% Op12: <span class="hljs-number"><span class="hljs-number">274.9</span></span> ¬± <span class="hljs-number"><span class="hljs-number">3.89</span></span>% IE8 : <span class="hljs-number"><span class="hljs-number">1020.4</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.71</span></span>%</code> </pre><br><div class="spoiler">  <b class="spoiler_title">(for those who are interested in how profiling took place)</b> <div class="spoiler_text"><pre> <code class="javascript hljs">&lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"resTest"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">table</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">resTable</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">randN</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">table</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script src=<span class="hljs-string"><span class="hljs-string">"jquery-1.9.1.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span>&gt; onload = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tSred = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s =<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i =<span class="hljs-number"><span class="hljs-number">0</span></span>, iL = a.length; i &lt; iL; i++) s += a[i]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s / iL; }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tSigm = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = <span class="hljs-number"><span class="hljs-number">0</span></span>, f2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i =<span class="hljs-number"><span class="hljs-number">0</span></span>, iL = a.length; i &lt; iL; i++){ f2 += a[i] * a[i]; s += a[i]; } s = s / iL; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sqrt(f2 / iL - s * s); }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> randN = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random()).toString().slice(<span class="hljs-number"><span class="hljs-number">2</span></span>) } ,testName =<span class="hljs-string"><span class="hljs-string">'randN'</span></span> ,nIzmer =<span class="hljs-number"><span class="hljs-number">20</span></span> ,timeS =[]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> j =<span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; nIzmer; j++){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i =<span class="hljs-number"><span class="hljs-number">3e5</span></span> ,time0 = +<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(i-- &gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) randN(<span class="hljs-number"><span class="hljs-number">15</span></span>); timeS.push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>() - time0); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sred = tSred(timeS).toFixed(<span class="hljs-number"><span class="hljs-number">1</span></span>) ,sigm = (tSigm(timeS) / sred *<span class="hljs-number"><span class="hljs-number">100</span></span> ).toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>) ,nu = navigator.userAgent ,br = <span class="hljs-regexp"><span class="hljs-regexp">/MSIE/</span></span>.test(nu) ?<span class="hljs-string"><span class="hljs-string">'IE8 : '</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/Opera/</span></span>.test(nu) ?<span class="hljs-string"><span class="hljs-string">'Op12: '</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/Firefox/</span></span>.test(nu) ?<span class="hljs-string"><span class="hljs-string">'Fx24: '</span></span>:<span class="hljs-string"><span class="hljs-string">'Ch30: '</span></span> $(<span class="hljs-string"><span class="hljs-string">'.resTest .resTable .'</span></span>+ testName).html(br + sred +<span class="hljs-string"><span class="hljs-string">' ¬± '</span></span>+ sigm +<span class="hljs-string"><span class="hljs-string">'% | '</span></span>+ timeS.join(<span class="hljs-string"><span class="hljs-string">', '</span></span>)); };<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> </div></div><br>  The same, but with checking the limits of the argument: <br><pre> <code class="php hljs">Ch30: <span class="hljs-number"><span class="hljs-number">238.4</span></span> ¬± <span class="hljs-number"><span class="hljs-number">4.16</span></span>% Fx24: <span class="hljs-number"><span class="hljs-number">782.5</span></span> ¬± <span class="hljs-number"><span class="hljs-number">1.84</span></span>% Op12: <span class="hljs-number"><span class="hljs-number">303.1</span></span> ¬± <span class="hljs-number"><span class="hljs-number">3.18</span></span>% IE8 : <span class="hljs-number"><span class="hljs-number">1230.5</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.56</span></span>%</code> </pre><br>  The first instructive conclusion is: although checks seem to be fast operations, they are not made really fast everywhere. <br><br>  Overhead costs in this profiling take very little and are within the limits of error: if you put an empty cycle, its pass rate is calculated as 100-300 times faster (from 0.5 to 10 ms for the same 300 thousand cycles).  Messages about whether it is time to stop the scripts for tests in browsers are specifically disabled.  Thus, we measure exactly what we want.  It makes sense only a comparison of indicators made on one computer.  If we want to make a comparison with IE10, in all other browsers we will have to repeat the tests - the operating system will be different and the speeds of both browsers and computer hardware will be different. <br><br>  Already interesting?  But it was just the preparation of tools for this study.  They will work for all other measurements, the main loop and the total given number will be different.  The resulting function [1] randN () gives us very little: only a line of up to 15 random numbers.  And ahead there are letters, numbers with letters, Russians and other national ones.  The most interesting thing is to compare how much the application of native functions of the form .toString (36) differs in speed compared to the more traditional cross-language algorithm. <br><br><h3>  Latin alphabet </h3><br>  There is little nationalism in this, so a politically correct wording crept into the headline.  Already the French and Spaniards will be unhappy that not all their letters of the alphabet are included in the proposed set.  But it will be useful for generating random names, if only with small Latin letters alone. <br><br>  Suppose, for a start, that we will not need a lot of alphabetical letters - a maximum of 10 is enough that Firefox can squeeze out of itself. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">randWD</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// [ 2 ] random words and digits return Math.random().toString(36).slice(2, 2 + Math.max(1, Math.min(n, 10)) ); } //result is such as "46c17fkfpl"</span></span></code> </pre><br>  How have the speeds changed (with limits checked: we are serious people)? <br><pre> <code class="php hljs">Ch30: <span class="hljs-number"><span class="hljs-number">195.4</span></span> ¬± <span class="hljs-number"><span class="hljs-number">3.17</span></span>% Fx24: <span class="hljs-number"><span class="hljs-number">1049.0</span></span> ¬± <span class="hljs-number"><span class="hljs-number">1.26</span></span>% Op12: <span class="hljs-number"><span class="hljs-number">421.6</span></span> ¬± <span class="hljs-number"><span class="hljs-number">2.46</span></span>% IE8 : <span class="hljs-number"><span class="hljs-number">1150.8</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.66</span></span>%</code> </pre><br>  Some people passed the test 1.5 times longer, Chrome showed miracles at all by completing the 36-bit conversion faster than decimal (and he calculated the binary for 350 ms), IE is a little faster than himself, beyond the limits of errors. <br><br>  The main result is this: without losing anything, we calculated the alphabet numbers about as quickly as random numbers. <br><br>  Now let's compare the speed with the dull classical algorithm, where you need to dial the whole alphabet and numbers into the bargain.  I did not want to write it, but science requires sacrifice. <br><br><h3>  Alphabets from the classics </h3><br><pre> <code class="javascript hljs">randWDclassic = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// [ 3 ] random words and digits by the wocabulary var s ='', abd ='abcdefghijklmnopqrstuvwxyz0123456789', aL = abd.length; while(s.length &lt; n) s += abd[Math.random() * aL|0]; return s; } //such as "46c17fkfpl"</span></span></code> </pre><br><pre> <code class="php hljs">Ch30: <span class="hljs-number"><span class="hljs-number">226.4</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.95</span></span>% Fx24: <span class="hljs-number"><span class="hljs-number">1006.4</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.93</span></span>% Op12: <span class="hljs-number"><span class="hljs-number">917.3</span></span> ¬± <span class="hljs-number"><span class="hljs-number">1.14</span></span>% IE8 : <span class="hljs-number"><span class="hljs-number">1268.0</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.45</span></span>%</code> </pre><br><br>  He calculated 15 characters in the test instead of 10 in the previous algorithm, showed on average even good results, and he has no problems with scaling.  Of the minuses - you need to write a lot of letters.  But the first algorithm did not say its last word either.  A big plus of the algorithm with a string is the ability to assemble a string of any characters and even provide for the frequency of characters in it, although a multiple of the minimum frequency of occurrence of the only character mentioned. <br><br>  It means that in this algorithm all the tasks are solved and, moreover, frequency issues.  Can native toString (36) oppose something and take at least part of a niche?  After all, she has small Latin letters on the issue or just numbers, and on stackoverflow they want everything that you can imagine: small with large letters without numbers, not far off - national sets. <br><br><h3>  Revenge toString (36) </h3><br>  We need to solve 2 problems with this approach: ensure scalability and at least learn how to produce only numbers.  Then, if the algorithm is fast, it will occupy its niche.  If only because he is brief. <br><br>  We use the fact that we can type a string of several characters at a time. <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">randWDn</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// [ 4 ] random words and digits unlimited var s =''; while(s.length &lt; n) s += Math.random().toString(36).slice(2, 12); return s.substr(0, n); }</span></span></code> </pre><br><pre> <code class="php hljs">Ch30: <span class="hljs-number"><span class="hljs-number">440.6</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.49</span></span>% Fx24: <span class="hljs-number"><span class="hljs-number">1760.2</span></span> ¬± <span class="hljs-number"><span class="hljs-number">5.05</span></span>% Op12: <span class="hljs-number"><span class="hljs-number">858.8</span></span> ¬± <span class="hljs-number"><span class="hljs-number">1.36</span></span>% IE8 : <span class="hljs-number"><span class="hljs-number">2495.3</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.35</span></span>%</code> </pre><br>  Calculated 15 characters (in fact, at least 20), the function is scalable, can take any positive argument.  In general, the comparison looks rather disastrous: the algorithm with toString (36) plays the role of a catch-up, comparing in speed in areas of 10, 20, 30, characters and playing in the intervals.  It only supports 2 (for now) character sets: numbers and letter numbers.  Can it be extended to letters without losing its brevity?  Yes. <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">randWn</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// [ 5 ] random words var s =''; while(s.length &lt; n) s += Math.random().toString(36).replace(/\d|_/g,'').slice(2, 12); return s.substr(0, n); } //such as "amyozispiizmmrb"</span></span></code> </pre><br><pre> <code class="php hljs">Ch30: <span class="hljs-number"><span class="hljs-number">785.6</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.80</span></span>% Fx24: <span class="hljs-number"><span class="hljs-number">3121.6</span></span> ¬± <span class="hljs-number"><span class="hljs-number">4.58</span></span>% Op12: <span class="hljs-number"><span class="hljs-number">1985.5</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.62</span></span>% IE8 : <span class="hljs-number"><span class="hljs-number">5967.2</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.16</span></span>%</code> </pre><br><br>  What is there to say?  Tested to get 15 characters, actually 20. 90-140 million characters for the entire test.  Received purely alphabetic strings.  In regexp it is now possible to write other conditions for cutting out unnecessary elements.  For example, turn off some letters.  Regekspy sags at all.  They behave super-failingly in IE8 - they received not 90 million random characters per second, as in Chrome, but some 16, which is also a lot, looking to compare with.  In comparison with character sets lose in all respects. <br><br>  <b>Findings.</b>  Using the exotic native function .toString (36) is a beautiful thing.  It is beneficial to use it not as part of a function, but for directly taking a random string of up to 10 characters in the code once.  Then she looks short, although not everyone understands.  In the rest, in terms of speed and flexibility, they lose to character sets [3]. <br><br><h3>  Random Cyrillic on regexp </h3><br>  In the Cyrillic version, there is nowhere to use toString (36).  Let's go the other way.  Get any character from a certain range of codes and remove unnecessary ones.  Something like the sieve of Eratosthenes.  It is clear that each deletion of a calculated random symbol is recorded in a passive, therefore, the greater the percentage of deletions, the slower the algorithm and the stronger it will lose to the classics [3].  Optimizing is easy if the character set occupies a limited range of Unicode codes.  But then checks and magic numbers appear in the code. <br><br>  Here, for starters, an example of such a <u>latin</u> assembly.  We get the addition of large and small letters.  Because of the "laziness", because they chose the range of 0 ... 127, there are many unnecessary calculations of random variables.  This does not interfere with the algorithm - it will dial a string if there is at least 1 character in the range, but time suffers. <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">randAa</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// [ 5 ] random big/small letters var s =''; while(s.length &lt; n) s += String.fromCharCode(Math.random() *127).replace(/\W|\d|_/g,''); return s; //such as "AujlgLpHLVfDVpNEP" }</span></span></code> </pre> <br>  <i>(If we want to see how many attempts disappear, simply write ".length" at the end of a long line. The zeroes in the response line are the missing attempts, 1 is used. Approximately such a density: "0101000010000000010010100010100101100". This is not to be surprised how slower there will be an algorithm.)</i> <br><pre> <code class="php hljs">Ch30: <span class="hljs-number"><span class="hljs-number">2897.7</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.23</span></span>% Fx24: <span class="hljs-number"><span class="hljs-number">7720.0</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.35</span></span>% Op12: <span class="hljs-number"><span class="hljs-number">74651.3</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.35</span></span>% IE8 : <span class="hljs-number"><span class="hljs-number">49903.7</span></span> ¬± <span class="hljs-number"><span class="hljs-number">0.21</span></span>% - <span class="hljs-number"><span class="hljs-number">50</span></span>   <span class="hljs-number"><span class="hljs-number">100</span></span>  </code> </pre><br>  It is easy to check what is slowing down here a short but difficult regexp (several checks for letters and numbers).  The easiest way to optimize is to exclude the range 0 ... 47 by writing Math.random () * 80 +48 inside the brackets. <br>  We do the same for Cyrillic.  We take the range where all it is, and delete the non-Cyrillic alphabet.  It must be remembered that such cycles are recorded beautifully, but they are performed extremely slowly, 1106/66 times slower than they could be if the range was effectively selected, so using them for calculating several thousand characters is normal, but for millions it will not work.  At the same time, the algorithm with the character set in the string is suitable for millions. <br><pre> <code class="javascript hljs">randAYa = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// [ 6 ] random big/small cyrillic letters var s =''; while(s.length &lt; n) s += String.fromCharCode(Math.random() *1106).replace(/[^--]|_/g,''); return s; //such as "" }</span></span></code> </pre> <br>  For tests, there were taken 100 times fewer passes with a set of 15 characters, but the results were increased 100 times for visual comparison with others. <br><pre> <code class="php hljs">Ch30: <span class="hljs-number"><span class="hljs-number">21800.3</span></span> ¬± <span class="hljs-number"><span class="hljs-number">1.77</span></span>% Fx24: <span class="hljs-number"><span class="hljs-number">64100.6</span></span> ¬± <span class="hljs-number"><span class="hljs-number">1.70</span></span>% Op12: <span class="hljs-number"><span class="hljs-number">57000.0</span></span> ¬± <span class="hljs-number"><span class="hljs-number">1.92</span></span>% IE8 : <span class="hljs-number"><span class="hljs-number">341200.5</span></span> ¬± <span class="hljs-number"><span class="hljs-number">4.20</span></span>%</code> </pre>  The time can be reduced by 16 times, based on the fact that the code 1105 is the maximum Unicode of the Cyrillic alphabet, and 1040 is the minimum by writing Math.random () * (1106-1040) * 1040 in the right place.  But still, seconds per 100 million characters are a lot for mass calculations as compared with the function [3]. </div><p>Source: <a href="https://habr.com/ru/post/197046/">https://habr.com/ru/post/197046/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197030/index.html">FreeNAS 9.1.1 - we create network storage. Part 2. Installation transmission</a></li>
<li><a href="../197034/index.html">I know that you know, that I know that you know ...</a></li>
<li><a href="../197036/index.html">Linux for professionals: how to prepare a layout for printing in a print shop</a></li>
<li><a href="../197038/index.html">Cross domain postMessage or how browsers support standards</a></li>
<li><a href="../197044/index.html">Centrifuge - as simple as possible, but not easier</a></li>
<li><a href="../197048/index.html">IT students forced to work on the assembly of the PlayStation 4</a></li>
<li><a href="../197056/index.html">Google starts paying rewards for fixing vulnerabilities in open source projects</a></li>
<li><a href="../197058/index.html">Metric # 25 - A podcast about technologies, products, and services from the IT world</a></li>
<li><a href="../197060/index.html">The process of testing mobile applications</a></li>
<li><a href="../197062/index.html">Details about the Nexus 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>