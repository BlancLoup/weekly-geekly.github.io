<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Smart room that helps in the work</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All materials about smart home  As a smart home did not let the cat freeze 
 Smart home: the operation of the microclimate or the path to comfort step...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Smart room that helps in the work</h1><div class="post__text post__text-html js-mediator-article"><div class="spoiler">  <b class="spoiler_title">All materials about smart home</b> <div class="spoiler_text">  <a href="https://geektimes.ru/post/272290/">As a smart home did not let the cat freeze</a> <br>  <a href="https://geektimes.ru/post/276204/">Smart home: the operation of the microclimate or the path to comfort step by step</a> <br>  <a href="https://geektimes.ru/post/284048/">Smart home: on guard for peace and security</a> <br></div></div><br><br>  It has long been observed that human biorhythms are strongly tied to the light and the solar cycle.  And the light itself can both help in life and work, and it can be very tiring if it is wrong to choose light sources: brightness, color temperature, flickering are important here ... <br>  But today I want to talk not about this, but about how my smart home helped to build a comfortable mode of work and sleep.  And we will work with the light in all possible ways. <br>  This material is a logical continuation of my first article about the smart house " <a href="https://geektimes.ru/post/272290/">How a smart house did not let the cat freeze,</a> " so the same technologies will be involved, and you can control the house using a predetermined algorithm from a computer or smartphone - these were my requirements for this technique. <br><br><img src="https://habrastorage.org/files/a6c/8a6/b23/a6c8a6b233e5408abefad498b3542682.gif">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  After talking with the readers of the previous article on the smart home ( <a href="https://geektimes.ru/post/272290/">How the smart home did not let the cat freeze</a> ), where I used the Fibaro Home Center Lite controller, I was recommended to pay attention to the <a href="http://www.5smart.ru/collection/kontrollery/product/kontroller-mi-casa-verde-vera-3">Mi Casa Verde Vera 3</a> controller, because ‚ÄúFibaro is an iPhone among the controllers, and Vera is an android.  You don't want your lips curled up? ‚Äù  Of course, for me it was not an argument, but I wanted to try something new.  In addition, I was interested in a huge number of plug-ins for this controller, which, as a result, were useful to me.  But I will not get ahead. <br><br>  <b>Task</b> <br>  The windows of my room are facing south-east.  So, rather quickly after dawn, the first rays already penetrate the room.  And the last rays of the sun disappear after 18 hours.  Sometimes a busy work schedule and dedication to one‚Äôs own business make it impossible to break away from the computer and turn on the light after sunset - one has to go to the light switch only by the light of the monitor.  There is also the opposite situation, when the amount of light in the room is such that it is necessary to partially draw the curtain in order not to blind and maintain comfort for the eyes.  And the task was born: <b>The room should be maintained at a given comfortable level of brightness automatically</b> . <br><br>  <b>Solutions</b> <br>  Any task should be divided into subtasks until the most simple and effective solution appears. <br>  Therefore, I began to look for solutions.  The first and easiest was the step-by-step opening and closing of the curtains, depending on the time of day.  And even such plugins already exist.  But there is no feedback and the curtain will be covered, even when there is a storm and lead clouds outside the window, and when the location is halfway across the globe, my curtains will start to open at night.  It did not suit me, so I went my own way. <br><br>  The task is divided into the following stages. <br>  If the time is daily, that is, from 9 to 19: <br>  1. We monitor the brightness level in the room with the help of a multi-sensor <br>  2. If the brightness level exceeds the comfort level, partially delay the curtain. <br>  3. If the brightness level is lower than comfortable, partially open the curtain <br>  4. Go back to step 1. <br><br>  If the time is night: <br>  1. Pull the curtain completely <br>  2. Change the brightness of artificial lighting discretely. <br>  3. We track the brightness level in the room with a multi-sensor <br>  4.1.  If the brightness level is below the comfort level, increase by 20%. <br>  4.2.  If the brightness level is higher than the comfort level, decrease by 20%. <br><br>  In order for the curtain not to jerk back and forth with the running clouds or a bright flash, we set the delta of time and brightness at which no action will be taken. <br>  In my experiments, I used 5 smart home devices based on Z-wave technology.  I warn you that this material is not an advertisement, but an instruction for launching the system, so I give references to the devices I use. <br><br>  <b>Devices</b> <br>  1. <a href="http://www.5smart.ru/collection/kontrollery/product/kontroller-mi-casa-verde-vera-3">Z-Wave Mi Casa Verde Vera 3</a> Controller <br>  2. <a href="http://www.5smart.ru/collection/datchiki/product/multisensor-aeotec-4-v-1">Multisensor AEOTEC 4 IN 1</a> <br>  3. Built-in dimmer <a href="http://www.5smart.ru/collection/upravlenie-osvescheniem/product/vstraivaemyy-dimmer-z-waveme-dimmer">Z-Wave.Me Dimmer</a> <br>  4. <a href="http://www.5smart.ru/collection/upravlenie-elektropriborami/product/vstraivaemoe-dvoynoe-rele-fibaro-double-switch-2x15kw">Z-Wave Fibaro Double Relay Switch 2x1.5kW built in switch</a> <br>  5. <a href="http://www.electronshik.ru/item/501-micro-gearmotor-extended-hp-667854">Micromotor with gearbox</a> <br>  6. <a href="http://www.electronshik.ru/item/4-channel-5v-relay-module-for-arduino-1135591">4 channel relay for Arduino</a> <br><br>  <b>Stage 1</b> <br>  As I already wrote, I divided the work into 2 stages.  The first is the automatic lighting operation in the evening.  If there is not enough light, then based on the data obtained from the light sensor, the controller increases the brightness of the light using a dimmer.  Since my main light is realized by LED strips, the dimmer works only with auxiliary halogen lamps.  It works like this: the light sensor sends data every 10 seconds to the controller, and the light test happens every 20 seconds.  This is done so that the random flash does not turn off all the lights.  The dimmer itself is mounted elementary.  When the wiring is properly laid, your phase should break, and zero should be applied to the lamps.  The dimmer is inserted into the wire break and is easily recorded in the controller.  I have installed two lines of fixtures, but since the dimmer allows you to smoothly adjust the illumination, they were both involved.  All work has been reduced to determining the phase wire and working with a screwdriver for two minutes: the first went to remove the old switch, and the second to connect the dimmer. <br><br><img src="https://habrastorage.org/files/457/855/3d0/4578553d034846a69e404ce88682f51e.JPG"><br><br>  <b>Stage 2</b> <br>  The second stage is working with daylight.  When the light is too bright, glare appears and it interferes a lot.  Therefore, it was also decided to automate the curtain drawing.  The biggest problems started with the mechanics, because at first I took a high-speed but low-powered engine that the roller could not turn.  Then I changed the engine to a compact one, but with more effort due to the use of a gearbox.  Its power and speed suited me perfectly.  The finishing touches were reduced to the fact that a thread was fixed to the first ring of the curtains, and the engine turned this thread back and forth.  It was originally planned to put the end sensors to track the extreme positions of the curtains, but experience has shown that the tension of the thread is such that at the extreme points the engine roller slips and does not tear anything.  And during normal operation, the roller has a good grip with the thread, which is provided with an additional tension roller.  It looks like this: <br><br><img src="https://habrastorage.org/files/cf7/54b/f2f/cf754bf2f6b3480aaed6d191fae2b87b.jpg"><br><br>  Having learned the total time of the engine when moving from one extreme position to another, I simply divided the time by 4 and set in the settings the change in the position of the curtain by the time the engine was running in one direction or another.  The DC motor has a reverse when changing polarity and then I was faced with the task of changing the polarity.  A simple solution would be to use a three-position relay, but finding it was not easy.  Old experience and some tricks came to the rescue. <br>  I took the standard two-position relay in the amount of 4 pieces, pairwise connected them for synchronous switching on and off.  And he controlled them with the help of Z-Wave relay.  The scheme is as follows: <br><br><img src="https://habrastorage.org/files/539/dbb/8fd/539dbb8fdbe244aebf918760cc794de5.jpg"><br><br>  It can be seen from the diagram that if contacts 1 and 3 are simultaneously closed, the motor will begin to rotate in one direction, and if 2 and 4, the motor will receive a different polarity and begin to rotate in the opposite direction.  To avoid confusion and close the relay in pairs, and even with the help of a controller, I activated the two-channel Fibaro Z-Wave relay.  For correct operation, it is enough to apply to the in1 and in3 +5 V contacts, or the same voltage on the water of the in2 and in4 relays.  The Z-Wave device itself is endowed with two relays, but they work with a single input bus.  This should be considered if you want to use such a relay as two different, for example, working with alternating and direct current.  As a result, we got the following control scheme from the controller of the smart home 4 relays in pairs. <br><br><img src="https://habrastorage.org/files/04d/5e7/b1c/04d5e7b1c79b4bcd86416d8b278d31a7.jpg"><br><br>  To power this circuit, it took 5V DC and 220V AC.  The alternating current is powered by the Z-Wave relay, and the direct current is powered by a re-arduine and an electric motor.  For the operation of the entire system, I had the old adapter from some electrical device for 5V and 1A. <br><br>  Now let's see how it works in reality. <br><br><img src="https://habrastorage.org/files/5f4/5f0/392/5f45f039200f4020a74f5193a1cc5157.gif"><br><br>  Putting it all together, we get an algorithm that works on time.  A virtual switch has also been added to the menu that allows you to start or stop the light tracking mode.  Measurements of illumination were carried out using both a multi-sensor and a control <a href="https://dadget.ru/katalog/zdorove/luksmetr">light meter</a> .  I must say that their testimony diverged with increasing light.  I believe that this was due to the fact that the cap of the multi-sensor was made in such a way as to collect light from the entire sphere, and the sensor of the luxmeter reads from the plane of its sensor. <br><br><img src="https://habrastorage.org/files/4fe/fb2/cf8/4fefb2cf8ccb445a98b58185c17e3498.JPG"><br><br>  <b>Conclusion</b> <br><br>  In the process of creating automatic lighting, people approached me and asked: ‚ÄúIs it worth it?‚Äù.  But after the first draft with an alert about which I wrote at the beginning of the article, I realized that there is no limit to perfection.  The point is not even that there is an opportunity to feel new technologies or to control the light without getting up from the chair.  A smart home is a completely different state of HOME.  How to explain the fact that I looked into the boiler room during the whole winter 4 times, simply adjusting the boiler temperature depending on the ‚Äúseason‚Äù?  At the same time, the boiler itself worked during the hours of the lowest cost of electricity (a two-tariff counter).  Or how to evaluate the comfort of living in a house where it is always fresh, and the ventilation system works quietly and autonomously, it turns itself on and off? <br>  The whole life of a smart home consists of trifles, which, in principle, you can do yourself, but the realization that you will come into the house and you will be sure that all systems are functioning properly - here you really understand that "It is worth it!" . </div><p>Source: <a href="https://habr.com/ru/post/392807/">https://habr.com/ru/post/392807/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../392789/index.html">Intel Software Guard Technology Extensions in Pictures</a></li>
<li><a href="../392795/index.html">The court for the second time blocked the library "Flibusta"</a></li>
<li><a href="../392797/index.html">China has created a solar panel that can generate electricity from rain</a></li>
<li><a href="../392799/index.html">Getting out of the comfort zone as a new business model</a></li>
<li><a href="../392803/index.html">Sony Xperia Z5 Premium comes in pink</a></li>
<li><a href="../392811/index.html">Game Patent for Boot Screens Gone</a></li>
<li><a href="../392813/index.html">Australian Craig Wright is going to prove that he is Satoshi Nakamoto, the creator of Bitcoin</a></li>
<li><a href="../392815/index.html">A prototype of a LED board for 262,144 color combinations and 64 pixels</a></li>
<li><a href="../392817/index.html">Death examination</a></li>
<li><a href="../392819/index.html">Vice-President of Jet Pack International crashed on a jetpack (alive, stable)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>