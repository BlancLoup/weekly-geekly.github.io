<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using SVG as a Placeholder</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SVG generation from images can be used for Placeholders. 

 I am engaged in the optimization of images and images for their quick download. One of the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using SVG as a Placeholder</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/fda/f98/f59/fdaf98f59edc981e02ca522d0a135432.jpg" alt="image"><br><br>  <i>SVG generation from images can be used for Placeholders.</i> <br><br>  I am engaged in the optimization of images and images for their quick download.  One of the most interesting areas of research is Placeholders: what to show when the image is not loaded yet. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In recent days I have come across some boot methods that use SVG, and I would like to describe them in this post. <br><br>  In this post we will cover the following topics: <br><br><ul><li>  Overview of the various types of placeholders </li><li>  SVG based placeholder (contours, shapes, and silhouettes) </li><li>  Automate the process. </li></ul><br><a name="habracut"></a><br><hr>  <em><font color="#999999">The translation was made with the support of the company <a href="https://www.edsd.ru/integratsiya-sistem-videonablyudeniya-axxon-next-i-sureview-immix">EDISON Software</a> , which is professionally engaged in the <a href="https://www.edsd.ru/korporativnye-sajty-na-wordpress">creation of corporate websites on WordPress</a> , as well as the <a href="https://www.edsd.ru/kak-my-risuem-personazhej">design of characters for corporate identity</a> .</font></em> <br><hr><br><h3>  Overview of the various types of placeholders </h3><br>  In the last post I wrote about Placeholder and lazy loading of images, and also talked about it.  When you do a lazy loading of images, it's a good idea to think about what to do as a Placeholder, as this can have a big impact on the user's perception.  Recently, I described several options: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f90/2c4/03f/f902c403fd55a6e23234ed9e90078835.png" alt="image"><br><br>  <i>Several options for filling the image area before loading it.</i> <br><br>  <b>Keeping image space empty</b> : in the world of responsive design, this prevents content shifting.  These layout changes are bad from the user's point of view, and for presentation.  The browser is forced to perform layout calculations every time it retrieves image dimensions, leaving space for it. <br><br><ul><li>  <b>Placeholder</b> : Imagine that we are showing a profile picture of a user.  We could display the silhouette in place of the image.  It is displayed not only when the main image is loaded, but also when the request fails or when the user has not installed a profile image at all.  These images are usually based on vectors, and because of their small size, are a good candidate that should be embedded. </li><li>  <b>Solid color</b> : take the color from the image and use it as the background color for the Placeholder.  This may be the dominant color, the brightest ... The idea is that it is based on the loaded image and should help make the transition between ‚Äúno image‚Äù to image smoother. </li><li>  <b>Blurred image</b> : also called a blur technique.  You create a small version of the image, and then go to the full.  The initial image is small in both pixels and sizes.  To remove artifacts, the image is scaled and blurred.  I previously wrote about this in these articles, <a href="https://medium.com/%40jmperezperez/how-medium-does-progressive-image-loading-fd1e4dc1ee3d">How Medium does progressive image loading</a> , <a href="https://medium.com/%40jmperezperez/using-webp-to-create-tiny-preview-images-3e9b924f28d6">using images</a> . </li><li>  It turns out that there are many other options, and many smart people are developing other methods for creating Placeholders. </li></ul><br>  One of them is the use of gradients instead of solid colors.  Gradients can create a more accurate preview of the final image with minimal cost (payload increase). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/959/56f/047/95956f04740153bd0a381c6ee87ddab7.jpg" alt="image"></div><br>  <i>Use gradients as a background.</i>  <i>Screenshot from Gradify, which is no longer online.</i>  <i><a href="https://github.com/fraser-hemp/gradify">The code on github</a> .</i> <br><br>  Another method is to use image-based SVG. <br><br><h3>  SVG-based placeholder </h3><br>  We know that SVG is ideal for vector images.  In most cases, we want to load a bitmap image, so the question is how to vectorize the image.  Some options use outlines, shapes, and areas. <br><br><h4>  Contours </h4><br>  In a <a href="https://medium.com/%40jmperezperez/drawing-images-using-edge-detection-and-svg-animation-16a1a3676d3">previous post,</a> I explained how to recognize the outlines in an image and create an animation.  My initial goal was to try to draw areas, vectorizing the image, but I did not know how to do it.  I realized that the use of contours can also be innovative, and I decided to revive them, creating the effect of "drawing." <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/06/31/u1/0631u1uda_0-imtfcq-u5-03ga8.jpeg" alt="image"></div><br>  <a href="https://codepen.io/jmperez/pen/oogqdp">Codepen</a> <br><br>  <a href="https://medium.com/%40jmperezperez/drawing-images-using-edge-detection-and-svg-animation-16a1a3676d3">Drawing images using edge detection and SVG animation</a> <br><br><h4>  Forms </h4><br>  SVG can also be used to draw areas from an image without using contours / borders.  In a sense, we will vectorize the bitmap to create a Placeholder. <br><br>  I once tried to do something similar with triangles.  You can see the result in my conversations in <a href="https://jmperezperez.com/cssconfau16/">CSSConf</a> and <a href="https://jmperezperez.com/renderconf17/">Render Conf</a> . <br><br><img src="https://habrastorage.org/webt/_u/k_/cb/_uk_cb-xxsfq3_gynl6cszkq6ho.jpeg" alt="image"><br><br>  <a href="https://codepen.io/jmperez/pen/BmaWmQ">The codepen above</a> is proof of the SVG-based Placeholder concept, consisting of 245 triangles.  Triangle generation is based on the <a href="https://en.wikipedia.org/wiki/Delaunay_triangulation">Delaunay triangulation</a> using the <a href="https://github.com/possan/polyserver">Pissan polyserver.</a>  As expected, the more triangles used by SVG, the larger the file size. <br><br><h4>  Primitive and SQIP, SVG-based LQIP method </h4><br>  Tobias Baldauf is working on another method of poor image quality using SVG, called <a href="https://github.com/technopagan/sqip">SQIP</a> .  Before digging into SQIP, I will give an overview of <a href="https://github.com/fogleman/primitive">Primitive</a> , the library on which SQIP is based. <br><br>  Primitive is quite fascinating, and I definitely recommend you try it.  It converts a raster image to an SVG, consisting of overlapping shapes.  Its small size makes it suitable for imposing it directly on the page.  Another good option as well as a meaningful placeholder in the initial HTML download. <br><br>  Primitive generates an image based on such shapes as triangles, rectangles and circles (and several others).  At each step, he adds a new one.  The more steps, the resulting image looks closer to the original.  If you have SVG output, it also means that the size of the output code will be larger. <br><br>  To understand how Primitive works, I took it through a couple of images.  I generated the SVG for artwork using 10 shapes and 100 shapes: <br><br><img src="https://habrastorage.org/webt/9m/bi/cy/9mbicykyiodmef1kj31dp7bm54o.jpeg" alt="image"><br><br>  to pictures (Processing this image using Primitive, using 10 Shapes and 100 figures.) <br><br><img src="https://habrastorage.org/webt/9h/ny/vk/9hnyvklqdyjupc0u0dwccr_pm4w.jpeg" alt="image"><br><br>  When using 10 figures in the image, we begin to understand the original image.  In the context of placeholder'a images, it is possible to use this SVG as a placeholder'a.  In fact, the code for SVG with 10 figures is very small, about 1030 bytes, which drops to ~ 640 bytes when transferring the output via SVGO. <br><br> <code>&lt;path fill=‚Äù#817c70" d=‚ÄùM0 0h1024v1024H0z‚Äù/&gt;&lt;path fill=‚Äù#03020f‚Äù d=‚ÄùM178 994l580 92L402‚Äì62"/&gt;&lt;path fill=‚Äù#f2e2ba‚Äù d=‚ÄùM638 894L614 6l472 440"/&gt;&lt;path fill=‚Äù#fff8be‚Äù d=‚ÄùM-62 854h300L138‚Äì62"/&gt;&lt;path fill=‚Äù#76c2d9" d=‚ÄùM410‚Äì62L154 530‚Äì62 38"/&gt;&lt;path fill=‚Äù#62b4cf‚Äù d=‚ÄùM1086‚Äì2L498‚Äì30l484 508"/&gt;&lt;path fill=‚Äù#010412" d=‚ÄùM430‚Äì2l196 52‚Äì76 356"/&gt;&lt;path fill=‚Äù#eb7d3f‚Äù d=‚ÄùM598 594l488‚Äì32‚Äì308 520"/&gt;&lt;path fill=‚Äù#080a18" d=‚ÄùM198 418l32 304 116‚Äì448"/&gt;&lt;path fill=‚Äù#3f201d‚Äù d=‚ÄùM1086 1062l-344‚Äì52 248‚Äì148"/&gt;&lt;path fill=‚Äù#ebd29f‚Äù d=‚ÄùM630 658l-60‚Äì372 516 320"/&gt;</code> <br> <br>  Images generated with 100 figures are larger, as expected, weighing ~ 5K after SVGO (previously 8KB).  They have a high level of detail with a small payload.  The decision on how many triangles to use will depend largely on the type of image (for example, contrast, number of colors, complexity) and level of detail. <br><br>  One could create a script similar to <a href="https://github.com/technopagan/cjpeg-dssim">cpeg-dssim</a> , which changes the number of figures used until the threshold of <a href="https://en.wikipedia.org/wiki/Structural_similarity">structural similarity</a> is reached (or the maximum number of figures in the worst case). <br><br>  These SVGs are also great for use as background images.  Being limited in size and based on a vector, they are a good candidate for images of heroes and large backgrounds that would otherwise show artifacts. <br><br><h4>  SQIP </h4><br>  According <a href="https://github.com/technopagan/sqip">to Tobias</a> : <br><blockquote>  SQIP is an attempt to find a balance between these two extremes: using <a href="https://github.com/fogleman/primitive">Primitive</a> to generate an SVG consisting of several simple shapes that approximate the main objects visible inside the image optimizes the SVG using <a href="https://github.com/svg/svgo">SVGO</a> and adds a Gaussian Blur filter to it.  This produces an SVG placeholder that weighs only ~ 800-1000 bytes, looks smooth on all screens and provides a visual replica of the image content. </blockquote><br>  The result is similar to using a tiny Placeholder image for blur technology (as <a href="https://medium.com/%40jmperezperez/how-medium-does-progressive-image-loading-fd1e4dc1ee3d">Medium</a> and <a href="https://medium.com/%40jmperezperez/more-examples-of-progressive-image-loading-f258be9f440b">other sites do</a> ).  The difference is that instead of using a bitmap, such as JPG or WebP, the Placeholder is an SVG. <br><br>  If we run SQIP against the original images, we get the following: <br><br><img src="https://habrastorage.org/webt/cb/1f/kh/cb1fkhncpvrvjazo9326uiovibk.jpeg" alt="image"><br><br>  <i>Output images using SQIP for the <a href="">first</a> image and the <a href="">second one</a> .</i> <br><br>  The output SVG is ~ 900 bytes, and by checking the code, we can detect the <code>feGaussianBlur</code> filter applied to the group of shapes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lg/ur/by/lgurbywl39xslwdim2xq-ociqmm.jpeg" alt="image"></div><br>  SQIP can also output an image tag with the contents of the SVG Base 64 encoded: <br><br> <code>&lt;img width="640" height="640" src="example.jpg‚Äù alt="Add descriptive alt text" style="background-size: cover; background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAw‚Ä¶&lt;stripped base 64&gt;‚Ä¶PjwvZz48L3N2Zz4=);"&gt;</code> <br> <br><h4>  Silhouettes </h4><br>  We just looked at using SVG for contours and primitive shapes.  Another possibility is to vectorize images, ‚Äúdrawing‚Äù them.  A few days ago, <a href="https://twitter.com/mikaelainalem">Mikael Ainalem</a> shared a codepen'on, specifying how to use a 2-color silhouette as a placeholder.  The result is very beautiful: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/440/ae7/53a/440ae753a17ee8fe01dca4106f83cc6f.gif" alt="image"><br><br>  In this case, the SVGs were drawn manually, but the technique quickly generated integration with the tools for automating the process. <br><br><ul><li>  <a href="https://www.gatsbyjs.org/">Gatsby</a> , a static site generator that uses React, supports these traced SVGs now.  It uses the <a href="https://www.npmjs.com/package/potrace">JS PORT potrace</a> for image vectoring. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hz/ir/n1/hzirn1ela_wpreswj3ykq84xkyg.jpeg" alt="image"></div></li><li>  <a href="https://craftcms.com/">Craft 3 CMS</a> , which also added support for silhouettes.  It uses <a href="https://github.com/nystudio107/craft3-imageoptimize/blob/master/src/lib/Potracio.php">PHP Port of potrace</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h6/oz/bp/h6ozbpzcvpsedlyb6_06jgkw0s0.jpeg" alt="image"></div></li><li>  <a href="https://github.com/EmilTholin/image-trace-loader">image-trace-loader</a> , a webpack loader that uses potrace to process images. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m_/y7/bl/m_y7bln8jgnhjwfq8zl0silghys.jpeg" alt="image"></div></li></ul><br>  It is also interesting to see a comparison of the output between the Emil Webpack loader (based on potrace) and the hand-drawn SVG from Mikael. <br><br><div style="text-align:center;"> <a href="https://twitter.com/nemtsovy/status/920647706799955970/photo/1"><img src="https://habrastorage.org/webt/fv/5v/fp/fv5vfp1ak688gdx4wrqkc9x729m.jpeg" alt="image"></a> </div> <a href="https://twitter.com/nemtsovy/status/920647706799955970/photo/1"><br></a> <br>  I assume that the output generated by potrace uses default parameters.  However, they can be customized.  Check the <a href="https://github.com/EmilTholin/image-trace-loader">parameters for the Image-trace-loader</a> , which are mainly <a href="https://www.npmjs.com/package/potrace">passed to the potrace</a> . <br><br><h3>  Total </h3><br>  We considered various tools and methods for generating SVG from images and using them as a placeholder.  Also <a href="https://medium.com/%40jmperezperez/using-webp-to-create-tiny-preview-images-3e9b924f28d6">WebP is a fantastic format for thumbnails</a> , SVG is also an interesting format for use in place holders.  We can control the level of detail (and, therefore, size), it is very compressed and easily controlled with CSS and JS. <br><br><h3>  Additional resources </h3><br><ul><li>  <a href="https://github.com/Tw1ddle/geometrize-haxe">Geometrize</a> is a port of Primitive, written in Haxe.  There is also an <a href="https://github.com/Tw1ddle/geometrize-haxe-web">implementation on JS</a> , which you can try right in <a href="http://www.samcodes.co.uk/project/geometrize-haxe-web/">your browser</a> . </li><li>  <a href="">Primitive.js</a> , which is the port of Primitive in JS.  In addition, <a href="https://github.com/cielito-lindo-productions/primitive.nextgen">primitive.nextgen</a> , which is a port of the Primitive desktop application using Primitive.js and Electron. </li><li>  There are several Twitter accounts where you can see examples of images created using primitive and geometry.  See <a href="https://twitter.com/PrimitivePic">@PrimitivePic</a> and <a href="https://twitter.com/Geometrizer">@Geometrizer</a> . </li><li>  <a href="https://github.com/jankovicsandras/imagetracerjs">imagetracerjs</a> , which is a bitmap tracer and vectorizer written in JavaScript.  There are also ports for <a href="https://github.com/jankovicsandras/imagetracerjava">Java</a> and <a href="https://github.com/jankovicsandras/imagetracerandroid">Android</a> . </li></ul></div><p>Source: <a href="https://habr.com/ru/post/342848/">https://habr.com/ru/post/342848/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342834/index.html">PKCS # 11 Cryptographic Tokens: Managing and Accessing Token Objects (Continued)</a></li>
<li><a href="../342838/index.html">Sparse columns or sparse columns in MS SQL Server. Real experience</a></li>
<li><a href="../342840/index.html">Performance in all senses: how did DotNext 2017 Moscow go</a></li>
<li><a href="../342842/index.html">The internal structure and optimization of the webpack bundle</a></li>
<li><a href="../342846/index.html">ENOG'14 - the impact of content locks on the Internet infrastructure</a></li>
<li><a href="../342850/index.html">RxPM - reactive implementation of the Presentation Model pattern</a></li>
<li><a href="../342852/index.html">LiveXAML is a useful tool for Xamarin developer</a></li>
<li><a href="../342860/index.html">Startup history ROI4CIO: Is it possible to automate the sale of IT solutions in the B2B sector and not only?</a></li>
<li><a href="../342862/index.html">Should I use the tabular model SSAS?</a></li>
<li><a href="../342864/index.html">The second wave cnPilot</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>