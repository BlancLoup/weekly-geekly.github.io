<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Deploy crutches or surprise pies</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="To dig or not to dig? 
 I want to talk about what seemed to be a simple, but important part of any OS ‚Äî about the rules or file allocation structure o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Deploy crutches or surprise pies</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/c69/118/734/c691187342d485c0c61fff1e24ecc61b.jpg"><br><h5>  To dig or not to dig? </h5><br>  I want to talk about what seemed to be a simple, but important part of any OS ‚Äî about the rules or file allocation structure or more simply ‚Äî I want to talk about order and convenience.  I will address UNIX-like operating systems, and specifically the whole variety of distributions based on the Linux kernel. <br><a name="habracut"></a><br>  So, the programmer has created a program and wants to distribute it, now there is a task - installing the program by the user.  For this, it seems there are standards (FHS, LSB), but the variety of software installation tools just discourages the programmer, to the best of his abilities, implements installation tools, from a simple README to something more complex. <br>  Yes, today most distributions have a software installation system that, within the distribution package, solves software installation issues and, to some extent, makes it easier for a programmer.  And when it was necessary to manage a large group of different distributions (racks in data centers, VM) various configuration management systems were created (CFEngine, Bcfg2 puppet, Chef, etc).  And everything seems to be ok, but the feeling of being a bit of a crutch, of all this variety, has been around for 14 years (since the moment when RedHat Linux 5.2 started picking) does not leave me ... So what's the matter? <br><br><h5>  The roots </h5><br>  I will try to discard everything that is used today for installing / removing programs in a typical Linux distribution - I‚Äôll figure out what to do with the program, harder than helloworld, removing: <br><ul><li>  configuration management systems; </li><li>  package manager; </li><li>  all installation scripts, without exception, including those that perform preliminary actions such as creating directories to house libraries, resources, program documentation, compilation scripts, etc .; </li><li>  and even the README / INSTALL file. </li></ul><br>  What actions need to be performed now to install and then remove the program, along with all its components? <br>  Suppose I managed to figure out where the parts of the program should be located, created the necessary directories, copied the files, updated the environment, and the program now runs successfully. <br>  But time passed, I have long forgotten where and how the program components were located, I just remember the name of the program and I need to delete it along with all the components and files created by it.  And here I am at a dead end - what to do?  Set on strace and ldd?  Find all directories with the same name to remove the documentation?  In order to just remove the program and all its components?  And it's not a fact that everything will be found and deleted. <br>  So, if you do without curtsies, then the observed situation with installing / uninstalling programs in Linux is a well-disguised <s>bullshit</s> crap: <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/oQ6aVQxwerw%3Ffeature%3Doembed&amp;xid=17259,15700023,15700043,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhgYfciP_AeKQNH2KtB1WWn7B3WTUQ" frameborder="0" allowfullscreen=""></iframe><br><br><h5>  And what to do with it? </h5><br>  There is a simple install program that allows you to copy and set the necessary attributes on the files to be copied, however, the results of its work should be deleted with the usual rm. <br>  To launch any program and complete its execution, the functions <b>execve ()</b> and <b>_exit () are available</b> , in order to open the file and close it there are functions <b>open ()</b> / <b>create ()</b> and <b>close ()</b> .  In this case, when executing / stopping the program, the <b>process identifier</b> ( <b>PID</b> ) takes place, and when opening / closing the file, the file descriptor.  So why not to install / remove a program, something similar to the <b>program's deployment ID</b> , let's call it Deploy ID ( <b>DID</b> ) / Install ID ( <b>IID</b> ), which can actually be a standard UUID, providing several functions for operating with this identifier type <b>_appinstall ()</b> / <b>_appupdate ()</b> / <b>_appuninstall ()</b> / etc and the corresponding command type ps, for example app?  And why not to place the program with its components, let's say not in <br><pre><code class="bash hljs">/etc/program.conf /etc/program.conf.d/someone.conf /usr/bin/program /usr/lib/program/libprogram.so /usr/share/doc/program/manual.txt /var/program/database</code> </pre> <br>  and in <br><pre> <code class="bash hljs"> /etc/&lt;did&gt;/program.conf /etc/&lt;did&gt;/program.conf.d/someone.conf /usr/bin/&lt;did&gt;/program /usr/lib/&lt;did&gt;/libprogram.so /usr/docs/&lt;did&gt;/manual.txt /var/&lt;did&gt;/database</code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Yes, it will be another package manager, it can appear convenient GUI and configuration management systems will not go anywhere.  But!  Everything can go to POSIX, the placement of the program and its component can be done in a strict way, and removal becomes easy even if the database of identifiers is destroyed.  In addition, going through the file allocation structure, it will be possible to restore all identifiers by recreating the database, just as updatedb does by building an index for locate.  It is possible, simply enough, to install multiple versions or instances of a single program and switch between versions. <br>  If we go further, then it is reasonable to bring the configuration files of programs to some common denominator, unifying their contents using, for example, the same xml or json, but providing functions in the manner of <b>_appconfigdeploy ()</b> with the validation of the configuration for compliance with a predefined one, let's say in the same POSIX, schema. <br><br><h5>  Crackers dry or throw a fishing rod? </h5><br>  In general, there are distributions that seem to have moved towards unifying the placement of their component components and configuration files, such as <a href="http://www.gobolinux.org/">GoboLinux</a> (which seems to be no longer developed), and in my opinion, the closest package manager is <a href="http://nixos.org/nix/">nix</a> and the <a href="http://nixos.org/nixos/">NixOS</a> distribution based on it.  But I think we need a large-scale initiative, discussion, the same as for the FHS.  Unless of course I'm right at all. <br><br>  These are the pies. <br><br>  <sub>PS Once I raised a <a href="https://www.google.ru/search%3Fq%3Dsite%253Agentoo.ru%2BRNZ%2B%25D0%25A3%25D0%25BD%25D0%25B8%25D1%2584%25D0%25B8%25D0%25BA%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F%26oq%3Dsite%253Agentoo.ru%2BRNZ%2B%25D0%25A3%25D0%25BD%25D0%25B8%25D1%2584%25D0%25B8%25D0%25BA%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F%26sugexp%3Dchrome,mod%3D9%26sourceid%3Dchrome%26ie%3DUTF-8">discussion</a> on this topic in 2006, on the forum gentoo.ru.</sub> <br><br>  <b>UPD</b> : Immediately minus, ask yourself a question: <br>  would suit the programmer, say, the appearance of differences in the way the fork of the process, let's say in debian and redhat?  I think not (remembering about the platform).  So why is kostalizm in the form of different rules and approaches to installing programs is the norm? <br><br>  <b>UPD</b> : As can be seen from the <a href="http://www.linux.org.ru/forum/talks/8285744">comments</a> on LOR, the inability to deal with stereotypes is peculiar not only to hardened windows users, alas, I will add some <a href="http://www.linux.org.ru/forum/talks/8285744%3Fcid%3D8292141">explanation</a> : <br>  The scheme is distinguished by simple logic - one id for one copy of the package deployed into the system without destroying the already established and standardized basic file hierarchy (unlike nixos, in which the changes are excessively total, for example / usr / contains only / usr / bin / env -&gt; / nix / store / id-coreutils-version / bin / env, this is despite the fact that PM nix itself allows you to organize your trash bin under any distribution package in $ HOME, without affecting the main system at all). <br><br>  Actually obtained id acts as an identifier for all parts of the program, adding only one level in the file hierarchy for insignificant but convenient isolation of the program components from each other (including the same program in several versions), it is easier to control through the same id access rights to the program and its components. <br><br>  Of course, there are victims, the main one of which they don‚Äôt take, is the <b>human-readable path</b> (hrp) - in fact, all the misunderstanding is because of the hrp they see KISS and they are perplexed - why should the path to the program and its component become complicated, but there is nothing complicated here, take a look at fstab tezhe - why did you use label and uuid for mounting?  Yes, because I wanted convenience.  So I did try to get my comforts, though: <br><ul><li>  better control of the program, regardless of the presence / absence of turnips; </li><li>  be able to run several versions of the program, without steaming with prefix and slot; </li><li>  to be able to access parts of the program through the program name (just as we do it by jerking the function to call from a smart dialer, without trying to prescribe the initialization and dialing commands for the gsm module every time before it, without having to juggle tools, write alias, and edit environment variables. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/152841/">https://habr.com/ru/post/152841/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../152825/index.html">The global conspiracy of manufacturers on the example of Asus Transformer Infinity TF700</a></li>
<li><a href="../152831/index.html">Electronic cards for learning English words</a></li>
<li><a href="../152835/index.html">What technology stack to choose for a startup?</a></li>
<li><a href="../152837/index.html">‚ÄúGo there, I don‚Äôt know where and bring me something, I don‚Äôt know what‚Äù or ‚Äú5 Whys - like a cure for Muda‚Äù</a></li>
<li><a href="../152839/index.html">CBS: everything ingenious is simple, or How I acted in a Danish university</a></li>
<li><a href="../152845/index.html">Getting .NET metadata on the client using ajax</a></li>
<li><a href="../152847/index.html">KnockoutJS: stateful list filtering</a></li>
<li><a href="../152853/index.html">zfsonlinux - easy and simple</a></li>
<li><a href="../152855/index.html">A detailed review of the new generation MacBook Pro (with Retina display)</a></li>
<li><a href="../152857/index.html">Incubator live (under the lens of the ip-camera). And how we did it ...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>