<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Typical errors and not very</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The story tells how a series of simple mistakes took shape and turned into tangible troubles for one company. However, the company traded fraud and sp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Typical errors and not very</h1><div class="post__text post__text-html js-mediator-article">  The story tells how a series of simple mistakes took shape and turned into tangible troubles for one company.  However, the company traded fraud and spam, so maybe this is not bad. <br><a name="habracut"></a><br>  <i>Of course, all faces and events are fictional, but the author chose to remain anonymous from Tor :) The main character will be called the ‚Äúauthor‚Äù.</i> <br><br><h3>  Do not send spam.  Especially sms spam </h3><br>  It was an ordinary day.  The author once again received an sms-message from some kind of money delivery service.  We will call him Roskapital.  Suddenly, the author realized that it was enough for him, and decided to repay the spammer with the same coin. <br><br>  The author went to the site of the service, found a feedback form there and decided to provide there a flow of feedback requests.  A script was written that regularly sent requests, substituting random names, phone names and phone numbers, and then launched into regular work through a large proxy pool (it so happened that the author had such a proxy pool at hand). <br>  It is worth noting that when studying the site, the author realized that Roskapital is a typical financial pyramid. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Disable error output in the public (production) version of your service. </h3><br>  After some time, the author decided to review the logs of his script for a change.  Logs included server responses to sent feedback requests.  In the logs, the author noticed that for some time the server returned an error.  The essence of the error was the inability to access the Google document.  The error was kindly attached to the call stack, in which the Google account login and password was visible.  Obviously, RosCapital simply wrote down feedback requests in a Google document to which the account used was taken away or something like that. <br><br><h3>  If possible, use two-factor authentication for your accounts.  Do not use important accounts for automated access to various resources. </h3><br>  Using this username and password (and of course Tor), the author logged into this account.  The mail was mainly messages related to the work of the service - advertising orders, server payment, messages from the payment system.  Messages from the payment system interested the author most of all. <br><br><h3>  Payment systems must provide full two-factor payment protection. </h3><br>  On the website of the payment system, the author made a request for password recovery.  Both the new password and the new payment password were successfully sent to the mail.  That is, if the attacker gains access to the mail, then he gets both passwords and no two-factorness remains. <br>  After that, the author successfully exchanged most of the funds from the account for bitcoins. <br>  Soon the account owner changed the password. <br><br><h3>  Install updates and patches on time.  All your counterparties should do the same. </h3><br>  This happened during the discovery of the Heartbleed vulnerability in OpenSSL.  The author has already closed this vulnerability on the servers for which he was responsible, and decided to look for who has not yet closed it.  The author, of course, came to the very same service. <br>  Vulnerability was not closed there. <br>  A script was written that regularly tugged the RosCapital server and fished 64 KB out of its memory, and then it was launched into regular work (again through a proxy). <br><br><h3>  It is necessary to tie the session on the site to IP (although this may be other pitfalls) </h3><br>  After some time, an administrator session appeared in the logs. <br>  Using this session and setting the appropriate useragent in the browser, the author freely got into the admin area.  There he created a ‚Äúdeposit‚Äù for a large amount and immediately brought it into Bitcoins. <br>  Soon the admin panel began returning an error code of 403, apparently it was denied access over IP. <br><br><h3>  It happens that VPN reduces security (!) </h3><br>  Heartbleed vulnerability on that site was still not closed, and the script continued to collect data from server memory.  In particular, a piece of the nginx config was obtained. <br>  In the config it was clear that access to the admin panel is limited to a subnet of IP addresses.  After a thorough search on the network, the author found out that there is a VPN service that uses several IPs from this subnet. <br>  The author purchased access to this VPN and ... again got into the admin area and again brought some amount of money into Bitcoins. <br>  After that, access to the admin panel was limited to one specific IP, and soon the Heartbleed vulnerability itself was closed. <br><br><h3>  About banal: write a safe code </h3><br>  The author could not stop and decided to just look for vulnerabilities in the service. <br>  As a result, a URL resource was found that simply read and gave the contents of the file, the name of which was passed in the request to the resource. <br>  The vulnerability was essentially blind, i.e.  it was possible to find interesting files only at random. <br><br><h3>  FreeBSD has a feature that potentially reduces its security compared to Linux (!) </h3><br>  But FreeBSD came to the rescue.  On FreeBSD, you can read the directory as a file.  At the same time, an entry about the directory from the file system is given - all files and subdirectories are visible there. <br>  So the study of the file structure has become much more interesting.  However, the author could not find anything tasty.  Upload your files was not possible.  Requisites of access to the database were found, but it was impossible to connect to the database.  PHPMyAdmin was only on a separate subdomain that was password protected. <br><br><h3>  Clear text passwords are always evil </h3><br>  However, as a result, a control script (shell) was found on the server, the password to which was specified directly in its code in clear text. <br>  The author, using this shell, immediately left his bookmarks in different places of the service code.  The touch utility helped change the timestamps of changed files in order to make it more difficult to detect bookmarks. <br>  Then there was the matter of technology.  The access keys to the API of payment systems were retrieved from the database, from which all funds were then safely merged and transferred to bitcoins. <br><br>  After that, the author, through the API, observed how all the funds received by the payment systems were transferred to other wallets every few minutes.  Obviously, the owners of the service tried to save as much money as possible.  In general, it was quite a popular financial pyramid, and incoming transfers went constantly.  Soon, RosCapital stopped its work.  In principle, this was in any case their goal, but the author clearly seriously reduced the amount of their funds.  To understand the scale - the amount of stolen funds was about 140-150 BTC.  Finding out the BTC course at that time is certainly not difficult for readers. <br><br>  Since then, the fictional author of this fictional story has been tormented by the question: Is it good to steal from scammers, especially given that scammers eventually got money from people who are guilty only of believing in fairy tales? </div><p>Source: <a href="https://habr.com/ru/post/257877/">https://habr.com/ru/post/257877/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../257865/index.html">Z-monitor: monitoring and control of government orders</a></li>
<li><a href="../257867/index.html">DIY Robot Vacuum Cleaner</a></li>
<li><a href="../257869/index.html">MyBatis and OSGi</a></li>
<li><a href="../257871/index.html">MBLT15: A week before the international mobile conference</a></li>
<li><a href="../257875/index.html">Thoughts on the ideal programming language</a></li>
<li><a href="../257879/index.html">How ‚ÄúRussian hackers‚Äù tried to learn about new sanctions against Russia: we study CVE-2015-1701</a></li>
<li><a href="../257881/index.html">Analysis of accounts of one (not) reliable email-service</a></li>
<li><a href="../257883/index.html">Comparative analysis of HL7 and openEHR</a></li>
<li><a href="../257885/index.html">Courses on ethical hacking and penetration testing: updated program</a></li>
<li><a href="../257887/index.html">Python nightmares: the implicit `this`</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>