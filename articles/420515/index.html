<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Diarization based on GMM-UBM model and MAP adaptation algorithm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr. I would like to talk about one of the approaches in solving the problem of diarization of announcers and show how this method can be impleme...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Diarization based on GMM-UBM model and MAP adaptation algorithm</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr.  I would like to talk about one of the approaches in solving the problem of diarization of announcers and show how this method can be implemented in python.  In order not to scare away the reader, I will not give complex mathematical formulas (partly because I myself am ‚Äúnot a real welder‚Äù), but I will try to explain everything in simple language and tell everything so that the developer has never come across machine learning. <br><a name="habracut"></a><br>  In preparing to write this article, I chose between two presentation options: for those who are already familiar with Data Science and those who simply program well.  In the end, I chose the second option, deciding that this would be a good demonstration of the capabilities of DS. <br><br><h3>  Formulation of the problem </h3><br>  As Wikipedia <a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25B8%25D0%25B0%25D1%2580%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">tells</a> us, diarization is the process of dividing an incoming audio stream into homogeneous segments according to the audio stream belonging to one or another speaker.  In other words, the record should be divided into pieces and numbered: here in these places one person says, but in these places another.  From the point of view of machine learning, this kind of tasks belong to the class of education without a teacher and are called clustering.  About what clustering methods exist, for example <a href="https://habr.com/post/101338/">,</a> you can read <a href="https://habr.com/post/101338/">here</a> or <a href="https://habr.com/company/ods/blog/325654/">here</a> , but I will only seed those that will be useful to us - this is a Gaussian Mixture Model and Spectral Clustering.  But about them a bit later. <br>  Let's start from the beginning. <br><br><h3>  Environment preparation </h3><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  I was not sure whether to leave this section - I didn‚Äôt want to turn the article into a very tutorial.  But in the end left.  Who does not need, he will miss, and for those who will do everything from scratch, this step will facilitate the start. <br></div></div><br>  Generally speaking, besides R, the python language is the main one in solving Data Science problems, and if you have not tried programming on it, I highly recommend it, because python allows you to do many things elegantly, literally in a few lines (by the way, there are even such a meme). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are two separately developing branches of python - versions 2 and 3. In my examples, I used version 3.6, but if you like, you can easily port them to version 2.7.  It is convenient to deploy any of these branches together with the <a href="https://www.anaconda.com/download/">Anaconda</a> installer, having installed which you immediately get an interactive shell for development - IPython. <br><br>  In addition to the development environment itself, additional libraries will be needed: librosa (for working with audio and extracting features), webrtcvad (for segmentation), and pickle (for writing trained models to a file).  All of them are installed by a simple team in Anaconda Prompt <br><br><pre><code class="hljs sql">pip <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">library</span></span>]</code> </pre> <br><h3>  Feature Extraction </h3><br>  We begin by extracting the traits ‚Äî the data the machine learning models will work with.  In principle, the audio signal itself is already data, namely an ordered array of sound amplitude values, to which is added a header containing the number of channels, the sampling frequency, and other information.  But we will not be able to analyze this data directly, since they do not contain such things, looking at which, our model can say - aha, these pieces belong to the same person. <br><br>  There are several approaches to feature extraction in speech processing tasks.  One of them is to obtain chalk-frequency cepstral coefficients (Mel Frequency Cepstral Coefficients).  We have <a href="https://habr.com/post/140828/">already</a> <a href="https://habr.com/post/226143/">written</a> about them here, so I‚Äôll just slightly remind you. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fg/dn/w-/fgdnw-m6jhpjb7b1wbj1xevahps.png" alt="image"></div><br>  The original signal is cut into frames with a length of 16-40 ms.  Next, applying the <a href="http://www.dsplib.ru/content/win/win.html">Hamming</a> window to the frame, we make a fast Fourier transform and obtain the power spectral density.  Then, a special ‚Äúcomb‚Äù of filters located evenly along the chalk scale makes a chalk spectrogram, to which a discrete cosine transform (DCT), a widely used data compression algorithm, is applied.  The coefficients obtained in this way are a kind of compressed frame characteristic, and since the filters we used were located in the <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D0%25BB_(%25D0%25B2%25D1%258B%25D1%2581%25D0%25BE%25D1%2582%25D0%25B0_%25D0%25B7%25D0%25B2%25D1%2583%25D0%25BA%25D0%25B0)">chalk</a> scale, the coefficients carry more information in the human ear‚Äôs perception range.  Typically, 13 to 25 MFCC per frame is used.  Since, in addition to the spectrum itself, the personality of the voice is shaped by speed and acceleration, MFCC is combined with the first and second derivatives. <br><br>  In general, MFCC is the most common way of working with speech, but besides them there are other signs - LPC (Linear Predictive Coding) and PLP (Perceptual Linear Prediction), and sometimes you can also find LFCC, where instead of chalk-scale linear is used. <br><br>  Let's see how to extract MFCC in python. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> librosa mfcc=librosa.feature.mfcc(y=y, sr=sr, hop_length=int(hop_seconds*sr), n_fft=int(window_seconds*sr), n_mfcc=n_mfcc) mfcc_delta=librosa.feature.delta(mfcc) mfcc_delta2=librosa.feature.delta(mfcc, order=<span class="hljs-number"><span class="hljs-number">2</span></span>) stacked=np.vstack((mfcc, mfcc_delta, mfcc_delta2)) features=stacked.T <span class="hljs-comment"><span class="hljs-comment">#librosa   MFCC   ,       .</span></span></code> </pre><br>  As you can see, this is really done in just a few lines.  We now turn to the first clustering algorithm. <br><br><h3>  Gaussian Mixture Model </h3><br>  The model of a mixture of Gaussian distributions assumes that our data are a mixture of multidimensional Gaussian distributions with certain parameters. <br><br>  If you wish, you can easily find both a detailed description of the model and how the <a href="https://ru.wikipedia.org/wiki/EM-%25D0%25B0%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC">EM algorithm</a> that teaches this model works, but I promised not to cause melancholy with complex formulas and therefore I will show beautiful examples from <a href="https://jakevdp.github.io/PythonDataScienceHandbook/05.12-gaussian-mixtures.html">this</a> article. <br><br>  Generate four clusters and draw them. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.datasets.samples_generator <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> make_blobs X, y_true=make_blobs(n_samples=<span class="hljs-number"><span class="hljs-number">400</span></span>, centers=<span class="hljs-number"><span class="hljs-number">4</span></span>, cluster_std=<span class="hljs-number"><span class="hljs-number">0.60</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>) plt.scatter(X[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]);</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/px/my/d7/pxmyd7covni39hf8fq19684nrv0.png" alt="image"></div><br>  We will create a model, train it on our data and again draw points, but already taking into account the predicted model of belonging to clusters. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.mixture <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GaussianMixture gmm = GaussianMixture(n_components=<span class="hljs-number"><span class="hljs-number">4</span></span>) gmm.fit(X) labels=gmm.predict(X) plt.scatter(X[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X[:, <span class="hljs-number"><span class="hljs-number">1</span></span>], c=labels, s=<span class="hljs-number"><span class="hljs-number">40</span></span>, cmap=<span class="hljs-string"><span class="hljs-string">'viridis'</span></span>);</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n0/2y/6n/n02y6nz_1nw3krhnatqj_qf5o9k.png" alt="image"></div><br>  The model coped well with artificial data.  In principle, by adjusting the number of components of the mixture and the type of the covariance matrix (the number of degrees of freedom of Gaussians), one can describe rather complex data. <br><br><img src="https://habrastorage.org/webt/ni/je/-m/nije-mrfqiykrrfykphnafbyr5w.png" alt="image"><br><br>  So, we know how to do parameterization of data and know how to train a model of a mixture of Gaussian distributions.  Now one could try to do head-on clustering - teaching GMM on the MFCC extracted from the dialogue.  And, probably, in some ideal spherical-vacuum dialogue, in which each speaker will fit into his Gaussian, we will get a good result.  It is clear that in reality this will never happen.  In fact, with the help of GMM, it is not the dialogue that is being modeled, but each person in the dialogue ‚Äî that is, they represent that each speaker‚Äôs voice in the extracted features is described by his own set of Gaussians. <br>  Summing up, we slowly get to the main topic. <br><br><h3>  Segmentation </h3><br>  Traditionally, the diarization process consists of three consecutive blocks - voice detection (Voice Activity Detection), segmentation and clustering (there are models in which the last two steps are combined, see <a href="https://www.researchgate.net/publication/258936008_The_LIA-EURECOM_RT09_Speaker_Diarization_System">LIA E-HMM</a> ). <br><br>  In the first step, speech is separated from various kinds of noise.  The VAD algorithm determines whether a piece of audio filed on it is a speech, or if, for example, a siren sounds or someone sneezes.  It is clear that in order for such an algorithm to be of high quality, training with a teacher is necessary.  And this in turn means that it is necessary to mark up the data - in other words, to create a database with records of speech and all sorts of noise.  We will act lazily - take ready <a href="https://github.com/wiseman/py-webrtcvad">VAD</a> , which does not work perfectly, but for the beginning we have enough. <br><br>  The second block cuts data into segments with one active speaker.  The classical approach in this regard is the algorithm for determining the change of speaker based on the Bayesian information criterion - <a href="https://en.wikipedia.org/wiki/Bayesian_information_criterion">BIC</a> .  The essence of this method is as follows: a sliding window traverses audio recordings and at each point of the passage answers the question: ‚ÄúHow are the data in this place better described - in one distribution or two?‚Äù.  To answer this question, the parameter is calculated. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>B</mi><mi>I</mi><mi>C</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.053ex" height="2.057ex" viewBox="0 -780.1 4759 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-44" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-65" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6C" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="1843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-61" x="2205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-42" x="2734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-49" x="3494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-43" x="3998" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>B</mi><mi>I</mi><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ Delta BIC </script>  , based on the sign of which the decision is made to change the speaker.  The problem is that this method will not work very well in case of a frequent change of announcer, and even in the presence of noise (which is very characteristic for recording a telephone conversation). <br><br><div class="spoiler">  <b class="spoiler_title">A little explanation</b> <div class="spoiler_text">  In the original, I worked with telephone call center recordings with an average duration of about 4 minutes.  For obvious reasons, I cannot post these recordings, so for the demonstration I took a <a href="">recording of</a> an interview from one radio station.  In the case of a long interview, this method would probably give an acceptable result, but it did not work on my data. <br></div></div><br>  In conditions when the speakers do not interrupt each other, and their voices do not overlap each other, the VAD, which we will use, more or less copes with the task of segmentation, so the first two steps will look like this. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  y_, sr = librosa.load('data/2018-08-26-beseda-1616.mp3', sr=SR) #   pre-emphasis:    pre_emphasis = 0.97 y = np.append(y[0], y[1:] - pre_emphasis * y[:-1]) #       webrtcvad    vad = webrtcvad.Vad(2) #  VAD audio = np.int16(y/np.max(np.abs(y)) * 32767) frames = frame_generator(10, audio, sr) frames = list(frames) segments = vad_collector(sr, 50, 200, vad, frames) if not os.path.exists('data/chunks'): os.makedirs('data/chunks') for i, segment in enumerate(segments): chunk_name = 'data/chunks/chunk-%003d.wav' % (i,) # vad      ,     write_wave(chunk_name, segment[0: len(segment)-int(100*sr/1000)], sr)</span></span></code> </pre><br>  In fact, people will certainly talk at the same time.  Moreover, VAD in some places blundered, due to the fact that the recording is not live, but is a gluing, in which pauses are cut.  You can try to repeat the cutting into segments, increasing the aggressiveness of VAD from 2 to 3. <br><br><h3>  GMM-UBM </h3><br>  Now we have separate segments, and we decided that we would be using GMM to model each speaker.  We will extract the signs from the segment and use this data to train the model.  We will do so on each segment and the resulting models are comparable.  It is justified to expect that models trained in segments belonging to the same person will be somehow similar.  But here we are faced with the following problem, extracting signs from an audio file of 1 sec length with a sampling frequency of 8000 Hz with a window size of 10 ms, we get a set of 800 MFCC vectors.  On such data, our model will not be able to learn, because it is negligible.  Even if it is not one second, but ten, the data will still not be enough.  And here the Universal Background Model (UBM) comes to the rescue, it is also called the speaker-independent.  The idea is as follows.  We will train GMM on a large sample of data (in our case, this is a complete recording of the interview) and we will get the acoustic model of a generalized announcer (this will be our UBM).  And then, using a special adaptation algorithm (about it a little lower), we will ‚Äúfit‚Äù this model to the characteristics extracted from each segment.  This approach is widely used not only for diarization, but also in voice recognition systems.  To recognize a person by voice, you first need to train a model on it and, without UBM, you would need to have several hours to record this person‚Äôs speech. <br><br>  From each adapted GMM, we extract a vector of shear coefficients. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ mu </script>  (he is a median or a mat. wait, if you will) and, based on the data on these vectors from all segments, we will do the clustering (below it will be clear why the shift vector is the one). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8o/v1/gc/8ov1gcun9ic5sqshic7fvlg09wo.png" alt="image"></div><br><h3>  MAP Adaptation </h3><br>  The method by which we will customize UBM for each segment is called Maximum A-Posteriori Adaptation.  In general, the algorithm is as follows.  First, the posterior probability on the adaptation data and <a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25BE%25D1%2581%25D1%2582%25D0%25B0%25D1%2582%25D0%25BE%25D1%2587%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2581%25D1%2582%25D0%25B0%25D1%2582%25D0%25B8%25D1%2581%25D1%2582%25D0%25B8%25D0%25BA%25D0%25B0">sufficient statistics</a> for the weight, median and variance of each Gaussian are calculated.  Then the statistics obtained are combined with the UBM parameters and the parameters of the adapted model are obtained.  In our case, we will only adapt the median, without affecting the other parameters.  Despite the fact that I promised not to delve into mathematics, I‚Äôll give you three formulas, because MAP adaptation is the key point in this article. <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>P</mi><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.446ex" height="3.021ex" viewBox="0 -883.9 13969.9 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="1044" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-3D" x="1360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-66" x="2666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-72" x="3217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-61" x="3668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-63" x="4198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-31" x="4631" y="0"></use><g transform="translate(5132,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-73" x="6327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-75" x="6796" y="0"></use><g transform="translate(7369,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-4E" x="1242" y="488"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-31" x="1140" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-50" x="9507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-72" x="10259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-28" x="10710" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="11100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-7C" x="11445" y="0"></use><g transform="translate(11724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-29" x="12652" y="0"></use><g transform="translate(13041,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>P</mi><mi>r</mi><mo stretchy="false">(</mo><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> E_ {i} = \ frac {1} {n_ {i}} \ sum_ {t = 1} ^ NPr (i | x_ {t}) x_ {t} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.817ex" height="2.66ex" viewBox="0 -832 16713 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="1356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6D" x="1967" y="0"></use><g transform="translate(2846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-3D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-62" x="5346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-65" x="5776" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="6242" y="0"></use><g transform="translate(6604,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="748" y="-213"></use></g><g transform="translate(7478,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="1044" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2B" x="8783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-28" x="9783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-31" x="10173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2212" x="10896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-62" x="12146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-65" x="12576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="13042" y="0"></use><g transform="translate(13404,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-29" x="14278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6D" x="14917" y="0"></use><g transform="translate(15796,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ hat \ mu_ {i} = \ beta_ {i} E_ {i} + (1- \ beta_ {i}) \ mu_ {i} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>+</mo><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.627ex" height="3.021ex" viewBox="0 -987.6 10172.5 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="1146" y="0"></use><g transform="translate(1507,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-3D" x="2659" y="0"></use><g transform="translate(3715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2F" x="4660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-28" x="5160" y="0"></use><g transform="translate(5550,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2B" x="6717" y="0"></use><g transform="translate(7717,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-62" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-65" x="783" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="1249" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-61" x="1611" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-29" x="9783" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mo>+</mo><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ beta_ {i} = n_ {i} / (n_ {i} + r ^ {\ beta}) </script></p><br>  Here <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.208ex" height="2.66ex" viewBox="0 -832 3534.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-72" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-28" x="1203" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="1592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-7C" x="1938" y="0"></use><g transform="translate(2216,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-29" x="3144" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mi>r</mi><mo stretchy="false">(</mo><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6"> Pr (i | x_ {t}) </script>  - a posteriori probability <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.515ex" height="2.419ex" viewBox="0 -780.1 1082.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="1044" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-7"> E_ {i} </script>  - sufficient statistics for <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> \ mu </script>  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.739ex" height="2.419ex" viewBox="0 -780.1 3762.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="1356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6D" x="1967" y="0"></use><g transform="translate(2846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-9"> \ hat \ mu_ {i} </script>  - median of the adapted model, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.531ex" height="2.419ex" viewBox="0 -780.1 2381.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="1146" y="0"></use><g transform="translate(1507,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-69" x="748" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-10"> \ beta_ {i} </script>  - coefficient of adaptation, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.796ex" height="2.419ex" viewBox="0 -935.7 2065.1 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-62" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-65" x="783" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-74" x="1249" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-61" x="1611" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-11"> r ^ {\ beta} </script>  - Compliance factor. <br>  If all this seems rubbish and causes despondency - do not despair.  In fact, to understand the operation of the algorithm, it is not necessary to delve into these formulas, its work can be easily demonstrated by the following example: <br><br><img src="https://habrastorage.org/webt/rj/fg/st/rjfgstiekke6cv1m8zc-d6s4kji.png" alt="image"><br><br>  Suppose we have some fairly large data, and we have trained on them UBM (left figure, UBM is a two-component mixture of Gaussian distributions).  There are new data that do not fit into our model (figure in the middle).  Using this algorithm, we will shift the Gaussian centers so that they fit into the new data (figure on the right).  Applying this algorithm on experimental data, we would expect that on segments with the same speaker Gaussians will shift in the same direction, thus forming clusters.  That is why for clustering segments we will use the data about the shift <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> \ mu </script>  . <br><br>  So let's do a MAP adaptation for each segment.  (For reference: besides MAP Adaptation, the MLLR - Maximum Likelihood Linear Regression method and some modifications are widely used. Also try to combine these two methods.) <br><br><pre> <code class="python hljs">SV = [] <span class="hljs-comment"><span class="hljs-comment">#    chunk-000  chunk-100 for i in range(101): clear_output(wait=True) fname='data/chunks/chunk-%003d.wav' % (i,) print('UBM MAP adaptation for {0}'.format(fname)) y_, sr_ = librosa.load(fname, sr=None) f_ = extract_features(y_, sr_, window=N_FFT, hop=HOP_LENGTH, n_mfcc=N_MFCC) f_ = preprocessing.scale(f_) gmm = copy.deepcopy(ubm) gmm = map_adaptation(gmm, f_, max_iterations=1, relevance_factor=16) sv = gmm.means_.flatten() #   sv = preprocessing.scale(sv) SV.append(sv) SV = np.array(SV) clear_output() print(SV.shape)</span></span></code> </pre><br>  Now that for each segment we have data on <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMATHI-75" x="1128" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> \ mu </script>  , we finally go to the final step. <br><br><h3>  Spectral clustering </h3><br>  Spectral clustering is briefly described in the article, the link to which I gave at the very beginning.  The algorithm builds a complete graph, where the vertices are our data, and the edges between them are a measure of similarity.  In voice recognition tasks, the cosine metric is used as such a measure, since it takes into account the angle between the vectors, ignoring their magnitude (which does not carry information about the speaker).  By constructing a graph, the eigenvectors of the Kirchhoff matrix (which is essentially a representation of the graph obtained) are calculated and then some standard clustering method is used, for example, the k-means method.  All this keeps within two lines of code. <br><br><pre> <code class="python hljs">N_CLUSTERS = <span class="hljs-number"><span class="hljs-number">2</span></span> sc = SpectralClustering(n_clusters=N_CLUSTERS, affinity=<span class="hljs-string"><span class="hljs-string">'cosine'</span></span>) labels = sc.fit_predict(SV) <span class="hljs-comment"><span class="hljs-comment">#     , . [2,1,1,0,2] labels = rearrange(labels, N_CLUSTERS) #     [0,1,1,2,0] print(labels) #   , ,  1 -  .     print([i for i, x in enumerate(labels) if x == 1])</span></span></code> </pre><br><h3>  Conclusions and future plans </h3><br>  The described algorithm was tested with various parameters: <br><br><ol><li>  Number of MFCC: 7, 13, 20 </li><li>  MFCC in combination with LPC </li><li>  Type and number of mixtures in GMM: full [8, 16, 32], diag [8, 16, 32, 64, 256] </li><li>  UBM adaptation methods: MAP (with covariance_type = 'full') and MLLR (with covariance_type = 'diag') </li></ol><br>  As a result, the parameters remained subjectively optimal: MFCC 13, GMM covariance_type = 'full' n_components = 16. <br><br>  Unfortunately, I didn‚Äôt have the patience (I started writing this article more than a month ago) in order to mark up the received segments and calculate the DER (Diariztion Error Rate).  Subjectively, I rate the work of the algorithm as ‚Äúin principle not bad, but far from ideal‚Äù.  By clustering on vectors derived from the first hundred segments (with one MAP pass), and then highlighting those where the interviewer speaks (the girl, she speaks much less guest there), clustering produces a list <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>25</mn><mo>,</mo><mn>26</mn><mo>,</mo><mn>46</mn><mo>,</mo><mn>48</mn><mo>,</mo><mn>49</mn><mo>,</mo><mn>61</mn><mo>,</mo><mn>85</mn><mo>,</mo><mn>86</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.523ex" height="2.66ex" viewBox="0 -832 13572.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-31" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-32" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2C" x="1724" y="0"></use><g transform="translate(2169,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-35" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2C" x="3170" y="0"></use><g transform="translate(3616,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2C" x="4617" y="0"></use><g transform="translate(5062,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-34"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2C" x="6063" y="0"></use><g transform="translate(6508,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-34"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-38" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2C" x="7509" y="0"></use><g transform="translate(7954,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-34"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-39" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2C" x="8955" y="0"></use><g transform="translate(9400,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-31" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2C" x="10401" y="0"></use><g transform="translate(10846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-38"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-35" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-2C" x="11847" y="0"></use><g transform="translate(12292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-38"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/420515/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhheo5-QuaQN8vJ4dyoBIlyeDfvqyg#MJMAIN-5D" x="13293" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>25</mn><mo>,</mo><mn>26</mn><mo>,</mo><mn>46</mn><mo>,</mo><mn>48</mn><mo>,</mo><mn>49</mn><mo>,</mo><mn>61</mn><mo>,</mo><mn>85</mn><mo>,</mo><mn>86</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-14"> [1, 2, 25, 26, 46, 48, 49, 61, 85, 86] </script>  that is 100% hit.  In this case, there are segments where both speakers are present (for example, 14), but this can already be blamed on the VAD error.  Moreover, such segments begin to count with an increase in the number of MAP passes.  An important point.  Interviews with which we worked - more or less ‚Äúclean‚Äù.  If various musical inserts, noises and other non-speech things are added, clustering starts to limp.  Therefore, plans to try to train your own VAD (because webrtcvad, for example, does not separate music from speech). <br><br>  Due to the fact that I initially worked with a telephone conversation, I did not need to estimate the number of announcers.  But the number of announcers is not always predetermined, even if it is an interview.  For example, in <a href="">this</a> interview in the middle there is an announcement superimposed on the music, and voiced by an additional two people.  Therefore, it would be interesting to try the method for estimating the number of announcers indicated in the first article in the section of the list of references (based on the analysis of the eigenvalues ‚Äã‚Äãof the normalized Laplace matrix). <br><br><h3>  Bibliography </h3><br>  In addition to the materials located on the links in the text and Jupyter laptops, the following sources were used to prepare this article: <br><br><ol><li>  Speaker Diarization using GMM Supervector and Advanced Reduction Algorithms.  Nurit spingarn </li><li>  Feature Extraction Methods LPC, PLP and MFCC In Speech Recognition.  Namrata dave </li><li>  MAP estimation for mulivariate gaussian mixture of observations of markov chains.  Jean-Luc Gauvain and Chin-Hui Lee </li><li>  On Spectral Clustering Analysis and an algorithm.  Andrew Y. Ng, Michael I. Jordan, Yair Weiss </li><li>  Speaker recognition using YOHO database.  Alexandre Majetniak </li></ol><br>  I also add some diarrhea projects: <br><br><ol><li>  <a href="https://projets-lium.univ-lemans.fr/sidekit/">Sidekit</a> and <a href="https://projets-lium.univ-lemans.fr/sidekit/">diarization</a> extension for <a href="https://projets-lium.univ-lemans.fr/s4d/">s4d</a> .  Python library for speech.  Unfortunately, the documentation leaves much to be desired. </li><li>  <a href="https://pypi.org/project/bob/">Bob</a> and its different parts like <a href="https://pypi.org/project/bob.bio.base/">bob.bio</a> , <a href="https://pypi.org/project/bob.learn.em/">bob.learn.em</a> is a python library for signal processing and working with biometric data.  Windows is not supported. </li><li>  <a href="http://www-lium.univ-lemans.fr/diarization/doku.php/welcome">LIUM</a> is a turnkey solution written in Java. </li></ol><br>  All the code is laid out on the <a href="https://github.com/fedderrico/ubm_map_diarization">githaba</a> .  For convenience, I made several Jupyter laptops with a demonstration of individual items - MFCC, GMM, MAP Adaptation and Diarization.  In the latter is the main process.  Also in the repository are pickle files with some pre-trained models and the interview itself. </div><p>Source: <a href="https://habr.com/ru/post/420515/">https://habr.com/ru/post/420515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420505/index.html">Will OpenAI Five win the professional team at The International?</a></li>
<li><a href="../420507/index.html">Reference: global Internet for all and its creators</a></li>
<li><a href="../420509/index.html">Unobvious problem of using assert</a></li>
<li><a href="../420511/index.html">Work as an IT specialist in the Far East - Amur Region</a></li>
<li><a href="../420513/index.html">Pirated copy of paid service in 39 lines of Python code</a></li>
<li><a href="../420517/index.html">Implementation of integer FFT on the FPGA</a></li>
<li><a href="../420519/index.html">Popularization of science</a></li>
<li><a href="../420521/index.html">Now officially: TLS 1.3 is recognized as standard</a></li>
<li><a href="../420523/index.html">Analysis of binary options charts or how I once again proved to myself that freebies do not exist</a></li>
<li><a href="../420525/index.html">Networks for the harshest. Part fifteen. QoS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>