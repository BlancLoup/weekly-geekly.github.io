<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Build FreeType library for Android x86 using NDK</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="FreeType is a free low-level font library. It is written in ANSI C and is used in a huge number of known projects. In Android, for example. But Androi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Build FreeType library for Android x86 using NDK</h1><div class="post__text post__text-html js-mediator-article">  FreeType is a free low-level font library.  It is written in ANSI C and is used in a huge number of known projects.  In Android, for example.  But Android applications do not have direct access to this library.  Therefore, if you want to use it in your own project, FreeType will need to be built for the platform you are interested in.  We will build it for the x86 platform using <a href="http://developer.android.com/tools/sdk/ndk/index.html">NDK</a> tools. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/2e0/6e4/307/2e06e43077d24682a2bd0144f2a1f442.png"></div><a name="habracut"></a><br>  NDK, in addition to building libraries for Android, has other useful features.  For example, it can be used to write mobile applications in C and C ++, it also supports many utility functions, such as automatically creating build files and working with the project structure. <br><br>  You can build libraries for Android in different ways.  For example, using the automatic assembly system NDK.  Another option is the cross-compilation tools from Cygwin and a separate set of NDK tools. <br><br>  <a href="https://software.intel.com/en-us/blogs/2015/06/26/building-android-middleware-libraries-for-x86-devices-using-the-android-ndk">Here</a> you can find a list of Android libraries that support the x86 platform.  And in this article we will describe how, using the <a href="https://eclipse.org/">Eclipse</a> IDE, to organize the automatic NDK-assembly of the FreeType library. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  <font color="#0071c5">Setting up the project and build the library</font> </h2><br>  Create a new Android application project in Eclipse and add the jni folder to it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf5/f6a/55c/bf5f6a55c01f3f458049b233ae6e54b4.gif"></div><br>  <i><font color="#999999">Jni folder in a new Android application project</font></i> <br><br>  Now let's download the archive with the <a href="http://sourceforge.net/projects/freetype/files/freetype2">FreeType</a> library code.  In our case, this is version 2.6.  Extract the archive to the jni folder. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f93/c1b/f4c/f93c1bf4c21121db8569e1693f388a55.png"></div><br>  <i><font color="#999999">FreeType source code in jni folder</font></i> <br><br>  Now we‚Äôll add the Android.mk and Application.mk files to the application project.  These files should be located in the jni folder.  Adroid.mk is the GNU makefile that the build system handles.  This file contains information about the files with the source code of the application and the external libraries required for building the project. <br><br>  <a href="https://developer.android.com/ndk/guides/android_mk.html">Here</a> you can find details about the syntax of Android.mk and about the features of building Android applications written in C and C ++.  Create this file in the jni folder, it is designed to build the FreeType library with all the supported font formats. <br><br>  <i>Android.mk file</i> <br><br><pre><code class="hljs ruby">LOCAL_PATH <span class="hljs-symbol"><span class="hljs-symbol">:</span></span>= $(call my-dir) <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> $(CLEAR_VARS) FREETYPE_SRC_PATH <span class="hljs-symbol"><span class="hljs-symbol">:</span></span>= LOCAL_MODULE <span class="hljs-symbol"><span class="hljs-symbol">:</span></span>= freetype LOCAL_CFLAGS <span class="hljs-symbol"><span class="hljs-symbol">:</span></span>= -DANDROID_NDK \   -DFT2_BUILD_LIBRARY=<span class="hljs-number"><span class="hljs-number">1</span></span> LOCAL_C_INCLUDES <span class="hljs-symbol"><span class="hljs-symbol">:</span></span>= $(LOCAL_PATH)/include_all \   $(FREETYPE_SRC_PATH)<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> \   $(FREETYPE_SRC_PATH)src LOCAL_SRC_FILES <span class="hljs-symbol"><span class="hljs-symbol">:</span></span>= \  $(FREETYPE_SRC_PATH)src/autofit/autofit.c \  $(FREETYPE_SRC_PATH)src/base/basepic.c \  $(FREETYPE_SRC_PATH)src/base/ftapi.c \  $(FREETYPE_SRC_PATH)src/base/ftbase.c \  $(FREETYPE_SRC_PATH)src/base/ftbbox.c \  $(FREETYPE_SRC_PATH)src/base/ftbitmap.c \  $(FREETYPE_SRC_PATH)src/base/ftdbgmem.c \  $(FREETYPE_SRC_PATH)src/base/ftdebug.c \  $(FREETYPE_SRC_PATH)src/base/ftglyph.c \  $(FREETYPE_SRC_PATH)src/base/ftinit.c \  $(FREETYPE_SRC_PATH)src/base/ftpic.c \  $(FREETYPE_SRC_PATH)src/base/ftstroke.c \  $(FREETYPE_SRC_PATH)src/base/ftsynth.c \  $(FREETYPE_SRC_PATH)src/base/ftsystem.c \  $(FREETYPE_SRC_PATH)src/cff/cff.c \  $(FREETYPE_SRC_PATH)src/pshinter/pshinter.c \  $(FREETYPE_SRC_PATH)src/pshinter/pshglob.c \  $(FREETYPE_SRC_PATH)src/pshinter/pshpic.c \  $(FREETYPE_SRC_PATH)src/pshinter/pshrec.c \  $(FREETYPE_SRC_PATH)src/psnames/psnames.c \  $(FREETYPE_SRC_PATH)src/psnames/pspic.c \  $(FREETYPE_SRC_PATH)src/raster/raster.c \  $(FREETYPE_SRC_PATH)src/raster/rastpic.c \  $(FREETYPE_SRC_PATH)src/sfnt/pngshim.c \  $(FREETYPE_SRC_PATH)src/sfnt/sfntpic.c \  $(FREETYPE_SRC_PATH)src/sfnt/ttbdf.c \  $(FREETYPE_SRC_PATH)src/sfnt/ttkern.c \  $(FREETYPE_SRC_PATH)src/sfnt/ttload.c \  $(FREETYPE_SRC_PATH)src/sfnt/ttmtx.c \  $(FREETYPE_SRC_PATH)src/sfnt/ttpost.c \  $(FREETYPE_SRC_PATH)src/sfnt/ttsbit.c \  $(FREETYPE_SRC_PATH)src/sfnt/sfobjs.c \  $(FREETYPE_SRC_PATH)src/sfnt/ttcmap.c \  $(FREETYPE_SRC_PATH)src/sfnt/sfdriver.c \  $(FREETYPE_SRC_PATH)src/smooth/smooth.c \  $(FREETYPE_SRC_PATH)src/smooth/ftspic.c \  $(FREETYPE_SRC_PATH)src/truetype/truetype.c \  $(FREETYPE_SRC_PATH)src/type1/t1driver.c \  $(FREETYPE_SRC_PATH)src/cid/cidgload.c \  $(FREETYPE_SRC_PATH)src/cid/cidload.c \  $(FREETYPE_SRC_PATH)src/cid/cidobjs.c \  $(FREETYPE_SRC_PATH)src/cid/cidparse.c \  $(FREETYPE_SRC_PATH)src/cid/cidriver.c \  $(FREETYPE_SRC_PATH)src/pfr/pfr.c \  $(FREETYPE_SRC_PATH)src/pfr/pfrgload.c \  $(FREETYPE_SRC_PATH)src/pfr/pfrload.c \  $(FREETYPE_SRC_PATH)src/pfr/pfrobjs.c \  $(FREETYPE_SRC_PATH)src/pfr/pfrsbit.c \  $(FREETYPE_SRC_PATH)src/type42/t42objs.c \  $(FREETYPE_SRC_PATH)src/type42/t42parse.c \  $(FREETYPE_SRC_PATH)src/type42/type42.c \  $(FREETYPE_SRC_PATH)src/winfonts/winfnt.c \  $(FREETYPE_SRC_PATH)src/pcf/pcfread.c \  $(FREETYPE_SRC_PATH)src/pcf/pcfutil.c \  $(FREETYPE_SRC_PATH)src/pcf/pcfdrivr.c \  $(FREETYPE_SRC_PATH)src/psaux/afmparse.c \  $(FREETYPE_SRC_PATH)src/psaux/psaux.c \  $(FREETYPE_SRC_PATH)src/psaux/psconv.c \  $(FREETYPE_SRC_PATH)src/psaux/psobjs.c \  $(FREETYPE_SRC_PATH)src/psaux/t1decode.c \  $(FREETYPE_SRC_PATH)src/tools/apinames.c \  $(FREETYPE_SRC_PATH)src/type1/t1afm.c \  $(FREETYPE_SRC_PATH)src/type1/t1gload.c \  $(FREETYPE_SRC_PATH)src/type1/t1load.c \  $(FREETYPE_SRC_PATH)src/type1/t1objs.c \  $(FREETYPE_SRC_PATH)src/type1/t1parse.c\  $(FREETYPE_SRC_PATH)src/bdf/bdfdrivr.c\  $(FREETYPE_SRC_PATH)src/bdf/bdflib.c\  $(FREETYPE_SRC_PATH)src/gzip/ftgzip.c\  $(FREETYPE_SRC_PATH)src/lzw/ftlzw.c \ LOCAL_LDLIBS <span class="hljs-symbol"><span class="hljs-symbol">:</span></span>= -ldl -llog <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> $(BUILD_SHARED_LIBRARY)</code> </pre> <br>  By default, the NDK build system generates machine code for the armeabi architecture.  In order to add support for the Intel architecture, we will need to configure the Application.mk file located in the same jni folder.  Namely, add ‚Äúx86‚Äù to the APP_ABI variable.  The assembly can be carried out simultaneously for several platforms, their identifiers are indicated with a space. <br><br>  This is what the APP_ABI variable looks like, tuned to two target architectures. <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">APP_ABI</span></span> := armeabi-v7a x86 <span class="hljs-comment"><span class="hljs-comment">#  : x86_64, armeabi, arm64-v8a, mips, mips64</span></span></code> </pre> <br>  In order to generate machine code for all available instruction sets, you can use the following settings: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">APP_ABI</span></span> := all <span class="hljs-comment"><span class="hljs-comment">#    all32  all64</span></span></code> </pre> <br>  The variable APP_PLATFORM contains the name of the target Android platform.  Our Application.mk is pretty simple: <br><br><pre> <code class="hljs go">APP_ABI :=all APP_PLATFORM := android<span class="hljs-number"><span class="hljs-number">-20</span></span></code> </pre> <br>  Here is what it looks like in the code editor. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/db5/bd6/345/db5bd6345bc6f618ed7203e6a7bce550.gif"></div><br>  <i><font color="#999999">Setting APP_ABI in the Application.mk file</font></i> <br><br>  Preliminary preparation is passed, now we will configure automatic assembly of the project with use of NDK.  To do this, firstly, set up a list of builders for the project, and secondly, select a specific collector to use in preparing the library. <br><br>  To do this, right-click on the Android project, select the Properties item in the menu.  In order to add a new build system to the list, in the left part of the window that appears, go to the Builders tab, then click on the New button located on the right. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d44/060/e51/d44060e51806f78ad3e51ff1a191dbec.gif"></div><br>  <i><font color="#999999">Project Properties</font></i> <br><br>  Select Program from the list in the configuration type selection window.  This option allows you to specify the location of external tools and exactly how you need to run the scripts that build. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/935/dcd/a4c/935dcda4ce5b72fdd786e4e74b7cc56d.gif"></div><br>  <i><font color="#999999">Configuration setting</font></i> <br><br>  In the window that appears, configure the following fields: <br><br><ul><li>  Name: the name of the new collector </li><li>  Location: path to ndk-build.cmd </li><li>  Working Directory: path to our project folder </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc5/0b8/e50/bc50b8e5014480601a3f919f2690847f.gif"></div><br>  <i><font color="#999999">NDK Setup</font></i> <br><br>  After completing the above settings, run the project build.  When this process is successfully completed, in folders that are named according to the / lib / &lt;APP_ABI&gt; scheme, it will be possible to find library assemblies for the platforms specified in Application.mk.  In particular, we are interested in x86 and x86_64 folders. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ead/c01/f3a/eadc01f3acff0dd674ceda37d4cbff6d.gif"></div><br>  <i><font color="#999999">Files libfreetype.so for Android devices built on the x86 platform</font></i> <br><br><h2>  <font color="#0071c5">Results</font> </h2><br>  The FreeType library is compiled, now you can use it in your own Android applications. </div><p>Source: <a href="https://habr.com/ru/post/278603/">https://habr.com/ru/post/278603/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278593/index.html">We get acquainted with web standards. Work with audio. - Video and creation history</a></li>
<li><a href="../278595/index.html">SQL engine for generating reports. Idea</a></li>
<li><a href="../278597/index.html">Decomposition of the affine transformation matrix</a></li>
<li><a href="../278599/index.html">We send Angular 2 routs through Laravel 5 router</a></li>
<li><a href="../278601/index.html">WG Labs Announces Developer Contest</a></li>
<li><a href="../278605/index.html">The history of one technology. Mob</a></li>
<li><a href="../278607/index.html">libuniset2 is a library for creating ACS. It‚Äôs better to see once ... Part 5 (uniset2-testsuite)</a></li>
<li><a href="../278611/index.html">Reverse engineering "Kazakov", part two: increase the queue</a></li>
<li><a href="../278613/index.html">Juniper MX + IX + SynFlood</a></li>
<li><a href="../278615/index.html">ZeroNet - A truly distributed network - a year later</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>