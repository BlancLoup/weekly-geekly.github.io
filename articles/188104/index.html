<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Configuring WebSVN on Windows for integration into Jira with support for SVN authorization and Delphi source encoding</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I post this instruction, because I myself had to look for the necessary information on the grains. The instruction is designed for people with little ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Configuring WebSVN on Windows for integration into Jira with support for SVN authorization and Delphi source encoding</h1><div class="post__text post__text-html js-mediator-article">  I post this instruction, because  I myself had to look for the necessary information on the grains.  The instruction is designed for people with little experience in web technologies and web development.  All software systems are configured on a dedicated ‚Äúserver‚Äù for programmer needs running Windows 7 Pro 32 bit. <br>  What we have: <br><ul><li>  Visual SVN Server 2.6.0 (Apache Subversion 1.8.0 + Apache HTTP Server 2.2.25) </li><li>  SVN access is already configured via ssl to port 8443 </li><li>  Jira 6.0 with JIRA Subversion plugin installed </li><li>  Basic JIRA Subversion plugin setup (the tasks display the corresponding commits with file lists) </li><li>  SVN stores source code written in Delphi 7 with CP1251 encoding </li></ul><br>  What we want to get: <br><ul><li>  viewing the contents of commits </li><li>  use of an existing SVN authorization system to access the source code </li></ul><br><a name="habracut"></a><br><h4>  1. Install PHP </h4><br><ol><li>  download the Thread Safe installer for windows from the official site (the latest version does not appear immediately, so php-5.3.27-Win32-VC9-x86.msi was chosen) </li><li>  install in C: \ PHP \ (when dealing with something multiplatform, I always avoid spaces in paths and Russian characters) </li><li>  during installation, select ‚ÄúApache 2.2.x module‚Äù;  Apache HTTP Server configuration is in the Visual SVN Server directory, I have this "C: \ Program Files \ VisualSVN Server \ conf" </li></ol><br>  When installing, the file C: \ Program Files \ VisualSVN Server \ conf \ httpd.conf will be automatically added to the lines <br><pre><code class="xml hljs">#BEGIN PHP INSTALLER EDITS - REMOVE ONLY ON UNINSTALL PHPIniDir "C:\PHP\" LoadModule php5_module "C:\PHP\php5apache2_2.dll" #END PHP INSTALLER EDITS - REMOVE ONLY ON UNINSTALL</code> </pre> <br>  I read the recommendations on the Internet to install PHP manually from a zip archive, but it didn't work out for me the first time.  Just because I did not find the latest php library php5apache2_2.dll in the delivery, and php5apache2_4.dll refused to load on Apache. <br><br><h4>  2. Installing WebSVN </h4><br>  Here and the installation is difficult to name.  Simply create the C: \ Program Files \ VisualSVN Server \ htdocs \ websvn directory and copy the contents of the archive downloaded from the official website into it. <br><br>  At this stage, you can already check the availability of the WebSVN page.  To do this, go to <code><a href="https://yourserver/"></a> yourserver:8443/websvn/index.php</code>  <code><a href="https://yourserver/"></a> yourserver:8443/websvn/index.php</code> , a welcome page should be displayed asking you to customize the list of repositories. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  3. Installing Cygwin </h4><br>  The essence of the Cygwin project is to provide Windows users with applications common in Unix systems.  Some of these applications are required for WebSVN.  The official site provided a fairly clear installer.  You must install the following packages: <br><ul><li>  diffutils </li><li>  enscript (code highlighting, just in case, if you don‚Äôt like the default Geshi highlighting in WebSVN) </li><li>  sed </li><li>  tar </li><li>  gzip </li><li>  zip </li></ul><br>  Installed in C: \ cygwin \, using the principle of avoiding spaces mentioned above. <br><br><h4>  4. Configure WebSVN </h4><br><h5>  Apache minor configuration </h5><br>  For the convenience of accessing the WebSVN homepage, add the following code to the Apache C: \ Program Files \ VisualSVN Server \ conf \ httpd-custom.conf user settings file: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">IfModule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dir_module</span></span></span><span class="hljs-tag">&gt;</span></span> DirectoryIndex index.html index.php <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">IfModule</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h5>  Configuring config.php </h5><br>  In accordance with the instructions for installing WebSVN, located in the file C: \ Program Files \ VisualSVN Server \ htdocs \ websvn \ doc \ install.html, copy the file \ include \ distconfig.php to \ include \ config.php, and then modify it in accordance with the comments to the parameters.  My settings were as follows: <br><pre> <code class="php hljs">$config-&gt;setSVNCommandPath(<span class="hljs-string"><span class="hljs-string">'C:\\Program Files\\VisualSVN Server\\bin'</span></span>); $config-&gt;setDiffPath(<span class="hljs-string"><span class="hljs-string">'C:\\cygwin\\bin'</span></span>); $config-&gt;setEnscriptPath(<span class="hljs-string"><span class="hljs-string">'C:\\cygwin\\bin'</span></span>); ... (    <span class="hljs-string"><span class="hljs-string">'C:\\cygwin\\bin'</span></span>) $config-&gt;setTrustServerCert(); $config-&gt;parentPath(<span class="hljs-string"><span class="hljs-string">'D:\\SVN\\Repositories'</span></span>); $config-&gt;setIgnoreWhitespacesInDiff(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $config-&gt;setDefaultLanguage(<span class="hljs-string"><span class="hljs-string">'ru'</span></span>); $config-&gt;allowDownload(); $config-&gt;setDefaultFolderDlMode(<span class="hljs-string"><span class="hljs-string">'gzip'</span></span>); $config-&gt;useEnscript(); <span class="hljs-comment"><span class="hljs-comment">//$config-&gt;useGeshi(); $config-&gt;setRssEnabled(false);</span></span></code> </pre><br><h5>  Configure authorization used in SVN </h5><br>  Immediately, I‚Äôll make a reservation that due to switching to Visual SVN version 2.6.0, the access system distributed over repositories could not be tied to the same files by authorizing WebSVN.  I had to manually create a common authorization file for the repositories that is not used in Visual SVN.  At the moment, this problem is insignificant due to the small size of the development team, but I will be happy to hear recommendations for avoiding manual file support for the authorization.  So, let's continue: <br><ul><li>  create a common authorization file for the repositories (I have the file D: \ SVN \ Repositories \ authz); you can see an example of filling in any local authorization file (for example, D: \ SVN \ Repositories \ rep1 \ conf \ authz);  My content is the simplest: <pre> <code class="hljs">user1=rw user2=rw user3=rw user4=rw</code> </pre></li><li>  in the file C: \ Program Files \ VisualSVN Server \ conf \ httpd-custom.conf add <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Location</span></span></span><span class="hljs-tag"> /</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">websvn</span></span></span><span class="hljs-tag">/&gt;</span></span> SVNListParentPath on SVNParentPath "D:/SVN/Repositories/" AuthType Basic AuthBasicProvider file AuthName "Please,authenticate in Subversion Repository" Require valid-user AuthUserFile "D:/SVN/Repositories/htpasswd" AuthzSVNGroupsFile "D:/SVN/Repositories/groups.conf" AuthzSVNAccessFile "D:/SVN/Repositories/authz" <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Location</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></li></ul><br>  Now at the entrance to <code><a href="https://yourserver/"></a> yourserver:8443/websvn/</code>  <code><a href="https://yourserver/"></a> yourserver:8443/websvn/</code> authorization used in the Visual SVN Server, and access is configured in general for the repositories authorization file. <br><br><h5>  Encoding setting </h5><br>  WebSVN is already fully functional, but not enough gloss.  For example, comments in the source code of Delphi 7, written in Russian, are displayed as crackers.  At the same time, the site itself is already in Russian.  What's the catch?  On the WebSVN website I found a discussion of this problem: <code><a href="http://websvn.tigris.org/ds/viewMessage.do%3FdsMessageId%3D2968020%26dsForumId%3D1547"></a> websvn.tigris.org/ds/viewMessage.do?dsMessageId=2968020&amp;dsForumId=1547</code>  <code><a href="http://websvn.tigris.org/ds/viewMessage.do%3FdsMessageId%3D2968020%26dsForumId%3D1547"></a> websvn.tigris.org/ds/viewMessage.do?dsMessageId=2968020&amp;dsForumId=1547</code> .  In short: the php mb_detect_encoding function used to determine the file encoding is simply lying.  Use the crutch suggested by the user yaroslav, for this in the file C: \ Program Files \ VisualSVN Server \ htdocs \ websvn \ include \ command.php replace <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mb_detect_encoding($str.<span class="hljs-string"><span class="hljs-string">'a'</span></span>, $list);</code> </pre>  on <br><pre> <code class="php hljs">$res = mb_detect_encoding($str.<span class="hljs-string"><span class="hljs-string">'a'</span></span>,$list); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($res !== <span class="hljs-string"><span class="hljs-string">'ISO-8859-1'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $res; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'CP1251'</span></span>;</code> </pre>  While problems with a crutch did not notice.  The problem of determining the file encoding is described in detail in the post of the user <a href="https://habrahabr.ru/users/m00t/" class="user_link">m00t</a> : <code><a href="http://habrahabr.ru/post/107945/"></a> habrahabr.ru/post/107945</code>  <code><a href="http://habrahabr.ru/post/107945/"></a> habrahabr.ru/post/107945</code> .  It also describes a working method for determining the encoding, the use of which will help avoid crutches and their potential problems. <br><br><h5>  Customize greeting on the title page </h5><br>  In the files C: \ Program Files \ VisualSVN Server \ htdocs \ websvn \ templates \\ index.tmpl, you can replace the default greeting text with your own.  I select this setting in a separate item, because  When using Russian text, the file must be written in utf8 encoding. <br><br><h4>  5. Configuring JIRA Subversion plugin </h4><br>  Enter administration -&gt; plugins -&gt; Subversion Repositories, configure paths in each repository (for example, rep1 repository): <br> <code><a href="https://yourserver/"></a> view format: yourserver:8443/websvn/filedetails.php?repname=rep1&amp;path=${path}</code> <br> <code><a href="https://yourserver/"></a> changeset format: yourserver:8443/websvn/revision.php?repname=rep1&amp;location=/&amp;rev=${rev}</code> <br> <code><a href="https://yourserver/"></a> file added format: yourserver:8443/websvn/filedetails.php?repname=rep1&amp;path=${path}&amp;rev=${rev}</code> <br> <code><a href="https://yourserver/"></a> file modified format: yourserver:8443/websvn/diff.php?repname=rep1&amp;path=${path}&amp;rev=${rev}&amp;sc=0</code> <br> <code><a href="https://yourserver/"></a> file replaced format: yourserver:8443/websvn/filedetails.php?repname=rep1&amp;path=${path}&amp;rev=${rev-1}&amp;sc=0</code> <br> <code><a href="https://yourserver/"></a> file deleted format: yourserver:8443/websvn/filedetails.php?repname=rep1&amp;path=${path}&amp;rev=${rev-1}&amp;sc=0</code> </div><p>Source: <a href="https://habr.com/ru/post/188104/">https://habr.com/ru/post/188104/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../188092/index.html">Android component from scratch</a></li>
<li><a href="../188094/index.html">Order in the photo and video archives using the technique and a pair of scripts</a></li>
<li><a href="../188096/index.html">Failover Master-Slave Cluster on PostgreSQL</a></li>
<li><a href="../188098/index.html">Relations enikeyschika and people in work</a></li>
<li><a href="../188102/index.html">Simple client and server authorization of an Ajax site user using the VKontakte API</a></li>
<li><a href="../188106/index.html">Django development server and HTTPS testing</a></li>
<li><a href="../188108/index.html">Articles about a portable Linux server for newbies - are they needed?</a></li>
<li><a href="../188110/index.html">ExtJs as a maven dependency</a></li>
<li><a href="../188114/index.html">A real multi-threaded web server in assembler for Linux</a></li>
<li><a href="../188116/index.html">Automatic update of Adobe Flash Player & Java RE in the Windows / AD domain</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>