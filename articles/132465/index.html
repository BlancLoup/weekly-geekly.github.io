<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bad java or how not to do</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="While working, I, as probably every one of you, sometimes have to notice the minor flaws of Java. Small and rare, but inherent. By writing this articl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bad java or how not to do</h1><div class="post__text post__text-html js-mediator-article">  While working, I, as probably every one of you, sometimes have to notice the minor flaws of Java.  Small and rare, but inherent.  By writing this article I was a feat of one of the <a href="http://stackoverflow.com/questions/186964/java-core-api-anti-patterns-what-is-wrong">comments</a> to my first post.  The topic seemed very interesting to me and I decided to recall everything that I don‚Äôt like in my favorite programming language.  So, let's begin: <br><br><h6>  Hashset </h6><br>  I don‚Äôt know why such a decision was made, but HashSet is implemented on a HashMap, yes - they saved time to create, but this is one of the main collections, why it wasn‚Äôt more responsibly created - it‚Äôs not clear.  Still, it was possible to create a HashSet more optimally.  HashMap carries redundant architecture in the context of HashSet tasks.  For example, inside HashSet there is the following code: <br><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Dummy value to associate with an Object in the backing Map private static final Object PRESENT = new Object();</span></span></code> </pre> <br>  This means that any of your values ‚Äã‚Äãinside HashSet will be associated with a link to this object.  This is the same as: <br><pre> <code class="java hljs">Map.put(key, PRESENT);</code> </pre><br>  It would seem, think - 8 bytes, which will be used by all.  But do not forget that every time you insert into HashSet, a Map.Entry is created, in which 4 links (another 16 extra bytes to each element).  Wasteful, is not it?  Why is that?  A great mystery ... Thanks at least not inherited. <br><br><h6>  Default logger </h6><br>  Who in the project does not use log4j?  Can you just call the library, which also do without it?  I think these are hard questions.  I understand, java cannot adapt to each specific task, but they added the standard Logger, so why in the 10 years of its existence log4j, java has not taken the best of it?  Imagine how much all applications would be reduced, especially complex ones, where there may be several different versions of the logger in the final assembly. <br><a name="habracut"></a><br><h6>  Clonable </h6><br>  Everyone knows that the Clonable interface is empty, without a single method and variable, just a marker for the JVM.  The question is why?  After all, if we inherit from it, then we try to define a certain behavior and, following the OOP paradigms, it should contain the clone () method, which would define this very behavior.  Of course, it is sometimes very convenient without overriding clone to get a copy of the object.  Nevertheless, in fact, it is necessary to redefine this method in all classes that have at least one collection of model objects in order to get a complete copy, and not just references to the same objects inside the collection.  I do not know why the developers did not define a single method in this interface.  I hope they had a reason for this, although they probably just forgot.  As a consequence, the clone () method in Object. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  Serializable </h6><br>  The situation is similar to Clonable, but at least you can argue here - in most cases <br>  we do not define the behavior manually, but rely on the standard implementation and it would be very inconvenient to constantly redefine some methods of serialization + constantly monitor the addition of new fields, add them to the methods.  Well, specifically for this purpose there is Externalizable.  However, we know that you can change the standard serialization behavior by predefining writeObject () and readObject ().  Somehow not on OOshny. <br><br><h6>  Properties </h6><br>  We all work with the Properties class anyway.  We open source codes and what we see? <br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Properties</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hashtable</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Object</span></span></span><span class="hljs-class">,</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Object</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre><br>  What for?  Anyone knows that composition is better than inheritance, especially if this inheritance has no logical meaning and does not simplify the application model.  What about the load (InputStream inStream) and load0 (LineReader lr) methods?  But what about overloading methods?  It‚Äôs the same with store0 (), well at least hidden inside a class.  By the way, such methods are found everywhere in core java, similar to someone's style. <br><br><h6>  Primitive Shell Classes </h6><br>  Wrapper classes are redundant, it would be much more convenient to operate with primitives and be able to assign a null value to them.  If a simple int is 4 bytes, then the Integer object is already 16. 16. A constant cast, a comparison by equals.  Why all this?  Farther: <br><pre> <code class="java hljs">Boolean.getBoolean(); Long.getLong(); Integer.getInteger()</code> </pre><br>  Mysterious methods.  I still cannot understand what role they should play and why the methods that <br>  check System.getProperty () are in the wrapper classes, not in the Properties class. <br><br><h6>  switch </h6><br>  Of course, every java developer knows that the switch statement works only with the integer type, and starting with the 7th java and with strings.  But why these restrictions?  Judging by the implementation of switch in the 7th version - it works with a string based on hashode () and equals ().  Then the question is why only lines?  It was easy to implement the operator for any object, but for some reason this was not done.  Another mystery. <br><br><h6>  Collections </h6><br>  In List and Set there is an excellent retainAll () method - intersection of sets, but for some reason there is no method for difference of sets.  Of course, you can easily implement it yourself: <br><pre> <code class="java hljs">List first = someList(); List second = someList(); diff = first.clone(); diff.removeAll(second);</code> </pre><br>  But I would like this basic operation with one of the main data types to be out of the box. <br><br>  Next - one of the most frequent tasks when working with collections is to find the desired item in the collection.  Why List has indexOf (Object o), and HashSet does not have get (Object o), which by hash code and equals would return a reference to an object from the collection.  Yes, when the hash code is not redefined it makes no sense, but when it is not, then there are opportunities for use.  Maybe I, of course, too carp, but quite often this problem arises. <br><br>  From the same category - there is no possibility to filter objects by some property.  You always have to do it manually.  Bad, very bad. <br><br><h6>  Generics </h6><br><pre> <code class="java hljs">Map&lt;MyKeyObject, PersistedPlan&gt; plansById = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashSet&lt;MyKeyObject, PersistedPlan&gt;();</code> </pre><br>  As already noted, such constructions are found everywhere in the code ‚Äî in class descriptions, in constructors, in methods, everywhere ... They overload the code and complicate its perception.  Fortunately, in the 7th java this was fixed.  It is not clear only - why waited so long? <br><br><h6>  Multithreading </h6><br>  For the first time, when I read about <a href="http://yzh44yzh.com/ru/scala_by_5">multithreading</a> in Erlang, I realized how much the java multithreading mechanisms are complex.  All of these locks, monitors, synchronizations, deadlocks, theads, runnables, memory barriers.  What for?  Why so complicate our lives, because java more than 20 years, is it really difficult to consider the trends of today?  After all, the main goal of java was to make life easier for us - simple developers. <br>  PS I talked to my colleagues here, there is information that the moves in this direction are not small, so let's hope. <br><br><h6>  Closures </h6><br>  Often there is a need to bring the function as a parameter, right?  How long can you wait?  As a java developer, I‚Äôm not very pleased that one of the most anticipated improvements wasn‚Äôt.  Let's hope that at least in the 8th Java will appear, there is nothing more to add. <br><br><h6>  Runtime and System </h6><br>  The logical separation of these classes is not entirely clear, it seems to me that one would be enough.  Several oddities are associated with System - for example, the out and in fields of the class are final.  But at the same time there are setOut and setIn methods.  Bad example, is not it? <br><br><h6>  String </h6><br>  It is not very efficient, not only does 2 bytes occupy each character, so every line is an object of class String, and this in turn is 8 bytes per header + 3 integer values ‚Äã‚Äãinside + 1 reference to the array == extra 24 bytes per each line!  Still expensive.  It would be possible to at least create 2 variants of the lines: cheap and expensive.  There would be a choice at least. <br><br><h6>  Numbers </h6><br><pre> <code class="java hljs">Long l = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-comment"><span class="hljs-comment">//compilation error Map&lt;int, Object&gt; a = new HashMap&lt;int, Object&gt;(); //compilation error Map&lt;Object, int&gt; a = new HashMap&lt;Object, int&gt;(); //compilation error Set&lt;int&gt; b = new HashSet&lt;int&gt;(); //compilation error</span></span></code> </pre><br>  Why did you complicate such simple things?  I still can not realize.  Trifle, of course, but not nice.  Next, everyone knows that standard primitives are not suitable for working with floating point numbers in Java, since they lose accuracy.  Well, we use another type - BigDecimal.  And what a simple formula will turn into: <br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//(metric.getValue() * 100 / prevMetric.getValue()) + metric.getOffset() BigDecimal result =BigDecimal.valueOf(metric.getValue() * 100).divide(BigDecimal.valueOf(prevMetric.getValue()).add(metric.getOffset()));</span></span></code> </pre><br>  Well, if the computations are simple, with complex things it‚Äôs much sadder.  Why not enter the data type that works normally with numbers along with double and float? <br><br><h6>  findings </h6><br>  Do not think that this is some kind of autumn aggravation.  In no case.  I love java very much and I want it to develop on a par with modern trends.  And I also want to be able to program it in pleasure, without all the little things that only annoy and distract from the entertaining and interesting work. </div><p>Source: <a href="https://habr.com/ru/post/132465/">https://habr.com/ru/post/132465/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132459/index.html">Tsung: Web Application Load Testing</a></li>
<li><a href="../132460/index.html">Games, squeezed out of the NES maximum (part 2)</a></li>
<li><a href="../132461/index.html">Orange San Francisco II will be available in the UK soon</a></li>
<li><a href="../132463/index.html">Reactive Extensions for javascript. Complete guide</a></li>
<li><a href="../132464/index.html">Graphical installation of Scientific Linux 6 on ServerLoft servers</a></li>
<li><a href="../132466/index.html">Pianorama. Android and iOS apps</a></li>
<li><a href="../132467/index.html">Does your team conduct code revisions?</a></li>
<li><a href="../132469/index.html">Semiconductor devices - diode</a></li>
<li><a href="../132471/index.html">Did you do Olympiad programming? Did you benefit from the experience?</a></li>
<li><a href="../132472/index.html">JavaScript patterns ... for dummies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>