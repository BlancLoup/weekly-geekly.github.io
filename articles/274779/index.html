<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with PGP digital signatures using the Bouncy Castle Cryptography Library in Java</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this tutorial, we will look at working with OpenPGP in Java using the Bouncy Castle Cryptography Library using web-based development. 



 ( link t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with PGP digital signatures using the Bouncy Castle Cryptography Library in Java</h1><div class="post__text post__text-html js-mediator-article">  In this tutorial, we will look at working with OpenPGP in Java using the Bouncy Castle Cryptography Library using web-based development. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bbe/0f7/ebd/bbe0f7ebd2390f418eae9bda5f286e96.png" alt="image"><br><a name="habracut"></a><br>  ( <a href="">link to the source of the scheme</a> ) <br><br><h4>  <a href="https://ru.wikipedia.org/wiki/PGP">PGP</a> / <a href="https://ru.wikipedia.org/wiki/PGP">OpenPGP</a> </h4><br>  <a href="https://ru.wikipedia.org/wiki/PGP">OpenPGP is</a> described in <a href="https://tools.ietf.org/html/rfc4880">RFC 4880</a> , and is the most common standard <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D1%2580%25D0%25B8%25D0%25BF%25D1%2582%25D0%25BE%25D1%2581%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0_%25D1%2581_%25D0%25BE%25D1%2582%25D0%25BA%25D1%2580%25D1%258B%25D1%2582%25D1%258B%25D0%25BC_%25D0%25BA%25D0%25BB%25D1%258E%25D1%2587%25D0%25BE%25D0%25BC">public key cryptographic system</a> for working with digital signatures and message encryption.  Supported by many programs and libraries, including free with open source.  In particular, it should be noted <a href="https://www.gnupg.org/">GnuPG</a> , <a href="https://www.kde.org/applications/utilities/kleopatra/">Kleopatra</a> , a set of utilities for Windows <a href="https://www.gpg4win.org/">Gpg4win</a> (it includes GnuPG, Kleopatra, etc.), an extension for Thunderbird <a href="https://www.enigmail.net/">Enigmail</a> . <br>  For Windows, also pay attention to the commercial package Symantec Endpoint Encryption, also known as PGP Desktop (a <a href="https://www4.symantec.com/Vrt/offer%3Fa_id%3D184016">trial version</a> is available, which can be used for non-commercial purposes after the expiration date), and other products from <a href="https://www.symantec.com/encryption/">Symantec Encryption Family</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For details, see: <a href="https://ssd.eff.org/ru/module/%25D0%25B2%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5-%25D0%25B2-%25D1%2588%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5-%25D1%2581-%25D0%25BE%25D1%2582%25D0%25BA%25D1%2580%25D1%258B%25D1%2582%25D1%258B%25D0%25BC-%25D0%25BA%25D0%25BB%25D1%258E%25D1%2587%25D0%25BE%25D0%25BC-%25D0%25B8-pgp">Introduction to Public Key Encryption and PGP</a> , <a href="https://ru.wikipedia.org/wiki/PGP">PGP Operation Mechanism</a> . <br><br><h4>  Bouncy Castle Cryptography Library </h4><br>  The Bouncy Castle Cryptography Library is currently the most widely used cryptographic library for Java, including Android. <br>  This is an open source project (GitHub: <a href="https://github.com/bcgit/bc-java">github.com/bcgit/bc-java</a> ).  Also for our topic of interest is the open source program <a href="http://ppgp.sourceforge.net/">Portable PGP</a> v.  1.x, written in Java using Bouncy Castle: <a href="http://sourceforge.net/p/ppgp/code/">sourceforge.net/p/ppgp/code</a> <br><br>  To work with OpenPGP in Bouncy Castle there is a separate <a href="https://www.bouncycastle.org/docs/pgdocs1.5on/index.html">org.bouncycastle.openpgp</a> package, with which we will work. <br><br><h4>  Read public key </h4><br>  Solved problem: read an ASCII-armored Public PGP Key Block (public key) in the form of a String and create an <a href="https://www.bouncycastle.org/docs/pgdocs1.5on/org/bouncycastle/openpgp/PGPPublicKey.html">org.bouncycastle.openpgp.PGPPublicKey</a> object representing the public key in BC. <br><br>  The ASCII-armored format represents the key in a text format that is convenient to use for publishing on the site, sending by e-mail, etc., looks like this: <br><pre><code class="xml hljs">-----BEGIN PGP PUBLIC KEY BLOCK----- Version: GnuPG v2.0.22 (GNU/Linux) mQINBFZpf0wBEADo7NZ4Oymw2pVJMfrNEhGwYOT4CGMOTZHQo3rYFrN3yxCsd/xX r8kWLvkKvEFSD0XfQlq6slA9fnOtsRZl4JlmabKC33ZkB1zhV2c78AhhVMrfFi2a 114xHhOHkR4LOv8mAyyRKd5mpuyYpPKcF2670jXxANeqNQCoKKM/dPS1uxGapE9Z GG0GFKvIUqKWJUAv7JqOAxtXbAS7JFMwiH16jL/TeuvKy+0JKvlBM4qxB9S18hi4 GYg1SEATqmeu9E+6alz0L25REYYZZOMja1quF8HywsRY0fSZqCbD+9diP0keAg6z PSDSlgDF4WBUi+c8PoXcRRZq7+XYgky4l8wfGoGnOZKA4GH2SMlNAX8jCIrC7Cpf KPCu6NMY533X735Md6fnWOeuyxz4owPRb6OTt4rYiA3/9vCu/waZ1zZx/wATYORS 1wmOx8ZjogeAPOz6a2PW8hrK0tWbT3ILucC7dxjYfdKHZX2+v3eMGvXFRKss8J5i E5rlJiDnAMoERmIJunh/EJHz4te+RdMy2jWeDQWGzaFyZC92SUo9tAUJk7xez0KX 5sYzhXjFJX/17DwFBTXIOYpFjWUyPaQaP7ByWOjZzhCmQxYRBUJSoxOty1ngkZ+B 7zAZSTXh2mukHukRERG1//2FsiBZeapRhAaFWdWnPDN95bg7L7/qQ5szjQARAQAB tDdWaWt0b3IgQWdleWV2IDxhZ2V5ZXZAaW50ZXJuYXRpb25hbC1hcmJpdHJhdGlv bi5vcmcudWs+iQI/BBMBAgApBQJWaX9MAhsvBQkB4lLUBwsJCAcDAgEGFQgCCQoL BBYCAwECHgECF4AACgkQzjaf2edxc+UywQ/+MfYX5BRzl7iSndhr/vVOEycxZntu 9efMhwQYO87EXT/cNpRMX/u2Wzhx70brzFIenvaYTPpVkYKinKv3iEAauJ1wr5/a PrUxRcfVnBrV8ecWTO6SbNRDePqayst8bBq9rdqnKnpDEv911zk2hjJtCeFDlUkO eiTLgYCVOQ7n0fbN4pjrBGAqDGs2SFjJXAKYJpZqY77P0crHxXCMyukrdj2WxnB7 JyMdmBqViJSo/MCi7SFXqVQFTvJZVBhTQEUO5KNJA6oAYztYKXBE3AybE528m571 p+HhJ2mOnlNaRu5y12RRQJ7qmKvN9uzHz0+mt8rRk3oYWCYImTMwxDpc1mT39QKs 0WS/zp5NTIaa+Hvt7V8GH5hmq67YL+JcxEINZGZ+MZmiSKuvGVuqC8ZJpswumVw5 PHtMEL+0zBxZXN41YyfTudssXbvMrNiGIdlQA7CW/7yMviVR4nyQtFQJwYSL4mva uTQSnihm4Bj6FeYpgGpk1TyIzgtIyaQNSvnlDYFezmN/JsAs+25EP/oxyFLaK+ij WdjVmnsDGS4l5BWH/a8BYPbSnm7YrlYkYCXjTjK1/EeWA/tggApISFptc8YQw0Wp Qw0IwhJVPWDVW8nDrv/1IPhTJgYfIfdmxr32RLhNePEZGZ02zfCP9BrlNKut9/Hn x1yKWjVaWZO8VtU= =XyhJ -----END PGP PUBLIC KEY BLOCK-----</code> </pre> <br>  In this form, the public key can be transferred to a web form.  We will write code that can retrieve data from the key on the server, and then, say, return it to the user (public key recognition service) and / or save it in the database.  In BC there is a class <a href="https://www.bouncycastle.org/docs/pgdocs1.5on/org/bouncycastle/openpgp/PGPPublicKey.html">PGPPublicKey</a> , our task is to create a new object of this class using the input String, and then using the methods provided by this class to get data about the key. <br><br>  In the org.bouncycastle.openpgp.examples package there is a PGPExampleUtil class, we cannot import it as it is non-public, but we can use its code to create our own similar class.  The PGPExampleUtil method we can use as a base: <br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** * A simple routine that opens a key ring file and loads the first available key * suitable for encryption. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> input data stream containing the public key data * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> the first public key found. * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> IOException * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> PGPException */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> PGPPublicKey </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readPublicKey</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputStream input)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException, PGPException </span></span>{ PGPPublicKeyRingCollection pgpPub = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PGPPublicKeyRingCollection( PGPUtil.getDecoderStream(input), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JcaKeyFingerprintCalculator()); <span class="hljs-comment"><span class="hljs-comment">// // we just loop through the collection till we find a key suitable for encryption, in the real // world you would probably want to be a bit smarter about this. // Iterator keyRingIter = pgpPub.getKeyRings(); while (keyRingIter.hasNext()) { PGPPublicKeyRing keyRing = (PGPPublicKeyRing)keyRingIter.next(); Iterator keyIter = keyRing.getPublicKeys(); while (keyIter.hasNext()) { PGPPublicKey key = (PGPPublicKey)keyIter.next(); if (key.isEncryptionKey()) { return key; } } } throw new IllegalArgumentException("Can't find encryption key in key ring."); }</span></span></code> </pre><br>  In <a href="">portablepgp.core.KeyRing, a</a> similar problem is solved as follows: <br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> PGPPublicKeyRing </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">importPublicKey</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputStream iKeyStream)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ PGPPublicKeyRing newKey = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PGPPublicKeyRing(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArmoredInputStream(iKeyStream)); pubring = PGPPublicKeyRingCollection.addPublicKeyRing(pubring, newKey); savePubring(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> newKey; }</code> </pre><br>  Assuming that we need to remove only one (first) PGPPublicKey from PGPPublicKeyRing, we simply use <a href="https://www.bouncycastle.org/docs/pgdocs1.5on/org/bouncycastle/openpgp/PGPPublicKeyRing.html">.getPublicKey ()</a> and do not use an iterator (at the input of String, the method returns org.bouncycastle.openpgp.PGPPublicKey): <br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> PGPPublicKey </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">importPublicKey</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String armoredPublicPGPkeyBlock)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ InputStream in = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ByteArrayInputStream(armoredPublicPGPkeyBlock.getBytes()); PGPPublicKeyRing pgpPublicKeyRing = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PGPPublicKeyRing(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArmoredInputStream(in), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JcaKeyFingerprintCalculator()); in.close(); PGPPublicKey pgpPublicKey = pgpPublicKeyRing.getPublicKey(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pgpPublicKey; }</code> </pre><br>  Or we can completely copy the readPublicKey method from org.bouncycastle.openpgp.examples.PGPExampleUtil into our class, and add the class with the following method: <br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> PGPPublicKey </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readPublicKeyFromString</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String armoredPublicPGPkeyBlock)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException, PGPException </span></span>{ InputStream in = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ByteArrayInputStream(armoredPublicPGPkeyBlock.getBytes()); PGPPublicKey pgpPublicKey = readPublicKey(in); in.close(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pgpPublicKey; }</code> </pre><br><h4>  Key data display </h4><br>  Based on the object's <a href="https://www.bouncycastle.org/docs/pgdocs1.5on/org/bouncycastle/openpgp/PGPPublicKey.html">org.bouncycastle.openpgp.PGPPublicKey</a> object, we create a representation of key data that can be read by a person or stored in a database. <br><br>  For the simplest version of presenting public key data in a readable form, you can use the <a href="">portablepgp.core.PrintablePGPPublicKey</a> class with the toString () method: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> portablepgp.core; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Iterator; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.bouncycastle.openpgp.PGPPublicKey; <span class="hljs-comment"><span class="hljs-comment">/** * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> Primiano Tucci - http://www.primianotucci.com/ */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PrintablePGPPublicKey</span></span></span><span class="hljs-class"> </span></span>{ PGPPublicKey base; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrintablePGPPublicKey</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PGPPublicKey iBase)</span></span></span></span>{ base = iBase; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> PGPPublicKey </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPublicKey</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> base; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ StringBuilder outStr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); Iterator iter = base.getUserIDs(); outStr.append(<span class="hljs-string"><span class="hljs-string">"[0x"</span></span>); outStr.append(Integer.toHexString((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)base.getKeyID()).toUpperCase()); outStr.append(<span class="hljs-string"><span class="hljs-string">"] "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(iter.hasNext()){ outStr.append(iter.next().toString()); outStr.append(<span class="hljs-string"><span class="hljs-string">"; "</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> outStr.toString(); } }</code> </pre><br>  To store more complete information about the key, create a class PGPPublicKeyData with a constructor that retrieves data from <a href="https://www.bouncycastle.org/docs/pgdocs1.5on/org/bouncycastle/openpgp/PGPPublicKey.html">org.bouncycastle.openpgp.PGPPublicKey</a> : <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.common.base.Splitter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.Gson; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.bouncycastle.openpgp.PGPPublicKey; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.xml.bind.DatatypeConverter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Date; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Iterator; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PGPPublicKeyData</span></span></span><span class="hljs-class"> </span></span>{ String keyID; String userID; String firstName; String lastName; String userEmail; Date created; Date exp; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bitStrength; String asciiArmored; String fingerprint; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PGPPublicKeyData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PGPPublicKey pgpPublicKey)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// keyID StringBuilder keyIDstrBuilder = new StringBuilder(); keyIDstrBuilder.append("[0x"); keyIDstrBuilder.append(Integer.toHexString((int) pgpPublicKey.getKeyID()).toUpperCase()); keyIDstrBuilder.append("] "); this.keyID = keyIDstrBuilder.toString(); // userID StringBuilder userIDstrBuilder = new StringBuilder(); Iterator userIDsIterator = pgpPublicKey.getUserIDs(); while (userIDsIterator.hasNext()) { userIDstrBuilder.append(userIDsIterator.next().toString()); userIDstrBuilder.append("; "); } this.userID = userIDstrBuilder.toString(); // user's first and last name and email List&lt;String&gt; userIdList = Splitter.on(' ').trimResults().omitEmptyStrings().splitToList(userID); this.firstName = userIdList.get(0); this.lastName = userIdList.get(1); String userEmailDirty = userIdList.get(userIdList.size() - 1); this.userEmail = userEmailDirty.substring( 1, userEmailDirty.length() - 2 ); // fingerprint // [0xE77173E5] this.fingerprint = DatatypeConverter.printHexBinary( pgpPublicKey.getFingerprint() ); // creation date this.created = pgpPublicKey.getCreationTime(); // exp date this.exp = org.apache.commons.lang3.time.DateUtils.addSeconds(created, (int) pgpPublicKey.getValidSeconds()); // Bit strength this.bitStrength = pgpPublicKey.getBitStrength(); } public String toJSON() { Gson gson = new Gson(); return gson.toJson(this); } // ---------- Getters and Setters: }</span></span></code> </pre><br><br>  <i>To be continued</i> </div><p>Source: <a href="https://habr.com/ru/post/274779/">https://habr.com/ru/post/274779/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274759/index.html">Well tuned emacs</a></li>
<li><a href="../274765/index.html">Software Internet gateway for not a small company (Shorewall, buns). Part 4</a></li>
<li><a href="../274767/index.html">ProDBG switches to Rust</a></li>
<li><a href="../274771/index.html">Details of the test-first, which is so lacking</a></li>
<li><a href="../274775/index.html">Automatically launching Libre / OpenOffice in listening mode from Python</a></li>
<li><a href="../274785/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ193 (January 3 - 10, 2016)</a></li>
<li><a href="../274787/index.html">Happy Birthday to Donald Knut</a></li>
<li><a href="../274789/index.html">Open Source Society University</a></li>
<li><a href="../274791/index.html">Why and why write open source code?</a></li>
<li><a href="../274797/index.html">Vectorization, small bug and seven-crutch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>