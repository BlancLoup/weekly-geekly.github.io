<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Forms: we fix event of sending the form in Google Analytics</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 Google Forms is a design tool for creating feedback collection forms. Simple interface, data collection in a table, integration with the sit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Forms: we fix event of sending the form in Google Analytics</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/59/ee/e7/59eee73f8c55d301873884.png"><br>  Hello! <br><br>  <b>Google Forms</b> is a design tool for creating feedback collection forms.  Simple interface, data collection in a table, integration with the site.  For those cases when it is necessary with the minimum time expenses.  In general, if not yet used - I recommend. <br><br>  <b>Unfortunately, there are limitations:</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  Separately, no Google Analytics counter can be added to the form.  Even technologically, the forms are hosted on Google domains, so users' identifiers would still be different. </li><li>  Integration with the site is possible only through iframe.  These are big restrictions - we cannot track events inside the iframe. </li></ol><br>  <b>Therefore, pains appear:</b> <br><br><ul><li>  The soul of the marketer requires a report on traffic sources with the number of ‚ÄúForm Submission‚Äù conversions for each of them. </li><li>  And how else to pour traffic on the form, not understanding what channel the application is converted? </li></ul><br><h2>  Solve problems </h2><br>  I‚Äôll say right away that this is not a single pill for all diseases, but a practical case of how you can integrate Google Forms with Google Analytics, that is, an instruction for getting acquainted with the technology. <a name="habracut"></a><br><br>  <b>Algorithm:</b> <br><br><ul><li>  Creating a new form </li><li>  We receive the link for the publication of the form with the pre-filled data </li><li>  Create a table to collect survey results </li><li>  Add a script to sync with Google Analytics </li><li>  We connect the form to the site </li><li>  Customize goal in Google Analytics </li></ul><br><h2>  Form setting </h2><br><h3>  Form creation </h3><br>  Open Google Drive and create a new form for your needs. <br><br>  Add the field ‚Äú <b>Your application number</b> ‚Äù, in which we automatically add the value cid - the unique client identifier (Client ID) in Google Analytics. <br><br><img src="https://habrastorage.org/webt/59/ee/e7/59eee73fdd890416709710.png"><br><br><h3>  We receive the link for the publication with the pre-filled fields </h3><br>  Open the menu, select the item <b>Get pre-filled link</b> . <br><br><img src="https://habrastorage.org/webt/59/ee/e7/59eee73fe01cc052622334.png"><br><br>  A new tab will open with your form, where you need to fill in the fields that you want to pre-fill through the link.  We write the value test1 in the field ‚Äú <b>Your application number</b> ‚Äù, click <b>Submit</b> . <br><br>  The service will give us a link to the form, something like: <br>  <i><a href="https://docs.google.com/forms/d/e/1FAIpQLSdh9ZudNKvUYPfY9paH48fUGAW-bx-Rdg7vK0HyOXZVXr4H4Q/viewform%3Fusp%3Dpp_url%26entry.1658302485%3Dtest1">docs.google.com/forms/d/e/1FAIpQLSdh9ZudNKvUYPfY9paH48fUGAW-bx-Rdg7vK0HyOXZVXr4H4Q/viewform?usp=pp_url&amp;entry.1658302485=test1</a></i> <br><br>  Pay attention to the parameter in the link <b>entry.1658302485</b> .  That is, through these parameters you can set values ‚Äã‚Äãthat will be automatically displayed in the form when it is opened. <br><br>  <i>Attention!</i>  <i>You have these fields will have other identifiers <i>entry.XXXXXXXX</i> .</i> <br><br>  Ok, save the link. <br><br><h3>  Creating a table for storing results </h3><br>  Open the tab with the form editing page, go to the ‚ÄúAnswers‚Äù ‚Äã‚Äãsection and click on the ‚ÄúTable‚Äù icon.  Select the item ‚ÄúCreate a new one‚Äù, write an arbitrary table name. <br><br><img src="https://habrastorage.org/webt/59/ee/e7/59eee7401db92087188461.png"><br><br>  So, when filling out the form, the results will fall into this table. <br><br><h3>  Adding a script to synchronize with Google Analytics </h3><br>  To notify Google Analytics about successful completion of the form, use the <a href="https://habrahabr.ru/company/englishdom/blog/326788/">Measurement Protocol</a> .  That is, we need to send an event to GA, and already in GA to set up a goal tracking for this event. <br><br>  In the form table with answers, open Menu - Tools - Script Editor. <br><br><img src="https://habrastorage.org/webt/59/ee/e7/59eee7403556a002164778.png"><br><br>  Paste function: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> sendToGa(e) { var <span class="hljs-type"><span class="hljs-type">timestamp</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">Date</span></span>().getTime(); var counter_id = "UA-100347089-2"; <span class="hljs-comment"><span class="hljs-comment">/*   ID   Google Analytics */</span></span> var mesurement_url = "https://www.google-analytics.com/collect?v=1&amp;tid="+ counter_id +"&amp;cid="+ e.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'_'</span></span>,<span class="hljs-string"><span class="hljs-string">'.'</span></span>) +"&amp;t=event&amp;ec=google_form&amp;ea=submit&amp;z="+<span class="hljs-type"><span class="hljs-type">timestamp</span></span>; var response = UrlFetchApp.<span class="hljs-keyword"><span class="hljs-keyword">fetch</span></span>(mesurement_url); Logger.log(e); }</code> </pre> <br>  Save - <b>floppy icon or CTRL + S.</b> <br><br>  Now we need this function to work every time after filling out the form. <br><br>  Click on the <b>Triggers</b> icon. <br><br><img src="https://habrastorage.org/webt/59/ee/e7/59eee7405fa7d764817255.png"><br><br>  Choose your function, set the From Spreadsheet event -&gt; On submit. <br><br>  Click save and allow to execute the script on your behalf (a window will appear with a dialog about allowing access). <br><br><h2>  Adding to the site </h2><br>  We will connect the form via iFrame using JS. <br><br>  Google ClientID (cid) can be obtained from the Google Analytics Tracker.  That is, our script needs to be placed below the GA counter (if you connected GA through the Tag Manager - you need to adjust the order of execution of the tag after the GA tag). <br><br>  Script (note the comments): <br><br><pre> <code class="hljs javascript">ga(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">tracker</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*  cid   Gogle Analytics  .  _,   -                 -   . */</span></span> cid = tracker.get(<span class="hljs-string"><span class="hljs-string">'clientId'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'.'</span></span>,<span class="hljs-string"><span class="hljs-string">'_'</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* */</span></span> <span class="hljs-comment"><span class="hljs-comment">/*  iframe */</span></span> form_f = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'iframe'</span></span>); form_f.style = <span class="hljs-string"><span class="hljs-string">'border:0px;width:100%;'</span></span>; form_f.id = <span class="hljs-string"><span class="hljs-string">'my_google_form'</span></span>; form_f.scrolling = <span class="hljs-string"><span class="hljs-string">'no'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*  src   cid : 1)      . 2)   entry.1658302485    (.  ) */</span></span> form_f.src = <span class="hljs-string"><span class="hljs-string">'https://docs.google.com/forms/d/e/1FAIpQLSdh9ZudNKvUYPfY9paH48fUGAW-bx-Rdg7vK0HyOXZVXr4H4Q/viewform?usp=pp_url&amp;entry.1658302485='</span></span>+ cid; <span class="hljs-comment"><span class="hljs-comment">/*  iframe  div c id="form_div" */</span></span> <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'form_div'</span></span>).appendChild(form_f); });</code> </pre><br>  Now on the page of our site you need to add a block where iFrame will be added with the Google form: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form_div"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  This way the iframe will be loaded into which the user's cid will be pulled. <br><br>  An example of a working form: <a href="http://l.englishdom.com/test-form/">l.englishdom.com/test-form</a> <br><br>  After submitting the form, an event will be sent to Google Analytics (category: google_form, action: submit). <br><br><img src="https://habrastorage.org/webt/59/ee/e7/59eee73f886b4475480254.png"><br><br>  For this event, you can set up conversion tracking. <br><br>  Thus, some time after the introduction, you will see from which sources visitors are better converted into filling out a form. <br><br>  Good luck! <br><br><h2>  Reader Bonuses </h2><br><h3>  Online Courses </h3><br>  We give free access to three months of learning English through our online courses.  To do this, simply follow the <a href="https://www.englishdom.com/myprofile/purchases/xabra3/%3Futm_medium%3Dpr%26utm_source%3Dhabra%26utm_campaign%3Dgoogle%2520forms241017">link</a> until December 31, 2017. <br><br><h3>  Individually by Skype </h3><br>  We will be glad to see you at the individual lessons of the course ‚ÄúEnglish for IT-specialists‚Äù. <br>  Take a <a href="https://www.englishdom.com/it-course/%3Futm_medium%3Dpr%26utm_source%3Dhabra%26utm_campaign%3Dgoogle%2520forms241017">free introductory lesson</a> and get a comprehensive feedback on your level of knowledge, then choose a teacher and a training program for yourself to your liking! </div><p>Source: <a href="https://habr.com/ru/post/340866/">https://habr.com/ru/post/340866/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340854/index.html">Smart nets for fishermen: how we taught smartphones to recognize fish</a></li>
<li><a href="../340856/index.html">How to tie a normal search to an outdated SQL backend</a></li>
<li><a href="../340858/index.html">As I stopped worrying and started cutting rectangles in Unity correctly</a></li>
<li><a href="../340860/index.html">Forward to the past: IT departments of companies 2018</a></li>
<li><a href="../340862/index.html">Linux Piter # 3: what about this time?</a></li>
<li><a href="../340868/index.html">Design for iPhone X. Guidelines for iOS 11</a></li>
<li><a href="../340870/index.html">Tale of sysctl (penguin folk story)</a></li>
<li><a href="../340872/index.html">Cloud Digest: about technologies, SSL certificates and IaaS provider operation</a></li>
<li><a href="../340874/index.html">‚ÄúActive Search‚Äù: how we chose the search engine for the DLP system</a></li>
<li><a href="../340876/index.html">Check whether the service pack is present on the system before installation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>