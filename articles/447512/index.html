<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>And who did this? We automate the audit of information security</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A source 

 It is believed that there are three approaches to the diagnosis of information security: auditing, vulnerability assessment and penetratio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>And who did this? We automate the audit of information security</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/hb/ud/ch/hbudchxsbwpjhocghpojhxtupqq.jpeg"><br>  <i><a href="https://rutube.ru/video/a4a14f155aa4246c648bf5429d5fe008/">A source</a></i> <br><br>  It is believed that there are three approaches to the diagnosis of information security: auditing, vulnerability assessment and penetration tests.  Let's talk about auditing and vulnerability assessment.  Under the cat, we consider the issues that need to be addressed as part of the audit, and a set of tools from Quest Software to identify, prevent and investigate information security incidents based on machine learning (Change Auditor Threat Detection), collect logs from infrastructure objects (InTrust), audit configuration (Enterprise Reporter) and the output of audit data on all listed systems in one interface (IT Security Search). <br><a name="habracut"></a><br>  An IT security audit determines whether the information system and its support are in line with customer expectations and company standards.  From our point of view, the audit system should have the following capabilities: <br><br><ul><li>  identify and detect normal and atypical activity; </li><li>  construct queries and filter data in an array of events to get the necessary information; </li><li>  escalate events to a group of responsible; </li><li>  have preconfigured reports that can be used to detect atypical activity. </li></ul><br>  The peculiarity of working with infosers, which we often see, is the performance of an audit on the residual basis.  That is, the change audit is performed by the department, which is also loaded with other tasks.  This implies the first problem - 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Using embedded audit tools</b> <br><br>  There is not enough time to search and configure others.  By built-in tools we mean, for example, a Windows snap-in or special Power Shell scripts.  Of course, with the help of such means, an incident can only be known after the fact. <br><br>  As the organization grows, the number of users and changes grows.  There are studies with specific figures on this topic, but even without this, it is clear that digital exchange changes in a big way every year.  The second audit problem is <br><br>  <b>Increased number of changes due to infrastructure growth</b> <br><br>  Growth may be associated with an increase in staff or the number of customers, but regardless of this, the amount of the number of changes will increase proportionally. <br>  Audit is seriously influenced not only by internal factors (these are the first two problems), but also external - by the requirements of state bodies or corporate policies.  And we come to the third audit issue - <br><br>  <b>Lack of suitable tools to meet the requirements</b> <br><br>  In the absence of suitable tools, system administrators either do not control the required changes, or do it, but with improvised means (see problem 1). <br>  And now we turn to a review of tools that can help with the answer to the question: ‚ÄúAnd who did this?‚Äù (In fact, they will help with the answer to a bunch of other questions). <br><br><h2>  Operational audit of information security events </h2><br>  When we come to some companies for installation meetings, we see Power Shell based audit systems.  Scripts are usually supported by a single Windows administrator.  This is not a serious problem until the employee is dismissed.  After his departure, the question arises: who will continue to support and develop this.  A new administrator (if he has sufficient competence) usually writes such scripts again.  And these are not isolated cases. <br><br>  Change Auditor is a tool for operational audit of changes in the Microsoft environment and on disk arrays, which does not require the knowledge of a single person. <br><br><img src="https://habrastorage.org/webt/td/8z/no/td8znosb5tmc-kbsqfew6oj-mzm.png"><br><br>  Auditing is supported: AD, Azure AD, SQL Server, Exchange, Exchange Online, Sharepoint, Sharepoint Online, Windows File Server, OneDrive for Business, Skype for Business, VMware, NetApp, EMC, FluidFS.  Suitable for hybrid environments.  There are predefined reports for compliance with the standards of GDPR, SOX, PCI, HIPAA, FISMA, GLBA. <br><br><img src="https://habrastorage.org/webt/f8/lv/be/f8lvbeetxjlgzukvise8m4ktra0.png"><br><br>  In addition to auditing, you can block changes in Change Auditor.  For example, prohibit adding new users to the AD group or prohibiting a file / folder change. <br><br>  Change Auditor has an additional analytics module - Threat Detection. <br><br><img src="https://habrastorage.org/webt/rx/zt/je/rxztjecdvxk2pdgmuxwt5dpd4gs.jpeg"><br><br>  Works on the basis of machine learning (ML) and user behavior analysis (UEBA).  At the entrance, it receives events from Change Auditor over the past 30 days and identifies atypical user behavior: entering from an unusual place or at an unusual time, unsuccessful password entry several times in a row on a domain controller, entering a forbidden file share, etc.  The module analyzes events in several dimensions and reports anomalies. <br><br><h2>  Infrastructure Configuration Audit </h2><br>  For those who have long wanted to bring order to their Windows-infrastructure, but still can not reach the hands.  Enterprise Reporter, a reporting tool, extracts data on objects from AD, Azure AD, SQL Server, Exchange Online, Windows Online Server, OneDrive for Business and Azure resources (virtual machines, network security groups and other objects) and builds beautiful reports. <br><br><img src="https://habrastorage.org/webt/01/jv/wv/01jvwvx0obzd1lwlw_6mlkh-oyu.jpeg"><br><br>  The main value of the product is an existing set of reports, which allows you to see the vulnerabilities immediately after installation.  For example, at one of our customers, we found users in groups of domain administrators with the password expiration option disabled. <br><br><img src="https://habrastorage.org/webt/xt/oq/ro/xtoqroekdxlqqspt4dxguh1oee4.png"><br><br>  From the already prepared reports: <br><br><ul><li>  users who have not logged in the past 30 days; </li><li>  expired users; </li><li>  privileged group users who have not logged in the past 30 days; </li><li>  Windows services that do not work under the local system account; </li><li>  Software installed on servers with the role of a domain controller; </li><li>  hotfixes installed on servers; </li><li>  security settings on servers; </li><li>  nested groups and users in nested groups </li><li>  Active Directory permissions; </li><li>  permissions for folders on file storage and others. </li></ul><br>  Examples of the listed reports can be <a href="https://www.quest.com/docs/techbrief-securityposture-enterprisereporter-technical-brief-23533.pdf">viewed on the Quest website</a> in a PDF report (the file opens immediately, registration is not needed).  There are predefined reports for compliance with the standards of GDPR, SOX, PCI-DSS, HIPAA, FISMA, GLBA and others.  And if in your company there are requirements for reports or you want to brand a document - there is a special designer. <br><br><img src="https://habrastorage.org/webt/-n/bp/t6/-nbpt66s0onqzy71nwwimoufako.png"><br><br><h2>  Logging and analysis </h2><br>  Another source of information on information security events is logs.  You can find in them, if not all, then almost everything.  After collecting them, it would be good to normalize and structure them in order to carry out a correlation between events, for example, in AD and some text logs. <br><br>  InTrust is a tool for collecting and analyzing logs from disparate sources.  It can take Windows logs, text logs and syslog from network devices.  After collecting all the statistics (events) is reduced to the state of the form: when it happened, what happened, where it happened, who performed the action, from where this action was performed. <br><br><img src="https://habrastorage.org/webt/ed/cj/mh/edcjmhpq4bnjjk9e0hphjkz1pja.png"><br><br>  InTrust can handle up to 60,000 events per second from 10,000 sources.  Often, collection agents are installed on workstations to track Windows eventlog Sysmon events (tracking changes in registry values, creating new processes with incorrect hashes, and others), PowerShell logs. <br><br><img src="https://habrastorage.org/webt/37/2u/-o/372u-orkz4my8plnhknsfk8xe78.png"><br><br>  Raw data is stored in built-in storage with a compression ratio of 20: 1.  There are ready-made integrations with some SIEM systems.  If you use them, InTrust is a convenient way to save on licenses, since  stores raw data in its storage and sends only events to SIEM. <br><br><h2>  Pool under the umbrella </h2><br>  To make the security concept look complete, it is advisable to combine data from all sources and observe what is happening in one window.  Additionally, correlate events for lightning-fast root cause detection. <br><br>  IT Security Search is a tool for global full-text search a'lya Google according to operational audit data, audit of infrastructure configuration and data from logs.  All data is retrieved in real time from related systems. <br><br><img src="https://habrastorage.org/webt/zt/bg/l3/ztbgl39hknlqohozt6thonu1g0m.png"><br><br>  You can enter a username, workstation, event type, or anything else and discover related events or configurations.  When making queries, you can use logical expressions.  From the results of the request, it is convenient to build reports and send them to interested parties on a schedule. <br><br><img src="https://habrastorage.org/webt/bt/vu/wa/btvuway29q2dtvpdj1ov_pbvxcu.jpeg"><br><br>  You can also roll back from changes in AD from the IT Security Search interface.  That is, for example, you can restore a user deleted by mistake, with all its attributes.  This is implemented through integration with another Quest product - Recovery Manager for Active Directory. <br><br>  The main goal of the article is to introduce the Quest product family to audit changes.  Those tools that you use now may have a different set of functions (somewhere more, somewhere less).  Write in the comments what you have to deal with, what functions have proven to be useful for you and why you chose this or that solution.  It is interesting to share experiences. </div><p>Source: <a href="https://habr.com/ru/post/447512/">https://habr.com/ru/post/447512/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447498/index.html">Photo report with JPoint 2019 + Joker 2019 announcement in St. Petersburg</a></li>
<li><a href="../447500/index.html">Why are operators scared by eSIM</a></li>
<li><a href="../447502/index.html">How to create a resume for foreign it-companies</a></li>
<li><a href="../447508/index.html">Sergey Zonov: ‚ÄúI did the first Spectrum because I was interested‚Äù</a></li>
<li><a href="../447510/index.html">GeekUniversity opens a set of design faculty</a></li>
<li><a href="../447516/index.html">How we dispersed CAD KOMPAS-3D ‚Üí Part 2</a></li>
<li><a href="../447522/index.html">What is useful you can get out of the logs of the workstation based on Windows</a></li>
<li><a href="../447526/index.html">Your bike to sync MariaDB and Sphinx</a></li>
<li><a href="../447528/index.html">Who is responsible for the quality?</a></li>
<li><a href="../447530/index.html">OceanLotus: Malvari update for macOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>