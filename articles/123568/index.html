<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Behind the wheel of a vacuum cleaner or smart Firefox</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The browser that follows the links, opens / closes tabs, parses, or saves all the content on the file system - it's interesting to look at this, isn't...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Behind the wheel of a vacuum cleaner or smart Firefox</h1><div class="post__text post__text-html js-mediator-article">  The browser that follows the links, opens / closes tabs, parses, or saves all the content on the file system - it's interesting to look at this, isn't it?  Personally, I was interested to create something like that.  No fiction!  In general, once again, something like <s>a lazy programmer‚Äôs laziness of</s> inspiration woke up in me and instead of writing a regular crawler (aka spider or simply site parser) in PHP, Perl or Ruby, I began to figure out how to do it on FireFox. <br><a name="habracut"></a><br><h4>  Training </h4><br>  In order to do all this, I needed a JavaScript console from which I would have access to the XUL DOM.  I wrote a very simple Firefox extension that adds an icon to the lower right corner of the browser window. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/206/421/d4d/206421d4d3d94507ee19c80ab25710e4.jpg" alt="image"><br><br>  Clicking this icon will open a window in which you can write JavaScript code and manage browser elements.  The extension can be downloaded <a href="">here</a> . <br>  To run the script, press CTRL + Enter (the focus should be on the textbox element). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  For those who are in the tank </h4><br>  Since not all programmers are familiar with JavaScript objects in FireFox itself, I think a bit of theory will be useful.  By analogy with HTML, the ‚Äúadvanced players‚Äù are window and document.  To access the content (HTML DOM) you need to write <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> links = window.content. <font color="#0000ff">document</font> .getElementsByTagName( <font color="#A31515">'a'</font> ); <br> <font color="#008000">// or just</font> <br> <font color="#0000ff">var</font> links = content. <font color="#0000ff">document</font> .querySelectorAll( <font color="#A31515">'a'</font> ); <br> alert(links.length)</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> links = window.content. <font color="#0000ff">document</font> .getElementsByTagName( <font color="#A31515">'a'</font> ); <br> <font color="#008000">// or just</font> <br> <font color="#0000ff">var</font> links = content. <font color="#0000ff">document</font> .querySelectorAll( <font color="#A31515">'a'</font> ); <br> alert(links.length)</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> links = window.content. <font color="#0000ff">document</font> .getElementsByTagName( <font color="#A31515">'a'</font> ); <br> <font color="#008000">// or just</font> <br> <font color="#0000ff">var</font> links = content. <font color="#0000ff">document</font> .querySelectorAll( <font color="#A31515">'a'</font> ); <br> alert(links.length)</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br>  Another very important point is how to catch the moment of loading HTML DOM, as well as how to work with tabs and browser.  You can use the global variable <a href="https://developer.mozilla.org/en/Code_snippets/Tabbed_browser">gBrowser</a> to refer to the <a href="https://developer.mozilla.org/en/XUL/tabbrowser">tabbrowser</a> element.  With this element you can manipulate tabs.  A few examples <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">// add new tab</font> <br> <font color="#0000ff">var</font> tab = gBrowser.addTab( <font color="#A31515">'http://habrahabr.ru'</font> ); <br> gBrowser.selectedTab = tab; <br> <br> <font color="#008000">// get browser element for tab</font> <br> <font color="#0000ff">var</font> browser = gBrowser.getBrowserForTab(tab); <br> <br> <font color="#008000">// add listeners on page load</font> <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#008000">// listener implementation</font> <br> }, <font color="#0000ff">false</font> ); <br> <br> <font color="#008000">// add listeners on HTML DOM loaded</font> <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#0000ff">if</font> ( <font color="#0000ff">event</font> .originalTarget instanceof HTMLDocument) { <br> <font color="#0000ff">var</font> <font color="#0000ff">document</font> = <font color="#0000ff">event</font> .originalTarget; <br> <font color="#008000">// listener implementation</font> <br> } <br> }, <font color="#0000ff">false</font> );</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">// add new tab</font> <br> <font color="#0000ff">var</font> tab = gBrowser.addTab( <font color="#A31515">'http://habrahabr.ru'</font> ); <br> gBrowser.selectedTab = tab; <br> <br> <font color="#008000">// get browser element for tab</font> <br> <font color="#0000ff">var</font> browser = gBrowser.getBrowserForTab(tab); <br> <br> <font color="#008000">// add listeners on page load</font> <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#008000">// listener implementation</font> <br> }, <font color="#0000ff">false</font> ); <br> <br> <font color="#008000">// add listeners on HTML DOM loaded</font> <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#0000ff">if</font> ( <font color="#0000ff">event</font> .originalTarget instanceof HTMLDocument) { <br> <font color="#0000ff">var</font> <font color="#0000ff">document</font> = <font color="#0000ff">event</font> .originalTarget; <br> <font color="#008000">// listener implementation</font> <br> } <br> }, <font color="#0000ff">false</font> );</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">// add new tab</font> <br> <font color="#0000ff">var</font> tab = gBrowser.addTab( <font color="#A31515">'http://habrahabr.ru'</font> ); <br> gBrowser.selectedTab = tab; <br> <br> <font color="#008000">// get browser element for tab</font> <br> <font color="#0000ff">var</font> browser = gBrowser.getBrowserForTab(tab); <br> <br> <font color="#008000">// add listeners on page load</font> <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#008000">// listener implementation</font> <br> }, <font color="#0000ff">false</font> ); <br> <br> <font color="#008000">// add listeners on HTML DOM loaded</font> <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#0000ff">if</font> ( <font color="#0000ff">event</font> .originalTarget instanceof HTMLDocument) { <br> <font color="#0000ff">var</font> <font color="#0000ff">document</font> = <font color="#0000ff">event</font> .originalTarget; <br> <font color="#008000">// listener implementation</font> <br> } <br> }, <font color="#0000ff">false</font> );</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br>  I also think it will be useful to learn how to save the web page to a file. <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> tab = gBrowser.addTab( <font color="#A31515">'http://habrahabr.ru'</font> ); <br> gBrowser.selectedTab = tab; <br> <font color="#0000ff">var</font> browser = gBrowser.getBrowserForTab(tab); <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#0000ff">var</font> <font color="#0000ff">document</font> = <font color="#0000ff">event</font> .originalTarget; <br> <font color="#0000ff">if</font> ( <font color="#0000ff">document</font> instanceof HTMLDocument &amp;&amp; <font color="#0000ff">this</font> .contentWindow. <font color="#0000ff">document</font> == <font color="#0000ff">document</font> ) { <br> <font color="#0000ff">var</font> basename = <font color="#0000ff">document</font> .location.href.replace(/\/+$/, <font color="#A31515">''</font> ), <br> pos = basename.lastIndexOf( <font color="#A31515">'/'</font> ); <br> <font color="#0000ff">if</font> (pos != -1) { <br> basename = basename.substr(pos+1); <br> } <br> <br> <font color="#0000ff">var</font> file = Components.classes[ <font color="#A31515">"@mozilla.org/file/local;1"</font> ].createInstance(Components.interfaces.nsILocalFile); <br> file.initWithPath( <font color="#A31515">'/tmp/'</font> +basename); <br> <font color="#0000ff">if</font> (!file.exists()) { <br> <font color="#0000ff">var</font> chosen = <font color="#0000ff">new</font> AutoChosen(file, makeFileURI(file)); <br> internalSave( <font color="#0000ff">document</font> .location.href, <font color="#0000ff">document</font> , <font color="#0000ff">null</font> , <font color="#0000ff">null</font> , <font color="#0000ff">document</font> .contentType, <font color="#0000ff">false</font> , <font color="#0000ff">null</font> , chosen); <br> } <br> } <br> }, <font color="#0000ff">false</font> )</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> tab = gBrowser.addTab( <font color="#A31515">'http://habrahabr.ru'</font> ); <br> gBrowser.selectedTab = tab; <br> <font color="#0000ff">var</font> browser = gBrowser.getBrowserForTab(tab); <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#0000ff">var</font> <font color="#0000ff">document</font> = <font color="#0000ff">event</font> .originalTarget; <br> <font color="#0000ff">if</font> ( <font color="#0000ff">document</font> instanceof HTMLDocument &amp;&amp; <font color="#0000ff">this</font> .contentWindow. <font color="#0000ff">document</font> == <font color="#0000ff">document</font> ) { <br> <font color="#0000ff">var</font> basename = <font color="#0000ff">document</font> .location.href.replace(/\/+$/, <font color="#A31515">''</font> ), <br> pos = basename.lastIndexOf( <font color="#A31515">'/'</font> ); <br> <font color="#0000ff">if</font> (pos != -1) { <br> basename = basename.substr(pos+1); <br> } <br> <br> <font color="#0000ff">var</font> file = Components.classes[ <font color="#A31515">"@mozilla.org/file/local;1"</font> ].createInstance(Components.interfaces.nsILocalFile); <br> file.initWithPath( <font color="#A31515">'/tmp/'</font> +basename); <br> <font color="#0000ff">if</font> (!file.exists()) { <br> <font color="#0000ff">var</font> chosen = <font color="#0000ff">new</font> AutoChosen(file, makeFileURI(file)); <br> internalSave( <font color="#0000ff">document</font> .location.href, <font color="#0000ff">document</font> , <font color="#0000ff">null</font> , <font color="#0000ff">null</font> , <font color="#0000ff">document</font> .contentType, <font color="#0000ff">false</font> , <font color="#0000ff">null</font> , chosen); <br> } <br> } <br> }, <font color="#0000ff">false</font> )</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> tab = gBrowser.addTab( <font color="#A31515">'http://habrahabr.ru'</font> ); <br> gBrowser.selectedTab = tab; <br> <font color="#0000ff">var</font> browser = gBrowser.getBrowserForTab(tab); <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#0000ff">var</font> <font color="#0000ff">document</font> = <font color="#0000ff">event</font> .originalTarget; <br> <font color="#0000ff">if</font> ( <font color="#0000ff">document</font> instanceof HTMLDocument &amp;&amp; <font color="#0000ff">this</font> .contentWindow. <font color="#0000ff">document</font> == <font color="#0000ff">document</font> ) { <br> <font color="#0000ff">var</font> basename = <font color="#0000ff">document</font> .location.href.replace(/\/+$/, <font color="#A31515">''</font> ), <br> pos = basename.lastIndexOf( <font color="#A31515">'/'</font> ); <br> <font color="#0000ff">if</font> (pos != -1) { <br> basename = basename.substr(pos+1); <br> } <br> <br> <font color="#0000ff">var</font> file = Components.classes[ <font color="#A31515">"@mozilla.org/file/local;1"</font> ].createInstance(Components.interfaces.nsILocalFile); <br> file.initWithPath( <font color="#A31515">'/tmp/'</font> +basename); <br> <font color="#0000ff">if</font> (!file.exists()) { <br> <font color="#0000ff">var</font> chosen = <font color="#0000ff">new</font> AutoChosen(file, makeFileURI(file)); <br> internalSave( <font color="#0000ff">document</font> .location.href, <font color="#0000ff">document</font> , <font color="#0000ff">null</font> , <font color="#0000ff">null</font> , <font color="#0000ff">document</font> .contentType, <font color="#0000ff">false</font> , <font color="#0000ff">null</font> , chosen); <br> } <br> } <br> }, <font color="#0000ff">false</font> )</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br>  The additional condition this.contentWindow.document == document filters situations when there are iframe elements on the page, and the page needs to be saved only once and that which is needed, and not from the frame. <br>  About the function internalSave (saves the file) and the class AutoChosen (as I understood it emulates the choice of the file by the user) you can read the comments in the <a href="">source code</a> .  More examples of working with files <a href="https://developer.mozilla.org/en/Code_snippets/File_I%252F%252FO">here</a> . <br><br><h4>  We train FireFox </h4><br>  Let's write a script that will teach FireFox to log in with a specific user on Habr. <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> Crawler = { <br> habrahabr: <font color="#0000ff">function</font> (username, password) { <br> <font color="#0000ff">this</font> .username = username; <br> <font color="#0000ff">this</font> .password = password; <br> }, <br> onHTMLLoaded: <font color="#0000ff">function</font> (browser, callback) { <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#0000ff">var</font> <font color="#0000ff">document</font> = <font color="#0000ff">event</font> .originalTarget; <br> <font color="#0000ff">if</font> ( <font color="#0000ff">document</font> instanceof HTMLDocument <br> &amp;&amp; <font color="#0000ff">this</font> .contentWindow. <font color="#0000ff">document</font> == <font color="#0000ff">document</font> <br> ) { <br> <font color="#0000ff">this</font> .removeEventListener( <font color="#A31515">'DOMContentLoaded'</font> , arguments.callee, <font color="#0000ff">false</font> ); <br> callback.call( <font color="#0000ff">this</font> , <font color="#0000ff">event</font> , <font color="#0000ff">document</font> ); <br> } <br> }, <font color="#0000ff">false</font> ); <br> <font color="#0000ff">return</font> browser; <br> } <br> } <br> <br> Crawler.habrahabr.prototype = { <br> url: <font color="#A31515">'http://habrahabr.ru/'</font> , <br> openAndSignIn: <font color="#0000ff">function</font> (inNewTab) { <br> <font color="#0000ff">var</font> tab = gBrowser.selectedTab, browser = <font color="#0000ff">null</font> ; <br> <font color="#0000ff">if</font> (inNewTab) { <br> tab = gBrowser.addTab( <font color="#0000ff">this</font> .url); <br> } <font color="#0000ff">else</font> { <br> content. <font color="#0000ff">document</font> .location = <font color="#0000ff">this</font> .url; <br> } <br> browser = gBrowser.getBrowserForTab(tab); <br> <font color="#0000ff">var</font> that = <font color="#0000ff">this</font> ; <br> Crawler.onHTMLLoaded(browser, <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> , <font color="#0000ff">document</font> ){ <br> <font color="#0000ff">document</font> .location = <font color="#0000ff">document</font> .querySelector( <font color="#A31515">'dl.panel-personal a'</font> ).href; <br> Crawler.onHTMLLoaded( <font color="#0000ff">this</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> , <font color="#0000ff">document</font> ){ <br> <font color="#0000ff">var</font> user  = <font color="#0000ff">document</font> .getElementById( <font color="#A31515">'reg-f-username'</font> ); <br> user.value = that.username; <br> <font color="#0000ff">document</font> .getElementById( <font color="#A31515">'reg-f-password'</font> ).value = that.password; <br> user.form.querySelector( <font color="#A31515">'input[type="submit"]'</font> ).click(); <br> }); <br> }); <br> } <br> }; <br> <font color="#0000ff">var</font> cr = <font color="#0000ff">new</font> Crawler.habrahabr( <font color="#A31515">'serjoga'</font> , <font color="#A31515">'***'</font> ); <br> cr.openAndSignIn( <font color="#0000ff">true</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> Crawler = { <br> habrahabr: <font color="#0000ff">function</font> (username, password) { <br> <font color="#0000ff">this</font> .username = username; <br> <font color="#0000ff">this</font> .password = password; <br> }, <br> onHTMLLoaded: <font color="#0000ff">function</font> (browser, callback) { <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#0000ff">var</font> <font color="#0000ff">document</font> = <font color="#0000ff">event</font> .originalTarget; <br> <font color="#0000ff">if</font> ( <font color="#0000ff">document</font> instanceof HTMLDocument <br> &amp;&amp; <font color="#0000ff">this</font> .contentWindow. <font color="#0000ff">document</font> == <font color="#0000ff">document</font> <br> ) { <br> <font color="#0000ff">this</font> .removeEventListener( <font color="#A31515">'DOMContentLoaded'</font> , arguments.callee, <font color="#0000ff">false</font> ); <br> callback.call( <font color="#0000ff">this</font> , <font color="#0000ff">event</font> , <font color="#0000ff">document</font> ); <br> } <br> }, <font color="#0000ff">false</font> ); <br> <font color="#0000ff">return</font> browser; <br> } <br> } <br> <br> Crawler.habrahabr.prototype = { <br> url: <font color="#A31515">'http://habrahabr.ru/'</font> , <br> openAndSignIn: <font color="#0000ff">function</font> (inNewTab) { <br> <font color="#0000ff">var</font> tab = gBrowser.selectedTab, browser = <font color="#0000ff">null</font> ; <br> <font color="#0000ff">if</font> (inNewTab) { <br> tab = gBrowser.addTab( <font color="#0000ff">this</font> .url); <br> } <font color="#0000ff">else</font> { <br> content. <font color="#0000ff">document</font> .location = <font color="#0000ff">this</font> .url; <br> } <br> browser = gBrowser.getBrowserForTab(tab); <br> <font color="#0000ff">var</font> that = <font color="#0000ff">this</font> ; <br> Crawler.onHTMLLoaded(browser, <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> , <font color="#0000ff">document</font> ){ <br> <font color="#0000ff">document</font> .location = <font color="#0000ff">document</font> .querySelector( <font color="#A31515">'dl.panel-personal a'</font> ).href; <br> Crawler.onHTMLLoaded( <font color="#0000ff">this</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> , <font color="#0000ff">document</font> ){ <br> <font color="#0000ff">var</font> user  = <font color="#0000ff">document</font> .getElementById( <font color="#A31515">'reg-f-username'</font> ); <br> user.value = that.username; <br> <font color="#0000ff">document</font> .getElementById( <font color="#A31515">'reg-f-password'</font> ).value = that.password; <br> user.form.querySelector( <font color="#A31515">'input[type="submit"]'</font> ).click(); <br> }); <br> }); <br> } <br> }; <br> <font color="#0000ff">var</font> cr = <font color="#0000ff">new</font> Crawler.habrahabr( <font color="#A31515">'serjoga'</font> , <font color="#A31515">'***'</font> ); <br> cr.openAndSignIn( <font color="#0000ff">true</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> Crawler = { <br> habrahabr: <font color="#0000ff">function</font> (username, password) { <br> <font color="#0000ff">this</font> .username = username; <br> <font color="#0000ff">this</font> .password = password; <br> }, <br> onHTMLLoaded: <font color="#0000ff">function</font> (browser, callback) { <br> browser.addEventListener( <font color="#A31515">'DOMContentLoaded'</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> ){ <br> <font color="#0000ff">var</font> <font color="#0000ff">document</font> = <font color="#0000ff">event</font> .originalTarget; <br> <font color="#0000ff">if</font> ( <font color="#0000ff">document</font> instanceof HTMLDocument <br> &amp;&amp; <font color="#0000ff">this</font> .contentWindow. <font color="#0000ff">document</font> == <font color="#0000ff">document</font> <br> ) { <br> <font color="#0000ff">this</font> .removeEventListener( <font color="#A31515">'DOMContentLoaded'</font> , arguments.callee, <font color="#0000ff">false</font> ); <br> callback.call( <font color="#0000ff">this</font> , <font color="#0000ff">event</font> , <font color="#0000ff">document</font> ); <br> } <br> }, <font color="#0000ff">false</font> ); <br> <font color="#0000ff">return</font> browser; <br> } <br> } <br> <br> Crawler.habrahabr.prototype = { <br> url: <font color="#A31515">'http://habrahabr.ru/'</font> , <br> openAndSignIn: <font color="#0000ff">function</font> (inNewTab) { <br> <font color="#0000ff">var</font> tab = gBrowser.selectedTab, browser = <font color="#0000ff">null</font> ; <br> <font color="#0000ff">if</font> (inNewTab) { <br> tab = gBrowser.addTab( <font color="#0000ff">this</font> .url); <br> } <font color="#0000ff">else</font> { <br> content. <font color="#0000ff">document</font> .location = <font color="#0000ff">this</font> .url; <br> } <br> browser = gBrowser.getBrowserForTab(tab); <br> <font color="#0000ff">var</font> that = <font color="#0000ff">this</font> ; <br> Crawler.onHTMLLoaded(browser, <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> , <font color="#0000ff">document</font> ){ <br> <font color="#0000ff">document</font> .location = <font color="#0000ff">document</font> .querySelector( <font color="#A31515">'dl.panel-personal a'</font> ).href; <br> Crawler.onHTMLLoaded( <font color="#0000ff">this</font> , <font color="#0000ff">function</font> ( <font color="#0000ff">event</font> , <font color="#0000ff">document</font> ){ <br> <font color="#0000ff">var</font> user  = <font color="#0000ff">document</font> .getElementById( <font color="#A31515">'reg-f-username'</font> ); <br> user.value = that.username; <br> <font color="#0000ff">document</font> .getElementById( <font color="#A31515">'reg-f-password'</font> ).value = that.password; <br> user.form.querySelector( <font color="#A31515">'input[type="submit"]'</font> ).click(); <br> }); <br> }); <br> } <br> }; <br> <font color="#0000ff">var</font> cr = <font color="#0000ff">new</font> Crawler.habrahabr( <font color="#A31515">'serjoga'</font> , <font color="#A31515">'***'</font> ); <br> cr.openAndSignIn( <font color="#0000ff">true</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br>  At the beginning, create a Crawler object, into which you can then add new parsers.  Create a constructor for the parser habrahabr, in which we pass the user name and password.  Add the openAndSignIn method to the prototype of the habrahabr object.  This method is able to open Habr and log in under a given user. <br><br>  PS: I often automate the reproduction of test cases of bugs, very funny and not tiring, in that case when you need to press a bunch of buttons and walk 10 pages more on 2 sites. </div><p>Source: <a href="https://habr.com/ru/post/123568/">https://habr.com/ru/post/123568/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123562/index.html">Beginners shareware and all those who decided to conduct their business on the Internet</a></li>
<li><a href="../123564/index.html">ICQ Mobile for iOS version 2.6 and Push Notifications</a></li>
<li><a href="../123565/index.html">Console cucumber and capybara with Selenium and Hudson</a></li>
<li><a href="../123566/index.html">Skype to SIP Gateway do it yourself</a></li>
<li><a href="../123567/index.html">What does not hide LastPass?</a></li>
<li><a href="../123569/index.html">Asynchronous Replication with Oracle Streams</a></li>
<li><a href="../123571/index.html">Amazon Kindle warranty replacement instructions</a></li>
<li><a href="../123573/index.html">MS SQL 2011 - Modification of the returned data set</a></li>
<li><a href="../123574/index.html">Facebook Video Calls - Based on Skype Technology</a></li>
<li><a href="../123575/index.html">An important step in the next generation of computers: Vital Insight Into Spintronics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>