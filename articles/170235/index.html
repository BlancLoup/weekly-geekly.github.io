<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic tuning of Icecast2 and mpd to several audio streams</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the request of a friend tried to make online radio. And everything seems to be nothing, but it became necessary to broadcast and manage many stream...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic tuning of Icecast2 and mpd to several audio streams</h1><div class="post__text post__text-html js-mediator-article">  At the request of a friend tried to make online radio.  And everything seems to be nothing, but it became necessary to broadcast and manage many streams independently of each other ... <br><br>  For this, I chose the following path ... <br><br><a name="habracut"></a><br>  Let's go in order. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a server system I use Ubuntu Server 12.10. <br><br>  The first step is to put Icecast2: <br><pre><code class="bash hljs">sudo apt-get install icecast2</code> </pre> <br><br>  Next put mpd: <br><pre> <code class="bash hljs">sudo apt-get install mpd</code> </pre> <br><br>  Create a <b>radio</b> directory in the root of the file system. <br>  Create 3 files in this directory <br><ul><li>  icecast.xml.default </li><li>  mpd.conf.default </li><li>  script.sh </li></ul><br>  And copy 2 directories from the / etc / icecast2 / directory <br><ul><li>  web </li><li>  admin </li></ul><br><br>  Next, you need to edit the settings files Icecast2 and mpd. <br><br>  File icecast.xml.default: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">icecast</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">limits</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">clients</span></span></span><span class="hljs-tag">&gt;</span></span>50<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">clients</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sources</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">threadpool</span></span></span><span class="hljs-tag">&gt;</span></span>5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">threadpool</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">queue-size</span></span></span><span class="hljs-tag">&gt;</span></span>524288<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">queue-size</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">client-timeout</span></span></span><span class="hljs-tag">&gt;</span></span>30<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">client-timeout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header-timeout</span></span></span><span class="hljs-tag">&gt;</span></span>15<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header-timeout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source-timeout</span></span></span><span class="hljs-tag">&gt;</span></span>10<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source-timeout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">burst-on-connect</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">burst-on-connect</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">burst-size</span></span></span><span class="hljs-tag">&gt;</span></span>65535<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">burst-size</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">limits</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source-password</span></span></span><span class="hljs-tag">&gt;</span></span>#2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source-password</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">relay-password</span></span></span><span class="hljs-tag">&gt;</span></span>#2_relay<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">relay-password</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">admin-user</span></span></span><span class="hljs-tag">&gt;</span></span>admin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">admin-user</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">admin-password</span></span></span><span class="hljs-tag">&gt;</span></span>admin_#2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">admin-password</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostname</span></span></span><span class="hljs-tag">&gt;</span></span>127.0.0.1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostname</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">listen-socket</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span>#3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">listen-socket</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mount</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mount-name</span></span></span><span class="hljs-tag">&gt;</span></span>/#1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mount-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mount</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">paths</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">basedir</span></span></span><span class="hljs-tag">&gt;</span></span>#0/#1/icecast2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">basedir</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logdir</span></span></span><span class="hljs-tag">&gt;</span></span>#0/#1/icecast2/log<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logdir</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">webroot</span></span></span><span class="hljs-tag">&gt;</span></span>#0/#1/icecast2/web<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">webroot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">adminroot</span></span></span><span class="hljs-tag">&gt;</span></span>#0/#1/icecast2/admin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">adminroot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pidfile</span></span></span><span class="hljs-tag">&gt;</span></span>#0/#1/icecast2/icecast.pid<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pidfile</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">alias</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dest</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/status.xsl"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">paths</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logging</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">accesslog</span></span></span><span class="hljs-tag">&gt;</span></span>access.log<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">accesslog</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">errorlog</span></span></span><span class="hljs-tag">&gt;</span></span>error.log<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">errorlog</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">loglevel</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">loglevel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logsize</span></span></span><span class="hljs-tag">&gt;</span></span>10000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logsize</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logging</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chroot</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chroot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">changeowner</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span>icecast<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">group</span></span></span><span class="hljs-tag">&gt;</span></span>icecast<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">group</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">changeowner</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">icecast</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Let us understand what the parameters mean: <br>  <b># 0</b> - path to user directory <br>  <b># 1</b> - username <br>  <b># 2</b> - user password <br>  <b># 3</b> - the port on which Icecast2 will be launched <br><br>  Now edit mpd.conf.default: <br><pre> <code class="bash hljs">music_directory <span class="hljs-string"><span class="hljs-string">"#1/#2/music"</span></span> playlist_directory <span class="hljs-string"><span class="hljs-string">"#1/#2/playlists"</span></span> db_file <span class="hljs-string"><span class="hljs-string">"#1/#2/lib/tag_cache"</span></span> log_file <span class="hljs-string"><span class="hljs-string">"#1/#2/log/mpd.log"</span></span> pid_file <span class="hljs-string"><span class="hljs-string">"#1/#2/pid"</span></span> state_file <span class="hljs-string"><span class="hljs-string">"#1/#2/state"</span></span> user <span class="hljs-string"><span class="hljs-string">"mpd"</span></span> bind_to_address <span class="hljs-string"><span class="hljs-string">"127.0.0.1"</span></span> port <span class="hljs-string"><span class="hljs-string">"#5"</span></span> auto_update <span class="hljs-string"><span class="hljs-string">"yes"</span></span> audio_output { <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> <span class="hljs-string"><span class="hljs-string">"shout"</span></span> name <span class="hljs-string"><span class="hljs-string">"#2 radio"</span></span> encoding <span class="hljs-string"><span class="hljs-string">"mp3"</span></span> host <span class="hljs-string"><span class="hljs-string">"localhost"</span></span> port <span class="hljs-string"><span class="hljs-string">"#4"</span></span> mount <span class="hljs-string"><span class="hljs-string">"/#2"</span></span> password <span class="hljs-string"><span class="hljs-string">"#3"</span></span> bitrate <span class="hljs-string"><span class="hljs-string">"192"</span></span> format <span class="hljs-string"><span class="hljs-string">"44100:16:2"</span></span> } audio_output { <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> <span class="hljs-string"><span class="hljs-string">"alsa"</span></span> name <span class="hljs-string"><span class="hljs-string">"fake out"</span></span> driver <span class="hljs-string"><span class="hljs-string">"null"</span></span> } volume_normalization <span class="hljs-string"><span class="hljs-string">"yes"</span></span> filesystem_charset <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span> id3v1_encoding <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span> metadata_to_use <span class="hljs-string"><span class="hljs-string">"artist,album,title,track,name,genre,date,composer,performer,disc"</span></span></code> </pre><br>  Mpd options: <br>  <b># 1</b> - path to user directory <br>  <b># 2</b> - username <br>  <b># 3</b> - user password for Icecast2 <br>  <b># 4</b> - the port on which Icecast2 is running <br>  <b># 5</b> - port to control mpd <br><br>  And the last file is the setup script: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash MAIN_DIR=/userAlias FROM=/radio if [ $# -lt 4 ]; then echo "====    ====" echo " ./script.sh 'userName' 'userPassword' 'port' 'mpdPort'" exit 1 fi echo "&lt;===&gt;    &lt;===&gt;" if [ ! -d "$MAIN_DIR" ]; then mkdir $MAIN_DIR echo "     " fi mkdir $MAIN_DIR'/'$1 echo "    " $1 echo "" echo "&lt;===&gt;  icecast &lt;===&gt;" cp $FROM/icecast.xml.default $MAIN_DIR'/'$1'/'icecast.xml replace '#0' $MAIN_DIR -- $MAIN_DIR'/'$1'/'icecast.xml replace '#1' $1 -- $MAIN_DIR'/'$1'/'icecast.xml replace '#2' $2 -- $MAIN_DIR'/'$1'/'icecast.xml replace '#3' $3 -- $MAIN_DIR'/'$1'/'icecast.xml mkdir $MAIN_DIR'/'$1'/icecast2' mkdir $MAIN_DIR'/'$1'/icecast2/log' mkdir $MAIN_DIR'/'$1'/icecast2/web' mkdir $MAIN_DIR'/'$1'/icecast2/admin' cp $FROM/icecastDirs/admin/* $MAIN_DIR'/'$1'/icecast2/admin' cp $FROM/icecastDirs/web/* $MAIN_DIR'/'$1'/icecast2/web' touch $MAIN_DIR/$1/icecast2/log/error.log touch $MAIN_DIR/$1/icecast2/log/access.log chown icecast:icecast $MAIN_DIR/$1/icecast.xml chown icecast:icecast $MAIN_DIR/$1/icecast2/log/* echo "&lt;===&gt;  icecast  &lt;===&gt;" echo "" echo "&lt;===&gt;  mpd &lt;===&gt;" cp $FROM/mpd.conf.default $MAIN_DIR'/'$1'/'mpd.conf replace '#1' $MAIN_DIR -- $MAIN_DIR'/'$1'/'mpd.conf replace '#2' $1 -- $MAIN_DIR'/'$1'/'mpd.conf replace '#3' $2 -- $MAIN_DIR'/'$1'/'mpd.conf replace '#4' $3 -- $MAIN_DIR'/'$1'/'mpd.conf replace '#5' $4 -- $MAIN_DIR'/'$1'/'mpd.conf mkdir $MAIN_DIR'/'$1'/music' mkdir $MAIN_DIR'/'$1'/playlists' mkdir $MAIN_DIR'/'$1'/lib' mkdir $MAIN_DIR'/'$1'/log' touch $MAIN_DIR/$1/lib/tag_cache chmod 777 $MAIN_DIR/$1/lib/tag_cache touch $MAIN_DIR/$1/pid chmod 777 $MAIN_DIR/$1/pid echo "&lt;===&gt;  mpd  &lt;===&gt;" echo "&lt;===&gt;  icecast &lt;===&gt;" icecast2 -b -c $MAIN_DIR'/'$1'/'icecast.xml sleep 1s echo "&lt;===&gt;  mpd &lt;===&gt;" mpd $MAIN_DIR'/'$1'/'mpd.conf</span></span></code> </pre><br>  If you do not go into details, the script does the following: <br><ul><li>  directories for the user are created </li><li>  Icecast2 and mpd configuration files are copied </li><li>  parameters in settings files are replaced </li><li>  additional files are created for Icecast2 and mpd </li><li>  file rights are set </li><li>  launch of Icecast2 </li><li>  running mpd </li></ul><br><br>  After creating 3 files you need to make the script run: <br><pre> <code class="bash hljs">chmod 777 script.sh</code> </pre> <br><br>  And execute: <br><pre> <code class="bash hljs">./script.sh radio1 password1 9001 19001</code> </pre> <br><br>  After running the script, Icecast2 and mpd will be launched. <br>  In the browser, you can try to contact: <br><pre> <code class="hljs 1c"><code class="bash">:<span class="hljs-number"><span class="hljs-number">9001</span></span>/radio1 <br> <br>    ... <b>mpd</b>  <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  ( <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  )    . <br> <br>       <span class="hljs-keyword"><span class="hljs-keyword"></span></span>   : <b>/userAlias/radio1/music/</b> <br> <br> <span class="hljs-keyword"><span class="hljs-keyword"></span></span>    <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  -      <span class="hljs-keyword"><span class="hljs-keyword"></span></span> mpd: <br> sudo apt-get install ncmpc <br>        mpd. <br> : <br> <b>ncmpc -p <span class="hljs-number"><span class="hljs-number">19001</span></span></b> <br>     music <code>Ctrl + U</code> <br>    '3' -     . <br>    /     . <br>  '2' -  .  Enter -   . <br> <br> <span class="hljs-keyword"><span class="hljs-keyword"></span></span>   ,  <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  <code>:<span class="hljs-number"><span class="hljs-number">9001</span></span>/radio1   <span class="hljs-keyword"><span class="hljs-keyword"></span></span> . <br> <br>    ,   .</code></code></code> </pre> <code><code class="bash">:9001/radio1 <br> <br>    ... <b>mpd</b>    (   )    . <br> <br>          : <b>/userAlias/radio1/music/</b> <br> <br>       -       mpd: <br> sudo apt-get install ncmpc</code> <br>        mpd. <br> : <br> <b>ncmpc -p 19001</b> <br>     music <code>Ctrl + U</code> <br>    '3' -     . <br>    /     . <br>  '2' -  .  Enter -   . <br> <br>    ,      <code>:9001/radio1    . <br> <br>    ,   .</code></code> </div><p>Source: <a href="https://habr.com/ru/post/170235/">https://habr.com/ru/post/170235/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../170217/index.html">Best Android Mobile Development Apps</a></li>
<li><a href="../170221/index.html">Safety control systems practices and examples</a></li>
<li><a href="../170227/index.html">Win32 / DoS.OutFlare.A aims to circumvent the anti-DDOS service CloudFlare</a></li>
<li><a href="../170229/index.html">Website development for mobile devices</a></li>
<li><a href="../170233/index.html">Free Windows Phone / Windows 8 Developer School in St. Petersburg</a></li>
<li><a href="../170237/index.html">NTT Expands IaaS Services Geography and Advertise SDN</a></li>
<li><a href="../170239/index.html">PlayStation Meeting 2013 summary</a></li>
<li><a href="../170241/index.html">VDS, VDI, anyone you want to choose: desktop virtualization through the eyes of Dell</a></li>
<li><a href="../170245/index.html">Wizee shopping center guide: 200 thousand downloads, 100 thousand users and 140 shopping centers</a></li>
<li><a href="../170247/index.html">Warranty replacement of SanDisk memory card from American Amazon</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>