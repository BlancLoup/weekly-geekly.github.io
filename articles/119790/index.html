<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How MRC technology reduces the size of PDF documents</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The PDF format has long taken root as a means of saving documents, which are then not supposed to be edited. All PDF files can be divided into two cla...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How MRC technology reduces the size of PDF documents</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/1bcc8a07/a1bb1dd8/4fbd2c5e/b905927c.png" align="right">  The PDF format has long taken root as a means of saving documents, which are then not supposed to be edited.  All PDF files can be divided into two classes.  The first is documents that were digitally folded, and then converted to PDF.  Instructions for any device will most likely be just such a file.  Inside, it looks like text and graphics plus formatting commands that describe how elements should be placed on the page. <br><br>  The second class is the documents obtained as a result of scanning paper images.  They can be skipped through ABBYY FineReader, and they will turn into the first type, or you can simply save to PDF as pictures.  And it often makes sense to use it when you want to keep the original document view.  Despite the fact that ABBYY FineReader is quite good at recognizing documents, recognition errors occur, some important elements on the page are not found, in general, what happens is somewhat different from the original document in appearance. <br><br>  Therefore, it often makes sense to save a PDF image of the original image, and underneath it to insert the recognized text so that you can find the document by keywords or use copy-paste.  Only one moment confuses - such PDF-files have a rather big size, from half a megabyte per page and more.  Accordingly, if you scan a medium-size textbook on mathematical analysis, you get a file of 200 megabytes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  This size is due to the fact that inside the PDF scanned, bitmap images are compressed with conventional image codecs, JPEG, JPEG2000, LZW or ZIP.  Accordingly, less than the usual JPEG files for such pages take is impossible.  To reduce the size, they usually resort to all sorts of tricks - reduce the resolution, greatly underestimate the compression of the image, as a result of which the quality of the text in such PDF suffers. <br><br>  Or then you have to give up PDF and save everything in DjVu.  It turns out a fairly small size, but the reality is that not all users of the resulting file can easily read it - after all, Adobe Acrobat is on a much larger number of computers than the DjVu viewer. <br>  And here comes to the aid of the PDF MRC technology (from ‚ÄúMixed Raster Content‚Äù) - Adobe's answer to the DjVu format.  This is the same PDF, but borrowing many elements from DjVu, and can be read by all popular PDF readers.  When using MRC, the page size is reduced by a factor of 4 while maintaining the quality of the scanned image.  This is due to the decision to divide the image into layers and compress each layer with the most appropriate codec.  The text is compressed with JBIG2 codec, everything else is compressed using JPEG / JPEG2000 / ZIP with different quality. <br><br>  How is the MRC inside the PDF?  Consider a simple example, and then gradually we will complicate it. <br>  Let us have a scan of a white page with black text, for example, pages from a book (all pictures are clickable). <br><br>  <b>Scan, JPEG, 1.2 MB</b> <br><br> <a href=""><img src="https://habrastorage.org/storage/52639588/60da78d7/6b9d4bfd/8553250c.png"></a> <br><br>  Useful information - only letters, everything else can be ignored.  Find all the text on the page, for example, it is logical for this to run FineReader and recognize the page.  Then select all the found text in a separate layer, and compress it with the JBIG2 codec.  We get 50 kilobytes per page against 400 for JPEG and 200 for the black-and-white fax codec CCITT4. <br><br>  JBIG2 is specifically designed to compress text.  When working, he combines externally similar images of letters into clusters.  Examples of such clusters, for example, are all the letters 'a', printed in the same font of the same size.  The slightly different letters 'a', for example, with distortions from scanning, or printed in a different font, will fall into other clusters.  The result is a dictionary, which combines the same common letters.  Then for each letter its place is remembered.  It turns out very compact. <br><br>  <b>JBIG2, 50 Kb.</b>  <b>The PDF with additional information is 80 Kb.</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/9ba6ba3c/449b2525/988a5e4a/e61e4c80.png"></a> <br><br>  Now we will complicate the task.  Let us have an uneven background that you don't want to lose. <br><br>  <b>Tiff, 500 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/cc6371e0/c3c15025/484eea25/02e22509.png"></a> <br><br>  For this we need two layers already.  The first of these will still be text compressed JBIG2.  And in the second layer will get everything that remains of the original image after cutting the letters and painting the holes from them.  We can compress the second layer quite strongly with the help of JPEG, since there is usually no particularly valuable information on it. <br><br>  The resulting PDF has a size of 35 Kb against 190, which we would get by simply compressing the entire image in JPEG. <br><br>  <b>Text, JBIG2, 18 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/826a4153/b56fae96/829a8e42/5e5500d0.png"></a> <br><br>  <b>Background, 11 Kb, JPEG</b> <br><br><img src="https://habrastorage.org/storage/a5eb6737/17a52459/76c98788/ecbdd3d8.png"><br><br>  <b>Final MRC PDF, 35 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/80e6833c/52d93b84/9578322e/876a5e1f.png"></a> <br><br>  The following complication.  So far, we have displayed only black and white text.  Let now we will meet the color text. <br><br>  <b>Tiff, 700 Kb</b> <br><br> <a href=""><img src="https://habrastorage.org/storage/f8a39a42/82616eaa/c67c7ecd/98975041.png"></a> <br><br>  As before, we press the text with the black-and-white JBIG2 codec, but under the colored letters we enclose the so-called color mask - another layer that can be seen in the ‚Äúslots‚Äù made by the letters.  This layer contains few colors, and is beautifully packaged, for example, using ZIP. <br><br>  <b>Text, JBIG2, 11 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/be662da2/055db355/ff4b7159/6c76c5db.png"></a> <br><br>  <b>Color mask, ZIP, 3 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/4e35854e/f69a8c31/ae56e667/d1134c45.png"></a> <br><br>  <b>Text + color mask look like this:</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/7325b629/a2d39db2/35d0768d/d43a8bcd.png"></a> <br><br>  <b>Background, JPEG, 40 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/5cc4e6d0/707f4dfe/ab1f8219/b8583c6a.png"></a> <br><br>  With background compression it is important not to overdo it - a text that has not been recognized as text can fall on it.  And if we compress it too much, such a text will be difficult to read. <br><br>  <b>Final MRC PDF, 60 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/50a56b2e/0ab28d44/13f70170/89a775c5.png"></a> <br><br>  So, there are already 3 layers: the text, the color mask that colors the text, and the background.  It remains to deal with elements that are neither text nor background.  For example, these are pictures or photos.  Nothing special can be done with them, and we will simply add them to the background, compressing JPEG or JPEG 2000 with high quality. <br><br>  <b>Tiff, 600 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/bd4a9408/c66016df/0e0490c7/c0f27e7f.png"></a> <br><br>  <b>Text JBIG2, 25 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/8fd00f55/fcab35ba/cca4f33a/e27b9788.png"></a> <br><br>  <b>Color mask, ZIP, 5 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/80679291/62307509/5bd489c0/4af0c5d9.png"></a> <br><br>  <b>Background, JPEG, 40 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/73b0d77e/bfd14c81/a1f0fe82/97996a04.png"></a> <br><br>  PDF MRC is ready.  It contains several layers, each of which contains different pieces of the picture and compressed with the most appropriate codec. <br><br>  <b>Summary PDF MRC, 72 Kb</b> <br><br> <a href=""><img src="http://habrastorage.org/storage/a67ba5e9/70d21b95/1019f12e/61e108de.png"></a> <br><br>  Of course, there are images that do not benefit in size from the use of MRC.  For example, trying to compress a photo of a landscape like that makes no sense, less than JPEG will fail.  Or text printed on a background containing many small details. <br><br>  From this picture PDF MRC will not work <br><br><img src="https://habrastorage.org/storage/474cf633/ac3ffbce/11961512/82e76033.png"><br><br>  However, for many of the documents we encounter in everyday life, the MRC gives excellent results. <br><br>  And finally - a few examples of PDF MRC, which can be obtained using ABBYY FineReader, ABBYY FineReader Engine or ABBYY Recognition Server: <br><br><table><tbody><tr><td>  <b>PDF, JPEG</b> </td><td>  <b>PDF, MRC</b> </td></tr><tr><td>  <b>524 Kb</b> </td><td>  <b>218 Kb</b> </td></tr><tr><td> <a href=""><img src="http://habrastorage.org/storage/f1b1532c/fe7b97a1/440b648f/c7d833bf.png"></a> </td><td> <a href=""><img src="https://habrastorage.org/storage/8eb164d1/19479956/c8d79ad6/a7f82611.png"></a> </td></tr><tr><td></td><td></td></tr><tr><td>  <b>618 Kb</b> </td><td>  <b>175 Kb</b> </td></tr><tr><td><a href=""><img src="http://habrastorage.org/storage/babbadf5/25f8892b/392da2a1/121f3097.png"></a> </td><td> <a href=""><img src="http://habrastorage.org/storage/97c2c1e1/f26466a9/9c0356a8/57701e47.png"></a> </td></tr><tr><td></td><td></td></tr><tr><td>  <b>412 Kb</b> </td><td>  <b>113 Kb</b> </td></tr><tr><td> <a href=""><img src="http://habrastorage.org/storage/f9b7bdda/9a9797e5/63eec2f1/00bd2b77.png"></a> </td><td> <a href=""><img src="http://habrastorage.org/storage/1a6162f6/a264a9a6/9aad0568/6d5aeb16.png"></a> </td></tr></tbody></table><br><br>  So we get compression by 2-6 times with the same quality, and this is not the limit.  PDF MRC is still a very young technology, and it continues to grow rapidly.  There will be improvements in the direction of quality improvement, and in the direction of reducing the size. <br><br>  All PDF examples in this article were obtained using ABBYY FineReader Engine 10, default settings. <br><br>  <i>Vasily Panfyorov,</i> <i><br></i>  <i>Product Development Department</i> </div><p>Source: <a href="https://habr.com/ru/post/119790/">https://habr.com/ru/post/119790/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../119779/index.html">Apple patent - the contents of the gadget screen may be visible only to the owner</a></li>
<li><a href="../119780/index.html">A small review of the source code of the zeus trojan</a></li>
<li><a href="../119781/index.html">What is mobile commerce</a></li>
<li><a href="../119782/index.html">Do you follow the principles of SOLID in object-oriented design and programming?</a></li>
<li><a href="../119787/index.html">Some (useful) tips for Windows 7</a></li>
<li><a href="../119791/index.html">Investing in startups has become easier and more enjoyable.</a></li>
<li><a href="../119793/index.html">Double cleaning mail</a></li>
<li><a href="../119794/index.html">For beginners about Windows Phone 7</a></li>
<li><a href="../119795/index.html">e-Registration in Russian</a></li>
<li><a href="../119796/index.html">The plug-in for Firefox, which downloaded about 7 million times, spied on users</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>