<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installation and basic configuration of nginx and php-fpm for developing projects locally in Ubuntu 16.04</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear user of Habrahabr. My story will be about how to prepare the ground for local web development projects in the operating system Ubuntu 16.0...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installation and basic configuration of nginx and php-fpm for developing projects locally in Ubuntu 16.04</h1><div class="post__text post__text-html js-mediator-article">  Hello, dear user of Habrahabr.  My story will be about how to prepare the ground for local web development projects in the operating system Ubuntu 16.04.1 LTS. <br><br>  In this article, I would like to dispel and explain the possible difficulties associated with installing and configuring software that is required for modern web development, which may be faced by novice developers and not only. <br><br>  Technologies that will be used in the article: nginx, php-fpm. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Before the beginning of the story, I want to note that I did all these actions on the "bare" system. <br>  I will work with the aptitude package manager.  I also recommend updating the package index and the packages themselves before installing the software.  In the article we will do these actions together. <br><br>  Go! <br><a name="habracut"></a><br><h3>  Installing the <b>aptitude</b> package manager, updating the index and packages </h3><br>  Install: <br><br><pre><code class="bash hljs">sudo apt install aptitude</code> </pre> <br>  Update the index. <br><br><pre> <code class="bash hljs">sudo aptitude update</code> </pre> <br>  We update packages (the team will update all packages for which there are new versions, if you need to remove packages, it will be executed). <br><br><pre> <code class="bash hljs">sudo aptitude full-upgrade</code> </pre> <br><h3>  Install and configure <b>nginx</b> (version&gt; = 1.10.0) </h3><br>  Install. <br><br><pre> <code class="bash hljs">sudo aptitude install nginx</code> </pre> <br>  We start. <br><br><pre> <code class="bash hljs">sudo service nginx start</code> </pre> <br>  We check the version to make sure that we did not install the old one, that is, below 1.10.0. <br><br><pre> <code class="bash hljs">nginx -v</code> </pre> <br><img src="https://habrastorage.org/files/4fd/ef1/356/4fdef135669849208b780ebc5061618f.png"><br><br>  Installation and start have made, now we will go to the directory where our nginx is installed and we will look at its structure.  The nginx directory is in this way: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /etc/nginx/</code> </pre> <br>  You can view the contents of the directory with the ls command, with the -la flags it will be more convenient to browse the contents of the directory (in fact, this command with specific flags can be described in more detail and more accurately, but today we have another topic). <br><br><pre> <code class="bash hljs">ls -la</code> </pre> <br>  We are currently interested in two directories that you see in the screenshot.  These are the sites-available and sites-enabled directories. <br><br><img src="https://habrastorage.org/files/030/86e/d46/03086ed46e0b44a19542898832094192.png"><br><br>  Let's move to the sites-available directory and begin to configure our virtual host (site). <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /etc/nginx/sites-available</code> </pre> <br>  Before starting to create a configuration file, check what is in our directory.  In my case, the directory is not empty, it already has configuration files, I wiped them so as not to mislead you. <br><br><div class="spoiler">  <b class="spoiler_title">Important retreat</b> <div class="spoiler_text">  In the case of installing nginx from scratch, it is from scratch, because when you delete nginx with the command <br><pre> <code class="bash hljs">sudo apt-get remove nginx</code> </pre>  or <pre> <code class="bash hljs">sudo apt remove nginx</code> </pre>  configuration files remain and if you suddenly do not understand why nginx does not work and want to reinstall it (usually Linux users begin to resort to this), then after reinstallation it will not work correctly, due to the fact that in the old configuration files they are not deleted after removal with the remove command) incorrect settings are registered, they will have to be removed, or the settings will be correct, only then nginx will work. <br><br>  I recommend to delete with the command <code>sudo apt-get purge nginx</code> or <code>sudo apt purge nginx</code> .  If you are using the aptitude package manager, then the <code>sudo aptitude purge nginx</code> command removes the package completely with all dependencies and configuration files. <br></div></div><br>  In this directory will be the default one file, named default.  It will contain a configuration file with an example, with comments, you can study it at your leisure, or you can delete it altogether (you can always refer to the official documentation). <br><br><pre> <code class="bash hljs">ls -la</code> </pre> <br><img src="https://habrastorage.org/files/776/afb/13a/776afb13afc8452386d24e2f71163041.png"><br><br>  Create your own configuration file that will match the domain name of our local site (or real, if you already know its name).  This is convenient, in the future, when there will be a lot of configuration files, it will save you from confusion in them.  My file will be called project.local. <br><br><pre> <code class="bash hljs">sudo touch project.local</code> </pre> <br>  Let's see what happened. <br><br><img src="https://habrastorage.org/files/22c/5ac/e16/22c5ace169914d35a876ec37422596ca.png"><br><br>  Now open it in the editor, I will open it in nano. <br><br><pre> <code class="bash hljs">sudo nano project.local</code> </pre> <br>  We see that it is empty.  We now turn to the formation of our file.  You need to bring the configuration to this form, as written below.  I will describe only the vital directives of this file, I will not describe the rest, since this is not currently important, after all, we have the theme of basic configuration.  These settings with the "hill" is enough for the development of projects locally, not only small, but also quite large.  In the following articles I will describe separately each directive used (this is the name of the string, for example server_name) of this file. <br><br>  See comments straight in the configuration file. <br><br><pre> <code class="bash hljs">server { listen 80; <span class="hljs-comment"><span class="hljs-comment"># ,  nginx server_name project.local; #  ,      root /home/stavanger/code/project.local; #     ,     index index.php; # add_header Access-Control-Allow-Origin *; # serve static files directly location ~* \.(jpg|jpeg|gif|css|png|js|ico|html)$ { access_log off; expires max; log_not_found off; } location / { # add_header Access-Control-Allow-Origin *; try_files $uri $uri/ /index.php?$query_string; } location ~* \.php$ { try_files $uri = 404; fastcgi_split_path_info ^(.+\.php)(/.+)$; fastcgi_pass unix:/var/run/php/php7.0-fpm.sock; #   php-fpm fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } location ~ /\.ht { deny all; } }</span></span></code> </pre> <br>  Save the file.  Now we need to check if there are any errors in it.  We can do this as a team. <br><br><pre> <code class="bash hljs">sudo nginx -t</code> </pre> <br>  If we see such information as in the screenshot, then we are all right, we can continue the setting.  If you get any errors, you should double-check the configuration file. <br><br><img src="https://habrastorage.org/files/15f/9df/492/15f9df49201a4df7a1b6309399b9b8b3.png"><br><br>  Now we need to activate the configuration file, in the / etc / nginx / sites-enabled / directory we need to create a symlink (symbolic link).  If your nginx was installed from scratch, then in this directory there is a symlink to the default file, which was described above, you can delete it if you do not need it.  Go to the desired directory. <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /etc/nginx/sites-enabled/</code> </pre> <br>  Now we are in the right directory.  Let's create our symlink.  To create, use the ln command with the -s flag, then we will indicate the path to our project.local config. <br><br><pre> <code class="bash hljs">sudo ln -s /etc/nginx/sites-available/project.local</code> </pre> <br>  Let's look at our created symlink. <br><br><img src="https://habrastorage.org/files/c6c/781/5b1/c6c7815b124c4f94827ebb842f1cb10f.png"><br><br>  To make sure that we are still doing everything right, we‚Äôll run the command again. <br><br><pre> <code class="bash hljs">sudo nginx -t</code> </pre> <br>  If everything is ok, go further. <br><br><h3>  <b>Hosts file</b> </h3><br>  This file is located on the path / etc / hosts.  The presence of records in it allows you to run nginx using localhost as the domain.  In this file, you can assign alternative aliases, for example, for our project project.local, we will assign the domain project.local. <br><br>  Open the file in the nano editor. <br><br><pre> <code class="bash hljs">sudo nano /etc/hosts</code> </pre> <br>  You will have other information in this file, just ignore it.  You just need to add a line like in my screenshot. <br><br><img src="https://habrastorage.org/files/df3/381/007/df33810072ae430ab79a67a608cb6e09.png"><br><br>  Do not forget to save the file.  This completes the setting of the hosts file. <br><br><h3>  Install <b>php-fpm</b> (&gt; = 7.0) </h3><br><pre> <code class="bash hljs">sudo aptitude install php-fpm</code> </pre> <br>  We check the installed version, just in case, although in Ubuntu 16.04.1 in the repositories is exactly the 7.0 version. <br><br><pre> <code class="bash hljs">php-fpm7.0 -v</code> </pre> <br><img src="https://habrastorage.org/files/205/2f9/19e/2052f919e9d044a4bc930c6fd0168090.png"><br><br>  We are convinced that everything is ok.  We start php-fpm. <br><br><pre> <code class="bash hljs">sudo service php7.0-fpm start</code> </pre> <br>  If you edit configs, then do not forget to restart the demon.  It does so.  But we will not need it. <br><br><pre> <code class="bash hljs">sudo service php7.0-fpm restart</code> </pre> <br>  This completes the installation and configuration of php-fpm.  True, that's all.  This is not magic, the path to the php-fpm socket was already registered in the configuration file.  Of course, you may need any php extensions to develop personal projects, but you can install them as they are required. <br><br>  Now let's go to the directory with our project, I have it along this path. <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /home/stavanger/code/project.local</code> </pre> <br>  Let's go up to the directory above and make the rights 777 (that is, we will do full directory rights with our project.local project).  In the future, it will save us from unnecessary problems. <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> .. sudo chmod -R 777 project.local</code> </pre> <br>  This completes the software setup, let's create a test file in our working directory project.local and make sure that everything works.  I will create an index.php file with this content. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Hello Habrahabr!"</span></span>;</code> </pre> <br>  We go to the browser and see that everything works great for us!  Php interpreter including. <br><br><img src="https://habrastorage.org/files/2e4/da9/50b/2e4da950b12d44beb654fe9fbb8827f9.png"><br><br>  Regards to readers, Stavanger. </div><p>Source: <a href="https://habr.com/ru/post/320036/">https://habr.com/ru/post/320036/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320024/index.html">Analyze it: how Skyeng chose a product analytics system for mobile apps</a></li>
<li><a href="../320026/index.html">"Friday format": where to grow technical specialists</a></li>
<li><a href="../320030/index.html">Intel Software Guard Extensions tutorial. Part 5, development of the enclave</a></li>
<li><a href="../320032/index.html">Hardware or software write blockers - which is more reliable?</a></li>
<li><a href="../320034/index.html">Is React Native good?</a></li>
<li><a href="../320040/index.html">Firebase: farewell to illusions</a></li>
<li><a href="../320042/index.html">Grant Proposal course: how to find the right words to attract attention and money to your development</a></li>
<li><a href="../320044/index.html">Caching data in web applications. Using memcached</a></li>
<li><a href="../320046/index.html">Authorization in Laravel, through social networks (Ulogin). Simple, flexible and efficient.</a></li>
<li><a href="../320048/index.html">Summary building information model: a practical lesson on OpenBIM technology</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>