<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SoapClient: parallel asynchronous requests, reconnect, timeout handling</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dklab_SoapClient is an advanced version of the standard PHP class SoapClient, designed for parallel (asynchronous) remote procedure calls in high-load...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SoapClient: parallel asynchronous requests, reconnect, timeout handling</h1><div class="post__text post__text-html js-mediator-article">  Dklab_SoapClient is an advanced version of the standard PHP class SoapClient, designed for parallel (asynchronous) remote procedure calls in high-load projects. <br><br>  With the help of this library you can, for example, build a page of your site from blocks, like from a constructor.  Each block is requested through SOAP separately and independently from the others, with all requests occurring in parallel.  If one of the blogs did not meet the allotted time (timeout), then it can not be displayed on the page. <br><br>  Compared with the built-in PHP SoapClient, additional features are supported: <ul><li>  <b>Simultaneous, parallel execution of requests</b> for several remote procedures is a key feature of the library.  If the page on your site is made up of 5 remote blocks, each of which is generated by 100ms, you can run them in parallel and get the whole page not for 500ms, but for the same 100ms. </li><li>  <b>Reconnect if communication is not possible.</b>  Unfortunately, the world is not perfect, and due to accidental packet loss, the first attempt to connect to the SOAP server may end in a timeout.  This especially happens when the project is located in several data centers.  Dklab_SoapClient allows you to set a timeout for the connection opening time (for example, 1 second) and, in case of failure, try again a specified number of times.  In practice, this reduces the likelihood of a final failure by a factor of a thousand, since  Reconnect almost always helps with the loss of the package. </li><li>  <b>Support timeout for receiving data.</b>  If a page is collected from remote blocks, then in the case of ‚Äúhanging up‚Äù of one of them, the whole page also freezes.  At the same time, the absence of one of the blocks in the presence of the rest is not such a big trouble.  You can specify how long the Dklab_SoapClient should wait for a response from the remote procedure;  if the time is exceeded, a PHP exception is thrown, which you can handle at your discretion, without interrupting the loading of the remaining blocks. </li></ul><a name="habracut"></a>  Why SOAP?  At first glance, it may seem like a very cumbersome protocol that is difficult to apply.  However, if you do not delve into the internals of the protocol, it turns out that it is very convenient to use in PHP SOAP.  If WSDL schemes are not needed, the simplest SOAP server is written as: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> class MyServer
 {
     public function getComplexData ($ some)
     {
         sleep (1);  // type, we emulate heavy code
         return array ("obj" =&gt; (object) array ("prop" =&gt; $ some), "some" =&gt; "thing");
     }
 }
 $ soapServer = new SoapServer (null, array ('uri' =&gt; 'urn: myschema'));
 $ soapServer-&gt; setObject (new MyServer ());
 $ soapServer-&gt; handle ();
</pre><br>  And the corresponding SOAP client is like this: <br><br><pre> require_once "Dklab / SoapClient.php";
 $ client = new Dklab_SoapClient (null, array (
     'location' =&gt; "http://example.com/server.php",
     'uri' =&gt; 'urn: myschema',
     'timeout' =&gt; 3,
 ))
 // Requests are executed in parallel, asynchronously.  In total - for 1 s.
 $ query1 = $ client-&gt; async-&gt; getComplexData (array ("abc"));
 $ query2 = $ client-&gt; async-&gt; getComplexData (array ("xyz"));
 print_r ($ query1-&gt; getResult ());
 print_r ($ query2-&gt; getResult ());
</pre><br>  What is important, when working with SOAP in PHP, the server can return data in an arbitrary format (for example, an array of arrays of objects), and the client can transfer variables of any structure to the server in parameters (for example, the same array of arrays of objects).  In this case, all conversions are performed automatically. <br><br>  Because  Dklab_SoapClient is an extension of the embedded SoapClient, it supports all the standard features of the latter, including: <ul><li>  Work with cookies.  One procedure can call setcookie (), and the other can read the value of this cooike later. </li><li>  Work with PHP sessions.  One procedure writes data to the session, the second one reads. </li><li>  Support for WSDL schemas and transfer of complex business objects. </li><li>  Handling exceptions that occur in a remote procedure. </li></ul>  If suddenly Apache Thrift for your project - ‚Äúfrom a cannon on a sparrow‚Äù, Dklab_SoapClient can serve as a simple and compact alternative.  (By the way, parallel queries are not supported in the PHP module for Thrift - at least I did not find them there.) <br><br>  View documentation, examples, autotests and download the library here: <a href="http://dklab.ru/lib/Dklab_SoapClient/">http://dklab.ru/lib/Dklab_SoapClient/</a> <br><br>  PS <br>  By the way, <a href="http://git-scm.com/">Git</a> and the <a href="https://github.com/">GitHub</a> social network are used in development.  Who else did not try them, I recommend it. </div><p>Source: <a href="https://habr.com/ru/post/55200/">https://habr.com/ru/post/55200/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../55192/index.html">The Battle For Wesnoth Version 1.6 Released</a></li>
<li><a href="../55193/index.html">Twitter, music and naughty bears</a></li>
<li><a href="../55195/index.html">Year of the youth - not so bad</a></li>
<li><a href="../55197/index.html">InfoTerminal for DokuWiki</a></li>
<li><a href="../55199/index.html">The future of botnets or thinking about what can wait for us.</a></li>
<li><a href="../55202/index.html">Release of MDC Desktop 1.0.3.1 "Flying Pepyaka"</a></li>
<li><a href="../55206/index.html">Live interview with Evgeny Kaspersky (Kaspersky Lab)</a></li>
<li><a href="../55207/index.html">Another php template engine</a></li>
<li><a href="../55208/index.html">Autodesk 2010. Snake in champagne</a></li>
<li><a href="../55216/index.html">CMS architecture. Data model Part 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>