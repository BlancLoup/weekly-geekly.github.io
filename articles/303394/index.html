<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a motion component for a climbing system in the Unreal Engine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, my name is Dmitry. I create computer games on the Unreal Engine as a hobby. 

 As you know, Mirror's edge 2 came out recently. Judging by the r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a motion component for a climbing system in the Unreal Engine</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/522/ba3/900/522ba390019644b8b2e8b19c31295f79.jpg" alt="image"><br><br>  Hello, my name is Dmitry.  I create computer games on the Unreal Engine as a hobby. <br><br>  As you know, Mirror's edge 2 came out recently. Judging by the reviews from critics, the game was very weak.  And you probably already wanted to make your Mirror's edge.  Therefore, today I will tell you how to create a motion component so that your character moves like the heroine of Mirror's edge. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Here will be described the creation of the motion component (further CD) that will allow the character: <br>  1) Hop onto the wall. <br>  2) Run along the wall. <br>  3) jump over small obstacles <br>  4) Do acceleration with continuous running <br>  5) Roll up when pressing Shift <br>  6) Roll off sloping surfaces <br>  7) And also we will create an interactive object; a rope along which it will also be possible to roll <br><br>  All sources are listed at the end of the article. <br><a name="habracut"></a><br><br>  If you‚Äôre hearing about the motion component for the first time, then the best thing to do is to take a <a href="https://docs.unrealengine.com/latest/INT/Programming/Tutorials/Components/1/index.html">lesson from Epic Games</a> . <br><br>  As a base object for the CD, I used the UCharacterMovementComponent; this motion component already allows the character to go swimming and flying. <br><br><pre><code class="cpp hljs">UCLASS() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CLIMBINGSYSTEM_API</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UClimbingPawnMovementComponent</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> UCharacterMovementComponent { GENERATED_UCLASS_BODY() <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: UFUNCTION(BlueprintCallable, Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetClimbMode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(EClimbingMode _ClimbingMode)</span></span></span></span>; UFUNCTION(BlueprintPure, Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement"</span></span>) <span class="hljs-function"><span class="hljs-function">EClimbingMode </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetClimbingMode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span></span>; UFUNCTION(BlueprintPure, Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CanSetClimbMode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(EClimbingMode ClimbingMode)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/*Offset from top of climbing surfase*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|Climb"</span></span>, EditAnywhere, BlueprintReadWrite) int32 ClimbDeltaZ; <span class="hljs-comment"><span class="hljs-comment">/*Velocyty of climb movement*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|Climb"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ClimbVelocyty; <span class="hljs-comment"><span class="hljs-comment">/*Velocyty of jump from climb state*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|Climb"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ClimbJumpVelocyty; <span class="hljs-comment"><span class="hljs-comment">/*Angle from center when state can change in degres*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|WallRun"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> WallRunLimitAngle; <span class="hljs-comment"><span class="hljs-comment">/*Offset from Wall when Wall Run*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|WallRun"</span></span>, EditAnywhere, BlueprintReadWrite) int32 WallOffset; <span class="hljs-comment"><span class="hljs-comment">/*Fall Gravity Scale when charecter run on wall*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|WallRun"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> WallRunFallGravityScale; <span class="hljs-comment"><span class="hljs-comment">/*Multiplier input vector when charecter run on wall*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|WallRun"</span></span>, EditAnywhere, BlueprintReadWrite) int32 WallRunInputVelocyty; <span class="hljs-comment"><span class="hljs-comment">/*Velocyty of jump near wall*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|WallRun"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> WallRunJumpZVelocyty; <span class="hljs-comment"><span class="hljs-comment">/*Velocyty of jump from wall run state*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|WallRun"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> WallRunJumpVelocyty; <span class="hljs-comment"><span class="hljs-comment">/*Offset from rope of zip line*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|ZipLine"</span></span>, EditAnywhere, BlueprintReadWrite) int32 ZipLineDeltaZ; <span class="hljs-comment"><span class="hljs-comment">/*Velocyty*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|ZipLine"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ZipLineVelocyty; <span class="hljs-comment"><span class="hljs-comment">/*Velocyty of jump from Zip Line state*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|ZipLine"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ZipLineJumpVelocyty; <span class="hljs-comment"><span class="hljs-comment">/*Angle of surfase when character slide*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|InclinedSlide"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> InclinedSlideAngle; UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|InclinedSlide"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> InclinedSlideVelosytyForward; UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|InclinedSlide"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> InclinedSlideVelosytyRight; UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement|InclinedSlide"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> InclinedJumpVelocyty; <span class="hljs-comment"><span class="hljs-comment">/*Velocyty of Run movement*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> RunSpeed; <span class="hljs-comment"><span class="hljs-comment">/*delay before Run movement in sec*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> RunDelay; <span class="hljs-comment"><span class="hljs-comment">/*Velocyty of jump near wall*/</span></span> UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement"</span></span>, EditAnywhere, BlueprintReadWrite) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> UnderWallJumpZVelocyty; UPROPERTY(Category = <span class="hljs-string"><span class="hljs-string">"ClimbingMovement"</span></span>, EditAnywhere, BlueprintReadWrite) FRuntimeFloatCurve SlideVelocytyCurve; <span class="hljs-comment"><span class="hljs-comment">/*UCharacterMovementComponent Interfase*/</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoJump</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bReplayingMoves)</span></span></span><span class="hljs-function"> override</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetMaxSpeed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> override</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BeginPlay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> override</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TickComponent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> DeltaTime, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">enum</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ELevelTick TickType, FActorComponentTickFunction *ThisTickFunction)</span></span></span><span class="hljs-function"> override</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: EClimbingMode ClimbingMode; EClimbingMode LastClimbingMode; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> BlockClimb; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> BlockWallRun; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> BlockInclinedSlide; FTimerHandle RunTimerHandle; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> bIsRun; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> MinSlideTime; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> MaxSlideTime; FTimerHandle InclinedSlideTimerHandle; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetRun</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DefineClimbMode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetMode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(EClimbingMode ClimbingMode)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnSetMode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(EClimbingMode ClimbingMode)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnBlockInclinedSlide</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnblockClimbState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnblockWallRunState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckDeltaVectorInCurrentState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> FVector&amp; InputDeltaVector, FVector&amp; CheckDeltaVector, FRotator&amp; CheckRotation)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">//Check climb is possibly from Approximate coordinate and return realy coordinate bool CheckDeltaVectorInCurrentState(FVector&amp; CheckDeltaVector, FRotator&amp; CheckRotation); //Check climb is possibly in current character location coordinate and return realy coordinate bool CheckDeltaVectorInCurrentState();//Check climb is possibly in current character location without return new coordinates void MoveTo(const FVector&amp; Delta, const FRotator&amp; NewRotation); };</span></span></code> </pre> <br><br>  So, as we see, a CD is a state machine that, depending on the value of the variable ClimbingMode, determines one or another behavior model.  And now about the main methods: <br>  DoJump - Called when a character is jumping. <br>  TickComponent - The most important function is called every frame.  This is where the main code works. <br>  SetClimbMode - Toggles CD from one state to another <br>  DefineClimbMode - Determines which state the CD should switch to. <br>  CanSetClimbMode - determines whether the CD can switch to the desired state at the moment. <br>  CheckDeltaVectorInCurrentState - Gets the vector that the character should move to and if in the new coordinates the character can still be in the specified state, then it returns true, the specified coordinates and the angle of rotation of the character otherwise false. <br>  MoveTo - Moves the character to the desired position. <br><br>  The UCharacterMovementComponent object works only in conjunction with an ACharacter object.  Therefore, the class of our character will be derived from ACharacter, and here it is. <br><pre> <code class="cpp hljs">UCLASS() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CLIMBINGSYSTEM_API</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AClimbingCharacter</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ACharacter { GENERATED_BODY() <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: UPROPERTY(Category = Character, VisibleAnywhere, BlueprintReadOnly) USpringArmComponent* CameraSpringArm; UPROPERTY(Category = Character, VisibleAnywhere, BlueprintReadOnly) UCameraComponent* Camera; <span class="hljs-comment"><span class="hljs-comment">// Sets default values for this pawn's properties //AClimbingCharacter(); AClimbingCharacter(const FObjectInitializer&amp; ObjectInitializer = FObjectInitializer::Get()); // Called when the game starts or when spawned virtual void BeginPlay() override; // Called every frame virtual void Tick( float DeltaSeconds ) override; // Called to bind functionality to input virtual void SetupPlayerInputComponent(class UInputComponent* InputComponent) override; void MoveForward(float AxisValue); void MoveRight(float AxisValue); void CameraPitch(float AxisValue); void CameraYaw(float AxisValue); UFUNCTION(BlueprintCallable, Category = "Pawn|Character") virtual void Jump() override; UFUNCTION(BlueprintCallable, Category = "ClimbingCharacter") void ChangeView(bool FistPirson); void SwitchView(); void CrouchFunk(); void UnCrouchFunk(); virtual void NotifyActorBeginOverlap(AActor* OtherActor) override; private: /** Pointer to climbing movement component*/ UPROPERTY(Category = Character, VisibleAnywhere, BlueprintReadOnly, meta = (AllowPrivateAccess = "true")) class UClimbingPawnMovementComponent* ClimbingMovement; class AOverlapObject* OverlopObject; class AZipLine* ZipLine; bool bFistPirsonView; USkeletalMeshComponent* ClimbMesh; UCapsuleComponent* ClimbCapsule; friend class UClimbingPawnMovementComponent; };</span></span></code> </pre><br><br>  And here we have the first problem.  The fact is that an ACharacter object spawns a UCharacterMovementComponent object in its constructor.  But we need not a UCharacterMovementComponent, but a UClimbingPawnMovementComponent.  In order for an ACharacter to spawn a UClimbingPawnMovementComponent, you need to change the AClimbingCharacter's constructor with this: <br><pre> <code class="cpp hljs">AClimbingCharacter::AClimbingCharacter(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> class FObjectInitializer&amp; ObjectInitializer) : Super(ObjectInitializer) {</code> </pre><br>  on this: <br><pre> <code class="cpp hljs">AClimbingCharacter::AClimbingCharacter(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FObjectInitializer&amp; ObjectInitializer) : Super(ObjectInitializer.SetDefaultSubobjectClass&lt;UClimbingPawnMovementComponent&gt;(ACharacter::CharacterMovementComponentName)) {</code> </pre><br>  Now the ACharacter will generate what we need. <br><br>  <b>This is interesting:</b> You probably noticed the word Super, what does it mean?  The word Super will replace the name of the base class for the object in which it is used.  That is, if I write Super :: Tick (), this means that I called the Tick method from the base class of the object. <br><br>  Then I will talk about the main methods: <br><br>  You were probably attracted by the ChangeView method.  Yes, by pressing the F button, it will be possible to switch from the first person view to the third view.  Although it disagrees with the canon. <br><br>  The MoveForward, MoveRight, CameraPitch, CameraYaw, CrouchFunk, UnCrouchFunk, Jump methods are responsible for keyboard and mouse input. <br><br>  The NotifyActorBeginOverlap method works when a character crosses some other object.  For all the interactive objects, I created the base class AOverlapObject here it is: <br><pre> <code class="cpp hljs">UCLASS() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CLIMBINGSYSTEM_API</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AOverlapObject</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> AActor { GENERATED_BODY() <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">enum</span></span></span><span class="hljs-function"> EClimbingMode </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetObjectType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: UPROPERTY(Category = ObjectType, VisibleAnywhere, BlueprintReadOnly, meta = (AllowPrivateAccess = <span class="hljs-string"><span class="hljs-string">"true"</span></span>)) TEnumAsByte&lt;<span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> EClimbingMode&gt; ObjectType; };</code> </pre><br>  This object contains a EClimbingMode type variable. When a character crosses this object, its Motion Component switches to this state. <br><br>  So far I have done only one interactive object. AZipLine is such a rope for which the character grabs and rolls down it.  If you played Mirror's edge, then you understand what I mean. <br><pre> <code class="cpp hljs">UCLASS() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CLIMBINGSYSTEM_API</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AZipLine</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> AOverlapObject { GENERATED_BODY() <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: AZipLine(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnConstruction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> FTransform&amp; Transform)</span></span></span><span class="hljs-function"> override</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PostEditMove</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bFinished)</span></span></span><span class="hljs-function"> override</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** The main skeletal mesh associated with this Character (optional sub-object). */</span></span> UPROPERTY(Category = ZipLine, VisibleDefaultsOnly, BlueprintReadOnly) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UStaticMeshComponent</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StartBase</span></span></span><span class="hljs-class">;</span></span> UPROPERTY(Category = ZipLine, VisibleDefaultsOnly, BlueprintReadOnly) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UStaticMeshComponent</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EndBase</span></span></span><span class="hljs-class">;</span></span> UPROPERTY(Category = ZipLine, VisibleDefaultsOnly, BlueprintReadOnly) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">USplineComponent</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Spline</span></span></span><span class="hljs-class">;</span></span> UPROPERTY(Category = ZipLine, VisibleDefaultsOnly, BlueprintReadOnly) USceneComponent* Pivot; UPROPERTY(Category = ZipLine, VisibleDefaultsOnly, BlueprintReadOnly) UBoxComponent* EndBox; UPROPERTY(Category = ZipLine, EditAnywhere, BlueprintReadOnly) UStaticMesh* RopeMesh; UPROPERTY(Category = ZipLine, EditAnywhere, BlueprintReadOnly) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> SplineHeight; <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> WITH_EDITORONLY_DATA UPROPERTY() class UArrowComponent* ArrowComponent; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> protected: TArray</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;class USplineMeshComponent*&gt; AddedSplineMeshComponents; void SetupSpline(); };</span></span></span></span></code> </pre><br><br>  The OnConstruction method is similar to the ConstructionScript function in blueprint; it is also called when the ector is moved or changed.  True, there is a slight difference, if in the blueprint all the added objects are automatically destroyed during each rebuilding, then in c ++ you have to destroy the objects yourself. <br><br>  A small demonstration: <iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/dSjZBR9v4DA%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjaqnDnNDETl-5itLzrciDahutv8g" frameborder="0" allowfullscreen=""></iframe><br><br>  Actually this is all as promised <a href="https://github.com/Deema35/Climbing-Movement-Component">source</a> .  By popular demand of the population, I posted them on github. </div><p>Source: <a href="https://habr.com/ru/post/303394/">https://habr.com/ru/post/303394/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../303380/index.html">Not Pascal alone: ‚Äã‚Äãwhat did the winner of the computer "Nobel Prize" Niklaus Wirth do for the modern world?</a></li>
<li><a href="../303382/index.html">From blacklists to intelligent call management</a></li>
<li><a href="../303386/index.html">inter-AS Option AB (D)</a></li>
<li><a href="../303388/index.html">The harsh web development market in Russia or why do we need databases, persistent storage and FTP</a></li>
<li><a href="../303390/index.html">As one developer on google i / o traveled</a></li>
<li><a href="../303398/index.html">Do you correspond on personal questions from your work computer? Do you know what the European Court thinks about this?</a></li>
<li><a href="../303400/index.html">KUKU.io - how the cloud service is designed for managing social networks</a></li>
<li><a href="../303402/index.html">Databoom control panel. Work with collections. Part 1</a></li>
<li><a href="../303404/index.html">Trying on deduplication and compression to backup</a></li>
<li><a href="../303406/index.html">Several useful tricks for developing on Yii 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>