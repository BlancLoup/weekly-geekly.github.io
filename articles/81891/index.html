<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Exact Model Property Names in Doctrine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is devoted to the exact (case sensitive) mapping of the names of the columns of the database table to the model properties. This problem ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Exact Model Property Names in Doctrine</h1><div class="post__text post__text-html js-mediator-article">  This article is devoted to the exact (case sensitive) mapping of the names of the columns of the database table to the model properties.  This problem is relevant for the 1st branch of ORM, since  in the second branch, it seems to have already been solved.  But since  Since stable release is currently version 1.2.1 and version 2 is in ALPHA4 stage, I think that this problem is relevant for many ORM users. <br><a name="habracut"></a><br>  <b>If camelCase column names / aliases are not used in your project, then this decision will be irrelevant for you.</b> <br><br><h2>  Problem </h2><br>  While working with Doctrine, I had a problem.  Many DB columns had names like camelCase.  And when receiving records turned into lowercase.  At first I sinned on Mysql. <br><blockquote>  Column, index, and stored routine, <b>nor are column aliases</b> .  Trigger names are case sensitive, which differs from standard SQL. <br></blockquote>  see <a href="http://dev.mysql.com/doc/refman/5.0/en/identifier-case-sensitivity.html">Identifier-case-sensitivity</a> <br><br>  From this it became clear that the column aliases are still case-sensitive, and the problem is that Doctrine itself incorrectly (case-insensitively) substitutes column aliases, making it strtolower ().  Googling, came across <a href="http://trac.doctrine-project.org/ticket/599">this page</a> .  The bug is closed for the second branch.  And for the first, strtolower () is automatically generated for column names.  It remains to find where ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Decision </h2><br>  Lots of code found quite quickly.  This is Doctrine_Table -&gt; setColumn ().  There we see: <br><blockquote>  $ name = strtolower ($ parts [0]); </blockquote>  and <br><blockquote>  $ name = strtolower ($ name); </blockquote><br>  They are responsible for bringing the names of the columns to lower case.  Now our task, without changing the ORM classes, is to make the register of column names not change. <br>  First, we create our own class MyDoctrine_Table, in which we overlap the setColumn () function and replace these parts of the code. <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> MyDoctrine_Table extends Doctrine_Table <br> { <br> <br> <font color="#0000ff">public</font> function setColumn($name, $type, $length = <font color="#0000ff">null</font> , $options = array(), $prepend = <font color="#0000ff">false</font> ) <br> { <br> <font color="#0000ff">if</font> (is_string($options)) { <br> $options = explode( <font color="#A31515">'|'</font> , $options); <br> } <br> <br> <font color="#0000ff">foreach</font> ($options <font color="#0000ff">as</font> $k =&gt; $option) { <br> <font color="#0000ff">if</font> (is_numeric($k)) { <br> <font color="#0000ff">if</font> ( ! empty($option)) { <br> $options[$option] = <font color="#0000ff">true</font> ; <br> } <br> unset($options[$k]); <br> } <br> } <br> <br> <font color="#008000">// extract column name &amp; field name</font> <br> <font color="#0000ff">if</font> (stripos($name, <font color="#A31515">' as '</font> )) <br> { <br> <font color="#0000ff">if</font> (strpos($name, <font color="#A31515">' as '</font> )) { <br> $parts = explode( <font color="#A31515">' as '</font> , $name); <br> } <font color="#0000ff">else</font> { <br> $parts = explode( <font color="#A31515">' AS '</font> , $name); <br> } <br> <br> <font color="#0000ff">if</font> (count($parts) &gt; 1) { <br> $fieldName = $parts[1]; <br> } <font color="#0000ff">else</font> { <br> $fieldName = $parts[0]; <br> } <br> <br> <font color="#008000">//$name = strtolower($parts[0]);</font> <br> $name = $parts[0]; <br> } <font color="#0000ff">else</font> { <br> $fieldName = $name; <br> <font color="#008000">//$name = strtolower($name);</font> <br> } <br> <br> $name = trim($name); <br> $fieldName = trim($fieldName); <br> <br> <font color="#0000ff">if</font> ($prepend) { <br> $ <font color="#0000ff">this</font> -&gt;_columnNames = array_merge(array($fieldName =&gt; $name), $ <font color="#0000ff">this</font> -&gt;_columnNames); <br> $ <font color="#0000ff">this</font> -&gt;_fieldNames = array_merge(array($name =&gt; $fieldName), $ <font color="#0000ff">this</font> -&gt;_fieldNames); <br> } <font color="#0000ff">else</font> { <br> $ <font color="#0000ff">this</font> -&gt;_columnNames[$fieldName] = $name; <br> $ <font color="#0000ff">this</font> -&gt;_fieldNames[$name] = $fieldName; <br> } <br> <br> <font color="#0000ff">if</font> ($length == <font color="#0000ff">null</font> ) { <br> <font color="#0000ff">switch</font> ($type) { <br> <font color="#0000ff">case</font> <font color="#A31515">'integer'</font> : <br> $length = 8; <br> <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> <font color="#A31515">'decimal'</font> : <br> $length = 18; <br> <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> <font color="#A31515">'string'</font> : <br> <font color="#0000ff">case</font> <font color="#A31515">'clob'</font> : <br> <font color="#0000ff">case</font> <font color="#A31515">'float'</font> : <br> <font color="#0000ff">case</font> <font color="#A31515">'integer'</font> : <br> <font color="#0000ff">case</font> <font color="#A31515">'array'</font> : <br> <font color="#0000ff">case</font> <font color="#A31515">'object'</font> : <br> <font color="#0000ff">case</font> <font color="#A31515">'blob'</font> : <br> <font color="#0000ff">case</font> <font color="#A31515">'gzip'</font> : <br> <font color="#008000">//$length = 2147483647;</font> <br> <br> <font color="#008000">//All the DataDict driver classes have work-arounds to deal</font> <br> <font color="#008000">//with unset lengths.</font> <br> $length = <font color="#0000ff">null</font> ; <br> <font color="#0000ff">break</font> ; <br> <font color="#0000ff">case</font> <font color="#A31515">'boolean'</font> : <br> $length = 1; <br> <font color="#0000ff">case</font> <font color="#A31515">'date'</font> : <br> <font color="#008000">// YYYY-MM-DD ISO 8601</font> <br> $length = 10; <br> <font color="#0000ff">case</font> <font color="#A31515">'time'</font> : <br> <font color="#008000">// HH:NN:SS+00:00 ISO 8601</font> <br> $length = 14; <br> <font color="#0000ff">case</font> <font color="#A31515">'timestamp'</font> : <br> <font color="#008000">// YYYY-MM-DDTHH:MM:SS+00:00 ISO 8601</font> <br> $length = 25; <br> <font color="#0000ff">break</font> ; <br> } <br> } <br> <br> $options[ <font color="#A31515">'type'</font> ] = $type; <br> $options[ <font color="#A31515">'length'</font> ] = $length; <br> <br> <font color="#0000ff">if</font> ($prepend) { <br> $ <font color="#0000ff">this</font> -&gt;_columns = array_merge(array($name =&gt; $options), $ <font color="#0000ff">this</font> -&gt;_columns); <br> } <font color="#0000ff">else</font> { <br> $ <font color="#0000ff">this</font> -&gt;_columns[$name] = $options; <br> } <br> <br> <font color="#0000ff">if</font> (isset($options[ <font color="#A31515">'primary'</font> ]) &amp;&amp; $options[ <font color="#A31515">'primary'</font> ]) { <br> <font color="#0000ff">if</font> (isset($ <font color="#0000ff">this</font> -&gt;_identifier)) { <br> $ <font color="#0000ff">this</font> -&gt;_identifier = (array) $ <font color="#0000ff">this</font> -&gt;_identifier; <br> } <br> <font color="#0000ff">if</font> ( ! in_array($fieldName, $ <font color="#0000ff">this</font> -&gt;_identifier)) { <br> $ <font color="#0000ff">this</font> -&gt;_identifier[] = $fieldName; <br> } <br> } <br> <font color="#0000ff">if</font> (isset($options[ <font color="#A31515">'default'</font> ])) { <br> $ <font color="#0000ff">this</font> -&gt;hasDefaultValues = <font color="#0000ff">true</font> ; <br> } <br> } <br> <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Then in bootstrap.php we include it, and register it as a class of the Doctrine table. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">//   lowercase   </font> <br> require_once(dirname(__FILE__) . <font color="#A31515">'/lib/doctrine_extra/MyDoctrine/Table.php'</font> ); <br> $conn-&gt;setAttribute(Doctrine::ATTR_TABLE_CLASS, <font color="#A31515">'MyDoctrine_Table'</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Everything, now the name of properties of models completely coincides with names of columns of the table. <br><br>  Please do not judge strictly, if you have other solutions for this task, I will be glad to hear them in the comments. </div><p>Source: <a href="https://habr.com/ru/post/81891/">https://habr.com/ru/post/81891/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../81885/index.html">Let me introduce - Notes programmer</a></li>
<li><a href="../81886/index.html">Do I need a blog about geo-information systems (GIS) on Habr√©?</a></li>
<li><a href="../81888/index.html">IT League 10 (one-zero) in Kharkov</a></li>
<li><a href="../81889/index.html">Linux, security and all that ... (after)</a></li>
<li><a href="../81890/index.html">Energy Roof Coop Himmelb (l) au, Italy</a></li>
<li><a href="../81892/index.html">SLTV - the first national Internet TV channel about software</a></li>
<li><a href="../81894/index.html">Visual integration of Firefox into KDE 4</a></li>
<li><a href="../81895/index.html">Google AppEngine Development: Right From the Start</a></li>
<li><a href="../81897/index.html">German aerial photographs of Leningrad 1942</a></li>
<li><a href="../81899/index.html">Google almost caught up with Yandex (according to comScore)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>