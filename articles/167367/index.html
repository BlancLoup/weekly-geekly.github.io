<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Deploying DNS / DDNS and DHCP servers on ROSA Enterpise Linux Server in a few minutes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction. 

 This article will describe the deployment of a standard DNS server and a DHCP server on your company's LAN, as well as a server suppo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Deploying DNS / DDNS and DHCP servers on ROSA Enterpise Linux Server in a few minutes</h1><div class="post__text post__text-html js-mediator-article">  <b>Introduction.</b> <br><br>  This article will describe the deployment of a standard DNS server and a DHCP server on your company's LAN, as well as a server supporting dynamic DNS technology.  Both of these topics will be consistently discussed in the described material on the example of the ROSA Enterprise Linux Server (hereinafter referred to as RELS) and tools with it.  This is the first article in a series describing the use of RELS in real enterprise environments. <br><br>  <b>Why is it necessary?</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For the public permanently living here it will not be a secret that, sooner or later, system administrators with the growth of infrastructure have to deal with the fact that the existing farm must somehow be managed.  The most logical solution is the implementation of DNS and DHCP servers within the intranet.  But then another question arises, how can this be maintained quickly and easily, without a long and painful reading of the BIND, dhcpd server documentation and spending time writing scripts that will somehow synchronize the work of these two demons?  Ideally, we need to set everything up once and not to touch it.  That is, everything should be as automated as possible. <br>  In RELS for solving this problem there is a convenient and very simple tool for configuring DHCP servers and DNS servers, which we will use. <br>  As a bonus, I will tell and show you how very conveniently you can organize the management of a local network using DHCP and DynamicDNS. <br><a name="habracut"></a><br>  <b>We scatter!</b> <br><br>  To deploy our own name server (named server) in the local network of the enterprise, we will need the already mentioned RELS, as well as the installed and configured ROSA Directory Server.  It makes no sense here to describe the installation of the entire system from scratch, so we will immediately proceed to the packet selection phase, omitting the previous routing procedure and selecting some common OS settings. <br>  The only remark that I would like to make is that when deploying a server from the very beginning, at the stage of selecting packages for the installed system, you need to select two items: ‚ÄúServer Platform‚Äù and ‚ÄúROSA Directory Server‚Äù, as in the illustration below. <br><br><img src="https://habrastorage.org/storage2/479/049/04b/47904904b59b60caea408832dd525e59.png"><br><br>  Next, skipping the description of the many familiar process of installing the system and creating users, we will proceed directly to setting up the DNS server. <br>  After installing the OS and the first login from a regular user, our eyes will open the desktop with the ROSA Server Setup icon. <br>  Now we will make a small digression and specify the settings: <br><br><ol><li>  The server and computers serviced by the DNS server are located on the 192.168.100.0/24 subnet, the server itself is configured to have the address 192.168.100.1; </li><li>  Rosa.int will be selected as the domain name; </li><li>  FQDN server name will be exactly the same as the domain name; </li><li>  The name of the main name server will be ns.rosa.int; </li></ol><br><br>  Before configuring the DNS server, you must verify the output of the hostname -f command.  If the output will produce any error like ‚Äúhostname: failed to find the host name‚Äù or something else that does not match the specified server name, then you need to open the / etc / hosts file with your favorite text editor and add: <br><br> <code>192.168.100.1 rosa rosa.int</code> <br> <br>  This is due to the fact that during installation ROSA Directory Server requires checking for the presence of an FQDN for the host where the DNS server will be located. <br><br>  <b>And now - we take off!</b>  <b>Set up a DNS server.</b> <br><br>  So, we proceed directly to the procedure of deployment and configuration. <br>  We click on the ROSA Server Setup icon on the desktop, after which Firefox will be launched with a warning about the wrong certificate.  We add our server to the exceptions, and then we get to the login page of the web interface, which is responsible for the installation and initial deployment of the necessary components required for the task. <br>  After adding the certificate to the exceptions, we get to the login page in the component deployment console, where after entering the username and password of the root user, we will see two blocks: ‚ÄúROSA Directory Server‚Äù and ‚ÄúServer services and tools‚Äù. <br>  For the installation and initial configuration of the DNS server, we need to select the ‚ÄúROSA Directory Server‚Äù block, which is located on the left.  In the list of server components that appears, you need to select the ‚ÄúDNS server with RDS backend‚Äù component in the ‚ÄúNetwork Modules‚Äù section, then click ‚ÄúInstall components‚Äù.  A setup wizard will start in which the procedure for checking the availability of necessary packages will be carried out first and, if they are not available, they will be automatically downloaded from the Internet. <br><br><img src="https://habrastorage.org/storage2/5a6/e72/63c/5a6e7263cea1c3593ebe1ee5e230f64f.png"><br><br>  To complete the procedure, you must click on the continue button, after which we will get to the next stage of the setup wizard.  Here we will be asked to set the FQDN-domain name of ROSA Directory Server and specify the network which will be allowed to serve recursive queries. <br>  Be sure to enter the password in the RDS Password field.  In the future, we will need it in order for us to log into the ROSA Management Console administration console, where a number of final settings will be made.  Upon completion of entering the necessary data, click the ‚ÄúContinue‚Äù button, after which you will be taken to the login page of the server component management console. <br>  If for some reason you need to do it later, then you can continue to configure the DNS from the main menu, section "Administration".  There is an icon ROSA Management Console.  An example of filling out the form in the screenshot below. <br><br><img src="https://habrastorage.org/storage2/2e4/af6/b7d/2e4af6b7db4560b3cd9a85b5737916cc.png"><br><br>  If you did not have time to forget, at the beginning of the article I wrote that before setting up the server, you need to make a small correction in the / etc / hosts file.  If you got the error shown below in the process, then you either forgot to do it, or did it wrong.  So I recommend in this case to check the contents of / etc / hosts again. <br><br><img src="https://habrastorage.org/storage2/6f8/66c/600/6f866c60005184b1a75c09213bd93944.png"><br><br>  But back to further customization.  After the installation is completed, you will be transferred to the main login page of the ROSA Magement Console automatically. <br>  The settings for the zones and the name server will be set according to the parameters specified at the very beginning of the article.  Keep in mind that your network settings may vary.  To configure, go to the section "Network"&gt; "Add DNS zone".  To do this, look at the top of the screen.  Or if you look a little lower, then the desired item will be immediately before your eyes. <br><br><img src="https://habrastorage.org/storage2/e23/3de/0aa/e233de0aaddc24edd24c962fe92efad8.png"><br><br>  The following parameters are set: <br><ol><li>  FQDN DNS zone name </li><li>  Description </li><li>  Name for the primary DNS server (in this case, the current host) </li><li>  IP address of the NS server </li><li>  Network address and subnet mask for the reverse zone. </li></ol><br><br>  The last point is also very necessary if we are going to create a DNS server in the future in conjunction with a DHCP server. <br>  After specifying the parameters we need, click "Create".  In case of successful and correct configuration, a corresponding message will be displayed, as in the illustration below. <br><br><img src="https://habrastorage.org/storage2/c83/b3d/7bc/c83b3d7bcf07bc8f8b002d2ab1ec00f6.png"><br><br>  To check DNS operation, it is now sufficient to open your favorite terminal emulator or cmd.exe if you are using Windows.  Then specify your newly configured DNS server in the client system settings and ping the server name. <br>  In rare cases, a problem may arise when the DNS service does not apply the settings, for this it is enough to go to the ‚ÄúManage network services‚Äù section and restart the DNS server.  At this problem will be exhausted. <br><br>  <b>A little kung fu.</b>  <b>Configure Dynamic DNS.</b> <br><br>  But besides creating a regular DNS server, ROSA Server allows you to deploy a server with Dynamic DNS support.  For those who are a little unaware, a short excerpt from Wikipedia: <br><br><blockquote>  Dynamic DNS is a technology that allows information on a DNS server to be updated in real time and (optionally) automatically.  It is used to assign a permanent domain name to a device (computer, network drive) with a dynamic IP address.  This can be an IP address obtained via DHCP or IPCP on PPP connections (for example, when remotely accessed via a modem).  Other machines on the Internet may establish a domain name connection with this machine and not even know that the IP address has changed. </blockquote><br>  The setup procedure is slightly different from what we described above.  The first difference will be on the component selection screen.  To deploy a server with DDNS support, you must select the DDNS support for BIND with LDAP backend option in the Network Modules section. <br><br><img src="https://habrastorage.org/storage2/7a0/d45/c0e/7a0d45c0efc40f3f2ca34074cce6aebd.png"><br><br>  Like last time, after selecting the necessary, click "Install components", where we observe the procedure of downloading packages that is already familiar to us.  After the procedure is completed, the same as last time, the procedure of pre-setting the components will be launched.  Please pay attention to the warning that appears at the very end, after installing the components related to the DHCP server. <br><br><img src="https://habrastorage.org/storage2/a0d/086/4f2/a0d0864f2964e4ab462ecb271ec29250.png"><br><br>  The setup wizard tells us that additional configuration will be required.  To do this, go to the administrative console ROSA Management Console and open the DNS zone settings panel, as before.  Here we are waiting for another difference: <br><br><img src="https://habrastorage.org/storage2/347/ff6/a90/347ff6a900a524b0f0cea285898599b0.png"><br><br>  At the very bottom, if you notice, there is another item ‚ÄúCreate a connected DHCP subnet‚Äù, which, in fact, creates a subnet that will be controlled by DHCP. <br><br><img src="https://habrastorage.org/storage2/8f4/f1a/d56/8f4f1ad5637f4eb7a53f234ec638babd.png"><br><br>  After clicking the "Create" button, you will need to make small changes in the settings.  To do this, go to the tab "DHCP subnet" and open the editing of existing settings. <br><br>  At the very bottom of the form that opens, look for the inscription ‚ÄúDynamic pools for unregistered DHCP clients‚Äù and click the checkbox in front of the label.  Enter the values ‚Äã‚Äãwe need.  I usually reserve several addresses from the upper range for business needs (additional servers, routers, and the like). <br>  After that, click even lower click on the button "Confirm". <br><br>  If this is not done, no client will be able to get an IP address, and in / var / log / messages you will see messages of this kind: <br><blockquote>  Nov 20 17:19:25 rosa dhcpd: DHCPDISCOVER from 08: 00: 27: 98: b0: cf via eth0: network 192.168.100.0/24: no free leases <br>  Nov 20 17:19:34 rosa dhcpd: DHCPDISCOVER from 08: 00: 27: 98: b0: cf via eth0: network 192.168.100.0/24: no free leases <br>  Nov 20 17:19:50 rosa dhcpd: DHCPDISCOVER from 08: 00: 27: 98: b0: cf via eth0: network 192.168.100.0/24: no free leases </blockquote><br><br>  Other settings related to setting the lease term, TFTP and other things can be customized at your discretion.  To check the correct performance, it is enough that already exists. <br><br>  At the time of this writing, there was a small bug in the Management Console interface.  In the case of adding an empty address pool, it still saved the settings, but after that the DHCP server was not restarted.  Therefore it is necessary to be attentive.  Later it is planned to add a check of the entered values ‚Äã‚Äãin the form. <br>  Now, after the settings, go to the section "Management of network services" and restarts the DHCP and DNS server. <br>  As usual, we check the DNS operation with the ping command.  To make sure that DDNS works as it should, I put a Windows machine named termit into the network.  Since DHCP is configured correctly, the system immediately received the necessary settings.  And now we check the work of DDNS: <br><br><blockquote>  [test @ localhost ~] $ dig termit.rosa.int <br><br>  ;  &lt;&lt; &gt;&gt; DiG 9.9.1-P2 &lt;&lt; &gt;&gt; termit.rosa.int <br>  ;;  global options: + cmd <br>  ;;  Got answer: <br>  ;;  - &gt;&gt; HEADER &lt;&lt; - opcode: QUERY, status: NXDOMAIN, id: 41416 <br>  ;;  flags: qr aa rd ra;  QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1 <br><br>  ;;  OPT PSEUDOSECTION: <br>  ;  EDNS: version: 0, flags :;  udp: 4096 <br>  ;;  QUESTION SECTION: <br>  ; termit.rosa.int.  IN A <br><br>  ;;  AUTHORITY SECTION: <br>  rosa.int.  3600 IN SOA ns.rosa.int.  admin.rosa.int.  2012112003 172800 900 1209600 3600 <br><br>  ;;  Query time: 2 msec <br>  ;;  SERVER: 192.168.100.1 # 53 (192.168.100.1) <br>  ;;  WHEN: Tue Nov 20 18:04:27 2012 <br>  ;;  MSG SIZE rcvd: 89 </blockquote><br><br>  As we can see, the A-record of the Windows machine appeared in the DNS.  In the case of changing the address, for example, in the case of the expiration of the lease IP-address after a long period of absence in the network, all the details change automatically.  In this case, the administrator will not need any intervention.  Absolutely the same will happen when adding a computer with Linux on board to the network.  It will only be necessary to specify the computer name (hostname) other than localhost.  ROSA Server will do the rest for you. <br>  Now, if necessary, you can deploy any service on such a host and contact it using the FQDN name, without thinking that it may suddenly become unavailable due to a change in addressing or to which address to be assigned to the machine from the service running there. <br><br>  <b>Conclusion</b> <br><br>  I hope this tutorial will make life easier for someone and save a lot of time.  Another bonus is the most inquisitive.  If it is interesting for someone to read in detail about how the DDNS and DHCP bundle in ROSA Server is arranged, you can <a href="http://wiki.rosalab.ru/ru/index.php/%25D0%2598%25D1%2581%25D0%25BF%25D0%25BE%25D0%25BB%25D1%258C%25D0%25B7%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5_DDNS_%25D0%25B8_LDAP_%25D1%2581%25D0%25BE%25D0%25B2%25D0%25BC%25D0%25B5%25D1%2581%25D1%2582%25D0%25BD%25D0%25BE_%25D1%2581_ROSA_Directory_Server">read the article in the wiki of the</a> company developing this solution. <br><br>  Reasonable criticism, comments and questions are certainly welcome.  If you liked the material, I will willingly continue the series of articles. </div><p>Source: <a href="https://habr.com/ru/post/167367/">https://habr.com/ru/post/167367/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../167349/index.html">dynDNS for Amazon EC2 or how to automate IP auto-update on hosting with dynamic public IP</a></li>
<li><a href="../167351/index.html">Business Plan "Creating a Game"</a></li>
<li><a href="../167353/index.html">Sublime Text 2 for C / C ++ Developer or SublimeClang</a></li>
<li><a href="../167359/index.html">MintEye CAPTCHA solution in 31 lines of code without even opening the picture</a></li>
<li><a href="../167363/index.html">The implementation of the Euclidean algorithm on Shakespeare</a></li>
<li><a href="../167371/index.html">The release of a new program for video monitoring user actions: NetWrix User Activity Video Reporter</a></li>
<li><a href="../167375/index.html">Forwarding vlan'ov through Juniper</a></li>
<li><a href="../167377/index.html">Windows To Go Technology in Windows 8</a></li>
<li><a href="../167381/index.html">Overview of salaries of IT-directors</a></li>
<li><a href="../167385/index.html">Startup pivot: from mobile to web application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>