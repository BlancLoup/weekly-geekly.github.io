<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>I want to take and shoot, or an educational program about why you should not use make install</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="By writing this note, I was inspired by the fact that I was tired of making detailed comments on this topic in the comments to the articles, where as ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>I want to take and shoot, or an educational program about why you should not use make install</h1><div class="post__text post__text-html js-mediator-article"><table><tbody><tr><td>  <sub>By writing this note, I was inspired by the fact that I was tired of making detailed comments on this topic in the comments to the articles, where as part of the instructions for building and configuring something for a specific distro, they propose to do a install install.</sub> </td></tr></tbody></table><img src="https://habrastorage.org/storage1/edcaa898/70b48a52/3072387b/da577538.png" align="left">  The bottom line is that this command in the form of ‚Äúmake install‚Äù or ‚Äúsudo make install‚Äù cannot be used in modern distributions. <br><br>  But the authors of the programs in the installation manuals write that you need to use this command, perhaps you will say.  Yes, they write.  But this only means that they do not know what kind of distribution kit you have, and whether it is a distribution kit at all, maybe you joined a sect and <s>smoked</s> about <s>reading</s> LFS and now decided to build their creation under your chthonic system.  And make install is universal, though often the wrong way to do it. <br><br><a name="habracut"></a><h4>  Lyrical digression </h4><br>  As you know, for normal operation, most software must not only be compiled, but also correctly installed in the system.  Programs expect to find the files they need in certain places, and these places in most * nix-systems are protected in the code at the compilation stage.  In addition to this aspect, the main difference in the linux / freebsd / whatever installation process from that in Windows and MacOS is that the program does not just add a bunch of files to a separate directory in Program Files or / Applications, but ‚Äúsmears‚Äù itself across the entire file system.  Libraries go to lib, executable files to bin, configs to etc, all sorts of data to var, and so on.  If you suddenly need to update it, then all this must first be cleaned up somehow, since <i>when using the new version, the remnants of the old files can lead to completely unpredictable consequences</i> , often bad ones.  The probability of this event is not so great, but you need it on the battle server? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  So what? </h4><br>  So, if you did the installation directly through make install, then you most likely will <i>not be able</i> to uninstall or update the software.  Moreover, installing a new version on top of the old one will most likely <i>wipe your changes in configs</i> .  make install does exactly what it says - installs the files in the right places, ignoring the fact that something is already there.  After this process, absolutely no information about what was put and where it was impossible to obtain in a digestible form.  Sometimes, of course, the Makefile supports the uninstall action, but this is not so common, and it‚Äôs not a fact that it works correctly.  In addition, it is strange to keep the unpacked source tree and build rules for uninstallation. <br><br><h4>  How to fight? </h4><br>  Since packages have the ability to sometimes be updated in distributions, they have invented such a thing as a package manager to solve this problem.  When using it, the installation goes something like this: <br><br><ol><li>  taken in a certain way formed archive </li><li>  information is extracted from it about what it is at all, what version, what it depends on, what conflicts with it, whether it is necessary to run some scripts to install / delete / configure, etc </li><li>  Perform direct installation steps. </li><li>  All data about where and what was delivered are added to the database of the package manager. </li></ol><br><br>  In this case, when upgrading, you can safely remove too much, and at the same time see if the files marked as configuration have changed in the system and ask what to do if their content is different in the new version.  In addition, the package manager will not allow to overwrite the files of one package when installing another.  In general, a lot of useful things he can do. <br><br>  If you are unknowingly / lazy to make install install instructions, then <i>files appear on the system that the package manager does not know about</i> .  With all that implies, if not enough of what has been listed before. <br><br><h4>  What to do? </h4><br>  You can, of course, configure the source tree so that the installation of everything and everything goes somewhere in / opt / mycoolapp /, and then, if necessary, remove it with your hands, but then a lot of unpleasant things can come out, starting with what the program expects load their libraries, and the loader about the directory where they lie knows nothing, ending with the fact that the author of the program can expect that for example, if he puts the file, say in $ prefix / share / xsessions /, then the display manager will pick it up.  Not to mention the paths for pkgconfig and so on. <br><br>  So it is necessary to collect the package. <br><br><h4>  I don‚Äôt have time to do this with ***, it‚Äôs better to do make install again, everything is simple and clear! </h4><br>  Calm, calm.  He's tied to our feet.  Everything is not so scary and difficult, as it seems at first glance. <br><br><h5>  checkinstall </h5><br>  This wonderful utility, being run instead of make install, will ask a few questions, after which it will assemble and install the package.  Everything, at updating any problems with cleaning of old stuff you will not have. <br><br><h5>  Build a deb package manually </h5><br>  If you are not inclined to trust such automatics (which sometimes still mows down) or you want to make a couple of changes, but it‚Äôs still lazy to deal with the normal package building process, you can assemble the package with handles.  I provide a way to build it for Debian-based systems, since it‚Äôs best known to them.  It is not ideologically correct, but the output is a completely correct package without using additional entities.  This is done as follows. <br>  To begin with, we collect software with the parameters previously specified for configure or autogen.sh --prefix = / usr and --exec-prefix = / usr. <br>  Next, make the installation in a temporary directory.  We write: <br><br><pre><code class="bash hljs">fakeroot
make install DESTDIR=`<span class="hljs-built_in"><span class="hljs-built_in">pwd</span></span>`/tempinstall</code></pre><br>
         . ,     fakeroot-, . .        ,        .    fakeroot-    ,         .<br>
   ¬´ ¬ª  DEBIAN    DEBIAN/conffiles   ,     /etc:<br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> tempinstall
mkdir DEBIAN
find etc | sed <span class="hljs-string"><span class="hljs-string">"s/^/\//"</span></span> &gt; DEBIAN/conffiles
</code></pre><br>
    DEBIAN/control  :<br>
<table>
<tbody><tr>
<td><pre>Package: _
Version: 1.2.3
Architecture: amd64/i386/armel/all
Maintainer:    ,  ,    ,  dpkg  
Depends:       .
Priority: optional
Description:   - ,    
</pre></td>
</tr>
</tbody></table><br>
<br>
       preinst, postinst, prerm  postrm.<br>
<br>
,  dpkg -b tempinstall     tempinstall.deb,     dpkg -i    ,   .<br>
<br>
¬´¬ª            ,     ,         .<br>
<br>
<h4></h4><br>
<br>
 ,     ,            . <br>
<br>
<i>     :  checkinstall  make install.     .</i></div><p>Source: <a href="https://habr.com/ru/post/130868/">https://habr.com/ru/post/130868/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../130861/index.html">Proxy Cookies on Nginx using the lua-nginx module</a></li>
<li><a href="../130862/index.html">BlackBerry Bold 9900 - the last hero?</a></li>
<li><a href="../130865/index.html">Google Reader, finally!</a></li>
<li><a href="../130866/index.html">One of the most sought-after windows features was found in LXDE.</a></li>
<li><a href="../130867/index.html">iOS 5 Tech Talk World Tour 2011</a></li>
<li><a href="../130869/index.html">WP7 social client. network "Vkontakte" open source</a></li>
<li><a href="../130870/index.html">Drupal Bundle Inherit - module for inheriting entity types</a></li>
<li><a href="../130871/index.html">About networks: a little bit of everything</a></li>
<li><a href="../130872/index.html">TV monitor</a></li>
<li><a href="../130873/index.html">Interpolation: draw smooth graphics with PHP and GD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>