<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CsvLogWriter plugin for JMeter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Surely everyone who used standard listeners in JMeter, faced the following restrictions: 


- standard listeners do not allow getting d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CsvLogWriter plugin for JMeter</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/25c/ac5/330/25cac53300e7469194e32f15029759ee.jpg"><br><h4>  Introduction </h4><br>  Surely everyone who used standard listeners in JMeter, faced the following restrictions: <br><ul><li>  standard listeners do not allow getting detailed information on all subqueries specified in the test plan; </li><li>  Standard listeners output information in XML format, which complicates the further analysis of logs using Excel and Pandas. </li></ul><br>  To circumvent these restrictions, it was decided to rework the formation of log files using the new CsvLogWriter plugin. <br><a name="habracut"></a><br><h4>  Assigned tasks </h4><br>  It was necessary to develop a plugin for JMeter, which would have the following functionality: <br><ul><li>  displaying the full text of the error in string format; </li><li>  data capture by child subqueries. </li></ul><br>  In standard listeners for JMeter, fixing the full content of the error is possible in XML format, which causes inconvenience for analysis.  There was a need to save the text of the error in a string format followed by recording, for example, in the CSV format to ensure the possibility of plotting in Excel and Pandas.  Usually, the resulting log files do not display data on child subqueries.  That is extremely inconvenient when using the complex structure of the test plan.  An example of the structure is shown in Figure 1. <br><br><img src="https://habrastorage.org/files/df9/e03/be3/df9e03be3170418db2d56530ade3317d.jpg"><br>  <i>Figure 1. The structure of the test plan</i> <br><br>  When using standard listeners we will not be able to get the data of subqueries (embedded resources), CSVLogWriter gives us this opportunity. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Description of plugin functionality pflb @ CsvLogWriter </h4><br>  A plugin pflb @ CsvLogWriter for JMeter was written during the work.  The key features of this plugin include the fact that it can record the results of the work of the child subqueries and record the full text of the error, when it occurs, in plain text, and not in the XML format. <br><br><div class="spoiler">  <b class="spoiler_title">Log fields description</b> <div class="spoiler_text"><h5>  Log format </h5><br>  The data recorded in the log file are presented in Table 1. <br>  Table 1. Log Format <br><table><tbody><tr><th>  No </th><th>  Name </th><th>  Type of </th><th>  Description </th><th>  Examples of values ‚Äã‚Äãfor the log column </th><th>  unit of measurement </th></tr><tr><td>  one </td><td>  timeStamp </td><td>  long </td><td>  Start or end time of request </td><td></td><td>  ms </td></tr><tr><td>  2 </td><td>  elapsed </td><td>  long </td><td>  Request processing time: endTime - startTime - idleTime </td><td>  49, 434 </td><td>  ms </td></tr><tr><td>  3 </td><td>  label </td><td>  String </td><td>  JMeter component name </td><td></td><td></td></tr><tr><td>  four </td><td>  responseCode </td><td>  String </td><td>  Request response code </td><td>  "200", "Non HTTP response code: java.net.UnknownHostException" </td><td></td></tr><tr><td>  five </td><td>  responseMessage </td><td>  String </td><td>  Deciphering the response code </td><td>  "OK", "Internal Server Error" </td><td></td></tr><tr><td>  6 </td><td>  threadName </td><td>  String </td><td>  Stream name </td><td>  "Thread Group 1-1" </td><td></td></tr><tr><td>  7 </td><td>  dataType </td><td>  String </td><td>  The data type in the response, in practice, takes two values ‚Äã‚Äã- "bin" or "text" </td><td>  "Bin", "text" </td><td></td></tr><tr><td>  eight </td><td>  success </td><td>  boolean </td><td>  Request Success Status </td><td>  true or false </td><td></td></tr><tr><td>  9 </td><td>  failureMessage </td><td>  String </td><td>  Error message <br>  in the case of the Assertion component, <br>  added to the sampler. <br>  In CsvLogWriter messages are written in the field. <br>  from all Assertion components, <br>  which generated an error. <br>  Only the first message is recorded in the base logger. </td><td></td><td></td></tr><tr><td>  ten </td><td>  bytes </td><td>  int </td><td>  The size of the answer. <br>  The value and calculation algorithm depend on the settings. <br>  sampler  The value may be affected by responseData.length, <br>  headersSize, bodySize. </td><td></td><td>  Byte </td></tr><tr><td>  eleven </td><td>  grpThreads </td><td>  int </td><td>  Number of active threads in the current group </td><td></td><td></td></tr><tr><td>  12 </td><td>  allThreads </td><td>  int </td><td>  The number of active virtual users of all groups </td><td></td><td></td></tr><tr><td>  13 </td><td>  URL </td><td>  String </td><td>  Link </td><td></td><td></td></tr><tr><td>  14 </td><td>  Filename </td><td>  String </td><td>  Names of the file to which the responses are recorded. <br>  The field is filled in using Save Response to File Listener. <br>  This Listener is rarely used, usually the value of a column <br>  - empty line </td><td></td><td></td></tr><tr><td>  15 </td><td>  Latency </td><td>  int </td><td>  The time to get the first server response. <br>  This time delay includes the time <br>  spent on connecting to the server <br>  delays due to the establishment of a secure connection <br>  and JMeter internal delays to receive <br>  first bytes of server response.  If for some reason <br>  Sampler's work was suspended, and then resumed, <br>  then the Latency value will be adjusted <br>  for the duration of the suspension Sampler. </td><td></td><td>  ms </td></tr><tr><td>  sixteen </td><td>  Encoding </td><td>  String </td><td>  Encoding.  The response encoding is returned, <br>  if the response encoding is not set, <br>  This returns the default encoding value. <br>  The default encoding value is set to <br>  "Sampleresult.default.encoding". <br>  For HTTP Request, the default value is ‚ÄúISO-8859-1‚Äù. </td><td>  "ISO-8859-1", "UTF-8" </td><td></td></tr><tr><td>  17 </td><td>  SampleCount </td><td>  int </td><td>  The number of samples. <br>  For HTTP Request, the value is 1. <br>  For JMS Sampler, subscribing to events <br>  and reading several messages at once, <br>  value equals the number of polling cycles <br>  or the number of read messages. <br>  The value is always greater than or equal to one. </td><td>  12 </td><td>  PC </td></tr><tr><td>  18 </td><td>  ErrorCount </td><td>  int </td><td>  Number of mistakes. <br>  For HTTP Request, the value is 0 if success <br>  and equals 1 if the request is not successful. <br>  For other samplers that process <br>  several messages at a time, <br>  value may be greater than 1. </td><td>  0, 1 </td><td>  PC </td></tr><tr><td>  nineteen </td><td>  Hostname </td><td>  String </td><td>  Machine name </td><td></td><td></td></tr><tr><td>  20 </td><td>  Idletime </td><td>  int </td><td>  Downtime </td><td></td><td>  ms </td></tr><tr><td>  21 </td><td>  Connect </td><td>  int </td><td>  Time spent on setting up a connection </td><td></td><td>  ms </td></tr><tr><td>  22 </td><td>  headersSize </td><td>  int </td><td>  Header size </td><td></td><td>  Byte </td></tr><tr><td>  23 </td><td>  bodySize </td><td>  int </td><td>  Body size </td><td></td><td>  Byte </td></tr><tr><td>  24 </td><td>  contentType </td><td>  String </td><td>  Content type from response header </td><td></td><td></td></tr><tr><td>  25 </td><td>  endTime </td><td>  long </td><td>  Request End Time </td><td></td><td>  ms </td></tr><tr><td>  26 </td><td>  isMonitor </td><td>  boolean </td><td>  Sign whether the checkmark is Use As Monitor </td><td>  true false </td><td></td></tr><tr><td>  27 </td><td>  threadName_label </td><td>  String </td><td>  Name of thread and JMeter component </td><td></td><td></td></tr><tr><td>  28 </td><td>  parent_threadName_label </td><td>  String </td><td>  Name of the thread and the parent JMeter component </td><td></td><td></td></tr><tr><td>  29 </td><td>  startTime </td><td>  long </td><td>  Request start time </td><td></td><td>  ms </td></tr><tr><td>  thirty </td><td>  stopTest </td><td>  boolean </td><td>  A sign of whether the test is stopped - the Stop button. <br>  Also in the settings of the Thread Group there is an option <br>  ‚ÄúStop Test‚Äù on error.  If in the column "stopTest" <br>  it is true, then this is exactly what happened. <br>  The script was interrupted by the current request. </td><td>  true false </td><td></td></tr><tr><td>  31 </td><td>  stopTestNow </td><td>  boolean </td><td>  The symptom stopped the test abruptly - the Shutdown button. <br>  Also in the settings of the Thread Group there is an option <br>  ‚ÄúStop Test Now‚Äù on error.  If in the column "stopTestNow" <br>  it is true, then this is exactly what happened. <br>  The script was interrupted by the current request. </td><td>  true false </td><td></td></tr><tr><td>  32 </td><td>  stopThread </td><td>  boolean </td><td>  A sign of whether the current thread has stopped. <br>  In the settings of the Thread Group there is an option ‚ÄúStop Thread‚Äù <br>  on error.  If the ‚ÄústopThread‚Äù column is true, <br>  it means exactly this situation occurred. <br>  The script was interrupted by the current request. </td><td>  true false </td><td></td></tr><tr><td>  33 </td><td>  startNextThreadLoop </td><td>  boolean </td><td>  Does the replay start? <br>  In the settings of the Thread Group is the option "Start Next Thread Loop" <br>  on error.  If the ‚ÄústartNextThreadLoop‚Äù column is true, <br>  it means exactly this situation occurred. <br>  The script was interrupted by the current request. </td><td>  true false </td><td></td></tr><tr><td>  34 </td><td>  isTransactionSampleEvent </td><td>  boolean </td><td>  A sign that the current event is a transaction (TransactionController).  That is, it is only a grouping element. </td><td>  true false </td><td></td></tr><tr><td>  35 </td><td>  transactionLevel </td><td>  int </td><td>  Request nesting level <br>  If Transaction Controller hierarchy is used <br>  or subqueries have subqueries, <br>  then in this column there will be an nesting level. </td><td>  0 for root query or root transaction controller. <br>  1 for a subquery whose parent is the root. </td><td></td></tr><tr><td>  36 </td><td>  responseDataAsString </td><td>  String </td><td>  Full error content in string format <br>  if it occurs, if success == false, <br>  then responseData will contain the complete response body </td><td></td><td></td></tr><tr><td>  37 </td><td>  requestHeaders </td><td>  String </td><td>  Request headers </td><td></td><td></td></tr><tr><td>  38 </td><td>  responseData </td><td>  String </td><td>  The full content of the error, if any, <br>  if success == false, then responseData will contain <br>  base64 full response body </td><td></td><td></td></tr><tr><td>  39 </td><td>  responseHeaders </td><td>  String </td><td>  Response headers </td><td></td><td></td></tr><tr><td>  40 </td><td>  &lt;Variable name&gt; </td><td>  String </td><td>  JMeter Variables </td><td></td><td></td></tr></tbody></table><br></div></div><br>  The log structure extends the basic CSV log format.  The basic set of parameters can be found at the link <a href="http://jmeter.apache.org/usermanual/listeners.html">jmeter.apache.org/usermanual/listeners.html#csvlogformat</a> <br><br>  The resulting CSV-log can be downloaded with any basic JMeter Listener that supports downloading of a CSV-log. <br>  Also, additional columns appeared in the log, which can be useful in the analysis (pp. 22-35 of the Log format table). <br>  The bodies and headers of responses and requests are recorded only in case of errors (pp. 36-39 of the Log Format table). <br>  Also, the logs for the variables will be written to the log: <a href="http://jmeter.apache.org/usermanual/listeners.html">jmeter.apache.org/usermanual/listeners.html#sample_variables</a> - description of the ability to log the values ‚Äã‚Äãof variables. <br><br><h4>  Interface </h4><br>  To run the plugin you must fill in the Filename field.  The Filename field contains the path to the file where the work results will be recorded.  You can set the directory manually, or select a file using the Browse button.  If the specified file exists, a new file is created.  The name of the new log file is formed by adding a postfix with the log file number to the original name. <br><br>  Also on the form are flags.  Using the checkboxes, you can manipulate the data recorded in the log.  The Additional parameters checkbox is responsible for fixing additional parameters (22-35 lines in the Log Format table), Response data is responsible for fixing error text (36-39 lines in the Log Format table), User variables are responsible for fixing user variables. <br><br>  The plug-in interface is shown in Figure 2. <br><br><img src="https://habrastorage.org/files/58a/c24/0fc/58ac240fc2d5409282b46497cc73d194.jpg"><br>  <i>Figure 2. Interface plug-in CSVLogWriter</i> <br><br><h4>  Compare CSVLogWriter and Simple Data Writer plugin </h4><br>  In this section, we will try to compare the CsvLogWriter plugin and the standard Simple Data Writer. <br><br><h5>  The composition of the logged data </h5><br>  The Simple Data Writer listener gives the user the ability to customize the list of captured data.  Figure 3 shows the output settings window. <br><br><img src="https://habrastorage.org/files/dc5/6a5/549/dc56a5549c974712a21c58e74baf0c64.jpg"><br>  <i>Figure 3. Simple Data Writer fixer data settings window</i> <br><br>  The CsvLogWriter plugin always displays a basic list of parameters (similar to Simple Data Writer) and allows you to customize the display of a list of additional data using 3 checkboxes on the form: <br><ul><li>  Additional parameters - additional parameters (22-35 lines in the Log Format table); </li><li>  Response data - error texts (36-39 lines in the Log format table); </li><li>  User variables - user variables (for output, you need to run JMeter with the -Jsample_variables key). </li></ul><br>  A detailed list of fixed data is fixed in the code.  But, as seen in Figure 3, Simple Data Writer cannot display error text in string format.  The full text of the error is recorded only in XML format.  For this reason, in the case when we need the text of errors, we have to keep 2 logs - 1 in CSV format (if further processing of the log with charting in Excel or Pandas is needed) and 1 in XML format. <br><br><h5>  Subquery Logging </h5><br>  Also, the Simple Data Writer listener does not record the results of the work of the child subqueries; accordingly, such a log file cannot be called exhaustive.  To visually compare the amount of output data, run the test corresponding to the test plan in Figure 1, and look at the log files.  The SimpleDataWriter log file is presented in Figure 4. <br><br><img src="https://habrastorage.org/files/9ad/fbf/837/9adfbf8378ef481aa1172da217482104.jpg"><br>  <i>Figure 4. Simple Data Writer log file</i> <br><br>  As you can see in Figure 4, SimpleDataWriter does not display information on embedded resources.  In turn, the CsvLogWriter plugin, by processing child subqueries, displays more information.  The content of the log file of the CsvLogWriter plugin is presented in Figure 5. <br><br><img src="https://habrastorage.org/files/8e3/5b8/0f8/8e35b80f828347b989c6818d09748579.jpg"><br>  <i>Figure 5. CsvLogWriter log file</i> <br><br><h4>  Performance comparison </h4><br>  We also analyzed the performance of the SimpleOccured method, which is responsible for event handling.  Profiling was done in Java VisualVM.  No subqueries were used in the test plan.  For SimpleDataWriter, testing was started with recording to 1 CSV file and recording to 2 files - CSV and XML.  The number of virtual users was 10, the number of repetitions is 100. The results of the comparison are shown in Table 2. <br><br>  Table 2. Comparison of the performance of SimpleDataWriter and CsvLogWriter plugin <br><table><tbody><tr><td>  CsvLogWriter </td><td>  SimpleDataWriter (CSV + XML) </td><td>  SimpleDataWriter (CSV) </td></tr><tr><td>  Duration (ms), number of calls </td><td>  Duration (ms), number of calls </td><td>  Duration (ms), number of calls </td></tr><tr><td>  215, 2000 </td><td>  23076, 4000 </td><td>  101, 2000 </td></tr></tbody></table><br>  Findings: <br><ul><li>  CsvLogWriter 10 times faster SimpleDataWriter (XML with maximum detail); </li><li>  CsvLogWriter 2 times slower than SimpleDataWriter (CSV with maximum detail); </li><li>  SimpleDataWriter (XML with maximum detail) is 20 times slower than SimpleDataWriter (CSV with maximum detail). </li></ul><br><br><h4>  Link to plugin </h4><br>  <a href="https://github.com/pflb/Jmeter.Plugin.CsvLogWriter">github.com/pflb/Jmeter.Plugin.CsvLogWriter</a> </div><p>Source: <a href="https://habr.com/ru/post/308098/">https://habr.com/ru/post/308098/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../308086/index.html">Individual daily limit for outgoing calls (limitation of paid directions)</a></li>
<li><a href="../308088/index.html">Safely use Go language in web programming</a></li>
<li><a href="../308090/index.html">About the division of labor and its consequences</a></li>
<li><a href="../308092/index.html">It's time to tell you how I was Beeline for 4 years on Habr√© - and what I learned about Habr during that time</a></li>
<li><a href="../308094/index.html">Training with reinforcements for the smallest</a></li>
<li><a href="../308100/index.html">Trello Clone on Phoenix and React. Parts 4-5</a></li>
<li><a href="../308102/index.html">Development for SailfishOS: menu</a></li>
<li><a href="../308104/index.html">From juniors to developers: we get the first job</a></li>
<li><a href="../308106/index.html">As I avoided burnout, having worked as a programmer for more than three decades</a></li>
<li><a href="../308108/index.html">What does HPE Mobile Center test?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>