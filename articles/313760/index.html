<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attackers specialize in compromising network routers in Brazil</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently we wrote about a large-scale DDoS attack, which was organized by the Mirai botnet, which consists of so-called devices. Internet of Things (I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attackers specialize in compromising network routers in Brazil</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/c87/1fe/538/c871fe538c224fbbb3ceec07bb58803a.jpeg" align="left" width="300">  Recently we <a href="https://habrahabr.ru/company/eset/blog/313444/">wrote</a> about a large-scale DDoS attack, which was organized by the Mirai botnet, which consists of so-called devices.  Internet of Things (IoT).  The cyber attack was so powerful that it led to disruptions of the largest Internet services.  Meanwhile, Mirai has in its arsenal only one way to compromise routers - the selection of standard passwords. <br><br>  Similar cyber attacks on routers have been observed since 2012, however, due to the significant increase in the number of working routers in recent years, the risk of their compromising has increased dramatically.  Given that many of them still come with standard passwords, we can only guess how huge a botnet can be created from such devices. <br><a name="habracut"></a><br>  It is likely that there are various groups of intruders carrying out such attacks.  However, the attack methods remain the same: they either use open access to routers due to weak authentication (default username and password) or vulnerabilities in their firmware. <br><br>  In such a scheme of attacks, intruders are interested in changing the DNS configuration, installing a backdoor for possible remote control of the router by accessing it by its public IP address, and setting a standard password for it in order to facilitate subsequent access by the attackers to the device itself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The attacks we observed were the result of redirecting a user from a malicious page or ad network to a malicious user's web page that hosts the malicious script.  After that, the script tries to use predefined combinations of username and password on the local IP address for specific types of routers.  Users of compromised routers mainly work on Firefox, Chrome or Opera web browsers.  In this case, the Internet Explorer web browser is more secure due to the fact that it does not support the ‚Äúusername: password @ server‚Äù notation used by the malicious user's scripts.  See <a href="https://support.microsoft.com/en-us/kb/834489">here</a> . <br><br>  Attackers use the Cross-Site Request Forgery Attack (CSRF) and the style attribute to initiate an attack.  In one particular case, we observed an attack that targeted a specific modem of a Brazilian provider, which comes with the following default credentials of ‚ÄúAdmin: gvt12345‚Äù: <br><br><img src="https://habrastorage.org/files/89d/4a1/a83/89d4a1a83ae84ec1821e90afba99a657.png"><br><br>  Which leads to the exchange of the following requests. <br><br><img src="https://habrastorage.org/files/656/8b9/1a4/6568b91a42d34770bf5761b5facb1e69.png"><br><br>  Other attackers got access to the router through its external IP-address. <br><br><img src="https://habrastorage.org/files/f2b/ceb/e1c/f2bcebe1c3064185bb6fb86f62c4ed49.png"><br><br>  It provides further instructions for ‚Äúupdating‚Äù the next web page.  The external IP address of the router is visible on these pages below. <br><br><img src="https://habrastorage.org/files/383/dad/730/383dad73071f426fa6e2688424c6dd21.png"><br><br>  In another attack scenario, attackers use the IPv6 protocol and the IFRAME element.  At the same time, they use obfuscation of the query text, which confuses not only analysts, but also an intrusion detection system (IDS). <br><br><img src="https://habrastorage.org/files/824/912/c9e/824912c9ed7b435c828eb3a7f21abe67.png"><br><br>  This leads to the generation of the next traffic in Chrome. <br><br><img src="https://habrastorage.org/files/e05/200/79b/e0520079b0024f568e8cbb9df26eac48.png"><br><br>  Another attacker hides his scripts using AngularJS, a special JavaScript framework.  They use its plugins to encrypt and display a fake webpage.  The authors have developed their own plugin, which specializes in downloading configuration files based on their assumption of a router, key exchange, decryption of the configuration and its execution. <br><br>  Below is a portion of the source code for AngularJS. <br><br><img src="https://habrastorage.org/files/e37/699/df2/e37699df22f348af9e1b6c76c50bfcc9.png"><br><br>  In the screenshot of the interaction below, the <i>GET / api / lockLinkss request</i> is responsible for loading the configuration file. <br><br><img src="https://habrastorage.org/files/a67/eec/7fb/a67eec7fb0e54a49bc46ca52b3146872.png"><br><br>  Below is a part of the decrypted configuration file. <br><br><img src="https://habrastorage.org/files/236/0da/81a/2360da81a13a4cd7bd07d63be0b6017a.png"><br><br>  Since September, the daily number of victims of such attacks has reached a figure of 1,800, with most of them falling on Brazil.  Much of these DNS addresses were active.  However, some of them did not work at all, or displayed a standard welcome web page.  Despite the fact that it is difficult to find exactly those web pages that the attackers tried to use for the substitution, we managed to find them. <br><br>  In the case of a DNS broadcast at the following addresses, the following web pages are replaced. <br><br><blockquote>  banco.bradesco <br>  142.4.201.184 <br>  166.62.39.18 <br>  167.114.109.18 <br>  167.114.7.109 <br>  185.125.4.181 <br>  185.125.4.196 <br>  185.125.4.244 <br>  185.125.4.249 <br>  185.125.4.250 <br>  185.125.4.251 <br>  216.245.222.105 <br>  45.62.205.34 <br>  63.143.36.91 <br>  64.71.75.140 <br>  74.63.196.126 <br>  74.63.251.102 <br><br>  santander.com.br <br>  158.69.213.186 <br><br>  linkedin.com <br>  198.23.201.234 </blockquote><br>  Below is a screenshot of the original banco.bradesco website, which was taken 2016-08-31. <br><br><img src="https://habrastorage.org/files/844/cc1/0df/844cc10df3ce42d181cf60f6d1910ba0.png"><br><br>  In the case of using the above DNS, the banco.bradesco web page was replaced with one PNG image, with only the username and password fields left working. <br><br><img src="https://habrastorage.org/files/d81/ade/e69/d81adee692144b71bed7fe45f95b1406.png"><br><br>  Below is a screenshot of a phishing webpage as of 2016/06/30 (DNS 142.4.201.184). <br><br><img src="https://habrastorage.org/files/da3/9f7/87b/da39f787bdf944f288d0fb9c44dcefce.png"><br><br>  Another phishing site resembles its legitimate version quite truthfully.  The IP address 23.3.13.59 is the legitimate IP address of the bank.  The real site ‚Äú <a href="http://www.banco.bradesco.com.br/">www.banco.bradesco.com.br</a> ‚Äù is redirected to ‚Äúbanco.bradesco‚Äù, which also belongs to the bank, but its IP belongs to the attackers. <br><br><img src="https://habrastorage.org/files/e14/f3d/1dc/e14f3d1dcabd4444a2163460d61f3322.png"><br><br>  Below is a screenshot of this phishing web page as of 2016-08-31 (DNS 185.125.4.181).  Also note that there is no favicon.ico, and the ‚Äúremember me‚Äù checkbox and the ‚ÄúOK‚Äù button are swapped. <br><br><img src="https://habrastorage.org/files/f93/468/a48/f93468a48bdb420182067c2aa7dca540.png"><br><br><h3>  Conclusion </h3><br>  Regardless of what purpose the attackers pursue by compromising the router, i.e., are they interested in setting up a simple phishing or backdoor to control the router, there‚Äôs only one meaning and it is to use weak account passwords to access the router.  In addition, attackers can use existing multiple vulnerable types of routers.  Such vulnerabilities are described by the following links <a href="http://routersecurity.org/bugs.php">here</a> and <a href="https://www.exploit-db.com/">here</a> .  However, the most common goal of attackers in the compromise of routers remains the possibility of replacing the DNS. <br><br>  Security routers is becoming increasingly important and the organization of phishing attackers is not the only reason for this.  Having access to the router, attackers can successfully enter the home network and check it for the presence of other connected devices there.  From smart TVs Smart TV to home control systems and smart refrigerators.  There are many IoT devices that can be connected to the router and enter the home network. <br><br>  In addition, the IoT devices themselves may also be vulnerable due to established known or weak passwords.  The user may forget to change the password, or set a weak password on the device, putting the device at additional risk. <br><br><h3>  Recommendations </h3><br>  The following guidelines will help you avoid falling victim to such attacks. <br><br><ul><li>  Change your standard router password to a more secure one. </li><li>  Check the following router settings: for the DNS settings page, the optimal choice is 8.8.8.8 or 8.8.4.4, otherwise you should contact your provider for the value;  disable the remote control setting of the router. </li><li>  Check for an update for the firmware of your router. </li><li>  Try searching for information about the model of your router and the vulnerabilities present in it. </li><li>  Contact your provider to upgrade the router firmware or to replace it. </li><li>  Use the NoScript script blocking plugin with the ABE (Application Boundary Enforcer) feature enabled in your web browser. </li><li>  Regularly check your router for the presence of vulnerabilities in it. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/313760/">https://habr.com/ru/post/313760/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../313746/index.html">Busfor's start-up startup has raised $ 20 million in investment</a></li>
<li><a href="../313750/index.html">The most popular network for supercomputers or Why did we choose InfiniBand?</a></li>
<li><a href="../313752/index.html">Video description of SalesForce CRM. Subtitles in Russian</a></li>
<li><a href="../313754/index.html">Required RMM monitors: how to detect incidents before they become problems in the IT network</a></li>
<li><a href="../313756/index.html">Do developers want to work in startups and be their founders - infographics on the results of the survey</a></li>
<li><a href="../313762/index.html">Security in IoT: Azure IoT Suite for those who start from scratch</a></li>
<li><a href="../313764/index.html">Django User Model Extension Strategies</a></li>
<li><a href="../313768/index.html">Adobe has released an emergency update for Flash Player.</a></li>
<li><a href="../313770/index.html">DocFactor: technical documentation conference</a></li>
<li><a href="../313772/index.html">Application development for KolibriOS. Overview of options</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>