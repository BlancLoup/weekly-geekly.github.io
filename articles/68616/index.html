<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating an installer using WiX</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For starters, what is WiX? WiX technology (Windows Installer XML) is a set of tools and specifications that simplify the process of creating distribut...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating an installer using WiX</h1><div class="post__text post__text-html js-mediator-article">  For starters, what is WiX?  WiX technology (Windows Installer XML) is a set of tools and specifications that simplify the process of creating distributions based on MSI (Microsoft Installer).  If it is easier to explain, this is a wrapper around MSI with a human face. <br><br>  In my opinion, the easiest way to learn is through simple examples.  In this article I will give an example of the simplest installer. <br><a name="habracut"></a><br><br>  To begin with, we set the conditions of the problem - it is necessary to create an installation distribution kit, which will contain the following dialogs: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Greeting</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/235/161/4c7/2351614c765488af64e7ec4a47be5408.png" width="499" height="392"><br><br>  <b>License agreement</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/338/71b/27a/33871b27a0407ab656a85a6326016c55.png" width="499" height="392"><br><br>  <b>Directory selection</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/257/fa5/be6/257fa5be6bc16ffae65026592607aeef.png" width="499" height="392"><br><br>  <b>Installation start</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f07/31e/c2c/f0731ec2c1cbf54e6125b2ad67e270a4.png" width="499" height="392"><br><br>  To create a distribution we need WiX itself, the latest version of which can always be downloaded at <a href="http://wix.sourceforge.net/releases/">Source Forge</a> .  At the moment the latest version is 3.5.0828.0. <br><br>  It is necessary to download and install: <br>  1. <a href="">ProjectAggregator2.msi</a> - is needed in order to install Votive (located inside distribution kit number 2).  Which, in turn, is an add-on for Visual Studio that facilitates the process of working with WiX (syntax highlighting, IntelliSense). <br>  2. <a href="">Wix35.msi</a> or <a href="">Wix35_x64.msi</a> (depending on the platform) <br>  3. <a href="">Russian language file</a> <br><br>  So, downloaded, installed, run Visual Studio.  File menu -&gt; New Project, if everything is installed correctly - a new section Windows Installer XML has appeared.  Select the project Project Setup Project, enter the name of the project (I left as it is SetupProject1). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f8f/684/711/f8f68471122b792f78dadc9653f994a2.png" width="500" height="345"><br><br>  The project will consist of a single Product.wxs file with which we will work.  In my case, the file looked like this: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Wix</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/wix/2006/wi"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Product</font> <font color="#ff0000">Id</font> <font color="#0000ff">="b7bc7c6f-9a4e-4973-be84-eca8e3427c97"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="SetupProject1"</font> <font color="#ff0000">Language</font> <font color="#0000ff">="1033"</font> <font color="#ff0000">Version</font> <font color="#0000ff">="1.0.0.0"</font> <font color="#ff0000">Manufacturer</font> <font color="#0000ff">="SetupProject1"</font> <font color="#ff0000">UpgradeCode</font> <font color="#0000ff">="06a81104-1e30-463d-87e1-e8a79b4c682a"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Package</font> <font color="#ff0000">InstallerVersion</font> <font color="#0000ff">="200"</font> <font color="#ff0000">Compressed</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Media</font> <font color="#ff0000">Id</font> <font color="#0000ff">="1"</font> <font color="#ff0000">Cabinet</font> <font color="#0000ff">="media1.cab"</font> <font color="#ff0000">EmbedCab</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="TARGETDIR"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="SourceDir"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProgramFilesFolder"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="SetupProject1"</font> <font color="#0000ff">&gt;</font> <br> <font>&lt;!-- TODO: Remove the comments around this Component element and the ComponentRef below in order to add resources to this installer. --&gt;</font> <br> <font>&lt;!-- &lt;Component Id="ProductComponent" Guid="b11556a2-e066-4393-af5c-9c9210187eb2"&gt; --&gt;</font> <br> <font>&lt;!-- TODO: Insert files, registry keys, and other resources here. --&gt;</font> <br> <font>&lt;!-- &lt;/Component&gt; --&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Directory</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Directory</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Directory</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProductFeature"</font> <font color="#ff0000">Title</font> <font color="#0000ff">="SetupProject1"</font> <font color="#ff0000">Level</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> <font>&lt;!-- TODO: Remove the comments around this ComponentRef element and the Component above in order to add resources to this installer. --&gt;</font> <br> <font>&lt;!-- &lt;ComponentRef Id="ProductComponent" /&gt; --&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Product</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Wix</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  <b>To begin with we will adjust appearance and we will add support of Russian.</b> <br><br>  Let's start with the addition of the Russian language.  For this: <br>  1. In the Product key, change 1033 to 1049 <br>  2. In the project properties ( <i>right-click on the project name in Solution Explorer -&gt; Properties</i> ), the Build tab, insert ru-RU into the Cultures to build field <br>  3. Add to the project ( <i>right-click on the project name in Solution Explorer -&gt; Add -&gt; Existing Item</i> ) the file WixUI_ru-ru.wxl (from the archive WixUI_ru-ru.v3.zip) <br><br>  There is no dialog box in the generated project.  There are two options for adding dialogs - create them yourself, or use a ready-made set of dialog boxes. <br><br>  We will go the second way, to begin acquaintance better with a simple one.  To do this, add a link to WixUIExtension.dll ( <i>right-</i> click on <i>the project name in Solution Explorer -&gt; Add Reference - open the folder where WiX was installed, bin subdirectory</i> ) <br><br>  The link was added, we specify which set we will use, at the end of the Product section we add <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Property</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WIXUI_INSTALLDIR"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">Property</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">WixVariable</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WixUILicenseRtf"</font> <font color="#ff0000">Overridable</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="License.rtf"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">UIRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WixUI_InstallDir"</font> <font color="#0000ff">/&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  <b>WixVariable Id = ‚ÄúWixUILicenseRtf</b> ‚Äù - points to the path to the license file (it wasn‚Äôt a question of it yet, added at once so that it wouldn‚Äôt be walked twice). <br>  <b>WixUI_InstallDir</b> is a ready-made set of dialog boxes.  This kit includes all the dialogs we need.  In addition to it, there are also sets of WixUI_Advanced, WixUI_Mondo, WixUI_FeatureTree, WixUI_InstallDir, WixUI_Minimal. <br><br>  Preparations are finished, you can start editing the installation file.  For a start, let's see what the studio nagenerila: <br><br>  <b>Product key</b> - describes the properties of the product. <br>  <b>Id</b> - product identifier, unique GUID. <br>  <b>Name</b> - product name <br>  <b>Language</b> - installation package language <br>  <b>Version</b> - product version <br>  <b>Manufacturer</b> - the manufacturer <br>  <b>UpgradeCode</b> - Unique GUID <br><br>  To simplify your life, we define some variables.  For what - the name of the product, for example, may occur more than once in the script, if we want to change it, we will have to look for it throughout the script and change it to a new one.  To avoid this, we define a variable that will contain the name of the product and, if necessary, we will only change it.  Above the <b>Product</b> section add: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">define</font> <font color="#ff0000">ProductName</font> <font color="#0000ff">="SetupProject1"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;?</font> <font color="#800000">define</font> <font color="#ff0000">ProductVersion</font> <font color="#0000ff">="1.0.0.0"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;?</font> <font color="#800000">define</font> <font color="#ff0000">ProductCode</font> <font color="#0000ff">="b7bc7c6f-9a4e-4973-be84-eca8e3427c97"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;?</font> <font color="#800000">define</font> <font color="#ff0000">UpgradeCode</font> <font color="#0000ff">="06a81104-1e30-463d-87e1-e8a79b4c682a"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;?</font> <font color="#800000">define</font> <font color="#ff0000">Manufacturer</font> <font color="#0000ff">="MyCompany"</font> ? <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now let's replace the value of the <b>Product</b> key parameters with variables: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Product</font> <font color="#ff0000">Id</font> <font color="#0000ff">="$(var.ProductCode)"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="$(var.ProductName)"</font> <font color="#ff0000">Language</font> <font color="#0000ff">="1049"</font> <font color="#ff0000">Version</font> <font color="#0000ff">="$(var.ProductVersion)"</font> <font color="#ff0000">Manufacturer</font> <font color="#0000ff">="$(var.Manufacturer)"</font> <font color="#ff0000">UpgradeCode</font> <font color="#0000ff">="$(var.UpgradeCode)"</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now we decide on where we will install our product. <br><br>  <b>Directory key</b> - determines the path for installation. <br>  <b>Directory Id = "TARGETDIR" is the</b> root element for all folders that will be used to install the project. <br>  <b>Directory Id = "ProgramFilesFolder"</b> folder Program Files (as indicated by Id = "ProgramFilesFolder"). <br>  <b>Directory Id = "INSTALLLOCATION"</b> folder named SetupProject1 in the Program Files folder.  Immediately replace Name = "SetupProject1" with Name = "$ (var.ProductName)" <br><br>  Add files to the installation package.  To do this, first add the installable components.  Following the advice ‚ÄúRemove the comments around this Component‚Äù, remove the comments from the Component inside the target folder and add, for example, a calculator. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProductComponent"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="b11556a2-e066-4393-af5c-9c9210187eb2"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">File</font> <font color="#ff0000">Id</font> <font color="#0000ff">='Calc'</font> <font color="#ff0000">DiskId</font> <font color="#0000ff">='1'</font> <font color="#ff0000">Source</font> <font color="#0000ff">='C:\WINDOWS\system32\calc.exe'</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Installing a component is impossible without including it in one of the Feature (to <i>be honest, not sure how in this case you can translate this term into Russian</i> ).  This element can be used when we need to give the user a choice of what to install and what not.  In the context of our task, nothing was said about the possibility of choice, but despite this we need to bind the described Component to a single Feature: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProductFeature"</font> <font color="#ff0000">Title</font> <font color="#0000ff">="$(var.ProductName)"</font> <font color="#ff0000">Level</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProductComponent"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  It remains to add a shortcut to the Start menu. <br><br>  First, we indicate that we are going to work with the Start menu folder and want to create a folder with the name of our program containing a shortcut to the calculator. <br><br>  In the Directory Id = "TARGETDIR" section, somewhere at the end we add: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProgramMenuFolder"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ApplicationProgramsFolder"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="$(var.ProductName)"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ApplicationShortcutCalc"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="4CEBD68F-E933-47f9-B02C-A4FC69FDB551"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Shortcut</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutCalc"</font> <br> <font color="#ff0000">Name</font> <font color="#0000ff">="Calc"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="$(var.ProductName)"</font> <br> <font color="#ff0000">Target</font> <font color="#0000ff">="[INSTALLLOCATION]Calc.exe"</font> <br> <font color="#ff0000">WorkingDirectory</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RemoveFolder</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ApplicationProgramsFolder"</font> <font color="#ff0000">On</font> <font color="#0000ff">="uninstall"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RegistryValue</font> <font color="#ff0000">Root</font> <font color="#0000ff">="HKCU"</font> <font color="#ff0000">Key</font> <font color="#0000ff">="Software\$(var.Manufacturer)\$(var.ProductName)"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="installed"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="1"</font> <font color="#ff0000">KeyPath</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Directory</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Directory</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  We start to understand: <br>  <b>Directory Id = ‚ÄúProgramMenuFolder‚Äù</b> - points to the directory that contains the Start menu shortcuts. <br>  <b>Directory Id = "ApplicationProgramsFolder"</b> - a folder of our program in the Start menu <br>  <b>Component</b> - the component that contains the shortcut (remember to include it in the Feature) <br>  <b>Shortcut</b> - actually a shortcut to the calculator <br><br>  The final version of the file should look like this: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Wix</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/wix/2006/wi"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;?</font> <font color="#800000">define</font> <font color="#ff0000">ProductName</font> <font color="#0000ff">="SetupProject1"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;?</font> <font color="#800000">define</font> <font color="#ff0000">ProductVersion</font> <font color="#0000ff">="1.0.0.0"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;?</font> <font color="#800000">define</font> <font color="#ff0000">ProductCode</font> <font color="#0000ff">="b7bc7c6f-9a4e-4973-be84-eca8e3427c97"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;?</font> <font color="#800000">define</font> <font color="#ff0000">UpgradeCode</font> <font color="#0000ff">="06a81104-1e30-463d-87e1-e8a79b4c682a"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;?</font> <font color="#800000">define</font> <font color="#ff0000">Manufacturer</font> <font color="#0000ff">="MyCompany"</font> ? <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Product</font> <font color="#ff0000">Id</font> <font color="#0000ff">="$(var.ProductCode)"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="$(var.ProductName)"</font> <font color="#ff0000">Language</font> <font color="#0000ff">="1049"</font> <font color="#ff0000">Version</font> <font color="#0000ff">="$(var.ProductVersion)"</font> <font color="#ff0000">Manufacturer</font> <font color="#0000ff">="$(var.Manufacturer)"</font> <font color="#ff0000">UpgradeCode</font> <font color="#0000ff">="$(var.UpgradeCode)"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Package</font> <font color="#ff0000">InstallerVersion</font> <font color="#0000ff">="200"</font> <font color="#ff0000">Compressed</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Media</font> <font color="#ff0000">Id</font> <font color="#0000ff">="1"</font> <font color="#ff0000">Cabinet</font> <font color="#0000ff">="media1.cab"</font> <font color="#ff0000">EmbedCab</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="TARGETDIR"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="SourceDir"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProgramFilesFolder"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="$(var.ProductName)"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProductComponent"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="b11556a2-e066-4393-af5c-9c9210187eb2"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">File</font> <font color="#ff0000">Id</font> <font color="#0000ff">='Calc'</font> <font color="#ff0000">DiskId</font> <font color="#0000ff">='1'</font> <font color="#ff0000">Source</font> <font color="#0000ff">='C:\WINDOWS\system32\calc.exe'</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Directory</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Directory</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProgramMenuFolder"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Directory</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ApplicationProgramsFolder"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="$(var.ProductName)"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Component</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ApplicationShortcutCalc"</font> <font color="#ff0000">Guid</font> <font color="#0000ff">="4CEBD68F-E933-47f9-B02C-A4FC69FDB551"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Shortcut</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ShortcutCalc"</font> <br> <font color="#ff0000">Name</font> <font color="#0000ff">="Calc"</font> <br> <font color="#ff0000">Description</font> <font color="#0000ff">="$(var.ProductName)"</font> <br> <font color="#ff0000">Target</font> <font color="#0000ff">="[INSTALLLOCATION]Calc.exe"</font> <br> <font color="#ff0000">WorkingDirectory</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RemoveFolder</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ApplicationProgramsFolder"</font> <font color="#ff0000">On</font> <font color="#0000ff">="uninstall"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">RegistryValue</font> <font color="#ff0000">Root</font> <font color="#0000ff">="HKCU"</font> <font color="#ff0000">Key</font> <font color="#0000ff">="Software\$(var.Manufacturer)\$(var.ProductName)"</font> <font color="#ff0000">Name</font> <font color="#0000ff">="installed"</font> <font color="#ff0000">Type</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="1"</font> <font color="#ff0000">KeyPath</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Component</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Directory</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Directory</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Directory</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Feature</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProductFeature"</font> <font color="#ff0000">Title</font> <font color="#0000ff">="SetupProject1"</font> <font color="#ff0000">Level</font> <font color="#0000ff">="1"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ProductComponent"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ComponentRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="ApplicationShortcutCalc"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Feature</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Property</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WIXUI_INSTALLDIR"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="INSTALLLOCATION"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">Property</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">WixVariable</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WixUILicenseRtf"</font> <font color="#ff0000">Overridable</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">Value</font> <font color="#0000ff">="License.rtf"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">UIRef</font> <font color="#ff0000">Id</font> <font color="#0000ff">="WixUI_InstallDir"</font> <font color="#0000ff">/&gt;</font> <br> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Product</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Wix</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  We do Build, we start, we check result. <br><br>  Where to read <br>  <a href="http://wix.sourceforge.net/">Project page</a> <br>  <a href="http://blogs.technet.com/alexshev/default.aspx">Alex Shevchuk: From MSI to WiX</a> (mostly in English, but there is some in Russian) <br>  <a href="http://www.tramontana.co.hu/wix/">WiX Tutorial</a> <br>  <a href="http://www.wixwiki.com/">wixwiki</a> <br><br>  Continued <a href="http://habrahabr.ru/blogs/development/69129/">Part 2 - Fragments and Includes</a> </div><p>Source: <a href="https://habr.com/ru/post/68616/">https://habr.com/ru/post/68616/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../68598/index.html">Invites to Peers.FM and Animuxia</a></li>
<li><a href="../68602/index.html">Nokia 5800 and N97 tricks</a></li>
<li><a href="../68608/index.html">10 tricks to work with YouTube</a></li>
<li><a href="../68613/index.html">Using P / Invoke: hiding the Start button and the taskbar in Windows</a></li>
<li><a href="../68615/index.html">More about syncing Windows Mobile with Evolution</a></li>
<li><a href="../68617/index.html">Software RAID1 (mirroring) on ‚Äã‚ÄãXenServer 5.5</a></li>
<li><a href="../68618/index.html">Clone Twitter from Yahoo !: Yahoo Meme</a></li>
<li><a href="../68619/index.html">AMD six-core dragon in 2010</a></li>
<li><a href="../68620/index.html">Looking for a book</a></li>
<li><a href="../68621/index.html">JSON vs. XML and a bit of refactoring</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>