<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Device and operation of input / output ports of AVR microcontrollers. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Work I / O ports 

 After reviewing this material, in which everything is described in great detail and in detail with many examples, you can easily m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Device and operation of input / output ports of AVR microcontrollers. Part 1</h1><div class="post__text post__text-html js-mediator-article">  <b>Work I / O ports</b> <br><br>  After reviewing this material, in which everything is described in great detail and in detail with many examples, you can easily master and program the input / output ports of AVR microcontrollers. <br><br><ul><li>  <a href="http://habrahabr.ru/post/253213/">Part 1. Work I / O ports</a> </li><li>  <a href="http://habrahabr.ru/post/253961/">Part 2. Connecting the LED to the line I / O port</a> </li><li>  <a href="http://habrahabr.ru/post/255715/">Part 3. Connecting the transistor to the I / O port line</a> </li><li>  <a href="http://habrahabr.ru/post/256269/">Part 4. Connecting a button to the I / O port line</a> </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      An example will be considered on an <i><b>ATMega8</b></i> microcontroller. <br><br>  We will write the program in <i><b>Atmel Studio 6.0</b></i> . <br><br>  We will emulate the circuit in <i><b>Proteus 7 Professional</b></i> . <br><br>  The microcontroller communicates with the outside world through the input / output ports.  The scheme of the input / output port is indicated in the datasheet <br><br><img src="https://habrastorage.org/files/6cd/82c/f36/6cd82cf3698b4c8da82c2551cade1f01.png" alt="image"><br><br>  But for a beginner, it's pretty difficult to figure out the scheme.  Therefore, we simplify the scheme: <br><br><img src="https://habrastorage.org/files/cbb/0d2/38e/cbb0d238e34243aa978df2a5000863fe.png" alt="image"><br><br>  <b>Pxn</b> is the port name of the microcontroller, where x is the letter of the port (A, B, C or D), n is the number of the port's discharge (7 ... 0). <br>  <b>Cpin</b> - stray port capacity. <br>  <b>VCC</b> - supply voltage. <br>  <b>Rpu</b> - disconnectable load resistor (pull-up). <br>  <b>PORTxn</b> - bit n register PORTx. <br>  <b>PINxn</b> is the n-bit of the PINx register. <br>  <b>DDRxn</b> is the n register bit of the DDRx. <br><a name="habracut"></a><br>  Consider what is the output of the microcontroller.  At the input of the microcontroller there is a small protection of two diodes <u><i><b>(see 1)</b></i></u> , it is designed to protect the input of the microcontroller from short-term voltage pulses exceeding the supply voltage.  If the voltage is higher than the power supply, the upper diode will open and this voltage will be bled to the power bus, where the power supply and its filters will already fight with it.  If the input gets negative (below zero) voltage, it will be neutralized through the lower diode and extinguished to the ground.  However, the diodes are frail there and this protection only helps against microscopic pulses and interference.  If the voltage on the microcontroller‚Äôs foot is 6-7 volts with 5 volts of power, then the internal diodes will not save it. <br><br>  A capacitor <u><i><b>(see 2)</b></i></u> is a parasitic output capacitance.  Although she is tiny, but present.  Usually it does not take into account, but it is.  Don't bother with your head, just know it. <br><br>  Next are the keys of management <u><i><b>(cm.3,4)</b></i></u> .  Each key is subject to a logical condition, which are drawn in the figure.  When the condition is satisfied - the key is closed. <br><br>  Each AVR microcontroller port (usually named A, B, and sometimes C or even D) has 8 bits, each of which is tied to a particular leg of the case.  Each port has three special registers <b>DDRx</b> , <b>PORTx</b> and <b>PINx</b> (where x corresponds to the letter of port A, B, C or D).  Register purpose: <br><br>  <b>DDRx</b> ‚Äî Configure the bits of port x for input or output. <br><br>  <b>PORTx</b> - Controls the status of the outputs of port x (if the corresponding discharge is configured as an output), or by connecting an internal pull-up resistor (if the corresponding discharge is configured as an input). <br><br>  <b>PINx</b> - <b>Reads the</b> logical levels of the bits of port x. <br><br>  <b>PINx</b> is a read register.  From it you can only read.  The <b>PINxn</b> register contains information about the actual current logic level on the port pins.  Regardless of the port settings.  So if we want to find out what we have at the input - we read the corresponding bit of the <b>PINxn</b> register.  Moreover, there are two borders: the boundary of the guaranteed zero and the boundary of the guaranteed unit - the thresholds beyond which we can clearly define the current logic level.  For a five-volt power supply, this is 1.4 and 1.8 volts, respectively.  That is, when the voltage drops from the maximum to the minimum, the bit in the <b>PINx</b> register switches from 1 to 0 only when the voltage drops below 1.4 volts, but when the voltage rises from minimum to maximum, switching the bit from 0 to 1 will only happen when the voltage reaches 1.8 volts.  That is, there is a switching hysteresis from 0 to 1, which eliminates the chaotic switch under the action of noise and interference, and also eliminates the erroneous reading of the logic level between the switching thresholds. <br><br>  By reducing the supply voltage, of course, these thresholds are also reduced. <br><br>  <b>DDRxn</b> is the port direction register.  A port at a specific point in time can be either an input or an output (but this does not matter for the state of the PINxn bits. <b>You</b> can always <b>read the</b> real value from <b>PINxn</b> ). <br><br>  <i>DDRxy</i> = 0 - output works as INPUT. <br><br>  <i>DDRxy</i> = 1 - the output works on the OUTPUT. <br><br>  <b>PORTxn</b> - output state control mode.  When we set up the output to the input, then the type of input depends on <b>PORTx</b> (Hi-Z or PullUp, more on that below). <br><br>  When the foot is set to output, the value of the corresponding bit in the <b>PORTx</b> register determines the status of the output.  If <b>PORTxn</b> = 1 then on pin log.1, if <b>PORTxn</b> = 0 then on pin log.0. <br><br>  When the foot is tuned to the input, then if <b>PORTxn</b> = 0, then the output is in Hi-Z mode.  If <b>PORTxn</b> = 1 then the output in PullUp mode with a 100k pull-up resistor to the power supply. <br><br>  Table.  Configuration of port pins. <br><br>  DDRxn PORTxn I / O Comment <br>  0 0 I (Input) Input High-impedance input.  (I do not recommend to use, as they may be induced power supply) <br>  0 1 I (Input) Input Tightened internal resistance. <br>  1 0 O (Output) Output The output is low. <br>  1 1 O (Output) Output The output is high. <br><br>  The overall picture of the port is shown in the figures: <br><br><img src="https://habrastorage.org/files/99c/d14/163/99cd141635d54c04b7390f9f956de2b7.png" alt="image"><br><br>  Fig.  <b>DDRxn</b> = 0 <b>PORTxn</b> = 0 - Mode: <b>HI-Z</b> - high impedance input. <br><br><img src="https://habrastorage.org/files/f62/ba0/b2c/f62ba0b2c8da4483beb4ff9f5bdc8d67.png" alt="image"><br><br>  Fig.  <b>DDRxn</b> = 0 <b>PORTxn</b> = 1 - Mode: <b>PullUp</b> - input with pull-up to log.1. <br><br><img src="https://habrastorage.org/files/2be/b29/481/2beb29481ea94f8aa274f0fe7316041d.png" alt="image"><br><br>  Fig.  <b>DDRxn</b> = 1 <b>PORTxn</b> = 0 - Mode: <b>Output</b> - output log.0.  (almost GND) <br><br><img src="https://habrastorage.org/files/612/133/e71/612133e71ba44707bcac798a24884798.png" alt="image"><br><br>  Fig.  <b>DDRxn</b> = 1 <b>PORTxn</b> = 1 - Mode: <b>Output</b> - output log.1.  (almost VCC) <br><br>  <i><b>Hi-Z</b> input - high-impedance input mode.</i> <br>  This mode is enabled by default.  All keys are open and port resistance is very high.  In principle, compared to other modes, it can be considered infinity.  That is, the electrically output is not connected anywhere at all and does not affect anything.  But!  At the same time, he constantly reads his state into the <b>PINn</b> register and we can always find out what we have at the entrance - one or zero.  This mode is good for listening to any data bus, because  It has no effect on the tire.  And what will happen if the entrance is hanging in the air?  And in this case, the voltage will jump on it depending on external interference, electromagnetic interference and, in general, on the phase of the moon and the weather on Mars (an ideal way to chop random numbers!).  In this case, the unstable sine of 50 Hz is very often on the port - pickup from the 220V network, and in the <b>PINn</b> register 0 and 1 will change with a frequency of about 50 Hz <br><br>  <i>Input <b>PullUp</b> - input with a pull.</i> <br>  With <b>DDRxn</b> = 0 and <b>PORTxn</b> = 1, the lift key closes and a <b>100kŒ©</b> resistor is connected to the line, which instantly brings the line not connected anywhere to the log.1 state.  The purpose of the suspenders is obvious - to prevent chaotic changes in the state at the entrance under the influence of interference.  But if a logical zero appears at the input (short circuit of the line to earth with a button or another microcontroller / microcircuit), then a weak 100kOhm resistor will not be able to hold the line voltage at log.1 and the input will be log.0. <br><br>  <i>Exit mode</i> <br>  Here, I think everything is clear - if we need to output log.1 to the port, we turn on the output port ( <b>DDRxn</b> = 1) and issue log.1 ( <b>PORTxn</b> = 1) - this closes the upper key and a voltage appears at the output close to nutrition.  And if log.0 is needed, then we turn on the output port ( <b>DDRxn</b> = 1) and issue log.0 ( <b>PORTxn</b> = 1) - this opens the lower gate, which gives about zero volts at the output. </div><p>Source: <a href="https://habr.com/ru/post/253213/">https://habr.com/ru/post/253213/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253199/index.html">QIWI terminals. Alternative way</a></li>
<li><a href="../253201/index.html">Unloading the conditions of public procurement contests with the EP. Zakupki.gov.ru</a></li>
<li><a href="../253207/index.html">Simple PHP complex HTML table generator</a></li>
<li><a href="../253209/index.html">Bash Booster - SCM tool on a clean bash</a></li>
<li><a href="../253211/index.html">Why I don‚Äôt dislike Git: hidden integrity</a></li>
<li><a href="../253217/index.html">Meet Envoyer.io (Part 1)</a></li>
<li><a href="../253223/index.html">Charting and graphing with Doxygen</a></li>
<li><a href="../253225/index.html">MailChimp UX Team: Design [Part 4 of the Book]</a></li>
<li><a href="../253227/index.html">Deep Learning, NLP, and Representations</a></li>
<li><a href="../253229/index.html">Weekly assembly Vivaldi 1.0.129.2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>