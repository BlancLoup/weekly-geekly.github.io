<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Once again about dial gauges (and completely without MK)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 
 I immediately liked the article about the switch indication of CPU and memory usage. Sometimes you need to see how much free memory is left, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Once again about dial gauges (and completely without MK)</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br>  I immediately liked the <a href="http://habrahabr.ru/post/206150/">article</a> about the switch indication of CPU and memory usage.  Sometimes you need to see how much free memory is left, launching the third or fourth instance of a heavy program / game (I don‚Äôt want to bring it to the situation, the code of the previous instances will be swapped).  Or with processor loading - I used to think that modern Crysis, Call of Duty, Mass Effect, etc.  ship and video card, and percent.  Now I know that even when the picture slows down - the percent is loaded no more than 30-40%.  Well, or on the move to assess whether all the kernel uses rendering.  <b>And what a pleasure the eye gives jerky arrows.</b> <br>  The second <a href="http://habrahabr.ru/post/206392/">realization,</a> though just as obvious, is not sunk into the soul ‚Äî there is no such spectacle. <br>  So I decided - someday I will certainly repeat with the arrows. <br>  The only problem, because of which I did not do it right away, is <s>laziness, the</s> absence of indicators, of course.  And so, sorting out the old-old stuff in the old-old cupboard, I found THEM. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2c5/5d5/8bc/2c55d58bc53a910b8bf469754b8af527.jpg"><br><a name="habracut"></a><br>  Just two dial gauges from an old reel tape recorder.  Oh, how many times he rewound the reels with Cinema and Modern Talking. <br><br>  So, in order for the idea to work, we needed: <br><ul><li>  beautiful indicators with a suitable scale; </li><li>  hardware for connecting indicators to a computer; </li><li>  program for output memory load and processor. </li></ul><br>  When the tasks are clear - and easier to work. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Beautiful indicators </h5><br>  Heads turned out to be filled with glue from the heart, but he could not stand under the usual stationery knife.  He divided it in half, took out the old scale, drew in size and printed out a new one.  Assembled in reverse order. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f4b/0b7/6a7/f4b0b76a77bb28196f2c3dbc253f8721.jpg"><br><br>  After writing the article I looked at the photos and disassembled them again.  He took from the wife a red nail polish and painted arrows.  It turned out more noticeable - it can be seen on the video. <br><br><h5>  Hardware </h5><br>  Here I didn‚Äôt subtilize with the controllers.  There is a LPT on mamma, he is hardly useful for me for some other purposes, so there is nothing for him to stand idle. <br>  LPT is 8 bits, 4 bits per channel, 16 positions of the arrow - I was completely satisfied.  The simplest DAC - resistors and diodes, we draw for two channels (aesthetes, sorry for ISIS): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bb2/3a2/d10/bb23a2d109d201500a1eacdb88e285e0.png"><br><br>  I neglected the accuracy of resistors, gash what happens in nature (10, 20, 39, 82 kOhm).  As usual, we solder the layout: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d0d/0ae/f69/d0d0aef6959b0c6185dbb547791d64c9.jpg"><br><br>  and check in work.  Calibration consists in setting the arrows by trimmers to the maximum scale division when transmitting the value of 255 to the port. With iron everything is. <br><br><h5>  Program </h5><br>  It turned out to be the most difficult to find a driver for working with LPT (Win 8 x64).  After several hours of searching, I finally found 32-bit DLPortIO (driver + library), but with installation instructions for 64-bit systems.  The link, unfortunately, has already been lost, just kept it on <a href="http://yadi.sk/d/a3pfnLMKKYFcv">Yandex.Disk</a> . <br>  Further - easier.  Half an hour later, the Delphi program (the only thing that I somehow remember from my studies) was written: <br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text"><pre><code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TForm1</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Timer1Timer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> MemStatus.dwLength := sizeof( TMemoryStatus ); GlobalMemoryStatus( MemStatus ); MemVal := round(<span class="hljs-number"><span class="hljs-number">15</span></span>*MemStatus.dwMemoryLoad/<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">shl</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 4  - ,  - CPU CPUUsage3:= CPUUsage2; // CPUUsage2:= CPUUsage1; // CPUUsage1:= CPUUsage; // CPUUsage := 0; CollectCPUData; for i:= 0 to GetCPUCount - 1 do begin CPUUsage:= CPUUsage + GetCPUUsage(i); end; CPUUsage:= CPUUsage / GetCPUCount; CPUUsage:= (CPUUsage + CPUUsage1 + CPUUsage2 + CPUUsage3)/4; //  CPUVal := Round(15 * CPUUsage); CPUVal := CPUVal or MemVal; DlPortWritePortUchar (888, CPUVal); end;</span></span></code> </pre> <br></div></div><br>  The RAM and CPU load values ‚Äã‚Äãare read twice a second and sent to the &amp; H378 port.  In the comments to the original article there was a question about how many resources the program is showing, showing the loading of resources.  The answer is: according to the task manager, the CPU load did not exceed 0%, but there was 956k of memory (I would have to tear my hands off: I went the simplest way, I create a form, and then it disappears. Nothing, I‚Äôll get to the optimization and fix it). <br>  Accuracy in the first half of the scale is lame, the closer to 100% - the more accurate. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e8/dd0/c46/1e8dd0c46530c23487f33788f4959707.jpg"><br><br>  The case is not and is not planned, let them lie on the monitor.  There is no backlight, but it is planned.  I think where to power.  The design is more of an aesthetic character, plus the pleasure of being made / assembled / welded personally, and this is priceless. <br>  Finally a small video: <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/WiL9NEyrYQU%3Ffeature%3Doembed&amp;xid=25657,15700023,15700186,15700190,15700253&amp;usg=ALkJrhg4zpAytVnqDLQwrBV12V3xmAqYdg" frameborder="0" allowfullscreen=""></iframe><br><br>  Thank you for your attention, and I wish you to find an arrow indicator in the cabinet. </div><p>Source: <a href="https://habr.com/ru/post/215911/">https://habr.com/ru/post/215911/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../215895/index.html">A miniature tricopter with a 1080p HD camera on a Kickstarter collected almost $ 1 million instead of 35 thousand</a></li>
<li><a href="../215901/index.html">NASA: 715 new planets found, 4 of them may be suitable for life</a></li>
<li><a href="../215905/index.html">Signed Distance Field or how to make a vector out of raster</a></li>
<li><a href="../215907/index.html">Simple strategy game 2048</a></li>
<li><a href="../215909/index.html">The Chinese lunar rover ‚ÄúYuytu‚Äù successfully ‚Äúwoke up‚Äù after the third moon night</a></li>
<li><a href="../215913/index.html">Flappy Bot for Flappy Bird</a></li>
<li><a href="../215921/index.html">Chameleon virus spreads via WiFi networks as a common cold among people</a></li>
<li><a href="../215923/index.html">OpenCV participates in Google Summer of Code 2014</a></li>
<li><a href="../215925/index.html">"A pleasant-2", or what is behind the "Faces"</a></li>
<li><a href="../215927/index.html">Popcorn Time closed due to "the threat of legal persecution and backstage fraud"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>