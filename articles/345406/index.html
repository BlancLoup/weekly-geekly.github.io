<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How and why we rethought the search input field of Yandex</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have already talked twice about our search tips: the first post came out already in 2012, the second one happened quite recently. 


  


 Search t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How and why we rethought the search input field of Yandex</h1><div class="post__text post__text-html js-mediator-article"><p>  We have already talked twice about our search tips: the <a href="https://habrahabr.ru/company/yandex/blog/160749/">first post</a> came out already in 2012, the <a href="https://habrahabr.ru/company/yandex/blog/340552/">second</a> one happened quite recently. </p><br><p> <a href="https://habrahabr.ru/company/yandex/blog/345406/"><img src="https://habrastorage.org/webt/w7/ag/mv/w7agmv_yyppod3mg66pcfgzlsv8.png"></a> </p><br><p>  Search tips - one of those things that the company can be proud of, so we do not seem shameful to talk about them often.  Today we will talk about the functional changes in search clues that occurred in 2017.  It's not just about the changes in the interface, but also about the interesting statistics and technological challenges that it has set for us. </p><br><h2 id="1-rasshiryayuscheesya-pole-vvoda">  1. ‚ÄúExpanding‚Äù input field </h2><br><p>  By the beginning of 2017, many messengers already possessed "rubber" input fields.  A person who writes a long enough text, of course, wants to be able to see if not the whole text, then at least a considerable part of it. </p><br><p>  Surprisingly, the search engines completely ignored this trend.  But long queries make up a significant part of the stream.  Say, queries containing more than seven words make up 10% of the entire flow of queries to Yandex! </p><a name="habracut"></a><br><p>  In general, query length is a very interesting feature.  The proportion of long requests is an indicator subject to pronounced seasonality caused by the educational needs of schoolchildren and students.  Therefore, on the graph of the share of long queries all holidays, weekends and summer holidays are clearly visible.  But even after deducting this effect, it is noticeable that requests are gradually becoming longer: for example, in the summer of 2017 the proportion of long requests was 20% higher compared to the summer of 2016.  The graph below shows the dynamics of changes in the share of long requests in the flow of requests to Yandex, the value corresponding to the beginning of 2016 is taken as one. </p><br><p><img src="https://habrastorage.org/webt/ly/kn/iy/lykniy83jj_1xilvpcat6mjzwbo.png"></p><br><p>  In addition to the fact that users often specify long queries, it is also important that they often change the wording of an already specified query.  We can say that the text editing script in the search line is in demand. </p><br><p>  Based on this, we really wanted to introduce the so-called.  expanding input field: a field whose size would increase in the process of entering text when this would be necessary. </p><br><p>  The idea is quite simple, but we spent about six months to bring it to production.  At first we got too excited about this idea and significantly expanded it by inventing a separate <em>page for entering a request</em> , which completely covered the current screen, contained a wide input field, full-text hints, and so on.  Fortunately, I still have one screenshot of this page, so I can demonstrate it to you: </p><br><p><img src="https://habrastorage.org/webt/4z/1l/ua/4z1luacobssydkr-bhz9_xvxt8k.png"></p><br><p>  When we turned on the display of the input page to a small number of users, it turned out that this page was not clear to them.  They stopped asking questions from the search page, tried to do it from the Yandex main page and so on.  So we had to shut down the experiment ahead of time! </p><br><p>  Such results were just another confirmation of the general rule: if you implement a simple idea, you should not change too much.  Therefore, we tried to rethink the concept and move iteratively.  The first successful solution was to implement the basic idea and at the same time differ as little as possible from the current production.  Some things, however, had to be changed: for example, the expanding input field does not correlate well with the triangular shape of the search arrow, so we needed an animation that turned the search button into a rectangular one. </p><br><p>  The result was a solution that Yandex users can now use on the results pages of a large search, image search and video search: </p><br><p><img src="https://habrastorage.org/webt/ux/yv/ok/uxyvokrb-a6kbpmzvehxjmn6boi.png"></p><br><p>  I must say that this implementation is one of the best ever implemented team in the mobile Yandex.  We managed to influence even how often users use the search engine! </p><br><h2 id="2-istoricheskie-podskazki">  2. Historical tips </h2><br><p>  Another fact of objective reality: users often ask the same requests.  If we take the queries of the median user, we will see that he sets more than half of his queries again. </p><br><p>  If so, you can simplify the input queries that were asked by this user in the past.  Let us say, to prioritize showing in queries those requests that the user has already entered. </p><br><p>  It should be noted that this idea was already implemented in desktop Yandex a long time ago: after entering the second character, a number of historical cues are shown in purple if their beginning coincides with the current input. </p><br><p><img src="https://habrastorage.org/webt/un/yi/ib/unyiibtqoq4op0__pud5qpllhxk.png"></p><br><p>  On mobile, however, this was not possible.  So we rushed to solve it, at the same time having dealt with a number of problems that are also relevant for the desktop, so that in the future we are waiting for quite significant changes related to the historical demands on the desktops. </p><br><ol><li><p>  Users do not always want their past queries to be remembered.  For example, there are secret requests.  Therefore, it is necessary to give the opportunity to turn off the query history in general, and in addition to give the opportunity to delete specific prompts. </p><br></li><li><p>  What to do with the display of historical clues in connection with the removal?  Suppose a user deleted some query - should a new, earlier one come in its place?  But then the user may need to make several hundred deletions to destroy all the necessary hints.  Maybe just to always show the last 10 tips, and not to update their list during the removal process?  But then after reloading the page, the user will see some new historical clues, and he may not be ready for this. </p><br></li><li><p>  Historical requests must be delivered and updated very quickly.  Say, right after a certain query is set, it should appear among the historical clues.  It can be said that the just specified query is not really needed, since  No one will need to set the current request again, but without it, the functionality of historical prompts will be completely incomprehensible to the user, so we have very serious requirements for the backend of personal prompts. </p><br></li><li>  It is required to understand what is the entity for which the query history is saved.  Should historical queries differ for different services, or should they coincide?  Do you need to store history for each specific browser, or should you try to store it also for logged-in users so that the query history is available on all devices? </li></ol><br><p>  In other words, the simplest idea is overgrown with a fair amount of nuances when it comes to implementation. </p><br><p>  We decided that the composition of the prompts should not change from request to request.  For example, if ten prompts were initially displayed to the user, and then he deleted five of them, then the next time he should see only the five remaining queries.  This behavior will cause the least surprise in most situations. </p><br><p>  As for the history storage, we decided that the historical cues should differ in different services, because the queries in the large search and the requests to the video service are essentially different requests.  We keep the history for logins, so that, say, a user on the desktop will have access to requests from his mobile device, if he is logged in both there and there. </p><br><p>  Now historical queries are available on all of our main search services, as well as on Yandex.Market.  Below, for example, my historical tips on Yandex.Maps and Yandex.Video are presented. </p><br><p><img src="https://habrastorage.org/webt/xi/ef/hx/xiefhxjan7xospb7jbudqqyvjpm.png"></p><br><h2 id="3-sadzhest-v-prilozheniyah-i-servisah">  3. Sajest in applications and services </h2><br><p>  In 2017, we turned our attention to Yandex applications.  It was obvious that the hints in them lagged behind the web version in its development, and this is unacceptable!  After all, users of our applications should receive the best user experience. </p><br><p>  Our main search applications are <a href="https://yandex.ru/app/">Yandex</a> . <a href="https://browser.yandex.ru/mobile//main/%3Ffrom%3Dwizard">Browser</a> and <a href="https://yandex.ru/app/">Yandex application</a> . </p><br><p>  The Yandex application could already boast word-by-word hints and some rich answers, but there was no full-text input in it.  Yandex.Browser, in turn, contained only full-text hints.  At the same time, our Browser is a unique program, because the omnibox is located in the lower part of the screen, therefore, the search hints in it should be displayed "inverted". </p><br><p>  As a result, we, together with the application development teams, managed to implement everything that was needed.  In Yandex Browser, word-by-word hints are located directly above the omnibox, which is very convenient and allows you to quickly type search queries, since  Sadzhest is located as close as possible to the keyboard, which focuses the person at the time of entry.  The Yandex application now implements an advanced from a visual point of view sadzhest.  It is to this solution that we will gradually arrive in other applications, and in the web version of Yandex. </p><br><p><img src="https://habrastorage.org/webt/sg/my/ss/sgmyss9yyf1_5ok4afgqflborgu.png"></p><br><p>  I would like to say more about the tips in the Market.  We managed to literally introduce all the best that was in the big sadget into the Market: word-by-word and full-text hints, history and crosses to remove it, and to do it both in the web version and in applications. </p><br><p><img src="https://habrastorage.org/webt/5h/zg/ip/5hzgip15b_jug1ezozgznojyi9k.png"></p><br><p>  Consistent interfaces help users: they do not need to get used to new unfamiliar mechanics.  The user experience gained in the Search is also useful when using our other services, and this is clearly seen on the metrics. </p><br><p>  At the same time, there are platforms that we cannot influence.  Say, many users enter their requests through the omnibox of mobile Chrome.  It turned out, however, <br>  that the sadzhest in Chromium can do quite a lot: pictures, special text, and so on, see the <a href="">ParseSuggestResults</a> method <a href="">in the sources</a> .  Thanks to this, it turned out to be possible to provide users of mobile Google Chrome, who chose Yandex search as the main, all the possibilities of our rich sadjest: factual answers, weather, traffic jams and so on. </p><br><p><img src="https://habrastorage.org/webt/1e/rn/gf/1erngffl012oqdrr3fou1gf_nlq.png"></p><br><p>  This is one of my favorite implementations.  It's great that the creators of Chromium provided all these possibilities!  Of course, it's a shame that now it is impossible to implement a word sadst in Chrome. </p><br><h2 id="4-fakty-v-podskazkah">  4. Facts in the tips </h2><br><p>  The ability to respond to a user request directly during its entry is fascinating.  This possibility arises when we understand the semantics of the query well.  In this regard, I would like to talk about a few interesting introductions in Video. </p><br><p>  An extremely important class of video requests - series.  We know the names of all the TV shows and understand how requests for them are arranged.  Query texts can often be divided into logical parts: the name of the series, the number next to the word "series", the number next to the word "season."  It is logical to combine such logical parts within one word-by-word hint.  If earlier on entering the ‚Äúgame of thrones‚Äù we could show the sequels ‚Äú1‚Äù, ‚Äú1 season‚Äù, ‚Äú7‚Äù and ‚Äú5‚Äù, and the numbers could relate to both the series and the seasons, now we have added more structure: </p><br><p><img src="https://habrastorage.org/webt/od/oh/hi/odohhi-f3fdgs7vza0cgvqjij2q.png"></p><br><p> Another example of understanding a request is the ability to move a user to a page that is guaranteed to contain the answer he needs.  For example, when a user enters the query "terminator", we understand that he is most likely referring to the film from 1991, and when he enters the query "terminator 3" - we are quite clearly talking about the 2003 film.  Therefore, it is possible, in addition to the actual requests, to show in the sadget and a direct link to the desired movie. </p><br><p><img src="https://habrastorage.org/webt/2o/t2/rd/2ot2rdxu0jgljubvlugwvmgopjo.png"></p><br><p>  When you click on the corresponding item, the user will be taken to a specially prepared, beautiful service page.  In this case, you can be sure that Yandex will find the right answer. </p><br><p><img src="https://habrastorage.org/webt/vb/ye/f9/vbyef9o3atzl23aufpnxbqjdc6k.png"></p><br><h2 id="buduschee">  Future </h2><br><p>  What is the future of search tips? </p><br><p>  Of course, we will continue to work on "transactional".  It's great when the search engine can give an answer even while entering a query, allowing the user to skip the query job phase, wait for the search results to load, view them, and so on.  We need to continue to enrich the tips and solve as many tasks as possible before entering the request. </p><br><p>  Naturally, you need to continue to work on the data.  After the previous article, we received a few questions about how the sadzhest inside is arranged.  In future publications, we will return to this topic and describe what algorithms and data structures are required to make good hints, responding to 100,000 requests per second, processing each request in less than 50 milliseconds and at the same time searching among the possible 1.5 billion options.  We have a lot to say about the predictions of the request frequencies and the formation of the correct tops - however, it is also clear that much can be improved in these areas. </p><br><p>  Search tips are one of the functionally and technologically complex interface parts of the search results page.  It is extremely important that all code that is responsible for user interaction, calculates metrics, and so on, is loaded and executed as quickly as possible.  Of course, here we are faced with standard programming problems for a huge number of browsers, OS versions and devices themselves.  Therefore, the development and testing of search tips is a very interesting topic and, I hope, we will also have publications and speeches about this. </p><br><p>  And, of course, we have a lot to do in terms of mobile development.  The Sajest in the Omnibox is not the same as the Sajest in the search line, since  he should cope well not only with entering queries, but also with searching for bookmarks, history, entering links.  Sajest in universal applications and widgets should also allow you to search for applications, files and contacts in your phone, as well as be able to interact with them. </p><br><p>  All this will deal with a team of search tips in the new year.  I hope that in a year we will again be able to write another article and tell you what happened! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/345406/">https://habr.com/ru/post/345406/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345388/index.html">HTML 5.2 in brief</a></li>
<li><a href="../345390/index.html">Synchronizing AssemblyVersion and Publish Version in a ClickOnce application</a></li>
<li><a href="../345392/index.html">Methods of simulation of probability distributions in the programming language Python</a></li>
<li><a href="../345396/index.html">NRF51822 in brief: Power saving and some peripherals</a></li>
<li><a href="../345402/index.html">Do not go to Fediverse, there you are in trouble. - Well, why not go there? They are waiting</a></li>
<li><a href="../345408/index.html">Who "goes to the clouds": Western IT startups that use virtual infrastructure</a></li>
<li><a href="../345410/index.html">Financial accounting for non-entrepreneurs</a></li>
<li><a href="../345412/index.html">Analyzing access logs using Splunk</a></li>
<li><a href="../345416/index.html">10 main announcements of Microsoft in 2017</a></li>
<li><a href="../345418/index.html">LAN routing through transparent socks-proxy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>