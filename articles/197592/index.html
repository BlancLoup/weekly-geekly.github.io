<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Digging into SAP data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As a promotional addition to a previously published article I will attach some experience and source code for a specific audience, namely SAP users. O...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Digging into SAP data</h1><div class="post__text post__text-html js-mediator-article">  As a promotional addition to a previously published <a href="http://habrahabr.ru/post/197424/">article</a> I will attach some experience and source code for a specific audience, namely SAP users.  Once I had to study and program for half a year in this wonderful system, or rather in the CRM module.  Since, on the one hand, the means for browsing data in SAP are extremely scarce, and, on the other hand, I was spoiled by my own habits of doing everything with a mouse, once, out of boredom, I did what I loved - Free Sampling, but in the ABAP &amp; light version. <br><a name="habracut"></a>  In the SAP tables, some terrible thousands of pieces, but their names are not the most convenient and obvious.  Normalization is abundant.  Therefore, to understand what lies in this table entry, say, BUT_000, is possible only with some stretch.  Without thinking twice, using rich means of reflection and metaprogramming of the ancient ABAP language like a mammoth and by flavoring this with all my beloved alv_grid, I ‚Äúweakened‚Äù some kind of code that allows viewing link values ‚Äã‚Äãto almost any depth using link metadata. <br>  In memory, the interface of the z-report <s>is not about cash registers, oh, by chance!</s>  following: <ul><li>  name of the start table </li><li>  additional limitation condition </li><li>  number of lines </li></ul>  In the opened grid, as well as in the nested ones, a double click on the "reference" field falls into the table.  The rest has already been forgotten, it is possible that this is not all goodies. <s>Learn</s> , <s>implement</s> refactoring, I hope you can do it yourself.  Good luck! <div class="spoiler">  <b class="spoiler_title">So ABAP source code</b> <div class="spoiler_text"><pre><code class="hljs dos">*&amp;---------------------------------------------------------------------* *&amp; Report Z_GREAT_ALV_TMP *&amp; *&amp;---------------------------------------------------------------------* *&amp; *&amp; *&amp;---------------------------------------------------------------------* REPORT z_great_alv_tmp. DATA: gv_ok LIKE sy-ucomm, gv_container <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO cl_gui_custom_container, gv_container_name <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> scrfname VALUE 'CONTAINER_ALV', gv_grid <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO cl_gui_alv_grid, gt_fieldcat <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_t_fcat, gs_layout <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_layo. *&amp;---------------------------------------------------------------------* *&amp; Include Z_GREAT_ALV_F01 *&amp;---------------------------------------------------------------------* FORM create_alv USING container_name <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> scrfname CHANGING container <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO cl_gui_custom_container grid <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO cl_gui_alv_grid. "    <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> container IS <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> BOUND. "  CREATE OBJECT container EXPORTING container_name = container_name EXCEPTIONS OTHERS = <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc NE <span class="hljs-number"><span class="hljs-number">0</span></span>. ENDIF. ENDIF. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> container IS BOUND. "  * <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> grid is bound. * free grid. * endif. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> grid IS <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> BOUND. CREATE OBJECT grid EXPORTING i_parent = container EXCEPTIONS OTHERS = <span class="hljs-number"><span class="hljs-number">1</span></span>. PERFORM set_great_handler. ENDIF. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc NE <span class="hljs-number"><span class="hljs-number">0</span></span>. ENDIF. ENDIF. ENDFORM. "create_alv *&amp;---------------------------------------------------------------------* *&amp; Form set_great_handlers *&amp;---------------------------------------------------------------------* * text *----------------------------------------------------------------------* *&amp;---------------------------------------------------------------------* *&amp; Form display_alv *&amp;---------------------------------------------------------------------* * text *----------------------------------------------------------------------* * --&gt;GRID text * --&gt;TAB text *----------------------------------------------------------------------* FORM display_alv CHANGING grid <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO cl_gui_alv_grid tab <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> ANY TABLE. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> grid IS BOUND. "   * PERFORM prepare_field_catalog CHANGING gt_fieldcat. * "     <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> METHOD grid-&gt;set_table_for_first_display EXPORTING" i_structure_name = gv_tablename is_layout = gs_layout CHANGING it_outtab = tab it_fieldcatalog = gt_fieldcat EXCEPTIONS invalid_parameter_combination = <span class="hljs-number"><span class="hljs-number">1</span></span> program_error = <span class="hljs-number"><span class="hljs-number">2</span></span> too_many_lines = <span class="hljs-number"><span class="hljs-number">3</span></span> OTHERS = <span class="hljs-number"><span class="hljs-number">4</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc NE <span class="hljs-number"><span class="hljs-number">0</span></span>. ENDIF. * "  * <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> METHOD grid-&gt;refresh_table_display * EXCEPTIONS * finished = <span class="hljs-number"><span class="hljs-number">1</span></span> * OTHERS = <span class="hljs-number"><span class="hljs-number">2</span></span>. * * <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc NE <span class="hljs-number"><span class="hljs-number">0</span></span>. * ENDIF. ENDIF. ENDFORM. "display_alv *&amp;---------------------------------------------------------------------* *&amp; Form prepare_field_catalog *&amp;---------------------------------------------------------------------* * text *----------------------------------------------------------------------* * --&gt;PT_FIELDCAT text *----------------------------------------------------------------------* FORM prepare_field_catalog USING tabname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname itab <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool CHANGING fieldcat <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_t_fcat . REFRESH fieldcat. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> itab IS INITIAL. <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> FUNCTION 'LVC_FIELDCATALOG_MERGE' EXPORTING i_structure_name = tabname CHANGING ct_fieldcat = fieldcat EXCEPTIONS OTHERS = <span class="hljs-number"><span class="hljs-number">1</span></span>. FIELD-SYMBOLS: &lt;fs_fcat&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_fcat. LOOP <span class="hljs-built_in"><span class="hljs-built_in">AT</span></span> fieldcat ASSIGNING &lt;fs_fcat&gt;. &lt;fs_fcat&gt;-edit = 'X'. ENDLOOP. <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span>. DATA: lv_field <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_fcat. lv_field-fieldname = 'FK_TABNAME'. lv_field-scrtext_s = 'TABNAME'. lv_field-inttype = 'C'. lv_field-outputlen = <span class="hljs-number"><span class="hljs-number">50</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> lv_field TO fieldcat. lv_field-fieldname = 'FIELDNAME'. lv_field-scrtext_s = 'FIELDNAME'. lv_field-outputlen = <span class="hljs-number"><span class="hljs-number">30</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> lv_field TO fieldcat. ENDIF. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>. * MESSAGE ID SY-MSGID <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> SY-MSGTY NUMBER SY-MSGNO * WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4. ENDIF. ENDFORM. "prepare_field_catalog *&amp;---------------------------------------------------------------------* *&amp; Form great_alv *&amp;---------------------------------------------------------------------* * text *----------------------------------------------------------------------* *&amp;---------------------------------------------------------------------* *&amp; Include Z_GREAT_ALV_CL_DICTSERVICES *&amp;---------------------------------------------------------------------* CLASS z_cl_great_alv_dictservices DEFINITION. PUBLIC SECTION. TYPES: BEGIN OF z_fk_pair, pk_name <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd03l-fieldname, fk_name <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd03l-fieldname, END OF z_fk_pair, z_fk_pair_list <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> STANDARD TABLE OF z_fk_pair, BEGIN OF z_dependent_rec, pk_tabname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname, fk_tabname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname, fieldname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd03l-fieldname, frkart <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd08l-frkart, fieldlist <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO data,"z_fk_pair_list, END OF z_dependent_rec, z_dependent_rec_list <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> STANDARD TABLE OF z_dependent_rec. CLASS-METHODS: get_fk_list IMPORTING tabname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname fieldname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd03l-fieldname EXPORTING dependent_rec <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_dependent_rec, get_check_fk_list IMPORTING tabname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname fieldname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd03l-fieldname EXPORTING dependent_rec <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_dependent_rec, get_dependent_list IMPORTING tabname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname EXPORTING tablist <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_dependent_rec_list. ENDCLASS. "z_cl_great_alv_dictservices DEFINITION *----------------------------------------------------------------------* * CLASS z_cl_great_alv_dictservices IMPLEMENTATION *----------------------------------------------------------------------* * *----------------------------------------------------------------------* CLASS z_cl_great_alv_dictservices IMPLEMENTATION. METHOD get_fk_list. dependent_rec-fk_tabname = tabname. dependent_rec-fieldname = fieldname. SELECT SINGLE checktable frkart FROM dd08l INTO (dependent_rec-pk_tabname, dependent_rec-frkart) WHERE tabname = tabname AND fieldname = fieldname. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span> AND dependent_rec-pk_tabname &lt;&gt; '*'. DATA: ls_fk_pair <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_fk_pair, lv_primpos <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd05s-primpos. FIELD-SYMBOLS: &lt;fs_pair_list&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_fk_pair_list. CREATE DATA dependent_rec-fieldlist <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_fk_pair_list. ASSIGN dependent_rec-fieldlist-&gt;* TO &lt;fs_pair_list&gt;. SELECT primpos forkey FROM dd05s INTO (lv_primpos, ls_fk_pair-fk_name) WHERE tabname = tabname AND fieldname = fieldname. SELECT SINGLE fieldname FROM dd03l INTO ls_fk_pair-pk_name WHERE tabname = dependent_rec-pk_tabname AND position = lv_primpos. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> ls_fk_pair TO &lt;fs_pair_list&gt;. ENDIF. ENDSELECT. ENDIF. ENDMETHOD. "get_fk_list METHOD get_check_fk_list. dependent_rec-fk_tabname = tabname. dependent_rec-fieldname = fieldname. DATA: lv_domname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd03l-domname. SELECT SINGLE domname FROM dd03l INTO lv_domname WHERE tabname = tabname AND fieldname = fieldname. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span> AND lv_domname IS <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> INITIAL. SELECT SINGLE entitytab FROM dd01l INTO dependent_rec-pk_tabname WHERE domname = lv_domname. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span> AND dependent_rec-pk_tabname IS <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> INITIAL. DATA: ls_fk_pair <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_fk_pair. FIELD-SYMBOLS: &lt;fs_pair_list&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_fk_pair_list. CREATE DATA dependent_rec-fieldlist <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_fk_pair_list. ASSIGN dependent_rec-fieldlist-&gt;* TO &lt;fs_pair_list&gt;. SELECT SINGLE fieldname FROM dd03l INTO ls_fk_pair-pk_name WHERE tabname = dependent_rec-pk_tabname AND domname = lv_domname AND keyflag = 'X'. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. ls_fk_pair-fk_name = fieldname. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> ls_fk_pair TO &lt;fs_pair_list&gt;. ENDIF. ENDIF. ENDIF. ENDMETHOD. "get_check_fk_list METHOD get_dependent_list. DATA: ls_rec <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_dependent_rec. REFRESH tablist. SELECT tabname fieldname frkart FROM dd08l INTO (ls_rec-fk_tabname, ls_rec-fieldname, ls_rec-frkart) WHERE checktable = tabname. get_fk_list( EXPORTING tabname = ls_rec-fk_tabname fieldname = ls_rec-fieldname IMPORTING dependent_rec = ls_rec ). <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> ls_rec-fieldlist IS BOUND. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> ls_rec TO tablist. CLEAR ls_rec. ENDIF. ENDSELECT. ENDMETHOD. "get_dependent_list ENDCLASS. "z_cl_great_alv_dictservices IMPLEMENTATION ** METHOD forward_zalx. ** DATA: ** lv_rowtype <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> zalx_clnt_genfld-rowtype, ** lv_fkrowtype <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> zalx_clnt_genfld-fkrowtype, ** lv_fkrowpos <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> zalx_clnt_genfld-fkrowpos, ** lv_structname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> zalx_clnt_genrel-structname, ** lv_tablename <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname, ** lv_condition <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> string, ** ls_nav_point <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_nav_point. ** READ TABLE nav_stack INTO ls_nav_point INDEX nav_position. ** ls_nav_point-row_id = row_id. ** ls_nav_point-key_field = fieldname. ** MODIFY nav_stack INDEX nav_position FROM ls_nav_point. ** ** <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. ** SELECT SINGLE rowtype FROM zalx_clnt_genrel INTO lv_rowtype WHERE structname = ls_nav_point-tab_name. ** <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. ** SELECT SINGLE fkrowtype fkrowpos FROM zalx_clnt_genfld INTO (lv_fkrowtype, lv_fkrowpos) WHERE rowtype = lv_rowtype AND fieldname = fieldname. ** <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. ** SELECT SINGLE structname FROM zalx_clnt_genrel INTO lv_structname WHERE rowtype = lv_fkrowtype. ** <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. ** ** table_name = lv_structname. ** SELECT SINGLE fieldname FROM zalx_clnt_genfld INTO lv_condition WHERE rowtype = lv_fkrowtype AND rowpos = lv_fkrowpos. ** <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. ** WRITE lv_structname. ** FIELD-SYMBOLS: &lt;ff&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> ANY, ** &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> ANY, ** &lt;lfs_table&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> STANDARD TABLE. ** ** ASSIGN ls_nav_point-tab_table-&gt;* TO &lt;lfs_table&gt;. ** READ TABLE &lt;lfs_table&gt; ASSIGNING &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; INDEX row_id-row_id. ** ASSIGN COMPONENT fieldname OF STRUCTURE &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; TO &lt;ff&gt;. ** CONCATENATE lv_condition ' = ''' &lt;ff&gt; '''' INTO lv_condition. ** ** CLEAR ls_nav_point. ** ** lv_tablename = lv_structname. ** doselect( EXPORTING tablename = lv_tablename condition = lv_condition ** IMPORTING data_table = ls_nav_point-tab_table ). ** ** data_table = ls_nav_point-tab_table. ** ls_nav_point-tab_name = lv_structname. ** ** <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> ls_nav_point TO nav_stack. ** ADD <span class="hljs-number"><span class="hljs-number">1</span></span> TO nav_position. ** ** ENDIF. ** ** ENDIF. ** ** ENDIF. ** ENDIF. ** ENDIF. ** ** ENDMETHOD. "forward *&amp;---------------------------------------------------------------------* *&amp; Include Z_GREAT_ALV_CL *&amp;---------------------------------------------------------------------* *&amp;---------------------------------------------------------------------* *&amp; Include Z_GREAT_ALV_CL_NAVSTACK *&amp;---------------------------------------------------------------------* CLASS z_cl_great_alv_navstack DEFINITION. PUBLIC SECTION. TYPES: BEGIN OF z_nav_point, tab_name <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname, key_field <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_col, row_id <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_roid, tab_table <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO data, dependent <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool, END OF z_nav_point. CLASS-METHODS: init IMPORTING tablename <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname reccount <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> i condition <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> string RETURNING value(ok) <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool, follow_fk IMPORTING fieldname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_col row_id <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_roid RETURNING value(ok) <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool, choose_dependent IMPORTING fieldname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_col row_id <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_roid table_name <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname OPTIONAL RETURNING value(ok) <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool, follow_pk IMPORTING deprec <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_dictservices=&gt;z_dependent_rec row_id <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_roid RETURNING value(ok) <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool, follow_text IMPORTING row_id <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_roid RETURNING value(ok) <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool, back, current_nav_point RETURNING value(point) <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_nav_point, follow_zalx IMPORTING fieldname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_col row_id <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_roid RETURNING value(ok) <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool, get_condition_string IMPORTING row_id <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> i deprec <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_dictservices=&gt;z_dependent_rec data_table <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO data OPTIONAL dependent <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool OPTIONAL RETURNING value(condition) <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> string. PRIVATE SECTION. CLASS-DATA: nav_stack <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> TABLE OF z_nav_point, nav_position <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> i, rec_count <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> i. CLASS-METHODS: doselect IMPORTING tablename <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname condition <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> string OPTIONAL EXPORTING data_table <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO data. ENDCLASS. "Z_CL_GREAT_ALV_NAVSTACK DEFINITION *----------------------------------------------------------------------* * CLASS Z_CL_GREAT_ALV_NAVSTACK IMPLEMENTATION *----------------------------------------------------------------------* * *----------------------------------------------------------------------* CLASS z_cl_great_alv_navstack IMPLEMENTATION. METHOD init. REFRESH: nav_stack. DATA: ls_nav_point <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_nav_point. rec_count = reccount. doselect( EXPORTING tablename = tablename condition = condition IMPORTING data_table = ls_nav_point-tab_table ). <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> ls_nav_point-tab_table IS BOUND. ls_nav_point-tab_name = tablename. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> ls_nav_point TO nav_stack. nav_position = <span class="hljs-number"><span class="hljs-number">1</span></span>. ok = 'X'. ENDIF. ENDMETHOD. "init METHOD doselect. CREATE DATA data_table <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> TABLE OF (tablename). FIELD-SYMBOLS: &lt;fsv_table&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> STANDARD TABLE. ASSIGN data_table-&gt;* TO &lt;fsv_table&gt;. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> condition IS SUPPLIED. SELECT * UP TO rec_count ROWS FROM (tablename) INTO TABLE &lt;fsv_table&gt; WHERE (condition). <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span>. SELECT * UP TO rec_count ROWS FROM (tablename) INTO TABLE &lt;fsv_table&gt;. ENDIF. ENDMETHOD. "doselect METHOD follow_fk. DATA: ls_dep <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_dictservices=&gt;z_dependent_rec, ls_nav_point <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_nav_point, lv_colname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_col, lv_condition <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> string. ls_nav_point = current_nav_point( ). ls_nav_point-row_id = row_id. ls_nav_point-key_field = fieldname. MODIFY nav_stack INDEX nav_position FROM ls_nav_point. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> ls_nav_point-dependent IS INITIAL. z_cl_great_alv_dictservices=&gt;get_fk_list( EXPORTING tabname = ls_nav_point-tab_name fieldname = fieldname-fieldname IMPORTING dependent_rec = ls_dep ). <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> ls_dep-fieldlist IS <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> BOUND. z_cl_great_alv_dictservices=&gt;get_check_fk_list( EXPORTING tabname = ls_nav_point-tab_name fieldname = fieldname-fieldname IMPORTING dependent_rec = ls_dep ). ENDIF. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> ls_dep-fieldlist IS BOUND. lv_condition = get_condition_string( row_id = row_id-row_id deprec = ls_dep ). CLEAR ls_nav_point. doselect( EXPORTING tablename = ls_dep-pk_tabname condition = lv_condition IMPORTING data_table = ls_nav_point-tab_table ). <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> ls_nav_point-tab_table IS BOUND. ls_nav_point-tab_name = ls_dep-pk_tabname. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> ls_nav_point TO nav_stack. ADD <span class="hljs-number"><span class="hljs-number">1</span></span> TO nav_position. ok = 'X'. ENDIF. ENDIF. <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span>. FIELD-SYMBOLS: &lt;fs_dep&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_dictservices=&gt;z_dependent_rec_list. ASSIGN ls_nav_point-tab_table-&gt;* TO &lt;fs_dep&gt;. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> &lt;fs_dep&gt; IS ASSIGNED. READ TABLE &lt;fs_dep&gt; INTO ls_dep INDEX row_id-row_id. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. back( ). ls_nav_point = current_nav_point( ). lv_colname-fieldname = ls_dep-fieldname. ok = follow_pk( deprec = ls_dep row_id = ls_nav_point-row_id ). ENDIF. ENDIF. ENDIF. ENDMETHOD. "follow_fk METHOD choose_dependent. DATA: ls_nav_point <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_nav_point, lv_dep_list <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO data. FIELD-SYMBOLS &lt;fs_deplist&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_dictservices=&gt;z_dependent_rec_list. ls_nav_point = current_nav_point( ). ls_nav_point-row_id = row_id. ls_nav_point-key_field = fieldname. MODIFY nav_stack INDEX nav_position FROM ls_nav_point. CREATE DATA lv_dep_list <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_dictservices=&gt;z_dependent_rec_list. ASSIGN lv_dep_list-&gt;* TO &lt;fs_deplist&gt;. z_cl_great_alv_dictservices=&gt;get_dependent_list( EXPORTING tabname = ls_nav_point-tab_name IMPORTING tablist = &lt;fs_deplist&gt; ). <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> lv_dep_list IS <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> INITIAL. SORT &lt;fs_deplist&gt; BY fk_tabname ASCENDING. CLEAR ls_nav_point. ls_nav_point-tab_table = lv_dep_list. ls_nav_point-dependent = 'X'. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> ls_nav_point TO nav_stack. ADD <span class="hljs-number"><span class="hljs-number">1</span></span> TO nav_position. ok = 'X'. ENDIF. ENDMETHOD. "choose_dependent METHOD follow_pk. DATA: lv_condition <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> string, ls_nav_point <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_nav_point. ls_nav_point = current_nav_point( ). ls_nav_point-row_id = row_id. MODIFY nav_stack INDEX nav_position FROM ls_nav_point. lv_condition = get_condition_string( row_id = row_id-row_id deprec = deprec dependent = 'X' ). CLEAR ls_nav_point. doselect( EXPORTING tablename = deprec-fk_tabname condition = lv_condition IMPORTING data_table = ls_nav_point-tab_table ). <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> ls_nav_point-tab_table IS BOUND. ls_nav_point-tab_name = deprec-fk_tabname. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> ls_nav_point TO nav_stack. ADD <span class="hljs-number"><span class="hljs-number">1</span></span> TO nav_position. ok = 'X'. ENDIF. ENDMETHOD. "follow_pk METHOD follow_text. DATA: ls_nav_point <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_nav_point, lv_colname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_col, lt_dep_list <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_dictservices=&gt;z_dependent_rec_list, ls_dep_list <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> LINE OF z_cl_great_alv_dictservices=&gt;z_dependent_rec_list. ls_nav_point = current_nav_point( ). z_cl_great_alv_dictservices=&gt;get_dependent_list( EXPORTING tabname = ls_nav_point-tab_name IMPORTING tablist = lt_dep_list ). LOOP <span class="hljs-built_in"><span class="hljs-built_in">AT</span></span> lt_dep_list INTO ls_dep_list WHERE frkart = 'TEXT'. lv_colname-fieldname = ls_dep_list-fieldname. ok = follow_pk( deprec = ls_dep_list row_id = row_id ). <span class="hljs-keyword"><span class="hljs-keyword">EXIT</span></span>. "only one text table, <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> any ENDLOOP. ENDMETHOD. "follow_text METHOD back. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> nav_position &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>. DELETE nav_stack INDEX nav_position. SUBTRACT <span class="hljs-number"><span class="hljs-number">1</span></span> FROM nav_position. ENDIF. ENDMETHOD. "back METHOD current_nav_point. READ TABLE nav_stack INTO point INDEX nav_position. ENDMETHOD. "current_table_name METHOD get_condition_string. FIELD-SYMBOLS: &lt;ff&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> ANY, &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> ANY, &lt;lfs_table&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> STANDARD TABLE, &lt;lfs_fkrec&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_dictservices=&gt;z_fk_pair_list. DATA: ls_navpoint <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_nav_point, ls_fkpair <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_dictservices=&gt;z_fk_pair, lv_condition <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> string, lt_condition <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> TABLE OF string. ls_navpoint = current_nav_point( ). ASSIGN ls_navpoint-tab_table-&gt;* TO &lt;lfs_table&gt;. READ TABLE &lt;lfs_table&gt; ASSIGNING &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; INDEX row_id. ASSIGN deprec-fieldlist-&gt;* TO &lt;lfs_fkrec&gt;. LOOP <span class="hljs-built_in"><span class="hljs-built_in">AT</span></span> &lt;lfs_fkrec&gt; INTO ls_fkpair. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> dependent IS INITIAL. ASSIGN COMPONENT ls_fkpair-fk_name OF STRUCTURE &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; TO &lt;ff&gt;. CONCATENATE ls_fkpair-pk_name ' = ''' &lt;ff&gt; '''' INTO lv_condition. <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span>. ASSIGN COMPONENT ls_fkpair-pk_name OF STRUCTURE &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; TO &lt;ff&gt;. CONCATENATE ls_fkpair-fk_name ' = ''' &lt;ff&gt; '''' INTO lv_condition. ENDIF. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> lv_condition TO lt_condition. ENDLOOP. CONCATENATE LINES OF lt_condition INTO condition SEPARATED BY ' AND '. ENDMETHOD. "get_condition_string METHOD follow_zalx. DATA: lv_rowtype <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> zalx_clnt_genfld-rowtype, lv_fkrowtype <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> zalx_clnt_genfld-fkrowtype, lv_fkrowpos <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> zalx_clnt_genfld-fkrowpos, lv_structname <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> zalx_clnt_genrel-structname, lv_tablename <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> dd02l-tabname, lv_condition <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> string, ls_nav_point <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_nav_point. READ TABLE nav_stack INTO ls_nav_point INDEX nav_position. ls_nav_point-row_id = row_id. ls_nav_point-key_field = fieldname. MODIFY nav_stack INDEX nav_position FROM ls_nav_point. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. SELECT SINGLE rowtype FROM zalx_clnt_genrel INTO lv_rowtype WHERE structname = ls_nav_point-tab_name. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. SELECT SINGLE fkrowtype fkrowpos FROM zalx_clnt_genfld INTO (lv_fkrowtype, lv_fkrowpos) WHERE rowtype = lv_rowtype AND fieldname = fieldname. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. SELECT SINGLE structname FROM zalx_clnt_genrel INTO lv_structname WHERE rowtype = lv_fkrowtype. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. "table_name = lv_structname. SELECT SINGLE fieldname FROM zalx_clnt_genfld INTO lv_condition WHERE rowtype = lv_fkrowtype AND rowpos = lv_fkrowpos. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. WRITE lv_structname. FIELD-SYMBOLS: &lt;ff&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> ANY, &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> ANY, &lt;lfs_table&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> STANDARD TABLE. ASSIGN ls_nav_point-tab_table-&gt;* TO &lt;lfs_table&gt;. READ TABLE &lt;lfs_table&gt; ASSIGNING &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; INDEX row_id-row_id. ASSIGN COMPONENT fieldname OF STRUCTURE &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; TO &lt;ff&gt;. CONCATENATE lv_condition ' = ''' &lt;ff&gt; '''' INTO lv_condition. CLEAR ls_nav_point. lv_tablename = lv_structname. doselect( EXPORTING tablename = lv_tablename condition = lv_condition IMPORTING data_table = ls_nav_point-tab_table ). <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> ls_nav_point-tab_table IS BOUND. ls_nav_point-tab_name = lv_structname. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> ls_nav_point TO nav_stack. ADD <span class="hljs-number"><span class="hljs-number">1</span></span> TO nav_position. ok = 'X'. ENDIF. ENDIF. ENDIF. ENDIF. ENDIF. ENDIF. ENDMETHOD. "forward ENDCLASS. "Z_CL_GREAT_ALV_NAVSTACK IMPLEMENTATION *----------------------------------------------------------------------* * CLASS z_great_alv_handler DEFINITION *----------------------------------------------------------------------* * *----------------------------------------------------------------------* CLASS z_great_alv_handler DEFINITION. PUBLIC SECTION. CLASS-DATA: zf_texting <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> stb_button-function VALUE 'TEXTING', zf_zalx <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> stb_button-function VALUE 'ZALX', zf_depend <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> stb_button-function VALUE 'DEPEND', zf_follow <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> stb_button-function VALUE 'FOLLOW'. METHODS: double_click <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> EVENT double_click OF cl_gui_alv_grid IMPORTING e_row e_column es_row_no, toolbar_modify <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> EVENT toolbar OF cl_gui_alv_grid IMPORTING e_object e_interactive, user_command <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> EVENT user_command OF cl_gui_alv_grid IMPORTING e_ucomm, data_changed <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> EVENT data_changed OF cl_gui_alv_grid IMPORTING er_data_changed e_onf4 e_onf4_before e_onf4_after e_ucomm. ENDCLASS. "Z_GREAT_ALV_HANDLER DEFINITION *----------------------------------------------------------------------* * CLASS Z_GREAT_ALV_HANDLER IMPLEMENTATION *----------------------------------------------------------------------* * *----------------------------------------------------------------------* CLASS z_great_alv_handler IMPLEMENTATION. METHOD double_click. DATA: lv_ok <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool. lv_ok = z_cl_great_alv_navstack=&gt;follow_fk( fieldname = e_column row_id = es_row_no ). <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> lv_ok = 'X'. <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> SCREEN <span class="hljs-number"><span class="hljs-number">100</span></span>. ENDIF. ENDMETHOD. "DOUBLE_CLICK METHOD toolbar_modify. DATA: lv_tbutton <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> stb_button. LOOP <span class="hljs-built_in"><span class="hljs-built_in">AT</span></span> e_object-&gt;mt_toolbar INTO lv_tbutton WHERE function = zf_texting. ENDLOOP. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>. CLEAR lv_tbutton. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> TO lv_tbutton-butn_type. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> zf_follow TO lv_tbutton-function. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> 'Follow foreign key/check table' TO lv_tbutton-text. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> 'Follow foreign key/check table' TO lv_tbutton-quickinfo. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> space TO lv_tbutton-disabled. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> lv_tbutton TO e_object-&gt;mt_toolbar. CLEAR lv_tbutton. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> TO lv_tbutton-butn_type. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> zf_texting TO lv_tbutton-function. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> 'Text table record' TO lv_tbutton-text. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> 'Text table record' TO lv_tbutton-quickinfo. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> space TO lv_tbutton-disabled. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> lv_tbutton TO e_object-&gt;mt_toolbar. CLEAR lv_tbutton. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> TO lv_tbutton-butn_type. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> zf_depend TO lv_tbutton-function. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> 'Dependent tables' TO lv_tbutton-text. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> 'Dependent tables' TO lv_tbutton-quickinfo. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> space TO lv_tbutton-disabled. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> lv_tbutton TO e_object-&gt;mt_toolbar. CLEAR lv_tbutton. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> TO lv_tbutton-butn_type. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> zf_zalx TO lv_tbutton-function. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> 'ZALX' TO lv_tbutton-text. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> 'ZALX' TO lv_tbutton-quickinfo. <span class="hljs-built_in"><span class="hljs-built_in">MOVE</span></span> space TO lv_tbutton-disabled. <span class="hljs-built_in"><span class="hljs-built_in">APPEND</span></span> lv_tbutton TO e_object-&gt;mt_toolbar. ENDIF. ENDMETHOD. "toolbar_modify METHOD user_command. DATA: lv_table <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO data, lv_column <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_col, lv_rowno <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_roid, lv_ok <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool. gv_grid-&gt;get_current_cell( IMPORTING es_col_id = lv_column es_row_no = lv_rowno ). CASE e_ucomm. WHEN zf_texting. lv_ok = z_cl_great_alv_navstack=&gt;follow_text( row_id = lv_rowno ). WHEN zf_zalx. lv_ok = z_cl_great_alv_navstack=&gt;follow_zalx( fieldname = lv_column row_id = lv_rowno ). WHEN zf_depend. lv_ok = z_cl_great_alv_navstack=&gt;choose_dependent( fieldname = lv_column row_id = lv_rowno ). WHEN zf_follow. lv_ok = z_cl_great_alv_navstack=&gt;follow_fk( fieldname = lv_column row_id = lv_rowno ). WHEN OTHERS. <span class="hljs-keyword"><span class="hljs-keyword">EXIT</span></span>. ENDCASE. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> lv_ok = 'X'. <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> SCREEN <span class="hljs-number"><span class="hljs-number">100</span></span>. ENDIF. ENDMETHOD. "user_command METHOD data_changed. DATA: ls_nav_point <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_navstack=&gt;z_nav_point, ls_deleted_row <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> lvc_s_moce. FIELD-SYMBOLS: &lt;fst&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> STANDARD TABLE, &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> ANY. "modify ls_nav_point = z_cl_great_alv_navstack=&gt;current_nav_point( ). ASSIGN er_data_changed-&gt;mp_mod_rows-&gt;* TO &lt;fst&gt;. MODIFY (ls_nav_point-tab_name) FROM TABLE &lt;fst&gt;. "delete ASSIGN ls_nav_point-tab_table-&gt;* TO &lt;fst&gt;. LOOP <span class="hljs-built_in"><span class="hljs-built_in">AT</span></span> er_data_changed-&gt;mt_deleted_rows INTO ls_deleted_row. READ TABLE &lt;fst&gt; ASSIGNING &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt; INDEX ls_deleted_row-row_id. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> sy-subrc = <span class="hljs-number"><span class="hljs-number">0</span></span>. DELETE (ls_nav_point-tab_name) FROM &lt;<span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>&gt;. ENDIF. ENDLOOP. ENDMETHOD. "data_changed ENDCLASS. "Z_GREAT_ALV_HANDLER IMPLEMENTATION *----------------------------------------------------------------------* * MODULE PAI_01 INPUT *----------------------------------------------------------------------* * *----------------------------------------------------------------------* MODULE pai_01 INPUT. CASE gv_ok. WHEN 'BACK'. z_cl_great_alv_navstack=&gt;back( ). PERFORM great_alv. WHEN '%EX'. LEAVE PROGRAM. ENDCASE. ENDMODULE. " PAI_01 INPUT *----------------------------------------------------------------------* * MODULE PBO_01 OUTPUT *----------------------------------------------------------------------* * *----------------------------------------------------------------------* MODULE pbo_01 OUTPUT. CLEAR gv_ok. <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PF-STATUS ''. PERFORM great_alv. ENDMODULE. " PBO_01 OUTPUT *&amp;---------------------------------------------------------------------* *&amp; Form set_great_handler *&amp;---------------------------------------------------------------------* * text *----------------------------------------------------------------------* FORM set_great_handler. DATA lv_handler <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> REF TO z_great_alv_handler. CREATE OBJECT lv_handler. <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> gv_grid IS BOUND AND lv_handler IS BOUND. <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> HANDLER lv_handler-&gt;double_click <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> gv_grid. <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> HANDLER lv_handler-&gt;toolbar_modify <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> gv_grid. <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> HANDLER lv_handler-&gt;user_command <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> gv_grid. <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> HANDLER lv_handler-&gt;data_changed <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> gv_grid. "grid-&gt;set_toolbar_interactive( ). ENDIF. ENDFORM. "set_great_handlers *&amp;---------------------------------------------------------------------* *&amp; Form great_alv *&amp;---------------------------------------------------------------------* * text *----------------------------------------------------------------------* FORM great_alv. DATA: lv_nav_point <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> z_cl_great_alv_navstack=&gt;z_nav_point. lv_nav_point = z_cl_great_alv_navstack=&gt;current_nav_point( ). PERFORM create_alv USING gv_container_name CHANGING gv_container gv_grid. . PERFORM prepare_field_catalog USING lv_nav_point-tab_name lv_nav_point-dependent CHANGING gt_fieldcat. FIELD-SYMBOLS: &lt;lfs_table&gt; <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> ANY TABLE. ASSIGN lv_nav_point-tab_table-&gt;* TO &lt;lfs_table&gt;. PERFORM display_alv USING gv_grid &lt;lfs_table&gt;. gv_grid-&gt;set_current_cell_via_id( EXPORTING "is_row_no = lv_nav_point-row_id is_column_id = lv_nav_point-key_field is_row_no = lv_nav_point-row_id ). ENDFORM. "great_alv PARAMETERS: tabname LIKE dd02l-tabname DEFAULT 'but050', rccount <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> i DEFAULT <span class="hljs-number"><span class="hljs-number">100</span></span>, condit <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> string DEFAULT ''. <span class="hljs-built_in"><span class="hljs-built_in">START</span></span>-OF-SELECTION. DATA: lv_ok <span class="hljs-built_in"><span class="hljs-built_in">TYPE</span></span> rs_bool. lv_ok = z_cl_great_alv_navstack=&gt;init( tablename = tabname reccount = rccount condition = condit ). <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> lv_ok = 'X'. <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> SCREEN <span class="hljs-number"><span class="hljs-number">100</span></span>. ENDIF.</code> </pre> </div></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/197592/">https://habr.com/ru/post/197592/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197582/index.html">KiCad and GOST. HBO Library</a></li>
<li><a href="../197584/index.html">Yandex bought Film Search</a></li>
<li><a href="../197586/index.html">Testing installers in Windows when you need to quickly and cheaply</a></li>
<li><a href="../197588/index.html">Collected Website Psd Layout Requirements</a></li>
<li><a href="../197590/index.html">MonoDB vs PostgreSQL performance comparison. Part I: No index</a></li>
<li><a href="../197594/index.html">System.exit (). What exit code to use?</a></li>
<li><a href="../197596/index.html">Brainbench: 600 free certificates till 10.25.2013</a></li>
<li><a href="../197598/index.html">Introduction to Go - we write a grabber of web pages with multithreading and harlots</a></li>
<li><a href="../197604/index.html">Open Hand Dextrus - palm prosthesis, which costs less than $ 1000</a></li>
<li><a href="../197606/index.html">On a singularity of the Kotelnikov theorem</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>