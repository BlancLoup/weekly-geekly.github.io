<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MiniATS at home</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have a landline phone from Ukrtelecom. And everything would be fine if they did not steal the telephone cable. And once again left without a city co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MiniATS at home</h1><div class="post__text post__text-html js-mediator-article">  I have a landline phone from Ukrtelecom.  And everything would be fine if they did not steal the telephone cable.  And once again left without a city connection, I decided to look for alternatives.  My Internet is on optics.  Having learned that Ukrtelecom provides SIP telephony services, I was already glad to solve the problem with a little blood.  However, it turned out that the number will change with me.  But the old number is the only thing that stopped me from leaving Ukrtelecom.  Well, since I couldn‚Äôt avoid losing a number, then I decided to tackle more closely the issue of providing myself with a connection. <br><a name="habracut"></a><br>  Immediately, the first alternative seems to be a CDMA tube, but I have 6 tubes in my house with 3 tubes for 2 bases (4 tubes in the house, 1 in the summer kitchen, 1 in the garage), this is very convenient when the handset is always at hand and not you have to carry it with you.  I did not know about the <b>Huawei-1201</b> CDMA terminal at that time, and if I had known, then this article would not have existed now.  That's why I saw my solution in the world of SIP telephony. <br><br>  I found out that in order to connect analog phones to the SIP line, a VOIP gateway is needed.  Well, once the telephony is digital, then why not make a ‚Äúcontrol panel‚Äù to it? <br><br>  At that moment, I only read about SIP telephony on Habr√© about Asterisk headers, skipping them, thinking that: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1) it is very difficult for me. <br>  2) I do not need it. <br><br>  In both points I was wrong. <br><br>  Once upon a time I watched a video by Dmitry Bachilo, about installing OpenWrt on a TP-Link TL-WR842 router, where he reported, among other things, that I installed Asterisk on similar devices.  Thanks to Dmitry for his video.  And when I chose a router, I decided that I would buy a router, on which Dmitry put OpenWRT, so that there would be no surprise that in case of buying another router, it does not support OpenWRT, the advantage was also the fact that it had a USB port.  Installing almost immediately after buying OpenWRT 05/15/1 on the router and inserting a USB flash drive into it, thus making it its home file server.  It was about 10-12 months ago.  Frankly, with OpenWRT, I have not had a deal with this and I learned about many technologies thanks to Dmitry's video. <br><br>  I also found articles about screwing GSM modems to Asterisk.  Since I had a usb port in the router, I decided to carry out this task as well, though without knowing which side to begin to solve it. <br><br>  Having found the step-by-step tutorial on installing Asterisk 11 on OpenWrt, I began to carry it out, following each step.  However, at the end I was disappointed, when I tried to run Asterisk 11 in OpenWRT 15, I saw an error Segmentation fault.  The first question that arises from an unaware reader: why exactly Asterisk 11?  Because it is for this version that there is a package chan_dongle, which allows you to hook Huawei GSM modems to Asterisk.  After searching the Internet for the cause of the Segmentation fault, I did not find anything intelligible, except for ‚ÄúOpenWRT 15 is bad, OpenWRT 14 is good.‚Äù  Since I had no experience with this issue, I had to ‚Äúwrite to believe‚Äù.  Having installed the 14th version of OpenWRT, I still managed to install and run Asterisk.  But this is not enough, you need to configure it.  Searching the Internet again, I came across a SIP provider like Zadarma, whose internal numbers are free.  For the test is the most!  By registering two accounts, I tried to call from a computer to a smartphone.  The call has passed.  So I set all the parameters correctly.  The site has instructions on how to connect to Asterisk, however, there‚Äôs one line missing, which needs to be written in the <b>sip.conf</b> file <br><br><pre><code class="markdown hljs">register =&gt; 111111:password@sip.zadarma.com/111111  111111- </code> </pre> <br>  Having registered the settings of the number 101 on my smartphone, I began to call again from the computer.  Having played enough and making sure of the viability of the idea, I began searching for a VOIP gateway.  After going through a bunch of options on OLX, I decided to order a gateway in China.  Having ordered the Linksys pap2t, I began searching for a suitable GSM modem, all on the same free ad site.  The most common modem supporting voice transmission was the Huawei e1550, which I bought.  However, since I did not have a USB hub at that time, I tried to install OpenWRT on a memory card inserted into the modem.  Unfortunately unsuccessfully.  The memory card was initialized after mounting the root file system.  But I didn‚Äôt give up trying to do it and even deciding to try to completely rebuild OpenWRT from the sources (what if it helps?).  Relentlessly compiling in the evenings different versions of OpenWRT I tried to get a modem boot from a memory card, but I achieved a completely different result.  It turns out Asterisk 11 under OpenWRT 15 - works !!!  If both the firmware and the package compile together.  Still, having surrendered, I acquired a USB hub, installed OpenWRT on a USB flash drive, and inserting a modem into the neighboring port, I began to configure chan_dongle.  However, since I‚Äôm already compiling the firmware myself, chan_dongle decided to build from the sources. <br><br>  Waiting for the gateway from China, I decided to find out that I can squeeze out my PBX, and first of all I wrote a script on Bash that forms a voice file from the caller‚Äôs number, and then when I call from my second Zadarma number, I played this file and I could find out the number of the last person calling me home, even if I was not at home.  I also wrote the bash script for the first time and much was not obvious to me.  As a result, after conducting experiments, when connecting to a slow Internet channel and calling home to Zadarma number, it was not possible to disassemble many numbers.  Yes, and the Bash script was not devoid of errors, for this I‚Äôm not going to post it here, I‚Äôll just say that while I was trying to figure out how to call the script I came across such a wonderful thing as AGI.  Which allows using PHP, Perl or CGI scripts as a handler. <br><br>  In parallel with writing scripts, I called my friends and acquaintances through different softphones from a smartphone.  The call route was as follows: SoftFon (different SIP clients) =&gt; Asterisk =&gt; GSM modem =&gt; GSM phone.  And without exception, everyone talked to me about the terrible quality of my voice, while I heard everyone perfectly.  This brought me to the fact that I had to register allowed codecs for each channel.  Having tried the G722 codec, I realized that the capacity of my router would obviously not be enough to encode voice and work as the main gateway of my Internet.  Therefore, for Asterisk, I decided to purchase a separate router.  However, the G711 codecs (alaw / ulaw) came to light with the most optimal sound quality.  I stopped at them, although I was clearly dissatisfied with the quality of my voice. <br><br>  The next step for me was the call detailing, and their recording.  Both of these tasks can be solved internally with Asterisk, 1 - CDR, 2 - MixMonitor.  CDR - serves to detail calls, and can record them from a CSV file to a MySQL database, which I planned to use as a database.  But later, after reading that MySQL would be too voracious for a router, I shifted my choice in favor of SqLite3.  Here is my <b>cdr_sqlite3_custom.conf</b> file <br><br><pre> <code class="markdown hljs">table =&gt; cdr columns =&gt; calldate, clid, dcontext, channel, dstchannel, lastapp, lastdata, duration, billsec, disposition, amaflags, accountcode, uniqueid, userfield, call<span class="hljs-emphasis"><span class="hljs-emphasis">_num, dist values =&gt; '${CDR(start)}','${CDR(clid)}','${CDR(dcontext)}','${CDR(channel)}','${CDR(dstchannel)}','${CDR(lastapp)}','${CDR(lastdata)}','${CDR(duration)}','${CDR(billsec)}','${CDR(disposition)}','${CDR(amaflags)}','${CDR(accountcode)}','${CDR(uniqueid)}','${CDR(userfield)}','${CDR(call_</span></span>num)}','${CDR(dist)}'</code> </pre> <br>  Having wrapped the call in MixMonitor, I record the call, but the recording goes to the wav file, and this format loves a lot of space, that's why I installed the lame package and after recording, I will convert the file to mp3. <br><br>  In the meantime, my Linksys pap2t has already arrived and I could already connect a regular landline phone instead of a smartphone for the test.  And what was my surprise when, when calling through this gateway, the problem with the quality of the outgoing voice disappeared.  Those.  I was already heard as well as I heard the interlocutor. <br><br>  In search of a router that will be allocated only for PBX (I decided to look for Ali), my choice fell on <b>OYE-0001</b> , because it already had a built-in card reader for MicroSD cards and OpenWRT standing out of the box.  After placing the order, I sat down again for writing scripts.  While writing scripts, it turned out that the Huawei E1550 modem has the ability to go to the astral, and only a complete reset on power helps from this.  Those.  pulling out and installing the modem back.  (Looking ahead, I will say that this problem has not been solved yet, although there is a proposed solution.) <br><br>  Having received a Chinese router, I again began to try to install the firmware on an external medium, but this time on a memory card inserted into a card reader.  On the stock firmware, I managed to do this, but the packages I needed from the OpenWRT repository did not work on it.  By this, I tried again to compile the firmware myself.  I tried to collect exactly the 15th version.  But having tried various pre-settings from similar routers, on the MT7620 processor, I constantly had something, but it did not work as it should.  But since there is little experience, I could not solve the problem.  However, it turned out that the 16th (trunk, test) version of OpenWRT supports my router out of the box and there is even a firmware on the site, which I hurried to download.  And in this firmware I managed to do everything that I had in mind, i.e.  install OpenWRT on a memory card, configure the network and install the packages I need.  If anyone sets up a 16-trunk, OpenWRT version, it does not have the Luci package.  Those.  Web-based GUI.  And the network settings will need to be made via the console in the / etc / config / network file. <br><br>  <b>The final stage - connecting the city number.</b> <br><br>  As a provider for a city number, I chose Intertelecom for myself.  This is a CDMA operator that provides SIP telephony services.  I saw my home PBX as follows: 2-GSM modem and SIP channel from Intertelecom, since  chan_dongle did not know how to work with CDMA modems.  But again gathering information, I came across <a href="http://tet-a-tet.mobi/ru/investitsii/49-prostoj-tekst-3.html">chan_cdma</a> .  This library allows you to work with a CDMA modem ZTE AC8710.  Thanks a lot to Oleg Zhabko for writing a module for working with this modem.  But it was written under Asterisk 1.8, and I used 11. Next, among the ads, I came across a ZTE AC8700 modem (it looks like 1 in 1 AC8710), for 35 UAH.  (this is a ball).  By this, I decided to invest in this experiment and purchased this modem.  Later I found out that chan_cdma was written based on chan_dongle.  Therefore, in order to make the modem work under 11 Asterisk, you will need a tedious copy-paste code from one project to another.  But having done the most thorough copy-paste, transferring to the project chan_dongle only the sections responsible for working with CDMA, but I didn‚Äôt understand the meaning of the code especially.  Alas, I could not get the modem to work and call the operator.  Then I had to make an effort and still began to delve into the code by constantly inserting debug messages.  I began to notice that there are data checking places in the code that are commented out, and the ‚Äúif (1) {...}‚Äù stubs are inserted instead.  Then I got to the code that is responsible for checking the registration on the network and also ‚Äúdrowned out‚Äù it too.  And ‚Äúlo and behold!‚Äù, I was able to make a call to the operator, but since I don‚Äôt know the purpose of these checks, I just added the number that my modem returned to the ‚Äúskip‚Äù. <br><br><img src="https://habrastorage.org/files/37a/269/9b1/37a2699b1e4c415e93c84ff727c5ca5f.jpg"><br><br>  I suffered with the chan_cdma library for about 2 weeks, and during that time I stumbled upon the Huawei-1201 CDMA terminal and since I didn‚Äôt believe in an optimistic final with a modem.  Then I decided not to depend on the wires, the optical cable can also be stolen.  By this decided to organize a "plan B".  Purchase a Voip gateway with an FXO port, purchase a Huawei-1201, put a terminal on this port and it will all go through my Asterisk server.  Looked again at ads on the site, I came across <b>TP-Link TD-VG3631</b> .  After reading the Internet descriptions, I realized that this is exactly what I need.  2FXS port and 1 FXO.  Yes, and in my city for sale, I immediately decided to buy.  But after the purchase, having rummaged in the settings, I was very disappointed.  Since  firstly, it was possible to call on ‚ÄúFXO‚Äù only from internal phones, and secondly, for this it was necessary to use a ‚Äúprefix‚Äù.  And this is already a ‚Äúcrutch‚Äù in my system, since  then the call will bypass my PBX and not all houses will remember that to call, "now you need to dial additional numbers."  That is why it never came to the purchase of the terminal.  Another disappointment was that Tp-Link TD-VG3631 did not recognize SIP numbers, shorter than 3 digits.  Before that, my internal numbers were 11 and 22 respectively.  By that time, I had already repaired the line of Ukrtelecom and for this reason I decided to leave Tp-Link TD-VG3631, since he could redirect the incoming call to the FXO port to the SIP number. <br><br>  By that moment, I already had an AGI script for handling incoming calls, the algorithm for its work was as follows.  If the number is ringing for the first time, then we check to skip the call in any case and write the number in the phone book, if we have this number in the phone book and it is not on the black list - we skip the call, otherwise we‚Äôll drop it.  The phonebook database file decided to place it in the same place where the call detail file in / var / log / asterisk is located.  But here again disappointment awaited.  After reboot, this folder is cleared.  It was necessary in the Asterisk source in the file cdr_sqlite3_custom.c to change the path to the location of the master.db file to / www /.  I will also say that the res_agi.ipk package does not work out of the box and requires res_speech.so to work.  Then I tried to manually slip this file from the OpenWRT build folder into the / var / lib / asterisk / modules directory and it all worked. <br><br>  The next change in the incoming call processing file, the number was checked and if it corresponded to my second private number, then the list of the last 5 incoming numbers was sent to it first, with the time they called, and only then the call was made to the internal numbers.  This is the code itself. <br><br><div class="spoiler">  <b class="spoiler_title">in.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/php-cgi -q &lt;?php class MyDB extends SQLite3 { function __construct($filename) { $this-&gt;path = "/www/"; $this-&gt;filename = $filename; if(!file_exists($this-&gt;path.$filename) &amp;&amp; $filename == 'phonebook.db'){ $this-&gt;create_phonebook_db(); }else{ $this-&gt;open($this-&gt;path.$filename); } } public function doit($sql) { $result = $this-&gt;query($sql); $row = array(); $i=0; while($res = $result-&gt;fetchArray(SQLITE3_ASSOC)){ $row[$i] = $res; $i++; } return $row; } private function create_phonebook_db() { $this-&gt;open($this-&gt;path.'phonebook.db'); $sql="CREATE TABLE phonebook( id INTEGER PRIMARY KEY AUTOINCREMENT, phone_num TEXT, name TEXT, blacklist INTEGER, last_call DATATIME )"; $this-&gt;query($sql); $sql="CREATE TABLE sms( id INTEGER PRIMARY KEY AUTOINCREMENT, phone_num TEXT, sms_text TEXT, sms_time DATATIME )"; $this-&gt;query($sql); $sql="CREATE TABLE ussd( id INTEGER PRIMARY KEY AUTOINCREMENT, phone_num TEXT, sms_text TEXT, sms_time DATATIME )"; $this-&gt;query($sql); } } function show_date_from_base($date) { $time = strtotime($date); $time+=7200; return date('dmY  H:i:s',$time); } set_time_limit(0); require('phpagi.php'); #       AGI $agi = new AGI(); $db = new MyDB('phonebook.db'); $now = date('Ymd H:i:s'); $cid = $agi-&gt;request['agi_callerid']; if(substr($cid,0,1) == "+") $cid = substr($cid,1); // + if(strlen($cid) &gt; 10 &amp;&amp; substr($cid,0,3) == "380") $cid = substr($cid,2); // 380  0 $agi-&gt;set_variable("CDR(call_num)", $cid); if($cid == "XXXXXX"){ //Zadarma $db_cdr = new MyDB('master.db'); $sql="select * from cdr where call_num != 'sms_ussd' AND channel NOT LIKE '%ussd%' AND dist = 'in' GROUP BY call_num ORDER BY calldate DESC LIMIT 0,5"; $calls = $db_cdr-&gt;doit($sql); $agi-&gt;answer(); $agi-&gt;send_text("_____________\n"); $agi-&gt;send_text("_____________\n"); for($n = 0; $n &lt; count($calls);$n++){ $agi-&gt;send_text($calls[$n]['call_num']."\n"); $agi-&gt;send_text(" ".show_date_from_base($calls[$n]['calldate'])."\n"); } $agi-&gt;wait_for_digit(10000); } $sql="select * from phonebook where phone_num = '".$cid."'"; $book = $db-&gt;doit($sql); if(count($book) == 0) { $agi-&gt;exec_dial("SIP/221&amp;SIP/222&amp;SIP/33"); #     $agi-&gt;hangup(); #   if(trim($cid)!=""){ $sql="insert into phonebook( phone_num, name, blacklist, last_call) VALUES ('".$cid."', '', '0', '".$now."')"; $db-&gt;exec($sql); } }else{ if($book[0]['blacklist'] == 0) { $agi-&gt;exec_dial("SIP/221&amp;SIP/222&amp;SIP/33"); #     $agi-&gt;hangup(); #   if(trim($cid)!=""){ $sql="UPDATE phonebook SET last_call = '".$now."' where phone_num = '".$cid."'"; $db-&gt;exec($sql); } }else{ $agi-&gt;hangup(); #   if(trim($cid)!=""){ $sql="UPDATE phonebook SET last_call = '".$now."' where phone_num = '".$cid."'"; $db-&gt;exec($sql); } } } ?&gt;</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">extensions.conf</b> <div class="spoiler_text">  [globals] <br><br>  RECDIR = / var / spool / asterisk / monitor <br>  SAVEMP3DIR = / www / light / monitor <br><br>  [dongle-incoming-sms] <br><br>  exten =&gt; sms, 1, Noop (Incoming SMS from $ {CALLERID (num)} $ {BASE64_DECODE ($ {SMS_BASE64})} - $ {SMS}) <br>  exten =&gt; sms, n, Set (CDR (call_num) = sms_ussd) <br>  exten =&gt; sms, n, AGI (sms.php, $ {CALLERID (num)}, $ {SMS}) <br>  exten =&gt; sms, n, hangup () <br><br>  [dongle-incoming-ussd] <br><br>  exten =&gt; ussd, 1, Noop (Incoming USSD: $ {BASE64_DECODE ($ {USSD_BASE64})}) <br>  exten =&gt; ussd, n, Set (CDR (call_num) = sms_ussd) <br>  exten =&gt; ussd, n, AGI (ussd.php, ussd, $ {USSD}) <br>  exten =&gt; ussd, n, hangup () <br><br>  [all-in] <br><br>  include =&gt; dongle-incoming-sms <br>  include =&gt; dongle-incoming-ussd <br><br>  exten =&gt; X., 1, Set (MON_FILE = $ {UNIQUEID} - $ {STRFTIME ($ {EPOCH} ,,% Y-% m-% d-% H% M)} - $ {CALLERID (num)} - $ {CDR (dst)}) <br>  exten =&gt; _X., 2, Set (CDR (userfield) = $ {MON_FILE}); <br>  exten =&gt; _X., 3, Set (CDR (call_num) = $ {CALLERID (num)}) <br>  exten =&gt; _X., 4, Set (CDR (dist) = in) <br>  exten =&gt; _X., 5, MixMonitor ($ {MON_FILE} .wav) <br>  exten =&gt; _X., 6, AGI (in.php);  sent to the internal number <br>  exten =&gt; _X., 7, Hangup () <br>  exten =&gt; _X., 8, StopMixMonitor () <br><br>  exten =&gt; + X., 1, Set (MON_FILE = $ {UNIQUEID} - $ {STRFTIME ($ {EPOCH} ,,% Y-% m-% d-% H% M)} - $ {CALLERID (num) } - $ {CDR (dst)}) <br>  exten =&gt; _ + X., 2, Set (CDR (userfield) = $ {MON_FILE}); <br>  exten =&gt; _ + X., 3, Set (CDR (call_num) = $ {CALLERID (num)}) <br>  exten =&gt; _ + X., 4, Set (CDR (dist) = in) <br>  exten =&gt; _ + X., 5, MixMonitor ($ {MON_FILE} .wav) <br>  exten =&gt; _ + X., 6, AGI (in.php);  sent to the internal number <br>  exten =&gt; _ + X., 7, Hangup () <br>  exten =&gt; _ + X., 8, StopMixMonitor () <br><br>  exten =&gt; h, 1, System (/ usr / bin / lame -b 16 -silent $ {RECDIR} / $ {MON_FILE} .wav $ {SAVEMP3DIR} / $ {MON_FILE} .mp3&gt; / var / log / asterisk / wav_2_mp3.log) <br>  exten =&gt; h, n, System (/ bin / rm -r $ {RECDIR} / $ {MON_FILE} .wav) <br></div></div><br>  Well, to display statistics, he snapped up a web-interface on calls.  This is how it looks.  And put it in the folder / www / light /. <br><br><img src="https://habrastorage.org/files/f63/02c/bbd/f6302cbbd612448dbdb011928f50449d.png" alt="image"><br><br>  ‚Üí <a href="https://github.com/superl3n1n/asterisk-cdr-light">Link to githab web interface statistics</a> <br><br>  ‚Üí <a href="https://github.com/superl3n1n/asterisk-chan-cdma-gsm-dongle">Link to githab chan_dongle with support for CDMA modems ZTE AC8700 / 8710.</a> <br><br>  Makefile to compile in the latest version of OpenWRT (you must replace the native Makefile in the folder /package/feeds/telephony/asterisk-11.x-chan-dongle, leave all patches as is). <br><br><div class="spoiler">  <b class="spoiler_title">Makefile</b> <div class="spoiler_text">  # <br>  # Copyright ¬© 2013 OpenWrt.org <br>  # <br>  # This is a free software licensed under the GNU General Public License v2. <br>  # See / LICENSE for more information. <br>  # <br><br>  include $ (TOPDIR) /rules.mk <br><br>  PKG_NAME: = asterisk11-chan-dongle <br>  PKG_VERSION: = 1.1r35 <br>  PKG_REV: = ff0a798b8f73b71af328c53862fd33ec5fe9ce85 <br>  PKG_RELEASE: = 6 <br><br>  PKG_SOURCE_SUBDIR: = asterisk11-chan-dongle - $ (PKG_VERSION) <br>  PKG_SOURCE: = $ (PKG_SOURCE_SUBDIR) .tar.gz <br>  PKG_SOURCE_URL: = https: //github.com/superl3n1n/asterisk-chan-cdma-gsm-dongle.git <br>  PKG_SOURCE_PROTO: = git <br>  PKG_SOURCE_VERSION: = $ (PKG_REV) <br><br>  PKG_BUILD_DIR = $ (BUILD_DIR) / $ (PKG_SOURCE_SUBDIR) <br><br>  PKG_FIXUP: = autoreconf <br><br>  PKG_LICENSE: = GPL-2.0 <br>  PKG_LICENSE_FILES: = COPYRIGHT.txt LICENSE.txt <br>  PKG_MAINTAINER: = Jiri Slachta &lt;jiri@slachta.eu&gt; <br><br>  include $ (INCLUDE_DIR) /package.mk <br><br>  define Package / asterisk11-chan-dongle <br>  SUBMENU: = Telephony <br>  SECTION: = net <br>  CATEGORY: = Network <br>  URL: = https: //code.google.com/p/asterisk-chan-dongle/ <br>  DEPENDS: = asterisk11 + libiconv-full + kmod-usb-acm + kmod-usb-serial + kmod-usb-serial-option + libusb-1.0 + usb-modeswitch <br>  TITLE: = Huawei UMTS 3G dongle support <br>  endef <br><br>  define Package / asterisk11-chan-dongle / description <br>  Asterisk channel driver for Huawei UMTS 3G dongle. <br>  endef <br><br>  MAKE_ARGS: = \ <br>  CC = "$ (TARGET_CC)" \ <br>  LD = "$ (TARGET_CC)" \ <br>  CFLAGS = "$ (TARGET_CFLAGS) -DASTERISK_VERSION_NUM = aks.a. asterisk-11 / include -DHAVE_CONFIG_H -I. -fPIC "\ <br>  LDFLAGS = "$ (TARGET_LDFLAGS) -L $ (STAGING_DIR) / usr / lib / libiconv-full / lib -liconv" \ <br>  DESTDIR = "$ (PKG_INSTALL_DIR) / usr / lib / asterisk / modules" <br><br>  CONFIGURE_VARS + = \ <br>  ac_cv_type_size_t = yes \ <br>  ac_cv_type_ssize_t = yes <br><br>  define Build / Configure <br>  $ (call Build / Configure / Default, \ <br>  --with-asterisk = $ (STAGING_DIR) / usr / include / asterisk-11 / include \ <br>  $ (MAKE_ARGS) \ <br>  ) <br>  endef <br><br>  define Build / Compile <br>  mkdir -p $ (PKG_INSTALL_DIR) / usr / lib / asterisk / modules <br>  $ (MAKE) -C "$ (PKG_BUILD_DIR)" $ (MAKE_ARGS) all install <br>  endef <br><br>  define Package / asterisk11-chan-dongle / conffiles <br>  /etc/asterisk/dongle.conf <br>  endef <br><br>  define Package / asterisk11-chan-dongle / install <br>  $ (INSTALL_DIR) $ (1) / etc / asterisk <br>  $ (INSTALL_DATA) $ (PKG_BUILD_DIR) /etc/dongle.conf $ (1) / etc / asterisk / <br>  $ (INSTALL_DIR) $ (1) / usr / lib / asterisk / modules <br>  $ (INSTALL_BIN) $ (PKG_INSTALL_DIR) /usr/lib/asterisk/modules/chan_dongle.so $ (1) / usr / lib / asterisk / modules / <br>  endef <br><br>  $ (eval $ (call BuildPackage, asterisk11-chan-dongle)) <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/318368/">https://habr.com/ru/post/318368/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318354/index.html">Release Python 3.6 - yes, now it‚Äôs with us</a></li>
<li><a href="../318358/index.html">Brochure about Ecto - an interface for working with databases on Elixir</a></li>
<li><a href="../318362/index.html">How will your personal data be sold to a startup, in which he invested 70m rubles of IIDF</a></li>
<li><a href="../318364/index.html">Developing a game for Android on Unity 5. From idea to monetization. Part 2 (Live)</a></li>
<li><a href="../318366/index.html">Creating an editor quests and dialogues for the Unreal engine, Part 1 plugin description</a></li>
<li><a href="../318370/index.html">Office 2 - Search Approach</a></li>
<li><a href="../318372/index.html">VulnHub: Parsing the DC416 by Dick Dastardly</a></li>
<li><a href="../318374/index.html">Competitiveness: Parallelism</a></li>
<li><a href="../318376/index.html">Console to the masses. Go to the bright side. Part two</a></li>
<li><a href="../318380/index.html">Family business in IT. How we sold our startup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>