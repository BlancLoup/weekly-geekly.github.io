<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SQL Server Integration Services (SSIS) for Beginners - Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="→ Part 1 
 → Part 3 

 In this part, we will change the loading logic of the Products directory: 



1. With the help of the “Union All” component we ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SQL Server Integration Services (SSIS) for Beginners - Part 2</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/web/128/5b7/4dc/1285b74dc03b4bd48c84d1894b2c5812.png"></div><br>  → <a href="https://habrahabr.ru/post/330618/">Part 1</a> <br>  → <a href="https://habrahabr.ru/post/330840/">Part 3</a> <br><br>  In this part, we will change the loading logic of the Products directory: <br><br><ol><li>  With the help of the “Union All” component we combine two incoming flows into one; </li><li>  For new records we will do an insert, and for records that have already been added we will do an update.  To separate the records to be added and updated, we use the Lookup component; </li><li>  To update the records, use the component "OLE DB Command". </li></ol><br>  At the end of this part, we consider the Multicast component in order to parallelize the outgoing set. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Total in this part we will get acquainted with four new components: Union All, Lookup, OLE DB Command and Multicast. <br><br>  <b>Further, there will also be a lot of pictures.</b> <a name="habracut"></a><br><br><h2>  Continuing with SSIS </h2><br>  Create a new package: <br><br><img src="https://habrastorage.org/web/4cb/0e2/3d4/4cb0e23d47fa4a708d3a329ffeb8a0a0.png"><br><br>  And rename it to " <b>LoadProducts_ver2.dtsx</b> ": <br><br><img src="https://habrastorage.org/web/050/5ea/df0/0505eadf06ec47a99c30a2c1b417a621.png"><br><br>  In the “Control Flow” area, create a “Data Flow Task”: <br><br><img src="https://habrastorage.org/web/c6c/e16/000/c6ce1600036d4f4b83bd6023c2e09f82.png"><br><br>  Double click on the element “Data Flow Task” we will go to its “Data Flow” area.  Create two Source Assistant elements for the SourceA and SourceB connections.  Rename these elements to “Source A” and “Source B”, respectively: <br><br><img src="https://habrastorage.org/web/9d4/7de/806/9d47de806a554140be124330415e522c.png"><br><br>  “Source A” is set up as follows: <br><br><img src="https://habrastorage.org/web/5c7/c4d/68b/5c7c4d68b22d4c8a9843877943d3dcdc.png"><br><br>  Request text: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> SourceProductID, Title, Price <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Products</code> </pre> <br>  <b>In order to demonstrate great features at a time, here I deliberately released SourceID.</b> <br><br>  “Source B” is set up as follows: <br><br><img src="https://habrastorage.org/web/b47/7e3/2a6/b477e32a621143a4904f4e9c5ac4b9a2.png"><br>  Request text: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> SourceProductID, <span class="hljs-string"><span class="hljs-string">'B'</span></span> SourceID, Title, Price <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Products</code> </pre> <br>  <b>As a result, set A will have 3 columns [SourceProductID, Title, Price], and set B will have 4 columns [SourceProductID, SourceID, Title, Price].</b> <br><br>  Use the “ <b>Union All</b> ” element to combine data from 2 sets into one.  Let's send blue arrows from Source A and Source B to it: <br><br><img src="https://habrastorage.org/web/ded/79b/8ec/ded79b8ec1134332b2f5b007e6039846.png"><br><br>  How the mapping of the columns of two incoming sets is done can be seen by double clicking on the “Union All” element: <br><br><img src="https://habrastorage.org/web/413/32a/254/41332a2545cc4076bb99d2d4a219d2f1.png"><br><br>  As we can see, automatic matching of columns has been made here whose names are the same.  If necessary, we can make our own mapping, for example, add a SourceID column from the second set: <br><br><img src="https://habrastorage.org/web/611/c4e/02c/611c4e02ce714acdbfe4d56e606592b3.png"><br><br>  In this case, the SourceID of the Source A set will be NULL. <br><br><blockquote>  The union of the two sets in this case is done on the SSIS side.  Here you should pay attention to the fact that the source databases and the host database can be located on different servers / instances of SQL Server, for this reason we cannot always write a SQL query using tables from different databases using SQL-operation UNION or JOIN (which could be used instead of the Lookup described below). </blockquote><br>  In order to replace the NULL values ​​with “A”, we will use the “Derived Column” component to which we will direct the flow from “Union All”: <br><br><img src="https://habrastorage.org/web/44e/55a/b2f/44e55ab2fbf64fb9837976744679f61c.png"><br><br>  Double-click into the editor "Derived Column" and configure it as follows: <br><img src="https://habrastorage.org/web/6be/de9/802/6bede980294248efb1b18f2c7efc28eb.png"><br><br>  Let's do the following (mouse to help): <br><br><ol><li>  We indicate in “Derived Column” the value of “Replace 'SourceID'” - this will mean that we replace the old SourceID column with a new one; </li><li>  Drag the REPLACENULL function to the Expression area; </li><li>  Drag the SourceID column to the first argument of the REPLACENULL function; </li><li>  As a second argument, write the constant “A”. </li></ol><br>  In order to understand what happened to the data after passing through “Union All”, make “Enable Data Viewer” for the arrow going from “Union All” to “Derived Column”: <br><br><img src="https://habrastorage.org/web/2fc/9a4/a03/2fc9a4a032f7482fb538ffcfc0d50891.png"><br><br>  Now when you run the package for execution, you can see the set that resulted from: <br><br><img src="https://habrastorage.org/web/4b6/fcb/7fe/4b6fcb7fe2fa4c589890bd15cf498158.png"><br>  <i>Here you can see that at this stage (before Derived Column) in the SourceID column for the rows of the first set are NULL values.</i> <br><br>  In order to determine whether an entry has been added to the DemoSSIS_Target database, we will use the <b>Lookup</b> component: <br><br><img src="https://habrastorage.org/web/fe6/c34/4ff/fe6c344ffd7e4e66b466e589c110bc6c.png"><br><br>  Double-click on it to configure this item: <br><br><img src="https://habrastorage.org/web/de6/80d/20c/de680d20ceb24bc9a1ecc1c79e3f03e1.png"><br><br>  Here we will say that those lines for which no match was found, we will redirect to the stream “no match output”.  In this case, the output we get 2 sets of “ <b>Lookup Match Output</b> ” and “ <b>Lookup No Match Output</b> ”. <br><blockquote>  For example, if you set the value “Ignore failure”, then in the rows for which there was no match in the TargetID field (see below) the value NULL will be written and all the rows will be returned through one set of “ <b>Match Match</b> ”. </blockquote><br>  “Full cache” says that the set that will be used as a reference by one SQL query (see the next tab) will be fully loaded into memory and the strings will be mapped to the cache without repeated calls to SQL Server. <br><br><blockquote>  If you select “Partial cache” or “No cache”, then on the Advanced tab you can write a query with parameters that will be executed to match each row of the incoming set.  For interest, you can play around with this property and through SQL Server Profiler to see which queries will be formed when the package is executed. </blockquote><br>  On the next tab, we need to define a set that will act as a directory: <br><br><img src="https://habrastorage.org/web/d6b/def/755/d6bdef755298458286f536f6b4f372a5.png"><br><br>  I have registered a request here: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> SourceID, SourceProductID, <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> TargetID <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Products</code> </pre><br>  On the next tab, you need to specify by what fields a search is performed in the directory and which columns from the directory should be added to the output set (if necessary): <br><br><img src="https://habrastorage.org/web/d45/8dd/240/d458dd24052d4a5aad5b8ca28f76a8cb.png"><br><br>  To define the connection, use the mouse to drag the SourceProductID field to SourceProductID and the SourceID field to SourceID. <br><br>  Add the “Destination Assistant” component to insert records from the “Lookup No Match Output” stream: <br><br><img src="https://habrastorage.org/web/c78/d6d/4d4/c78d6d4d4e1b4e398d359f1732039dd6.png"><br><br>  Drag the blue arrow from “Lookup” to “OLE DB Destination” and in the dialog box select the stream “Lookup No Match Output”: <br><br><img src="https://habrastorage.org/web/6a8/52f/41b/6a852f41b0854fb884aba31154a434ab.png"><br><br>  As a result, we get the following: <br><br><img src="https://habrastorage.org/web/47c/a50/164/47ca501645f64e378a28d3eb261ef05e.png"><br><br>  Double-clicking on "OLE DB Destination" will configure it: <br><br><img src="https://habrastorage.org/web/c4b/932/9a0/c4b9329a0dd649cd977e35c1a2005f94.png"><br><br><img src="https://habrastorage.org/web/995/43d/047/99543d0473f1452691fe7d17d354f7bf.png"><br><br>  <b>We have done the insertion processing for new records.</b> <br><br>  Now, to update previously inserted records, we will use the “OLE DB Command” component and transfer the blue arrow from the Lookup to it: <br><br><img src="https://habrastorage.org/web/736/432/fc5/736432fc5f8146ec9a8df49a05d4dffb.png"><br><br>  The “Lookup Match Output” stream will be automatically sent to this component since  we already chose the “Lookup No Match Output” stream: <br><br><img src="https://habrastorage.org/web/a04/9cd/171/a049cd1713aa4ac091a4b398bde8be95.png"><br><br>  Double click on “OLE DB Command” and configure it: <br><br><img src="https://habrastorage.org/web/e20/6c1/9b2/e206c19b23064e3789ed318576aa0200.png"><br><br><img src="https://habrastorage.org/web/25d/7ca/868/25d7ca868df444219974c40d9f54d616.png"><br><br>  Let's write the following update request: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> Products <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> Title=?, Price=? <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>=?</code> </pre><br>  On the next tab, we will indicate how the parameters will be set based on the data of the rows of the incoming “Lookup Match Output” set: <br><br><img src="https://habrastorage.org/web/fd3/25a/760/fd325a760af64b78a879f18b078425b4.png"><br><br>  Through SSMS we will add new products to the base DemoSSIS_SourceB: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> DemoSSIS_SourceB <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-comment"><span class="hljs-comment">--    SET IDENTITY_INSERT Products ON INSERT Products(ID,Title,Price)VALUES (6,N'',NULL), (7,N'',NULL), (8,N' ',NULL) SET IDENTITY_INSERT Products OFF GO</span></span></code> </pre> <br>  In order to track how the data has changed, you can, in order to launch the package for execution, in the necessary places, make the “Enable Data Viewer”: <br><br><img src="https://habrastorage.org/web/977/62d/1f5/97762d1f51b74536a7e0b02faef7ccba.png"><br><br>  Run the package for execution: <br><br><img src="https://habrastorage.org/web/3f5/9dc/93e/3f59dc93e341430aa4740f152385c908.png"><br><br>  As a result, we should see that 3 lines were inserted using the “OLE DB Destination” component and 10 lines were updated using the “OLE DB Command” component. <br><br>  The query specified in the “OLE DB Command” was executed for each row of the incoming set, i.e.  in this example 10 times. <br><br>  In "OLE DB Command" you can write more complex logic in TSQL, for example, to check whether the Title or Price have been changed, and to update the corresponding line only if one of the values ​​is different. <br><br>  For clarity, we will add a new column to the Products table in the DemoSSIS_Target database: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> DemoSSIS_Target <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> Products <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> UpdatedOn datetime <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span></code> </pre><br>  Let's now write the following command: <br><br><img src="https://habrastorage.org/web/b4c/80c/e53/b4c80ce53dbb4b1a815b4f59122fd0f2.png"><br><br>  Command text: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @TargetID <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>=? <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @Title <span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>(<span class="hljs-number"><span class="hljs-number">50</span></span>)=? <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> @Price money=? <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> Title,Price <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Products <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>=@TargetID <span class="hljs-keyword"><span class="hljs-keyword">EXCEPT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @Title,@Price ) ) <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> Products <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> Title=@Title, Price=@Price, UpdatedOn=<span class="hljs-keyword"><span class="hljs-keyword">GETDATE</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>=@TargetID <span class="hljs-keyword"><span class="hljs-keyword">END</span></span></code> </pre> <br><blockquote>  It would also be possible to arrange all of this in the form of a stored procedure, and here you can register it through the “EXEC ProcName?,?,?” Call.  Here, I think, as it is more convenient for someone, it is sometimes more convenient for me that everything is written in one place, i.e.  in the SSIS project.  But if we use the procedure, we also get our convenience, in this case it is possible, it would be easy to change the procedure and avoid reworking and redeploying the SSIS project. </blockquote><br>  After that, we will redefine the binding of parameters according to their order in the command text: <br><br><img src="https://habrastorage.org/web/339/74f/a87/33974fa870fc4535b0e6b1ef959e68e7.png"><br><br>  Let's make an update in the DemoSSIS_SourceA database: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> DemoSSIS_SourceA <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> Products <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> Price=<span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-comment"><span class="hljs-comment">-- </span></span></code> </pre><br>  And again we will start the project on performance.  As a result, after the next launch of the package for execution, UPDATE should be executed only once, only for this record. <br><br><img src="https://habrastorage.org/web/a02/391/9bd/a023919bd093437ead0053eb7bf1e6df.png"><br><br>  After executing the package, check it with the query: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> DemoSSIS_Target <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Products <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> UpdatedOn <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span></code> </pre><br><img src="https://habrastorage.org/web/73e/3f2/3a9/73e3f23a98aa4a5a8b911bedc07cba5c.png"><br><br>  Within this part, we will also consider the <b>Multicast</b> component.  This component allows you to get several from one stream.  This can be useful when the same data needs to be recorded in two or more different places - i.e.  One set comes in, and we get as many copies as we need, and with each copy of this set we can do what we want. <br><br>  For example, let's create another LastAddedProducts table in the DemoSSIS_Target database: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> DemoSSIS_Target <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> LastAddedProducts( SourceID <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-comment"><span class="hljs-comment">--     SourceProductID int NOT NULL, -- ID   Title nvarchar(50) NOT NULL, Price money, CONSTRAINT PK_LastAddedProducts PRIMARY KEY(SourceID,SourceProductID), CONSTRAINT CK_LastAddedProducts_SourceID CHECK(SourceID IN('A','B')) ) GO</span></span></code> </pre><br>  To clear this table, add the “Execute SQL Task” component to the “Control Flow” area and write the “TRUNCATE TABLE LastAddedProducts” command in it: <br><br><img src="https://habrastorage.org/web/d5d/4d2/cf2/d5d4d2cf2b8a4e009ac7324095eb7da2.png"><br><br><img src="https://habrastorage.org/web/52a/d46/628/52ad46628604468f9d5ea71d81eae54b.png"><br><br>  Go to the “Data Flow” area of ​​the “Data Flow Task” component and add the component as follows: <br><br><img src="https://habrastorage.org/web/9f1/db2/88c/9f1db288c9d0477fae17a429fe7f2086.png"><br><br>  Pay attention to the yellow exclamation mark - this was due to the fact that we added a column of UpdatedOn and did not attach it.  Go to the item “OLE DB Destination”, go to the Mappings tab and leave it on the UpdatedOn column as the incoming Ignore field and click OK: <br><br><img src="https://habrastorage.org/web/5ed/f0c/edb/5edf0cedbbb24c979704dbfb1c780ae7.png"><br><br>  Create another “OLE DB Destination” element and drag the second blue arrow from the Multicast element onto it: <br><br><img src="https://habrastorage.org/web/213/d5a/35c/213d5a35ca6f43e3a72ad7b9a0c731de.png"><br><br>  Rename for clarity: <br><br><img src="https://habrastorage.org/web/df6/d85/2d5/df6d852d5ba1443da41246c4e39cf2dd.png"><br><br>  Set up "To LastAddedProducts": <br><br><img src="https://habrastorage.org/web/64e/58a/76d/64e58a76d51b4a2586b62c89314a286c.png"><br><br><img src="https://habrastorage.org/web/19c/52b/949/19c52b949f6945308bccb701ebe28933.png"><br><br>  Delete the last three records inserted via SSMS: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> DemoSSIS_Target <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> Products <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> SourceID=<span class="hljs-string"><span class="hljs-string">'B'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> SourceProductID&gt;=<span class="hljs-number"><span class="hljs-number">6</span></span></code> </pre> <br>  And run the package for execution: <br><br><img src="https://habrastorage.org/web/007/b09/6ba/007b096baca946f8a9cbac7887a6d451.png"><br><br>  As a result, the addition occurred in 2 tables - Products and LastAddedProducts. <br><br><h2>  The conclusion of the second part </h2><br>  In this part, we looked at how to synchronize small directories.  Here, of course, the moment is not taken into account that the data in the sources can still be deleted, but if necessary, you can try to do it yourself, because  when deleting, sometimes additional factors need to be taken into account, for example, references from other tables can be deleted (in the next part we plan to do this). <br><blockquote>  In order not to violate referential integrity, sometimes an entry in the receiving table is logically deleted. For this purpose, for example, you can add a bit bit field (logical deletion flag) or a datetime string (date / time logical deletion) to this table. </blockquote><br><blockquote>  Sometimes, on the server on which the Target base is located, an auxiliary intermediate base is made (usually called Staging) and first of all the “raw” data from Source is loaded into it.  Since now Target and Staging are on the same server, the second step is to easily write a SQL query (for example, using the MERGE SQL construct or a query using the JOIN construct), which operates on sets of both these databases. </blockquote><br>  SSIS is quite an interesting tool, which in my opinion does not hurt to have in its arsenal, since in some cases it can greatly simplify the integration process.  But of course there are situations when weighing everything, it is wiser to write integration using other methods, for example, use Linked Servers and write procedures in pure TSQL or write your utility in some other programming language using all the power of OOP, etc. <br><br>  While studying the material, show more curiosity, for example, click on the tabs that I did not show, look and analyze information on them, click on the arrows, they also have their own properties and settings.  Experiment, with all that you find interesting, do not be lazy to make your own small test examples.  Change the scheme so that it leads to exceptions, choose more suitable parameters for the components trying to find the most suitable way out of the current situation. <br><br>  Thanks for attention!  Good luck! <br><br>  → <a href="https://habrahabr.ru/post/330840/">Part 3</a> </div><p>Source: <a href="https://habr.com/ru/post/330702/">https://habr.com/ru/post/330702/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330686/index.html">Tutorial: Creating a simple 2D game on Android</a></li>
<li><a href="../330690/index.html">Optimization of combinatorial algorithms</a></li>
<li><a href="../330692/index.html">Idiomatic Redux: Redo's Tao, Part 1 - Realization and Design</a></li>
<li><a href="../330694/index.html">The digest of fresh materials from the world of the frontend for the last week №266 (June 5 - 11, 2017)</a></li>
<li><a href="../330696/index.html">PHP Digest number 110 - the latest news, materials and tools (May 28 - June 11, 2017)</a></li>
<li><a href="../330704/index.html">Create your own custom Style plugin - Theming Views in Drupal 8</a></li>
<li><a href="../330706/index.html">Responsive Bar Charts with Bokeh, Flask and Python 3</a></li>
<li><a href="../330708/index.html">You are not google</a></li>
<li><a href="../330710/index.html">Copier RFID tags standard EM-Marin</a></li>
<li><a href="../330712/index.html">NNCP: online treatment and censorship of the store-and-forward method</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>