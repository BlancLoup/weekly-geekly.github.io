<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SOC for beginners. How to organize monitoring of incidents and response to attacks in the 24x7 mode</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue the cycle of our articles ‚ÄúSOC for beginners‚Äù. Last time we talked about how to implement Threat Intelligence in a company and not regret ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SOC for beginners. How to organize monitoring of incidents and response to attacks in the 24x7 mode</h1><div class="post__text post__text-html js-mediator-article">  We continue the cycle of our articles ‚ÄúSOC for beginners‚Äù.  Last time we talked about how to implement <a href="https://habrahabr.ru/company/solarsecurity/blog/343574/">Threat Intelligence</a> in a company and not regret it.  Today I would like to talk about how to organize processes to ensure continuous monitoring of incidents and rapid response to attacks. <br><br>  In the first half of 2017, the cumulative average daily flow of IS events processed by SIEM systems and used by Solar JSOC to provide service was <b>6.156 billion</b> .  Events with suspicion of the incident - an average of about <b>960 per day</b> .  Every sixth incident is <b>critical</b> .  At the same time, for our clients, including Tinkoff Bank, CTC Media or Pochta Bank, the issue of promptly informing about an attack and receiving recommendations on counteraction is very serious. <br><br>  We decided to tell how we solved this problem, what problems we encountered, and what method of work organization we use in the end. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/59/e7/1d/59e71dfc73a51846323425.jpeg"><br><a name="habracut"></a><br><h3>  Team building <br></h3><br>  It is obvious that for successful incident management it is necessary to create something like dispatching service, which will coordinate the elimination of incidents and serve as a single point of contact with the customer. <br><br>  In order to delineate responsibilities and responsibilities within the service, we have divided it into several levels, which over time have been scaled in accordance with the new tasks.  After numerous attempts and approaches to the projectile, we got the following picture: <br><br><img src="https://habrastorage.org/webt/vl/9h/gj/vl9hgjoi9n4o3qtsggmgyhqikmi.png"><br><br>  The first line of Solar JSOC is monitoring engineers who are responsible for the timely response to the incident and its analysis, filtering false positives, as well as for preparing an analytical report on all typed incidents.  Timely reaction is considered to meet the requirements of the SLA.  The first line works in shifts to ensure the response and analysis of incidents in 24x7 mode. <br><br>  The second line is response engineers, specialists in specific products and areas of information security, on whom atypical incidents fall according to their area of ‚Äã‚Äãexpertise. <br><br>  Usually, the Service Desk has an ‚Äúinverted pyramid‚Äù structure, and, as you see, we have an hourglass.  The fact is that a somewhat atypical story has arisen with the third line.  The third line consists of analysts assigned to specific customers and possessing the most complete information on their infrastructure and internal processes.  Escalation on them occurs in the following situations: <br><br><ul><li>  Analysis of anomalous activities to identify incidents. </li><li>  Response to atypical critical incidents of their customers. </li><li>  Participation in the investigation of IS incidents not recorded by monitoring. </li><li>  Also, analysts are engaged in technical survey, connection and adaptation of source settings. </li></ul><br>  To ensure monitoring 24x7 at night, weekends and holidays, an on-duty analyst is allocated.  So, it turned out that with an increase in the number of customers and scaling of the service, the need for analysts in the first place increases. <br><br>  The team of specialists in forensics and reverse engineering of malware stands apart.  They are connected if the incident is associated with a virus infection or penetration attack. <br><br>  To remain effective, the service of the monitoring center must constantly evolve.  For example, the quality of monitoring is highly dependent on the content of the SIEM system, so it is necessary to constantly develop new scenarios for identifying incidents and optimize existing ones.  In addition, it is necessary to stay abreast of new technologies and evaluate the possible benefits from their use within the service.  For example, a retrospective analysis of indicators of compromise by means of SIEM takes too much time, and you need to find a tool that will perform this task faster.  We have created a separate group, which consists of three people and deals exclusively with the development of the service. <br><br>  It is important to clarify that the content needs to be adapted for each Customer: tune the rules to reduce the number of false positives, build a connection profile for a new segment, etc.  The selected group cannot cope with such a scope of work, therefore we have appointed analysts from the third line to perform this task, who have thoroughly studied the characteristics of their customers and know where and what they have pain. <br><br>  Having dealt with the internal structure, we began to build processes of interaction with customers in addition to communications as part of the investigation of incidents.  In other words, it was necessary to build SLA management, which would allow to control the level of service and customer satisfaction.  At this stage, the role of another group of specialists arose - service managers who are involved in monitoring the parameters of the quality of services prescribed in the contract.  These parameters must always be measurable, that is, representable in the form of numeric metrics. <br><br>  Here are the metrics for monitoring the quality of the monitoring service we chose: <br><br><ul><li>  The reaction time to the incident from the moment of its fixation is the time elapsed from the moment of the receipt and registration of the request until the beginning of work.  This indicator reflects how quickly we commit to process the flow of incoming alerts.  In our case, this is 20 minutes for critical incidents. </li><li>  The time of analysis and preparation of analytical information on the incident is the time elapsed from the moment of the actual beginning of work on the problem until the closing of the application.  Everything is simple - the customer must understand how quickly we will be able to analyze the situation and give recommendations on counteraction.  Our SLA implies that this time should not exceed 60 minutes for an ordinary incident and 40 for a critical incident. </li></ul><br>  In addition to directly monitoring the incidents, the process of providing services revealed two quite frequent activities - connecting a new event source and launching / refining the incident detection scenario.  To put these operations under control, we have introduced two new metrics: <br><br><ul><li>  The execution time for the connection of new typical sources.  Our standard is 24 hours. </li><li>  Execution time for script rework.  In accordance with SLA, we have to solve this problem in 72 hours. </li></ul><br>  Well, the last metric concerns the availability of the service.  To simplify the control, we have combined the set of accessibility indicators of all the technical means involved in the provision of the service into one - the accessibility of the platform. <br><br>  Let's see what kind of team we finally got together: <br><br><img src="https://habrastorage.org/webt/mv/8k/2a/mv8k2ahkqkzbry0f78qnob2xqse.png"><br><img src="https://habrastorage.org/webt/r_/nc/ns/r_ncnsch1wkcq4l_mt-ktorfv-i.png"><br><img src="https://habrastorage.org/webt/ku/ql/yt/kuqlytyq5hsxnacjbeu23atw8hg.png"><br><img src="https://habrastorage.org/webt/ox/mh/mm/oxmhmm7fe-gnopiw-itqtbboz68.png"><br><img src="https://habrastorage.org/webt/pd/8v/rk/pd8vrksc5k0btvmfuys2d6wr8nq.png"><br><br><h3>  First problems <br></h3><br>  It would seem that the processes were regulated, the roles are painted, the interaction is established, it is time to fight.  But, having started the service and connected the first customers, we began to face a shaft of problems.  As the entire flow of incidents falls first on the first line, difficulties began to manifest themselves with it. <br><br>  The first line in any case has a qualification lower than the others and operates 24x7.  In such circumstances, there is always the risk of error: for example, closing a combat incident as false positive.  If this leads to serious consequences for the customer, no one will look for the culprit, and reputational damage will fall on the whole team. <br><br>  Hence the important question: how to control the quality of case analysis and analysis?  If you want to simplify your life, the specialist can choose the incident easier or closer to the topic in which he understands better.  With this approach, an ‚Äúundesired‚Äù incident may appear that no one wants to take, and it will slowly float over the SLA boundaries, become overdue, or even not be disassembled. <br><br>  The following risk applies only to commercial monitoring centers.  The operator is forced to process a continuous stream of alerts coming from a large number of customers, and may in the confusion send an answer to the wrong address.  What consequences, I think, it is not required to explain. <br><br>  What to do if the load has increased, and the first line begins to sink under the flow of incidents? <br><br>  Well, let's start in order: <br><br>  To facilitate the work of the first line, we have developed detailed instructions and rules for handling all typical incidents.  The instructions describe: <br><br><img align="left" src="https://habrastorage.org/webt/hj/kl/j_/hjklj_i1azybmittjvq60ab9i9a.png"><ul><li>  Basic information on the incident (target, event sources, name). </li><li>  Trigger logic. </li><li>  Signs of false positives. </li><li>  Possible consequences of the incident. </li><li>  Recommendations on counteraction, etc. </li></ul><br>  The instructions greatly help the engineer to comply with the incident SLA and quickly make a decision about whether to escalate the case further or can be managed on its own. <br><br>  To solve the problem of monitoring the work of the first line, we have developed a system for evaluating waste cases, which includes more than a dozen categories.  For example, informational content of the alert, correctness of the analysis and filling of the incident card, etc. <br><br>  The duties of each third-line analyst include a weekly review of several dozen incidents that have been disassembled by the first line.  Based on the results of the review, the analyst may comment on the development of the above categories.  To make the review as useful as possible, we have developed clear criteria for the selection of cases: <br><br><ul><li>  High criticality incidents. </li><li>  Incidents involving critical sources (for example, the banking arm of the CBD and similar highly critical workstations). </li><li>  Profiling incidents (if not included in the first two categories). </li><li>  Triggered by Threat Intelligence feeds. </li><li>  New incident scenarios (less than 1 month since the launch into the first line). </li></ul><br>  A short review might look like this: <br><br><img src="https://habrastorage.org/webt/6p/7e/-q/6p7e-qfuewpdnbapetgr24dkezw.png"><br><br>  The results of the evaluations are taken into account in the motivational scheme of the first line both in a positive and in a negative direction.  Such a solution to the problem, of course, is very costly.  However, for us this is the best option, because  the consequences of a missed incident will cost us much more.  Also, public debriefings of improperly processed incidents are practiced so that the mistakes made do not recur. <br><br>  To avoid the temptation to choose an easier incident, we deprived the engineers of the first line of the opportunity to choose a case for analysis.  The scoring system decides for it, which distributes each incident into one of three zones: green, yellow or red.  The distribution takes into account 5 indicators: <br><br><img src="https://habrastorage.org/webt/bz/zo/gh/bzzogh7tl6hffnqaafsmvjeee5q.png"><br><br>  As a result, the free engineer automatically receives the incident with the highest score. <br><br>  We minimized the risk of sending a response to the wrong address due to the fact that the operator does not work directly with e-mail.  To automate the monitoring service, we chose the Kayako HelpDesk system, adapted it to our specifics, integrated it with the mail, and put the monitoring service for it.  When sending a reply, pre-configured notification profiles are triggered, in which the routes to the respective customer‚Äôs specialists are registered.  In order to be able to analyze the incident, a ticket is attached to it in the console of the SIEM system. <br><br><img src="https://habrastorage.org/webt/i0/ae/o_/i0aeo_o1fzpm2rtev42yr1nwlvm.png"><br><br>  We predict the load, starting from the current shift load, the planned decision time and the flow density of incoming alerts.  Here we again use the distribution by zones: if a lot of ‚Äúred‚Äù incidents have accumulated, then it‚Äôs time to put out the fire with all available forces.  If necessary, specialists of the 2nd line, or in a critical situation, a duty analyst are connected to the primary case analysis. <br><br><h3>  What is the result <br></h3><br>  Of course, these are not all the problems that we encountered on our way, and not all of them we managed to solve them completely.  For example, here are a few ‚Äúhung‚Äù questions: what to do with the incident if the customer did not provide feedback on it?  Do I have to close it every other day or remain in unchanged condition before receiving a response?  What to do if the customer reported on the elimination of the incident, and a day later it arises again?  Or from the customer there is no feedback, and the incident occurs daily? <br><br>  But, nevertheless, the distance traveled and the results suggest that we have reached a fairly high level of maturity in the organization of processes. <br><br>  As a result, we will try to impose all the described roles and tasks on the RACI-matrix of the distribution of responsibility.  Immediately make a reservation that this table describes only a small piece of the tasks and responsibility of SOC (to be honest, it‚Äôs all too big and terrible to publish in the article): <br><br><img src="https://habrastorage.org/webt/lt/tq/-r/lttq-ru0fttbce4kdqlmtvqyvdg.png"><br><br><img src="https://habrastorage.org/webt/qv/mu/tu/qvmutueaaecpcy6lt3rbsuumt14.png"><br><br>  The construction of SOC is a long way, on which you can collect a lot of various rakes, even without going up to the technical aspects.  I hope I managed to point out some of them and suggest workarounds.  Unfortunately, I cannot guarantee that you will not encounter problems unique to you.  But, as we have repeatedly said, the road will be mastered by walking.  Well, prepare your forehead :). </div><p>Source: <a href="https://habr.com/ru/post/344632/">https://habr.com/ru/post/344632/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344622/index.html">Vivaldi Sync - first acquaintance</a></li>
<li><a href="../344624/index.html">HP leaves random keylogger in laptop keyboard driver</a></li>
<li><a href="../344626/index.html">We understand and work with gulp</a></li>
<li><a href="../344628/index.html">Veritas Access 7.3: pros, cons, pitfalls</a></li>
<li><a href="../344630/index.html">Tutorial on creating a tracker cryptocurrency for android on Kotlin</a></li>
<li><a href="../344634/index.html">ATOL Online Online Cash Desk Service: API and CMS Integration</a></li>
<li><a href="../344638/index.html">Corona SDK - Crush Crush Game</a></li>
<li><a href="../344640/index.html">Mail for Good: how the community of programmers helps NGOs</a></li>
<li><a href="../344642/index.html">Something is wrong with the IDS signature</a></li>
<li><a href="../344644/index.html">Dynamic sound on destructible levels of Rainbow Six: Siege</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>