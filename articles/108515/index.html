<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Removing dead code for beginners</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the translator: unfortunately, I didn‚Äôt wait for the next post to be translated from browser developers about IE9 vs SunSpider, I had to translat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Removing dead code for beginners</h1><div class="post__text post__text-html js-mediator-article">  <i>From the translator: unfortunately, I didn‚Äôt wait for the next post to be translated from browser developers about IE9 vs SunSpider, I had to translate myself.</i>  <i>Why one more?</i>  <i>Unlike the others ( <a href="http://habrahabr.ru/blogs/browsers/108313/">first</a> , <a href="http://habrahabr.ru/blogs/browsers/108355/">second</a> ), which gave only information for reflection, this one also gives practical knowledge - a description of the pitfalls that each developer may encounter when running his code in the new IE9.</i> <br><br><blockquote>  Dean Hachamovitch: One of the changes in our new JavaScript engine, code-named Chakra, is the <a href="http://ru.wikipedia.org/wiki/%25D0%25A3%25D0%25B4%25D0%25B0%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25BC%25D1%2591%25D1%2580%25D1%2582%25D0%25B2%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25BA%25D0%25BE%25D0%25B4%25D0%25B0">destruction of dead code</a> , in order to improve the performance of real sites.  <sup>[ <a href="http://habrahabr.ru/blogs/browsers/108355/">1</a> ]</sup> </blockquote><br><br>  Yesterday I sent a bug after a light analysis of the dead code removal algorithm in IE9.  After that, the IE9 team released a platform preview 7 and <a href="http://blogs.msdn.com/b/ie/archive/2010/11/17/html5-and-real-world-site-performance-seventh-ie9-platform-preview-available-for-developers.aspx">updated</a> its blog about IE. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Removing a dead code is a valid optimization, but very easily surface implementations can lead to unpredictable behavior and become a source of errors. <br><br><a name="habracut"></a><br>  Regarding the fragility of the algorithm implemented in IE9, our study showed that only the following operations can be optimized: -, +, ++, &lt;&lt;, + =, - =, and if (&gt;).  For example, if you change this comparison in <a href="http://habrahabr.ru/blogs/browsers/108313/">that test</a> : <br><br><pre>  if (TargetAngle&gt; CurrAngle) { </pre><br>  on <br><br><pre>  if (TargetAngle &lt;= CurrAngle) { </pre><br>  then IE9 will no longer delete this code.  It is curious that the developers of IE9 decided not to delete such resource-intensive operations as multiplication and division.  The set of operations chosen for optimization seems to coincide with that used in the math tests in SunSpider. <br><br>  As for reasonableness, several problems have already been found in implementing the removal of dead code in IE9.  One of our developers, Andreas Gal., Attracted my attention to the first one I touched on.  Dean on the IE blog gave this example: <br><br><blockquote>  In the following example, the code in the loop constantly overwrites the same variable (in <a href="http://ru.wikipedia.org/wiki/Computer_science">CS,</a> this is known as dead save), so this code can be simplified to one call. <br><br><pre> function func (a, b) {
    var x;
    var i = 300;
    while (i--) {
       x = a + b;  // dead store
    }
 }
</pre><br></blockquote><br>  I think with this example Dean tries to show that since x is constantly being overwritten, the JavaScript engine can perform only one iteration of the loop and save time, since all calls give the same value to x. <br><br>  This may be true for <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2582%25D0%25B0%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D1%2582%25D0%25B8%25D0%25BF%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">statically typed</a> languages ‚Äã‚Äãsuch as C #, but unfortunately this is not true for JavaScript. <br><br>  This function can be optimized if it is called as <br><br><pre>  func (1,2) </pre><br>  since there is no <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25B1%25D0%25BE%25D1%2587%25D0%25BD%25D1%258B%25D0%25B9_%25D1%258D%25D1%2584%25D1%2584%25D0%25B5%25D0%25BA%25D1%2582_(%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5)">side effect</a> .  However, if we call a function like this, then it cannot be optimized: <br><br><pre>  func (1, {valueOf: function () {alert ("Hi Dean!"); return 2;}}); </pre><br>  Here we pass the object as the second argument (b), and in it we declare the valueOf method, which will be called by the operation a + b.  Unexpected turn?  This dynamic side of the language makes it very difficult to optimize JavaScript, and the task of adding traditional compiler optimizations, such as removing dead code or deleting dead save, becomes anything but not trivial. <br><br>  IE9 Platform Preview # 7 does not handle this example from their blog correctly (you can <a href="http://people.mozilla.com/~sayrer/2010/dead/iedemo1.html">try</a> ).  If the function is called with an object that has its own implementation of the valueOf method, then IE9 does not mistakenly call this handler. <br><br>  Deep analysis of dead code in javascript is in fact very complex and requires a global analysis of the entire program.  The IE9 blog explained how local operations on <a href="http://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B8%25D1%2582%25D0%25B5%25D1%2580%25D0%25B0%25D0%25BB_(%25D0%25B8%25D0%25BD%25D1%2584%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D1%2582%25D0%25B8%25D0%25BA%25D0%25B0)">literals</a> for arrays can be simplified as dead code, since they do not have side effects.  Therefore, we can assume that the following call can be safely removed: <br><br><pre>  func (1, [1,2,3,4,5]) </pre><br>  The first argument is a constant and the array literal looks pretty safe.  Unfortunately, if the following code was executed in the program before this call, this deletion again becomes superficial: <br><br><pre>  Object.prototype.valueOf = function () {alert ("IE9 is fast!");  } </pre><br>  Here we override the valueOf handler for all objects, including literals, and therefore adding a + b will cause our implementation of valueOf.  And again, IE9 mistakenly misses a call to our handler, and defining this case is even more difficult than the previous one, because now the ‚Äúoptimization‚Äù can be affected by code in other files. <br><br>  The second problem of surface implementation, which I will describe, was noticed by Chris Leary, another developer from the Mozilla team.  The loop in the math test, which IE9 deletes like a dead code, works with the global variable "Angles".  We found that IE9 still removes the call for cordicsincos (), even when the definition of the variable "Angles" was removed from the source.  In this case, the correct behavior would be to throw a Reference Error exception, since Angles is not defined anywhere.  If you wish, try <a href="http://people.mozilla.com/~sayrer/2010/dead/iedemo2.html">this demo</a> to check the error.  In addition, you will find many more problems with the dead code removal algorithm in IE9, if you start using <a href="http://ajaxian.com/archives/ecmascript-5-changes-to-javascript">new ES5 features</a> such as getters for the Angles variable or the window object. <br><br>  The fact that the time of my post coincided with the release of IE9 PP7 is pure coincidence, and I am glad that all browsers are faster and faster to execute JavaScript.  But, as I said, I don‚Äôt think that the implementation of deleting dead code in IE9 can be considered a serious wide-area optimization.  It seems that it was not tested on anything, except for the SunSpider test. <br><br>  Obviously, I could have missed something, so even more information should appear on <a href="http://windowsteamblog.com/ie/b/ie/archive/2010/11/17/meet-the-chakra-team-live-on-twitter.aspx">Twitter Q &amp; A session</a> from the IE team tomorrow morning. <br><br>  <i>From the translator: in the comments to the <a href="http://blog.mozilla.com/rob-sayre/2010/11/17/dead-code-elimination-for-beginners/">original</a> are alternative and cheaper solutions to these problems instead of global analysis.</i>  <i>I hope the developers of IE9 will fix these problems, and the developers of SunSpider will add side effects to their tests.</i>  <i>Thanks to <a href="https://geektimes.ru/users/xpilot/" class="user_link">XPilot</a> for <a href="https://geektimes.ru/users/xpilot/" class="user_link">linking</a> to this wonderful analysis.</i> </div><p>Source: <a href="https://habr.com/ru/post/108515/">https://habr.com/ru/post/108515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../108508/index.html">Python Bug Weekend</a></li>
<li><a href="../108509/index.html">Javascript Password Generator</a></li>
<li><a href="../108510/index.html">Russian official translations of license descriptions have appeared on the official Commons website.</a></li>
<li><a href="../108511/index.html">How not to write documentation</a></li>
<li><a href="../108514/index.html">Two in one: spring-mobile & spring-android</a></li>
<li><a href="../108516/index.html">Do you use PHP on a 64-bit platform? So lost in performance!</a></li>
<li><a href="../108518/index.html">C Birthday, Windows!</a></li>
<li><a href="../108519/index.html">Monitoring channel status via jitter / packet loss</a></li>
<li><a href="../108521/index.html">Intelligent vending machines appeared in Japan</a></li>
<li><a href="../108522/index.html">I want an update Habra-Habra</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>