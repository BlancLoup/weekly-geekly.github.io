<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Running Image Viewer from Windows XP on Modern Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have a folder with old pictures that I collected in zero. I transfer from computer to computer along with all my files with each upgrade, occasional...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Running Image Viewer from Windows XP on Modern Windows</h1><div class="post__text post__text-html js-mediator-article">  I have a folder with old pictures that I collected in zero.  I transfer from computer to computer along with all my files with each upgrade, occasionally I go to notify me.  But each time I was a little embarrassed that the standard Windows 7 viewer did not show GIF animation, although my memory told me that during the time of XP the animation was shown without problems.  During the next attack of nostalgia, I decided to launch the viewer from XP on Windows 7. After overcoming a number of obstacles, I am now sure that GIF-animation was really supported there!  And most importantly - now I can watch my old folder with pictures in the authentic Windows XP Image Viewer interface, which creates a more suitable atmosphere =) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd2/3e1/be7/bd23e1be793ad99e00a4d9c5c8f601da.png"></div><br>  <b>Download:</b> <a href="">shimgvw_xp32.7z</a> (includes the binary and launcher source code, plus shimgvw.dll from English-language Windows XP SP3). <br><br><a name="habracut"></a><h2>  How was this done? </h2><br>  The standard image viewer in Windows XP is not a regular application.  It is located in the shimgvw.dll library, and you cannot start it directly - you need at least <a href="https://support.microsoft.com/en-us/help/164787/info-windows-rundll-and-rundll32-interface">rundll32</a> (the path to the existing image file is required): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">rundll32 c:\windows\system32\shimgvw.dll,ImageView_Fullscreen c:\test.gif</code> </pre> <br>  But this trick does not work when you try to run shimgvw.dll from Windows XP to Windows 7 and newer - shimgvw.dll cannot boot, it needs compatibility mode with Windows XP to work correctly.  This can be achieved by setting the appropriate compatibility mode for the rundll32 copy, but compatibility with XP implies raising the application rights to maximum, which causes the appearance of the UAC dialog at each launch, which we would like to avoid. <br><br>  A small dance with the debugger made it possible to find out the reason - during the boot process, shimgvw.dll subsequently tries to import several functions from shunimpl.dll, where obsolete shell functions are stored, and the latter refuses to load by default if ATOM "FailObsoleteShellAPIs" is missing (this ATOM allows loading the library , but then all obsolete functions simply return an error code).  XP compatibility mode, among other things, installs this ATOM, so the viewer starts up. <br><br>  It was decided to write a small loader that adds ATOM "FailObsoleteShellAPIs", asks which picture to open (if the path was not passed in the parameters), and then transfers control to shimgvw.dll.  The viewer works fine (i.e., the original task was completed), so I didn‚Äôt investigate what old functions are imported from shunimpl.dll and when they are used - apparently, they don‚Äôt do anything critical for the viewer to work. <br><br>  Since to implement the loader, you do not need anything other than a small number of WinAPI functions, I decided to build a project using Clang as an experiment without using runtime (earlier I always used MSVC for such dances).  Thus, we have an executable file of 14 kilobytes in size, of which 9 kilobytes was spent on the icon.  If someone also likes to do mini-applications without dependencies on non-standard libraries - this project can serve as a small example, as is done with the help of Clang. </div><p>Source: <a href="https://habr.com/ru/post/430434/">https://habr.com/ru/post/430434/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../430424/index.html">Security Week 47: back to back</a></li>
<li><a href="../430426/index.html">Western Digital Product Rebranding: What Has Changed?</a></li>
<li><a href="../430428/index.html">Website "Escher II" in the nomination "People's Internet project" Runet Prize 2018</a></li>
<li><a href="../430430/index.html">Fullstack - why is it cool, or how to get pleasure from work</a></li>
<li><a href="../430432/index.html">The modal window that you were waiting for. Or how to call a "pop-up" from different buttons on a pure JS</a></li>
<li><a href="../430436/index.html">On the way to QUIC: what is the basis of HTTP / 3</a></li>
<li><a href="../430438/index.html">Realistic shadow for roguelike</a></li>
<li><a href="../430446/index.html">Once again about the advantages of "mobile slavery"</a></li>
<li><a href="../430448/index.html">What gives retail machine learning: a project example</a></li>
<li><a href="../430450/index.html">Development model on the example of Stack-based CPU</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>