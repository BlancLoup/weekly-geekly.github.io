<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DHCP over VLAN on Cisco switches</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I want to talk about a very convenient, in my opinion, scheme for IP addressing on a network with and using VLAN. 
 In the sample conf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DHCP over VLAN on Cisco switches</h1><div class="post__text post__text-html js-mediator-article">  In this article I want to talk about a very convenient, in my opinion, scheme for IP addressing on a network with and using VLAN. <br>  In the sample configuration, we will use the following scheme: <br><img src="http://supernado.com/shema1.png" alt="image"><a name="habracut"></a><br><h4>  A bit of theory for the smallest </h4><br>  <b>VLAN,</b> or Virtual Local Area Network, is a group of hosts with a common set of requirements that interact as if they were connected to a broadcast domain, regardless of their physical location. <br>  In other words, VLAN is a technology of segmentation of a local network into smaller virtual local area networks with its broadcast domain. <br><br>  <b>Advantages of networks with VLAN:</b> <br><ul><li>  Facilitates moving, adding devices and changing their connections with each other; </li><li>  Since the routing between VLANs is carried out at the third level, the degree of administrative control in the network therefore increases; </li><li>  In connection with the splitting of the broadcast domain, the broadcast traffic on the network is reduced, which saves bandwidth; </li><li>  Reduced non-productive use of the CPU by reducing the forwarding of broadcast messages; </li><li>  Preventing broadcast storms and preventing loops. </li></ul><br><h4>  Introduction </h4><br>  I don‚Äôt need to talk about what DHCP is, but for those who are ‚Äúnot sure‚Äù there is a good article, you can read it <a href="http://habrahabr.ru/blogs/cisconetworks/87920/">here</a> .  It also describes the basic DHCP settings on Cisco routers.  They are no different for switches.  I will add only that before configuring DHCP I need to enable ip routing on the switch, which would raise it to level 3 and perform interwave routing, which in turn requires entering the corresponding command in global configuration mode: <br><br><blockquote><code>core(config)#ip routing</code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Everyone knows that it is very convenient to use the DHCP protocol, since the network administrator does not need to configure the TCP / IP protocol stack for each client machine.  On the other hand, in the general case, addresses are assigned randomly, and it is not known in advance which host will receive which address.  And if you need to keep some order of address assignment, what to do in this case!? <br><br>  <b>1st solution:</b> Having retained the convenience of using DHCP, bind each computer to a specific IP address, the so-called binding to the MAC address: a table of addresses is stored on the DHCP server, where the IP is assigned to the MAC, according to which the issue occurs.  The table is filled as you add computers to the network. <br>  The disadvantages of this solution are that the administrator needs to track the MAC address and maintain the matching tables on the server. <br><br>  <b>Solution # 2:</b> Assign the IP addresses not to the MAC addresses, but to the access switch ports to which the client computers are connected. <br><br>  <b>Decision ‚Ññ3</b> The issuance of IP addresses occurs depending on which DHCP relay request came from.  In this case, addresses are issued from the same subnet, but with the binding of specific ranges of addresses to specific switches that act as DHCP relays (dhcpsnooper).  This can quite substantially help the network administrator, since by the IP address of the client computer, it is immediately clear to which switches it is connected to.  This solution uses option 82 of the DHCP protocol. <br><br>  <b>Solution # 4 (And the most flexible):</b> Distribute IP addresses over VLAN.  So we get some kind of universal solution that includes the advantages of all the previous ones.  The flexibility of such a solution is almost limitless. <br><br>  And so, let's get started. <br><br><h4>  The practical side of the issue </h4><br>  For clarity, consider the following example, shown in the figure (see above). <br>  We have: three access level switches (sw1, sw2, sw3), nine client computers (user 1-9), a level 3 switch (Multilayer Switch, let's designate it as Core) and three VLANs. <br>  On access level switches, no additional configuration is required to accomplish the task (well, just configure the interfaces in the appropriate vlan), all the necessary configuration is done on the Core switch.  Core switch configuration example: <br><blockquote> <code><code>!    vlan' <br> core#vlan database <br> core(vlan)#vlan 10 <br> core(vlan)#vlan 20 <br> core(vlan)#vlan 30</code> <br> !    <br> <code>core(vlan)#exit</code> <br> ! vlan  ip- <br> <code>core(config)#int vlan 10 <br> core(config-if)#ip address 10.1.10.1 255.255.255.0</code> <br> !    . vlan 20 - 10.1.20.1, vlan 30 10.1.30.1 <br> !... <br> ! ip routing    dhcp <br> <code>core(config)#ip routing <br> core(config)#ip dhcp pool vl10 <br> core(dhcp-config)#network 10.1.10.0 255.255.255.0 <br> core(dhcp-config)#default-router 10.1.10.1</code> <br> !... <br> !   ,   dns <br> ! +     vlan' <br> <code>core(config)#ip dhcp excluded-address 10.1.10.1 10.1.20.1 10.1.30.1</code> <br></code> </blockquote><br><br>  That's it, ready!  Computers connected to the network will receive IP addresses via DHCP in accordance with the pools for the VLANs in which they are located. <br>  In real networks, it may be advisable to separate VLANs by floor or by department, etc.  as you wish.  Thus, the distribution of IP addresses is now completely in your hands. </div><p>Source: <a href="https://habr.com/ru/post/113431/">https://habr.com/ru/post/113431/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../113425/index.html">iPad and news: a small overview of the best apps</a></li>
<li><a href="../113426/index.html">Release Flash Player 10.2</a></li>
<li><a href="../113427/index.html">RAID-4 / RAID-DP - turning disadvantages into advantages</a></li>
<li><a href="../113429/index.html">C ++, C-style coercion and unexpected consequences of their combination</a></li>
<li><a href="../113430/index.html">Ubiquity RouterStation Pro: a small overview and installation of Debian GNU / Linux</a></li>
<li><a href="../113433/index.html">A joint project of Toshiba and Royal Opera House. Watch the opera ‚ÄúCarmen‚Äù in 3D (update!)</a></li>
<li><a href="../113434/index.html">David O'Reilly</a></li>
<li><a href="../113435/index.html">The most popular phone number in the world: 214-748-3647</a></li>
<li><a href="../113437/index.html">Cellular base station in your pocket</a></li>
<li><a href="../113440/index.html">The ‚Äúbutting‚Äù of TripAdvisor and Google due to hotel reviews continues</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>