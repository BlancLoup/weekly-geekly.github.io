<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Win 8.1 App using HTML & WinJS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I assume that this article will be of interest to those who know and know HTML & JavaScript, but have not tried their hand at developing applications ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Win 8.1 App using HTML & WinJS</h1><div class="post__text post__text-html js-mediator-article">  I assume that this article will be of interest to those who know and know HTML &amp; JavaScript, but have not tried their hand at developing applications for Win8.  In order to go through this article and code it is necessary to have VS 2013 on board. <br><br>  The article will discuss the key aspects of developing applications for the Win 8.1 platform.  Namely: <br><br><ol><li>  The life cycle of the application; </li><li>  Promise; </li><li>  Work with DataSource; </li><li>  Creating your own controls; </li><li>  Working with templates; </li><li>  Tile s; </li><li>  Share; </li></ol><br>  For those who do not like to read, as I, for example, I posted the source code on <a href="http://github.com/Sigura/HubraWin">github.com/Sigura/HubraWin</a> , <br><a name="habracut"></a><br>  In order to reveal all the topics indicated, I created an application that will display a list of contacts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you are already viewing the source, then note that I changed default.js a bit so that there was no common code for launching the application and brought it to app.js.  Leaving the default.js settings and directly launch.  I also supplemented WinJs.Utilities with a modest set of "amenities" and a bus message. <br><br><h1>  Work with objects </h1><br>  In WinJS space, there is a special set of ways to create a class, add methods to it, extend it and make it available. <br><br>  For example, the class declaration is a message bus: <br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,        //     ,  -    //      (function (winJs) { 'use strict'; //   var bus = winJs.Class.define(winJs.Utilities.defaultConstructor(), { init: function (element, options) { var me = this; } }); //         winJs.Class.mix(bus, winJs.Utilities.eventMixin); //      winJs.Namespace.define('HabraWin', { MessageBus: bus }); })(WinJS);</span></span></code> </pre> <br><br><h1>  WinJS application </h1><br>  In fact, this is a web application that has its own hosting (WWAHost.exe).  Its framework for working with OS resources and applications in the namespace WinJS, Application, Windows, ... And a set of controls in WinJS.UI. <br>  I made "my" class for the application, in order to use it in other projects.  In addition to the standard set of settings, this class creates events for launch processing (activated with information about the launch), termination of work and other things (oncheckpoint, before-start, after-start). <br><div class="spoiler">  <b class="spoiler_title">application class</b> <div class="spoiler_text">  <font color="#339933">;</font>  <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> winJs <font color="#339933">,</font> habraWin <font color="#009900">)</font> <font color="#009900">{</font> <br><br>  <font color="#000066">var</font> app <font color="#339933">=</font> winJs.  <font color="#660066">Class</font> .  <font color="#660066">define</font> <font color="#009900">(</font> winJs. <font color="#660066">Utilities</font> . <font color="#660066">defaultConstructor</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">,</font> <font color="#009900">{</font> <br>  init <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> options <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> activatedEventType <font color="#339933">=</font> <font color="#3366CC">'activated'</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> ui <font color="#339933">=</font> options.  <font color="#660066">ui</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> application <font color="#339933">=</font> options.  <font color="#660066">app</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> nav <font color="#339933">=</font> options.  <font color="#660066">nav</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> activation <font color="#339933">=</font> options.  <font color="#660066">activation</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> sched <font color="#339933">=</font> options.  <font color="#660066">sched</font> <font color="#339933">;</font> <br><br>  application.  <font color="#660066">addEventListener</font> <font color="#009900">(</font> activatedEventType <font color="#339933">,</font> <font color="#000066">function</font> <font color="#009900">(</font> args <font color="#009900">)</font> <font color="#009900">{</font> <br><br>  me.  <font color="#660066">dispatchEvent</font> <font color="#009900">(</font> activatedEventType <font color="#339933">,</font> <font color="#009900">{</font> <br>  kind <font color="#339933">:</font> args.  <font color="#660066">detail</font> .  <font color="#660066">kind</font> <font color="#339933">,</font> <br>  isReactivated <font color="#339933">:</font> args.  <font color="#660066">detail</font> .  <font color="#660066">previousExecutionState</font> <font color="#339933">===</font> activation.  <font color="#660066">ApplicationExecutionState</font> .  <font color="#660066">terminated</font> <br>  parevEventDetails <font color="#339933">:</font> args.  <font color="#660066">detail</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> args. <font color="#660066">detail</font> . <font color="#660066">kind</font> <font color="#339933">! ==</font> activation. <font color="#660066">ActivationKind</font> . <font color="#660066">launch</font> <font color="#009900">)</font> <br>  <font color="#000066">return</font> <font color="#339933">;</font> <br><br>  nav.  <font color="#660066">history</font> <font color="#339933">=</font> application.  <font color="#660066">sessionState</font> .  <font color="#660066">history</font> <font color="#339933">||</font>  <font color="#009900">{</font> <font color="#009900">}</font> <font color="#339933">;</font> <br>  nav.  <font color="#660066">history</font> .  <font color="#660066">current</font> .  <font color="#660066">initialPlaceholder</font> <font color="#339933">=</font> <font color="#003366">true</font> <font color="#339933">;</font> <br><br>  ui.  <font color="#660066">disableAnimations</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> p <font color="#339933">=</font> ui.  <font color="#660066">processAll</font> <font color="#009900">(</font> <font color="#009900">)</font> .  <font color="#660066">then</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> nav.  <font color="#660066">navigate</font> <font color="#009900">(</font> nav. <font color="#660066">location</font> <font color="#339933">||</font> habraWin. <font color="#660066">navigator</font> . <font color="#660066">home</font> <font color="#339933">,</font> nav. <font color="#660066">state</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> .  <font color="#660066">then</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> sched.  <font color="#660066">requestDrain</font> <font color="#009900">(</font> sched. <font color="#660066">Priority</font> . <font color="#660066">aboveNormal</font> <font color="#339933">+</font> <font color="#CC0000">1</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> .  <font color="#660066">then</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  ui.  <font color="#660066">enableAnimations</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  args.  <font color="#660066">setPromise</font> <font color="#009900">(</font> p <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  application.  <font color="#660066">oncheckpoint</font> <font color="#339933">=</font> <font color="#000066">function</font> <font color="#009900">(</font> args <font color="#009900">)</font> <font color="#009900">{</font> <br>  me.  <font color="#660066">dispatchEvent</font> <font color="#009900">(</font> <font color="#3366CC">'oncheckpoint'</font> <font color="#339933">,</font> <font color="#009900">{</font> prevEvent <font color="#339933">:</font> args <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  application.  <font color="#660066">sessionState</font> .  <font color="#660066">history</font> <font color="#339933">=</font> nav.  <font color="#660066">history</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  start <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">dispatchEvent</font> <font color="#009900">(</font> <font color="#3366CC">'before-start'</font> <font color="#339933">,</font> me <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">options</font> .  <font color="#660066">app</font> .  <font color="#660066">start</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">dispatchEvent</font> <font color="#009900">(</font> <font color="#3366CC">'after-start'</font> <font color="#339933">,</font> me <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  winJs.  <font color="#660066">Class</font> .  <font color="#660066">mix</font> <font color="#009900">(</font> app <font color="#339933">,</font> winJs. <font color="#660066">Utilities</font> . <font color="#660066">eventMixin</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  winJs.  <font color="#660066">Namespace</font> .  <font color="#660066">define</font> <font color="#009900">(</font> <font color="#3366CC">'Application'</font> <font color="#339933">,</font> <font color="#009900">{</font> <br>  Instance <font color="#339933">:</font> app <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#009900">(</font> WinJS <font color="#339933">,</font> HabraWin <font color="#009900">)</font> <font color="#339933">;</font> </div></div><br>  Then the application launch itself (default.js) will look like this: <br><pre> <code class="javascript hljs">; (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">application, winJs, habraWin, windows, window</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; winJs.Binding.optimizeBindingReferences = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    var app = new application.Instance({ activation: windows.ApplicationModel.Activation, app: winJs.Application, nav: winJs.Navigation, sched: winJs.Utilities.Scheduler, ui: winJs.UI }); //       WinJS winJs.bus = new habraWin.MessageBus(); //   window.app = app; //  app.start(); })(Application, WinJS, HabraWin, Windows, window);</span></span></code> </pre> <br><br><h1>  Page navigation </h1><br>  I am a supporter of applications on the same "page".  WinJS offers a rich set of capabilities for implementing modern user interaction scenarios. <br>  Web aka WinJS application needs a separate object to maintain the conversion history, page by page, page life cycle maintenance. <br>  Those.  each page when moving to it we will need to render into its element, necessarily getting rid of the previous one, namely, removing event listeners, open resources, etc. <br>  How the page life cycle should look like: <br><ul><li>  Use of resources, baiding (processed), </li><li>  Initialization (ready), works when all the controls on the page are ready and the resources are applied, here you can: <ol><li>  Subscribe to page control events, including AppBar, </li><li>  Do some work, like the first search, </li></ol></li><li>  Processing a page refresh, for example, when resizing, </li><li>  Unload a page (unload) to clear all event handlers and other resources. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Control for navigation service</b> <div class="spoiler_text">  <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> winJs <font color="#339933">,</font> habraWin <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#3366CC">'use strict'</font> <font color="#339933">;</font> <br><br>  winJs.  <font color="#660066">Namespace</font> .  <font color="#660066">define</font> <font color="#009900">(</font> <font color="#3366CC">'HabraWin'</font> <font color="#339933">,</font> <font color="#009900">{</font> <br>  PageNavigatorControl <font color="#339933">:</font> winJs.  <font color="#660066">Class</font> .  <font color="#660066">define</font> <font color="#009900">(</font> <br>  <font color="#000066">function</font> <font color="#009900">(</font> element <font color="#339933">,</font> options <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> nav <font color="#339933">=</font> winJs.  <font color="#660066">Navigation</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> ._element <font color="#339933">=</font> element <font color="#339933">||</font>  document.  <font color="#660066">createElement</font> <font color="#009900">(</font> <font color="#3366CC">'div'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">this</font> ._element.  <font color="#660066">appendChild</font> <font color="#009900">(</font> <font color="#000066">this</font> ._createPageElement <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">home</font> <font color="#339933">=</font> options.  <font color="#660066">home</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> ._eventHandlerRemover <font color="#339933">=</font> <font color="#009900">[</font> <font color="#009900">]</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">addRemovableEventListener</font> <font color="#009900">(</font> nav <font color="#339933">,</font> <font color="#3366CC">'navigating'</font> <font color="#339933">,</font> <font color="#000066">this</font> ._navigating. <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066">this</font> <font color="#009900">)</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">this</font> .  <font color="#660066">addRemovableEventListener</font> <font color="#009900">(</font> nav <font color="#339933">,</font> <font color="#3366CC">'navigated'</font> <font color="#339933">,</font> <font color="#000066">this</font> ._navigated. <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066">this</font> <font color="#009900">)</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  window.  <font color="#660066">onresize</font> <font color="#339933">=</font> <font color="#000066">this</font> ._resized.  <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066">this</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  habraWin.  <font color="#660066">navigator</font> <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <font color="#009900">{</font> <br>  addRemovableEventListener <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> e <font color="#339933">,</font> eventName <font color="#339933">,</font> handler <font color="#339933">,</font> capture <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> that <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  e.  <font color="#660066">addEventListener</font> <font color="#009900">(</font> eventName <font color="#339933">,</font> handler <font color="#339933">,</font> capture <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  that._eventHandlerRemover.  <font color="#660066">push</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  e.  <font color="#660066">removeEventListener</font> <font color="#009900">(</font> eventName <font color="#339933">,</font> handler <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  home <font color="#339933">:</font> <font color="#3366CC">''</font> <font color="#339933">,</font> <br>  _element <font color="#339933">:</font> <font color="#003366">null</font> <font color="#339933">,</font> <br>  _lastNavigationPromise <font color="#339933">:</font> winJs.  <font color="#660066">Promise</font> .  <font color="#660066">as</font> <font color="#009900">(</font> <font color="#009900">)</font> <br>  _lastViewstate <font color="#339933">:</font> <font color="#CC0000">0</font> <font color="#339933">,</font> <br><br>  pageControl <font color="#339933">:</font> <font color="#009900">{</font> <br>  <font color="#000066">get</font> <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <font color="#000066">return</font> <font color="#000066">this</font> .  <font color="#660066">pageElement</font> <font color="#339933">&amp;&amp;</font> <font color="#000066">this</font> .  <font color="#660066">pageElement</font> .  <font color="#660066">winControl</font> <font color="#339933">;</font>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br><br>  pageElement <font color="#339933">:</font> <font color="#009900">{</font> <br>  <font color="#000066">get</font> <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <font color="#000066">return</font> <font color="#000066">this</font> ._element.  <font color="#660066">firstElementChild</font> <font color="#339933">;</font>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br><br>  dispose <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">this</font> ._disposed <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#000066">this</font> ._disposed <font color="#339933">=</font> <font color="#003366">true</font> <font color="#339933">;</font> <br>  winJs.  <font color="#660066">Utilities</font> .  <font color="#660066">disposeSubTree</font> <font color="#009900">(</font> <font color="#000066">this</font> ._element <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">for</font> <font color="#009900">(</font> <font color="#000066">var</font> i <font color="#339933">=</font> <font color="#CC0000">0</font> <font color="#339933">;</font> i <font color="#339933">&lt;</font> <font color="#000066">this</font> ._eventHandlerRemover. <font color="#660066">length</font> <font color="#339933">;</font> i <font color="#339933">++</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> ._eventHandlerRemover <font color="#009900">[</font> i <font color="#009900">]</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#000066">this</font> ._eventHandlerRemover <font color="#339933">=</font> <font color="#003366">null</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br><br>  _createPageElement <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> element <font color="#339933">=</font> document.  <font color="#660066">createElement</font> <font color="#009900">(</font> <font color="#3366CC">'div'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  element.  <font color="#660066">setAttribute</font> <font color="#009900">(</font> <font color="#3366CC">'dir'</font> <font color="#339933">,</font> window. <font color="#660066">getComputedStyle</font> <font color="#009900">(</font> <font color="#000066">this</font> ._element <font color="#339933">,</font> <font color="#003366">null</font> <font color="#009900">)</font> . <font color="#660066">direction</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  element.  <font color="#660066">style</font> .  <font color="#660066">position</font> <font color="#339933">=</font> <font color="#3366CC">'absolute'</font> <font color="#339933">;</font> <br>  element.  <font color="#660066">style</font> .  <font color="#660066">visibility</font> <font color="#339933">=</font> <font color="#3366CC">'hidden'</font> <font color="#339933">;</font> <br>  element.  <font color="#660066">style</font> .  <font color="#660066">width</font> <font color="#339933">=</font> <font color="#3366CC">'100%'</font> <font color="#339933">;</font> <br>  element.  <font color="#660066">style</font> .  <font color="#660066">height</font> <font color="#339933">=</font> <font color="#3366CC">'100%'</font> <font color="#339933">;</font> <br>  <font color="#000066">return</font> element <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br><br>  _getAnimationElements <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">this</font> . <font color="#660066">pageControl</font> <font color="#339933">&amp;&amp;</font> <font color="#000066">this</font> . <font color="#660066">pageControl</font> . <font color="#660066">getAnimationElements</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> <font color="#000066">this</font> .  <font color="#660066">pageControl</font> .  <font color="#660066">getAnimationElements</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#000066">return</font> <font color="#000066">this</font> .  <font color="#660066">pageElement</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br><br>  _navigated <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">pageElement</font> .  <font color="#660066">style</font> .  <font color="#660066">visibility</font> <font color="#339933">=</font> <font color="#3366CC">"</font> <font color="#339933">;</font> <br>  winJs.  <font color="#660066">Ui</font> .  <font color="#660066">Animation</font> .  <font color="#660066">enterPage</font> <font color="#009900">(</font> <font color="#000066">this</font> ._getAnimationElements <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">)</font> .  <font color="#660066">done</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br><br>  _navigating <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> args <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> newElement <font color="#339933">=</font> <font color="#000066">this</font> ._createPageElement <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">this</font> ._element.  <font color="#660066">appendChild</font> <font color="#009900">(</font> newElement <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> ._lastNavigationPromise.  <font color="#660066">cancel</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br>  <font color="#000066">this</font> ._lastNavigationPromise <font color="#339933">=</font> winJs.  <font color="#660066">Promise</font> .  <font color="#660066">as</font> <font color="#009900">(</font> <font color="#009900">)</font> .  <font color="#660066">then</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> winJs.  <font color="#660066">Ui</font> .  <font color="#660066">Pages</font> .  <font color="#660066">render</font> <font color="#009900">(</font> args. <font color="#660066">detail</font> . <font color="#660066">location</font> <font color="#339933">,</font> newElement <font color="#339933">,</font> args. <font color="#660066">detail</font> . <font color="#660066">state</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> .  <font color="#660066">then</font> <font color="#009900">(</font> <font color="#000066">function</font> parentElement <font color="#009900">(</font> control <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> oldElement <font color="#339933">=</font> me.  <font color="#660066">pageElement</font> <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> oldElement. <font color="#660066">winControl</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> oldElement. <font color="#660066">winControl</font> . <font color="#660066">unload</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  oldElement.  <font color="#660066">winControl</font> .  <font color="#660066">unload</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  oldElement.  <font color="#660066">winControl</font> .  <font color="#660066">dispose</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  oldElement.  <font color="#660066">parentNode</font> .  <font color="#660066">removeChild</font> <font color="#009900">(</font> oldElement <font color="#009900">)</font> <font color="#339933">;</font> <br>  oldElement.  <font color="#660066">innerText</font> <font color="#339933">=</font> <font color="#3366CC">"</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  args.  <font color="#660066">detail</font> .  <font color="#660066">setPromise</font> <font color="#009900">(</font> <font color="#000066">this</font> ._lastNavigationPromise <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br><br>  _resized <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> args <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">this</font> . <font color="#660066">pageControl</font> <font color="#339933">&amp;&amp;</font> <font color="#000066">this</font> . <font color="#660066">pageControl</font> . <font color="#660066">updateLayout</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">pageControl</font> .  <font color="#660066">updateLayout</font> .  <font color="#660066">call</font> <font color="#009900">(</font> <font color="#000066">this</font> . <font color="#660066">pageControl</font> <font color="#339933">,</font> <font color="#000066">this</font> . <font color="#660066">pageElement</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">)</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#009900">(</font> WinJS <font color="#339933">,</font> HabraWin <font color="#009900">)</font> <font color="#339933">;</font> </div></div><br><div class="spoiler">  <b class="spoiler_title">Page Code</b> <div class="spoiler_text">  <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> winJs <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#3366CC">'use strict'</font> <font color="#339933">;</font> <br><br>  winJs.  <font color="#660066">Ui</font> .  <font color="#660066">Pages</font> .  <font color="#660066">define</font> <font color="#009900">(</font> <font color="#3366CC">'/pages/hub/hub.html'</font> <font color="#339933">,</font> <font color="#009900">{</font> <br>  processed <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> element <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> winJs.  <font color="#660066">Resources</font> .  <font color="#660066">processAll</font> <font color="#009900">(</font> element <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  className <font color="#339933">:</font> <font color="#3366CC">'client-search-hub'</font> <font color="#339933">,</font> <br>  ready <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> element <font color="#339933">,</font> options <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">initEnv</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">initAppBar</font> <font color="#009900">(</font> element <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">this</font> .  <font color="#660066">subscribe</font> <font color="#009900">(</font> element <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">setFormValues</font> <font color="#009900">(</font> options <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">search</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  initAppBar <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> element <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br>  me.  <font color="#660066">appBar</font> <font color="#339933">=</font> element.  <font color="#660066">querySelector</font> <font color="#009900">(</font> <font color="#3366CC">'#appbar'</font> <font color="#009900">)</font> .  <font color="#660066">winControl</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">addRemovableEventListener</font> <font color="#009900">(</font> me. <font color="#660066">appBar</font> . <font color="#660066">getCommandById</font> <font color="#009900">(</font> <font color="#3366CC">'clear'</font> <font color="#009900">)</font> <font color="#339933">,</font> <font color="#3366CC">'click'</font> <font color="#339933">,</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  winJs.  <font color="#660066">bus</font> .  <font color="#660066">dispatchEvent</font> <font color="#009900">(</font> <font color="#3366CC">'clear-command'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  subscribe <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> search <font color="#339933">=</font> me.  <font color="#660066">element</font> .  <font color="#660066">querySelector</font> <font color="#009900">(</font> <font color="#3366CC">'#search'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  search <font color="#339933">&amp;&amp;</font> me.  <font color="#660066">addRemovableEventListener</font> <font color="#009900">(</font> search <font color="#339933">,</font> <font color="#3366CC">'click'</font> <font color="#339933">,</font> me. <font color="#660066">search</font> . <font color="#660066">bind</font> <font color="#009900">(</font> me <font color="#009900">)</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">addRemovableEventListener</font> <font color="#009900">(</font> winJs. <font color="#660066">bus</font> <font color="#339933">,</font> <font color="#3366CC">'client-selected'</font> <font color="#339933">,</font> <font color="#000066">function</font> <font color="#009900">(</font> item <font color="#009900">)</font> <font color="#009900">{</font> <br>  me.  <font color="#660066">currentClient</font> <font color="#339933">=</font> item.  <font color="#660066">detail</font> .  <font color="#660066">data</font> <font color="#339933">;</font> <br>  <font color="#006600">//me.editButton.disabled = false;</font> <br>  me.  <font color="#660066">appBar</font> .  <font color="#660066">sticky</font> <font color="#339933">=</font> <font color="#003366">true</font> <font color="#339933">;</font> <br>  me.  <font color="#660066">appBar</font> .  <font color="#660066">show</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  me.  <font color="#660066">addRemovableEventListener</font> <font color="#009900">(</font> winJs. <font color="#660066">bus</font> <font color="#339933">,</font> <font color="#3366CC">'client-unselected'</font> <font color="#339933">,</font> <font color="#000066">function</font> <font color="#009900">(</font> item <font color="#009900">)</font> <font color="#009900">{</font> <br>  me.  <font color="#660066">currentClient</font> <font color="#339933">=</font> <font color="#003366">null</font> <font color="#339933">;</font> <br>  <font color="#006600">//me.editButton.disabled = true;</font> <br>  me.  <font color="#660066">appBar</font> .  <font color="#660066">hide</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  me.  <font color="#660066">appBar</font> .  <font color="#660066">sticky</font> <font color="#339933">=</font> <font color="#003366">false</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  unload <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">element</font> .  <font color="#660066">classList</font> .  <font color="#660066">remove</font> <font color="#009900">(</font> <font color="#000066">this</font> . <font color="#660066">className</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">this</font> ._disposed <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#000066">this</font> ._disposed <font color="#339933">=</font> <font color="#003366">true</font> <font color="#339933">;</font> <br>  winJs.  <font color="#660066">Utilities</font> .  <font color="#660066">disposeSubTree</font> <font color="#009900">(</font> <font color="#000066">this</font> ._element <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">for</font> <font color="#009900">(</font> <font color="#000066">var</font> i <font color="#339933">=</font> <font color="#CC0000">0</font> <font color="#339933">;</font> i <font color="#339933">&lt;</font> <font color="#000066">this</font> ._eventHandlerRemover. <font color="#660066">length</font> <font color="#339933">;</font> <font color="#339933">++</font> i <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> ._eventHandlerRemover <font color="#009900">[</font> i <font color="#009900">]</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#000066">this</font> ._eventHandlerRemover <font color="#339933">=</font> <font color="#003366">null</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  addRemovableEventListener <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> e <font color="#339933">,</font> eventName <font color="#339933">,</font> handler <font color="#339933">,</font> capture <font color="#009900">)</font> <font color="#009900">{</font> <br>  capture <font color="#339933">=</font> capture <font color="#339933">! ==</font> <font color="#003366">false</font> <font color="#339933">?</font>  <font color="#003366">false</font> <font color="#339933">:</font> <font color="#003366">true</font> <font color="#339933">;</font> <br><br>  e.  <font color="#660066">addEventListener</font> <font color="#009900">(</font> eventName <font color="#339933">,</font> handler <font color="#339933">,</font> capture <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> ._eventHandlerRemover.  <font color="#660066">push</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  e.  <font color="#660066">removeEventListener</font> <font color="#009900">(</font> eventName <font color="#339933">,</font> handler <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  updateLayout <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> element <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#006600">/// &lt;param name = "element" domElement = "true" /&gt;</font> <br><br>  <font color="#006600">// TODO: Respond to changes in layout.</font> <br><br>  <font color="#006600">// debugger;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  setFormValues <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> clinetInfo <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">searchForm</font> <font color="#339933">=</font> <font color="#000066">this</font> .  <font color="#660066">element</font> .  <font color="#660066">querySelector</font> <font color="#009900">(</font> <font color="#3366CC">'# main-search-form'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">searchForm</font> <font color="#339933">&amp;&amp;</font> <font color="#000066">this</font> .  <font color="#660066">searchForm</font> .  <font color="#660066">setAttribute</font> <font color="#009900">(</font> <font color="#3366CC">'data-win-options'</font> <font color="#339933">,</font> JSON. <font color="#660066">stringify</font> <font color="#009900">(</font> clinetInfo <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">this</font> .  <font color="#660066">searchForm</font> <font color="#339933">&amp;&amp;</font> <font color="#000066">this</font> .  <font color="#660066">searchForm</font> .  <font color="#660066">winControl</font> <font color="#339933">&amp;&amp;</font> <font color="#000066">this</font> .  <font color="#660066">searchForm</font> .  <font color="#660066">winControl</font> .  <font color="#660066">setValues</font> <font color="#009900">(</font> clinetInfo <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  search <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  winJs.  <font color="#660066">bus</font> .  <font color="#660066">dispatchEvent</font> <font color="#009900">(</font> <font color="#3366CC">'search-command'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  initEnv <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">element</font> .  <font color="#660066">classList</font> .  <font color="#660066">add</font> <font color="#009900">(</font> <font color="#000066">this</font> . <font color="#660066">className</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">this</font> ._eventHandlerRemover <font color="#339933">=</font> <font color="#009900">[</font> <font color="#009900">]</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#009900">(</font> WinJS <font color="#009900">)</font> <font color="#339933">;</font> </div></div><br><h1>  Localization </h1><br>  If you make the file strings \ en-RU \ resources.resjson <br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"pageHeader"</span></span>: <span class="hljs-string"><span class="hljs-string">"Habra WinJS 8.1"</span></span> <span class="hljs-comment"><span class="hljs-comment">// ‚Ä¶ }</span></span></code> </pre><br>  then in the code to use the links: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pagetitle"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-win-res</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{ textContent: 'pageHeader' }"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The path to the most appropriate language will be automatically picked up at startup. <br>  <a href="http://code.msdn.microsoft.com/windowsapps/Application-resources-and-cd0c6eaa/sourcecode%3FfileId%3D43559%26pathId%3D1789706597">It is curious what can be built into the resources of the building.</a> <br>  It is also interesting that for resources a special type of content is used in jsproj <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PRIResource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"strings\ru-RU\resources.resjson"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  Those.  you need to create a resource file using the VS interface, you can‚Äôt just rename the existing file, for example, txt to resjson, it will be in jsproj: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Content</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" strings\ru-RU\resources.resjson"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  making it impossible to use because  It will not load automatically. <br><h1>  Templates, biding </h1><br>  Template example: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"client-search-item-template"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-win-control</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"WinJS.Binding.Template"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"display: none;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"client-item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"client-info"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"client-photo"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-win-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"alt: name; src: this HabraWin.Converters.clientPhoto;"</span></span></span><span class="hljs-tag"> /&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"client-name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-win-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"innerText: name"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"decoration-bottom-line"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  This is the markup to display the user in the list.  A special attribute (data-win-bind) specifies a binding to one or another property of the element, as well as an expression for data access. <br>  And in order to make some transformations, for example, in order to show a photo of a client, you can specify a converter: <br>  src: this HabraWin.Converters.clientPhoto <br><pre> <code class="javascript hljs">; (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">winJs</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> converters = { <span class="hljs-attr"><span class="hljs-attr">clientPhoto</span></span>: winJs.Binding.converter(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">client</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!client || !client.hasPhoto) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'/images/empty-photo.png'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> converters.baseAddress + <span class="hljs-string"><span class="hljs-string">'/clients/photos/'</span></span> + client.ID; }) }; winJs.Namespace.define(<span class="hljs-string"><span class="hljs-string">'HabraWin'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">Converters</span></span>: converters }); })(WinJS);</code> </pre><br>  In order to apply data to the template it is enough: <br><pre> <code class="javascript hljs">WinJS.Binding.processAll(element, data);</code> </pre><br><h1>  Controls </h1><br>  Creating a WinJS control is very similar to creating a class.  For example, the form HabraWin.ClientSearchForm: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">role</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"main-search-form"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-win-control</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HabraWin.ClientSearchForm"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form-group"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"second-name"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-win-res</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{textContent: 'serachFormSecondNameLabel'}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-win-res</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{attributes: { 'placeholder' : 'serachFormSecondNamePlaceholder' }}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">spellcheck</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"secondName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"second-name"</span></span></span><span class="hljs-tag"> /&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"main-search-form-buttons form-group"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"search"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-win-res</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{textContent: 'serachFormSearchButton'}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"reset"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"clear"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"clear"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-win-res</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{textContent: 'serachFormClearButton'}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Code to serve events and form controls</b> <div class="spoiler_text">  <font color="#339933">;</font>  <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> winJs <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#3366CC">'use strict'</font> <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> searchForm <font color="#339933">=</font> winJs.  <font color="#660066">Class</font> .  <font color="#660066">derive</font> <font color="#009900">(</font> HabraWin. <font color="#660066">BaseForm</font> <font color="#339933">,</font> winJs. <font color="#660066">Utilities</font> . <font color="#660066">defaultControlConstructor</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">,</font> <font color="#009900">{</font> <br>  init <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> element <font color="#339933">,</font> options <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">initProperies</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">clearForm</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">defineElements</font> <font color="#009900">(</font> element <font color="#009900">)</font> <font color="#339933">;</font> <br>  me.  <font color="#660066">defineEvents</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  me.  <font color="#660066">subscribe</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">setValues</font> <font color="#009900">(</font> options <font color="#009900">)</font> <font color="#339933">;</font> <br>  me.  <font color="#660066">search</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  defineElements <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> element <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">fields</font> <font color="#339933">=</font> <font color="#009900">{</font> <br>  secondName <font color="#339933">:</font> element.  <font color="#660066">querySelector</font> <font color="#009900">(</font> <font color="#3366CC">'input [name = secondName]'</font> <font color="#009900">)</font> <br>  <font color="#009900">}</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">buttons</font> <font color="#339933">=</font> <font color="#009900">{</font> <br>  clear <font color="#339933">:</font> element.  <font color="#660066">querySelector</font> <font color="#009900">(</font> <font color="#3366CC">'button [name = clear]'</font> <font color="#009900">)</font> <font color="#006600">//,</font> <br>  <font color="#009900">}</font> <font color="#339933">;</font> <br><br><br>  <font color="#000066">var</font> values <font color="#339933">=</font> <font color="#000066">this</font> .  <font color="#660066">getValues</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">oldValues</font> <font color="#339933">=</font> JSON.  <font color="#660066">stringify</font> <font color="#009900">(</font> values <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  defineEvents <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">buttons</font> .  <font color="#660066">clear</font> .  <font color="#660066">addEventListener</font> <font color="#009900">(</font> <font color="#3366CC">'click'</font> <font color="#339933">,</font> me. <font color="#660066">clearAndSearch</font> . <font color="#660066">bind</font> <font color="#009900">(</font> me <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  setValues <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> values <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#339933">!</font> values <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#000066">this</font> .  <font color="#660066">changedFields</font> <font color="#339933">=</font> <font color="#009900">[</font> <font color="#009900">]</font> <font color="#339933">;</font> <br><br>  <font color="#000066">for</font> <font color="#009900">(</font> <font color="#000066">var</font> lbl <font color="#000066">in</font> values <font color="#009900">)</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> values. <font color="#000066">hasOwnProperty</font> <font color="#009900">(</font> lbl <font color="#009900">)</font> <font color="#339933">&amp;&amp;</font> <font color="#000066">this</font> . <font color="#660066">fields</font> . <font color="#000066">hasOwnProperty</font> <font color="#009900">(</font> lbl <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> field <font color="#339933">=</font> <font color="#000066">this</font> .  <font color="#660066">fields</font> <font color="#009900">[</font> lbl <font color="#009900">]</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> value <font color="#339933">=</font> values <font color="#009900">[</font> lbl <font color="#009900">]</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> valPropName <font color="#339933">=</font> field <font color="#339933">&amp;&amp;</font> <font color="#009900">(</font> <font color="#3366CC">'type'</font> <font color="#000066">in</font> field <font color="#009900">)</font> <font color="#339933">&amp;&amp;</font> field.  <font color="#660066">type</font> <font color="#339933">===</font> <font color="#3366CC">'checkbox'</font> <font color="#339933">?</font>  <font color="#3366CC">'checked'</font> <font color="#339933">:</font> <font color="#009900">(</font> field <font color="#339933">&amp;&amp;</font> <font color="#3366CC">'value'</font> <font color="#000066">in</font> field <font color="#339933">?</font> <font color="#3366CC">'value'</font> <font color="#339933">:</font> <font color="#3366CC">'current'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#339933">!</font> field <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">continue</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  field <font color="#009900">[</font> valPropName <font color="#009900">]</font> <font color="#339933">=</font> value <font color="#339933">;</font> <br>  value <font color="#339933">&amp;&amp;</font> <font color="#000066">this</font> .  <font color="#660066">changedFields</font> .  <font color="#660066">push</font> <font color="#009900">(</font> lbl <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  subscribe <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  <font color="#000066">for</font> <font color="#009900">(</font> <font color="#000066">var</font> lbl <font color="#000066">in</font> <font color="#000066">this</font> . <font color="#660066">fields</font> <font color="#009900">)</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">this</font> . <font color="#660066">fields</font> . <font color="#000066">hasOwnProperty</font> <font color="#009900">(</font> lbl <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> field <font color="#339933">=</font> <font color="#000066">this</font> .  <font color="#660066">fields</font> <font color="#009900">[</font> lbl <font color="#009900">]</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> isTextField <font color="#339933">=</font> <font color="#3366CC">'value'</font> <font color="#000066">in</font> field <font color="#339933">;</font> <br><br>  field.  <font color="#660066">addEventListener</font> <font color="#009900">(</font> isTextField <font color="#339933">?</font> <font color="#3366CC">'keydown'</font> <font color="#339933">:</font> <font color="#3366CC">'change'</font> <font color="#339933">,</font> me. <font color="#660066">fieldChanged</font> . <font color="#660066">bind</font> <font color="#009900">(</font> me <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  field.  <font color="#660066">addEventListener</font> <font color="#009900">(</font> isTextField <font color="#339933">?</font> <font color="#3366CC">'keydown'</font> <font color="#339933">:</font> <font color="#3366CC">'change'</font> <font color="#339933">,</font> isTextField <font color="#339933">?</font> me. <font color="#660066">search</font> . <font color="#660066">bind</font> <font color="#009900">(</font> me <font color="#009900">)</font> . <font color="#660066">defer</font> <font color="#009900">(</font> <font color="#CC0000">1000</font> <font color="#009900">)</font> <font color="#339933">:</font> me. <font color="#660066">search</font> . <font color="#660066">bind</font> <font color="#009900">(</font> me <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> isTextField <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#009900">[</font> <font color="#3366CC">'cut'</font> <font color="#339933">,</font> <font color="#3366CC">'paste'</font> <font color="#339933">,</font> <font color="#3366CC">'change'</font> <font color="#009900">]</font> .  <font color="#660066">forEach</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> e <font color="#009900">)</font> <font color="#009900">{</font> <br>  field.  <font color="#660066">addEventListener</font> <font color="#009900">(</font> e <font color="#339933">,</font> me. <font color="#660066">fieldChanged</font> . <font color="#660066">bind</font> <font color="#009900">(</font> me <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br><br>  winJs.  <font color="#660066">bus</font> .  <font color="#660066">addEventListener</font> <font color="#009900">(</font> <font color="#3366CC">'clear-command'</font> <font color="#339933">,</font> me. <font color="#660066">clearAndSearch</font> . <font color="#660066">bind</font> <font color="#009900">(</font> me <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  clearAndSearch <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">clearForm</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">this</font> .  <font color="#660066">search</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  addNewClient <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> values <font color="#339933">=</font> <font color="#000066">this</font> .  <font color="#660066">getValues</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  winJs.  <font color="#660066">Navigation</font> .  <font color="#660066">navigate</font> <font color="#009900">(</font> <font color="#3366CC">"/pages/section/section.html"</font> <font color="#339933">,</font> values <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  getValues <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> values <font color="#339933">=</font> <font color="#009900">{</font> <font color="#009900">}</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">changedFields</font> .  <font color="#660066">forEach</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> lbl <font color="#009900">)</font> <font color="#009900">{</font> <br>  values <font color="#009900">[</font> lbl <font color="#009900">]</font> <font color="#339933">=</font> me.  <font color="#660066">getValue</font> <font color="#009900">(</font> lbl <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">return</font> values <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  search <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> values <font color="#339933">=</font> <font color="#000066">this</font> .  <font color="#660066">getValues</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  winJs.  <font color="#660066">bus</font> .  <font color="#660066">dispatchEvent</font> <font color="#009900">(</font> <font color="#3366CC">'search-client'</font> <font color="#339933">,</font> values <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">oldValues</font> <font color="#339933">=</font> JSON.  <font color="#660066">stringify</font> <font color="#009900">(</font> values <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  clearForm <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> fields <font color="#339933">=</font> <font>Array</font> .  <font color="#000066">prototype</font> .  <font color="#660066">slice</font> .  <font color="#660066">call</font> <font color="#009900">(</font> me. <font color="#660066">element</font> . <font color="#660066">querySelectorAll</font> <font color="#009900">(</font> <font color="#3366CC">'input [type = text], select'</font> <font color="#009900">)</font> <font color="#339933">,</font> <font color="#CC0000">0</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  fields.  <font color="#660066">forEach</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> e <font color="#009900">)</font> <font color="#009900">{</font> <br>  e.  <font color="#660066">value</font> <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> current <font color="#339933">=</font> <font color="#000066">new</font> <font>Date</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">fields</font> <font color="#339933">&amp;&amp;</font> me.  <font color="#660066">fields</font> .  <font color="#660066">birthday</font> <font color="#339933">&amp;&amp;</font> <font color="#009900">(</font> me. <font color="#660066">fields</font> . <font color="#660066">birthday</font> . <font color="#660066">current</font> <font color="#339933">=</font> <font color="#000066">new</font> <font>Date</font> <font color="#009900">(</font> current. <font color="#660066">setYear</font> <font color="#009900">(</font> current. <font color="#660066">getFullYear</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">-</font> <font color="#CC0000">24</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">changedFields</font> <font color="#339933">=</font> <font color="#009900">[</font> <font color="#009900">]</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  fieldLabel <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> field <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> field <font color="#339933">&amp;&amp;</font> <font color="#009900">(</font> field. <font color="#660066">getAttribute</font> <font color="#009900">(</font> <font color="#3366CC">'name'</font> <font color="#009900">)</font> <font color="#339933">||</font> field. <font color="#660066">id</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  fieldChanged <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> e <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> field <font color="#339933">=</font> e <font color="#339933">&amp;&amp;</font> e.  <font color="#660066">currentTarget</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> lbl <font color="#339933">=</font> <font color="#000066">this</font> .  <font color="#660066">fieldLabel</font> <font color="#009900">(</font> field <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#339933">!</font> <font color="#009900">(</font> lbl <font color="#000066">in</font> <font color="#000066">this</font> . <font color="#660066">fields</font> <font color="#009900">)</font> <font color="#009900">)</font> <br>  <font color="#000066">return</font> <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> value <font color="#339933">=</font> <font color="#000066">this</font> .  <font color="#660066">getValue</font> <font color="#009900">(</font> lbl <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#339933">!</font> value <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">changedFields</font> .  <font color="#660066">remove</font> <font color="#009900">(</font> lbl <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">return</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#000066">this</font> . <font color="#660066">changedFields</font> . <font color="#660066">indexOf</font> <font color="#009900">(</font> lbl <font color="#009900">)</font> <font color="#339933">===</font> <font color="#339933">-</font> <font color="#CC0000">1</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">changedFields</font> .  <font color="#660066">push</font> <font color="#009900">(</font> lbl <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  initProperies <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  winJs.  <font color="#660066">Namespace</font> .  <font color="#660066">define</font> <font color="#009900">(</font> <font color="#3366CC">'HabraWin'</font> <font color="#339933">,</font> <font color="#009900">{</font> <br>  ClientSearchForm <font color="#339933">:</font> searchForm <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#009900">(</font> WinJS <font color="#009900">)</font> <font color="#339933">;</font> </div></div><br><br><h1>  Promise for example Share </h1><br>  If you used api for asynchronous calls, for example, XmlHttpRequest, and you had to make a chain of dependent calls from each other, then you noticed that it‚Äôs difficult to support such a call chain, i.e.  read and modify first of all because of nesting.  I know two patterns that can get rid of nesting: events or promise. <br><br>  For example, combining sequential calls: <br><pre> <code class="javascript hljs">share: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> request = e.request; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> deferral = request.getDeferral(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> offering = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offering; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> files = []; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> me = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text = offering.description.replace(<span class="hljs-regexp"><span class="hljs-regexp">/&lt;[^&gt;]+&gt;/gim</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).replace(<span class="hljs-regexp"><span class="hljs-regexp">/ [\s]+/</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   : this.fileListControl.selection.getItems() .then(function (items) { //   ,   return items.map(function (item) { var uri = new Windows.Foundation.Uri(item.data.uri); return Windows.Storage.StorageFile.getFileFromApplicationUriAsync(uri) .then(function (storageFile) { files.push(storageFile); }); }); }).then(function (promises) { //   ,      return WinJS.Promise.join(promises); }).done(function () { //            request.data.properties.title = offering.name; request.data.properties.description = text; if (files.length) request.data.setStorageItems(files); else me.articlePackage(request.data); deferral.complete(); }); },</span></span></code> </pre><br><br><h1>  Data Access - DataSource </h1><br>  To visualize the data, you can use WinJs.UI.ListView.  For example, this wonderful control can not load data all at once, but display it as necessary.  That saves resources when displaying more than a hundred records.  But for this you need to implement your DataSource with support for data loading page by page. <br><br><div class="spoiler">  <b class="spoiler_title">Sample DataSource code for paginating users</b> <div class="spoiler_text">  <font color="#339933">;</font>  <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> winJs <font color="#339933">,</font> console <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#3366CC">'use strict'</font> <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> clientSearchDataAdapter <font color="#339933">=</font> winJs.  <font color="#660066">Class</font> .  <font color="#660066">define</font> <font color="#009900">(</font> winJs. <font color="#660066">Utilities</font> . <font color="#660066">defaultConstructor</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">,</font> <font color="#009900">{</font> <br>  def <font color="#339933">:</font> <font color="#009900">{</font> <br>  maxCount <font color="#339933">:</font> <font color="#CC0000">300</font> <font color="#339933">,</font> <br>  maxPageSize <font color="#339933">:</font> <font color="#CC0000">50</font> <font color="#339933">,</font> <br>  minPageSize <font color="#339933">:</font> <font color="#CC0000">50</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  init <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> options <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">cache</font> <font color="#339933">=</font> <font color="#009900">{</font> <font color="#009900">}</font> <font color="#339933">;</font> <br>  <font color="#000066">this</font> ._filter <font color="#339933">=</font> <font color="#003366">null</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">dataSource</font> <font color="#339933">=</font> options.  <font color="#660066">dataSource</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  condition <font color="#339933">:</font> <font color="#009900">{</font> <br>  <font color="#000066">get</font> <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> <font color="#000066">this</font> ._filter <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  <font color="#000066">set</font> <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> value <font color="#009900">)</font> <font color="#009900">{</font> <br><br>  <font color="#000066">this</font> ._filter <font color="#339933">=</font> value <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">dataSource</font> <font color="#339933">&amp;&amp;</font> <font color="#000066">this</font> .  <font color="#660066">dataSource</font> .  <font color="#660066">invalidateAll</font> <font color="#339933">&amp;&amp;</font> <font color="#000066">this</font> .  <font color="#660066">dataSource</font> .  <font color="#660066">invalidateAll</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">return</font> value <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  getQuery <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  <font color="#000066">return</font> <font color="#000066">new</font> HabraWin.  <font color="#660066">ProxyBuilder</font> <font color="#009900">(</font> <font color="#3366CC">'client'</font> <font color="#009900">)</font> .  <font color="#660066">then</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> proxy <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> proxy.  <font color="#660066">search</font> <font color="#009900">(</font> me. <font color="#660066">condition</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  getCount <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br><br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> cacheKey <font color="#339933">=</font> JSON.  <font color="#660066">stringify</font> <font color="#009900">(</font> me. <font color="#660066">condition</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> cacheKey <font color="#000066">in</font> <font color="#000066">this</font> . <font color="#660066">cache</font> <font color="#009900">)</font> <br>  <font color="#000066">return</font> winjs.  <font color="#660066">Promise</font> .  <font color="#660066">wrap</font> <font color="#009900">(</font> me. <font color="#660066">cache</font> <font color="#009900">[</font> cacheKey <font color="#009900">]</font> . <font color="#660066">length</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> query <font color="#339933">=</font> me.  <font color="#660066">getQuery</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> i <font color="#339933">=</font> <font color="#CC0000">0</font> <font color="#339933">;</font> <br><br>  <font color="#000066">return</font> query <br>  .  <font color="#660066">then</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> clients <font color="#009900">)</font> <font color="#009900">{</font> <br>  me.  <font color="#660066">cache</font> <font color="#009900">[</font> cacheKey <font color="#009900">]</font> <font color="#339933">=</font> clients.  <font color="#660066">map</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> item <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> <font color="#009900">{</font> <br>  key <font color="#339933">:</font> <font color="#3366CC">''</font> <font color="#339933">+</font> <font color="#009900">(</font> i <font color="#339933">++</font> <font color="#009900">)</font> <font color="#339933">,</font> <br>  data <font color="#339933">:</font> item <br>  groupKey <font color="#339933">:</font> item.  <font color="#660066">secondName</font> .  <font color="#660066">length</font> <font color="#339933">&gt;</font> <font color="#CC0000">0</font> <font color="#339933">?</font>  item.  <font color="#660066">secondName</font> .  <font color="#660066">substring</font> <font color="#009900">(</font> <font color="#CC0000">0</font> <font color="#339933">,</font> <font color="#CC0000">1</font> <font color="#009900">)</font> .  <font color="#660066">toUpperCase</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">:</font> <font color="#3366CC">'-'</font> <br>  <font color="#009900">}</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> filtered <font color="#339933">=</font> me.  <font color="#660066">applyFilters</font> <font color="#009900">(</font> <font color="#009900">{</font> items <font color="#339933">:</font> clients <font color="#339933">,</font> offset <font color="#339933">:</font> <font color="#CC0000">0</font> <font color="#339933">,</font> totalCount <font color="#339933">:</font> clients. <font color="#660066">length</font> <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">return</font> filtered.  <font color="#660066">items</font> .  <font color="#660066">length</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  addFilter <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> filter <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">this</font> .  <font color="#660066">filters</font> <font color="#339933">=</font> <font color="#000066">this</font> .  <font color="#660066">filters</font> <font color="#339933">||</font>  <font color="#009900">[</font> <font color="#009900">]</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">filters</font> .  <font color="#660066">push</font> <font color="#009900">(</font> filter <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  applyFilters <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> result <font color="#009900">)</font> <font color="#009900">{</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> <font color="#339933">!</font> <font color="#000066">this</font> . <font color="#660066">filters</font> <font color="#339933">||</font> <font color="#339933">!</font> <font color="#000066">this</font> . <font color="#660066">filters</font> . <font color="#660066">length</font> <font color="#009900">)</font> <br>  <font color="#000066">return</font> result <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">filters</font> .  <font color="#660066">forEach</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> filter <font color="#009900">)</font> <font color="#009900">{</font> <br>  result <font color="#339933">=</font> filter <font color="#009900">(</font> result <font color="#339933">,</font> me. <font color="#660066">condition</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">return</font> result <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">,</font> <br>  itemsFromIndex <font color="#339933">:</font> <font color="#000066">function</font> <font color="#009900">(</font> requestIndex <font color="#339933">,</font> countBefore <font color="#339933">,</font> countAfter <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> me <font color="#339933">=</font> <font color="#000066">this</font> <font color="#339933">;</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> requestIndex <font color="#339933">&gt; =</font> me. <font color="#660066">options</font> . <font color="#660066">maxCount</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> winJs.  <font color="#660066">Promise</font> .  <font color="#660066">wrapError</font> <font color="#009900">(</font> <font color="#000066">new</font> winJs. <font color="#660066">ErrorFromName</font> <font color="#009900">(</font> winJs. <font color="#660066">UI</font> . <font color="#660066">FetchError</font> . <font color="#660066">doesNotExist</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#000066">var</font> fetchSize <font color="#339933">,</font> fetchIndex <font color="#339933">;</font> <br>  <font color="#000066">if</font> <font color="#009900">(</font> countBefore <font color="#339933">&gt;</font> countAfter <font color="#009900">)</font> <font color="#009900">{</font> <br>  countAfter <font color="#339933">=</font> <font>Math</font> .  <font color="#660066">min</font> <font color="#009900">(</font> countAfter <font color="#339933">,</font> <font color="#CC0000">10</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> fetchBefore <font color="#339933">=</font> <font>Math</font> .  <font color="#660066">max</font> <font color="#009900">(</font> <font>Math</font> . <font color="#660066">min</font> <font color="#009900">(</font> countBefore <font color="#339933">,</font> me. <font color="#660066">options</font> . <font color="#660066">maxPageSize</font> <font color="#339933">-</font> <font color="#009900">(</font> countAfter <font color="#339933">+</font> <font color="#CC0000">1</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">,</font> me. <font color="#660066">options</font> . <font color="#660066">minPageSize</font> <font color="#339933">-</font> <font color="#009900">(</font> countAfter <font color="#339933">+</font> <font color="#CC0000">1</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  fetchSize <font color="#339933">=</font> fetchBefore <font color="#339933">+</font> countAfter <font color="#339933">+</font> <font color="#CC0000">1</font> <font color="#339933">;</font> <br>  fetchIndex <font color="#339933">=</font> requestIndex <font color="#339933">-</font> fetchBefore <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#000066">else</font> <font color="#009900">{</font> <br>  countBefore <font color="#339933">=</font> <font>Math</font> .  <font color="#660066">min</font> <font color="#009900">(</font> countBefore <font color="#339933">,</font> <font color="#CC0000">10</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> fetchAfter <font color="#339933">=</font> <font>Math</font> .  <font color="#660066">max</font> <font color="#009900">(</font> <font>Math</font> . <font color="#660066">min</font> <font color="#009900">(</font> countAfter <font color="#339933">,</font> me. <font color="#660066">options</font> . <font color="#660066">maxPageSize</font> <font color="#339933">-</font> <font color="#009900">(</font> countBefore <font color="#339933">+</font> <font color="#CC0000">1</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">,</font> me. <font color="#660066">options</font> . <font color="#660066">minPageSize</font> <font color="#339933">-</font> <font color="#009900">(</font> countBefore <font color="#339933">+</font> <font color="#CC0000">1</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  fetchSize <font color="#339933">=</font> countBefore <font color="#339933">+</font> fetchAfter <font color="#339933">+</font> <font color="#CC0000">1</font> <font color="#339933">;</font> <br>  fetchIndex <font color="#339933">=</font> requestIndex <font color="#339933">-</font> countBefore <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#000066">var</font> cacheKey <font color="#339933">=</font> JSON.  <font color="#660066">stringify</font> <font color="#009900">(</font> me. <font color="#660066">condition</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> result <font color="#339933">=</font> <font color="#000066">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> cache <font color="#339933">=</font> me.  <font color="#660066">cache</font> <font color="#009900">[</font> cacheKey <font color="#009900">]</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> items <font color="#339933">=</font> cache.  <font color="#660066">slice</font> <font color="#009900">(</font> fetchIndex <font color="#339933">,</font> fetchIndex <font color="#339933">+</font> fetchSize <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> offset <font color="#339933">=</font> requestIndex <font color="#339933">-</font> fetchIndex <font color="#339933">;</font> <br>  <font color="#000066">var</font> totalCount <font color="#339933">=</font> <font>Math</font> .  <font color="#660066">min</font> <font color="#009900">(</font> cache. <font color="#660066">length</font> <font color="#339933">,</font> me. <font color="#660066">options</font> . <font color="#660066">maxCount</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> r <font color="#339933">=</font> <font color="#009900">{</font> <br>  items <font color="#339933">:</font> items <font color="#339933">,</font> <br>  offset offset <font color="#339933">,</font> <br>  totalCount <font color="#339933">:</font> totalCount <font color="#339933">,</font> <br>  <font color="#009900">}</font> <font color="#339933">;</font> <br>  <font color="#000066">var</font> filtered <font color="#339933">=</font> me.  <font color="#660066">applyFilters</font> <font color="#009900">(</font> r <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">return</font> filtered <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">;</font> <br><br>  <font color="#000066">if</font> <font color="#009900">(</font> cacheKey <font color="#000066">in</font> me. <font color="#660066">cache</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> winjs.  <font color="#660066">Promise</font> .  <font color="#660066">wrap</font> <font color="#009900">(</font> result <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#000066">var</font> query <font color="#339933">=</font> me.  <font color="#660066">getQuery</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">return</font> query <br>  .  <font color="#660066">then</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> items <font color="#009900">)</font> <font color="#009900">{</font> <br><br>  <font color="#000066">var</font> i <font color="#339933">=</font> <font color="#CC0000">0</font> <font color="#339933">;</font> <br><br>  me.  <font color="#660066">cache</font> <font color="#009900">[</font> cacheKey <font color="#009900">]</font> <font color="#339933">=</font> items.  <font color="#660066">map</font> <font color="#009900">(</font> <font color="#000066">function</font> <font color="#009900">(</font> item <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">return</font> <font color="#009900">{</font> <br>  key <font color="#339933">:</font> <font color="#3366CC">''</font> <font color="#339933">+</font> <font color="#009900">(</font> fetchIndex <font color="#339933">+</font> i <font color="#339933">++</font> <font color="#009900">)</font> <font color="#339933">,</font> <br>  data <font color="#339933">:</font> item <br>  groupKey <font color="#339933">:</font> item.  <font color="#660066">secondName</font> .  <font color="#660066">length</font> <font color="#339933">&gt;</font> <font color="#CC0000">0</font> <font color="#339933">?</font>  item.  <font color="#660066">secondName</font> .  <font color="#660066">substring</font> <font color="#009900">(</font> <font color="#CC0000">0</font> <font color="#339933">,</font> <font color="#CC0000">1</font> <font color="#009900">)</font> .  <font color="#660066">toUpperCase</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">:</font> <font color="#3366CC">'-'</font> <br>  <font color="#009900">}</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">return</font> result <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">var</font> clientsDataSource <font color="#339933">=</font> winJs.  <font color="#660066">Class</font> .  <font color="#660066">derive</font> <font color="#009900">(</font> winJs. <font color="#660066">UI</font> . <font color="#660066">VirtualizedDataSource</font> <font color="#339933">,</font> <font color="#000066">function</font> <font color="#009900">(</font> condition <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000066">var</font> dataAdapter <font color="#339933">=</font> <font color="#000066">new</font> clientSearchDataAdapter <font color="#009900">(</font> <font color="#009900">{</font> <br>  dataSource <font color="#339933">:</font> <font color="#000066">this</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">setCondition</font> <font color="#339933">=</font> <font color="#000066">function</font> <font color="#009900">(</font> cond <font color="#009900">)</font> <font color="#009900">{</font> <br>  dataAdapter.  <font color="#660066">condition</font> <font color="#339933">=</font> cond <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">addFilter</font> <font color="#339933">=</font> <font color="#000066">function</font> <font color="#009900">(</font> filter <font color="#009900">)</font> <font color="#009900">{</font> <br>  dataAdapter.  <font color="#660066">addFilter</font> <font color="#009900">(</font> filter <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> ._baseDataSourceConstructor <font color="#009900">(</font> dataAdapter <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#000066">this</font> .  <font color="#660066">setCondition</font> <font color="#009900">(</font> condition <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br><br>  winJs.  <font color="#660066">Namespace</font> .  <font color="#660066">define</font> <font color="#009900">(</font> <font color="#3366CC">'HabraWin.DataSources'</font> <font color="#339933">,</font> <font color="#009900">{</font> <br>  ClientSearch <font color="#339933">:</font> clientsDataSource <br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> <br><br>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#009900">(</font> WinJS <font color="#339933">,</font> console <font color="#009900">)</font> <font color="#339933">;</font> </div></div><br><br><h1>  Tile </h1><br>  In Win8 there is a great opportunity for the applications that the user has added to the start panel to display the most valuable information at one time or another. <br>  In the example below, I use the template TileWideSmallImageAndText03, <a href="http://msdn.microsoft.com/library/windows/apps/windows.ui.notifications.tiletemplatetype">all possible templates can be seen on msdn</a> <br>  Sample code for updating tiles: <br><pre> <code class="javascript hljs">; (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">winJs, ui, dom</span></span></span><span class="hljs-function">) </span></span>{ winJs.Namespace.define(<span class="hljs-string"><span class="hljs-string">'HabraWin'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">Tile</span></span>: { <span class="hljs-comment"><span class="hljs-comment">//  xml  tile- wideSmallImageAndText03: function(img, text) { var tileXmlString = '&lt;tile&gt;&lt;visual version="1" lang="ru-RU" branding="logo"&gt;' + '&lt;binding template="TileWideSmallImageAndText03"&gt;' + '&lt;image id="1" src="' + img + '" alt="logo" /&gt;' + '&lt;text id="1"&gt;' + text + '&lt;/text&gt;' + '&lt;/binding&gt;' + '&lt;/visual&gt;&lt;/tile&gt;'; var tileDom = new dom.XmlDocument(); tileDom.loadXml(tileXmlString); //   xml  return new ui.Notifications.TileNotification(tileDom); }, baseUrl: '', //  tile-   updateTile: function() { var tileUpdateManager = ui.Notifications.TileUpdateManager.createTileUpdaterForApplication(); var me = this; var mesageAccepted = WinJS.Resources.getString('tileMessageAccepted').value; var mesageDenied = WinJS.Resources.getString('tileMessageDenied').value; tileUpdateManager.clear(); tileUpdateManager.enableNotificationQueue(true); [ { Creator: { ID: '30BD3259-EF01-4ebb-ACEE-5065EB2885E1', Photo: true }, Description: mesageAccepted }, { Creator: { ID: 'A2021DFE-1271-41d1-9A90-A64039A8A5E6', Photo: true }, Description: mesageDenied } ].forEach(function(comment) { var img = (comment.Creator &amp;&amp; comment.Creator.Photo &amp;&amp; (me.baseUrl + '/clients/photos/' + comment.Creator.ID)) || 'appx:///images/empty.png'; var text = (comment.Description) || '...'; var tile = me.wideSmallImageAndText03(img, text); tileUpdateManager.update(tile); }); } } }); })(WinJS, Windows.UI, Windows.Data.Xml.Dom);</span></span></code> </pre></div><p>Source: <a href="https://habr.com/ru/post/216135/">https://habr.com/ru/post/216135/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../216121/index.html">CubeStormer 3 collects the Rubik's Cube in 3 seconds</a></li>
<li><a href="../216123/index.html">Accounts of the Ukrainian division of WebMoney are unblocked, WMU withdrawal resumed</a></li>
<li><a href="../216129/index.html">The strategy of the game "mafia" in terms of transaction analysis</a></li>
<li><a href="../216131/index.html">Denial of Service Attacks: Testing Practice</a></li>
<li><a href="../216133/index.html">A game about crazy geek scientists and a little enchanting localization story</a></li>
<li><a href="../216137/index.html">Students, where are you? You need PostgreSQL!</a></li>
<li><a href="../216141/index.html">Rails 4 Engines. Gem development through mountable engine - we read server logs</a></li>
<li><a href="../216145/index.html">Neuroplasticity - 8 changes in man, formed under the influence of technology</a></li>
<li><a href="../216149/index.html">Simple transmission to Google Analytics of form filling error events in Magento (and not only)</a></li>
<li><a href="../216153/index.html">"Forbid them to ban" or the reverse side of the registry of banned sites</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>