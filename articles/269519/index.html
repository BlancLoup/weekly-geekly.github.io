<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cryptanalysis "Enigma"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All specialists unanimously agreed to read. 
 Admiral Kurt Fricke, Chief of Naval War Command 

 Enigma is a rotary ciphering machine used by Nazi Ger...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cryptanalysis "Enigma"</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/de9/379/7ba/de93797bab8cc9a28c86be018ba9a908.jpg" alt="image"></div><br>  All specialists unanimously agreed to read. <br>  <i>Admiral Kurt Fricke, Chief of Naval War Command</i> <br><br>  Enigma is a rotary ciphering machine used by Nazi Germany during the Second World War.  Thanks to the influence exerted on the course of the war, the breaking of the Enigma was perhaps the highlight of the centuries-old history of cryptanalysis.  In this topic, I would like to talk about the hacking method used in Bletchley Park, as well as describe the device of the machine itself. <br><a name="habracut"></a><br><h4>  Rotary machines </h4><br>  For the first time cryptographic rotary machines began to be used in the early 20th century.  The main component of such devices is a disk (aka the rotor) with 26 electrical contacts on both sides of the disk.  Each contact corresponded to the letter of the English alphabet.  The contact connection of the left and right sides implemented a simple replacement cipher.  When the disk was rotated, the contacts shifted, thereby changing the substitution for each letter.  One disc provided 26 different substitutions.  This means that when encrypting the same character, the resulting sequence begins to repeat after 26 steps. <br>  To increase the sequence period, you can use several rotors connected in series.  When making a full turn of one of the disks, the next disk moves one position.  This increases the length of the sequence to 26 <sup>n</sup> , where n is the number of rotors connected in series. <br>  As an example, consider the following image of a simplified rotary machine: <br><img src="https://habrastorage.org/files/e25/56d/b35/e2556db351ad486e9d722218869cde77.png"><br>  The given machine consists of a keyboard (for entering a character), three disks, an indicator (for displaying a cryptotext) and implements 4 characters encryption: A, B, C, D. In the initial position, the first disk implements a substitution: AC;  BA;  CB;  DD  The substitutions of the second and third disks are equal to AB;  BC;  CA;  DD and AA;  BC;  CB;  DD, respectively. <br>  When you press the letter B on the keyboard closes the electrical circuit, depending on the current position of the rotors, and the light on the indicator lights up.  In the example above, the letter B will be encrypted in C. Then the first rotor will move one position and the machine settings will take the following form: <br><img src="https://habrastorage.org/files/434/356/0fa/4343560fae1c4900800481ae5cbe1909.png"><br><br><h4>  Enigma </h4><br>  Enigma is the most popular representative of the world of cryptographic rotary machines.  It was used by German troops during the Second World War and was considered practically unbreakable. <br>  The Enigma encryption procedure is implemented as in the example above, with the exception of some additional strokes. <br>  First, the number of rotors in different versions of the Enigma could be different.  The most common was the Enigma with three rotors, but the four-disk version was also used. <br>  Secondly, the decryption process of the demo rotary machine described above is different from the encryption process.  Each time, for decryption, the left and right rotor will have to be replaced in places, which may not be very convenient.  To solve this problem, another disk was added to the Enigma, called a reflector.  In the reflector, all contacts were connected in pairs, thereby realizing the repeated passage of the signal through the rotors, but by a different route.  Unlike the other rotors, the reflector was always in a fixed position and did not rotate. <br><img src="https://habrastorage.org/files/828/0d5/9dd/8280d59ddae4415b9f1daec2fd0098c0.png"><br>  Add a replacement reflector (AB; CD) to our demo encryption machine.  When you press the key B, the signal passes through the rotors and enters the reflector through the contact C. Here the signal "reflects" and returns, passing through the rotors in the reverse order and in a different way.  As a result, the letter B on the output is converted to D. <br>  Note that if you press the D key, the signal will go along the same circuit, converting D to B. Thus, the presence of a reflector made the encryption and decryption processes identical. <br>  Another property of the Enigma associated with the reflector is the impossibility of encrypting any letter in itself.  This property has played a very important role in hacking Enigma. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The resulting device is already very similar to the real Enigma.  With one minor caveat.  The resistance of such a machine rests on the secrecy of the internal switching of the rotors.  If the device rotors will be disclosed, then hacking is reduced to the selection of their initial positions. <br>  Since each rotor can be in one of 26 positions, for three rotors we get 26 <sup>3</sup> = 17476 variants.  At the same time, the rotors themselves can also be arranged in an arbitrary order, which increases the difficulty by 3!  time.  Those.  the key space of such a machine will be 6 * 17576 = 105456.  This is clearly not enough to ensure a high level of security.  Therefore, the Enigma was equipped with another additional tool: a <b>patch panel</b> .  Connecting letters on the patch panel in pairs could add one more additional step to encryption. <br><img src="https://habrastorage.org/files/20e/4a2/bdb/20e4a2bdbb084ed7af1ede4a73783047.png"><br>  For example, suppose that the letter B is connected to the letter A on the switching panel. Now when you press A, AB is first substituted, and the letter B is fed to the input of the first rotor <br>  Similarly, the message is decrypted.  When the D key is pressed, the rotors and the reflector convert the DDDDCBAB.  After which the patch panel converts B to A. <br><br><h4>  Enigma Resistance Analysis </h4><br>  The real Enigma was different from the one described in the demonstration machine.  Namely, the device rotors.  In our example, the rotor changes its position only when a full turn is made by the previous disc.  In the present Enigma, each disc had a special notch that, in a certain position, hooked the next rotor and shifted it by one position. <br>  The location of the groove for each of the rotors could be adjusted using special external rings.  The initial position of the rings did not affect the switching of the rotors and the result of encrypting a single letter, so the rings are not taken into account when calculating the key space of the Enigma. <br>  So, the base model of the Enigma had 3 different rotors, numbered in roman numerals I, II, III and implementing the following substitutions: <br>  Entry = ABCDEFGHIJKLMNOPQRSTUVWXYZ <br>  I = EKMFLGDQVZNTOWYHXUSPAIBRCJ <br>  II = AJDKSIRUXBLHWTMCQGZNPYFVOE <br>  III = BDFHJLCPRTXVZNYEIWGAKMUSQO <br>  When encrypting, the rotors could be arranged in any sequence, which for 6 rotors gives 6 different combinations. <br>  In addition, each rotor could be installed in one of the 26 possible starting positions.  Those.  the initial position of the rotors has a total <br>  6 * 26 <sup>3</sup> = 105456 combinations. <br>  The number of all possible connections on the switching panel is calculated by the formula n!  / ((n-2m)! m! 2 <sup>m</sup> ), where n is the number of letters of the alphabet, m is the number of connected pairs. <br>  For 26 letters of the English alphabet and 10 pairs, this is 150738274937250 = 2 <sup>47</sup> different combinations. <br>  Thus, the basic version of the Enigma with three rotors had a solid key space even by modern standards: <br>  150738274937250 * 105456 = 15.896,255,521,782,636,000‚âà2 <sup>64</sup> . <br>  Such a huge number of options inspired a deceptive feeling of invulnerability. <br><br><h4>  Enigma Cryptanalysis </h4><br>  A large key space provides the Enigma cipher with a rather serious level of resistance to attacks using a well-known ciphertext. <br>  A complete search of 2 <sup>64</sup> options, even on modern computers, is not a simple matter. <br>  However, everything changes if you apply the attack with known plaintext.  For such a case, there is a very clever method that allows you to neglect the settings of the switching panel in the process of searching for a key combination, which reduces the key space of the Enigma to only 105,456 combinations and makes the entire cipher fatally vulnerable. <br><br>  The method exploits the presence of a pair of open-closed text of the so-called "cycles".  To explain the concept of "cycle", consider the following open message P and its corresponding cryptotext C, encoded by the Enigma. <br><br>  P = WETTERVORHERSAGEBISKAYA <br>  C = RWIVTYRESXBFOGKUHQBAISE <br>  We write each symbol of the pair in the form of a table: <br><table><tbody><tr><td>  one </td><td>  2 </td><td>  3 </td><td>  four </td><td>  five </td><td>  6 </td><td>  7 </td><td>  eight </td><td>  9 </td><td>  ten </td><td>  eleven </td><td>  12 </td><td>  13 </td><td>  14 </td><td>  15 </td><td>  sixteen </td><td>  17 </td><td>  18 </td><td>  nineteen </td><td>  20 </td><td>  21 </td><td>  22 </td><td>  23 </td></tr><tr><td>  w </td><td>  e </td><td>  t </td><td>  t </td><td>  e </td><td>  r </td><td>  v </td><td>  o </td><td>  r </td><td>  h </td><td>  e </td><td>  r </td><td>  s </td><td>  a </td><td>  g </td><td>  e </td><td>  b </td><td>  i </td><td>  s </td><td>  k </td><td>  a </td><td>  y </td><td>  a </td></tr><tr><td>  r </td><td>  w </td><td>  i </td><td>  v </td><td>  t </td><td>  y </td><td>  r </td><td>  e </td><td>  s </td><td>  x </td><td>  b </td><td>  f </td><td>  o </td><td>  g </td><td>  k </td><td>  u </td><td>  h </td><td>  q </td><td>  b </td><td>  a </td><td>  i </td><td>  s </td><td>  e </td></tr></tbody></table><br>  Pay attention to the substitutions implemented by the enigma in 14, 15 and 20 positions.  At step 14, the letter A is encrypted in G. The latter, in turn, is encrypted in K at step 15.  And then the letter K is encrypted in A in step 20, thereby looping the AGKA chain.  Such looped chains are called cycles.  The presence of cycles allows you to divide the task of breaking Enigma into two simple components: 1) search for the starting position of the rotors and 2) search for connections of the patch panel with known rotor installations. <br><br>  We know that several transformations occur during encryption in the Enigma.  First, the signal passes through the patch panel.  The result of the conversion on the switching panel enters the rotors.  After that, the signal reaches the reflector and returns through the rotors to the switching panel, where the last substitution is performed.  All these operations can be represented by a mathematical formula: <br>  E <sub>i</sub> = S <sup>-1</sup> R <sup>-1</sup> TRS, where <br>  S and S <sup>-1</sup> , - conversion on the input and output switchboard, respectively; <br>  R and R <sup>-1</sup> - conversion in the rotors at the input and output; <br>  T - conversion on the reflector. <br>  Lowering the switch panel, we express the internal transformation of the Enigma through P <sub>i</sub> : <br>  Pi = R <sup>-1</sup> TR <br>  Now encryption can be written as: <br>  E <sub>i</sub> = S <sup>-1</sup> P <sub>i</sub> S <br><br>  Using the formula we rewrite the substitutions from the example in 14, 15 and 20 positions. <br>  S <sup>-1</sup> P <sub>14</sub> S (A) = G or that the same P <sub>14</sub> S (A) = S (G). <br>  P <sub>15</sub> S (G) = S (K) <br>  P <sub>20</sub> S (K) = S (A) <br>  Replacing in the last expression S (K) we get: <br>  P <sub>20</sub> P <sub>15</sub> P <sub>14</sub> S (A) = S (A) (1), where S (A) is the letter connected to A on the patch panel. <br>  Now the attack is reduced to a trivial enumeration of all possible rotor settings.  For each combination of rotors, it is necessary to verify the equality (1).  If the equality is performed for the letter S, this means that the correct configuration of the rotors is found and that the letter A is connected to the switchboard with the letter S. The search for the remaining pairs is reduced to deciphering the cryptotext and comparing the result with known plaintext. <br>  It should be noted that with a probability of 1/26 equality can be performed even if rotors are installed incorrectly, therefore, it is desirable to use several ‚Äúcycles‚Äù to increase the reliability of the algorithm. <br>  Another important point is that the attacker may only know part of the encrypted message.  And in this case, first of all, he will need to find the location of the known text in the received cryptogram.  The knowledge of the fact that Enigma never encrypts a letter into itself helps a great deal in this task.  Those.  To find the correct offset, you need to find such a position in the cryptotext in which none of the letters of the closed text is duplicated by the letter of the open message. <br><br><h4>  PS </h4><br>  A very slow, but quite working implementation of the Python attack can be viewed on <a href="https://github.com/NeverWalkAloner/BreakEnigma">GitHub</a> . <br><br><h4>  Links </h4><br><ul><li>  <a href="http://users.telenet.be/d.rijmenants/en/enigmatech.htm">Detailed Description of Enigma</a> </li><li>  <a href="http://www.codesandciphers.org.uk/enigma/index.htm">Enigma description with examples</a> </li><li>  <a href="http://www.ellsbury.com/enigmabombe.htm">Detailed Description of the Turing Bomb</a> </li><li>  <a href="http://people.physik.hu-berlin.de/~palloks/js/enigma/enigma-u_v20_en.html">A great simulator of different versions of the Enigma</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/269519/">https://habr.com/ru/post/269519/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269509/index.html">Tibero. First pancake</a></li>
<li><a href="../269511/index.html">Little about query optimization</a></li>
<li><a href="../269513/index.html">Email Security Overview</a></li>
<li><a href="../269515/index.html">What version control system do you use (in real work, most of all)?</a></li>
<li><a href="../269517/index.html">Integrating Admob Native Ads into ListView</a></li>
<li><a href="../269521/index.html">German intelligence agencies have discovered new traces of the Regin virus</a></li>
<li><a href="../269525/index.html">HackerSIM: Debriefing</a></li>
<li><a href="../269527/index.html">Participation in the competition LudumDare # 33</a></li>
<li><a href="../269529/index.html">Cisco switch stacking. Part 1</a></li>
<li><a href="../269531/index.html">Why writing scripts to fight Amigo browser is evil?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>