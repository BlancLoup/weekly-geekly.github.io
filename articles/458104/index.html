<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>RDMA inside the data center in the implementation of Huawei</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Under the cut, what approach does Huawei offer when organizing remote direct memory access using AI Fabric technology and how does it differ from Infi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>RDMA inside the data center in the implementation of Huawei</h1><div class="post__text post__text-html js-mediator-article">  Under the cut, what approach does Huawei offer when organizing remote direct memory access using AI Fabric technology and how does it differ from InfiniBand and ‚Äúpure‚Äù Ethernet-based RDMA. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/77f/e62/b1c/77fe62b1c70a12e4e4466074c4e81ce8.png"><br><a name="habracut"></a><br>  Distributed computing is used in a wide variety of industries.  This research and technical development like facial recognition or autopilot, and industry.  In general, data analysis is finding more and more applications, and one can say with confidence that it will not lose popularity in the near future.  In fact, we are now experiencing a transition from the era of cloud computing, where the most important factors were application and speed of service deployment, to the era of data monetization, including through the use of artificial intelligence algorithms.  According to our internal data (report <a href="https://www.huawei.com/en/press-events/news/2018/4/huawei-global-industry-vision-2025">GIV 2025: Unfolding the Industry Blueprint of an Intelligent World</a> ) by 2025, 86% of companies will use AI in their work.  Many of them view this direction as a key to modernizing activities and, possibly, a basic tool for making business decisions in the future.  And this means that each of these companies will need some kind of raw data processing - most likely through distributed clusters. <br><br><h2>  The evolution of architecture </h2><br>  With the growing popularity of distributed calculations, the amount of traffic exchanged between individual data center machines increases.  Traditionally, when discussing networks, attention is focused on the growth of traffic between the data center and end users on the Internet, and it is really growing.  But the growth of horizontal traffic within distributed systems far exceeds that generated by users.  According to Facebook, the traffic between their internal systems doubles in less than a year. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/11e/9fb/c67/11e9fbc6722ddb012e7b925bc139ecfa.png"><br><br>  In attempts to cope with this traffic, you can increase the clusters, but you can not do this indefinitely.  Therefore, predicting the growth of computational load on clusters, it is necessary to increase processing efficiency ‚Äî first of all, find and eliminate bottlenecks within these distributed networks. <br><br>  If earlier the ‚Äúweak link‚Äù of distributed systems was the resources of each of these systems separately, while the constantly developing data transmission networks even overtook the needs, today network communications are the main source of the problem.  The usual TCP / IP protocol stack and tree topology no longer correspond to the tasks.  Therefore, more and more data centers are abandoning the centralized and moving to a new CLOS-architecture that provides greater bandwidth and better cluster scalability, as, for example, Facebook did a few years ago. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ae5/4eb/9a4/ae54eb9a4b0762eae67a4f523b5480f0.png"><br><br>  At the same time, it is necessary to optimize the process at another level - at the level of interaction of two separate systems.  In this article we want to talk about what optimization tools provides data center Huawei Ai Fabric.  This is our proprietary technology that accelerates data exchange between nodes. <br><br><h2>  Networking Changes </h2><br>  The main ‚Äútrick‚Äù of Huawei Ai Fabric is the reduction of overhead costs for transferring data packets between systems within the cluster through the implementation of RDMA (Remote Direct Memory Access) - direct memory access by the systems included in the cluster. <br><br><h3>  RDMA - a way to reduce transmission delays </h3><br>  RDMA is not a new idea.  The technology provides direct data exchange between the memory and the network interface, reducing waiting time and eliminating unnecessary copying of data to the buffers.  Its roots go back to the 1990s of Compaq, Intel, and Microsoft. <br><br>  There are three types of delays in transmitting a packet from one system to another: <br><br><ul><li>  due to the processor processing required, for example, for buffering data in the OS and calculating the check sums; <br></li><li>  due to busses and data transmission channels (it is technically impossible to significantly increase the bandwidth); <br></li><li>  because of network equipment. <br></li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/3ce/c48/d2b/3cec48d2b4561be549997679868b61dd.png"><br><br>  To reduce losses throughout this chain, back in the 1990s, it was proposed to use direct memory access for interacting systems ‚Äî the abstract Virtual Interface Architecture model.  Its main idea is that applications running on two interacting systems completely fill their local memory and establish a P2P data connection without affecting the OS.  Thus it is possible to significantly reduce delays in the transmission of packets.  In addition, since the VIA model did not imply the placement of transmitted data into intermediate buffers, it saved the resources needed for the copy operation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/251/502/d86/251502d86f133da73b76fe7b537a6ce9.png"><br><br>  With respect to the abstract model, VIA RDMA, as a technology, has gone a step further towards the optimal utilization of resources.  In particular, it does not wait for the buffer to complete the connection and allows connections with several computers simultaneously.  Due to this, the technology allows reducing transmission delays to 1 ms, reducing the load on the processor. <br><br><h3>  InfiniBand vs Ethernet </h3><br>  The two main implementations of RDMA on the market, the proprietary transport protocol InfiniBand and the ‚Äúpure‚Äù Ethernet-based RDMA, unfortunately, are not without flaws. <br><br>  The InfiniBand transport protocol has a built-in packet delivery control mechanism (protection against data loss), but is supported by specific equipment and is not compatible with Ethernet.  In fact, using this protocol closes the data center at one hardware vendor, which carries certain risks and promises complexity from the point of view of service (since InfiniBand has a small market share, finding specialists will not be so easy).  And, of course, when implementing a protocol, it is impossible to use already existing equipment of IP networks. <br><br>  RDMA over Ethernet allows you to use existing equipment on the network, supports Ethernet networks, and thus it will be easier to find service technicians.  Against the background of Infiniband it significantly reduces the cost of ownership of the infrastructure, simplifies its deployment. <br>  The only serious flaw that impeded the widespread use of RDMA over Ethernet is the lack of mechanisms to protect against packet loss, which limits the bandwidth of the entire network.  To reduce packet loss or prevent network congestion, third-party mechanisms should be used.  We went just this way by offering our own intelligent algorithms for compensating for the disadvantages of RDMA over Ethernet while maintaining its advantages in the new tool - Huawei Ai Fabric. <br><br><h3>  Huawei AI Fabric - your way </h3><br>  AI Fabric implements RDMA over Ethernet, complemented by its own intelligent network congestion control algorithm, which ensures zero packet loss, high network bandwidth and low transmission delay for RDMA streams. <br><br>  Huawei Ai Fabric is built on open standards and supports a range of different equipment that optimizes the implementation process.  However, some additional tools - add-ons over open standards that allow for more efficient data exchange, which we will discuss in subsequent publications - are available only for Huawei devices.  The CloudEngine series of switches supports the solution, integrates a chip that analyzes traffic characteristics and dynamically adjusts network parameters, which makes it possible to use the switch buffer more efficiently.  The collected characteristics are also used to predict traffic patterns in the future. <br><br><h2>  Who is it useful? </h2><br>  Huawei Ai Fabric allows you to get a profit on two levels. <br>  On the one hand, the solution allows optimizing the data center architecture - reducing the number of nodes (due to more optimal utilization of resources), creating a converged environment without the traditional division into separate subnets that are difficult and expensive to service in parts.  Using the tool, you do not have to allocate separate subnets for each type of service in the domain controller (with its own network requirements).  You can create a unified environment that ensures the provision of all services. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/054/849/c06/054849c06070cd3b2b59320d005d547b.png"><br><br>  On the other hand, AI Fabric allows you to increase the speed of distributed computing, especially where you often need to access the memory of remote systems.  For example, the introduction of AI in any field implies a period of learning of the algorithm, which can include millions of operations, so a gain in delay for each such operation will result in a serious acceleration of the process. <br><br>  The effect of the introduction of a specialized tool, such as Huawei Ai Fabric, will be noticeable in the data center with six or more switches.  But the greater the volume of the data center, the higher the profit - due to the optimal utilization of resources, a cluster of the same scale with Ai Fabric will provide higher performance.  For example, a cluster of 384 nodes can achieve the performance of a ‚Äúnormal‚Äù cluster of 512 nodes.  At the same time, the solution has no restrictions on the number of physical switches within the infrastructure.  There may be tens of thousands of them (if you forget that projects are usually limited to the scope of the administrative domain). </div><p>Source: <a href="https://habr.com/ru/post/458104/">https://habr.com/ru/post/458104/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../458092/index.html">Towards the core of Python</a></li>
<li><a href="../458096/index.html">What is the MERN stack and how to work with it?</a></li>
<li><a href="../458098/index.html">Pitfalls GDPR</a></li>
<li><a href="../4581/index.html">IE7 and CSS support: expert comments</a></li>
<li><a href="../458102/index.html">Effective web development workflow: Confluence, Airtable and other tools</a></li>
<li><a href="../458106/index.html">Jetpack Compose dive</a></li>
<li><a href="../45811/index.html">Black Triangle Dock in Leopard</a></li>
<li><a href="../458110/index.html">Dynamic programming in the real world: cutting seams</a></li>
<li><a href="../458112/index.html">Sony's Xperia 10 Review</a></li>
<li><a href="../458116/index.html">SwiftUI and auto-renewable subscriptions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>