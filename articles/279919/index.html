<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to use named constructors in PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="tl; dr - Do not limit yourself to one constructor in the classroom. Use static factory methods. 

 PHP allows you to use only one constructor in a cla...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to use named constructors in PHP</h1><div class="post__text post__text-html js-mediator-article">  <em>tl;</em>  <em>dr - Do not limit yourself to one constructor in the classroom.</em>  <em>Use static factory methods.</em> <br><br>  PHP allows you to use only one constructor in a class, which is rather annoying.  Probably, we will never get a normal opportunity to overload constructors in PHP, but something can still be done.  For example, take a simple class that stores the value of time.  What is the best way to create a new object: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $time = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Time(<span class="hljs-string"><span class="hljs-string">"11:45"</span></span>); $time = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Time(<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">45</span></span>);</code> </pre> <br>  The correct answer is "depending on the situation."  Both methods may be correct in terms of the result obtained.  We implement support for both methods: <br><a name="habracut"></a><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Time</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $hours, $minutes; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($timeOrHours, $minutes = null)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(is_string($timeOrHours) &amp;&amp; is_null($minutes)) { <span class="hljs-keyword"><span class="hljs-keyword">list</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hours, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;minutes) = explode($timeOrHours, <span class="hljs-string"><span class="hljs-string">':'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hours = $timeOrHours; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;minutes = $minutes; } } }</code> </pre><br>  Looks disgusting.  In addition, class support will be difficult.  What happens if we need to add a few more ways to create instances of the Time class? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $minutesSinceMidnight = <span class="hljs-number"><span class="hljs-number">705</span></span>; $time = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Time($minutesSinceMidnight);</code> </pre><br>  It is also probably worth adding support for numeric lines (fool protection does not hurt): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $time = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Time(<span class="hljs-string"><span class="hljs-string">"11"</span></span>, <span class="hljs-string"><span class="hljs-string">"45"</span></span>);</code> </pre><br><h4>  Reorganize code using named constructors </h4><br>  Add a few static methods to initialize Time.  This will allow us to get rid of the conditions in the code (which is often a good idea). <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Time</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $hours, $minutes; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($hours, $minutes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hours = (int) $hours; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;minutes = (int) $minutes; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($time)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">list</span></span>($hours, $minutes) = explode($time, <span class="hljs-string"><span class="hljs-string">':'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Time($hours, $minutes); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromMinutesSinceMidnight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($minutesSinceMidnight)</span></span></span><span class="hljs-function"> </span></span>{ $hours = floor($minutesSinceMidnight / <span class="hljs-number"><span class="hljs-number">60</span></span>); $minutes = $minutesSinceMidnight % <span class="hljs-number"><span class="hljs-number">60</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Time($hours, $minutes); } }</code> </pre><br>  Now each method satisfies the principle of Unified Responsibility.  The public interface is simple and straightforward.  It seems to be finished?  I'm still worried about the constructor, it uses the internal representation of the object, which makes it difficult to change the interface.  Let us suppose that for some reason we need to store the combined time value in string format, and not individually, as before: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Time</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $time; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($hours, $minutes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;time = <span class="hljs-string"><span class="hljs-string">"$hours:$minutes"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($time)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">list</span></span>($hours, $minutes) = explode($time, <span class="hljs-string"><span class="hljs-string">':'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Time($hours, $minutes); } <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre><br>  This is ugly: we have to break the string in order to reconnect it in the constructor.  Do we need a constructor for the constructor? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/475/e01/c97/475e01c9768377b2ac8967e94f4dfe20.jpg" alt="We built in you the designer in the designer ...." width="400" height="216"><br><br>  No, do without it.  We reorganize the work of the methods, to work with the internal representation directly, and the designer will be made private: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Time</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $hours, $minutes; <span class="hljs-comment"><span class="hljs-comment">//    , ..         private function __construct(){} public static function fromValues($hours, $minutes) { $time = new Time; $time-&gt;hours = $hours; $time-&gt;minutes = $minutes; return $time; } // ... }</span></span></code> </pre><br><h4>  Uniform language constructs </h4><br>  Our code has become cleaner, we have acquired several useful methods for initializing a new object.  But as often happens with good design decisions - previously hidden flaws are selected to the surface.  Take a look at an example of using our methods: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $time1 = Time::fromValues($hours, $minutes); $time2 = Time::fromString($time); $time3 = Time::fromMinutesSinceMidnight($minutesSinceMidnight);</code> </pre><br>  Did you notice anything?  Method naming is not uniform: <br><ul><li>  fromString - uses PHP implementation details in the name; </li><li>  fromValues ‚Äã‚Äã- uses a kind of general programming term; </li><li>  fromMinutesSinceMidnight - uses notation from the domain. </li></ul><br>  As language <del>  zadrot </del>  a geek, as well as an adherent of the Domain-Driven Design approach, I could not ignore this.  Since  The Time class is part of our subject area, I suggest using the terms of this same subject area to name methods: <br><ul><li>  fromString =&gt; fromTime </li><li>  fromValues ‚Äã‚Äã=&gt; fromHoursAndMinutes </li></ul><br>  This focus on the subject area gives us a wide scope for action: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $customer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Customer($name); <span class="hljs-comment"><span class="hljs-comment">//         //  ,    : $customer = Customer::fromRegistration($name); $customer = Customer::fromImport($name);</span></span></code> </pre><br>  Perhaps this approach will not always be justified, and this level of detail is superfluous.  We can use any of the options, but the most important thing is that named constructors give us the opportunity to choose. <br><hr><br>  Part 2: <a href="https://habrahabr.ru/post/279921/">When to use static methods</a> </div><p>Source: <a href="https://habr.com/ru/post/279919/">https://habr.com/ru/post/279919/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../279907/index.html">NetApp ONTAP Cloud: Amazon & Azure</a></li>
<li><a href="../279909/index.html">How to make content recommendations</a></li>
<li><a href="../279911/index.html">NetApp ONTAP: SnapMirror for SVM</a></li>
<li><a href="../279915/index.html">MongoDB tree storage</a></li>
<li><a href="../279917/index.html">Stop abusing arrays in PHP</a></li>
<li><a href="../279921/index.html">When to use static methods</a></li>
<li><a href="../279923/index.html">Automatic completion of JS-code from the base Stack Overflow</a></li>
<li><a href="../279925/index.html">JetBrains C ++ night: impressions and recordings of reports</a></li>
<li><a href="../279927/index.html">C ++ 17 that we lost</a></li>
<li><a href="../279929/index.html">Unity and Helpers for the editor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>