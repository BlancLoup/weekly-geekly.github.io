<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unusual use of the report generator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the dawn of his career, he had to deal with the maintenance and writing of accounting programs and accounting systems. Since then, despite the fact...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unusual use of the report generator</h1><div class="post__text post__text-html js-mediator-article">  At the dawn of his career, he had to deal with the maintenance and writing of accounting programs and accounting systems.  Since then, despite the fact that 18 years have passed, the rejection of everything related to accounting and reports has been steadfastly held.  And who would have thought that fate would send me to a company that develops a report generator.  My whole nature was stretched (and continues to stretch) to system programming, and participation in the development of software for generating reports is a punishment for the sins of youth.  As a matter of fact, this article talks about the attempt to ‚Äúbreak out of the cage‚Äù and combine the incompatible - system programming and report generators. <br><a name="habracut"></a><br>  Have you ever written documentation?  And if they wrote, what style was used - a dry description of the protocols or a live narration?  Why, I ask, because at one point I realized that my project required documentation.  Unlike the user's manual, the description of the protocols is a boring and monotonous document without allegories and lyrical digressions, only message formats describing the parameters transmitted and returned.  I used to use Microsoft Word and a style sheet for such things, but as it turned out, it‚Äôs very difficult to maintain an exact style with a monotonous description of the protocols.  Do not believe - try it yourself. <br><br>  At some point, an idea came - why not use a report generator to describe protocols?  Firstly, there is no need to buy funds to generate documentation, secondly, the ability to become a user of a product developed by my employer, thirdly, the ability to export to various formats, fourthly, a real opportunity to separate information from its presentation. <br><br>  No sooner said than done.  As a source of information was taken Microsoft Access database.  The structure of the database is organized as follows - the main information is located in three related tables: <br><img src="https://habrastorage.org/storage1/a7028d43/ce6b74fc/79c98a1e/c9aae56a.png"><br>  The <b>Protocols</b> Master Table contains a list and description of the basic protocols. <br>  Detail <b>Methods</b> table contains a list of protocol methods (functions). <br>  Subdetail table <b>Arguments</b> contains a list of parameters (arguments) for each method. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a generator of documentation - FastReport.VCL report generator.  Start the report designer, select the Data tab and create a new ADO connection: <br><img src="https://habrastorage.org/storage1/0ac2b6eb/9f942155/d0321969/67afe10f.png"><br>  I used the assistant built into the report generator and received the following line: <br><blockquote>  <i>Provider = Microsoft.Jet.OLEDB.4.0; User ID = Admin; Data Source = ProtocolsSpecifications.mdb; Mode = Share Deny None; Jet OLEDB: System database = ""; Jet OLEDB: Registry Path = ""; Jet OLEDB: Database Password = ""; Jet OLEDB: Engine Type = 5; Jet OLEDB: Database Locking Mode = 1; Jet OLEDB: Global Partial Bulk Ops = 2; Jet OLEDB: Global Bulk Transactions = 1; Jet OLEDB: New Database Password = "" ; Jet OLEDB: Create System Database = False; Jet OLEDB: Encrypt Database = False; Jet OLEDB: Don't Copy Locale on Compact = False; Jet OLEDB: Compact Without Replica Repair = False; Jet OLEDB: SFP = False;</i> <i><br></i> </blockquote><br><br>  Then I added three data sources to the ADO connection, linking them together to a Master-Detail-Subdetail bundle using three SQL queries. <br><br><img src="https://habrastorage.org/storage1/df5ef7ab/14884551/dc1e93e9/a38be175.png"><br><br>  Here are the queries: <br>  Protocols: <br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">SELECT</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">P</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Name</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">P</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Description</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">P</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ProtocolID</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">P</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Description_Rus</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FROM</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Protocols</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">P</span></span></code> </pre> <br>  Methods: <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> S.ProtocolID, S.Label, S.Name, S.Description, S.Description_Rus, S.ID <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Methods S <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> S.ProtocolID =:ProtocolID <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> S.Label</code> </pre><br>  Arguments: <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> A.ID, A.InOutFlag, A.<span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>, A.TypedUntypedFlag, A1.Name, A.Name, A.Description <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Arguments A <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> ArgType A1 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (A.TypedUntypedFlag=A1.ID) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> A.ID =:ID <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> A.ID , A.InOutFlag <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>, A.<span class="hljs-keyword"><span class="hljs-keyword">Index</span></span></code> </pre> <br><br>  After that you can add a new page to the report and compile the report. <br><br><img src="https://habrastorage.org/storage1/98ba35c7/96f4b881/8c9d4c16/c5367504.png"><br><br>  Have you ever compared the hardware specifications from Intel and AMD?  If so, then in whose favor?  In my opinion, the documentation from Intel is more convenient for perception and work with it due to the presence in the document of many cross-references and a magnificent outline.  To add outline to the documentation, it is necessary to tell the report generator how and where to get the information.  For this, the band object (the data selected from the database is actually displayed on it) has the OutlineText property, which can be filled with both static text and from the database.  Since the bands can be nested, the information in the outline is obtained in the form of a tree where the branches correspond to the nesting of the bands: <br><img src="https://habrastorage.org/storage1/9f56bad3/120fefbc/1a5d5c8a/600ab197.png"><br><br>  The best part is that when exporting the generated document to PDF, the outline is also exported. <br><br>  This article would not have appeared if I didn‚Äôt feel a bit crowded within the framework of the FastReport.VCL report generator.  The fact is that in one form or another I already played up using the report generator to create documentation on various Internet resources, but suddenly a whim came to me in the form of a desire to make the same exact report with the help of another product - FastReport.NET.  Using the report converter, I found that the appearance without any problems was transformed from a report from the FR.VCL format to the FR.NET format.  The joy is over - the data sources were lost during the conversion.  It was necessary to re-create (using the "wizard") a connection to the database. As a result, we got the following line: <br><blockquote>  Provider = Microsoft.Jet.OLEDB.4.0; Data Source = ProtocolsSpecifications.mdb; User ID = Admin <br></blockquote><br>  And SQL queries acquired the following form: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">SELECT</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">P</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Name</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">P</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Description</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">P</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ProtocolID</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">P</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Description_Rus</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FROM</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Protocols</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">P</span></span></code> </pre><br>  As you can see, the request for the protocols has not changed.  And in two other queries, the <b>WHERE clause</b> disappeared. <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">SELECT</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">S</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ProtocolID</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">S</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Label</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">S</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Name</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">S</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Description</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">S</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Description_Rus</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">S</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ID</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FROM</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Methods</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">S</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ORDER</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">BY</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">S</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Label</span></span></code> </pre><br>  and <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> A.ID, A.InOutFlag, A.<span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>, A.TypedUntypedFlag, A1.Name, A.Name, A.Description <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Arguments A <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> ArgType A1 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (A.TypedUntypedFlag=A1.ID) <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> A.ID , A.InOutFlag <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>, A.<span class="hljs-keyword"><span class="hljs-keyword">Index</span></span></code> </pre><br><br>  instead of the WHERE operator, in the ‚ÄúData‚Äù window, select the ‚ÄúAction‚Äù menu, then select the ‚ÄúNew link‚Äù menu item and assign the link between the subordinate table and the main table. <br><br>  After the completion of editing, simply hold down the Ctrl key and click on the Latin <b>P</b> or ‚Äúclick‚Äù the mice on the magnifying glass icon to generate documentation and preview the received document. <br><br>  I can not compare FR.VCL and FR.NET.  When generating documentation, FR.VCL showed the best results in the speed of report building.  At the same time, FR.NET offers a slightly larger number of export formats (for example, the XPS format), a slightly more modern interface, and a certain margin of fault tolerance at the expense of the managed code. <br><br>  For those who think that it‚Äôs better to try it yourself once, than 10 times to read, I <a href="http://narod.ru/disk/25933410001/Xam_spec_draft7.zip.html">post the original database and two report templates in FR3 (FR.VCL) and FRX (FR.NET) formats in a zip archive</a> .  Download FastReport from the <a href="http://www.fast-report.com/ru/">official site</a> .  You will need to open the report in the designer and edit the path to the database in the report - <b>in the connection string you must specify the full path</b> to the ProtocolsSpecifications.mdb file.  I apologize for the inconvenience. <br><br>  Finally, I would like to once again turn to the advantages of this method of describing protocols and dream a little.  The main advantage is the separation of information and its presentation.  The developer focuses on the protocol description, and the report generator takes care of the appearance.  The ability to easily export a document to many common document formats. <br><br>  If MS Access is replaced with any SQL server and provided for users to edit the database via the WEB interface, it is possible to produce remote development of protocols by several developers at once.  Fortunately, the report generator has a server version that can generate reports on the fly and send them over the HTTP protocol. <br><br>  Finally, the database can be used as an analogue of IDL (Interface Definition Language).  Those.  Virtually nothing prevents the generation of C / C ++ header files with the description of interfaces directly from the database. <br><br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/128915/">https://habr.com/ru/post/128915/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128907/index.html">New physics calculation engine in 3ds Max</a></li>
<li><a href="../128909/index.html">Porting applications to Windows Phone 7</a></li>
<li><a href="../128912/index.html">Business processes in the load</a></li>
<li><a href="../128913/index.html">Image compression using wavelet</a></li>
<li><a href="../128914/index.html">Create Your Look and Feel - Part I</a></li>
<li><a href="../128918/index.html">Beta test Battlefield 3 starts on September 29</a></li>
<li><a href="../128920/index.html">Spain's anti-monopoly officers launched an investigation into Microsoft</a></li>
<li><a href="../128922/index.html">An example of integrating Robokassa with Rails</a></li>
<li><a href="../128923/index.html">Finnish startup hopes to change the web advertising market</a></li>
<li><a href="../128924/index.html">Beta testing ABBYY Lingvo Dictionaries for Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>