<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a custom map control using the Yandex.Maps API 2.0</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Rambler cards have one interesting design solution that is not found in other maps. This is the control of the center of the map, due to which the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a custom map control using the Yandex.Maps API 2.0</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/a14/140/f81/a14140f81a106cfb44ef9a9f5101dfd4.png"><br>  The Rambler cards have one interesting design solution that is not found in other maps.  This is the control of the center of the map, due to which the current center of the map is shown.  It is with the example of this functionality that I would like to tell you how to make your control for maps on your site. <br><a name="habracut"></a><br>  The creation of the control is divided into several stages. <br><br><h4>  Step 1. Layout. </h4><br>  Layout, he's the layout.  This entity is responsible for the appearance of the element on the map.  In our case, this is a cross, when you hover over which will show the coordinates of the center of the map.  We will create the layout using the special factory <a href="">templateLayoutFactory</a> . <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> CrossCenterLayout = ymaps.templateLayoutFactory.createClass(<span class="hljs-string"><span class="hljs-string">'&lt;div id="cross-center" style="left:$[options.position.left]px;top:$[options.position.top]px;"&gt;+&lt;/div&gt;'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">build</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ CrossCenterLayout.superclass.build.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._controlListeners = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.events.group().add(<span class="hljs-string"><span class="hljs-string">'mouseenter'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onCenterEnter, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).add(<span class="hljs-string"><span class="hljs-string">'mouseleave'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onCenterLeave, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    ,     this._map = this.getData().map; }, clear: function() { this._controlListeners.removeAll(); CrossCenterLayout.superclass.clear.call(this); }, onCenterEnter: function() { var center = this._map.getCenter(); var lat = center[0].toFixed(2); var lng = center[1].toFixed(2); //          this._map.hint.show(center, { content: lat + ', ' + lng }); }, onCenterLeave: function() { //   this._map.hint.hide(); } });</span></span></code> </pre> <br>  Consider the code in detail.  Factory <a href="">templateLayoutFactory</a> accepts 2 parameters as input, a template for the future layout and a list of methods of the new layout that can override the methods of the parent <a href="">class</a> . <br>  In our case, we override the <a href="">build</a> and <a href="">clear</a> methods, as well as add our own <i>onCenterEnter</i> and <i>onCenterLeave methods</i> .  In the <i>build</i> method, we add <i>mouseleave</i> and <i>mouseenter</i> subscriptions to the event <a href="">manager</a> <a href="">container</a> . <br>  In the <i>clear</i> method, we get rid of these subscriptions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Step 2. Class of control. </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> CrossCenter = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.events = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ymaps.event.Manager(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.options = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ymaps.option.Manager(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ymaps.data.Manager(); }; CrossCenter.prototype = { <span class="hljs-attr"><span class="hljs-attr">setParent</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">parent</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.parent = parent; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (parent) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> map = parent.getMap(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.layout = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CrossCenterLayout({ <span class="hljs-comment"><span class="hljs-comment">//      ,         map: map, options: this.options }); //     pane  this.layout.setParentElement(map.panes.get('controls').getElement()); } else { this.layout.setParentElement(null); } }, getParent: function() { return this.parent; } };</span></span></code> </pre><br>  This is probably the hardest part of the code.  Here we implement the <a href="">IControl</a> interface.  First, we set the required fields using the appropriate <a href="">event</a> , <a href="">option,</a> and <a href="">data</a> managers.  Then we implement the <i>setParent</i> and <i>getParent</i> methods.  The first one was peeped in the source code of api, thanks to the <i>debug</i> mode, and the second, I think, does not cause questions. <br><br><h4>  Step 3. Adding to the card </h4><br>  Given the style <br><pre> <code class="css hljs"><span class="hljs-selector-id"><span class="hljs-selector-id">#cross-center</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">font-size</span></span>: <span class="hljs-number"><span class="hljs-number">20px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">cursor</span></span>: pointer; <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: absolute; <span class="hljs-attribute"><span class="hljs-attribute">z-index</span></span>: <span class="hljs-number"><span class="hljs-number">800</span></span>; }</code> </pre><br>  and container card <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"map"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"height: 300px; width: 420px;"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  create a control and add it to the center of the map <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> crossCenter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CrossCenter(); map.controls.add(crossCenter, { <span class="hljs-attr"><span class="hljs-attr">top</span></span>: <span class="hljs-number"><span class="hljs-number">140</span></span>, <span class="hljs-attr"><span class="hljs-attr">left</span></span>: <span class="hljs-number"><span class="hljs-number">200</span></span> });</code> </pre><br>  <a href="http://jsfiddle.net/dolf/VqJL3/1/embedded/result/">See the result of works.</a> <br><br>  PS In order to be just like at Rambler, you can add <a href="">reverse geocoding</a> to the <i>onCenterEnter</i> method by changing the parameter <i>kind</i> depending on the current zoom of the map. </div><p>Source: <a href="https://habr.com/ru/post/145548/">https://habr.com/ru/post/145548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145539/index.html">Syntax AOP in JavaScript</a></li>
<li><a href="../145541/index.html">Press Conferences Microsoft, Electronic Arts, SONY, Ubisoft at E3 2012</a></li>
<li><a href="../145543/index.html">Luxoft Launches Technology Testing for the iviLink Software Platform</a></li>
<li><a href="../145546/index.html">Video of Meet Windows Azure event reports published</a></li>
<li><a href="../145547/index.html">WWDC and iOS 6: what are we waiting for?</a></li>
<li><a href="../145549/index.html">Visual Studio Express 2012 for Windows Desktop</a></li>
<li><a href="../145550/index.html">Automation of music management in the office, any song on order via ICQ</a></li>
<li><a href="../145551/index.html">Test task for the Connected FixedThreadPool on C #. What is wrong here? UPD</a></li>
<li><a href="../145552/index.html">Some OSM and OpenLayers for enterprise systems</a></li>
<li><a href="../145553/index.html">Effective role assignment through the RACI matrix (Updated)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>