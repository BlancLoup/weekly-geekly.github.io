<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sending an e-mail message in the 3CX Call Flow Designer development environment</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 In this article we will explain how to send an e-mail message from 3CX Call Flow Designer using the Email Sender component. The applica...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sending an e-mail message in the 3CX Call Flow Designer development environment</h1><div class="post__text post__text-html js-mediator-article"><h2>  Introduction </h2><br>  In this article we will explain how to send an e-mail message from <a href="https://www.3cx.com/phone-system/call-flow-designer/">3CX Call Flow Designer</a> using the Email Sender component.  The application records the caller's voice in a WAV file and sends it as an e-mail attachment. <br><br>  You can use this component, for example, to notify about the order of goods through the voice menu 3CX, and in other situations when the voice interaction of the user with the system must be accompanied by sending e-mail. <br><br>  Recall that in previous articles we considered the creation of a <a href="https://habrahabr.ru/company/3cx/blog/336528/">CFD application for outgoing dialing</a> (after the call is completed, you can send a report using the Email Sender component), <a href="https://habrahabr.ru/company/3cx/blog/334472/">CFD operation with databases</a> (which can also be used to get a subscriber number) and <a href="https://habrahabr.ru/company/3cx/blog/333958/">incoming call routing depending on time of day</a> (which can be combined with outgoing calls) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Please note - the 3CX CFD development environment is free.  But voice applications will be run only on <a href="https://www.3cx.ru/ip-pbx/edition-comparison/">3CX Pro and Enterprise editions</a> .  Download CFD <a href="">from here</a> . <br><br>  The demo project of this voice application comes with the 3CX CFD distribution and is located in the <b>Documents \ 3CX Call Flow Designer Demos</b> folder.  To get started, it is enough to specify the parameters of your SMTP server in the demo application. <a name="habracut"></a><br><br><h2>  Project creation </h2><br>  To create a CFD project, go to <b>File ‚Üí New ‚Üí Project</b> , specify the project folder and its name, for example, <b>EMailDemo</b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3c4/0c9/356/3c40c93564d0539ad8007dc0f3e5ae4e.png"><br><br><h2>  Write user message to file </h2><br>  To begin, write the subscriber's message to a file.  This file will then be sent to the e-mail.  For this, the <b>Record</b> component is used. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/99b/f46/4ed/99bf464ed88142638969270539313960.png"><br><br><ol><li>  Drag the <b>Record</b> component into the main development environment window (into the <b>Main</b> voice application).  Go to the properties window and rename the component to <b>recordYourMessage</b> . <br></li><li>  Double click on the component and in the opened window set the following parameters: <br></li></ol><br><pre><code class="hljs pgsql">CONCATENATE("CallFrom_",<span class="hljs-keyword"><span class="hljs-keyword">session</span></span>.ani,".wav")</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/8c5/ac5/bfa/8c5ac5bfa74253b2e298aec7ae3c6368.png"><br><br><h2>  Sending a recorded message to e-mail </h2><br>  Now we will send the recorded audio file as an e-mail attachment.  To do this, add the <b>E-Mail Sender</b> component to the <b>Audio Recorded</b> branch of the <b>Record</b> component and configure it as shown below: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c2/fec/19c/9c2fec19c84ab58cb5d0ec11cf863634.png"><br><br>  Note that in those parameters where expressions are specified (the fields have the <b>Fx</b> button on the right), any specified constant must be quoted, since these fields may also contain variables or expression results. <br><br>  For the <b>Subject</b> parameter, we use an expression that adds the caller's number. <br><br>  The Attachments <b>Attachments</b> list contains file descriptions consisting of two columns: <br><br><ul><li>  <b>Name</b> is the name of the file that the recipient of the e-mail message will see.  We indicate here <b>Recording.wav</b> , so that only the file with this name comes in the attachment. <br></li><li>  <b>File</b> - an expression that indicates the physical file of the record that you want to attach to the letter.  However, here we must supplement the expression that generates the file name (which was used in the previous step).  In the previous step, the relative path to the file was used in the <b>Record</b> component - only the name was indicated.  The file was created in the audio file directory of this project.  The <b>Email Sender</b> component should be passed the full path to the file, so the expression is complemented by the variable <b>session.audioFolder</b> : <br></li></ul><br><pre> <code class="hljs pgsql">CONCATENATE(<span class="hljs-keyword"><span class="hljs-keyword">session</span></span>.audioFolder,"/CallFrom_",<span class="hljs-keyword"><span class="hljs-keyword">session</span></span>.ani,".wav")</code> </pre> <br>  Now the voice application correctly finds and inserts the audio file. <br><br><h2>  Compiling and installing the application on the 3CX server </h2><br>  Voice application is ready!  Now it should be compiled and uploaded to the 3CX server.  For this: <br><br><ul><li>  Go to <b>Build ‚Üí Build All</b> , and the CFD will create the <b>EMailDemo.tcxvoiceapp</b> file. <br></li><li>  Go to the 3CX management interface, in the <b>Call Queues</b> section.  Create a new Call Queue, specify the name and extension number of the Queue, and then set the <b>Voice Applications</b> option and download the compiled file. <br></li><li>  Save your changes to the Call Queue.  Voice application is ready to use. <br></li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/ca9/649/ddb/ca9649ddbc63c0720ed35cba6274c81e.png"></div><p>Source: <a href="https://habr.com/ru/post/337096/">https://habr.com/ru/post/337096/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337084/index.html">Methods for detecting "glued" files</a></li>
<li><a href="../337086/index.html">Corporate communication in Telegram. Migration from WhatsApp at full speed</a></li>
<li><a href="../337088/index.html">Securing Network Security in the Kubernetes Cluster</a></li>
<li><a href="../337092/index.html">Artificial intelligence will save from ransomware</a></li>
<li><a href="../337094/index.html">4 ICO IT startups in September: sale of excess communications, parallel Internet and awards to open-source developers</a></li>
<li><a href="../337098/index.html">Creator of Node.js: ‚ÄúFor servers, I can‚Äôt imagine another language other than Go‚Äù</a></li>
<li><a href="../337100/index.html">Be careful with what you measure - MJIT vs TruffleRuby: 2.1 times slower or 4.2 times faster</a></li>
<li><a href="../337102/index.html">BFQ I / O scheduler better</a></li>
<li><a href="../337106/index.html">Meeting in St. Petersburg "The role of the analyst in making important product decisions"</a></li>
<li><a href="../337108/index.html">Test asynchronous code with PyTest (translation)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>