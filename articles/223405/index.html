<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PL / SQL Web Services Solution</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Faced the requirement to send and receive SOAP messages from an Oracle database. 
 Also, this solution should be universal and easily integrated with ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PL / SQL Web Services Solution</h1><div class="post__text post__text-html js-mediator-article">  Faced the requirement to send and receive SOAP messages from an Oracle database. <br>  Also, this solution should be universal and easily integrated with other modules. <br>  On the Internet, nothing of the kind found.  There are articles about how to send SOAP messages using the UTL_HTTP packet, but nothing more. <br><br>  I decided to write a generic PL / SQL product for sending SOAP messages from an Oracle database that is easy to configure and integrate. <br><a name="habracut"></a><br>  So let's get started. <br><br>  This solution uses the following database objects: <br><ul><li>  User-Defined Datatypes </li><li>  Table </li><li>  Package </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It is assumed that the reader does not need to explain what is SOAP, XML, or Oracle Database objects. <br><br><h4>  <b>Installation</b> </h4><br>  To install this solution, you must install the following objects <br><br><ul><li>  Type PARAMS_RECORD </li><li>  Type PARAMS_ARRAY </li><li>  WS_SERVER table </li><li>  WS_TEMPLATE table </li><li>  WS_LOG table </li><li>  WS Package </li></ul><br>  <a href="https://github.com/KhayyamSadigov/WS">Source</a> <br><br><h4>  <b>Instructions</b> </h4><br>  Consider the structure of tables <br><br><img src="https://habrastorage.org/getpro/habr/post_images/822/94f/63c/82294f63cd765210c0d20de6fd5e6e8b.png" alt="image"><br><br>  Consider each of them in more detail. <br><br><h6>  WS_SERVER table </h6><br>  Stores the list of Servers where SOAP / XML messages will be sent. <br><br>  The SERVER_ID column is a logical server identifier.  Is a primary key <br>  URL column - Service path <br>  STATUS - Status.  1 - works.  0 - off.  Default 1 <br><br><h6>  WS_TEMPLATE table </h6><br>  Stores patterns and configuration information for SOAP / XML messages. <br><br>  TEMPLATE_ID - Logical Template ID.  Is a primary key <br>  TEMPLATE_XML - Template (The format will be discussed later) <br>  SERVER_ID - The logical server identifier.  Is a foreign key referencing the WS_SERVER table <br>  REQUEST_PARAMS - Request Parameters (The format will be discussed later) <br>  RESPONSE_PARAMS - Response Parameters (The format will be discussed later) <br>  XMLNS - Namespace <br>  PATH - XML ‚Äã‚ÄãPath (It will be discussed in more detail by the example below) <br>  STATUS - Status.  1 - works.  0 - off.  Default 1 <br><br><h6>  WS_LOG table </h6><br>  Keeps logs about operations. <br><br>  EVENT_TIME - Operation Time <br>  XML_REQUEST - XML ‚Äã‚Äã/ SOAP request <br>  XML_RESPONSE - XML ‚Äã‚Äã/ SOAP response <br>  REQUEST_PARAMS - Request Parameters <br>  RESPONSE_PARAMS - Response Parameters <br>  RETVAL - Information about the status of the executed request.  Successfully if&gt; 0 <br>  RETMSG - Information about the executed Request.  Error code in case of a failed request <br>  EXECUTE_TIME - Time in seconds and milliseconds spent on the execution of the request <br><br><h6>  How to fill out the TEMPLATE_XML Template </h6><br>  The XML file itself fits here, replacing the parameters for entering in the following format <code>%PARAMETER_NAME%</code> <br><br>  For example: <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-envelope"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soap:encodingStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-encoding"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:m</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.example.org/stock"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetStockPrice</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockName</span></span></span><span class="hljs-tag">&gt;</span></span>%NAME%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetStockPrice</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  In this case, to send this request we need to write the value in this format in this column.  The program itself will then replace it with the response from the Parameter (the parameters are described below). <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockName</span></span></span><span class="hljs-tag">&gt;</span></span>%NAME%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockName</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  If, accordingly, there are several Values ‚Äã‚Äãthat do not prevent them from being immediately indicated: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-envelope"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soap:encodingStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-encoding"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:m</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.example.org/stock"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetStockPrice</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockName</span></span></span><span class="hljs-tag">&gt;</span></span>%NAME%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockCount</span></span></span><span class="hljs-tag">&gt;</span></span>%COUNT%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockCount</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetStockPrice</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  As you can see, there are 2 variables <code>NAME</code> and <code>COUNT</code> <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockName</span></span></span><span class="hljs-tag">&gt;</span></span>%NAME%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockCount</span></span></span><span class="hljs-tag">&gt;</span></span>%COUNT%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockCount</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><h6>  Parameters Filling Rule (Columns REQUEST_PARAMS and RESPONSE_PARAMS) </h6><br>  This column is populated in the following format. <br> <code>PARAMETER_NAME_1={VALUE_1}|PARAMETER_NAME_2={VALUE_2}|‚Ä¶PARAMETER_NAME_N={VALUE_N}</code> <br> <br><h6>  Request Parameter (REQUEST_PARAMS Column) </h6><br>  This column is filled in if there are constant variables regardless of the query.  Basically it can be left empty.  This value is set when the main procedure is started.  About this a little further. <br><br><h6>  PATH column </h6><br>  To set up working with the Reply from the server, the PATH column must be filled in which indicates the path where in XML (between which tags) the necessary answer is stored. <br><br>  When sending a SOAP / XML message, we know in advance the possible answer that will come from the server. <br>  For example, the answer might be the following SOAP / XML <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-envelope"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soap:encodingStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-encoding"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:m</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.example.org/stock"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetStockPriceResponse</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Price</span></span></span><span class="hljs-tag">&gt;</span></span>34.5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetStockPriceResponse</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  In this case, the PATH column should be written as: <br> <code>/soap:Envelope/soap:Body/m:GetStockPriceResponse</code> <br> <br>  As can be seen from the Answer, this is the way to find the necessary value. <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Price</span></span></span><span class="hljs-tag">&gt;</span></span>34.5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Price</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><h6>  Response Parameter (RESPONSE_PARAMS Column) </h6><br>  This column is required.  The format remains the same (specified above). <br><br>  Knowing in advance the format of the response, you must write the parameters in this column. <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-envelope"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soap:encodingStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-encoding"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:m</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.example.org/stock"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetStockPriceResponse</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Price</span></span></span><span class="hljs-tag">&gt;</span></span>34.5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetStockPriceResponse</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Already specifying in the PATH column the path we need we enter here the necessary values ‚Äã‚Äãin the following format: <br> <code>RESULT_PRICE={m:Price}</code> <br> <br>  This means RESULT_PRICE to assign the <code>m:Price</code> value to the Response obtained from SOAP / XML.  Further on the example it will be considered in more detail. <br><br><h6>  XMLNS column </h6><br>  This column is namespace.  Filled similarly from the SOAP / XML Request. <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-envelope"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soap:encodingStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-encoding"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:m</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.example.org/stock"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetStockPrice</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockName</span></span></span><span class="hljs-tag">&gt;</span></span>%NAME%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockCount</span></span></span><span class="hljs-tag">&gt;</span></span>%COUNT%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:StockCount</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetStockPrice</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  This column must be filled in by typing in all the <code>xmlns</code> from this query.  From this example, you need to fill it with the following value: <br> <code>xmlns:soap="http://www.w3.org/2001/12/soap-envelope" xmlns:m="http://www.example.org/stock"</code> <br> <br><h6>  Running procedure </h6><br>  Now consider the package structure and launch rules. <br>  The package specification is as follows: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">replace</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> WS <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PROCEDURE</span></span> add_param(pi_params <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> varchar2, pi_parameter_name varchar2, pi_parameter_value varchar2); FUNCTION get_param(pi_params varchar2, pi_parameter_name varchar2) return varchar2; PROCEDURE <span class="hljs-keyword"><span class="hljs-keyword">call</span></span>(pi_template_id VARCHAR2, pi_params VARCHAR2, po_params <span class="hljs-keyword"><span class="hljs-keyword">OUT</span></span> VARCHAR2, po_data_response <span class="hljs-keyword"><span class="hljs-keyword">OUT</span></span> VARCHAR2); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> WS;</code> </pre><br><br>  Consider each function in more detail. <br>  Using each of them on the example will be discussed in the Integration section. <br><br><h6>  Procedure add_param </h6><br>  Used to add / form a parameter. <br><br>  Options <br>  pi_params - Variable Parameter String <br>  pi_parameter_name - The name of the parameter being added <br>  pi_parameter_value - The value of the parameter being added <br><br><h6>  Get_param function </h6><br>  Used to extract a parameter from the parameter string. <br><br>  Options <br>  pi_params - Variable Parameter String <br>  pi_parameter_name - The name of the parameter to retrieve <br><br><h6>  Call procedure </h6><br>  It is the main and starts the process itself. <br><br>  Options <br>  pi_template_id - Template identifier from WS_TEMPLATE table <br>  pi_params - Variable of the parameter string required for sending <br>  po_params - Variable of the parameter string received in response from the server <br>  po_data_response - XML ‚Äã‚Äãresponse from the server (This variable can not be used) <br><br>  In the next section, we will use the package procedures as an example. <br><br><h4>  <b>Integration</b> </h4><br>  In this section, we will look at the integration of this solution using the example of an invented project. <br><br>  Suppose there is a task: <br><br>  Build the Interface for interaction with the Server for the end user who should be able to perform the following operations <br><ul><li>  Getting Product Information </li><li>  Add Item </li></ul><br><br>  The implementation scheme is as follows: <br><img src="https://habrastorage.org/getpro/habr/post_images/38c/874/1c9/38c8741c9b94680916a26ef9802ab84c.jpg"><br><br>  I note that the interface between the End User and the Database can be anything.  The end user can run the procedure directly through SQL or it can be called by a third-party application (for example, Java SE, Java EE, etc.). <br><br>  The following information is provided: <br><br>  Web Service itself <br> <code>http://10.10.1.100:8080/GoodsManagementWS/Goods</code> <br> <br>  It should be noted that before sending SOAP / XML messages to the server, the latter must be added to the ACL.  To do this, contact the Administrator of the Database.  Also in the intern there is information about this.  I think it should not be considered in this article. <br><br><h5>  Request Examples </h5><br><h6>  Product information </h6><br>  Request: <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-envelope"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soap:encodingStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-encoding"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:m</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.example.org/goods"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:GetInfo</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:ID</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:ID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">GetInfo</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Answer: <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-envelope"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soap:encodingStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-encoding"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:m</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.example.org/goods"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Response</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Name</span></span></span><span class="hljs-tag">&gt;</span></span>Printer<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Vendor</span></span></span><span class="hljs-tag">&gt;</span></span>HP<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Vendor</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Price</span></span></span><span class="hljs-tag">&gt;</span></span>Printer<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Count</span></span></span><span class="hljs-tag">&gt;</span></span>Printer<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Count</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Response</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><h6>  Adding a Product </h6><br>  Request: <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-envelope"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soap:encodingStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-encoding"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:m</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.example.org/goods"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Add</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Name</span></span></span><span class="hljs-tag">&gt;</span></span>Printer<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Vendor</span></span></span><span class="hljs-tag">&gt;</span></span>HP<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Vendor</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Price</span></span></span><span class="hljs-tag">&gt;</span></span>Printer<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Count</span></span></span><span class="hljs-tag">&gt;</span></span>Printer<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Count</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Add</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Answer: <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-envelope"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soap:encodingStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-encoding"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:m</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.example.org/goods"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Response</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:id</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Response</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  We received the necessary data from the customer.  Getting started to configure and integrate. <br><br>  First of all, you need to record the server information: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> WS_SERVER (SERVER_ID, <span class="hljs-keyword"><span class="hljs-keyword">URL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">STATUS</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-string"><span class="hljs-string">'Store'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://10.10.1.100:8080/GoodsManagementWS/Goods'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><br><br>  Next, you need to write information about the query templates in the table <code>WS_TEMPLATE</code> <br><br><h6>  Product information </h6><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> WS_TEMPLATE (TEMPLATE_ID, TEMPLATE_XML, SERVER_ID, REQUEST_PARAMS, RESPONSE_PARAMS, XMLNS, <span class="hljs-keyword"><span class="hljs-keyword">PATH</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">STATUS</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-string"><span class="hljs-string">'GetInfo'</span></span>, <span class="hljs-comment"><span class="hljs-comment">--TEMPLATE_ID '&lt;?xml version="1.0"?&gt; &lt;soap:Envelope xmlns:soap="http://www.w3.org/2001/12/soap-envelope" soap:encodingStyle="http://www.w3.org/2001/12/soap-encoding"&gt; &lt;soap:Body xmlns:m="http://www.example.org/goods"&gt; &lt;m:GetInfo&gt; &lt;m:ID&gt;%ID%&lt;/m:ID&gt; &lt;/m: GetInfo &gt; &lt;/soap:Body&gt; &lt;/soap:Envelope&gt; ', --TEMPLATE_XML 'Store', --SERVER_ID NULL, --REQUEST_PARAMS 'NAME={m:Name}|VENDOR={m:Vendor}|PRICE={m:Price}|COUNT={m:Count}', --RESPONSE_PARAMS 'xmlns:soap="http://www.w3.org/2001/12/soap-envelope" xmlns:m="http://www.example.org/goods"', --XMLNS '/soap:Envelope/soap:Body/m:Response', --PATH 1) ;--STATUS</span></span></code> </pre><br><br><h6>  Adding a Product </h6><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> WS_TEMPLATE (TEMPLATE_ID, TEMPLATE_XML, SERVER_ID, REQUEST_PARAMS, RESPONSE_PARAMS, XMLNS, <span class="hljs-keyword"><span class="hljs-keyword">PATH</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">STATUS</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-string"><span class="hljs-string">'AddInfo'</span></span>, <span class="hljs-comment"><span class="hljs-comment">--TEMPLATE_ID '&lt;?xml version="1.0"?&gt; &lt;soap:Envelope xmlns:soap="http://www.w3.org/2001/12/soap-envelope" soap:encodingStyle="http://www.w3.org/2001/12/soap-encoding"&gt; &lt;soap:Body xmlns:m="http://www.example.org/goods"&gt; &lt;m:Add&gt; &lt;m:Name&gt;%NAME%&lt;/m:Name&gt; &lt;m:Vendor&gt;%VENDOR%&lt;/m:Vendor&gt; &lt;m:Price&gt;%PRICE%&lt;/m:Price&gt; &lt;m:Count&gt;%COUNT%&lt;/m:Count&gt; &lt;/m: Add &gt; &lt;/soap:Body&gt; &lt;/soap:Envelope&gt; ', --TEMPLATE_XML 'Store', --SERVER_ID NULL, --REQUEST_PARAMS 'ID={m:id}', --RESPONSE_PARAMS 'xmlns:soap="http://www.w3.org/2001/12/soap-envelope" xmlns:m="http://www.example.org/goods"', --XMLNS '/soap:Envelope/soap:Body/m:Response', --PATH 1); --STATUS</span></span></code> </pre><br><br>  And by adding all the necessary information the procedure can be run.  But for this you need to write procedures for this project which in turn uses the procedures from the WS package. <br><br><h6>  Receive product information </h6><br>  For this task, the final procedure will be as follows. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PROCEDURE</span></span> GET_INFO(PI_ID VARCHAR2, PO_NAME <span class="hljs-keyword"><span class="hljs-keyword">OUT</span></span> VARCHAR2, PO_VENDOR <span class="hljs-keyword"><span class="hljs-keyword">OUT</span></span> VARCHAR2, PO_PRICE <span class="hljs-keyword"><span class="hljs-keyword">OUT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>, PO_COUNT <span class="hljs-keyword"><span class="hljs-keyword">OUT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> v_template_id VARCHAR2(<span class="hljs-number"><span class="hljs-number">100</span></span>) := <span class="hljs-string"><span class="hljs-string">'GetInfo'</span></span>; v_data_response VARCHAR2(4000); v_request_params VARCHAR2(4000); v_response_params VARCHAR2(4000); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-comment"><span class="hljs-comment">--       -- ws.add_param(v_request_params, 'ID', PI_ID); --    -- ws.call(v_template_id, v_request_params, v_response_params, v_data_response); --        -- PO_NAME := ws.get_param(v_response_params, 'NAME'); PO_VENDOR := ws.get_param(v_response_params, 'VENDOR'); PO_PRICE := ws.get_param(v_response_params, 'PRICE'); PO_COUNT := ws.get_param(v_response_params, 'COUNT'); END;</span></span></code> </pre><br><br>  The package will prepare the SOAP message for sending, send, receive the result and as a result, the resulting response of the final procedure will be the values ‚Äã‚Äãobtained by the work of the get_param procedure.  You can get any parameter from the parameter list RESPONSE_PARAMS and return it as a result. <br><br><h6>  Add product </h6><br>  For this task, the final procedure will be as follows. <br><br><pre> <code class="sql hljs">PROCEDURE ADD_INFO(PI_NAME VARCHAR2, PI_VENDOR VARCHAR2, PI_PRICE NUMBER, PI_COUNT NUMBER, PO_ID OUT VARCHAR2) IS v_template_id VARCHAR2(100) := 'AddInfo'; v_data_response VARCHAR2(4000); v_request_params VARCHAR2(4000); v_response_params VARCHAR2(4000); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-comment"><span class="hljs-comment">--       -- ws.add_param(v_request_params, 'NAME', PI_NAME); ws.add_param(v_request_params, 'VENDOR', PI_VENDOR); ws.add_param(v_request_params, 'PRICE', PI_PRICE); ws.add_param(v_request_params, 'COUNT', PI_COUNT); --    -- ws.call(v_template_id, v_request_params, v_response_params, v_data_response); --        -- PO_ID := ws.get_param(v_response_params, 'ID'); END;</span></span></code> </pre><br><br>  In this procedure, there are several input parameters, and the resulting variable is one. <br><br>  And so, in the end we got 2 procedures that perform the task.  Query results are logged in the <code>WS_LOG</code> table <code>WS_LOG</code> <br><br><h4>  <b>Additional questions</b> </h4><br><br><h6>  What if the necessary data in the answer is in different ways? </h6><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:soap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-envelope"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">soap:encodingStyle</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/12/soap-encoding"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:m</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.example.org/goods"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Response1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:id</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Response1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Response2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:id</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Response2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Response3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:id</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">m:Response3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">soap:Envelope</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  In this case, the PATH writes <code> /soap:Envelope/soap:Body</code> .  Since the necessary answer lies between the <code>&lt;soap:Body&gt;  &lt;/soap:Body&gt;</code> tags.  And already RESPONSE_PARAMS will need to be written a little more detailed. <br><br> <code>ID1={m:Response1/m:id}|ID2={m:Response2/m:id}|ID3={m:Response3/m:id}</code> <br> <br><h6>  What if SOAP / XML Request and Answer are Simple? </h6><br>  Request <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Request</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span>Test<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Request</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Answer <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Response</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Result</span></span></span><span class="hljs-tag">&gt;</span></span>DONE<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Result</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Response</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  In this case, everything is configured in the same way. <br>  Accordingly, XMLNS is empty, PATH is <code>Response</code> and RESPONSE_PARAMS is <code>RES={Result}</code> .  I note that the variable name is specified arbitrarily, but it will be used for the query in the get_param <code>get_param</code> <br><br><h6>  If I enter the string REQUEST_PARAMS during the startup of the procedure, then why do I need the REQUEST_PARAMS column in the WS_TEMPLATE table? </h6><br>  The need for this column arises if there are values ‚Äã‚Äãin the SOAP / XML Request that are unchanged.  Specifying them in this column during the start of the procedure, there is no longer any need to add these parameters (the add_param procedure) since they are already added by default. <br><br><h5>  That's all </h5><br>  Tried to lay out enough information. <br>  I will be glad to hear and answer questions that arise.  As well as criticism, suggestions and advice. <br>  The decision was written recently.  So there are things that can be improved. <br><br>  Thank.  I hope this article was helpful. </div><p>Source: <a href="https://habr.com/ru/post/223405/">https://habr.com/ru/post/223405/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../223389/index.html">‚ÄúAyusha‚Äù - a controller on a 6502 processor</a></li>
<li><a href="../223395/index.html">LabView in robotics - creating a SCADA system to control the robot</a></li>
<li><a href="../223399/index.html">A little cycling under Linux or RSS-aggregator on the knee with your own hands</a></li>
<li><a href="../223401/index.html">The basic principles of setting up the Garbage Collection from scratch</a></li>
<li><a href="../223403/index.html">Imagine Cup 2014: the path to victory</a></li>
<li><a href="../223407/index.html">Convenient basket (and DAS) for HDD / SSD 3.5 "/2.5" from the designer with your own hands</a></li>
<li><a href="../223415/index.html">Intel GPA for Android - we optimize graphics in mobile applications</a></li>
<li><a href="../223419/index.html">Microwaves guard weather forecasts, or what a scatterometer</a></li>
<li><a href="../223421/index.html">How to optimize a site for mobile devices using PageSpeed ‚Äã‚ÄãInsights</a></li>
<li><a href="../223425/index.html">5 reasons to use AngularJS in your corporate application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>