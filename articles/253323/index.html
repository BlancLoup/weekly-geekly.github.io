<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a custom matcher for unit testing in Jasmine 2.0</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently faced with the need to write a custom matcher in jasmine. The first thing I started to google and found an example where everything is clearl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a custom matcher for unit testing in Jasmine 2.0</h1><div class="post__text post__text-html js-mediator-article">  Recently faced with the need to write a custom matcher in jasmine.  The first thing I started to google and found an example where everything is clearly and clearly explained.  The code itself is shown below: <br><a name="habracut"></a><br><pre><code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'Hello world'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ beforeEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addMatchers({ <span class="hljs-attr"><span class="hljs-attr">toBeWithinOf</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">distance, base</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.message = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lower = base - distance, upper = base + distance; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Expected "</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.actual + <span class="hljs-string"><span class="hljs-string">" to be between "</span></span> + lower + <span class="hljs-string"><span class="hljs-string">" and "</span></span> + upper + <span class="hljs-string"><span class="hljs-string">" (inclusive)"</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.abs(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.actual - base) &lt;= distance; } }); }); it(<span class="hljs-string"><span class="hljs-string">'should be within in range'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ expect(<span class="hljs-number"><span class="hljs-number">8</span></span>).toBeWithinOf(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>); }); });</code> </pre> <br><br>  In this example, a matcher is created that will tell whether the entered number ( <b>this.actual</b> ) is in a certain range.  Note that when you call a matcher, two parameters are passed: <b>base</b> - the number from which a certain value will be counted in both directions - <b>distance</b> , eventually forming a search interval - <b>[base - distance, base + distance]</b> .  In this case, we expect that 8 will be in the interval [4, 8].  If the number specified by the user is outside the interval, then in the tests we will see an error that we form with the help of the function <b>this.message</b> . <br><br>  Everything seems to be nothing, but when you run the example in jasmine 2.0 none of this works.  It turns out that the syntax has changed a bit. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I tried a lot of ways and went through more than one forum I was able to resolve this issue.  The solution code is as follows: <br><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'Hello world'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ beforeEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ jasmine.addMatchers({ <span class="hljs-attr"><span class="hljs-attr">toBeWithinOf</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">compare</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">actual, distance, base</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lower = base - distance, upper = base + distance, result = { <span class="hljs-attr"><span class="hljs-attr">pass</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.abs(actual - base) &lt;= distance }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!result.pass) { result.message = <span class="hljs-string"><span class="hljs-string">"Expected "</span></span> + actual + <span class="hljs-string"><span class="hljs-string">" to be between "</span></span> + lower + <span class="hljs-string"><span class="hljs-string">" and "</span></span> + upper + <span class="hljs-string"><span class="hljs-string">" (inclusive)"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } } } }) }); it(<span class="hljs-string"><span class="hljs-string">'should be within in range'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ expect(<span class="hljs-number"><span class="hljs-number">8</span></span>).toBeWithinOf(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>); }); });</code> </pre><br>  As you can see, the method for calling the add match function has been changed - ( <b>this.addMatchers -&gt; jasmine.addMatchers</b> ).  Also, from the function itself, we are forced to return an object in which the <b>compare</b> method must be declared, which takes all the parameters, and not the matcher function itself. <br><br>  Please note that the first parameter ( <b>actual</b> ) corresponds to the number we want to check, and if we need to transfer our parameters to the matcher itself (as in our case, base and distance), we can indicate them in the same place. <br><br>  Inside the compare function itself, we create an object into which we immediately write the comparison property ( <b>pass</b> ).  And only if this property does not work out as a result, then only then the <b>message</b> property is created, in which you can form a text that the user will see if the test fails. <br><br>  A link to a working example can be found here - <a href="http://jsfiddle.net/2bo511uo/2/">fiddle</a> . <br><br>  That's all. </div><p>Source: <a href="https://habr.com/ru/post/253323/">https://habr.com/ru/post/253323/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253313/index.html">Optimum continuous archive sorting</a></li>
<li><a href="../253315/index.html">Juniper tincture: Prepare Juniper SRX. Part 3: Virtual Routers</a></li>
<li><a href="../253317/index.html">RabbitMQ tutorials in C ++</a></li>
<li><a href="../253319/index.html">Introduction to what3words API: Basic Procedures and Samples</a></li>
<li><a href="../253321/index.html">We write ARP Spoofer for Android. Development of Root tools for Android</a></li>
<li><a href="../253327/index.html">Google will increase the security of its Android app store</a></li>
<li><a href="../253329/index.html">JetBrains at RubyConfBy in Minsk on March 22</a></li>
<li><a href="../253331/index.html">OpenWRT + OpenVPN for Asterisk. Budget way to organize a VPN network</a></li>
<li><a href="../253333/index.html">Corporate Laboratories PENTESTIT - practical training in the field of information security</a></li>
<li><a href="../253335/index.html">Your wi-fi will tell me where you live, where you work and where you travel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>