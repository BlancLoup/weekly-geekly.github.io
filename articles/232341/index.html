<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As I stand to build from windows to wine migrated</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Preamble 
 I have a few old projects written in C ++ that I still develop as much as I can. It would seem - what's the matter? Alas, this is a bunch o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As I stand to build from windows to wine migrated</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/23b/519/e38/23b519e38cd94ec8a2ee411d1d86b648.png" alt="image" align="left" width="350"><br><h4>  Preamble </h4><br>  I have a few old projects written in C ++ that I still develop as much as I can.  It would seem - what's the matter?  Alas, this is a bunch of regular plug-ins under my favorite Adobe InDesign. <br><br>  And every time a new Creative Suite comes out, you have to port this business.  Interestingly, the main effort goes on to build a new version of the new rules, and bend the installer.  Therefore, if you have reached the stage ‚Äúit is compiled,‚Äù then, as a rule, it works.  Although of course there are nuances - for example, at one point, PlaceGun stopped laying out several selected images, only the first one.  But about it - next time. <br><br>  And of course - I would like to collect it for all versions and all platforms at a time, and not <i>‚Äúopened vizhlu - assembled - close - repeated‚Äù</i> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So for assembly, we need <b>both</b> <br><br><ul><li>  MS VS 2005 </li><li>  MS VS 2005 sp1 </li><li>  MS VS 2008 </li><li>  MS VS 2010 </li><li>  MS VS 2012 </li></ul><br><br><a name="habracut"></a><br><br><img src="https://habrastorage.org/files/ba1/0ed/db2/ba10eddb2b95494387f35776c8c90270.png" alt="image" align="left" width="350"><br><h4>  Go to gmake - profit </h4><br>  Why is that?  Ah, I did not say - there is still MacOSX.  So <s>goodbye nmake</s> no options. <br><br>  And in the end we get this nightmare: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><ol><li>  cl-cs3.mak </li><li>  cl-cs4.mak </li><li>  cl-cs5.mak </li><li>  cl-cs55.mak </li><li>  cl-cs6.mak </li><li>  cl-cc.mak </li><li>  cl-cc2014.mak </li><li>  cl.mak </li><li>  commplugs.mak </li><li>  gcc-cs3.mak </li><li>  gcc-cs4.mak </li><li>  gcc-cs5.mak </li><li>  gcc-cs55.mak </li><li>  gcc-cs6.mak </li><li>  gcc-cc.mak </li><li>  gcc-cc2014.mak </li><li>  gcc.mak </li><li>  mac-defs.mak </li><li>  platform-impl.mak </li><li>  platform-targets.mak </li><li>  platform.mak </li><li>  win-defs.mak </li></ol><br></div></div><br><br>  And it starts like this: <br><pre><code class="bash hljs">make ARCH=x64 INDD=cc2014 compile</code> </pre> <br><br>  Obviously, the platform is defined through uname.  And each part is built in the standard way as make -C foo. <br><br>  The description of each component looks like this. <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs ruby"><span class="hljs-keyword"><span class="hljs-keyword">include</span></span> ../../make/platform.mak TARGET=../../../lib/$(ARCH)/$(INDD)/libz.$(LibSuffix) OBJS=\ $(ARCH)/$(INDD)/adler32.$(OBJSuffix) \ $(ARCH)/$(INDD)/compress.$(OBJSuffix) \ $(ARCH)/$(INDD)/crc32.$(OBJSuffix) \ $(ARCH)/$(INDD)/deflate.$(OBJSuffix) \ $(ARCH)/$(INDD)/gzio.$(OBJSuffix) \ $(ARCH)/$(INDD)/infback.$(OBJSuffix) \ $(ARCH)/$(INDD)/inffast.$(OBJSuffix) \ $(ARCH)/$(INDD)/inflate.$(OBJSuffix) \ $(ARCH)/$(INDD)/inftrees.$(OBJSuffix) \ $(ARCH)/$(INDD)/trees.$(OBJSuffix) \ $(ARCH)/$(INDD)/uncompr.$(OBJSuffix) \ $(ARCH)/$(INDD)/zutil.$(OBJSuffix) \ <span class="hljs-symbol"><span class="hljs-symbol">all:</span></span> $(TARGET) $(TARGET): $(OBJS) $(AR) $(LFLAGS) $(OBJS) <span class="hljs-symbol"><span class="hljs-symbol">clean:</span></span> $(RMRF) $(TARGET) $(OBJS)</code> </pre></div></div><br><br>  And it all worked on a separate dedicated virtual machine under WinXP (and the same under hackintosh). <br><br>  I can‚Äôt see how I see these passions from and to the point; I‚Äôll give only the most interesting excerpts.  For example, this is how we calculate the project root and the platform on which compilation will now be performed: <br><br><pre> <code class="hljs mel">PR:=$(subst make/,,$(dir $(CURDIR)/$(word $(words $(MAKEFILE_LIST)),$(MAKEFILE_LIST)))) OSA:=$(shell uname -o) ifeq (Darwin,$(OSA)) OS=mac <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> OS=win endif</code> </pre><br><br>  And this is how it is determined where to look for Boost (adobe in each version manage to shift, so here are two parts - we define a macro and then use it): <br><pre> <code class="hljs mel">ifeq ($(ARCH),x86) BoostARCH=<span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> BoostARCH=<span class="hljs-number"><span class="hljs-number">64</span></span> endif BoostLib=$(subst \,/,$(AdobeSDK))/external/dva/third_party/boost_libraries/bin.v2/libs/boost_$1/lib/$(OS)/release/$(BoostARCH)/boost_$1.$(LibSuffix) BoostFilesystemLib=$(call BoostLib,filesystem) BoostThreadLib=$(call BoostLib,threads) BoostRegexLib=$(call BoostLib,regex) BoostSystemLib=$(call BoostLib,<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>)</code> </pre><br><br>  It is clear that I typed it not with my hands, but wrote a pack of batch files, but under MinGW: <br><br><div class="spoiler">  <b class="spoiler_title">genmake-for-dll.bat component-name [path-to-sources [target-directory]]</b> <div class="spoiler_text"><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">rem</span></span> genmake component-name [<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>-to-sources [target-directory]] <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> CN=%<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> FP=%<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> -%<span class="hljs-number"><span class="hljs-number">1</span></span>==- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> CN=default <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> -%<span class="hljs-number"><span class="hljs-number">2</span></span>==- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> FP=. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> -%<span class="hljs-number"><span class="hljs-number">3</span></span>==- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> TD=. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt; MakeF COMPONENT=<span class="hljs-variable"><span class="hljs-variable">%CN%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF include ../make/platform.mak <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF TARGET=$(OBJDIR)/$(COMPONENT).$(DLLSuffix) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF OBJS=\ <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> <span class="hljs-variable"><span class="hljs-variable">%FP%</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -name '*.c*' | grep -v .svn | awk '{ <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> "\t$(OBJDIR)/" $<span class="hljs-number"><span class="hljs-number">1</span></span> ".$(OBJSuffix)\t\\\"; }' | sed -e 's/\.cpp\./\./' | sed -e 's/\.cxx\./\./' | sed -e 's?/<span class="hljs-variable"><span class="hljs-variable">%FP%</span></span>??' &gt;&gt; MakeF <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF HEADERS=\ <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> <span class="hljs-variable"><span class="hljs-variable">%FP%</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -name '*.h*' | grep -v .svn | awk '{ <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> "\t" $<span class="hljs-number"><span class="hljs-number">1</span></span> "\t\\\"; }' &gt; headers &gt;&gt; MakeF <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF all: $(TARGET) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF $(TARGET): $(OBJS) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF $(LINK) $(LDFLAGS) $(OBJS) $(XLIBS) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -f $@.manifest ] ; then mt -nologo -manifest $@.manifest "-outputresource:$@;<span class="hljs-number"><span class="hljs-number">2</span></span>"; fi <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF clean: <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF rm -f $(TARGET) $(OBJS) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> <span class="hljs-variable"><span class="hljs-variable">%FP%</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -name '*.c*' | grep -v .svn | awk '{ <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> "$(OBJDIR)/" $<span class="hljs-number"><span class="hljs-number">1</span></span> ".$(OBJSuffix) : " $<span class="hljs-number"><span class="hljs-number">1</span></span> " $(HEADERS)\n\t$(CC) $(CFLAGS) " $<span class="hljs-number"><span class="hljs-number">1</span></span> "\n"; }' | sed -e 's/.cpp././' | sed -e 's/\.cxx\./\./' | sed -e 's?/<span class="hljs-variable"><span class="hljs-variable">%FP%</span></span>/?/?' &gt;&gt; MakeF <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF #EOF mv MakeF Makefile</code> </pre></div></div><br><br><div class="spoiler">  <b class="spoiler_title">genmake-for-lib.dll component-name [path-to-sources [target-directory]]</b> <div class="spoiler_text"><pre> <code class="hljs dos">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">rem</span></span> genmake component-name [<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>-to-sources [target-directory]] <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> CN=%<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> FP=%<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> -%<span class="hljs-number"><span class="hljs-number">1</span></span>==- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> CN=default <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> -%<span class="hljs-number"><span class="hljs-number">2</span></span>==- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> FP=. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> -%<span class="hljs-number"><span class="hljs-number">3</span></span>==- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> TD=. <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt; MakeF COMPONENT=<span class="hljs-variable"><span class="hljs-variable">%CN%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF include ../make/platform.mak <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF TARGET=$(OBJDIR)/lib$(COMPONENT).$(LibSuffix) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF OBJS=\ <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> <span class="hljs-variable"><span class="hljs-variable">%FP%</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -name '*.c*' | grep -v .svn | awk '{ <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> "\t$(OBJDIR)/" $<span class="hljs-number"><span class="hljs-number">1</span></span> ".$(OBJSuffix)\t\\\"; }' | sed -e 's/\.cpp\./\./' | sed -e 's/\.cxx\./\./' | sed -e 's?/<span class="hljs-variable"><span class="hljs-variable">%FP%</span></span>??' &gt;&gt; MakeF <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF HEADERS=\ <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> <span class="hljs-variable"><span class="hljs-variable">%FP%</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -name '*.h*' | grep -v .svn | awk '{ <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> "\t" $<span class="hljs-number"><span class="hljs-number">1</span></span> "\t\\\"; }' &gt; headers &gt;&gt; MakeF <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF $(TARGET): $(OBJS) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF $(AR) $(LFLAGS) $(OBJS) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF clean: <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF rm -f $(TARGET) $(OBJS) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF # <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> <span class="hljs-variable"><span class="hljs-variable">%FP%</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -name '*.c*' | grep -v .svn | awk '{ <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> "$(OBJDIR)/" $<span class="hljs-number"><span class="hljs-number">1</span></span> ".$(OBJSuffix) : " $<span class="hljs-number"><span class="hljs-number">1</span></span> " $(HEADERS)\n\t$(CC) $(CFLAGS) " $<span class="hljs-number"><span class="hljs-number">1</span></span> "\n"; }' | sed -e 's/.cpp././' | sed -e 's/\.cxx\./\./' | sed -e 's?/<span class="hljs-variable"><span class="hljs-variable">%FP%</span></span>/?/?' &gt;&gt; MakeF <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>&gt;&gt; MakeF #EOF mv MakeF Makefile</code> </pre></div></div><br><br><div class="spoiler">  <b class="spoiler_title">genmake-for-indd.bat plugin-name [path-to-sources [target-directory]]</b> <div class="spoiler_text"><pre> <code class="hljs haskell">@echo off setlocal rem genmake plugin-name [path-to-sources [target-directory]] set <span class="hljs-type"><span class="hljs-type">CN</span></span>=%<span class="hljs-number"><span class="hljs-number">1</span></span> set <span class="hljs-type"><span class="hljs-type">FP</span></span>=%<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> -%<span class="hljs-number"><span class="hljs-number">1</span></span>==- set <span class="hljs-type"><span class="hljs-type">CN</span></span>=plugin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> -%<span class="hljs-number"><span class="hljs-number">2</span></span>==- set <span class="hljs-type"><span class="hljs-type">FP</span></span>=. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> -%<span class="hljs-number"><span class="hljs-number">3</span></span>==- set <span class="hljs-type"><span class="hljs-type">TD</span></span>=. echo&gt; <span class="hljs-type"><span class="hljs-type">MakeF</span></span> <span class="hljs-type"><span class="hljs-type">COMPONENT</span></span>=%<span class="hljs-type"><span class="hljs-type">CN</span></span>% echo&gt;&gt; <span class="hljs-type"><span class="hljs-type">MakeF</span></span> include ../make/platform.mak echo&gt;&gt; <span class="hljs-type"><span class="hljs-type">MakeF</span></span> <span class="hljs-type"><span class="hljs-type">PluginName</span></span>=$(<span class="hljs-type"><span class="hljs-type">COMPONENT</span></span>) echo&gt;&gt; <span class="hljs-type"><span class="hljs-type">MakeF</span></span> <span class="hljs-type"><span class="hljs-type">TARGET_DIR</span></span>=$(<span class="hljs-type"><span class="hljs-type">OBJDIR</span></span>)/$(<span class="hljs-type"><span class="hljs-type">PluginPrefix</span></span>) echo&gt;&gt; <span class="hljs-type"><span class="hljs-type">MakeF</span></span> <span class="hljs-type"><span class="hljs-type">TARGET</span></span>=$(<span class="hljs-type"><span class="hljs-type">TARGET_DIR</span></span>)/$(<span class="hljs-type"><span class="hljs-type">PluginName</span></span>)$(<span class="hljs-type"><span class="hljs-type">PluginSuffix</span></span>) echo&gt;&gt; <span class="hljs-type"><span class="hljs-type">MakeF</span></span> <span class="hljs-type"><span class="hljs-type">CFLAGS</span></span>+=-<span class="hljs-type"><span class="hljs-type">I</span></span> ../common echo&gt;&gt; <span class="hljs-type"><span class="hljs-type">MakeF</span></span> <span class="hljs-type"><span class="hljs-type">LIBS</span></span>+=$(call add_component_ref,vl) $(call add_component_ref,common) echo&gt;&gt; <span class="hljs-type"><span class="hljs-type">MakeF</span></span> <span class="hljs-type"><span class="hljs-type">OBJS</span></span>=\ find %<span class="hljs-type"><span class="hljs-type">FP</span></span>% -<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> f -name '*.c*' | grep -v .svn | awk '{ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">print</span></span></span><span class="hljs-class"> "\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/" $1 ".$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJSuffix</span></span></span><span class="hljs-class">)\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">\\\"; }' | sed -e 's/\.cpp\./\./' | sed -e 's/\.cxx\./\./' | sed -e 's?/%</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FP</span></span></span><span class="hljs-class">%??' &gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMMON_PLUGIN_OBJS</span></span></span><span class="hljs-class">) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">HEADERS</span></span></span><span class="hljs-class">=\ find %</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FP</span></span></span><span class="hljs-class">% -</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> f -name '*.h*' | grep -v .svn | awk '{ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">print</span></span></span><span class="hljs-class"> "\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">" $1 "\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">\\\"; }' &gt; headers &gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> ifeq (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">win</span></span></span><span class="hljs-class">,$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OS</span></span></span><span class="hljs-class">)) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJS</span></span></span><span class="hljs-class">+= $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">).res echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES_TGT</span></span></span><span class="hljs-class">=$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">)_w.$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES</span></span></span><span class="hljs-class">) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> else echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES_TGT</span></span></span><span class="hljs-class">=$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class">/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">)_w.$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES</span></span></span><span class="hljs-class">) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> endif echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> ifeq (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mac</span></span></span><span class="hljs-class">,$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OS</span></span></span><span class="hljs-class">)) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> ifeq (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x64</span></span></span><span class="hljs-class">,$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ARCH</span></span></span><span class="hljs-class">)) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET</span></span></span><span class="hljs-class">:= echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> endif echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> endif echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> all: $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET</span></span></span><span class="hljs-class">) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> clean: echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> rm -rf $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJS</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET_DIR</span></span></span><span class="hljs-class">)/* echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET</span></span></span><span class="hljs-class">): $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJS</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LIBS</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES_TGT</span></span></span><span class="hljs-class">) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LINK</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LDFLAGS</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LDFLAGS_InDesignPlugin</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJS</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LIBS</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AdobeLIBS</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">XLIBS</span></span></span><span class="hljs-class">) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> ifeq ($(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OS</span></span></span><span class="hljs-class">),win) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">)_w.$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES</span></span></span><span class="hljs-class">): $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">).fr echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ODFRC</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ODFRCFLAGS</span></span></span><span class="hljs-class">) -o $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unix_to_dos</span></span></span><span class="hljs-class">,$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">)_w.$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES</span></span></span><span class="hljs-class">)) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">).fr echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">).res: $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">).rc $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">)_w.$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES</span></span></span><span class="hljs-class">) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RSC</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RSCFLAGS</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CFLAGS_INCLUDE</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">).rc echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AdobeSDK</span></span></span><span class="hljs-class">)\devtools\bin\merge_res.cmd $(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unix_to_dos</span></span></span><span class="hljs-class">,$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">)_w echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> mkdir -p "$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET_DIR</span></span></span><span class="hljs-class">)/($(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PluginName</span></span></span><span class="hljs-class">) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Resources</span></span></span><span class="hljs-class">)" echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> cp -r $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/idrc_* "$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET_DIR</span></span></span><span class="hljs-class">)/($(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PluginName</span></span></span><span class="hljs-class">) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Resources</span></span></span><span class="hljs-class">)" echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> endif echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> ifeq ($(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OS</span></span></span><span class="hljs-class">),mac) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class">/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">)_w.$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES</span></span></span><span class="hljs-class">): $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">).fr echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> mkdir -p $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET_DIR</span></span></span><span class="hljs-class">)/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Resources</span></span></span><span class="hljs-class"> echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> mkdir -p $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class"> echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ODFRC</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ODFRCFLAGS</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CFLAGS_IXA_OF</span></span></span><span class="hljs-class">) -o $@ $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">COMPONENT</span></span></span><span class="hljs-class">).fr echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> /</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Developer</span></span></span><span class="hljs-class">/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Tools</span></span></span><span class="hljs-class">/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ResMerger</span></span></span><span class="hljs-class"> -dstIs </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DF</span></span></span><span class="hljs-class"> $@ -o $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PluginName</span></span></span><span class="hljs-class">).$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES</span></span></span><span class="hljs-class">) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> /</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Developer</span></span></span><span class="hljs-class">/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Tools</span></span></span><span class="hljs-class">/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ResMerger</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PluginName</span></span></span><span class="hljs-class">).$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FRES</span></span></span><span class="hljs-class">) -dstIs </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DF</span></span></span><span class="hljs-class"> -o $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET_DIR</span></span></span><span class="hljs-class">)/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Resources</span></span></span><span class="hljs-class">/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PluginName</span></span></span><span class="hljs-class">).rsrc echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> cp -r $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class">/idrc_* </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Info</span></span></span><span class="hljs-class">.plist $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET_DIR</span></span></span><span class="hljs-class">)/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Resources</span></span></span><span class="hljs-class"> echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> ( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cd</span></span></span><span class="hljs-class"> $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TARGET_DIR</span></span></span><span class="hljs-class">)/..; ln -s </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">A</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Current</span></span></span><span class="hljs-class"> ; cd .. ; ln -s </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Versions</span></span></span><span class="hljs-class">/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Current</span></span></span><span class="hljs-class">/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Resources</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Resources</span></span></span><span class="hljs-class"> ; ln -s </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Versions</span></span></span><span class="hljs-class">/</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Current</span></span></span><span class="hljs-class">/$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PluginName</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PluginName</span></span></span><span class="hljs-class">) ) echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> endif echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> include ../make/commplugs.mak echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> # find %</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FP</span></span></span><span class="hljs-class">% -</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> f -name '*.c*' | grep -v .svn | awk '{ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">print</span></span></span><span class="hljs-class"> "$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJDIR</span></span></span><span class="hljs-class">)/" $1 ".$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">OBJSuffix</span></span></span><span class="hljs-class">) : " $1 " $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">HEADERS</span></span></span><span class="hljs-class">)\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">$(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CC</span></span></span><span class="hljs-class">) $(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CFLAGS</span></span></span><span class="hljs-class">) " $1 "\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">n</span></span></span><span class="hljs-class">"; }' | sed -e 's/.cpp././' | sed -e 's/\.cxx\./\./' | sed -e 's?/%</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FP</span></span></span><span class="hljs-class">%/?/?' &gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> echo&gt;&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> #</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EOF</span></span></span><span class="hljs-class"> rem mv </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MakeF</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Makefile</span></span></span><span class="hljs-class"> endlocal</span></span></code> </pre></div></div><br><br><img src="https://habrastorage.org/files/9ae/d24/3d4/9aed243d48fd4fd4abd9f63ead0bed5e.png" alt="image" align="left" width="350"><br><h4>  Nothing foreshadowed, and yeah </h4><br>  And all this worked perfectly until the Adobe InDesign CC 2014 came out. I wanted a visual studio 2012. It was then that the white fur animal kaak jumped out! <br><br>  No, of course I knew in theory that the visual studio had not worked on <i>Khrusha</i> for a <i>long time</i> .  But the fact that cl.exe suddenly turned out to be <i>not a valid Win32 image</i> - it was a hit. <br><br>  I will explain a little bit - since the time of two visual studios of 2005 with service pack and without service pack at the same time, I honestly don‚Äôt put anything on the build machine.  To do this, there is a pure virtual machine, in which I put the visual studio express edition, roll in the correct platform sdk, and copy what happened (licensed and so on) into the appropriate daddy.  A virtual roll back to the state of "there was nothing." <br><br>  And since the installer of 2012 studios wanted a newer one ‚Äî no question, here‚Äôs Windows 8.1.  Any whim - for microsoft. <br><br>  I put, copy - opanki. <br><br><img src="https://habrastorage.org/files/95e/5d2/606/95e5d2606311473498f8db8e7e58e2a8.png" alt="image" width="350" align="left"><br><h4>  Monsieur knows a lot about perversions </h4><br><br>  And then the question arose - what to do? <br><br>  There are few options. <br><br><ol><li>  Put and obzhit new virtualka under Windows 8.1, starting from MinGW and ending with indigogs.  And you need to find licenses - of course, I have everything, but they are in completely different places.  Long and tedious. </li><li>  Move to the Amazon cloud - on w2k12, enough for a long time and will work quickly.  But again the same problem is long and tedious.  And all these accumulated versions and copies are 25 gigs to transfer.  Lazy. </li><li>  To dodge so that he did not have to change anything. </li></ol><br>  I scratched my poppy head, and I thought - <i>wouldn't I have a puruetan</i> ?  After all, my host is worth it. <br><br>  Typing <br><pre> <code class="bash hljs">wine ---2012-\vc\bin\cl.exe /<span class="hljs-built_in"><span class="hljs-built_in">help</span></span></code> </pre><br>  and it does work. <br><br>  <i>- Yeah!</i>  <i>- said the harsh Siberian men.</i> <br><br>  Of course, not without a rake, it turned out that some libraries from the visual studio runtime in Vaina are not quite like that.  This is not a problem - the visual studio has a reference, copied the visual studio for daddies. <br><br>  But what surprised me, the quite simple mt.exe not only crashed, but also caused SIGSEGV in wine.  Shamanism with libraries did not give a solution, I had to quickly write my own substitute with poetess. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs lua">#include &lt;windows.h&gt; #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.h&gt; #include &lt;<span class="hljs-built_in"><span class="hljs-built_in">io</span></span>.h&gt; #include &lt;fcntl.h&gt; #include &lt;sys/types.h&gt; #include &lt;sys/stat.h&gt; static void usage() { printf(<span class="hljs-string"><span class="hljs-string">"Usage: mt.exe -manifest foo.dll.manifest -outputresource:foo.dll[;2]\n"</span></span>); } static void alert(<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>* fn, <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>* msg, int code) { static <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>* lpstrError; FormatMessageA(FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_ALLOCATE_BUFFER, NULL, GetLastError(), LANG_USER_DEFAULT, &amp;lpstrError, <span class="hljs-number"><span class="hljs-number">1</span></span>, NULL); fprintf(<span class="hljs-built_in"><span class="hljs-built_in">stderr</span></span>, <span class="hljs-string"><span class="hljs-string">"%s: %s: %s, %d\n"</span></span>, fn, msg, lpstrError, code); LocalFree(lpstrError); } static int update_res(<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>* ou, int resk, <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>* mf) { HANDLE hUpdateRes; LPVOID buf; BOOL result; FILE* fp; struct _stat st; int ressz = <span class="hljs-number"><span class="hljs-number">0</span></span>, outk; fp = fopen(mf, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!fp) { alert(mf, <span class="hljs-string"><span class="hljs-string">"could not open manifest file"</span></span>, errno); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_fstat( fileno(fp), &amp;st) != <span class="hljs-number"><span class="hljs-number">0</span></span>) { fclose(fp); alert(mf, <span class="hljs-string"><span class="hljs-string">"could not determine manifest file size"</span></span>, errno); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; } ressz = st.st_size; buf = (void*)malloc(ressz); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!buf) { fclose(fp); free(buf); alert(mf, <span class="hljs-string"><span class="hljs-string">"could not allocate buffer for resource"</span></span>, ressz); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; } outk = fread(buf, <span class="hljs-number"><span class="hljs-number">1</span></span>, ressz, fp); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(outk != ressz) { fclose(fp); free(buf); alert(mf, <span class="hljs-string"><span class="hljs-string">"could not read manifest"</span></span>, ressz - outk); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; } fclose(fp); hUpdateRes = BeginUpdateResourceA(ou, FALSE); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hUpdateRes == NULL) { free(buf); alert(ou, <span class="hljs-string"><span class="hljs-string">"Could not open file for writing."</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>; } result = UpdateResourceA(hUpdateRes, RT_MANIFEST, MAKEINTRESOURCE(resk), MAKELANGID(LANG_NEUTRAL, SUBLANG_NEUTRAL), buf, ressz); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result == FALSE) { alert(ou, <span class="hljs-string"><span class="hljs-string">"could not add resource"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); free(buf); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!EndUpdateResource(hUpdateRes, FALSE)) { alert(ou, <span class="hljs-string"><span class="hljs-string">"could not write changes to file"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); free(buf); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>; } free(buf); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } int main(int argc, <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>** argv) { <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>* mf = NULL; <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>* ou = NULL; <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>* v; int resk = <span class="hljs-number"><span class="hljs-number">1</span></span>; int k; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(argc &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { usage(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(k=<span class="hljs-number"><span class="hljs-number">1</span></span>; k &lt; argc; ++k) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(argv[k][<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">'-'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(argv[k][<span class="hljs-number"><span class="hljs-number">1</span></span>] ==<span class="hljs-string"><span class="hljs-string">'m'</span></span>) { // manifest mf = argv[k+<span class="hljs-number"><span class="hljs-number">1</span></span>]; ++k; continue; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(argv[k][<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'o'</span></span> ) { // outputresource <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(argv[k+<span class="hljs-number"><span class="hljs-number">1</span></span>]) ou = argv[k+<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ou = strchr(argv[k], <span class="hljs-string"><span class="hljs-string">':'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!ou) { usage(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>; } ++ou; } ++k; v = strchr(ou, <span class="hljs-string"><span class="hljs-string">';'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v) { resk = atoi(v + <span class="hljs-number"><span class="hljs-number">1</span></span>); *v = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> resk = <span class="hljs-number"><span class="hljs-number">1</span></span>; continue; } } usage(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!mf || !ou) { usage(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> update_res(ou, resk, mf); }</code> </pre></div></div><br><br>  But InnoSetup against expectations - did not bring surprises, collects with a whistle. <br><br>  So far - so, and then I will go to the cloud, the moment has matured. <br><br>  But nevertheless I decided to share with the community - all of a sudden I‚Äôm missing something, all of a sudden someone will come in handy ... </div><p>Source: <a href="https://habr.com/ru/post/232341/">https://habr.com/ru/post/232341/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../232323/index.html">Debugging Qt Style Sheet</a></li>
<li><a href="../232327/index.html">Sequel "Intel Inside" in Russian with 3G: tablet review iconBIT NETTAB THOR IZ 3G</a></li>
<li><a href="../232329/index.html">Discussion of the bill to ban Bitcoin in Russia</a></li>
<li><a href="../232337/index.html">Mutual assistance in the accelerator: the collective mind of twenty-three projects</a></li>
<li><a href="../232339/index.html">Temperature control of fast thermal processes</a></li>
<li><a href="../232343/index.html">Happy birthday, Kevin Mitnick!</a></li>
<li><a href="../232345/index.html">User interaction in Smart TV commercial interfaces</a></li>
<li><a href="../232347/index.html">Parsing email addresses from a string in C #</a></li>
<li><a href="../232351/index.html">VKApp Treatment for iPhone</a></li>
<li><a href="../232353/index.html">Social engineering in practice: ‚Äúphysical access‚Äù to Kevin Mitnick‚Äôs private conference</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>