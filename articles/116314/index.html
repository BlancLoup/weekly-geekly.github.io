<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unladen Swallow is everything ...</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the translator: a couple of hours ago, Guido, in his twitter, mentioned the blog post of his colleague, one of the (former) developers of Unladen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unladen Swallow is everything ...</h1><div class="post__text post__text-html js-mediator-article">  <i>From the translator: a couple of hours ago, Guido, in his twitter, <a href="http://twitter.com/">mentioned the</a> blog post of his colleague, one of the (former) developers of Unladen Swallow, in which he tells the sad story of Unladen Swallow‚Äôs vivid but short life on Google.</i> <i><br><br></i>  <i>Original: Reid Kleckner - <a href="http://qinsb.blogspot.com/2011/03/unladen-swallow-retrospective.html">Unladen Swallow Retrospective</a></i> <br><br><a name="habracut"></a><br><h1>  Unladen Swallow: Retrospective </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>I started writing this while I was at PyCon, but I‚Äôve been fine-tuning the text ever since.</i>  <i>Anyway, here.</i>  <i>:)</i> <br><br>  As is already obvious, no one else seriously takes care of either Unladen Swallow directly or porting it to py3k.  Why? <br><br>  <b>Loss of customer interest</b> <br><br>  The main reason is that Google hasn‚Äôt found enough potential users for Unladen Swallow.  This is due to several reasons: <br><ol><li>  For the main volume of the Python-code in Google high performance is not required.  Python is mainly used for tools and prototyping, while the main end-user applications are written in Java and C ++. </li><li>  The same internal users, for whom performance was important, were embarrassed by the too complex deployment requirements of Unladen Swallow.  For them, it was not just necessary that Unladen Swallow be a replacement for CPython ‚Äî any new Python implementation would have to replace the existing one on a turnkey basis.  We thought that, basing the source code on CPython, rather than starting development from absolute zero, we avoid this problem, because all the extensions to C and SWIG wrappers will continue to work as if nothing had happened.  Nevertheless, even the transition from the previous version of CPython to Python 2.6 was too complicated. </li><li>  Our potential users somehow found other ways to solve their performance problems, which turned out to be more convenient for them to deploy. </li></ol><br>  After my internship ended, I tried to make Unladen the theme of my MIT master's thesis, but my manager found that the results achieved at that time did not promise good prospects, and that the concepts I wanted to apply were no longer considered modern.  Basic techniques <i>(from translator: I mean techniques for generating optimized code based on tracking the process of performing non-optimized)</i> feedback, and already implemented by Urs H√∂lzle for Smalltalk, and tracing techniques - by Andreas Gil <i>(from comments: in fact, Andreas Gal)</i> for java.  Of course, this does not mean that no one else could invent new techniques, but at that time I had no fresh ideas. <br><br>  <b>Loss of self interest</b> <br><br>  Basically, all of the above was considered in the first quarter of 2010.  We could still decide to work on Unladen in our free time, but that would be different. <br><br>  First, working on a project alone is far from being so cool as with other people, especially if it is not obvious whether your creation will ever have users. <br><br>  Secondly, one of the main reasons for our interest was that we thought that PyPy would never even try to support extensions in C or SWIG-wrapped code.  We were quite surprised when we learned that the PyPy project started moving precisely in this direction.  This has partially alleviated the need for a ‚Äúplug-in‚Äù JIT for CPython.  In addition, when the project was launched, PyPy did not yet support the 64-bit platform, but over time they added this support. <br><br>  And, in the end, the comments in python-dev that we read did not encourage us.  People assumed that if Unladen Swallow falls into py3k, then this code will be supported by Google, but these assumptions were already groundless.  If code misses it would seem, it would mean that by default JIT would be turned off, and in a year, <a href="http://en.wikipedia.org/wiki/Bit_rot">due to rare use and lack of support</a> , it would have to be removed again.  Very few developers were interested in the new JIT.  We never kept the code, but we hoped that if we finished, we could inspire the developers of CPython to catch it. <br><br>  So, taking into account all of the above reasons why none of us are engaged in Unladen anymore, what do we understand? <br><br>  <b>Conclusions about LLVM</b> <br><br>  First, we deeply studied the pros and cons of using LLVM to generate JIT code.  Our initial decision to use LLVM was made due to the fact that none of us knew the x86 assembler deeply enough, but we also wanted to support both x86 and x86_64, and maybe even ARM.  We considered the option to recycle psyco, but refused mainly because of the need for deep knowledge of x86. <br><br>  Unfortunately, at the moment LLVM is too focused on use as a static optimizer and backend.  Code generation and optimization of LLVM are good, but too ‚Äúexpensive‚Äù to use.  The optimizations are too focused on working with intermediate code representation generated by static C-like languages.  Most of the basic techniques for optimizing Python require a high-level representation of how the program worked on previous iterations, which was difficult with LLVM. <br><br>  An example of how high-level code generation is used is optimization of work with the Python stack.  LLVM is not able to optimize reading from the Python stack between calls to external functions (that is, the CPython environment, which means it never actually).  To solve this problem, we finally had to write an analysis of aliases, and all this is a typical example of what you encounter if you do not create your own code generator. <br><br>  In addition, other restrictions apply to LLVM.  For example, LLVM does not seriously support back-patching <i>(from the translator: apparently, dynamic code modification)</i> , which PyPy uses for editing on the fly outputs from the validation branches of the working code.  This is quite an important requirement with significant memory consumption, but I would argue with the latter, because according to the results of Steven Noonan‚Äôs work within the GSOC, the consumption can be reduced, especially considering that PyPy has a higher memory consumption. <br><br>  In addition, I spent the summer creating an interface between LLVM JIT and gdb.  It was not necessary, but the result was a useful tool.  I don‚Äôt know what is being used to debug PyPy now, but we can take advantage of our experience and apply it to PyPy. <br><br>  <b>results</b> <br><br>  Personally, I, before starting work on this project, took a course on compilers and operating systems, but the experience I gained during my work brought me a huge amount of new skills.  I am now quite well versed in gdb, rules it for myself and even debugged gdb with gdb.  Now I know a lot more about x86, compiler optimization techniques, JIT features, and this is what I use in my master‚Äôs work. <br><br>  I am also very proud of our macro benchmark collection of real Python applications, which is now actively used by the PyPy project: <a href="http://speed.pypy.org/">speed.pypy.org</a> .  Perhaps from all my performance-related Python activities, he turned out to be the most useful.  Any change in performance is easy to see from changes in results before and after it appears. <br><br>  We also brought some benefits to LLVM, thereby helping other LLVM-based JIT projects, such as Parrot and Rubinius.  For example, I helped fix the 16-megabyte restriction on the code being analyzed by JIT.  Again, now for the LLVM JIT there is an interface gdb.  Jeff also spent a lot of time so that C-shny functions could be compiled directly into JIT-generated code, as well as editing memory leaks and adding a TypeBuilder pattern to build C-shny types in LLVM. <br><br>  Therefore, no matter how much I wish there were more resources, and the project would survive, it all brought me great experience, we managed to bring some benefits to LLVM and create a very useful set of benchmarks. </div><p>Source: <a href="https://habr.com/ru/post/116314/">https://habr.com/ru/post/116314/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116305/index.html">As I watched Formula 1 on the BBC live via the Internet</a></li>
<li><a href="../116308/index.html">We are writing the viewer of the MS Exchange mail database (part 1)</a></li>
<li><a href="../116309/index.html">Feature of work of class AsyncTask</a></li>
<li><a href="../116311/index.html">Watching video without leaving the site</a></li>
<li><a href="../116313/index.html">Yandex with taste of Intel</a></li>
<li><a href="../116316/index.html">Greetings GCC 4.6</a></li>
<li><a href="../116317/index.html">Difficulties in comparing code analyzers or do not forget about usability</a></li>
<li><a href="../116318/index.html">Warner Bros. launches some more movies on Facebook</a></li>
<li><a href="../116320/index.html">Arab support problems. Where is more dramatic, in a Nokia ad or on a female body?</a></li>
<li><a href="../116322/index.html">Surgeons at Sunnybrook Hospital use Kinect during surgery.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>