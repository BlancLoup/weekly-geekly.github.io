<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The complete guide to CMake. Part Two: Build System</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 


 This article discusses the use of the CMake build system used in a huge number of C / C ++ projects. It is strongly recommended to re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The complete guide to CMake. Part Two: Build System</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/lf/se/70/lfse70sjifxiyddiuym73hdvcho.png"></p><br><h1 id="vvedenie">  Introduction </h1><br><p>  This article discusses the use of the CMake build system used in a huge number of C / C ++ projects.  It is strongly recommended to read the <a href="https://habr.com/post/431428">first part of the</a> manual in order to avoid misunderstanding the syntax of the CMake language, which appears explicitly throughout the article. </p><a name="habracut"></a><br><h1 id="zapusk-cmake">  Launch CMake </h1><br><p>  Below are examples of using the CMake language that you should practice using.  Experiment with the source code, changing existing commands and adding new ones.  To run these examples, install CMake from the <a href="https://cmake.org/">official site</a> . </p><br><h1 id="princip-raboty">  Principle of operation </h1><br><p>  <a href="https://cmake.org/cmake/help/latest/manual/cmake-buildsystem.7.html">The CMake build system</a> is a shell over other platform-dependent utilities (for example, <a href="https://ninja-build.org/">Ninja</a> or <a href="https://www.gnu.org/software/make">Make</a> ).  Thus, in the assembly process itself, however paradoxical it may sound, it does not directly participate. </p><br><p> The CMake build system accepts a <code>CMakeLists.txt</code> file with a description of the build rules in the formal CMake language, and then generates intermediate and native build files in the same directory adopted on your platform. </p><br><p>  The generated files will contain specific names of system utilities, directories and compilers, while CMake commands operate only with an abstract concept of a compiler and are not tied to platform-dependent tools, which differ greatly on different operating systems. </p><br><h1 id="proverka-versii-cmake">  CMake version check </h1><br><p>  The <a href="https://cmake.org/cmake/help/latest/command/cmake_minimum_required.html"><code>cmake_minimum_required</code></a> command checks a running version of CMake: if it is less than the specified minimum, then CMake completes its work with a fatal error.  An example demonstrating typical use of this command at the beginning of any CMake file: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#     CMake: cmake_minimum_required(VERSION 3.0)</span></span></code> </pre> <br><p>  As <a href="https://habr.com/post/432096/">noted</a> in the comments, the <a href="https://cmake.org/cmake/help/latest/command/cmake_minimum_required.html"><code>cmake_minimum_required</code></a> command sets all compatibility flags (see <a href="https://cmake.org/cmake/help/latest/command/cmake_policy.html"><code>cmake_policy</code></a> ).  Some developers deliberately set a low version of CMake, and then adjust the functionality manually.  This allows you to simultaneously support the ancient version of CMake and sometimes use new features. </p><br><h1 id="oformlenie-proekta">  Design of the project </h1><br><p>  At the beginning of any <code>CMakeLists.txt</code> should set the project characteristics with the project command to better design the integrated environments and other development tools. </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyProject": project(MyProject VERSION 1.2.3.4 LANGUAGES C CXX)</span></span></code> </pre> <br><p>  It should be noted that if the <code>LANGUAGES</code> keyword is omitted, then <code>C CXX</code> languages ‚Äã‚Äãare set by default.  You can also disable the indication of any languages ‚Äã‚Äãby writing the keyword <code>NONE</code> as a list of languages, or simply leave an empty list. </p><br><h1 id="zapusk-skriptovyh-faylov">  Running Script Files </h1><br><p>  The <a href="https://cmake.org/cmake/help/latest/command/include.html"><code>include</code></a> command replaces the line of its call with the code of the specified file, acting in the same way as the preprocessor <code>include</code> command of C / C ++ languages.  This example runs the script file <code>MyCMakeScript.cmake</code> command described: </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(<span class="hljs-string"><span class="hljs-string">"'TEST_VARIABLE' is equal to [${TEST_VARIABLE}]"</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   `MyCMakeScript.cmake`  : include(MyCMakeScript.cmake) message("'TEST_VARIABLE' is equal to [${TEST_VARIABLE}]")</span></span></code> </pre> <br><p>  In this example, the first message will notify that the <code>TEST_VARIABLE</code> variable <code>TEST_VARIABLE</code> not yet been defined, however, if the <code>MyCMakeScript.cmake</code> script determines this variable, the second message will already inform about the new value of the test variable.  Thus, the script file included by the <a href="https://cmake.org/cmake/help/latest/command/include.html"><code>include</code></a> command does not create its own scope, as <a href="https://habr.com/post/431428/">mentioned</a> in the comments to the <a href="https://habr.com/post/431428">previous article</a> . </p><br><h1 id="kompilyaciya-ispolnyaemyh-faylov">  Compiling executable files </h1><br><p>  The <a href="https://cmake.org/cmake/help/latest/command/add_executable.html"><code>add_executable</code></a> command compiles an executable file with the specified name from the source list.  It is important to note that the final file name depends on the target platform (for example, <code>&lt;ExecutableName&gt;.exe</code> or simply <code>&lt;ExecutableName&gt;</code> ).  A typical example of calling this command is: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyExecutable"  #  "ObjectHandler.c", "TimeManager.c"  "MessageGenerator.c": add_executable(MyExecutable ObjectHandler.c TimeManager.c MessageGenerator.c)</span></span></code> </pre> <br><h1 id="kompilyaciya-bibliotek">  Library compilation </h1><br><p>  The <a href="https://cmake.org/cmake/help/latest/command/add_library.html"><code>add_library</code></a> command compiles a library with the specified view and a name from source.  It is important to note that the final library name depends on the target platform (for example, <code>lib&lt;LibraryName&gt;.a</code> or <code>&lt;LibraryName&gt;.lib</code> ).  A typical example of calling this command is: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyLibrary"  #  "ObjectHandler.c", "TimeManager.c"  "MessageConsumer.c": add_library(MyLibrary STATIC ObjectHandler.c TimeManager.c MessageConsumer.c)</span></span></code> </pre> <br><ul><li>  Static libraries are specified by the <code>STATIC</code> keyword as the second argument and are archives of object files linked to executable files and other libraries at compile time; </li><li>  Dynamic libraries are specified by the <code>SHARED</code> keyword as the second argument and are binary libraries that are loaded by the operating system during program execution; </li><li>  Modular libraries are specified by the <code>MODULE</code> keyword by the second argument and are binary libraries loaded by execution techniques by the executable file itself; </li><li>  Object libraries are specified by the <code>OBJECT</code> keyword as the second argument and are a set of object files that are associated with executable files and other libraries during compilation. </li></ul><br><h1 id="dobavlenie-ishodnikov-k-celi">  Add source to target </h1><br><p>  There are cases that require adding source files to the target.  For this purpose, a <a href="https://cmake.org/cmake/help/latest/command/target_sources.html"><code>target_sources</code></a> command is <a href="https://cmake.org/cmake/help/latest/command/target_sources.html"><code>target_sources</code></a> that can add source to the target multiple times. </p><br><p>  The first argument is the <a href="https://cmake.org/cmake/help/latest/command/target_sources.html"><code>target_sources</code></a> command accepts the name of the target previously specified using the <a href="https://cmake.org/cmake/help/latest/command/add_library.html"><code>add_library</code></a> or <a href="https://cmake.org/cmake/help/latest/command/add_executable.html"><code>add_executable</code></a> , and the following arguments are the list of source files to be added. </p><br><p>  Repeated calls to the <a href="https://cmake.org/cmake/help/latest/command/target_sources.html"><code>target_sources</code></a> add source files to the target in the order in which they were called, so the bottom two blocks of code are functionally equivalent: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyExecutable"   # "ObjectPrinter.c"  "SystemEvaluator.c": add_executable(MyExecutable ObjectPrinter.c SystemEvaluator.c) #    "MyExecutable"  "MessageConsumer.c": target_sources(MyExecutable MessageConsumer.c) #    "MyExecutable"  "ResultHandler.c": target_sources(MyExecutable ResultHandler.c)</span></span></code> </pre> <br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyExecutable"   # "ObjectPrinter.c", "SystemEvaluator.c", "MessageConsumer.c"  "ResultHandler.c": add_executable(MyExecutable ObjectPrinter.c SystemEvaluator.c MessageConsumer.c ResultHandler.c)</span></span></code> </pre> <br><h1 id="generiruemye-fayly">  Generated files </h1><br><p>  The location of the output files generated by the <a href="https://cmake.org/cmake/help/latest/command/add_executable.html"><code>add_executable</code></a> and <a href="https://cmake.org/cmake/help/latest/command/add_library.html"><code>add_library</code></a> is determined only at the generation stage, but this rule can be changed by several variables defining the final location of the binary files: </p><br><ul><li>  The variables <a href="https://cmake.org/cmake/help/latest/prop_tgt/RUNTIME_OUTPUT_DIRECTORY.html"><code>RUNTIME_OUTPUT_DIRECTORY</code></a> and <a href="https://cmake.org/cmake/help/latest/prop_tgt/RUNTIME_OUTPUT_NAME.html"><code>RUNTIME_OUTPUT_NAME</code></a> determine the location of the execution targets; </li><li>  The variables <a href="https://cmake.org/cmake/help/latest/prop_tgt/LIBRARY_OUTPUT_DIRECTORY.html"><code>LIBRARY_OUTPUT_DIRECTORY</code></a> and <a href="https://cmake.org/cmake/help/latest/prop_tgt/LIBRARY_OUTPUT_NAME.html"><code>LIBRARY_OUTPUT_NAME</code></a> determine the location of the libraries; </li><li>  The variables <a href="https://cmake.org/cmake/help/latest/prop_tgt/ARCHIVE_OUTPUT_DIRECTORY.html"><code>ARCHIVE_OUTPUT_DIRECTORY</code></a> and <a href="https://cmake.org/cmake/help/latest/prop_tgt/ARCHIVE_OUTPUT_NAME.html"><code>ARCHIVE_OUTPUT_NAME</code></a> define the location of the archives. </li></ul><br><p>  Executable files are always viewed as execution targets, static libraries as archive targets, and modular libraries as library targets.  For non-DLL platforms, dynamic libraries are considered library targets, and for DLL platforms, execution targets.  For object libraries such variables are not provided, since this kind of libraries is generated in the depths of the <code>CMakeFiles</code> catalog. </p><br><p>  It is important to note that all platforms based on Windows, including <a href="https://cygwin.com/">Cygwin,</a> are considered "DLL-platforms". </p><br><h1 id="komponovka-s-bibliotekami">  Library layout </h1><br><p>  The <a href="https://cmake.org/cmake/help/latest/command/target_link_libraries.html"><code>target_link_libraries</code></a> command <a href="https://cmake.org/cmake/help/latest/command/target_link_libraries.html"><code>target_link_libraries</code></a> library or executable file with other libraries provided.  <a href="https://cmake.org/cmake/help/latest/command/add_executable.html"><code>add_executable</code></a> first argument, this command takes the name of the target generated using the <a href="https://cmake.org/cmake/help/latest/command/add_executable.html"><code>add_executable</code></a> or <a href="https://cmake.org/cmake/help/latest/command/add_library.html"><code>add_library</code></a> , and the following arguments are the names of the library targets or full paths to the libraries.  Example: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    "MyExecutable"  #  "JsonParser", "SocketFactory"  "BrowserInvoker": target_link_libraries(MyExecutable JsonParser SocketFactory BrowserInvoker)</span></span></code> </pre> <br><p>  It should be noted that modular libraries cannot be linked with executable files or other libraries, since they are intended solely for downloading by technicians. </p><br><h1 id="rabota-s-celyami">  Work with goals </h1><br><p>  As <a href="https://habr.com/post/432096/">mentioned</a> in the comments, CMake targets are also subject to manual manipulation, but very limited. </p><br><p>  It is possible to control the properties of the objectives, intended to set the project assembly process.  The <a href="https://cmake.org/cmake/help/latest/command/get_target_property.html"><code>get_target_property</code></a> command assigns a target property value to the variable provided.  This example displays the value of the <a href="https://cmake.org/cmake/help/latest/prop_tgt/C_STANDARD.html"><code>C_STANDARD</code></a> property of the <a href="https://cmake.org/cmake/help/latest/prop_tgt/C_STANDARD.html"><code>C_STANDARD</code></a> target on the screen: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   "VALUE"   "C_STANDARD": get_target_property(VALUE MyTarget C_STANDARD) #      : message("'C_STANDARD' property is equal to [${VALUE}]")</span></span></code> </pre> <br><p>  The <a href="https://cmake.org/cmake/help/latest/command/set_target_properties.html"><code>set_target_properties</code></a> command sets the specified target properties with the specified values.  This command accepts a list of targets for which property values ‚Äã‚Äãwill be set, and then the <code>PROPERTIES</code> keyword, followed by a list of the form <code>&lt; &gt; &lt; &gt;</code> : </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   'C_STANDARD'  "11", #   'C_STANDARD_REQUIRED'  "ON": set_target_properties(MyTarget PROPERTIES C_STANDARD 11 C_STANDARD_REQUIRED ON)</span></span></code> </pre> <br><p>  The example above has set <code>MyTarget</code> properties that affect the compilation process, namely: when compiling the goal, <code>MyTarget</code> CMake will <code>MyTarget</code> compiler to use the C11 standard.  All known target property names are listed on <a href="https://cmake.org/cmake/help/latest/manual/cmake-properties.7.html">this page</a> . </p><br><p>  It is also possible to check previously defined targets using the <code>if(TARGET &lt;TargetName&gt;)</code> construct <code>if(TARGET &lt;TargetName&gt;)</code> : </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#  "The target was defined!"   "MyTarget"  , #    "The target was not defined!": if(TARGET MyTarget) message("The target was defined!") else() message("The target was not defined!") endif()</span></span></code> </pre> <br><h1 id="dobavlenie-podproektov">  Adding Subprojects </h1><br><p>  The <a href="https://cmake.org/cmake/help/latest/command/add_subdirectory.html"><code>add_subdirectory</code></a> command prompts CMake to immediately process the specified subproject file.  The example below demonstrates the use of the described mechanism: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   "subLibrary"    , #       "subLibrary/build": add_subdirectory(subLibrary subLibrary/build)</span></span></code> </pre> <br><p>  In this example, the first argument of the <a href="https://cmake.org/cmake/help/latest/command/add_subdirectory.html"><code>add_subdirectory</code></a> command is the <a href="https://cmake.org/cmake/help/latest/command/add_subdirectory.html"><code>add_subdirectory</code></a> subproject, and the second argument is optional and informs CMake about the folder intended for the generated files of the included subproject (for example, <code>CMakeCache.txt</code> and <code>cmake_install.cmake</code> ). </p><br><p>  It is worth noting that all variables from the parent scope are inherited by the added directory, and all variables defined and redefined in this directory will be visible only to it (unless the keyword <code>PARENT_SCOPE</code> was specified by the argument of the <a href="https://cmake.org/cmake/help/latest/command/set.html"><code>set</code></a> command).  This feature was <a href="https://habr.com/post/431428/">mentioned</a> in the comments to the <a href="https://habr.com/post/431428">previous article</a> . </p><br><h1 id="poisk-paketov">  Search for packages </h1><br><p>  The <a href="https://cmake.org/cmake/help/latest/command/find_package.html"><code>find_package</code></a> command finds and loads external project settings.  In most cases, it is used for the subsequent linking of external libraries, such as <a href="https://www.boost.org/">Boost</a> and <a href="https://www.gnu.org/software/gsl">GSL</a> .  This example calls the described command to search for the <a href="https://www.gnu.org/software/gsl">GSL</a> library and then link it: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#     "GSL": find_package(GSL 2.5 REQUIRED) #      "GSL": target_link_libraries(MyExecutable GSL::gsl) #      "GSL": target_include_directories(MyExecutable ${GSL_INCLUDE_DIRS})</span></span></code> </pre> <br><p>  In the example above, the <a href="https://cmake.org/cmake/help/latest/command/find_package.html"><code>find_package</code></a> command first takes the name of the package, and then the required version.  The <code>REQUIRED</code> option requires printing a fatal error and CMake shutdown if the required package is not found.  The opposite is the <code>QUIET</code> option, requiring CMake to continue its work, even if the package was not found. </p><br><p>  Next, the <code>MyExecutable</code> executable file <code>MyExecutable</code> linked with the GSL library by the <a href="https://cmake.org/cmake/help/latest/command/target_link_directories.html"><code>target_link_libraries</code></a> command using the <code>GSL::gsl</code> variable encapsulating the location of the already compiled GSL. </p><br><p>  At the end, the <a href="https://cmake.org/cmake/help/latest/command/target_include_directories.html"><code>target_include_directories</code></a> command is <a href="https://cmake.org/cmake/help/latest/command/target_include_directories.html"><code>target_include_directories</code></a> , informing the compiler about the location of the GSL header files.  Notice that the <code>GSL_INCLUDE_DIRS</code> variable is <code>GSL_INCLUDE_DIRS</code> , which stores the location of the headers I described (this is an example of the imported package settings). </p><br><p>  You will probably want to check the result of the package search if you specified the <code>QUIET</code> option.  This can be done by checking the <code>&lt;PackageName&gt;_FOUND</code> , which is automatically detected after the <a href="https://cmake.org/cmake/help/latest/command/find_package.html"><code>find_package</code></a> command <a href="https://cmake.org/cmake/help/latest/command/find_package.html"><code>find_package</code></a> .  For example, if the GSL settings are successfully imported into your project, the <code>GSL_FOUND</code> variable will turn into true. </p><br><p>  In general, the <a href="https://cmake.org/cmake/help/latest/command/find_package.html"><code>find_package</code></a> command has two types of launch: modular and configuration.  The example above applied a modular form.  This means that during a call, CMake searches for a script file of the type <code>Find&lt;PackageName&gt;.cmake</code> in the <a href="https://cmake.org/cmake/help/latest/variable/CMAKE_MODULE_PATH.html"><code>CMAKE_MODULE_PATH</code></a> directory, and then launches it and imports all the necessary settings (in this case, CMake launched the standard <code>FindGSL.cmake</code> file). </p><br><h1 id="sposoby-vklyucheniya-zagolovkov">  Ways to include titles </h1><br><p>  The compiler can be informed about the placement of included headers using two commands: <a href="https://cmake.org/cmake/help/latest/command/include_directories.html"><code>include_directories</code></a> and <a href="https://cmake.org/cmake/help/latest/command/target_include_directories.html"><code>target_include_directories</code></a> .  You decide which one to use, but some differences between them are worth considering (the idea is suggested in the <a href="https://habr.com/post/432096/">comments</a> ). </p><br><p>  The <a href="https://cmake.org/cmake/help/latest/command/include_directories.html"><code>include_directories</code></a> command affects the directory area.  This means that all the directories directories specified by this command will be used for all the purposes of the current <code>CMakeLists.txt</code> , as well as for the subprojects being processed (see <a href="https://cmake.org/cmake/help/latest/command/add_subdirectory.html"><code>add_subdirectory</code></a> ). </p><br><p>  The <a href="https://cmake.org/cmake/help/latest/command/target_include_directories.html"><code>target_include_directories</code></a> command <a href="https://cmake.org/cmake/help/latest/command/target_include_directories.html"><code>target_include_directories</code></a> affects the target specified by the first argument, but no other effect is exerted on other targets.  The example below demonstrates the difference between these two commands: </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_executable</span></span>(RequestGenerator RequestGenerator.c) <span class="hljs-keyword"><span class="hljs-keyword">add_executable</span></span>(ResponseGenerator ResponseGenerator.c) <span class="hljs-comment"><span class="hljs-comment">#     "RequestGenerator": target_include_directories(RequestGenerator headers/specific) #    "RequestGenerator"  "ResponseGenerator": include_directories(headers)</span></span></code> </pre> <br><p>  In the comments it is <a href="https://habr.com/post/432096/">mentioned</a> that in modern projects the use of the <a href="https://cmake.org/cmake/help/latest/command/include_directories.html"><code>include_directories</code></a> and <a href="https://cmake.org/cmake/help/latest/command/link_libraries.html"><code>link_libraries</code></a> is undesirable.  The alternative is the <a href="https://cmake.org/cmake/help/latest/command/target_include_directories.html"><code>target_include_directories</code></a> and <a href="https://cmake.org/cmake/help/latest/command/target_link_libraries.html"><code>target_link_libraries</code></a> that act only on specific targets, and not on the entire current scope. </p><br><h1 id="ustanovka-proekta">  Project Installation </h1><br><p>  The <a href="https://cmake.org/cmake/help/latest/command/install.html"><code>install</code></a> command generates installation rules for your project.  This command is able to work with goals, files, folders and much more.  First, consider setting goals. </p><br><p>  To set goals, the first argument of the described function is to pass the keyword <code>TARGETS</code> , followed by a list of targets to be set, and then the keyword <code>DESTINATION</code> with the location of the directory into which the specified goals will be installed.  This example demonstrates typical goal setting: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   "TimePrinter"  "DataScanner"   "bin": install(TARGETS TimePrinter DataScanner DESTINATION bin)</span></span></code> </pre> <br><p>  The process of describing the installation of files is similar, except for the fact that instead of the keyword <code>TARGETS</code> should indicate <code>FILES</code> .  An example demonstrating the installation of files: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   "DataCache.txt"  "MessageLog.txt"   "~/": install(FILES DataCache.txt MessageLog.txt DESTINATION ~/)</span></span></code> </pre> <br><p>  The process of describing the installation of folders is similar, with the exception that instead of the keyword <code>FILES</code> should specify <code>DIRECTORY</code> .  It is important to note that the installation will copy the entire contents of the folder, and not just its name.  An example of installing folders is as follows: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#   "MessageCollection"  "CoreFiles"   "~/": install(DIRECTORY MessageCollection CoreFiles DESTINATION ~/)</span></span></code> </pre> <br><p>  After CMake has completed processing all your files, you can install all the described objects with the <code>sudo checkinstall</code> (if CMake generates a <code>Makefile</code> ), or perform this action with an integrated development environment that supports CMake. </p><br><h1 id="naglyadnyy-primer-proekta">  Illustrative example of the project </h1><br><p>  This manual would be incomplete without showing a real example of using the CMake build system.  Consider a simple project diagram using CMake as the only build system: </p><br><pre> <code class="plaintext hljs">+ MyProject - CMakeLists.txt - Defines.h - StartProgram.c + core - CMakeLists.txt - Core.h - ProcessInvoker.c - SystemManager.c</code> </pre> <br><p>  The main assembly file <code>CMakeLists.txt</code> describes the compilation of the entire program: first, the <a href="https://cmake.org/cmake/help/latest/command/add_executable.html"><code>add_executable</code></a> that compiles the executable is invoked, then the <a href="https://cmake.org/cmake/help/latest/command/add_subdirectory.html"><code>add_subdirectory</code></a> command is <a href="https://cmake.org/cmake/help/latest/command/add_subdirectory.html"><code>add_subdirectory</code></a> , prompting the subproject processing, and finally, the executable is linked with the compiled library: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    CMake: cmake_minimum_required(VERSION 3.0) #   : project(MyProgram VERSION 1.0.0 LANGUAGES C) #      "MyProgram": add_executable(MyProgram StartProgram.c) #    "core/CMakeFiles.txt": add_subdirectory(core) #    "MyProgram"  #    "MyProgramCore": target_link_libraries(MyProgram MyProgramCore) #    "MyProgram"   "bin": install(TARGETS MyProgram DESTINATION bin)</span></span></code> </pre> <br><p>  The <code>core/CMakeLists.txt</code> file is called by the main assembly file and compiles the static <code>MyProgramCore</code> library, which is intended to link to the executable file: </p><br><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#    CMake: cmake_minimum_required(VERSION 3.0) #      "MyProgramCore": add_library(MyProgramCore STATIC ProcessInvoker.c SystemManager.c)</span></span></code> </pre> <br><p>  After a series of commands <code>cmake . &amp;&amp; make &amp;&amp; sudo checkinstall</code>  <code>cmake . &amp;&amp; make &amp;&amp; sudo checkinstall</code> CMake build system completes successfully.  The first command starts processing the <code>CMakeLists.txt</code> file in the project root directory, the second command finally compiles the necessary binaries, and the third command installs the assembled <code>MyProgram</code> executable file into the system. </p><br><h1 id="zaklyuchenie">  Conclusion </h1><br><p>  Now you are able to write your own and understand other people's CMake files, and you can read about other mechanisms in detail on the <a href="https://cmake.org/cmake/help/latest">official website</a> . </p><br><p>  <a href="https://habr.com/post/433822/">The next article in</a> this guide will be devoted to testing and packaging using CMake and will be released in a week.  See you soon! <br></p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/432096/">https://habr.com/ru/post/432096/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../432086/index.html">3D printing in the international school named after M. V. Lomonosov</a></li>
<li><a href="../432088/index.html">MySQL High Availability on GitHub</a></li>
<li><a href="../432090/index.html">Magento Meetup Kharkiv ‚Ññ4 - video reports</a></li>
<li><a href="../432092/index.html">Unpleasant errors while writing unit tests</a></li>
<li><a href="../432094/index.html">Joint online hackathon from OpenGift and Credits Blockchain Platform</a></li>
<li><a href="../432098/index.html">Autopilots on road transport, how to interact with the specials. transport?</a></li>
<li><a href="../432100/index.html">How we improved the conversion of the payment form</a></li>
<li><a href="../432102/index.html">Explicit JavaScript features</a></li>
<li><a href="../432104/index.html">IT digest of December events (part one)</a></li>
<li><a href="../432106/index.html">Product Design Digest November 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>