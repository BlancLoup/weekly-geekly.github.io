<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Continuing the theme of trojan in Odnoklassniki</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Getting here: vilgeforce.habrahabr.ru/blog/43746.html 

 Anyway, the WinNt32.dll file appeared on the victim's computer, which was loaded into memory ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Continuing the theme of trojan in Odnoklassniki</h1><div class="post__text post__text-html js-mediator-article">  Getting here: <a href="http://vilgeforce.habrahabr.ru/blog/43746.html">vilgeforce.habrahabr.ru/blog/43746.html</a> <br><br>  Anyway, the WinNt32.dll file appeared on the victim's computer, which was loaded into memory and thus its code was executed.  This file downloaded two encrypted files from the network, one of which started and the second injected into svchost (let's call it Injected). <br><br>  Analysis of the first file (dropper) showed the following.  The first stages of his work are identical to those for WinNt32.dll - Sysenter, decryption, loading into memory and execution.  Only in this case 3 files were encrypted.  The first is the payload itself, and the second and third are used by the payload.  What is the payload?  The functionality is simple and uncomplicated - to throw off two previously decrypted files to disk, one of them - under the name WinNt32.dll, and the second under the random name with the extension Sys.  Register both files in the registry, and * .sys is prescribed by the service.  Then start the corresponding service and call one of the DLL functions.  I did not explore the functionality of the driver - alas, this is a complicated matter.  But the dropped DLL is the one with which it all started!  That is, the Downloader downloads the Dropper, and the Dropper saves and runs the Downloader.  Such is the "vicious circle." 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The file that is injected into svchost (Injected) is not encrypted, unlike Downloader and Dropper and even without understanding its work, only by text lines, you can understand that it works with mail.  Most likely, sends spam.  The file has several mail servers, both domestic and foreign, and even a google server. <br>  Thus, the spam mailing was most likely intended to create an army of spambots, and not only Odnoklassniki users could suffer from it, but everyone else as well. </div><p>Source: <a href="https://habr.com/ru/post/26746/">https://habr.com/ru/post/26746/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267451/index.html">Docker, part two. Semi-automatic rifle with homing on the leg</a></li>
<li><a href="../267453/index.html">Webinar: Basics of parallelizing C / C ++ programs using OpenMP</a></li>
<li><a href="../267455/index.html">Docker Recipes: Monkey patch, part three</a></li>
<li><a href="../267457/index.html">Imitate, repeat, apply! English grammar at the count of three</a></li>
<li><a href="../267459/index.html">Hackathon at school InterSystems 2015</a></li>
<li><a href="../267461/index.html">Another algorithm for determining the intersection of two segments</a></li>
<li><a href="../267465/index.html">Exploit a million</a></li>
<li><a href="../267467/index.html">3 Attacks on TACACS + from Cisco</a></li>
<li><a href="../267469/index.html">Search tips from the inside</a></li>
<li><a href="../267471/index.html">gulpfile in 10 lines? Easy! - we simplify the creation of standard tasks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>