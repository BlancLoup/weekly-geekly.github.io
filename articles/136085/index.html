<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simulation of pressing Home, End, PgUp, PgDown</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 About a year and a half ago, I became the proud owner of the HP Mini 110-3155sr. The machine pleased everyone, but there was one proble...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simulation of pressing Home, End, PgUp, PgDown</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><img align="right" src="https://habrastorage.org/getpro/habr/post_images/97e/450/65e/97e45065edbf50bc96e2c2dbb326344e.jpg" alt="image"><br>  About a year and a half ago, I became the proud owner of the HP Mini 110-3155sr.  The machine pleased everyone, but there was one problem that eventually got more and more boring - the lack of Home, End, PgUp, PgDown buttons.  How I solved this problem with a small Python program - under the cat. <br><a name="habracut"></a><br>  The decision comes to mind quickly enough.  If there are no buttons, it means that you need to create some hot keys for them.  I did not find how to do it using system tools, so I started sorting through various programs of this kind.  Despite the fact that there are really many such programs, I did not find the one that would suit me.  Some suggested executing commands on hotkeys, in others there was no convenient keyboard shortcut at all. <br><br>  In the end, I decided to write a small utility with my own hands.  In addition, it became a good idea as a ‚Äúbaptism of fire‚Äù in Python ‚Äî I started learning quite recently, and it became interesting how quickly (if at all) you could do such a thing. <br><br><h4>  Formulation of the problem </h4><img align="right" src="https://habrastorage.org/getpro/habr/comment_images/719/7ce/b8a/7197ceb8a59a6f64cb3e9374fc2d52c2.gif" alt="image"><br>  So, you need to write a program that will respond to keystrokes, and generate others.  In my particular case, you need to generate clicks of all four buttons - Home, End, PgUp, PgDown.  After sorting through a heap of possible combinations, discarding existing and important ones for me, I decided to dwell on the Alt + arrow combinations, namely: <br><ul><li>  Alt + Left == Home </li><li>  Alt + Right == End </li><li>  Alt + Up == Page Up </li><li>  Alt + Down == Page Down </li></ul><br><h5>  What do we use? </h5><br>  <a href="http://python.org/download/releases/2.7.2/">Python 2.7</a> - this version is fairly well supported, as I managed to make sure; <br>  <a href="http://pywin32.sourceforge.net/">Python for Windows Extentions (build 216)</a> - to use WinAPI; <br>  <a href="http://sourceforge.net/apps/mediawiki/pyhook/index.php%3Ftitle%3DMain_Page">pyHook 1.5.1</a> - a convenient wrapper for using system hooks; <br>  <a href="http://www.py2exe.org/">py2exe 0.6.9</a> (optional) - to create a standalone-executable file. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Solution idea </h4><br>  The general idea is quite simple: hang up the system hook, track clicks.  If the Alt + arrow is pressed, we generate the corresponding system message on pressing the button. <br><br><h5>  Gingerbread and rake </h5><ol><li>  There are several points that require special attention: </li><li>  The Alt key is distinguished from the others by the fact that if it is pressed, any other system message about a button being pressed will be ‚Äúsystem‚Äù.  This means that, directly from the arrow click message, we can find out if the Alt button is currently pressed or not. </li><li>  If we try to press the PgUp button while pressing the alto, nothing will happen.  Similarly, with the generation of system messages.  The solution is simple: programmatically ‚Äúrelease‚Äù Alt before generation, and then ‚Äúpush‚Äù after. </li><li>  Pressing (keystroke) each button generates two messages - pressing (key down) and releasing (key up).  It is necessary to distinguish them, otherwise for one keystroke there will be two simulations of pressing the button we need. </li><li>  The message processing function returns True or False, and depending on this, the message is either transmitted further along the chain of other system hooks or is not transmitted.  This way you can control the flow of system messages. </li></ol><br><h5>  Program code </h5><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- encoding:cp1251 -*- import pythoncom, pyHook, win32api, win32con #    def OnKeyboardEvent(event): #       ... if event.Key == 'Lmenu': # ...    ,    ... if event.MessageName[-2:] == 'up': # ...     ... win32api.keybd_event(win32con.VK_MENU, 0, win32con.KEYEVENTF_EXTENDEDKEY | win32con.KEYEVENTF_KEYUP, 0) # ...              return False #     - ,      if not(37 &lt;= event.KeyID &lt;= 40 and event.MessageName == 'key sys down'): return True #  -   #   ,  ,   ,   "" win32api.keybd_event(win32con.VK_MENU, 0, win32con.KEYEVENTF_EXTENDEDKEY | win32con.KEYEVENTF_KEYUP, 0) #     if event.KeyID == 38: win32api.keybd_event(win32con.VK_PRIOR, 0, 0, 0) elif event.KeyID == 40: win32api.keybd_event(win32con.VK_NEXT, 0, 0, 0) elif event.KeyID == 37: win32api.keybd_event(win32con.VK_HOME, 0, 0, 0) elif event.KeyID == 39: win32api.keybd_event(win32con.VK_END, 0, 0, 0) #    ""   win32api.keybd_event(win32con.VK_MENU, 0, win32con.KEYEVENTF_EXTENDEDKEY, 0) #   ,        return False #    HookManager hm = pyHook.HookManager() #      hm.KeyAll = OnKeyboardEvent #   hm.HookKeyboard() #   pythoncom.PumpMessages()</span></span></code> </pre> <br><br><h4>  Result </h4><br>  Such a program really simplified life.  True, it works far from "perfect." <br>  Firstly, the Alt button has lost the fullness of its functionality - now it will not work just to access the application menu by pressing it.  However, the same Alt + F4 works fine.  However, all the main system hotkeys are already busy, so I had to sacrifice something in any case. <br>  Secondly, the following bug was found: the Alt + Tab combination works, but when the Alt button is released, the switch window does not disappear.  So far I do not know how to fix it, I hope someone will tell. <br><br><h4>  findings </h4><br>  The global conclusion is ‚ÄúPython is cool‚Äù (remember, this is the first thing I wrote on python).  Indeed, the necessary libraries are easily installed in two clicks.  It's nice that you can easily use what has been written by others. <br><br>  The smaller conclusion concerns directly pyHook - the package is quite convenient.  Several ideas have already appeared on how to apply it: <br><ul><li>  based on the movement of the cursor, try to determine (taking, for example, 1 pixel ~ 1 mm), what distance the mouse travels (per hour, per day, for the entire observation time), its average speed, etc .; </li><li>  write the usual keyboard keyhook in the output to some log file (I have long wanted to feel like a spy :)); </li><li>  compile a frequency dictionary of his speech.  Essentially the same keyhook, only combining individual letters into words, and counting their frequency.  The idea of <s>stealing is</s> inspired by a long-standing correspondence with <a href="http://habrahabr.ru/users/skiminok/" class="user_link">Skiminok</a> - he made a similar plugin for QIP. </li></ul><br><br>  <b>UPD:</b> <a href="http://habrahabr.ru/users/lxyd/" class="user_link">lxyd</a> suggested that for all of the above, there is an AutoHotkey program.  The article came out in the style of ‚Äúhow I invented my own bicycle, which nobody needs‚Äù. </div><p>Source: <a href="https://habr.com/ru/post/136085/">https://habr.com/ru/post/136085/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136076/index.html">Another wiki project about contemporary culture</a></li>
<li><a href="../136077/index.html">Keep it simplest. Or about simple sites</a></li>
<li><a href="../136080/index.html">CES 2012 // Lenovo IdeaPad Yoga</a></li>
<li><a href="../136082/index.html">Asus Zenbook UX31 Ultrabook Review</a></li>
<li><a href="../136084/index.html">Demotivation in full, or why am I waiting for the end of the world?</a></li>
<li><a href="../136086/index.html">Ruby on Rails on Windows with performance tests</a></li>
<li><a href="../136093/index.html">What we thought about 20 years ago</a></li>
<li><a href="../136095/index.html">How to make money in IT?</a></li>
<li><a href="../136097/index.html">High-quality gps monitoring for $ 150</a></li>
<li><a href="../136098/index.html">Protecting electronics from water - a new unique coating</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>