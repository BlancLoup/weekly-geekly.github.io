<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PHP closures and passing arguments by reference</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For the sake of interest, I decided to make a mechanism for closures in PHP. I know that in PHP 5.3 there is such a mechanism, so I emphasize - purely...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PHP closures and passing arguments by reference</h1><div class="post__text post__text-html js-mediator-article">  For the sake of interest, I decided to make a mechanism for closures in PHP.  I know that in PHP 5.3 there is such a mechanism, so I emphasize - purely from academic interest.  And my curiosity gave (at least for me - someone could already deal with this) its fruits - in addition to the closures proper, I received an interesting method of passing arguments. <br><br><a name="habracut"></a>  The closure mechanism consists of the following class: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } else { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> closure { <font color="#0000ff">private</font> <font color="#0000ff">static</font> $l_closures = array(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> create($_scope, $_args, $_code) { $id = md5( <font color="#A31515">"closure::create&gt;"</font> .serialize($_scope).$_args.$_code); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $header_code = <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");'</font> ; $header_end = <font color="#A31515">'unset($scope);'</font> ; <font color="#0000ff">if</font> ($_scope) { <font color="#0000ff">foreach</font> ($_scope <font color="#0000ff">as</font> $key =&gt; $value) { <font color="#0000ff">if</font> ($key == <font color="#A31515">'scope'</font> ) { $header_end = <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } <font color="#0000ff">else</font> { $header_code .= <font color="#A31515">'$'</font> .$key. <font color="#A31515">'=&amp;$scope["'</font> .$key. <font color="#A31515">'"];'</font> ; } } } $header_code .= $header_end; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function($_args, $header_code.$_code), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> bind($_scope, $_function) { $id = md5( <font color="#A31515">"closure::bind&gt;"</font> .serialize($_scope).$_function); <font color="#0000ff">if</font> (isset(self::$l_closures[$id])) { print <font color="#A31515">"exists&lt;br&gt;"</font> ; <font color="#0000ff">return</font> self::$l_closures[$id][ <font color="#A31515">"function"</font> ]; } print <font color="#A31515">"create new&lt;br&gt;"</font> ; $closure = array( <font color="#A31515">"function"</font> =&gt; create_function( <font color="#A31515">''</font> , <font color="#A31515">'$scope=closure::scope("'</font> .$id. <font color="#A31515">'");$debug=debug_backtrace();$args=$debug[0]["args"];call_user_func_array("'</font> .$_function. <font color="#A31515">'", array_merge($scope,$args));'</font> ), <font color="#A31515">"scope"</font> =&gt; is_array($_scope) ? $_scope : array() ); self::$l_closures[$id] = $closure; <font color="#0000ff">return</font> $closure[ <font color="#A31515">"function"</font> ]; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope($_id) { <font color="#0000ff">if</font> (isset(self::$l_closures[$_id])) { <font color="#0000ff">return</font> self::$l_closures[$_id][ <font color="#A31515">"scope"</font> ]; } <font color="#0000ff">return</font> array(); } }</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      and nothing more.  This is how it looks in action: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">function</font> outer1 ($ _ arg) </li><li>  { </li><li>  $ local_var = 70; </li><li>  <font color="#0000ff">return</font> closure :: create ( </li><li>  <font color="#008000">/ * scope * /</font> array ( <font color="#A31515">'_arg'</font> =&gt; &amp; $ _ arg, <font color="#A31515">'local_var'</font> =&gt; &amp; $ local_var), </li><li>  <font color="#008000">/ * args * /</font> <font color="#A31515">'&amp; $ _ inner_arg'</font> , </li><li>  <font color="#008000">/ * code * /</font> <font color="#A31515">'print $ _arg. "". $ local_var. "". $ _ inner_arg;</font>  <font color="#A31515">$ _arg = 110;</font>  <font color="#A31515">$ _inner_arg = 120; '</font> </li><li>  ); </li><li>  } </li><li></li><li>  $ a = 50; </li><li>  $ inner1 = outer1 (&amp; $ a); </li><li>  $ inner1 = outer1 (&amp; $ a); </li><li>  $ inner1 = outer1 (&amp; $ a); </li><li>  $ ia = 90; </li><li>  $ inner1 (&amp; $ ia); </li><li>  print <font color="#A31515">""</font> . $ a.  <font color="#A31515">""</font> . $ ia.  <font color="#A31515">"&lt;br&gt;"</font> ; </li><li></li><li>  <font color="#0000ff">function</font> inner2 ($ _ arg, $ local_var, &amp; $ _ inner_arg) </li><li>  { </li><li>  print $ _arg.  <font color="#A31515">""</font> . $ local_var.  <font color="#A31515">""</font> . $ _ inner_arg;  $ _arg = 110;  $ _inner_arg = 120; </li><li>  } </li><li></li><li>  <font color="#0000ff">function</font> outer2 ($ _ arg) </li><li>  { </li><li>  $ local_var = 70; </li><li>  <font color="#0000ff">return</font> closure :: bind ( </li><li>  <font color="#008000">/ * scope * /</font> array (&amp; $ _ arg, &amp; $ local_var), </li><li>  <font color="#008000">/ * function * /</font> <font color="#A31515">'inner2'</font> </li><li>  ); </li><li>  } </li><li></li><li>  $ a = 50; </li><li>  $ inner2 = outer2 (&amp; $ a); </li><li>  $ inner2 = outer2 (&amp; $ a); </li><li>  $ inner2 = outer2 (&amp; $ a); </li><li>  $ ia = 90; </li><li>  $ inner2 (&amp; $ ia); </li><li>  print <font color="#A31515">""</font> . $ a.  <font color="#A31515">""</font> . $ ia.  <font color="#A31515">"&lt;br&gt;"</font> ; </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  The closure :: create method looks the same as create_function - only at the beginning it passes another parameter, the environment in the form of an associative array, the keys of which are the names of the variables (without the $ sign), and the values ‚Äã‚Äãcorrespond to their values. <br><br>  closure :: bind takes an environment as an array with the values ‚Äã‚Äãof variables and a function that will be closed for caching.  The function must accept environment variables at the beginning, and only then the arguments with which it will be called. <br><br>  print "create new";  and print "exists";  introduced to show that each closure is created only once. <br><br>  As long as PHP 5.3 has not settled tightly on all hosting sites, you can use this mechanism. <br><br>  Now pay attention to lines 37-39.  For clarity, I will write a separate example: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">function</font> f () </li><li>  { </li><li>  $ args = func_get_args (); </li><li>  $ args [0] = 10; </li><li>  } </li><li>  $ a = 20; </li><li>  f (&amp; $ a); </li><li>  print $ a.  <font color="#A31515">"&lt;br&gt;"</font> ; </li><li>  $ a = 20; </li><li>  call_user_func_array ( <font color="#A31515">'f'</font> , array (&amp; $ a)); </li><li>  print $ a.  <font color="#A31515">"&lt;br&gt;"</font> ; </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  At the output of the f function, the value of the $ a variable will be, as it was, 20 - the func_get_args function returns not an array of arguments, but an array <i>of</i> argument <i>values</i> , i.e.  the link disappeared and we changed the local variable. <br><br>  Now consider this example: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">function</font> f () </li><li>  { </li><li>  $ debug = debug_backtrace (); </li><li>  $ debug [0] [ <font color="#A31515">"args"</font> ] [0] = 10; </li><li>  } </li><li>  $ a = 20; </li><li>  f (&amp; $ a); </li><li>  print $ a.  <font color="#A31515">"&lt;br&gt;"</font> ; </li><li>  $ a = 20; </li><li>  call_user_func_array ( <font color="#A31515">'f'</font> , array (&amp; $ a)); </li><li>  print $ a.  <font color="#A31515">"&lt;br&gt;"</font> ; </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  An example will display 10, i.e.  what we expected!  It is <i>the arguments themselves</i> that are stored in debug_backtrace.  call_user_func_array can transfer values ‚Äã‚Äãby reference, so <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  call_user_func_array ( <font color="#A31515">'f'</font> , array (&amp; $ a)); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  will also write the value 10 in $ a. <br><br>  I fully admit that for someone it would be a warrior, but, taking into account the fact that I did not know this before and could not find anything on the Internet, it may be useful to others, so don‚Äôt be too strict. <br><br>  Thank you for attention! <br><br>  <b>UPD # 1 12/05/09</b> <br><br>  The scope method of the closure class needs to be changed as follows: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> scope ($ _ id) </li><li>  { </li><li>  $ result = array (); </li><li>  <font color="#0000ff">if</font> (isset (self :: $ l_closures [$ _ id])) </li><li>  { </li><li>  <font color="#0000ff">if</font> (self :: $ l_closures [$ _ id] [ <font color="#A31515">"scope"</font> ]) </li><li>  { </li><li>  <font color="#0000ff">foreach</font> (self :: $ l_closures [$ _ id] [ <font color="#A31515">"scope"</font> ] <font color="#0000ff">as</font> $ key =&gt; $ value) </li><li>  { </li><li>  $ result [$ key] = &amp; self :: $ l_closures [$ _ id] [ <font color="#A31515">"scope"</font> ] [$ key]; </li><li>  } </li><li>  } </li><li>  } </li><li>  <font color="#0000ff">return</font> $ result; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  When a reference to a variable remains unique, PHP for some reason converts it into the value itself, i.e.  local variables will already be transferred from the environment not by reference, but by value, which is useless.  With the same modification example <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">function</font> inner2 ($ _ arg, $ local_var, &amp; $ _ inner_arg) </li><li>  { </li><li>  $ local_var ++; </li><li>  print $ _arg.  <font color="#A31515">""</font> . $ local_var.  <font color="#A31515">""</font> . $ _ inner_arg;  $ _arg = 110;  $ _inner_arg = 120; </li><li>  } </li><li></li><li>  <font color="#0000ff">function</font> outer2 ($ _ arg) </li><li>  { </li><li>  $ local_var = 70; </li><li>  <font color="#0000ff">return</font> closure :: bind ( </li><li>  <font color="#008000">/ * scope * /</font> array (&amp; $ _ arg, &amp; $ local_var), </li><li>  <font color="#008000">/ * function * /</font> <font color="#A31515">'inner2'</font> </li><li>  ); </li><li>  } </li><li></li><li>  $ a = 50; </li><li>  $ inner2 = outer2 (&amp; $ a); </li><li>  $ inner2 = outer2 (&amp; $ a); </li><li>  $ inner2 = outer2 (&amp; $ a); </li><li>  $ ia = 90; </li><li>  $ inner2 (&amp; $ ia); </li><li>  print <font color="#A31515">""</font> . $ a.  <font color="#A31515">""</font> . $ ia.  <font color="#A31515">"&lt;br&gt;"</font> ; </li><li>  $ inner2 (&amp; $ ia); </li><li>  print <font color="#A31515">""</font> . $ a.  <font color="#A31515">""</font> . $ ia.  <font color="#A31515">"&lt;br&gt;"</font> ; </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  would print 71 and 72 for $ local_var, respectively, whereas without the specified method change, he would output 71 in both cases. <br><br>  <b>UPD # 2 12/05/09</b> <br><br>  In point 49 of the class you need to write <b>return call_user_func_array.</b> </div><p>Source: <a href="https://habr.com/ru/post/77282/">https://habr.com/ru/post/77282/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../77275/index.html">C #: Etudes, part 4</a></li>
<li><a href="../77277/index.html">Cleaning the RAM</a></li>
<li><a href="../77278/index.html">"The Big Bang Theory" in the Russian town of nuclear scientists</a></li>
<li><a href="../77279/index.html">Mechanical cellphone</a></li>
<li><a href="../77281/index.html">How to deal with perfectionism?</a></li>
<li><a href="../77284/index.html">Record SSD - Micron RealSSD C300</a></li>
<li><a href="../77285/index.html">Taiwanese player went through WoW to the end</a></li>
<li><a href="../77287/index.html">Free access to the St. Petersburg guide</a></li>
<li><a href="../77291/index.html">Ni ** no or Russian translation secrets facebook</a></li>
<li><a href="../77292/index.html">Your opinions and suggestions for increasing sales of webinars</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>