<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>XLS Templates in Oracle BI Publisher (XML Publisher)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, in this article I want to talk about my experience with BI Publisher and drawing up templates for MS Excel in the native * .xls format for t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>XLS Templates in Oracle BI Publisher (XML Publisher)</h1><div class="post__text post__text-html js-mediator-article">  Good day, in this article I want to talk about my experience with BI Publisher and drawing up templates for MS Excel in the native * .xls format for this program. <br><br><h4>  Small preface </h4><br><br>  Working with Oracle eBS, from time to time it becomes necessary to create additional reports (and, accordingly, templates in BI Publisher).  In this case, there was a rather complicated report, which was collected from tables filled with data in the BEFORE REPORT trigger of the same report.  The number of columns in the report could change dynamics. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The template was originally made in RTF format.  For each number of columns was provided for its own version of the report.  At the output we had to get the XLS file with the data we wanted. <br><br><img src="https://habrastorage.org/storage2/2f0/26e/9a4/2f026e9a4421e550d6697d8b41fa51e5.png"><br><br><h4>  Problems encountered </h4><br><br>  When the output file is an XLS file, we may encounter the following problems, or to be more precise, restrictions: <br><br>  1) We want the Excel output file to look exactly like that, because we need the right columns to be right where we need, and not go somewhere. <br>  2) So that data types are transferred to Excel output, that is, that numbers have a numeric data type in Excel, dates have a date type, and so on ... <br>  3) When transmitting data that starts with ‚Äú0‚Äù (leading zeroes), leading zeros are truncated, that is, we need to preserve the integrity of the data. <br>  4) The same problem appears when transferring data with zeros after the decimal point (fractional part). <br><br>  If 3 and 4 problems can be solved by adding two spaces or special characters to the beginning / end of the attribute, then the rest is a bit more complicated. <br><br>  In my case, I had to transfer the value ‚Äú0000‚Äù to Excel without losing a single zero and not allowing any other characters in the cell. <br><br>  More information about other limitations of Excel output files created using RTF templates can be found <a href="https://blogs.oracle.com/xmlpublisher/entry/excel_limitations">here.</a> <br><br><h4>  Insight </h4> <br><br>  As a result of a long search on the Internet, a mention of Real Excel Template was found in the Oracle <a href="https://blogs.oracle.com/xmlpublisher/entry/excel_template_teaser">blog</a> . <br><br>  That is, you can now create templates <s>without leaving the cash register</s> without leaving MS Excel.  To do this, we need to create a standard * .XLS file and start to wake our wonder pattern in it. <br><br>  First, a little about the differences between RTF and XLS templates. <br><br>  1) In the RTF for the designation of elements, we had to put the tag <code>&lt;?ELEMENT_NAME?&gt;</code> , And in XLS we must write in the properties of the cell, where we will have the element tag <code>XDO_?ELEMENT_NAME?</code>  .  Example: <br><br><img src="https://habrastorage.org/storage2/ca2/d14/eb4/ca2d14eb4238816314925407f294a0a6.png"><br><br>  2) In the RTF to indicate the opening of groups, we had to put the tag <code>&lt;? for-each: GROUP_NAME?&gt;</code>  <code>&lt;? for-each: GROUP_NAME?&gt;</code> and to close the groups we had to put the <code>&lt;?end for-each?&gt;</code> , and in XLS we need to select the cells that will be filled with data from our group and set them as the <code>XDO_GROUP_?GROUP_NAME?</code>  .  It looks like this: <br><br><img src="https://habrastorage.org/storage2/9d9/f1a/81c/9d9f1a81cb9d16588b3fb61a3282b2e0.png"><br><br>  3) Be careful with what you write in the cell itself, since you can specify the type of data that will be in the cell using normal Excel functionality, and what is written in the cell should correspond to this type.  The only thing that didn‚Äôt work out for me was to get a date at the output as a date, I had to write a small macro for this.  Oh yes, now we can complement our template patterns with macros, which was not possible in RTF templates for Excel. <br><br>  4) There must be a separate tab XDO_METADATA: <br><br><img src="https://habrastorage.org/storage2/d05/d95/81a/d05d9581a06d56f3252d598a832b77ec.png"><br><br>  Everything that is written before ‚ÄúData Constraints:‚Äù including the change is not necessary and it should be present in all XLS templates.  That below is your function.  XSL is supported, I do not know about the rest.  If an element is outside groups, then it needs to be obtained via <code>xsl:value-of select</code> .  All items in this tab should be accessed via .//ELEMENT_NAME. <br><br><h4>  Afterword </h4><br><br>  When using the XLS template, I no longer needed to create a separate version of the table for each column number.  It is enough to make a table for the maximum number of columns.  Columns in which data will be present will be filled in automatically, in which data will not be and will remain empty.  This avoids unnecessary work. <br><br>  Additional information on the possibilities of creating such templates can be found at this <a href="http://docs.oracle.com/cd/E10415_01/doc/bi.1013/e14667/create_excel_tmpl.htm">link</a> . <br><br>  I hope this helps someone to avoid unnecessary trouble with drawing up templates. </div><p>Source: <a href="https://habr.com/ru/post/148041/">https://habr.com/ru/post/148041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148031/index.html">Switchvox Home - IP PBX for very small businesses</a></li>
<li><a href="../148034/index.html">Even in the prisons of Silicon Valley, there are incubators startups</a></li>
<li><a href="../148037/index.html">Can your programming language do this?</a></li>
<li><a href="../148038/index.html">Do you have access to social networks and instant messengers at work?</a></li>
<li><a href="../148040/index.html">Steve Wozniak showed the contents of his backpack</a></li>
<li><a href="../148043/index.html">How the team maps.nokia.com launched the Nokia 808 PureView over Berlin</a></li>
<li><a href="../148044/index.html">Where are the brakes in ORM?</a></li>
<li><a href="../148045/index.html">Direct PCB printing on PCB</a></li>
<li><a href="../148046/index.html">Group resistance</a></li>
<li><a href="../148047/index.html">Marketing by Sharing (translation and subtitles for Jason Fried speech)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>