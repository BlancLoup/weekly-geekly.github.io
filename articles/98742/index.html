<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Combining multiple sections into one without losing information</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Task 
 It is necessary to combine several existing sections into one without losing information. This can happen if LVM was not involved in advance, b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Combining multiple sections into one without losing information</h1><div class="post__text post__text-html js-mediator-article"><h2>  Task </h2><br>  It is necessary to combine several existing sections into one without losing information.  This can happen if LVM was not involved in advance, but it is necessary to expand the space, for example, for torrents. <br><a name="habracut"></a><br><h2>  Solutions </h2><br>  There are at least two solutions. <br><br><h3>  aufs2 </h3><br>  <a title="Aufs2 project home page" href="http://aufs.sourceforge.net/">aufs2</a> is a file system that implements cascade-joint mount for Linux file systems.  In addition to the inherited functionality from UnionFS, RW branches and record balancing are implemented here, which is ideal for solving the set task. <br><br>  It should be noted that aufs2 is not included in the mainline core.  But it is: <br><ul><li>  in Debian Lenny ( <em>unfortunately, not in Testing and Sid</em> ); </li><li>  in Ubuntu ( <em>since the LiveCD of Ubuntu is built using this FS</em> ); </li><li>  in <a title="Zen-kernel project home page" href="http://zen-kernel.org/">Zen-kernel</a> and <a title="Liquorix Project Home Page" href="http://liquorix.net/">Liquorix</a> . </li></ul><br>  You can also patch and assemble the kernel yourself using <a href="http://git.c3sl.ufpr.br/gitweb%3Fp%3Daufs/aufs2-standalone.git%3Ba%3Dsummary">standalone-version of</a> aufs2.  For debianov recommend, if you do not want to mess with the compilation of the kernel, use the ready-made Liquorix packages, connecting the repository as indicated on <a title="Liquorix Project Home Page" href="http://liquorix.net/">the project page</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you have dealt with the kernel, then you need to take care of userspace utilities.  In Debian, there are ready-made packages ( <em>despite the lack of support from the kernel</em> ), so you can put them in one command: <br><br> <code>sudo aptitude install aufs-tools</code> <br> <br>  If there are no ready-made packages in the distribution, you can take them from the <a title="aufs-utils" href="http://git.c3sl.ufpr.br/gitweb%3Fp%3Daufs/aufs2-util.git%3Ba%3Dsummary">official website of aufs</a> . <br><br>  Now to the point.  Suppose there are two mounted partitions: <br><ul><li>  old with a bunch of torrents: / media / torrents; </li><li>  and a new one on a newly purchased hard drive: / media / new_storage. </li></ul><br>  In order for these two sections to be visible as one, the following command must be executed: <br><br> <code>sudo mount -t aufs none /media/storage -o br:/media/torrents=rw:/media/new_storage=rw,create=mfs,sum</code> <br> <br>  Here: <br><ul><li>  br: branch1 = rw: branch2 = rw: ... - the list of so-called.  branches, i.e. mounted partitions that will be merged into one; </li><li>  create = mfs is the main parameter indicating that the branch that has more free space will be selected for recording.  Without this parameter, the ‚Äúpuff‚Äù from the sections will not work as intended; </li><li>  sum indicates that the utilities of type df or pydf will display the total size of the partitions and free space for them for the combined partition. </li></ul><br>  In / etc / fstab, this entry should look like: <br><br> <code>none /media/storage aufs br:/media/torrents=rw:/media/new_storage=rw,create=mfs,sum 0 0</code> <br> <br><h3>  mhddfs </h3><br>  Unlike aufs, mhddfs is a user-space file system that works through fuse.  In Debian, there is a ready-made package, which is installed by the command: <br><br> <code>sudo aptitude install mhddfs</code> <br> <br>  Mounting is done by the command: <br><br> <code>sudo mhddfs /media/torrents,/media/new_storage /media/storage -o default_permissions,allow_other</code> <br> <br>  In / etc / fstab, the corresponding entry is: <br><br> <code>mhddfs#/media/torrents,/media/new_storage /media/storage fuse default_permissions,allow_other 0 0</code> <br> <br>  It is worth noting that neither aufs2 nor mhddfs allow one file is partially on one, partly on another section.  Also note that after unmounting the puff, all files will be accessed through the original mount points.  Some files will be on one partition, some - on the other. <br><br><h3>  findings </h3><br><br>  If a quick and easy solution is needed, mhddfs will suffice for most users.  But it is worth remembering that aufs2 works at the kernel level, so the performance in this case is higher.  In addition, mhddfs loads the processor to a much greater degree, and the write / read speed is slightly lower than in aufs2. <br><br>  Thanks for attention.  Comments, comments and suggestions are welcome. </div><p>Source: <a href="https://habr.com/ru/post/98742/">https://habr.com/ru/post/98742/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../98733/index.html">4K video on YouTube</a></li>
<li><a href="../98735/index.html">Skype + Python = Skype4Py</a></li>
<li><a href="../98736/index.html">Useful Add-ons for Mozilla Firefox</a></li>
<li><a href="../98737/index.html">Overview cooling pad for laptop ZALMAN ZM-NC1500</a></li>
<li><a href="../98740/index.html">The idea is only a multiplier when implementing</a></li>
<li><a href="../98743/index.html">Simple overlay of 2 images</a></li>
<li><a href="../98745/index.html">JCUKEN phonetic keyboard layout</a></li>
<li><a href="../98747/index.html">Short links in Google Maps</a></li>
<li><a href="../98751/index.html">Using ActiveRecord without Rails</a></li>
<li><a href="../98752/index.html">Filter the bazaar: write a simple and functional data filter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>