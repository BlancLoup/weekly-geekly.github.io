<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Visual Search provider for IE 8 - a task for two tomatoes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Visual Search provider is one of three new types of extensions in IE 8.0. It will allow users to search for something on your site without going t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Visual Search provider for IE 8 - a task for two tomatoes</h1><div class="post__text post__text-html js-mediator-article">  The Visual Search provider is one of three new types of extensions in IE 8.0. It will allow users to search for something on your site without going to its pages.  And if you add a favicon to the provider, your brand (or rather, a 16 pixel brand) will always be with the user.  And most importantly, it will allow you to dilute the dry text of the search results with cute pictures, like this: <br><br> <a href="http://play2game.ru/" title="Mini games on Play2Game.ru"><img src="http://developernotes.net/img/art/play2game.png" alt="Mini games on Play2Game.ru"><br></a> <br>  And also, you can tell about your provider by uploading it to the <a href="http://www.ieaddons.com/ru/popular">gallery of extensions IE 8.0</a> .  Or win a plasma TV by participating in the <a href="http://remix.ru/ie8">competition for additions to IE 8.0</a> , which is held as part of the ReMIX09 conference. <br><br><img src="http://developernotes.net/img/art/tv.jpg" alt="The main prize of the competition additions to IE 8.0"><br>  By the way, now there are only 3 visual providers registered there.  So if you have something to look for, and even better - a website with the right audience ready to support it in the competition - let's try? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All you really need is a method that will return the data found on the request.  How it will look depends on your favorite technology and site size.  In my case (a <a href="http://play2game.ru/">mini-games site</a> that I wrote on .NET) it was a simple string comparison in a LINQ query.  Someone will set up full text search in MS SQL Server more seriously, but PHP and MySQL followers will probably choose something effective in their arsenal. <br><br>  If we have such a method, the rest is a task for two tomatoes <a title="ref1" href="https://habr.com/ru/post/57222/"><sup>1</sup></a> , which we will do once or two or three.  Moreover, unlike <a href="http://developernotes.net/post/web-slices-ie-8-scrolling.aspx">web slices</a> , a simple solution will be good at the same time, without any reservations and nuances. <br><br>  So, in the best traditions of culinary programs, for successful preparation of the provider we will need: <a name="habracut"></a><br><ul><li>  Website with pictures and text that we can look for - 1 pc </li><li>  The method that will accept the input string entered by the user in the search string and returns a little text and pictures to us - 1 pc. </li><li>  The module that the browser will access to get the results in xml format - 1 pc </li><li>  A little more xml to describe our provider </li><li>  And to complete - a pinch of html to tell browsers what a wonderful provider we have prepared </li></ul>  Well, the products are ready, the water is boiling - we start ... <br><br>  First, let's work on the basis of our dish - the search method, which in fact will do all the real work.  As we agreed, its implementation is entirely on you.  It does not matter how it will be done, the main thing is that it: <br><br><img src="http://developernotes.net/img/art/search-string.png" alt="Play2Game.com search"><br><ol><li>  Accepted as input text that the user typed in the search bar: <br>  And remember, the browser will access your site after each entered letter, so it‚Äôs better to search faster. </li><li>  For each item found returned: <ul><li>  Headline </li><li>  Short description </li><li>  URL of the page to which we will get by selecting this item when searching </li><li>  Image URL </li></ul>  In principle, it suffices to return only the title or url.  But, if we want to get a beautiful result, we need all the elements. </li></ol> We turn to the second part: the module of your site, which will call the browser to get xml with search options.  You can set the call format yourself, the browser will add to it several parameters describing the request.  Only one is required for us, in which the search string will be passed.  The request might look something like this: <br><br> <code>http://{  }/search.aspx?q={searchTerms} <br></code> <br>  A module can be implemented in different ways, for example, as IHttpModule or WebService.  I preferred the simplest option - the usual .aspx page: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font>&lt;%@ Page Language="C#" CodeBehind="visual.aspx.cs" Inherits="Play2game.VisualProvider" %&gt;</font> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SearchSuggestion</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/Search/2008/suggestions"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Query</font> <font color="#0000ff">&gt;&lt;</font> <font color="#800000">asp:Literal</font> <font color="#ff0000">ID</font> <font color="#0000ff">="ltKeyword"</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <font color="#0000ff">/&gt;&lt;/</font> <font color="#800000">Query</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Section</font> <font color="#ff0000">title</font> <font color="#0000ff">=" Play2Game.ru"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">asp:Literal</font> <font color="#ff0000">ID</font> <font color="#0000ff">="ltItems"</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Section</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">SearchSuggestion</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  This is the xml that will need to be returned to the browser.  It contains two placeholders (as the simplest Literal controls from ASP.NET).  Instead of the first one, we need to insert the string that the user was looking for.  The browser will check it and display the results only if this string matches the string that it passed to you in the query. <br><br>  Instead of the second placeholder, we will substitute xml with descriptions of the elements found.  Before you deal with him, pay attention to two things: <br><ol><li>  The string &lt;? Xml version = "1.0"?&gt; Is on the same line as the page declaration is not accidental.  If you write it from a new line (as I did, because I hate crookedly formatted text), the resulting xml will begin with a carriage return character and it will not be recognized by the browser (and you will see the error message, which means ‚Äúyou have problems, try to change something in your code and try again "). <br></li><li>  In the Section tag, we passed the title title, which will be displayed at the very top, along with the gray line - the separator.  If we didn‚Äôt do this, IE formed it itself as ‚Äú{your provider‚Äôs name} of options‚Äù, which may look rather crooked. </li></ol>  Now go to the xml format with the results themselves (which will be inserted in place of the second placeholder).  It is quite simple: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font>&lt;!--   --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> ,    <font color="#0000ff">&lt;/</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> <br> <font>&lt;!--   --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font>   ,   . <font color="#0000ff">&lt;/</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> <br> <font>&lt;!-- Url,    ,    --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> /something.html <font color="#0000ff">&lt;/</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> <br> <font>&lt;!-- Url  --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Image</font> <font color="#ff0000">source</font> <font color="#0000ff">="/something.gif"</font> <font color="#ff0000">alt</font> <font color="#0000ff">=",   "</font> <font color="#ff0000">width</font> <font color="#0000ff">="45"</font> <font color="#ff0000">height</font> <font color="#0000ff">="45"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> ... <br> <font color="#0000ff">&lt;</font> <font color="#800000">Separator</font> <font color="#ff0000">title</font> <font color="#0000ff">="     "</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> ... <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Here, too, should pay attention to two points.  The first is the size of the picture.  If you specify them, everything will work fine.  But if your images are slightly different in size - this can be a problem.  If in the usual html tag img specify only one dimension of the two - your image will be proportionally scaled.  Here, such a focus will not work - the pictures simply cease to be displayed (when I tried not to specify the size at all, the images were normally displayed at the first request after connecting the provider, and then they all disappeared).  So you have to figure out how to correctly calculate the dimensions. <br><br>  In this case, I was lucky - all the icons were the same size 44 by 44. At another time it was worse, the pictures were different and if you specify something like 45x45, everything was scaled to this square and ruthlessly distorted.  In the end, I added a method that found a physical file, determined its size and correctly entered the width and height attributes.  Contrary to fears, it worked quite quickly - thanks to the second point, which we will talk about now. <br><br><img src="http://developernotes.net/img/art/visual-search-results.png" alt="Search for games on Play2Game.com"><br><br>  The fact is that the size of the list is limited - no more than 10 elements will be displayed in it (therefore, it was easy enough to check the sizes of a maximum of 10 files).  These elements can be separated by ‚Äúseparators‚Äù - the &lt;Separator title = tag ‚ÄúAnother list I don‚Äôt know what‚Äù /&gt; in our xml.  However, separators also occupy one of 10 places.  So you will need to decide whether to display separators in order to nicely group the found items or display more search results. <br><br>  I created the Xml with the results using a simple ASP.NET StringBuilder and inserting a placeholder in place.  If you are a supporter of difficult, but correct decisions, be sure to read the post " <a href="http://blogs.microsoft.co.il/blogs/bursteg/archive/2008/12/17/building-an-ie8-visual-search-suggestion-provider-for-my-twitter-friends.aspx">Building an IE8 Visual Friends Provider for my Twitter Friends</a> " in which Guy Burstein tells how to create such a module correctly using WCF REST service and XML serialization. <br><br>  Almost everything is ready, there are two little things left.  The first is to create an xml file with the description of our provider: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">OpenSearchDescription</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://a9.com/-/spec/opensearch/1.1/"</font> <font color="#ff0000">xmlns:ie</font> <font color="#0000ff">="http://schemas.microsoft.com/Search/2008/"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ShortName</font> <font color="#0000ff">&gt;</font> {  } <font color="#0000ff">&lt;/</font> <font color="#800000">ShortName</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Image</font> <font color="#ff0000">height</font> <font color="#0000ff">="16"</font> <font color="#ff0000">width</font> <font color="#0000ff">="16"</font> <font color="#ff0000">type</font> <font color="#0000ff">="image/icon"</font> <font color="#0000ff">&gt;</font> http://{  }/favicon.ico <font color="#0000ff">&lt;/</font> <font color="#800000">Image</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Url</font> <font color="#ff0000">type</font> <font color="#0000ff">="text/html"</font> <font color="#ff0000">template</font> <font color="#0000ff">="http://{  }/search-page.aspx?q={searchTerms}"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Url</font> <font color="#ff0000">type</font> <font color="#0000ff">="application/x-suggestions+xml"</font> <font color="#ff0000">template</font> <font color="#0000ff">="http://{  }/search.aspx?q={searchTerms}"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">OpenSearchDescription</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  What you should pay attention here: <br><ol><li>  The &lt;Url type = ‚Äútext / html‚Äù tag specifies the url to be called if the user simply presses input in the search bar and never selects any of the options in the proposed list.  Url you can specify arbitrary, as long as it includes placeholder {searchTerms}, the location of which the browser will insert the string entered by the user. <br>  If your site has already implemented a search - send this url there.  If not, trust it to your favorite search engine, like this: <br><br> <code>&lt;Url type="text/html" template="http://www.google.com/search?q={searchTerms}"/&gt;</code> <br> <br></li><li>  The &lt;Url type = "application / x-suggestions + xml" tag defines the url of our module, which should return xml with the results.  The conditions are the same: an arbitrary url with the obligatory placeholder {searchTerms}, instead of which the browser will substitute a string for the search.  In addition, you can use a few more placeholders and then the browser will give you a little more useful information.  For example, a query of the form: <br><br> <code>&lt;Url type="text/html" template="http://www.google.com/search?q={searchTerms}&amp;language={Language}"/&gt;</code> <br> <br>  let you know the user's system language locale.  You can learn more about the additional parameters from the documentation, a link to which is given at the end of the article.  There is nothing particularly useful, almost everything comes down to determining the size of the drop-down list with the results in order to better calculate the size of pictures and text. </li></ol>  The final touch of the artist - add html tag with a description of the provider in the head of our site.  It looks like this: <br><br> <code>&lt;link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="  " /&gt;</code> <br> <br><img src="http://developernotes.net/img/art/add-visual-provider.png" alt="Add search provider"><br><br>  Having found it on our website, IE will turn orange with impatience and promptly add it to the extensions already registered in it. <br><br>  Please note that the value of the ‚ÄúTitle‚Äù attribute must exactly match the same name in the ‚ÄúShortName‚Äù tag of the provider's description.  If these lines are different, the browser will not believe that this provider has already added and will offer to add it again. <br><br>  Well, I ask to the table, it has boiled! <br><br>  Another tip that can simplify your life.  The browser caches the resulting xml, so constantly change the words entered during testing.  For a while I was sitting under the debugger and unsuccessfully trying to understand why my module was not called when I typed the classic ‚Äúsdfsdf‚Äù (more options ‚ÄúYukuken‚Äù or ‚Äúqwerty‚Äù). <br><br>  And if you want to understand all the details, take a look at the main Microsoft cookbook: <a href="http://msdn.microsoft.com/en-us/library/cc848862(VS.85).aspx">Search Provider Extensibility in Internet Explorer</a> and the <a href="http://msdn.microsoft.com/en-us/library/cc848863(VS.85).aspx">XML Search Suggestions Format Specification</a> , as well as read the article by Sebastian Zimmerman (the main developer of the Visual Search function) <a href="http://www.thevista.ru/page.php%3Fid%3D10345">Hello, World or start working with IE8 Visual Search</a> and a slightly more detailed edition of the article on <a href="http://developernotes.net/post/visual-search-provider-ie8.aspx">creating a Visual Search provider</a> for IE 8.0 in my blog " <a href="http://developernotes.net/">.NET: Notes programmer</a> ." <br><br>  Enjoy your cooking and winning the competition! <br><br> <code><sup><strong>1</strong></sup>  XP      ,     .   -    ,            .        ¬´   ¬ª.</code> </div><p>Source: <a href="https://habr.com/ru/post/57222/">https://habr.com/ru/post/57222/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../57213/index.html">Layfkhak for the system administrator when "ping ya.ru" does not work</a></li>
<li><a href="../57216/index.html">Registration is now open for the 5th free startup seminar</a></li>
<li><a href="../57217/index.html">Come to the Russian final of the Imagine Cup 2009 competition and win a smartphone!</a></li>
<li><a href="../57220/index.html">About the right approach to choosing an engine for an online store</a></li>
<li><a href="../57221/index.html">Takete and Maluma. Practical use of the phenomenon</a></li>
<li><a href="../57223/index.html">Steve Ballmer</a></li>
<li><a href="../57225/index.html">Dia (in) logs from bloggingheads .tv</a></li>
<li><a href="../57226/index.html">InnoDB transactions</a></li>
<li><a href="../57227/index.html">Anticrisis proposal for coworking</a></li>
<li><a href="../57228/index.html">6 must-have Linux distributions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>