<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fighting Tastypie API performance</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As I dragged the Tastypie package onto the Pony ORM and what came of it. 

 This article continues the story of my struggle for application performanc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fighting Tastypie API performance</h1><div class="post__text post__text-html js-mediator-article">  As I dragged the Tastypie package onto the Pony ORM and what came of it. <br><br>  This article continues the story of my struggle for application performance in python and django. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Summary of the previous series: <br>  - <a href="http://habrahabr.ru/post/148044/">ORMs slow down</a> , and very much - 3-5 times or more <br>  - <a href="http://habrahabr.ru/post/149066/">But the slapstick</a> for Django ORM <br>  - <a href="http://habrahabr.ru/post/188842/">Wow, this ORM almost does not slow down</a> and caches all that is possible. <br>  - <a href="http://habrahabr.ru/post/197962/">This is how you can fasten a</a> high-performance Pony ORM to the Django project and use it in key places <br><br><h4>  Introduction </h4><br><br>  Having obtained quite satisfactory (compared to Django ORM) results on the speed of accessing the DBMS using the Pony ORM, I began to think about how to use them in practice.  To begin with, I did a <a href="http://habrahabr.ru/post/197962/">mapping of the Django data model to the Pony data model</a> .  Now, the finished data model can be used in the project. <br><br>  Where code is written from scratch, using Pony instead of Django was not easy, but very simple: the `p` attribute of all Django models now points to the Pony model.  However - what to do with those ready-made packages that already use Django ORM? <br><br>  Unfortunately, the answer is one: rewrite or append, since the syntax and semantics of accessing models and collections in Pony ORM is completely different from Django ORM - so much so that to mask the appeal to Pony ORM under appeal to Django ORM is not yet possible.  In addition, I strongly suspect that such a disguise, when performed, will kill all the advantages of using the Pony ORM due to losses on the intermediate layer.  Still, python is an interpreter, and for example, losses on a function call are large enough to be noticeable even against the background of accessing the DBMS.  These losses, among others, are likely to kill the performance of Django ORM and SQLAlchemy. <br><br>  We plan to transfer the entire interface (or most of it) of our application to the client side, using the server as a data provider via the HTTP API.  Thus, the key element is the API that we implement using the <a href="http://django-tastypie.readthedocs.org/en/latest/">Tastypie package</a> , so that increasing its performance should directly affect the performance of the application interface and reduce the overall load on the site. <br><br>  And I <a href="https://github.com/nnseva/tastypie_djony">took up the Tastypie</a> . <br><br><h4>  How did the Tastypie structure help me? </h4><br><br>  The Tastypie library, although it relies on Django, has a data source abstraction layer (Resource), independent of Django ORM.  Only the next heir, ModelResource, uses Django ORM-specific data calls.  Thus, as I assumed at the beginning, I only needed to inherit from the Resource and implement a functional similar to the ModelResource. <br><br>  In practice, I also had to make a class parallel to ToManyField, because, to my disappointment, the latter turned out to be several lines oriented specifically to Django ORM.  I called my class SetField, since it is the Set class that is used in Pony ORM to denote a one-to-many relationship. <br><br><h4>  What happened </h4><br><br>  Everything turned out just fine.  As a sample, I used the data model from django.contrib.auth, filling it in approximately 1000 users.  I assigned one of the users 159 rights to various types of data in the system (we have accumulated a lot of them - data types) and requested this user along with his rights through the API, using this call as a model. <br><br>  Here's what the data source definition for the old API v2, which used Django ORM, looked like (note that authentication and authorization are excluded - for correct measurement of performance). <br><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PermissionResource</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ModelResource)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Meta</span></span></span><span class="hljs-class">:</span></span> queryset = auth_models.Permission.objects.all() object_model = queryset.model filtering = dict([(n,ALL_WITH_RELATIONS) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> object_model._meta.get_all_field_names()]) resource_name = <span class="hljs-string"><span class="hljs-string">'auth/permission'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserResource</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ModelResource)</span></span></span><span class="hljs-class">:</span></span> user_permissions = ToManyField(PermissionResource,<span class="hljs-string"><span class="hljs-string">'user_permissions'</span></span>,related_name=<span class="hljs-string"><span class="hljs-string">'user_set'</span></span>,null=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Meta</span></span></span><span class="hljs-class">:</span></span> queryset = auth_models.User.objects.all() object_model = queryset.model filtering = dict([(n,ALL_WITH_RELATIONS) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> object_model._meta.get_all_field_names()]) resource_name = <span class="hljs-string"><span class="hljs-string">'auth/user'</span></span></code> </pre> <br><br>  Well, this is how the definition for the new v3 API looks, based on the use of the Pony ORM together with the Djony package: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PermissionResource</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(DjonyResource)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Meta</span></span></span><span class="hljs-class">:</span></span> object_model = auth_models.Permission filtering = dict([(n,ALL_WITH_RELATIONS) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> object_model._meta.get_all_field_names()]) resource_name = <span class="hljs-string"><span class="hljs-string">'auth/permission'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserResource</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(DjonyResource)</span></span></span><span class="hljs-class">:</span></span> user_permissions = SetField(PermissionResource,<span class="hljs-string"><span class="hljs-string">'user_permissions'</span></span>,related_name=<span class="hljs-string"><span class="hljs-string">'user_set'</span></span>,null=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Meta</span></span></span><span class="hljs-class">:</span></span> object_model = auth_models.User filtering = dict([(n,ALL_WITH_RELATIONS) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> object_model._meta.get_all_field_names()]) resource_name = <span class="hljs-string"><span class="hljs-string">'auth/user'</span></span></code> </pre><br><br>  Please note that the metadata definition uses the Django model and not the Pony.  This is due to the fact that the Pony model does not contain many of the attributes specific to Django ORM, but not needed to define the actual data structure, such as help_text, for example.  The question of the placement of such metadata is actually important, but its discussion is probably beyond the scope of this article. <br><br>  The server was deployed on my modest work computer with 2 2.2 GHz cores and 3 GB of RAM.  The test client started from the same computer.  As the last, the ab (Apache Benchmark) package was launched: <br><br><pre> <code class="hljs vhdl">seva@SEVA (<span class="hljs-number"><span class="hljs-number">2</span></span>):~/djony$ ab -n <span class="hljs-number"><span class="hljs-number">100</span></span> -c <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-string"><span class="hljs-string">"http://localhost:8080/api/v2/auth/user/3/?format=json"</span></span> This <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> ApacheBench, Version <span class="hljs-number"><span class="hljs-number">2.3</span></span> &lt;$Revision: <span class="hljs-number"><span class="hljs-number">655654</span></span> $&gt; Copyright <span class="hljs-number"><span class="hljs-number">1996</span></span> Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> The Apache Software Foundation, http://www.apache.org/ Benchmarking localhost (be patient).....done Server Software: nginx/<span class="hljs-number"><span class="hljs-number">1.1</span></span>.<span class="hljs-number"><span class="hljs-number">19</span></span> Server Hostname: localhost Server <span class="hljs-keyword"><span class="hljs-keyword">Port</span></span>: <span class="hljs-number"><span class="hljs-number">8080</span></span> Document Path: /api/v2/auth/user/<span class="hljs-number"><span class="hljs-number">3</span></span>/?format=json Document Length: <span class="hljs-number"><span class="hljs-number">5467</span></span> bytes Concurrency Level: <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> taken <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tests: <span class="hljs-number"><span class="hljs-number">17.331</span></span> seconds Complete requests: <span class="hljs-number"><span class="hljs-number">100</span></span> Failed requests: <span class="hljs-number"><span class="hljs-number">0</span></span> Write errors: <span class="hljs-number"><span class="hljs-number">0</span></span> Total transferred: <span class="hljs-number"><span class="hljs-number">582900</span></span> bytes HTML transferred: <span class="hljs-number"><span class="hljs-number">546700</span></span> bytes Requests per second: <span class="hljs-number"><span class="hljs-number">5.77</span></span> [#/sec] (mean) <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> per request: <span class="hljs-number"><span class="hljs-number">693.256</span></span> [ms] (mean) <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> per request: <span class="hljs-number"><span class="hljs-number">173.314</span></span> [ms] (mean, across <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> concurrent requests) Transfer rate: <span class="hljs-number"><span class="hljs-number">32.84</span></span> [Kbytes/sec] received Connection Times (ms) min mean[+/-sd] median max Connect: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1.5</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> Processing: <span class="hljs-number"><span class="hljs-number">313</span></span> <span class="hljs-number"><span class="hljs-number">685</span></span> <span class="hljs-number"><span class="hljs-number">486.1</span></span> <span class="hljs-number"><span class="hljs-number">575</span></span> <span class="hljs-number"><span class="hljs-number">3357</span></span> Waiting: <span class="hljs-number"><span class="hljs-number">312</span></span> <span class="hljs-number"><span class="hljs-number">684</span></span> <span class="hljs-number"><span class="hljs-number">485.8</span></span> <span class="hljs-number"><span class="hljs-number">574</span></span> <span class="hljs-number"><span class="hljs-number">3355</span></span> Total: <span class="hljs-number"><span class="hljs-number">313</span></span> <span class="hljs-number"><span class="hljs-number">685</span></span> <span class="hljs-number"><span class="hljs-number">486.7</span></span> <span class="hljs-number"><span class="hljs-number">575</span></span> <span class="hljs-number"><span class="hljs-number">3357</span></span> Percentage <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the requests served within a certain <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> (ms) <span class="hljs-number"><span class="hljs-number">50</span></span>% <span class="hljs-number"><span class="hljs-number">575</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span>% <span class="hljs-number"><span class="hljs-number">618</span></span> <span class="hljs-number"><span class="hljs-number">75</span></span>% <span class="hljs-number"><span class="hljs-number">647</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span>% <span class="hljs-number"><span class="hljs-number">670</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span>% <span class="hljs-number"><span class="hljs-number">819</span></span> <span class="hljs-number"><span class="hljs-number">95</span></span>% <span class="hljs-number"><span class="hljs-number">1320</span></span> <span class="hljs-number"><span class="hljs-number">98</span></span>% <span class="hljs-number"><span class="hljs-number">2797</span></span> <span class="hljs-number"><span class="hljs-number">99</span></span>% <span class="hljs-number"><span class="hljs-number">3357</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>% <span class="hljs-number"><span class="hljs-number">3357</span></span> (longest request) seva@SEVA (<span class="hljs-number"><span class="hljs-number">2</span></span>):~/djony$ ab -n <span class="hljs-number"><span class="hljs-number">100</span></span> -c <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-string"><span class="hljs-string">"http://localhost:8080/api/v3/auth/user/3/?format=json"</span></span> This <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> ApacheBench, Version <span class="hljs-number"><span class="hljs-number">2.3</span></span> &lt;$Revision: <span class="hljs-number"><span class="hljs-number">655654</span></span> $&gt; Copyright <span class="hljs-number"><span class="hljs-number">1996</span></span> Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> The Apache Software Foundation, http://www.apache.org/ Benchmarking localhost (be patient).....done Server Software: nginx/<span class="hljs-number"><span class="hljs-number">1.1</span></span>.<span class="hljs-number"><span class="hljs-number">19</span></span> Server Hostname: localhost Server <span class="hljs-keyword"><span class="hljs-keyword">Port</span></span>: <span class="hljs-number"><span class="hljs-number">8080</span></span> Document Path: /api/v3/auth/user/<span class="hljs-number"><span class="hljs-number">3</span></span>/?format=json Document Length: <span class="hljs-number"><span class="hljs-number">5467</span></span> bytes Concurrency Level: <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> taken <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tests: <span class="hljs-number"><span class="hljs-number">8.339</span></span> seconds Complete requests: <span class="hljs-number"><span class="hljs-number">100</span></span> Failed requests: <span class="hljs-number"><span class="hljs-number">0</span></span> Write errors: <span class="hljs-number"><span class="hljs-number">0</span></span> Total transferred: <span class="hljs-number"><span class="hljs-number">582900</span></span> bytes HTML transferred: <span class="hljs-number"><span class="hljs-number">546700</span></span> bytes Requests per second: <span class="hljs-number"><span class="hljs-number">11.99</span></span> [#/sec] (mean) <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> per request: <span class="hljs-number"><span class="hljs-number">333.557</span></span> [ms] (mean) <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> per request: <span class="hljs-number"><span class="hljs-number">83.389</span></span> [ms] (mean, across <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> concurrent requests) Transfer rate: <span class="hljs-number"><span class="hljs-number">68.26</span></span> [Kbytes/sec] received Connection Times (ms) min mean[+/-sd] median max Connect: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> Processing: <span class="hljs-number"><span class="hljs-number">137</span></span> <span class="hljs-number"><span class="hljs-number">317</span></span> <span class="hljs-number"><span class="hljs-number">375.9</span></span> <span class="hljs-number"><span class="hljs-number">243</span></span> <span class="hljs-number"><span class="hljs-number">2753</span></span> Waiting: <span class="hljs-number"><span class="hljs-number">137</span></span> <span class="hljs-number"><span class="hljs-number">316</span></span> <span class="hljs-number"><span class="hljs-number">375.7</span></span> <span class="hljs-number"><span class="hljs-number">243</span></span> <span class="hljs-number"><span class="hljs-number">2751</span></span> Total: <span class="hljs-number"><span class="hljs-number">137</span></span> <span class="hljs-number"><span class="hljs-number">317</span></span> <span class="hljs-number"><span class="hljs-number">375.9</span></span> <span class="hljs-number"><span class="hljs-number">243</span></span> <span class="hljs-number"><span class="hljs-number">2753</span></span> Percentage <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the requests served within a certain <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> (ms) <span class="hljs-number"><span class="hljs-number">50</span></span>% <span class="hljs-number"><span class="hljs-number">243</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span>% <span class="hljs-number"><span class="hljs-number">264</span></span> <span class="hljs-number"><span class="hljs-number">75</span></span>% <span class="hljs-number"><span class="hljs-number">282</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span>% <span class="hljs-number"><span class="hljs-number">299</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span>% <span class="hljs-number"><span class="hljs-number">351</span></span> <span class="hljs-number"><span class="hljs-number">95</span></span>% <span class="hljs-number"><span class="hljs-number">433</span></span> <span class="hljs-number"><span class="hljs-number">98</span></span>% <span class="hljs-number"><span class="hljs-number">2670</span></span> <span class="hljs-number"><span class="hljs-number">99</span></span>% <span class="hljs-number"><span class="hljs-number">2753</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>% <span class="hljs-number"><span class="hljs-number">2753</span></span> (longest request)</code> </pre><br><br>  As you can see, the use of Pony ORM gave here a 2-fold increase in API performance. <br><br>  In the second example, I request all the objects from the table.  Here, productivity increase is even more significant: <br><br><pre> <code class="hljs vhdl">seva@SEVA (<span class="hljs-number"><span class="hljs-number">2</span></span>):~/djony$ ab -n <span class="hljs-number"><span class="hljs-number">20</span></span> -c <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-string"><span class="hljs-string">"http://localhost:8080/api/v2/auth/user/?format=json&amp;limit=0"</span></span> This <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> ApacheBench, Version <span class="hljs-number"><span class="hljs-number">2.3</span></span> &lt;$Revision: <span class="hljs-number"><span class="hljs-number">655654</span></span> $&gt; Copyright <span class="hljs-number"><span class="hljs-number">1996</span></span> Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> The Apache Software Foundation, http://www.apache.org/ Benchmarking localhost (be patient).....done Server Software: nginx/<span class="hljs-number"><span class="hljs-number">1.1</span></span>.<span class="hljs-number"><span class="hljs-number">19</span></span> Server Hostname: localhost Server <span class="hljs-keyword"><span class="hljs-keyword">Port</span></span>: <span class="hljs-number"><span class="hljs-number">8080</span></span> Document Path: /api/v2/auth/user/?format=json&amp;limit=<span class="hljs-number"><span class="hljs-number">0</span></span> Document Length: <span class="hljs-number"><span class="hljs-number">306326</span></span> bytes Concurrency Level: <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> taken <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tests: <span class="hljs-number"><span class="hljs-number">40.891</span></span> seconds Complete requests: <span class="hljs-number"><span class="hljs-number">20</span></span> Failed requests: <span class="hljs-number"><span class="hljs-number">0</span></span> Write errors: <span class="hljs-number"><span class="hljs-number">0</span></span> Total transferred: <span class="hljs-number"><span class="hljs-number">6133760</span></span> bytes HTML transferred: <span class="hljs-number"><span class="hljs-number">6126520</span></span> bytes Requests per second: <span class="hljs-number"><span class="hljs-number">0.49</span></span> [#/sec] (mean) <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> per request: <span class="hljs-number"><span class="hljs-number">8178.157</span></span> [ms] (mean) <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> per request: <span class="hljs-number"><span class="hljs-number">2044.539</span></span> [ms] (mean, across <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> concurrent requests) Transfer rate: <span class="hljs-number"><span class="hljs-number">146.49</span></span> [Kbytes/sec] received Connection Times (ms) min mean[+/-sd] median max Connect: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0.1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> Processing: <span class="hljs-number"><span class="hljs-number">6235</span></span> <span class="hljs-number"><span class="hljs-number">7976</span></span> <span class="hljs-number"><span class="hljs-number">1035.4</span></span> <span class="hljs-number"><span class="hljs-number">7980</span></span> <span class="hljs-number"><span class="hljs-number">10671</span></span> Waiting: <span class="hljs-number"><span class="hljs-number">6225</span></span> <span class="hljs-number"><span class="hljs-number">7959</span></span> <span class="hljs-number"><span class="hljs-number">1033.0</span></span> <span class="hljs-number"><span class="hljs-number">7958</span></span> <span class="hljs-number"><span class="hljs-number">10654</span></span> Total: <span class="hljs-number"><span class="hljs-number">6235</span></span> <span class="hljs-number"><span class="hljs-number">7976</span></span> <span class="hljs-number"><span class="hljs-number">1035.4</span></span> <span class="hljs-number"><span class="hljs-number">7980</span></span> <span class="hljs-number"><span class="hljs-number">10671</span></span> Percentage <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the requests served within a certain <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> (ms) <span class="hljs-number"><span class="hljs-number">50</span></span>% <span class="hljs-number"><span class="hljs-number">7980</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span>% <span class="hljs-number"><span class="hljs-number">8177</span></span> <span class="hljs-number"><span class="hljs-number">75</span></span>% <span class="hljs-number"><span class="hljs-number">8287</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span>% <span class="hljs-number"><span class="hljs-number">8390</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span>% <span class="hljs-number"><span class="hljs-number">10001</span></span> <span class="hljs-number"><span class="hljs-number">95</span></span>% <span class="hljs-number"><span class="hljs-number">10671</span></span> <span class="hljs-number"><span class="hljs-number">98</span></span>% <span class="hljs-number"><span class="hljs-number">10671</span></span> <span class="hljs-number"><span class="hljs-number">99</span></span>% <span class="hljs-number"><span class="hljs-number">10671</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>% <span class="hljs-number"><span class="hljs-number">10671</span></span> (longest request) seva@SEVA (<span class="hljs-number"><span class="hljs-number">2</span></span>):~/djony$ ab -n <span class="hljs-number"><span class="hljs-number">20</span></span> -c <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-string"><span class="hljs-string">"http://localhost:8080/api/v3/auth/user/?format=json&amp;limit=0"</span></span> This <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> ApacheBench, Version <span class="hljs-number"><span class="hljs-number">2.3</span></span> &lt;$Revision: <span class="hljs-number"><span class="hljs-number">655654</span></span> $&gt; Copyright <span class="hljs-number"><span class="hljs-number">1996</span></span> Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> The Apache Software Foundation, http://www.apache.org/ Benchmarking localhost (be patient).....done Server Software: nginx/<span class="hljs-number"><span class="hljs-number">1.1</span></span>.<span class="hljs-number"><span class="hljs-number">19</span></span> Server Hostname: localhost Server <span class="hljs-keyword"><span class="hljs-keyword">Port</span></span>: <span class="hljs-number"><span class="hljs-number">8080</span></span> Document Path: /api/v3/auth/user/?format=json&amp;limit=<span class="hljs-number"><span class="hljs-number">0</span></span> Document Length: <span class="hljs-number"><span class="hljs-number">306326</span></span> bytes Concurrency Level: <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> taken <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tests: <span class="hljs-number"><span class="hljs-number">11.841</span></span> seconds Complete requests: <span class="hljs-number"><span class="hljs-number">20</span></span> Failed requests: <span class="hljs-number"><span class="hljs-number">0</span></span> Write errors: <span class="hljs-number"><span class="hljs-number">0</span></span> Total transferred: <span class="hljs-number"><span class="hljs-number">6133760</span></span> bytes HTML transferred: <span class="hljs-number"><span class="hljs-number">6126520</span></span> bytes Requests per second: <span class="hljs-number"><span class="hljs-number">1.69</span></span> [#/sec] (mean) <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> per request: <span class="hljs-number"><span class="hljs-number">2368.136</span></span> [ms] (mean) <span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> per request: <span class="hljs-number"><span class="hljs-number">592.034</span></span> [ms] (mean, across <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> concurrent requests) Transfer rate: <span class="hljs-number"><span class="hljs-number">505.88</span></span> [Kbytes/sec] received Connection Times (ms) min mean[+/-sd] median max Connect: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0.1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> Processing: <span class="hljs-number"><span class="hljs-number">1024</span></span> <span class="hljs-number"><span class="hljs-number">2269</span></span> <span class="hljs-number"><span class="hljs-number">806.2</span></span> <span class="hljs-number"><span class="hljs-number">2227</span></span> <span class="hljs-number"><span class="hljs-number">4492</span></span> Waiting: <span class="hljs-number"><span class="hljs-number">1017</span></span> <span class="hljs-number"><span class="hljs-number">2252</span></span> <span class="hljs-number"><span class="hljs-number">803.6</span></span> <span class="hljs-number"><span class="hljs-number">2211</span></span> <span class="hljs-number"><span class="hljs-number">4472</span></span> Total: <span class="hljs-number"><span class="hljs-number">1024</span></span> <span class="hljs-number"><span class="hljs-number">2269</span></span> <span class="hljs-number"><span class="hljs-number">806.2</span></span> <span class="hljs-number"><span class="hljs-number">2227</span></span> <span class="hljs-number"><span class="hljs-number">4492</span></span> Percentage <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the requests served within a certain <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> (ms) <span class="hljs-number"><span class="hljs-number">50</span></span>% <span class="hljs-number"><span class="hljs-number">2227</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span>% <span class="hljs-number"><span class="hljs-number">2336</span></span> <span class="hljs-number"><span class="hljs-number">75</span></span>% <span class="hljs-number"><span class="hljs-number">2395</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span>% <span class="hljs-number"><span class="hljs-number">2406</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span>% <span class="hljs-number"><span class="hljs-number">4140</span></span> <span class="hljs-number"><span class="hljs-number">95</span></span>% <span class="hljs-number"><span class="hljs-number">4492</span></span> <span class="hljs-number"><span class="hljs-number">98</span></span>% <span class="hljs-number"><span class="hljs-number">4492</span></span> <span class="hljs-number"><span class="hljs-number">99</span></span>% <span class="hljs-number"><span class="hljs-number">4492</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>% <span class="hljs-number"><span class="hljs-number">4492</span></span> (longest request)</code> </pre><br><br>  API performance increased more than 4 times! <br><br><h4>  What remains to be </h4><br><br>  Authorization and authentication have not yet been implemented, however, I do not see any special problems in their implementation. <br><br>  There is a problem with the implementation of filters on the criteria of the regex, week_day and search types, since similar criteria are not yet available in Pony ORM. <br><br><h4>  Conclusion </h4><br><br>  Implementing the Pony ORM as a replacement for the Django ORM in ready-made Django application packages is quite possible and very useful in terms of productivity.  A good abstraction of classes inside a package helps a lot, in particular the presence of a layer independent of Django ORM. <br><br>  I invite everyone who is interested in improving the performance of their Django applications to join the open <a href="https://github.com/nnseva/djony">djony</a> projects <a href="https://github.com/nnseva/djony">(crossing Pony and Django)</a> and <a href="https://github.com/nnseva/tastypie_djony">tastypie_djony (accelerating Tastypie using Pony ORM)</a> to bring them to a sustainable industrial design as quickly as <a href="https://github.com/nnseva/tastypie_djony">possible</a> . <br><br>  Project <a href="http://doc.ponyorm.com/">Pony ORM</a> is an open source project. <br><br>  Traditionally, I remind you that the Pony ORM developers are still readonly-users of Habrahabr: <br><br>  <a href="http://habrahabr.ru/users/alexeymalashkevich/" class="user_link">AlexeyMalashkevich</a> m.alexey@gmail.com <br><br>  <a href="http://habrahabr.ru/users/metaprogrammer/" class="user_link">metaprogrammer</a> alexander.kozlovsky@gmail.com </div><p>Source: <a href="https://habr.com/ru/post/201294/">https://habr.com/ru/post/201294/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../201282/index.html">How to find a logistics partner or why you do not need to wait for a steam locomotive</a></li>
<li><a href="../201284/index.html">Manageability of complex networks - translation of the article Controllability of complex networks</a></li>
<li><a href="../201286/index.html">COLT released with TypeScript support</a></li>
<li><a href="../20129/index.html">A small hint on usability Habrahabra</a></li>
<li><a href="../201292/index.html">Using COLT annotations in front-end development</a></li>
<li><a href="../201296/index.html">Google Product Ads: Debriefing</a></li>
<li><a href="../201298/index.html">Tesla and Mpemba Effect</a></li>
<li><a href="../2013/index.html">Google will index more</a></li>
<li><a href="../20130/index.html">MySQL-Front is back?</a></li>
<li><a href="../201304/index.html">Details of the targeted attack using Win32 / Exploit.CVE-2013-3906.A</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>