<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How was the local version of the site Intuit.Ru hacked</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Connection establishment ... 
 Looking through the results (rather disappointingly) of the next exam for INTUIT, I wondered for the hundredth time the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How was the local version of the site Intuit.Ru hacked</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/e2f/20a/903/e2f20a903ee3f0c33152b766d838011b.jpg" alt="image"><br><br><h4>  Connection establishment ... </h4><br>  Looking through the results (rather disappointingly) of the next exam for INTUIT, I wondered for the hundredth time the question ‚ÄúWhy is this question again not right ?!  After all, he was 100% sure of the answer ... ‚Äù.  Having shown a bit of cowardice, I decided to look for the correct answers to the tests and was greatly surprised by their lack of public access.  Something was certainly there, but it was basically a lure of the form "10 random answers for free, and for the rest, please transfer us a coin."  The money is not big there, but I didn‚Äôt want to pay for the answers, and I decided to go another way. <br><a name="habracut"></a><br>  The first crazy thought was to try to search for bugs on the site, but I quickly refused it because the next one came.  I remembered that in the old days INTUIT was selling discs with a local version of its site, which allowed it to be trained without being connected to the Internet, and so on.  pass exams.  The results could then be synchronized upon connection.  Then a logical chain appeared in the brain: ‚ÄúYou can pass tests offline =&gt; a check is also performed offline =&gt; somewhere there is a file with answers‚Äù. <br><br>  Some 4.5GB separated me from my happiness and the solution of all my dilemmas!  The disc was found pretty quickly on some tracker and put on download.  From boredom began to read the comments.  Among the placer of thanks, someone asked: ‚Äúcan I see the answers in the same place?‚Äù.  He was never answered, but then it did not alert me at all.  And the image was downloaded and installed (it was set for quite a long time).  Let's see what we have here. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Dive </h4><br>  The internal structure of the root directory looked like this: <br><pre><code class="dos hljs">html lib local_web_server intu32.ico INTUIT.exe intuit.ini trayicon.ico uninstall.exe</code> </pre> <br>  Somehow I was immediately drawn to the <b>lib</b> folder.  And rightly drawn.  A bunch of * .pm files and a couple of directories with interesting names " <b>course</b> " and " <b>test</b> ".  Looking into the test folder and examining its contents, I realized that I did not understand anything.  It contained 3 .pm files, which, as you may have guessed, turned out to be perl-packages.  I must say that I am absolutely not a pearl guru.  I wrote something on it once for experiments, but that is the case of bygone days.  The system, which fell into my hands, was completely written in pearl.  But this is not a reason to surrender and the excavation was continued. <br><br>  In the <b>course</b> directory there are many files with names very similar to abbreviated course naming.  How to find the one that I needed?  It‚Äôs time, apparently, to launch a shortcut from the desktop and see what they offer there.  Some time after the launch, the default browser started and loaded the page at <a href="http://localhost/">localhost</a> : 3232.  It is interesting.  So somewhere inside this wigwam a full-fledged Apache still lives, or at least some Denver.  But more about that later. <br><br>  Logged in as <b>admin: admin,</b> I decided to try the exam for the course I needed to see how the whole system works.  After noting the answers to the questions and clicking on the submit button, I saw the following text: <b>‚ÄúYou scored {n}% points.</b>  <b>We correctly solved {m} tasks from {k}. ‚Äù</b> And then the glance fell on the browser line in which the path to the course was specified, but not in the <b>lib</b> directory, but in the <b>html</b> directory.  There was also an abbreviated course name.  It seems that I have already seen a similar file ... Running into the lib / courses directory, opening oopbase.pm and seeing several procedures, some kind of hash array% lecture, but the picture below is much more interesting!  Here he is handsome!  The hash is an array of% test with all questions, as well as answer options.  "All the problem is solved!" I thought at that moment, but as I studied this hash, the beautiful pink bird Oblomingo knocked me out of the window more and more obsessively ... There were no answers.  The hash is very large, so I bring it a piece that is of interest: <br><br><pre> <code class="perl hljs"><span class="hljs-string"><span class="hljs-string">830 =&gt;</span></span> [<span class="hljs-string"><span class="hljs-string">'830'</span></span>,<span class="hljs-string"><span class="hljs-string">'50'</span></span>,<span class="hljs-string"><span class="hljs-string">'5'</span></span>,<span class="hljs-string"><span class="hljs-string">"16ab48786a5d520fe6eeea7f1a6e140b"</span></span>, [[<span class="hljs-string"><span class="hljs-string">'5708'</span></span>,<span class="hljs-string"><span class="hljs-string">'830'</span></span>,<span class="hljs-string"><span class="hljs-string">'1'</span></span>,<span class="hljs-string"><span class="hljs-string">'10'</span></span>,<span class="hljs-string"><span class="hljs-string">"7ce21606425e2b20e566f422696b92de"</span></span>, [[<span class="hljs-string"><span class="hljs-string">'16692'</span></span>,<span class="hljs-string"><span class="hljs-string">'5708'</span></span>,<span class="hljs-string"><span class="hljs-string">'1'</span></span>,<span class="hljs-string"><span class="hljs-string">'1'</span></span>,<span class="hljs-string"><span class="hljs-string">"  ‚Äì  "</span></span>,<span class="hljs-string"><span class="hljs-string">"e9b0b5d2f98bf71489891a48f80cb868"</span></span>, <span class="hljs-string"><span class="hljs-string">"387b3b67d9c1248131c136eae3e6cab9"</span></span>, [[<span class="hljs-string"><span class="hljs-string">'349301'</span></span>,<span class="hljs-string"><span class="hljs-string">'16692'</span></span>,<span class="hljs-string"><span class="hljs-string">'1'</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,], [<span class="hljs-string"><span class="hljs-string">'349302'</span></span>,<span class="hljs-string"><span class="hljs-string">'16692'</span></span>,<span class="hljs-string"><span class="hljs-string">'2'</span></span>,<span class="hljs-string"><span class="hljs-string">"  ,     "</span></span>,], [<span class="hljs-string"><span class="hljs-string">'349303'</span></span>,<span class="hljs-string"><span class="hljs-string">'16692'</span></span>,<span class="hljs-string"><span class="hljs-string">'3'</span></span>,<span class="hljs-string"><span class="hljs-string">"    "</span></span>,], [<span class="hljs-string"><span class="hljs-string">'349304'</span></span>,<span class="hljs-string"><span class="hljs-string">'16692'</span></span>,<span class="hljs-string"><span class="hljs-string">'4'</span></span>,<span class="hljs-string"><span class="hljs-string">"     "</span></span>,],],],</code> </pre><br>  The key 830 is the value that was assigned to the key from the% lecture hash.  At the same time I bring in his part: <br><br><pre> <code class="perl hljs"><span class="hljs-keyword"><span class="hljs-keyword">my</span></span> %lecture = ( <span class="hljs-string"><span class="hljs-string">11 =&gt;</span></span> <span class="hljs-number"><span class="hljs-number">830</span></span>, <span class="hljs-string"><span class="hljs-string">7 =&gt;</span></span> <span class="hljs-number"><span class="hljs-number">826</span></span>, <span class="hljs-string"><span class="hljs-string">17 =&gt;</span></span> <span class="hljs-number"><span class="hljs-number">836</span></span>, <span class="hljs-string"><span class="hljs-string">2 =&gt;</span></span> <span class="hljs-number"><span class="hljs-number">821</span></span>, <span class="hljs-string"><span class="hljs-string">1 =&gt;</span></span> <span class="hljs-number"><span class="hljs-number">820</span></span>, ‚Ä¶ );</code> </pre><br>  Now it becomes clear that the questions that correspond to key 830 belong to the 11th lecture.  And this is the only thing that became clear at that time.  Since I didn‚Äôt have more clever thoughts about this file, it was decided to go around, as all normal characters do.  My path lay to the further study of the file structure, maybe there is the same table of answers.  I even thought of how it could look like.  The table was not found, but a careful examination of the <b>lib</b> directory led me along the test.pm =&gt; etest.pm chain to a rather amusing ext.pm file which contained the procedures: <br><br><pre> <code class="perl hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_answer_exam</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_answer_exam_extern</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_answer</span></span></span></span></code> </pre><br>  Which in turn caused the same-name procedures from the ‚Äúer‚Äù package.  The package was found quite quickly and the analysis of its contents showed that it loads the <b>er.dll</b> library <b>through the XSLoader</b> , which was lying nearby (and next to it was exactly the same, but under * nix with the .so extension).  The picture began to take shape, and I went to look at the export table of this library. <br><br><h4>  We need to go deeper! </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/68a/948/f7c/68a948f7c623d981d249ced1dcfdf620.jpg"><br><br>  The export table has killed all the sense of beauty in me.  It contained one function <b>boot_er</b> .  But what about <b>check_answer</b> and other buns ... It began to smell like kerosene and required countermeasures: good tea and IDA Pro! <br><br>  It turned out that the library is not as simple as it seems and contains a whole bunch of all sorts of procedures, and in addition it has an interesting import table.  In addition to quite familiar imports from KERNEL32 and msvcrt, I saw a whole bunch of functions from the perl58.dll library and everything would probably not be so interesting if these functions were easily found in Google.  But they were not. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/72b/07d/680/72b07d68001fb964d209f8178cd73b63.png"><br><br>  Maybe this is all from the lack of pearl barley experience and I do not know how to look for such functions, but I have not found an exhaustive description anywhere.  Only scraps of information on the forums.  Go ahead.  The bold pressing of Shift + F12 showed a lot of potentially interesting things. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b5/e25/e26/9b5e25e268736fe1dfd83a0c474909a1.png"><br><br>  In particular, the string Usage: er :: check_answer (a, local_user_id, t, answer) gave me the idea of ‚Äã‚Äãcalling this library from my own perl script.  The only catch was the input format.  Having picked in scripts with which help testing was carried out, I saw several calls of print which interested me.  The values ‚Äã‚Äãwere not output to a log file, but directly to the console.  It is logical to assume that this is the console of the web server and the matter remained for a small one: to find this console. <br><br>  Inspection of the local_web_server catalog showed that there was no smell of Apache, or even Denver.  The server was written in perl and was provided in two versions of ‚Äúserver_unix.pl‚Äù and ‚Äúserver_win32.pl‚Äù, and the main startup file ‚Äúintuit.exe‚Äù which is located above the directory, just started all this stuff, as indicated by the following lines obtained with using IDA from this file <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c72/ed0/584/c72ed058452bd49c26aee1476798d15c.png"><br><br>  Great, then you can start all this manually and see what is written in STDOUT.  Selecting the first test in the course I needed and ticking the correct answers, I pressed the submit button and saw the next console output. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4a1/4f0/e4a/4a14f0e4a215632dfdb92b138a8f672a.gif"><br><br>  Here are the first cookies!  Let us examine the values ‚Äã‚Äãthat are of practical interest: <br><ul><li>  820 - test ID that corresponds to the first lecture (based on the% lecture hash array) </li><li>  tasks =&gt; 4 is the number of correctly solved tasks. </li><li>  answer =&gt; [348966, 349080, 63232, 63234, 53240] - an array of answer choices I have marked. </li></ul><br>  The numbers in the array answer are response IDs that were previously discussed in the% test array. <br><br>  It remains to obtain the parameters of the function call er :: check_answer ().  A call to the print function was added to the etest.pm file, in which the contents of the <b>param</b> array were written to the file using Data :: Dumper, which was passed to the function.  I give a piece of code: <br><br><pre> <code class="perl hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($type eq <span class="hljs-string"><span class="hljs-string">'lecture'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(F, <span class="hljs-string"><span class="hljs-string">"&gt;&gt;D:\param.txt"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> F Dumper(@param); <span class="hljs-keyword"><span class="hljs-keyword">close</span></span>(F); ($mtime,$csa,$tasks,$points,$mark) = test::ext::check_answer(@param); }</code> </pre><br>  Further, on the basis of the data obtained, I sketched the following script: <br><br><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/perl -w require test::ext; @var1 = [ 1388075531, '8647ee8932669c9e0a00827bb82957d2', [ [ 5658, 16542 ] #   4     ,       . ]; $var2 = '57d0c0e0304de48376b064b86cd36bc1'; @var3 = [ ‚Ä¶ ]; #         $var4 = ['348973', '348975']; my @param = (@var1, $var2, @var3, $var4); my ($mtime,$csa,$tasks,$points,$mark); ($mtime,$csa,$tasks,$points,$mark) = test::ext::check_answer(@param); print "Tasks: " . $tasks;</span></span></code> </pre><br>  Let us analyze what is happening here.  The <b>@ var1</b> contains the questions that were asked in the current test; there are only 5 arrays of the form [section int id, question int id].  The <b>$ var2</b> variable contains the hash identifier of the user who passes the test.  Need most likely to save the test results.  The <b>@ var3</b> hash contains an exact copy of the value from the% test array, which can be obtained from the lecture ID key.  Finally, the <b>$ var4 array</b> contains the answers I selected.  In the above script, I left only the answers to the first question to make it easier to test. <br><br>  The launch of the script pleased with the string "Tasks: 1", which meant that I was on the right track.  A thought immediately arose on writing the simplest brute force that would form various variants of the $ var4 array and check $ task for equality to one.  It would have ended this story if it were not for the interest that filled me and the desire to find out how deep the rabbit hole still was. <br><br><h4>  Wake up, Neo ... The Matrix has you ... </h4><br>  After examining the import table in IDA, it was decided to start with the function <b>strncmp</b> .  Having launched my test script under the debugger (the code of which is given above) and having traced the program before loading the er.dll library, I opened the list of functions used by it and set a breakpoint on the import of strncmp.  After restarting the script, the debugger happily reported ‚Äú <i>Break point at msvcrt.strncmp</i> ‚Äù, and the stack of compared lines were: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e3a/dbe/b08/e3adbeb087bf6eb85b4901ec3d1d7cd8.gif"><br><br>  It was a hash from the <b>@ var1</b> array and I decided to see where this function is called from.  Pressing Ctrl + F9, and then F8, I began to trace the program further.  In the course of the trace, I again found myself inside strncmp, to which two strings of the form "57f260a2606af344753ffc00ad834581" were transmitted.  This hash was vaguely familiar to me and, having looked at the script code, I was convinced that it was a hash relating to one of the questions.  But it was already warmer!  Pressing F9 and once again entering the comparison function, I was a little puzzled by the parameters I saw on the stack: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/958/534/5f8/9585345f8fafe38fc6525568fb501df4.gif"><br><br>  The string ‚Äúe8c178abd4f1114837d00771871b6379‚Äù was a hash for another test question, and the second was not familiar to me.  Continuing the launches, I compiled a list of 6 calls to the compare function.  Here they are: <br><table><tbody><tr><th>  <b>Call</b> </th><th>  <b>Hash # 1</b> </th><th>  <b>Hash # 2</b> </th></tr><tr><td>  <b>one</b> </td><td>  8647ee8932669c9e0a00827bb82957d2 </td><td>  8647ee8932669c9e0a00827bb82957d2 </td></tr><tr><td>  <b>2</b> </td><td>  57f260a2606af344753ffc00ad834581 </td><td>  57f260a2606af344753ffc00ad834581 </td></tr><tr><td>  <b>3</b> </td><td>  e8c178abd4f1114837d00771871b6379 </td><td>  0f4632529bff4a4ebab04b5794c1518a </td></tr><tr><td>  <b>four</b> </td><td>  9ffcabf80ad0aea2ec7b8c7b89051c29 </td><td>  46916f5f972e01efa665f6cf2245f071 </td></tr><tr><td>  <b>five</b> </td><td>  3f2fd6dc285372ee847ee9837718f0df </td><td>  a95478bfb5af215aa268d21b498b493c </td></tr><tr><td>  <b>6</b> </td><td>  7f29edf5e4fad4e5782ffd36512cc6b7 </td><td>  a2401e9ad6086aa57ea59b61ec0d55d2 </td></tr></tbody></table><br>  Calls from the 2nd to the 6th contained the first line of hashes, which I at that time called "question identifiers".  In this case, the question to which I answered correctly, the hashes coincided.  So there was some kind of dependency here.  Changing the <b>$ var4</b> array in the script, I was finally convinced of this, seeing instead of ‚Äú57f260a2606af344753ffc00ad834581‚Äù a completely different hash: ‚Äú859c6288692d7037035a011ba54597aa‚Äù.  Now I had to understand where these hashes come from. <br><br>  Turning to the function call, I put a breakpoint at the beginning of the transfer of parameters and, removing all other points, I restarted the script. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fab/113/91e/fab11391e306bc559d2c6ee5d138f832.gif"><br><br>  As can be seen from the code, the address where the hash is located is stored in EAX, which confirmed the memory dump. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/288/a5d/19a/288a5d19a1ad3ac4061dd9eaba76f628.gif"><br><br>  Things are easy - to find out who put it there. <br><br>  Further study of the algorithm showed that for each question lines of the form are formed <br>  <i>asdc * a * &lt;query_id&gt; * a * &lt;response_id_id_1_&gt; ... * a * &lt;response__id_ id_N&gt;</i> , which are hashed by the md5 algorithm and compared with the hash that I previously mistakenly called the ‚Äúquestion identifier‚Äù.  In fact, it turned out to be the hash-identifier of the correct answer.  Shah! <br><br><h4>  And mate! </h4><br>  It turned out that the idea of ‚Äã‚Äãwriting bruteforce answers was not as bad as it seemed to me at the beginning.  And although I still came to this again, this brute force is of a completely different quality.  I will not give the full code, I will consider only its main points. <br><br>  In order not to insult the feelings of believers in perl (I think they had enough of my miracle script), I will implement brute force in C #, which, as we know, will endure everything.  It was decided to analyze files with courses using regular expressions.  To the critics of this approach, I want to immediately say: Can you do better?  Do it.  And it's more convenient for me. <br><br>  The following data blocks represent interest in the course file: <br><ul><li>  hash array of lecture numbers and their identifiers </li><li>  question lists for each lecture </li><li>  answers to questions </li></ul><br>  The first hash array can be obtained with a fairly simple regular expression: <br><br><pre> <code class="cs hljs">(?&lt;lnum&gt;\d+)\s=&gt;\s(?&lt;lid&gt;\d+)</code> </pre><br>  Next, analyze the receipt of questions from the course.  To do this, I applied the following regular expression: <br><br><pre> <code class="cs hljs">\[<span class="hljs-string"><span class="hljs-string">'(?&lt;tid&gt;\d+)'</span></span>,<span class="hljs-string"><span class="hljs-string">'\d+'</span></span>(?:,<span class="hljs-string"><span class="hljs-string">'\d'</span></span>){<span class="hljs-number"><span class="hljs-number">2</span></span>},<span class="hljs-string"><span class="hljs-string">"(?&lt;ttext&gt;.*?)"</span></span>,<span class="hljs-string"><span class="hljs-string">"(?&lt;ahash&gt;[a-f0-9]*)"</span></span>,<span class="hljs-string"><span class="hljs-string">"[a-f0-9]*"</span></span>,(?&lt;avars&gt;\[{<span class="hljs-number"><span class="hljs-number">2</span></span>}.*?(?:,\]){<span class="hljs-number"><span class="hljs-number">2</span></span>})</code> </pre><br>  It may seem complicated at first glance, but in fact there is nothing supernatural either.  Named groups contain: <br><ul><li>  <b>tid</b> - question identifier </li><li>  <b>ttext</b> - question text </li><li>  <b>ahash</b> - the correct answer hash </li><li>  <b>avars</b> - unprocessed answers </li></ul><br>  The parsing of unprocessed response options is performed by the following expression: <br><br><pre> <code class="cs hljs"><span class="hljs-string"><span class="hljs-string">'(?&lt;aid&gt;\d+)'</span></span>.*?<span class="hljs-string"><span class="hljs-string">"(?&lt;atext&gt;.*?)"</span></span></code> </pre><br>  Named groups contain: <br><ul><li>  <b>aid</b> - answer ID </li><li>  <b>atext</b> - question text </li></ul><br>  Directly brute force answers in this case is a combinatorial problem of finding all subsets of a given set.  The subsets were generated using a binary code, as shown by the following algorithm: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> SetPower = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)Math.Pow(<span class="hljs-number"><span class="hljs-number">2</span></span>, answers.Count); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; SetPower; i++) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> aStr = <span class="hljs-string"><span class="hljs-string">""</span></span>; answers.ForEach(x =&gt; x.Valid = <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; answers.Count; j++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((i &amp; (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; j)) != <span class="hljs-number"><span class="hljs-number">0</span></span>) { aStr += <span class="hljs-string"><span class="hljs-string">"*a*"</span></span> + answers[j].AID; answers[j].Valid = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> answerString = <span class="hljs-string"><span class="hljs-string">"asdc*a*"</span></span> + task.TID + aStr; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GetMD5Hash(answerString) == task.TrueAnswerHash) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> answers.Where(w =&gt; w.Valid == <span class="hljs-literal"><span class="hljs-literal">true</span></span>).ToList(); } }</code> </pre><br>  At each pass of the algorithm, a subset of the answer choices is formed, from which a string is compiled for hashing.  After receiving the hash, it is compared with the reference one, and in case of coincidence, many correct answers are returned. <br><br><h4>  Connection terminated ... </h4><br>  And so this story of the struggle for knowledge ended.  Knowledge is the thing that is obtained only by work and any knowledge obtained free of charge (in the broad sense of the word) does not cost anything.  I thank the INTUIT LEU for their resource in general and for those pleasant moments that they delivered to me with their magic library er.dll in particular. <br><br><h5>  Additional materials to the article </h5><br>  <a href="https://gist.github.com/8389024">Perl Script I Used For Debugging</a> <br>  <a href="https://github.com/Sp0tted0wl/iGetAnswer">Console bruteforcer answers</a> </div><p>Source: <a href="https://habr.com/ru/post/208874/">https://habr.com/ru/post/208874/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208864/index.html">NAVIA - unmanned electric vehicle</a></li>
<li><a href="../208866/index.html">Deploy using Salt</a></li>
<li><a href="../208868/index.html">Reading room of a mobile indie developer: the most interesting thing for the New Year holidays</a></li>
<li><a href="../208870/index.html">10 simple tasks on c # with a trick</a></li>
<li><a href="../208872/index.html">A simple interpreter from scratch in Python (part 3)</a></li>
<li><a href="../208876/index.html">Chase Algorithm</a></li>
<li><a href="../208886/index.html">Tolstoy Startup Camp: how Yandex teaches how to do its business</a></li>
<li><a href="../208890/index.html">GulpJS - fantastically fast project builder</a></li>
<li><a href="../208894/index.html">Conference Bridge, Call Recording Server and Grandstream Fax Server: Overview</a></li>
<li><a href="../208900/index.html">Webinar: "Dell Venue PCs - Dell's look at the BYOD concept"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>