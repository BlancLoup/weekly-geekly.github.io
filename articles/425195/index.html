<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Black, white and gray lists on guard of enterprise security</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the last article, we introduced you to the work of the built-in spam filter in the Zimbra Collaboration Suite, which allows you to reliably protect...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Black, white and gray lists on guard of enterprise security</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://habr.com/company/zimbra/blog/424001/">In the last article,</a> we introduced you to the work of the built-in spam filter in the Zimbra Collaboration Suite, which allows you to reliably protect your company from receiving infected messages and letters that are not related to business correspondence.  But what to do in cases when an enterprise is subjected to a targeted attack by attackers, part of which is composed of letters using social engineering techniques, the use of trusted mailboxes or even a DoS attack on the mail server?  Salvation from these troubles can be the creation of white, black and gray lists. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e98/93d/7d9/e9893d7d9f995c2a24dce02df7fa5d51.png" alt="image"><br><a name="habracut"></a><br>  Creating a blacklist can help reliably protect against these types of attacks, when attackers gain control of your organization‚Äôs trusted counterpart‚Äôs mail and start sending infected excel files or archives with supposedly new details, invoices and so on.  If you have time to add mail to the counterparty to the blacklist, you can reduce the effect of the intruders' efforts to zero.  Let's take a look at how this works in the Zimbra Collaboration Suite. <br><br>  Black and white lists in Zimbra can be formed on two levels at once.  For example, a ban on receiving mail can be set in the Amavis software interface, which is built into the ZCS and is responsible for filtering mail.  In addition to separating business letters from spam according to various indirect signs, Amavis also sends letters for analysis to SpamAssassin spam filter and ClamAV antivirus. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In Amavis, you can add to the white and black lists not only individual mailboxes and entire domains, but also individual ip-addresses and even entire subnets.  In order to block or allow a mailbox or domain, you first need to create the <b>whitelist</b> and / or <b>blacklist</b> files in the <b>/ opt / zimbra / conf /</b> folder, and then add mailing addresses or domains that you are going to allow or block. <br><br><blockquote>  $ cat / opt / zimbra / conf / whitelist <br>  ceo@partner.com <br>  partner.org <br><br>  $ cat / opt / zimbra / conf / blacklist <br>  spammer@spam.com <br>  spam.org </blockquote><br>  After that, you need to add two lines to the <b>/opt/zimbra/conf/amavisd.conf.in</b> file with the rule for checking previously created files. <br><br><blockquote>  read_hash (% whitelist_sender, '/ opt / zimbra / conf / whitelist'); <br>  read_hash (% blacklist_sender, '/ opt / zimbra / conf / blacklist'); </blockquote><br>  After saving all changes, you must restart Amavis. <br><br><blockquote>  # su - zimbra -c "zmamavisdctl restart" </blockquote><br>  If you have trusted networks, for example, an enterprise local network or a remote branch's subnet for which you would like to disable anti-virus and anti-spam checks, then Amavis can also help you with this.  First of all, you need to activate the initially disabled bypass checks for selected ip-addresses and subnets with the help of a special command and restart Amavis and related programs. <br><br><blockquote>  $ zmprov mcf zimbraAmavisOriginatingBypassSA TRUE <br>  $ zmantispamctl restart <br>  $ zmantivirusctl restart <br>  $ zmamavisdctl restart </blockquote><br>  Add to the list of trusted subnets using the following command <br><br><blockquote>  $ zmprov ms `zmhostname` zimbraMtaMyNetworks '127.0.0.0/8 10.0.0.0/8 192.168.1.0/22' </blockquote><br>  You can check the current list of trusted networks using the following commands: <br><br><blockquote>  $ postconf mynetworks <br>  $ zmprov gs `zmhostname` zimbraMtaMyNetworks </blockquote><br>  You can block ip-addresses in Zimbra at the Postfix level.  This method helps to protect the server from DoS attacks.  Detailed instructions are set out <a href="https://habr.com/company/zimbra/blog/341804/">in a previous article</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/030/d57/166/030d57166ec0523c9d6013a4695d51b4.png" alt="image"><br><br>  A separate item is the creation of the so-called "gray list".  It is usually used to protect against automatic spam, but it can also be useful to protect against malicious emails coming from a trusted counterparty‚Äôs mailbox captured by cybercriminals.  The principle of its operation is based on the fact that the letter from the sender is not accepted the first time and he receives a message about the temporary unavailability of the server.  The logic here is that the sender, who deliberately sends a letter to the server, will try to send again, and the software for automated sending of e-mails will not repeat sending.  That is why when attackers gain control of your counterpart's mailbox and automatically begin to spread infected emails to all addresses from the contact book, it is possible to avoid the troubles associated with their receipt. <br><br>  You can customize gray lists in Zimbra thanks to Postfrey daemon from Postfix authors.  It is available in official repositories and is easily installed by regular means.  In Ubuntu, the daemon is <b>started</b> using the <b>/etc/init.d/postgrey start</b> command, after which it will be available on port 60000 and you just have to configure it correctly.  To do this, open the file <b>/opt/zimbra/conf/postfix_recipient_restrictions.cf</b> in the editor and add the line <b>check_policy_service inet: 127.0.0.1: 60000</b> before each line starting with '%%'.  After that, it remains only to restart Postfix using the <b>postfix reload</b> command. </div><p>Source: <a href="https://habr.com/ru/post/425195/">https://habr.com/ru/post/425195/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../425177/index.html">We study Adversarial Tactics, Techniques & Common Knowledge (ATT @ CK). Enterprise Tactics. Part 3</a></li>
<li><a href="../425179/index.html">YouTube stars are starting to burn at work: "the attractiveness of the most interesting of the works faded"</a></li>
<li><a href="../425181/index.html">Frankie Zapata for The Verge: ‚ÄúTurbo-jet fuel will help melt reinforced concrete skepticism‚Äù</a></li>
<li><a href="../425187/index.html">Intel PAC with FPGA Stratix 10 SX - an accelerator for large tasks</a></li>
<li><a href="../425191/index.html">Fastware</a></li>
<li><a href="../425197/index.html">Costing an IdM implementation project - how to anticipate surprises</a></li>
<li><a href="../425199/index.html">What protects buyers from fraud with contactless payments</a></li>
<li><a href="../425201/index.html">‚ÄúI‚Äôve been struggling with impostor syndrome for three years‚Äù - 10 questions for a programmer, issue 7</a></li>
<li><a href="../425205/index.html">Soft Skills in Project Management: Concept, Goals and Tips for Successful Business Applications</a></li>
<li><a href="../425207/index.html">Design Testing: Top 10 Heisenbug 2018 Piter Reports</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>