<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to create a virtual machine in Google Spreadsheets</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The author of the material tells how using Google-tables to create a virtual machine that generates Fibonacci numbers. 

 Recently, I noticed that Goo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to create a virtual machine in Google Spreadsheets</h1><div class="post__text post__text-html js-mediator-article">  <i>The author of the material tells how using Google-tables to create a virtual machine that generates Fibonacci numbers.</i> <br><br>  Recently, I noticed that Google Docs has a fairly comprehensive system of scripts called <a href="https://developers.google.com/apps-script/">Apps Script</a> .  It allows you to write some pretty useful things in JavaScript: <br><br><ul><li>  Run code in response to events such as opening documents or changing cells </li><li>  Create custom table functions for formulas in Google Spreadsheets </li><li>  Use services such as Google Translator to translate text or Gmail to send email. </li><li>  Add new menu items to the Google Docs interface using custom features </li></ul><br>  Naturally, for this reason I had to create something interesting.  Look at this: Google spreadsheet virtual machine that generates <a href="https://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B8%25D1%2581%25D0%25BB%25D0%25B0_%25D0%25A4%25D0%25B8%25D0%25B1%25D0%25BE%25D0%25BD%25D0%25B0%25D1%2587%25D1%2587%25D0%25B8">Fibonacci numbers</a> ! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/web/aba/7fd/372/aba7fd37246246a38be29c453df74c2e.gif" alt="image"><br><a name="habracut"></a><br><h3>  How does it work </h3><br>  A VM has a memory area of ‚Äã‚Äã100 cells, numbered from 0 to 99. Each cell can contain a command or an integer value. <br><br>  There is also a stack that starts at the bottom of the memory area and grows up. <br>  This is what a VM sheet looks like when it is empty: <br><br><img src="https://habrastorage.org/web/0ea/3cc/2c2/0ea3cc2c2fd24510bec5cea5bbf7ac07.png" alt="image"><br><br>  Note the following: <br><br><ul><li>  RA, RB, RC and RD are general registers. </li><li>  RI is a pointer to a command.  It indicates the next command to be executed in the memory area, which is highlighted in green. </li><li>  RS is a pointer to the stack.  He points to a memory cell at the top of the stack.  It is highlighted in blue. </li><li>  Output Displays the output of the program. </li><li>  Error (Error) displays any errors that occur when analyzing or executing a command. </li><li>  Memory (Memory) is an area of ‚Äã‚Äã100 memory cells. </li></ul><br>  To run a command, Apps Script checks the RI value in the background to understand which command should be executed next.  It reads the command in the cell pointed to by RI and analyzes it. <br><br>  There are commands for moving data between memory and registers, managing the stack, or executing conditional commands. <br><br>  After the command is executed, the RI value is incremented to point to the next cell in memory. <br><br><h3>  Using </h3><br>  There is a special menu called "Computer" (Computer) with some functions that are used to control the VM: <br><br><img src="https://habrastorage.org/web/730/a09/70c/730a0970c8b84a9fa7f38afaa8496f47.png" alt="image"><br><br><ul><li>  Run (Run) starts the current program before it ends or an error is detected. </li><li>  Step (Step) runs one command, and then pauses. </li><li>  Reset clears all registers and output fields, thus preparing the program for restarting. </li><li>  Load Factor Program (Load Factorial Program) loads factorial example from another table. </li><li>  Loading the Fibonacci Program loads the Fibonacci example from another sheet. </li></ul><br><h3>  Teams </h3><br>  There are several implemented commands: <br><br>  <b>Are common</b> <br><br><ul><li>  mov dst src copies the value from src to dst. </li></ul><br>  <b>Mathematical</b> <br><br><ul><li>  add dst src adds dst to src and stores the result in dst. </li><li>  sub dst src subtracts src from dst and stores the result in dst. </li><li>  mul dst src multiplies dst by src and stores the result in dst. </li></ul><br>  <b>Stack operations</b> <br><br><ul><li>  push src pushes src onto the stack. </li><li>  pop dst retrieves the value from the top of the stack and saves it to dst. </li></ul><br>  <b>Transitions and conditional commands</b> <br><br><ul><li>  jmp target goes to the command in the cell referenced by target. </li><li>  jl cmp1 cmp2 target compares cmp1 with cmp2.  If cmp1 is less than cmp2, ‚Äã‚Äãexecution proceeds to target. </li></ul><br>  <b>Functions</b> <br><br><ul><li>  call target is a function call.  He loads the current command pointer onto the stack so that it can be returned later, and then goes to the target. </li><li>  ret returns a function.  It retrieves the value from the stack and passes to it. </li></ul><br>  <b>Other</b> <br><br><ul><li>  output src writes src to Output: the interface section. </li><li>  end terminates the program. </li></ul><br><h3>  Addressing Methods </h3><br>  Operands in the above commands can take several forms: <br><br>  Immediates are literal values ‚Äã‚Äãembedded in the command.  Examples: 7 and 123.  For example, to copy the value 7 to the register ra: <br><br><pre><code class="javascript hljs">mov ra <span class="hljs-number"><span class="hljs-number">7</span></span></code> </pre> <br>  Registers refer to registers by name.  Examples: ra, rb, rc.  To copy a value from rc to rb: <br><br><pre> <code class="javascript hljs">mov rb rc</code> </pre> <br>  Memory refers to the value inside the memory location.  Examples: $ 0, $ 10, $ 99.  To copy a value from ra to the first memory location: <br><br><pre> <code class="javascript hljs">mov $<span class="hljs-number"><span class="hljs-number">0</span></span> ra</code> </pre> <br>  To copy the value from the last memory location to rd: <br><br><pre> <code class="javascript hljs">mov rd $<span class="hljs-number"><span class="hljs-number">99</span></span></code> </pre> <br>  Indirect refers to the value pointed to by the memory cell.  Examples: @ 15, @ 50.  Therefore, if memory cell 10 contains the value 20, and memory cell 20 contains the value 30, you can copy the value 30 into ra as follows: <br><br><pre> <code class="javascript hljs">mov ra @<span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br>  He checks memory cell 10 to find the value 20. Then he accesses memory cell 20 to find the value 30, and copies this value to ra. <br><br><h3>  Recursion </h3><br>  You can use the stack and the call and ret commands to make recursive calls.  Here is an example that uses recursion to generate the factorial of the number 5: <br><br><img src="https://habrastorage.org/web/04b/73e/2ef/04b73e2ef2484703b2c99201124e14a9.gif" alt="image"><br><br>  Code starting with jl ra 2 50 is a function that accepts an input value in ra and returns the result in rd.  It calls itself recursively to calculate the factorial of a value in ra. <br><br><h3>  How to get a copy </h3><br>  If you want to play with it yourself, you can make a copy of it <a href="https://docs.google.com/spreadsheets/d/1385V2Mu2yZOMSJcSz9JrV6r8X0_JGzHZZRdPhaAdwWY/edit%3Fusp%3Dsharing">here</a> . <br><br>  You can see the Apps Script code by selecting ‚ÄúTools‚Äù (Tools), and then ‚ÄúScript Editor‚Äù. <br><br> <a href="http://payonline.ru/%3Futm_source%3Dhabrahabr%26utm_medium%3Dreferral%26utm_campaign%3Dwebpayments-main"><img src="https://habrastorage.org/files/8f6/e15/80b/8f6e1580b42a45e78421d1678ed655ad.png" alt="image"></a> </div><p>Source: <a href="https://habr.com/ru/post/319754/">https://habr.com/ru/post/319754/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319744/index.html">QR codes - security issues: have we not rushed?</a></li>
<li><a href="../319746/index.html">Weather station from Arduino and Orienteer</a></li>
<li><a href="../319748/index.html">MySpace syndrome, which is also peculiar to Facebook</a></li>
<li><a href="../319750/index.html">Why payments are at the heart of tourist experience</a></li>
<li><a href="../319752/index.html">Zelle launch - proof that fintech companies can influence large banks</a></li>
<li><a href="../319756/index.html">Reaching for milleniali: trends and mobile marketing techniques</a></li>
<li><a href="../319758/index.html">Stripe API version control system as a separate tool</a></li>
<li><a href="../319760/index.html">Terraform, Azure, Irkutsk and another 1207 words about transferring the game to the cloud</a></li>
<li><a href="../319762/index.html">7 services for finding mobile application vulnerabilities</a></li>
<li><a href="../319766/index.html">How to teach at the Yandex Interface Development School, and what I learned there</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>